<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: TCacheResource Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="class_t_cache_resource-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">TCacheResource Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="">tcacheresource.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a78a568d4557327238b64c044c78e398a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><b>Type</b> { <b>NONE</b>
, <b>RGBM32</b>
, <b>RGBM64</b>
, <b>CM32</b>
 }</td></tr>
<tr class="separator:a78a568d4557327238b64c044c78e398a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6e14ecc6dbe795f67b4ef782c4b9687c"><td class="memItemLeft" align="right" valign="top">const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a6e14ecc6dbe795f67b4ef782c4b9687c">getName</a> () const</td></tr>
<tr class="separator:a6e14ecc6dbe795f67b4ef782c4b9687c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6b944485ad7712b736abfd31aecf04e"><td class="memItemLeft" align="right" valign="top">QMutex *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#ae6b944485ad7712b736abfd31aecf04e">getMutex</a> ()</td></tr>
<tr class="separator:ae6b944485ad7712b736abfd31aecf04e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a546ee206417d986f3c1fcc668d131c3c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a546ee206417d986f3c1fcc668d131c3c">getRasterType</a> () const</td></tr>
<tr class="separator:a546ee206417d986f3c1fcc668d131c3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a202e9c303fad494f0e244941c56c8883"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_smart_pointer_t.html">TRasterP</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a202e9c303fad494f0e244941c56c8883">buildCompatibleRaster</a> (const <a class="el" href="class_t_dimension_t.html">TDimension</a> &amp;<a class="el" href="class_t_cache_resource.html#a5b07817551a426772a465e1e1518cc82">size</a>)</td></tr>
<tr class="separator:a202e9c303fad494f0e244941c56c8883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90381856ea59bff5c96f7de5cc80ae45"><td class="memItemLeft" align="right" valign="top">QRegion&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a90381856ea59bff5c96f7de5cc80ae45">getAvailableRegion</a> () const</td></tr>
<tr class="separator:a90381856ea59bff5c96f7de5cc80ae45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fca73a70165610ef7d0ed9d67d32150"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a7fca73a70165610ef7d0ed9d67d32150">upload</a> (const <a class="el" href="class_t_point_t.html">TPoint</a> &amp;pos, <a class="el" href="class_t_smart_pointer_t.html">TRasterP</a> ras)</td></tr>
<tr class="separator:a7fca73a70165610ef7d0ed9d67d32150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67a336e4ba0a07963f1b70eb1f9c24ab"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a67a336e4ba0a07963f1b70eb1f9c24ab">upload</a> (const <a class="el" href="class_t_tile.html">TTile</a> &amp;tile)</td></tr>
<tr class="separator:a67a336e4ba0a07963f1b70eb1f9c24ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cc45812b90f1616703355f871e9f66c"><td class="memItemLeft" align="right" valign="top">QRegion&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a2cc45812b90f1616703355f871e9f66c">download</a> (const <a class="el" href="class_t_point_t.html">TPoint</a> &amp;pos, <a class="el" href="class_t_smart_pointer_t.html">TRasterP</a> ras)</td></tr>
<tr class="separator:a2cc45812b90f1616703355f871e9f66c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab48664e5e08cb13174b648d3473aed79"><td class="memItemLeft" align="right" valign="top">QRegion&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#ab48664e5e08cb13174b648d3473aed79">download</a> (<a class="el" href="class_t_tile.html">TTile</a> &amp;tile)</td></tr>
<tr class="separator:ab48664e5e08cb13174b648d3473aed79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b031ed696884c6e264e43a88e261992"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a0b031ed696884c6e264e43a88e261992">downloadAll</a> (const <a class="el" href="class_t_point_t.html">TPoint</a> &amp;pos, <a class="el" href="class_t_smart_pointer_t.html">TRasterP</a> ras)</td></tr>
<tr class="separator:a0b031ed696884c6e264e43a88e261992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51b528636943060b9deae2d7335b1b3e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a51b528636943060b9deae2d7335b1b3e">downloadAll</a> (<a class="el" href="class_t_tile.html">TTile</a> &amp;tile)</td></tr>
<tr class="separator:a51b528636943060b9deae2d7335b1b3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa12f473ea3211fff52dbf0e2bdbad1cd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#aa12f473ea3211fff52dbf0e2bdbad1cd">uploadPalette</a> (<a class="el" href="class_t_smart_pointer_t.html">TPaletteP</a> palette)</td></tr>
<tr class="separator:aa12f473ea3211fff52dbf0e2bdbad1cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7df351d55eeb49dbccb3d6b68c4322d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#ab7df351d55eeb49dbccb3d6b68c4322d">downloadPalette</a> (<a class="el" href="class_t_smart_pointer_t.html">TPaletteP</a> &amp;palette)</td></tr>
<tr class="separator:ab7df351d55eeb49dbccb3d6b68c4322d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af246ee11a995b81c7678521a4f29d288"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#af246ee11a995b81c7678521a4f29d288">clear</a> (QRegion region)</td></tr>
<tr class="separator:af246ee11a995b81c7678521a4f29d288"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ce70d2ba7217d7108fad7bb664c5235"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a9ce70d2ba7217d7108fad7bb664c5235">canUpload</a> (const <a class="el" href="class_t_tile.html">TTile</a> &amp;tile) const</td></tr>
<tr class="separator:a9ce70d2ba7217d7108fad7bb664c5235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9af323ed1459c98546a31d1d03e5cde3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a9af323ed1459c98546a31d1d03e5cde3">canDownloadSome</a> (const <a class="el" href="class_t_tile.html">TTile</a> &amp;tile) const</td></tr>
<tr class="separator:a9af323ed1459c98546a31d1d03e5cde3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae821b3058d74bb59cb7dc48f7bd4db9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#aae821b3058d74bb59cb7dc48f7bd4db9">canDownloadAll</a> (const <a class="el" href="class_t_tile.html">TTile</a> &amp;tile) const</td></tr>
<tr class="separator:aae821b3058d74bb59cb7dc48f7bd4db9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeb6b5e5ae11508a059ea374e365270d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#afeb6b5e5ae11508a059ea374e365270d">canUpload</a> (int rasType) const</td></tr>
<tr class="separator:afeb6b5e5ae11508a059ea374e365270d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6296f3b08b3d6ff38ad96ce3d9c82550"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a6296f3b08b3d6ff38ad96ce3d9c82550">canDownloadSome</a> (const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;rect) const</td></tr>
<tr class="separator:a6296f3b08b3d6ff38ad96ce3d9c82550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9941e7b80447789207ab5deaa7f10a06"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a9941e7b80447789207ab5deaa7f10a06">canDownloadAll</a> (const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;rect) const</td></tr>
<tr class="separator:a9941e7b80447789207ab5deaa7f10a06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c36ef28e9afda71ccf1e197e9bb78f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a7c36ef28e9afda71ccf1e197e9bb78f5">addRef2</a> (const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;rect)</td></tr>
<tr class="separator:a7c36ef28e9afda71ccf1e197e9bb78f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afde44819cacc4d85e8a705eb5758bd09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#afde44819cacc4d85e8a705eb5758bd09">release2</a> (const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;rect)</td></tr>
<tr class="separator:afde44819cacc4d85e8a705eb5758bd09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc00a70419e29d5280e6ba674f44f73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a1cc00a70419e29d5280e6ba674f44f73">addLock</a> ()</td></tr>
<tr class="separator:a1cc00a70419e29d5280e6ba674f44f73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad213948a094a3aa54683b1bc1c7b068d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#ad213948a094a3aa54683b1bc1c7b068d">releaseLock</a> ()</td></tr>
<tr class="separator:ad213948a094a3aa54683b1bc1c7b068d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b07817551a426772a465e1e1518cc82"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a5b07817551a426772a465e1e1518cc82">size</a> () const</td></tr>
<tr class="memdesc:a5b07817551a426772a465e1e1518cc82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current size, in MB, of the cache resource.  <a href="class_t_cache_resource.html#a5b07817551a426772a465e1e1518cc82">More...</a><br /></td></tr>
<tr class="separator:a5b07817551a426772a465e1e1518cc82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d50e8f6fea2f7460ea34725f16a0548"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a8d50e8f6fea2f7460ea34725f16a0548">enableBackup</a> ()</td></tr>
<tr class="separator:a8d50e8f6fea2f7460ea34725f16a0548"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa985cadb862103dacc57de8cecb5a137"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#aa985cadb862103dacc57de8cecb5a137">invalidate</a> ()</td></tr>
<tr class="separator:aa985cadb862103dacc57de8cecb5a137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa881605a8e00f86020e007f8292aaf1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#aa881605a8e00f86020e007f8292aaf1f">save</a> (const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;fp)</td></tr>
<tr class="separator:aa881605a8e00f86020e007f8292aaf1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a722a517681415eb4997c6571c3c5b6b4"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a722a517681415eb4997c6571c3c5b6b4">TCacheResourcePool</a></td></tr>
<tr class="separator:a722a517681415eb4997c6571c3c5b6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05cf1f35aa862c864aed074a625b9121"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a05cf1f35aa862c864aed074a625b9121">THDCacheResourcePool</a></td></tr>
<tr class="separator:a05cf1f35aa862c864aed074a625b9121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d9e971014d432f33435740f298820ca"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_cache_resource.html#a3d9e971014d432f33435740f298820ca">TCacheResourceP</a></td></tr>
<tr class="separator:a3d9e971014d432f33435740f298820ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >The <a class="el" href="class_t_cache_resource.html">TCacheResource</a> class models generic tile objects suitable for caching in render processes.</p>
<p >Whereas common <a class="el" href="class_t_tile.html">TTile</a> instances can be used to represent images bounded on a specific rect of the plane, the caching procedures in a render process require certain generalizations of the tile model that are fulfilled by the <a class="el" href="class_t_cache_resource.html">TCacheResource</a> class:</p>
<p >A cache resource has a textual description of its content that we'll call 'name'. It is the associative key used to retrieve a resource among all the others stored in the cache. &lt;</p><ul>
<li>&gt;  The spatial domain of a cache resource is the entire plane, meaning that access methods are not bound to work on a specific rect. This is necessary since the image data accessed on non-consecutive renders could cover sparse regions of the plane. &lt;</li>
<li>&gt;  For simplicity, the pixel geometry of a cache is coherent to the plane origin - that is, pixel corners always have integer coordinates. &lt;</li>
<li>&gt;  Filled resources have a <b> raster type &lt;<b></b> &gt;, specifying the type of rasters that are currently storing. It is forbidden to upload rasters to resources when their raster type differs. Empty resources are compatible to all possible raster types. &lt;</b></li>
<li><b>&gt;  Cache resources provide reference counters to either the entire resource and each piece of its internal memory model, in order to perform automatic release of unnecessary data. &lt;</b></li>
<li><b>&gt;  The resource provides an accessible resume of its currently filled areas, in the form of a QRegion. &lt;</b></li>
<li><b>&gt;</b></li>
</ul>
<p>In order to use or retrieve a cache resource, users must instantiate a smart pointer reference to the resource, providing its name. Please refer to the <a class="el" href="class_t_cache_resource_p.html">TCacheResourceP</a> documentation for this topic.</p>
<p ><b></p><dl class="section see"><dt>See also</dt><dd><a class="el" href="class_t_raster.html">TRaster</a>, <a class="el" href="class_t_tile.html">TTile</a> classes. </dd></dl>
<p></b></p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a78a568d4557327238b64c044c78e398a" name="a78a568d4557327238b64c044c78e398a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78a568d4557327238b64c044c78e398a">&#9670;&nbsp;</a></span>Type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum TCacheResource::Type</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  141</span>{ NONE, RGBM32, RGBM64, CM32 };</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1cc00a70419e29d5280e6ba674f44f73" name="a1cc00a70419e29d5280e6ba674f44f73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cc00a70419e29d5280e6ba674f44f73">&#9670;&nbsp;</a></span>addLock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCacheResource::addLock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  738</span>                             {</div>
<div class="line"><span class="lineno">  739</span>  <span class="comment">// DIAGNOSTICS_NUMBEREDSTR(prefix + QString::number((UINT) this) + &quot; | Stack |</span></div>
<div class="line"><span class="lineno">  740</span>  <span class="comment">// &quot;,</span></div>
<div class="line"><span class="lineno">  741</span>  <span class="comment">//&quot;crStack&quot;, &quot;addLock&quot;);</span></div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>  ++m_locksCount;</div>
<div class="line"><span class="lineno">  744</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c36ef28e9afda71ccf1e197e9bb78f5" name="a7c36ef28e9afda71ccf1e197e9bb78f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c36ef28e9afda71ccf1e197e9bb78f5">&#9670;&nbsp;</a></span>addRef2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCacheResource::addRef2 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;&#160;</td>
          <td class="paramname"><em>rect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  685</span>                                              {</div>
<div class="line"><span class="lineno">  686</span>  <span class="comment">// DIAGNOSTICS_NUMBEREDSTRSET(prefix + QString::number((UINT) this) + &quot; |</span></div>
<div class="line"><span class="lineno">  687</span>  <span class="comment">// Stack | &quot;,</span></div>
<div class="line"><span class="lineno">  688</span>  <span class="comment">//&quot;crStack&quot;, &quot;addRef&quot;, ::traduce(rect));</span></div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>  <span class="comment">// Add a reference to all cells intersecting the passed one</span></div>
<div class="line"><span class="lineno">  691</span>  <a class="code hl_class" href="class_t_point_t.html">TPoint</a> initialPos(getCellPos(rect.getP00()));</div>
<div class="line"><span class="lineno">  692</span>  <a class="code hl_class" href="class_t_point_t.html">TPoint</a> pos;</div>
<div class="line"><span class="lineno">  693</span>  <span class="keywordflow">for</span> (pos.x = initialPos.x; pos.x &lt;= rect.x1; pos.x += latticeStep)</div>
<div class="line"><span class="lineno">  694</span>    <span class="keywordflow">for</span> (pos.y = initialPos.y; pos.y &lt;= rect.y1; pos.y += latticeStep) {</div>
<div class="line"><span class="lineno">  695</span>      PointLess cellIndex(getCellIndex(pos));</div>
<div class="line"><span class="lineno">  696</span>      CellData &amp;cellData    = m_cellDatas[cellIndex];</div>
<div class="line"><span class="lineno">  697</span>      cellData.m_referenced = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  698</span>      cellData.m_refsCount++;</div>
<div class="line"><span class="lineno">  699</span>    }</div>
<div class="line"><span class="lineno">  700</span>}</div>
<div class="ttc" id="aclass_t_point_t_html"><div class="ttname"><a href="class_t_point_t.html">TPointT&lt; int &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a202e9c303fad494f0e244941c56c8883" name="a202e9c303fad494f0e244941c56c8883"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a202e9c303fad494f0e244941c56c8883">&#9670;&nbsp;</a></span>buildCompatibleRaster()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_smart_pointer_t.html">TRasterP</a> TCacheResource::buildCompatibleRaster </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_dimension_t.html">TDimension</a> &amp;&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  333</span>                                                                     {</div>
<div class="line"><span class="lineno">  334</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TRasterP</a> result;</div>
<div class="line"><span class="lineno">  335</span>  <span class="keywordflow">if</span> (m_tileType == RGBM32)</div>
<div class="line"><span class="lineno">  336</span>    result = <a class="code hl_class" href="class_t_raster_p_t.html">TRaster32P</a>(<a class="code hl_function" href="class_t_cache_resource.html#a5b07817551a426772a465e1e1518cc82">size</a>);</div>
<div class="line"><span class="lineno">  337</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_tileType == RGBM64)</div>
<div class="line"><span class="lineno">  338</span>    result = <a class="code hl_class" href="class_t_raster_p_t.html">TRaster64P</a>(<a class="code hl_function" href="class_t_cache_resource.html#a5b07817551a426772a465e1e1518cc82">size</a>);</div>
<div class="line"><span class="lineno">  339</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_tileType == CM32)</div>
<div class="line"><span class="lineno">  340</span>    result = <a class="code hl_class" href="class_t_raster_p_t.html">TRasterCM32P</a>(<a class="code hl_function" href="class_t_cache_resource.html#a5b07817551a426772a465e1e1518cc82">size</a>);</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  343</span>}</div>
<div class="ttc" id="aclass_t_cache_resource_html_a5b07817551a426772a465e1e1518cc82"><div class="ttname"><a href="class_t_cache_resource.html#a5b07817551a426772a465e1e1518cc82">TCacheResource::size</a></div><div class="ttdeci">int size() const</div><div class="ttdoc">Returns the current size, in MB, of the cache resource.</div><div class="ttdef"><b>Definition:</b> tcacheresource.cpp:790</div></div>
<div class="ttc" id="aclass_t_raster_p_t_html"><div class="ttname"><a href="class_t_raster_p_t.html">TRasterPT&lt; TPixel32 &gt;</a></div></div>
<div class="ttc" id="aclass_t_smart_pointer_t_html"><div class="ttname"><a href="class_t_smart_pointer_t.html">TSmartPointerT&lt; TRaster &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9941e7b80447789207ab5deaa7f10a06" name="a9941e7b80447789207ab5deaa7f10a06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9941e7b80447789207ab5deaa7f10a06">&#9670;&nbsp;</a></span>canDownloadAll() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TCacheResource::canDownloadAll </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;&#160;</td>
          <td class="paramname"><em>rect</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  417</span>                                                           {</div>
<div class="line"><span class="lineno">  418</span>  <span class="keywordflow">return</span> contains(m_region, rect);</div>
<div class="line"><span class="lineno">  419</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae821b3058d74bb59cb7dc48f7bd4db9" name="aae821b3058d74bb59cb7dc48f7bd4db9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae821b3058d74bb59cb7dc48f7bd4db9">&#9670;&nbsp;</a></span>canDownloadAll() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TCacheResource::canDownloadAll </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_tile.html">TTile</a> &amp;&#160;</td>
          <td class="paramname"><em>tile</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Returns true if the passed tile is compatible, and it can be downloaded entirely. </p>
<div class="fragment"><div class="line"><span class="lineno">  440</span>                                                           {</div>
<div class="line"><span class="lineno">  441</span>  <span class="keywordflow">return</span> checkTile(tile) &amp;&amp; contains(m_region, getTileRect(tile));</div>
<div class="line"><span class="lineno">  442</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6296f3b08b3d6ff38ad96ce3d9c82550" name="a6296f3b08b3d6ff38ad96ce3d9c82550"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6296f3b08b3d6ff38ad96ce3d9c82550">&#9670;&nbsp;</a></span>canDownloadSome() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TCacheResource::canDownloadSome </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;&#160;</td>
          <td class="paramname"><em>rect</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  411</span>                                                            {</div>
<div class="line"><span class="lineno">  412</span>  <span class="keywordflow">return</span> m_region.intersects(toQRect(rect));</div>
<div class="line"><span class="lineno">  413</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9af323ed1459c98546a31d1d03e5cde3" name="a9af323ed1459c98546a31d1d03e5cde3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9af323ed1459c98546a31d1d03e5cde3">&#9670;&nbsp;</a></span>canDownloadSome() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TCacheResource::canDownloadSome </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_tile.html">TTile</a> &amp;&#160;</td>
          <td class="paramname"><em>tile</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Returns true if the passed tile is compatible with the complex, and some part of it is downloadable. </p>
<div class="fragment"><div class="line"><span class="lineno">  432</span>                                                            {</div>
<div class="line"><span class="lineno">  433</span>  <span class="keywordflow">return</span> checkTile(tile) &amp;&amp; m_region.intersects(toQRect(getTileRect(tile)));</div>
<div class="line"><span class="lineno">  434</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ce70d2ba7217d7108fad7bb664c5235" name="a9ce70d2ba7217d7108fad7bb664c5235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ce70d2ba7217d7108fad7bb664c5235">&#9670;&nbsp;</a></span>canUpload() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TCacheResource::canUpload </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_tile.html">TTile</a> &amp;&#160;</td>
          <td class="paramname"><em>tile</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  423</span>                                                      {</div>
<div class="line"><span class="lineno">  424</span>  <span class="keywordtype">int</span> tileType;</div>
<div class="line"><span class="lineno">  425</span>  <span class="keywordflow">return</span> checkTile(tile) &amp;&amp; checkRasterType(tile.getRaster(), tileType);</div>
<div class="line"><span class="lineno">  426</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afeb6b5e5ae11508a059ea374e365270d" name="afeb6b5e5ae11508a059ea374e365270d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeb6b5e5ae11508a059ea374e365270d">&#9670;&nbsp;</a></span>canUpload() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool TCacheResource::canUpload </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rasType</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  163</span>                                    {</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">return</span> m_tileType == NONE || m_tileType == rasType;</div>
<div class="line"><span class="lineno">  165</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af246ee11a995b81c7678521a4f29d288" name="af246ee11a995b81c7678521a4f29d288"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af246ee11a995b81c7678521a4f29d288">&#9670;&nbsp;</a></span>clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCacheResource::clear </td>
          <td>(</td>
          <td class="paramtype">QRegion&#160;</td>
          <td class="paramname"><em>region</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Clears the complex on the specified region. Please observe that the actually cleared region consists of all lattice cells intersecting the passed region, therefore resulting in a cleared region typically larger than passed one, up to the lattice granularity. </p>
<div class="fragment"><div class="line"><span class="lineno">  624</span>                                         {</div>
<div class="line"><span class="lineno">  625</span>  <span class="keywordflow">if</span> (!m_region.intersects(region)) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  626</span> </div>
<div class="line"><span class="lineno">  627</span>  <span class="comment">// Get the region bbox</span></div>
<div class="line"><span class="lineno">  628</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> bbox(toTRect(region.boundingRect()));</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>  <span class="comment">// For all cells intersecting the bbox</span></div>
<div class="line"><span class="lineno">  631</span>  <a class="code hl_class" href="class_t_point_t.html">TPoint</a> initialPos(getCellPos(bbox.getP00()));</div>
<div class="line"><span class="lineno">  632</span>  <a class="code hl_class" href="class_t_point_t.html">TPoint</a> pos;</div>
<div class="line"><span class="lineno">  633</span>  <span class="keywordflow">for</span> (pos.x = initialPos.x; pos.x &lt;= bbox.x1; pos.x += latticeStep)</div>
<div class="line"><span class="lineno">  634</span>    <span class="keywordflow">for</span> (pos.y = initialPos.y; pos.y &lt;= bbox.y1; pos.y += latticeStep) {</div>
<div class="line"><span class="lineno">  635</span>      QRect cellQRect(</div>
<div class="line"><span class="lineno">  636</span>          toQRect(<a class="code hl_class" href="class_t_rect_t.html">TRect</a>(pos, <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a>(latticeStep, latticeStep))));</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>      <span class="keywordflow">if</span> (region.intersects(cellQRect) &amp;&amp; m_region.intersects(cellQRect)) {</div>
<div class="line"><span class="lineno">  639</span>        <span class="comment">// Release the associated cell from cache and clear the cell from the</span></div>
<div class="line"><span class="lineno">  640</span>        <span class="comment">// content region.</span></div>
<div class="line"><span class="lineno">  641</span>        TImageCache::instance()-&gt;<a class="code hl_function" href="class_t_image_cache.html#a57d63227dfe2532b0aed22c47113be66">remove</a>(getCellCacheId(pos));</div>
<div class="line"><span class="lineno">  642</span>        m_region -= cellQRect;</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>        --m_cellsCount;</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>        <span class="comment">// DIAGNOSTICS_GLOADD(&quot;crCellsCnt&quot;, -1);</span></div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>        <span class="comment">// Release the cell from m_cellDatas</span></div>
<div class="line"><span class="lineno">  649</span>        m_cellDatas[getCellIndex(pos)].m_modified = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  650</span>      }</div>
<div class="line"><span class="lineno">  651</span>    }</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>  <span class="keywordflow">if</span> (m_region.isEmpty()) {</div>
<div class="line"><span class="lineno">  654</span>    m_tileType   = NONE;</div>
<div class="line"><span class="lineno">  655</span>    m_locksCount = 0;</div>
<div class="line"><span class="lineno">  656</span>  }</div>
<div class="line"><span class="lineno">  657</span>}</div>
<div class="ttc" id="aclass_t_dimension_t_html"><div class="ttname"><a href="class_t_dimension_t.html">TDimensionT&lt; int &gt;</a></div></div>
<div class="ttc" id="aclass_t_image_cache_html_a57d63227dfe2532b0aed22c47113be66"><div class="ttname"><a href="class_t_image_cache.html#a57d63227dfe2532b0aed22c47113be66">TImageCache::remove</a></div><div class="ttdeci">void remove(const std::string &amp;id)</div><div class="ttdoc">Removes from the image cache the image associated to passed id.</div><div class="ttdef"><b>Definition:</b> timagecache.cpp:1260</div></div>
<div class="ttc" id="aclass_t_rect_t_html"><div class="ttname"><a href="class_t_rect_t.html">TRectT&lt; int &gt;</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00624">clear()</a>, and <a class="el" href="#l01260">TImageCache::remove()</a>.</p>

<p class="reference">Referenced by <a class="el" href="#l00624">clear()</a>.</p>

</div>
</div>
<a id="a2cc45812b90f1616703355f871e9f66c" name="a2cc45812b90f1616703355f871e9f66c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cc45812b90f1616703355f871e9f66c">&#9670;&nbsp;</a></span>download() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QRegion TCacheResource::download </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_point_t.html">TPoint</a> &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TRasterP</a>&#160;</td>
          <td class="paramname"><em>ras</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Fills the passed tile with the data contained in the complex, returning the copied region. The same restriction of the <a class="el" href="class_t_cache_resource.html#a7fca73a70165610ef7d0ed9d67d32150">upload()</a> method applies here. </p>
<div class="fragment"><div class="line"><span class="lineno">  511</span>                                                                {</div>
<div class="line"><span class="lineno">  512</span>  <span class="keywordtype">int</span> tileType;</div>
<div class="line"><span class="lineno">  513</span>  <span class="keywordflow">if</span> (!checkRasterType(ras, tileType)) <span class="keywordflow">return</span> QRegion();</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>  <span class="comment">// Build the tile&#39;s rect</span></div>
<div class="line"><span class="lineno">  516</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> tileRect(ras-&gt;getBounds() + pos);</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>  <span class="keywordflow">if</span> (!m_region.intersects(toQRect(tileRect))) <span class="keywordflow">return</span> QRegion();</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>  <span class="comment">// For all cells intersecting the tile&#39;s rect, copy all those intersecting the</span></div>
<div class="line"><span class="lineno">  521</span>  <span class="comment">// complex&#39;s content region.</span></div>
<div class="line"><span class="lineno">  522</span>  <a class="code hl_class" href="class_t_point_t.html">TPoint</a> initialPos(getCellPos(tileRect.getP00()));</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>  <a class="code hl_class" href="class_t_point_t.html">TPoint</a> currPos;</div>
<div class="line"><span class="lineno">  525</span>  <span class="keywordflow">for</span> (currPos.x = initialPos.x; currPos.x &lt;= tileRect.x1;</div>
<div class="line"><span class="lineno">  526</span>       currPos.x += latticeStep)</div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordflow">for</span> (currPos.y = initialPos.y; currPos.y &lt;= tileRect.y1;</div>
<div class="line"><span class="lineno">  528</span>         currPos.y += latticeStep) {</div>
<div class="line"><span class="lineno">  529</span>      <a class="code hl_class" href="class_t_rect_t.html">TRect</a> cellRect(currPos, <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a>(latticeStep, latticeStep));</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>      <a class="code hl_class" href="class_t_rect_t.html">TRect</a> overlapRect(tileRect * cellRect);</div>
<div class="line"><span class="lineno">  532</span>      assert(!overlapRect.isEmpty());</div>
<div class="line"><span class="lineno">  533</span>      QRect overlapQRect(toQRect(overlapRect));</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>      <span class="keywordflow">if</span> (m_region.intersects(overlapQRect)) {</div>
<div class="line"><span class="lineno">  536</span>        <span class="comment">// Extract the associated rasters and perform the copy to the input</span></div>
<div class="line"><span class="lineno">  537</span>        <span class="comment">// tile.</span></div>
<div class="line"><span class="lineno">  538</span>        std::pair&lt;TRasterP, CellData *&gt; cellInfos(touch(getCellIndex(currPos)));</div>
<div class="line"><span class="lineno">  539</span>        <a class="code hl_class" href="class_t_smart_pointer_t.html">TRasterP</a> cellRas(cellInfos.first);</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>        <a class="code hl_class" href="class_t_rect_t.html">TRect</a> temp(overlapRect - currPos);</div>
<div class="line"><span class="lineno">  542</span>        <a class="code hl_class" href="class_t_smart_pointer_t.html">TRasterP</a> overlappingCellRas(cellRas-&gt;extract(temp));</div>
<div class="line"><span class="lineno">  543</span>        temp = <a class="code hl_class" href="class_t_rect_t.html">TRect</a>(overlapRect - tileRect.getP00());</div>
<div class="line"><span class="lineno">  544</span>        <a class="code hl_class" href="class_t_smart_pointer_t.html">TRasterP</a> overlappingTileRas(ras-&gt;extract(temp));</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>        <a class="code hl_function" href="namespace_t_rop.html#a229eb7fd85c23c325ea4ba55478d5712">TRop::copy</a>(overlappingTileRas, overlappingCellRas);</div>
<div class="line"><span class="lineno">  547</span>      }</div>
<div class="line"><span class="lineno">  548</span>    }</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span>  <span class="keywordflow">return</span> m_region.intersected(QRegion(toQRect(tileRect)));</div>
<div class="line"><span class="lineno">  551</span>}</div>
<div class="ttc" id="anamespace_t_rop_html_a229eb7fd85c23c325ea4ba55478d5712"><div class="ttname"><a href="namespace_t_rop.html#a229eb7fd85c23c325ea4ba55478d5712">TRop::copy</a></div><div class="ttdeci">DVAPI void copy(TRasterP dst, const TRasterP &amp;src)</div><div class="ttdoc">Copy src in dst.</div><div class="ttdef"><b>Definition:</b> trop.cpp:93</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00093">TRop::copy()</a>, and <a class="el" href="class_t_rect_t.html#a53ce09c6112f8a019b43ad82d721a93b">TRectT&lt; T &gt;::isEmpty()</a>.</p>

</div>
</div>
<a id="ab48664e5e08cb13174b648d3473aed79" name="ab48664e5e08cb13174b648d3473aed79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab48664e5e08cb13174b648d3473aed79">&#9670;&nbsp;</a></span>download() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QRegion TCacheResource::download </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_tile.html">TTile</a> &amp;&#160;</td>
          <td class="paramname"><em>tile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  555</span>                                            {</div>
<div class="line"><span class="lineno">  556</span>  <span class="keywordflow">if</span> (!checkTile(tile)) <span class="keywordflow">return</span> QRegion();</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="class_t_cache_resource.html#a2cc45812b90f1616703355f871e9f66c">download</a>(<a class="code hl_class" href="class_t_point_t.html">TPoint</a>(tile.m_pos.x, tile.m_pos.y), tile.getRaster());</div>
<div class="line"><span class="lineno">  559</span>}</div>
<div class="ttc" id="aclass_t_cache_resource_html_a2cc45812b90f1616703355f871e9f66c"><div class="ttname"><a href="class_t_cache_resource.html#a2cc45812b90f1616703355f871e9f66c">TCacheResource::download</a></div><div class="ttdeci">QRegion download(const TPoint &amp;pos, TRasterP ras)</div><div class="ttdef"><b>Definition:</b> tcacheresource.cpp:511</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b031ed696884c6e264e43a88e261992" name="a0b031ed696884c6e264e43a88e261992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b031ed696884c6e264e43a88e261992">&#9670;&nbsp;</a></span>downloadAll() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TCacheResource::downloadAll </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_point_t.html">TPoint</a> &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TRasterP</a>&#160;</td>
          <td class="paramname"><em>ras</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  563</span>                                                                {</div>
<div class="line"><span class="lineno">  564</span>  <span class="keywordtype">int</span> tileType;</div>
<div class="line"><span class="lineno">  565</span>  <span class="keywordflow">if</span> (!checkRasterType(ras, tileType)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>  <span class="comment">// Build the tile&#39;s rect</span></div>
<div class="line"><span class="lineno">  568</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> tileRect(ras-&gt;getBounds() + pos);</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>  <span class="keywordflow">if</span> (!contains(m_region, tileRect)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>  <span class="comment">// DIAGNOSTICS_NUMBEREDSTRSET(prefix + QString::number((UINT) this) + &quot; |</span></div>
<div class="line"><span class="lineno">  573</span>  <span class="comment">// Stack | &quot;,</span></div>
<div class="line"><span class="lineno">  574</span>  <span class="comment">//&quot;crStack&quot;, &quot;downloadAll&quot;, ::traduce(TRect(pos, ras-&gt;getSize())));</span></div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>  <span class="comment">// For all cells intersecting the tile&#39;s rect, copy all those intersecting the</span></div>
<div class="line"><span class="lineno">  577</span>  <span class="comment">// complex&#39;s content region.</span></div>
<div class="line"><span class="lineno">  578</span>  <a class="code hl_class" href="class_t_point_t.html">TPoint</a> initialPos(getCellPos(tileRect.getP00()));</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>  <a class="code hl_class" href="class_t_point_t.html">TPoint</a> currPos;</div>
<div class="line"><span class="lineno">  581</span>  <span class="keywordflow">for</span> (currPos.x = initialPos.x; currPos.x &lt;= tileRect.x1;</div>
<div class="line"><span class="lineno">  582</span>       currPos.x += latticeStep)</div>
<div class="line"><span class="lineno">  583</span>    <span class="keywordflow">for</span> (currPos.y = initialPos.y; currPos.y &lt;= tileRect.y1;</div>
<div class="line"><span class="lineno">  584</span>         currPos.y += latticeStep) {</div>
<div class="line"><span class="lineno">  585</span>      <a class="code hl_class" href="class_t_rect_t.html">TRect</a> cellRect(currPos, <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a>(latticeStep, latticeStep));</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>      <a class="code hl_class" href="class_t_rect_t.html">TRect</a> overlapRect(tileRect * cellRect);</div>
<div class="line"><span class="lineno">  588</span>      assert(!overlapRect.isEmpty());</div>
<div class="line"><span class="lineno">  589</span>      QRect overlapQRect(toQRect(overlapRect));</div>
<div class="line"><span class="lineno">  590</span> </div>
<div class="line"><span class="lineno">  591</span>      <span class="keywordflow">if</span> (m_region.intersects(overlapQRect)) {</div>
<div class="line"><span class="lineno">  592</span>        <span class="comment">// Extract the associated rasters and perform the copy to the input</span></div>
<div class="line"><span class="lineno">  593</span>        <span class="comment">// tile.</span></div>
<div class="line"><span class="lineno">  594</span>        std::pair&lt;TRasterP, CellData *&gt; cellInfos(touch(getCellIndex(currPos)));</div>
<div class="line"><span class="lineno">  595</span>        <a class="code hl_class" href="class_t_smart_pointer_t.html">TRasterP</a> cellRas(cellInfos.first);</div>
<div class="line"><span class="lineno">  596</span> </div>
<div class="line"><span class="lineno">  597</span>        <a class="code hl_class" href="class_t_rect_t.html">TRect</a> temp(overlapRect - currPos);</div>
<div class="line"><span class="lineno">  598</span>        <a class="code hl_class" href="class_t_smart_pointer_t.html">TRasterP</a> overlappingCellRas(cellRas-&gt;extract(temp));</div>
<div class="line"><span class="lineno">  599</span>        temp = <a class="code hl_class" href="class_t_rect_t.html">TRect</a>(overlapRect - tileRect.getP00());</div>
<div class="line"><span class="lineno">  600</span>        <a class="code hl_class" href="class_t_smart_pointer_t.html">TRasterP</a> overlappingTileRas(ras-&gt;extract(temp));</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>        <a class="code hl_function" href="namespace_t_rop.html#a229eb7fd85c23c325ea4ba55478d5712">TRop::copy</a>(overlappingTileRas, overlappingCellRas);</div>
<div class="line"><span class="lineno">  603</span>      }</div>
<div class="line"><span class="lineno">  604</span>    }</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  607</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a51b528636943060b9deae2d7335b1b3e" name="a51b528636943060b9deae2d7335b1b3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51b528636943060b9deae2d7335b1b3e">&#9670;&nbsp;</a></span>downloadAll() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TCacheResource::downloadAll </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_tile.html">TTile</a> &amp;&#160;</td>
          <td class="paramname"><em>tile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  611</span>                                            {</div>
<div class="line"><span class="lineno">  612</span>  <span class="keywordflow">if</span> (!checkTile(tile)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>  <span class="keywordflow">return</span> downloadAll(<a class="code hl_class" href="class_t_point_t.html">TPoint</a>(tile.m_pos.x, tile.m_pos.y), tile.getRaster());</div>
<div class="line"><span class="lineno">  615</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7df351d55eeb49dbccb3d6b68c4322d" name="ab7df351d55eeb49dbccb3d6b68c4322d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7df351d55eeb49dbccb3d6b68c4322d">&#9670;&nbsp;</a></span>downloadPalette()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCacheResource::downloadPalette </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TPaletteP</a> &amp;&#160;</td>
          <td class="paramname"><em>palette</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  677</span>                                                       {</div>
<div class="line"><span class="lineno">  678</span>  palette = m_palette;</div>
<div class="line"><span class="lineno">  679</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d50e8f6fea2f7460ea34725f16a0548" name="a8d50e8f6fea2f7460ea34725f16a0548"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d50e8f6fea2f7460ea34725f16a0548">&#9670;&nbsp;</a></span>enableBackup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCacheResource::enableBackup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  803</span>                                  {</div>
<div class="line"><span class="lineno">  804</span>  <span class="keywordflow">if</span> (m_backEnabled) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  805</span>  TCacheResourcePool::instance()-&gt;startBacking(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">  806</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a90381856ea59bff5c96f7de5cc80ae45" name="a90381856ea59bff5c96f7de5cc80ae45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90381856ea59bff5c96f7de5cc80ae45">&#9670;&nbsp;</a></span>getAvailableRegion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QRegion TCacheResource::getAvailableRegion </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Returns the current region currently available in the complex, with respect to the complex's origin. </p>
<div class="fragment"><div class="line"><span class="lineno">  145</span>{ <span class="keywordflow">return</span> m_region; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6b944485ad7712b736abfd31aecf04e" name="ae6b944485ad7712b736abfd31aecf04e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6b944485ad7712b736abfd31aecf04e">&#9670;&nbsp;</a></span>getMutex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QMutex * TCacheResource::getMutex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  139</span>{ <span class="keywordflow">return</span> &amp;m_mutex; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e14ecc6dbe795f67b4ef782c4b9687c" name="a6e14ecc6dbe795f67b4ef782c4b9687c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e14ecc6dbe795f67b4ef782c4b9687c">&#9670;&nbsp;</a></span>getName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string &amp; TCacheResource::getName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  137</span>{ <span class="keywordflow">return</span> m_pos-&gt;first; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a546ee206417d986f3c1fcc668d131c3c" name="a546ee206417d986f3c1fcc668d131c3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a546ee206417d986f3c1fcc668d131c3c">&#9670;&nbsp;</a></span>getRasterType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int TCacheResource::getRasterType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Returns the type of raster currently present in the tile complex. Only images providing a raster representation coherent with the complex's one may be exchanged with it. </p>
<div class="fragment"><div class="line"><span class="lineno">  142</span>{ <span class="keywordflow">return</span> m_tileType; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa985cadb862103dacc57de8cecb5a137" name="aa985cadb862103dacc57de8cecb5a137"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa985cadb862103dacc57de8cecb5a137">&#9670;&nbsp;</a></span>invalidate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCacheResource::invalidate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  810</span>{ m_invalidated = <span class="keyword">true</span>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afde44819cacc4d85e8a705eb5758bd09" name="afde44819cacc4d85e8a705eb5758bd09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afde44819cacc4d85e8a705eb5758bd09">&#9670;&nbsp;</a></span>release2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCacheResource::release2 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;&#160;</td>
          <td class="paramname"><em>rect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  704</span>                                               {</div>
<div class="line"><span class="lineno">  705</span>  <span class="comment">// DIAGNOSTICS_NUMBEREDSTRSET(prefix + QString::number((UINT) this) + &quot; |</span></div>
<div class="line"><span class="lineno">  706</span>  <span class="comment">// Stack | &quot;,</span></div>
<div class="line"><span class="lineno">  707</span>  <span class="comment">//&quot;crStack&quot;, &quot;release&quot;, ::traduce(rect));</span></div>
<div class="line"><span class="lineno">  708</span> </div>
<div class="line"><span class="lineno">  709</span>  <span class="keywordflow">if</span> (m_locksCount &gt; 0) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>  std::map&lt;PointLess, CellData&gt;::iterator it;</div>
<div class="line"><span class="lineno">  712</span>  <span class="keywordflow">for</span> (it = m_cellDatas.begin(); it != m_cellDatas.end();) {</div>
<div class="line"><span class="lineno">  713</span>    <span class="keywordflow">if</span> (!it-&gt;second.m_referenced) {</div>
<div class="line"><span class="lineno">  714</span>      ++it;</div>
<div class="line"><span class="lineno">  715</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  716</span>    }</div>
<div class="line"><span class="lineno">  717</span> </div>
<div class="line"><span class="lineno">  718</span>    <a class="code hl_class" href="class_t_point_t.html">TPoint</a> cellPos(getCellPos(it-&gt;first));</div>
<div class="line"><span class="lineno">  719</span>    <a class="code hl_class" href="class_t_rect_t.html">TRect</a> cellRect(cellPos, <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a>(latticeStep, latticeStep));</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>    <span class="keywordflow">if</span> (isEmpty(cellRect * rect)) {</div>
<div class="line"><span class="lineno">  722</span>      ++it;</div>
<div class="line"><span class="lineno">  723</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  724</span>    }</div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>    QRect cellQRect(toQRect(cellRect));</div>
<div class="line"><span class="lineno">  727</span>    <span class="keywordflow">if</span> (--it-&gt;second.m_refsCount &lt;= 0) {</div>
<div class="line"><span class="lineno">  728</span>      releaseCell(cellQRect, it-&gt;first, it-&gt;second.m_modified);</div>
<div class="line"><span class="lineno">  729</span>      std::map&lt;PointLess, CellData&gt;::iterator jt = it++;</div>
<div class="line"><span class="lineno">  730</span>      m_cellDatas.erase(jt);</div>
<div class="line"><span class="lineno">  731</span>    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  732</span>      ++it;</div>
<div class="line"><span class="lineno">  733</span>  }</div>
<div class="line"><span class="lineno">  734</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad213948a094a3aa54683b1bc1c7b068d" name="ad213948a094a3aa54683b1bc1c7b068d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad213948a094a3aa54683b1bc1c7b068d">&#9670;&nbsp;</a></span>releaseLock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCacheResource::releaseLock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  748</span>                                 {</div>
<div class="line"><span class="lineno">  749</span>  <span class="comment">// DIAGNOSTICS_NUMBEREDSTR(prefix + QString::number((UINT) this) + &quot; | Stack |</span></div>
<div class="line"><span class="lineno">  750</span>  <span class="comment">// &quot;,</span></div>
<div class="line"><span class="lineno">  751</span>  <span class="comment">//&quot;crStack&quot;, &quot;releaseLock&quot;);</span></div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>  m_locksCount = std::max(m_locksCount - 1, 0);</div>
<div class="line"><span class="lineno">  754</span> </div>
<div class="line"><span class="lineno">  755</span>  <span class="keywordflow">if</span> (m_locksCount &gt; 0) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>  <span class="comment">// Check for released cells</span></div>
<div class="line"><span class="lineno">  758</span>  std::map&lt;PointLess, CellData&gt;::iterator it;</div>
<div class="line"><span class="lineno">  759</span>  <span class="keywordflow">for</span> (it = m_cellDatas.begin(); it != m_cellDatas.end();)</div>
<div class="line"><span class="lineno">  760</span>    <span class="keywordflow">if</span> (it-&gt;second.m_referenced) {</div>
<div class="line"><span class="lineno">  761</span>      <a class="code hl_class" href="class_t_point_t.html">TPoint</a> cellPos(getCellPos(it-&gt;first));</div>
<div class="line"><span class="lineno">  762</span>      QRect cellQRect(cellPos.x, cellPos.y, latticeStep, latticeStep);</div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span>      releaseCell(cellQRect, it-&gt;first, it-&gt;second.m_modified);</div>
<div class="line"><span class="lineno">  765</span>      std::map&lt;PointLess, CellData&gt;::iterator jt = it++;</div>
<div class="line"><span class="lineno">  766</span>      m_cellDatas.erase(jt);</div>
<div class="line"><span class="lineno">  767</span>    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  768</span>      ++it;</div>
<div class="line"><span class="lineno">  769</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa881605a8e00f86020e007f8292aaf1f" name="aa881605a8e00f86020e007f8292aaf1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa881605a8e00f86020e007f8292aaf1f">&#9670;&nbsp;</a></span>save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCacheResource::save </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>fp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  916</span>                                             {</div>
<div class="line"><span class="lineno">  917</span>  assert(!fp.isEmpty());</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>  std::map&lt;PointLess, CellData&gt;::iterator it;</div>
<div class="line"><span class="lineno">  920</span>  <span class="keywordflow">for</span> (it = m_cellDatas.begin(); it != m_cellDatas.end(); ++it) {</div>
<div class="line"><span class="lineno">  921</span>    <a class="code hl_class" href="class_t_smart_pointer_t.html">TRasterP</a> cellRas = getRaster(TImageCache::instance()-&gt;get(</div>
<div class="line"><span class="lineno">  922</span>        getCellCacheId(it-&gt;first.x, it-&gt;first.y), <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  923</span> </div>
<div class="line"><span class="lineno">  924</span>    assert(m_tileType != NONE);</div>
<div class="line"><span class="lineno">  925</span> </div>
<div class="line"><span class="lineno">  926</span>    <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> cellFp(fp + <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>(getCellName(it-&gt;first.x, it-&gt;first.y)));</div>
<div class="line"><span class="lineno">  927</span> </div>
<div class="line"><span class="lineno">  928</span>    <span class="keywordflow">if</span> (m_tileType == CM32)</div>
<div class="line"><span class="lineno">  929</span>      ::saveCompressed(cellFp, cellRas);</div>
<div class="line"><span class="lineno">  930</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  931</span>      TImageWriter::save(cellFp.withType(<span class="stringliteral">&quot;.tif&quot;</span>), cellRas);</div>
<div class="line"><span class="lineno">  932</span>  }</div>
<div class="line"><span class="lineno">  933</span>}</div>
<div class="ttc" id="aclass_t_file_path_html"><div class="ttname"><a href="class_t_file_path.html">TFilePath</a></div><div class="ttdef"><b>Definition:</b> tfilepath.h:134</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b07817551a426772a465e1e1518cc82" name="a5b07817551a426772a465e1e1518cc82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b07817551a426772a465e1e1518cc82">&#9670;&nbsp;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCacheResource::size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the current size, in MB, of the cache resource. </p>
<div class="fragment"><div class="line"><span class="lineno">  790</span>                               {</div>
<div class="line"><span class="lineno">  791</span>  <span class="comment">// NOTE: It&#39;s better to store the size incrementally. This complies</span></div>
<div class="line"><span class="lineno">  792</span>  <span class="comment">// with the possibility of specifying a bbox to fit the stored cells to...</span></div>
<div class="line"><span class="lineno">  793</span> </div>
<div class="line"><span class="lineno">  794</span>  <span class="keywordflow">return</span> m_tileType == NONE ? 0</div>
<div class="line"><span class="lineno">  795</span>                            : m_tileType == RGBM64 ? (m_cellsCount &lt;&lt; 11)</div>
<div class="line"><span class="lineno">  796</span>                                                   : (m_cellsCount &lt;&lt; 10);</div>
<div class="line"><span class="lineno">  797</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7fca73a70165610ef7d0ed9d67d32150" name="a7fca73a70165610ef7d0ed9d67d32150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fca73a70165610ef7d0ed9d67d32150">&#9670;&nbsp;</a></span>upload() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TCacheResource::upload </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_point_t.html">TPoint</a> &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TRasterP</a>&#160;</td>
          <td class="paramname"><em>ras</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Copies the passed tile in the tile complex. The passed tile <b>must</b> possess integer geometry (ie tile.m_pos must have integer coordinates), otherwise this function is a no-op. </p>
<div class="fragment"><div class="line"><span class="lineno">  449</span>                                                           {</div>
<div class="line"><span class="lineno">  450</span>  <span class="keywordtype">int</span> tileType;</div>
<div class="line"><span class="lineno">  451</span>  <span class="keywordflow">if</span> (!checkRasterType(ras, tileType)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>  <span class="keywordflow">if</span> (m_tileType == NONE) m_tileType = tileType;</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>  <span class="comment">// For all cells of the lattice which intersect the tile, upload the content</span></div>
<div class="line"><span class="lineno">  456</span>  <span class="comment">// in the</span></div>
<div class="line"><span class="lineno">  457</span>  <span class="comment">// complex</span></div>
<div class="line"><span class="lineno">  458</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> tileRect(ras-&gt;getBounds() + pos);</div>
<div class="line"><span class="lineno">  459</span>  <a class="code hl_class" href="class_t_point_t.html">TPoint</a> initialPos(getCellPos(tileRect.getP00()));</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>  <span class="comment">// DIAGNOSTICS_NUMBEREDSTRSET(prefix + QString::number((UINT) this) + &quot; |</span></div>
<div class="line"><span class="lineno">  462</span>  <span class="comment">// Stack | &quot;,</span></div>
<div class="line"><span class="lineno">  463</span>  <span class="comment">//&quot;crStack&quot;, &quot;upload&quot;, ::traduce(TRect(pos, ras-&gt;getSize())));</span></div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>  <a class="code hl_class" href="class_t_point_t.html">TPoint</a> currPos;</div>
<div class="line"><span class="lineno">  466</span>  <span class="keywordflow">for</span> (currPos.x = initialPos.x; currPos.x &lt;= tileRect.x1;</div>
<div class="line"><span class="lineno">  467</span>       currPos.x += latticeStep)</div>
<div class="line"><span class="lineno">  468</span>    <span class="keywordflow">for</span> (currPos.y = initialPos.y; currPos.y &lt;= tileRect.y1;</div>
<div class="line"><span class="lineno">  469</span>         currPos.y += latticeStep) {</div>
<div class="line"><span class="lineno">  470</span>      <span class="comment">// Copy tile&#39;s content into the cell&#39;s raster.</span></div>
<div class="line"><span class="lineno">  471</span>      <a class="code hl_class" href="class_t_rect_t.html">TRect</a> cellRect(currPos, <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a>(latticeStep, latticeStep));</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>      <a class="code hl_class" href="class_t_rect_t.html">TRect</a> overlapRect(tileRect * cellRect);</div>
<div class="line"><span class="lineno">  474</span>      assert(!overlapRect.isEmpty());</div>
<div class="line"><span class="lineno">  475</span> </div>
<div class="line"><span class="lineno">  476</span>      PointLess cellIndex(getCellIndex(currPos));</div>
<div class="line"><span class="lineno">  477</span>      std::pair&lt;TRasterP, CellData *&gt; cellInfos(touch(cellIndex));</div>
<div class="line"><span class="lineno">  478</span>      <a class="code hl_class" href="class_t_smart_pointer_t.html">TRasterP</a> cellRas(cellInfos.first);</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>      <a class="code hl_class" href="class_t_rect_t.html">TRect</a> temp(overlapRect - currPos);</div>
<div class="line"><span class="lineno">  481</span>      <a class="code hl_class" href="class_t_smart_pointer_t.html">TRasterP</a> overlappingCellRas(cellRas-&gt;extract(temp));</div>
<div class="line"><span class="lineno">  482</span>      temp = <a class="code hl_class" href="class_t_rect_t.html">TRect</a>(overlapRect - tileRect.getP00());</div>
<div class="line"><span class="lineno">  483</span>      <a class="code hl_class" href="class_t_smart_pointer_t.html">TRasterP</a> overlappingTileRas(ras-&gt;extract(temp));</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>      assert(overlappingCellRas-&gt;getBounds() ==</div>
<div class="line"><span class="lineno">  486</span>             overlappingTileRas-&gt;getBounds());</div>
<div class="line"><span class="lineno">  487</span>      <a class="code hl_function" href="namespace_t_rop.html#a229eb7fd85c23c325ea4ba55478d5712">TRop::copy</a>(overlappingCellRas, overlappingTileRas);</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>      cellInfos.second-&gt;m_modified = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  490</span>    }</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>  <span class="comment">// Update the complex&#39;s content region</span></div>
<div class="line"><span class="lineno">  493</span>  m_region += toQRect(tileRect);</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  496</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00093">TRop::copy()</a>, and <a class="el" href="class_t_rect_t.html#a53ce09c6112f8a019b43ad82d721a93b">TRectT&lt; T &gt;::isEmpty()</a>.</p>

</div>
</div>
<a id="a67a336e4ba0a07963f1b70eb1f9c24ab" name="a67a336e4ba0a07963f1b70eb1f9c24ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67a336e4ba0a07963f1b70eb1f9c24ab">&#9670;&nbsp;</a></span>upload() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TCacheResource::upload </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_tile.html">TTile</a> &amp;&#160;</td>
          <td class="paramname"><em>tile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  500</span>                                             {</div>
<div class="line"><span class="lineno">  501</span>  <span class="keywordflow">if</span> (!checkTile(tile)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="class_t_cache_resource.html#a7fca73a70165610ef7d0ed9d67d32150">upload</a>(<a class="code hl_class" href="class_t_point_t.html">TPoint</a>(tile.m_pos.x, tile.m_pos.y), tile.getRaster());</div>
<div class="line"><span class="lineno">  504</span>}</div>
<div class="ttc" id="aclass_t_cache_resource_html_a7fca73a70165610ef7d0ed9d67d32150"><div class="ttname"><a href="class_t_cache_resource.html#a7fca73a70165610ef7d0ed9d67d32150">TCacheResource::upload</a></div><div class="ttdeci">bool upload(const TPoint &amp;pos, TRasterP ras)</div><div class="ttdef"><b>Definition:</b> tcacheresource.cpp:449</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa12f473ea3211fff52dbf0e2bdbad1cd" name="aa12f473ea3211fff52dbf0e2bdbad1cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa12f473ea3211fff52dbf0e2bdbad1cd">&#9670;&nbsp;</a></span>uploadPalette()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TCacheResource::uploadPalette </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TPaletteP</a>&#160;</td>
          <td class="paramname"><em>palette</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  663</span>                                                    {</div>
<div class="line"><span class="lineno">  664</span>  <span class="keywordflow">if</span> (m_tileType == NONE) m_tileType = CM32;</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>  <span class="keywordflow">if</span> (m_tileType != CM32) {</div>
<div class="line"><span class="lineno">  667</span>    assert(!<span class="stringliteral">&quot;The resource already holds a non-colormap content!&quot;</span>);</div>
<div class="line"><span class="lineno">  668</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  669</span>  }</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>  m_palette = palette;</div>
<div class="line"><span class="lineno">  672</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  673</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a3d9e971014d432f33435740f298820ca" name="a3d9e971014d432f33435740f298820ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d9e971014d432f33435740f298820ca">&#9670;&nbsp;</a></span>TCacheResourceP</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="class_t_cache_resource_p.html">TCacheResourceP</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a722a517681415eb4997c6571c3c5b6b4" name="a722a517681415eb4997c6571c3c5b6b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a722a517681415eb4997c6571c3c5b6b4">&#9670;&nbsp;</a></span>TCacheResourcePool</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="class_t_cache_resource_pool.html">TCacheResourcePool</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a05cf1f35aa862c864aed074a625b9121" name="a05cf1f35aa862c864aed074a625b9121"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05cf1f35aa862c864aed074a625b9121">&#9670;&nbsp;</a></span>THDCacheResourcePool</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="class_t_h_d_cache_resource_pool.html">THDCacheResourcePool</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>E:/opentoonz/toonz/sources/include/<a class="el" href="">tcacheresource.h</a></li>
<li>E:/opentoonz/toonz/sources/common/tfx/<a class="el" href="">tcacheresource.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
