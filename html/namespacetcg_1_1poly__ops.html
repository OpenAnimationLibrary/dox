<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: tcg::poly_ops Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>tcg</b></li><li class="navelem"><a class="el" href="namespacetcg_1_1poly__ops.html">poly_ops</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">tcg::poly_ops Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Contains useful functions for operating with polynomials.  
<a href="namespacetcg_1_1poly__ops.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a70aeb5c2535d8ec2b25e2e07f79b5fc4"><td class="memTemplParams" colspan="2">template&lt;typename Scalar &gt; </td></tr>
<tr class="memitem:a70aeb5c2535d8ec2b25e2e07f79b5fc4"><td class="memTemplItemLeft" align="right" valign="top">Scalar&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetcg_1_1poly__ops.html#a70aeb5c2535d8ec2b25e2e07f79b5fc4">evaluate</a> (const Scalar poly[], int deg, Scalar x)</td></tr>
<tr class="memdesc:a70aeb5c2535d8ec2b25e2e07f79b5fc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates a polynomial using Horner's algorithm.  <a href="namespacetcg_1_1poly__ops.html#a70aeb5c2535d8ec2b25e2e07f79b5fc4">More...</a><br /></td></tr>
<tr class="separator:a70aeb5c2535d8ec2b25e2e07f79b5fc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2c0be0452e2ff8440eb337ddedd3e59"><td class="memTemplParams" colspan="2">template&lt;typename Scalar &gt; </td></tr>
<tr class="memitem:ab2c0be0452e2ff8440eb337ddedd3e59"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetcg_1_1poly__ops.html#ab2c0be0452e2ff8440eb337ddedd3e59">reduceDegree</a> (const Scalar poly[], int &amp;deg, Scalar tolerance)</td></tr>
<tr class="memdesc:ab2c0be0452e2ff8440eb337ddedd3e59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduces the degree of the input polynomial, discarding all leading coefficients whose absolute value is below the specified tolerance threshold.  <a href="namespacetcg_1_1poly__ops.html#ab2c0be0452e2ff8440eb337ddedd3e59">More...</a><br /></td></tr>
<tr class="separator:ab2c0be0452e2ff8440eb337ddedd3e59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ce6c8bcbc58bd7f994a759686a09f87"><td class="memTemplParams" colspan="2">template&lt;typename A , typename B , typename C , int deg&gt; </td></tr>
<tr class="memitem:a2ce6c8bcbc58bd7f994a759686a09f87"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetcg_1_1poly__ops.html#a2ce6c8bcbc58bd7f994a759686a09f87">add</a> (const A(&amp;poly1)[deg], const B(&amp;poly2)[deg], C(&amp;result)[deg])</td></tr>
<tr class="memdesc:a2ce6c8bcbc58bd7f994a759686a09f87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds two polynomials and returns the sum.  <a href="namespacetcg_1_1poly__ops.html#a2ce6c8bcbc58bd7f994a759686a09f87">More...</a><br /></td></tr>
<tr class="separator:a2ce6c8bcbc58bd7f994a759686a09f87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0947d0d2f6953ac9ef649b7f26f55e36"><td class="memTemplParams" colspan="2">template&lt;typename A , typename B , typename C , int deg&gt; </td></tr>
<tr class="memitem:a0947d0d2f6953ac9ef649b7f26f55e36"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetcg_1_1poly__ops.html#a0947d0d2f6953ac9ef649b7f26f55e36">sub</a> (const A(&amp;poly1)[deg], const B(&amp;poly2)[deg], C(&amp;result)[deg])</td></tr>
<tr class="memdesc:a0947d0d2f6953ac9ef649b7f26f55e36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subtracts two polynomials /p poly1 and <code>poly2</code> and returns the difference <code>poly1 - poly2</code>.  <a href="namespacetcg_1_1poly__ops.html#a0947d0d2f6953ac9ef649b7f26f55e36">More...</a><br /></td></tr>
<tr class="separator:a0947d0d2f6953ac9ef649b7f26f55e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed9052d61e84710a8a2ffa6288912e4a"><td class="memTemplParams" colspan="2">template&lt;typename A , typename B , typename C , int deg1, int deg2, int degR&gt; </td></tr>
<tr class="memitem:aed9052d61e84710a8a2ffa6288912e4a"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetcg_1_1poly__ops.html#aed9052d61e84710a8a2ffa6288912e4a">mul</a> (const A(&amp;poly1)[deg1], const B(&amp;poly2)[deg2], C(&amp;result)[degR])</td></tr>
<tr class="memdesc:aed9052d61e84710a8a2ffa6288912e4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiplies two polynomials into a polynomial whose degree is the <em>sum</em> of the multiplicands' degrees.  <a href="namespacetcg_1_1poly__ops.html#aed9052d61e84710a8a2ffa6288912e4a">More...</a><br /></td></tr>
<tr class="separator:aed9052d61e84710a8a2ffa6288912e4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4299a9653d24554e97e3e75a34dfeef"><td class="memTemplParams" colspan="2">template&lt;typename A , typename B , typename C , int deg1, int deg2, int degR&gt; </td></tr>
<tr class="memitem:ad4299a9653d24554e97e3e75a34dfeef"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetcg_1_1poly__ops.html#ad4299a9653d24554e97e3e75a34dfeef">chain</a> (const A(&amp;poly1)[deg1], const B(&amp;poly2)[deg2], C(&amp;result)[degR])</td></tr>
<tr class="memdesc:ad4299a9653d24554e97e3e75a34dfeef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the chaining <code>poly1 o poly2</code> of two given polynomial <code>poly1</code> and <code>poly2</code>.  <a href="namespacetcg_1_1poly__ops.html#ad4299a9653d24554e97e3e75a34dfeef">More...</a><br /></td></tr>
<tr class="separator:ad4299a9653d24554e97e3e75a34dfeef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e0e986308336fb6fcd67f141a2e21c8"><td class="memTemplParams" colspan="2">template&lt;typename A , typename B , int deg, int degR&gt; </td></tr>
<tr class="memitem:a0e0e986308336fb6fcd67f141a2e21c8"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetcg_1_1poly__ops.html#a0e0e986308336fb6fcd67f141a2e21c8">derivative</a> (const A(&amp;poly)[deg], B(&amp;result)[degR])</td></tr>
<tr class="separator:a0e0e986308336fb6fcd67f141a2e21c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa241ac7ed1e6875500825065ac00bb40"><td class="memTemplParams" colspan="2">template&lt;typename Scalar &gt; </td></tr>
<tr class="memitem:aa241ac7ed1e6875500825065ac00bb40"><td class="memTemplItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetcg_1_1poly__ops.html#aa241ac7ed1e6875500825065ac00bb40">solve_1</a> (Scalar c[2], Scalar s[1], Scalar tol=0)</td></tr>
<tr class="memdesc:aa241ac7ed1e6875500825065ac00bb40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the 1st degree equation: $c[1] t + c[0] = 0$.  <a href="namespacetcg_1_1poly__ops.html#aa241ac7ed1e6875500825065ac00bb40">More...</a><br /></td></tr>
<tr class="separator:aa241ac7ed1e6875500825065ac00bb40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d0ee1f8b032593a7fad7ef97dc9e14b"><td class="memTemplParams" colspan="2">template&lt;typename Scalar &gt; </td></tr>
<tr class="memitem:a2d0ee1f8b032593a7fad7ef97dc9e14b"><td class="memTemplItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetcg_1_1poly__ops.html#a2d0ee1f8b032593a7fad7ef97dc9e14b">solve_2</a> (Scalar c[3], Scalar s[2], Scalar tol=0)</td></tr>
<tr class="memdesc:a2d0ee1f8b032593a7fad7ef97dc9e14b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the 2nd degree equation: $c[2] t^2 + c[1] t + c[0] = 0$.  <a href="namespacetcg_1_1poly__ops.html#a2d0ee1f8b032593a7fad7ef97dc9e14b">More...</a><br /></td></tr>
<tr class="separator:a2d0ee1f8b032593a7fad7ef97dc9e14b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef47a1bb2cd66679b420dc8bff023ba5"><td class="memTemplParams" colspan="2">template&lt;typename Scalar &gt; </td></tr>
<tr class="memitem:aef47a1bb2cd66679b420dc8bff023ba5"><td class="memTemplItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetcg_1_1poly__ops.html#aef47a1bb2cd66679b420dc8bff023ba5">solve_3</a> (Scalar c[4], Scalar s[3], Scalar tol=0)</td></tr>
<tr class="memdesc:aef47a1bb2cd66679b420dc8bff023ba5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the 3rd degree equation: $c[3]t^3 + c[2] t^2 + c[1] t + c[0] = 0$.  <a href="namespacetcg_1_1poly__ops.html#aef47a1bb2cd66679b420dc8bff023ba5">More...</a><br /></td></tr>
<tr class="separator:aef47a1bb2cd66679b420dc8bff023ba5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Contains useful functions for operating with polynomials. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a2ce6c8bcbc58bd7f994a759686a09f87" name="a2ce6c8bcbc58bd7f994a759686a09f87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ce6c8bcbc58bd7f994a759686a09f87">&#9670;&nbsp;</a></span>add()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename A , typename B , typename C , int deg&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void tcg::poly_ops::add </td>
          <td>(</td>
          <td class="paramtype">const A(&amp;)&#160;</td>
          <td class="paramname"><em>poly1</em>[deg], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const B(&amp;)&#160;</td>
          <td class="paramname"><em>poly2</em>[deg], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">C(&amp;)&#160;</td>
          <td class="paramname"><em>result</em>[deg]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds two polynomials and returns the sum. </p>
<dl class="section remark"><dt>Remarks</dt><dd>The supplied polynomials can actually be the same. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">poly1</td><td>First polynomial addendum. </td></tr>
    <tr><td class="paramname">poly2</td><td>Second polynomial addendum. </td></tr>
    <tr><td class="paramname">result</td><td>Resulting sum. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">   69</span>{</div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d != deg; ++d) result[d] = poly1[d] + poly2[d];</div>
<div class="line"><span class="lineno">   71</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4299a9653d24554e97e3e75a34dfeef" name="ad4299a9653d24554e97e3e75a34dfeef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4299a9653d24554e97e3e75a34dfeef">&#9670;&nbsp;</a></span>chain()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename A , typename B , typename C , int deg1, int deg2, int degR&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void tcg::poly_ops::chain </td>
          <td>(</td>
          <td class="paramtype">const A(&amp;)&#160;</td>
          <td class="paramname"><em>poly1</em>[deg1], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const B(&amp;)&#160;</td>
          <td class="paramname"><em>poly2</em>[deg2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">C(&amp;)&#160;</td>
          <td class="paramname"><em>result</em>[degR]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the chaining <code>poly1 o poly2</code> of two given polynomial <code>poly1</code> and <code>poly2</code>. </p>
<dl class="section warning"><dt>Warning</dt><dd>The resulting polynomial is currently <b>not allowed</b> to be one of the multiplicands. </dd>
<dd>
This function is still <b>untested</b>. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">poly1</td><td>First polynomial. </td></tr>
    <tr><td class="paramname">poly2</td><td>Second polynomial. </td></tr>
    <tr><td class="paramname">result</td><td>Resulting polynomial. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  123</span>{</div>
<div class="line"><span class="lineno">  124</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a = 0; a != deg1; ++a) {</div>
<div class="line"><span class="lineno">  125</span>    B pow[degR][2] = {{}};</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    <span class="comment">// Build poly2 powers</span></div>
<div class="line"><span class="lineno">  128</span>    {</div>
<div class="line"><span class="lineno">  129</span>      std::copy(poly2, poly2 + deg2, pow[1]);</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 1; p &lt; a; ++p) poly_mul(pow[p % 2], poly2, pow[(p + 1) % 2]);</div>
<div class="line"><span class="lineno">  132</span>    }</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>    B(&amp;pow_add)[degR] = pow[a % 2];</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    <span class="comment">// multiply by poly1[a]</span></div>
<div class="line"><span class="lineno">  137</span>    C addendum[degR];</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c != degR; ++c) addendum[c] = poly1[c] * pow_add[c];</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>    poly_add(addendum, result);</div>
<div class="line"><span class="lineno">  142</span>  }</div>
<div class="line"><span class="lineno">  143</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e0e986308336fb6fcd67f141a2e21c8" name="a0e0e986308336fb6fcd67f141a2e21c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e0e986308336fb6fcd67f141a2e21c8">&#9670;&nbsp;</a></span>derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename A , typename B , int deg, int degR&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void tcg::poly_ops::derivative </td>
          <td>(</td>
          <td class="paramtype">const A(&amp;)&#160;</td>
          <td class="paramname"><em>poly</em>[deg], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">B(&amp;)&#160;</td>
          <td class="paramname"><em>result</em>[degR]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">poly</td><td>Polynomial to be derived. </td></tr>
    <tr><td class="paramname">result</td><td>Resulting derivative polynomial. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  150</span>{</div>
<div class="line"><span class="lineno">  151</span>  <a class="code hl_define" href="macros_8h.html#afb05acd7751b0243f9571b72e13b29cc">TCG_STATIC_ASSERT</a>(degR == deg - 1);</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 1; c != deg; ++c) result[c - 1] = c * poly[c];</div>
<div class="line"><span class="lineno">  154</span>}</div>
<div class="ttc" id="amacros_8h_html_afb05acd7751b0243f9571b72e13b29cc"><div class="ttname"><a href="macros_8h.html#afb05acd7751b0243f9571b72e13b29cc">TCG_STATIC_ASSERT</a></div><div class="ttdeci">#define TCG_STATIC_ASSERT(expr)</div><div class="ttdoc">Performs a compile-time check of the specified assertion.</div><div class="ttdef"><b>Definition:</b> macros.h:70</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00070">TCG_STATIC_ASSERT</a>.</p>

</div>
</div>
<a id="a70aeb5c2535d8ec2b25e2e07f79b5fc4" name="a70aeb5c2535d8ec2b25e2e07f79b5fc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70aeb5c2535d8ec2b25e2e07f79b5fc4">&#9670;&nbsp;</a></span>evaluate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Scalar tcg::poly_ops::evaluate </td>
          <td>(</td>
          <td class="paramtype">const Scalar&#160;</td>
          <td class="paramname"><em>poly</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>deg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates a polynomial using Horner's algorithm. </p>
<dl class="section return"><dt>Returns</dt><dd>The value of the input polynomial at the specified parameter </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">poly</td><td>Coefficients of the input polynomial, indexed by degree </td></tr>
    <tr><td class="paramname">deg</td><td>Degree of the polynomial function </td></tr>
    <tr><td class="paramname">x</td><td>Parameter the polynomial will be evaluated on </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">   34</span>{</div>
<div class="line"><span class="lineno">   35</span>  <span class="comment">// ((poly[deg] * x) + poly[deg-1]) * x + poly[deg - 2] + ...</span></div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>  Scalar value = poly[deg];</div>
<div class="line"><span class="lineno">   38</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = deg - 1; d &gt;= 0; --d) value = value * x + poly[d];</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>  <span class="keywordflow">return</span> value;</div>
<div class="line"><span class="lineno">   41</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed9052d61e84710a8a2ffa6288912e4a" name="aed9052d61e84710a8a2ffa6288912e4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed9052d61e84710a8a2ffa6288912e4a">&#9670;&nbsp;</a></span>mul()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename A , typename B , typename C , int deg1, int deg2, int degR&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void tcg::poly_ops::mul </td>
          <td>(</td>
          <td class="paramtype">const A(&amp;)&#160;</td>
          <td class="paramname"><em>poly1</em>[deg1], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const B(&amp;)&#160;</td>
          <td class="paramname"><em>poly2</em>[deg2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">C(&amp;)&#160;</td>
          <td class="paramname"><em>result</em>[degR]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Multiplies two polynomials into a polynomial whose degree is the <em>sum</em> of the multiplicands' degrees. </p>
<dl class="section warning"><dt>Warning</dt><dd>The resulting polynomial is currently <b>not allowed</b> to be one of the multiplicands. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">poly1</td><td>First multiplicand. </td></tr>
    <tr><td class="paramname">poly2</td><td>Second multiplicand. </td></tr>
    <tr><td class="paramname">result</td><td>Resulting polynomial. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  100</span>{</div>
<div class="line"><span class="lineno">  101</span>  <a class="code hl_define" href="macros_8h.html#afb05acd7751b0243f9571b72e13b29cc">TCG_STATIC_ASSERT</a>(degR == deg1 + deg2 - 1);</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a = 0; a != deg1; ++a) {</div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b != deg2; ++b) result[a + b] += poly1[a] * poly2[b];</div>
<div class="line"><span class="lineno">  105</span>  }</div>
<div class="line"><span class="lineno">  106</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00070">TCG_STATIC_ASSERT</a>.</p>

</div>
</div>
<a id="ab2c0be0452e2ff8440eb337ddedd3e59" name="ab2c0be0452e2ff8440eb337ddedd3e59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2c0be0452e2ff8440eb337ddedd3e59">&#9670;&nbsp;</a></span>reduceDegree()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void tcg::poly_ops::reduceDegree </td>
          <td>(</td>
          <td class="paramtype">const Scalar&#160;</td>
          <td class="paramname"><em>poly</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>deg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>tolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reduces the degree of the input polynomial, discarding all leading coefficients whose absolute value is below the specified tolerance threshold. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">poly</td><td>Input polynomial to be reduced. </td></tr>
    <tr><td class="paramname">deg</td><td>Input/output polynomial degree. </td></tr>
    <tr><td class="paramname">tolerance</td><td>Coefficients threshold to reduce the polynomial with. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">   55</span>      {</div>
<div class="line"><span class="lineno">   56</span>  <span class="keywordflow">while</span> ((deg &gt; 0) &amp;&amp; (std::abs(poly[deg]) &lt; tolerance)) --deg;</div>
<div class="line"><span class="lineno">   57</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa241ac7ed1e6875500825065ac00bb40" name="aa241ac7ed1e6875500825065ac00bb40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa241ac7ed1e6875500825065ac00bb40">&#9670;&nbsp;</a></span>solve_1()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int tcg::poly_ops::solve_1 </td>
          <td>(</td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>c</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>s</em>[1], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>tol</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solves the 1st degree equation: $c[1] t + c[0] = 0$. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of solutions found under the specified divide-by tolerance </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>Polynomial coefficients array </td></tr>
    <tr><td class="paramname">s</td><td>Solutions array </td></tr>
    <tr><td class="paramname">tol</td><td>Leading coefficient tolerance, the equation has no solution if the leading coefficient is below this threshold </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  170</span>{</div>
<div class="line"><span class="lineno">  171</span>  <span class="keywordflow">if</span> (std::abs(c[1]) &lt;= tol) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>  s[0] = -c[0] / c[1];</div>
<div class="line"><span class="lineno">  174</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  175</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="#l00187">solve_2()</a>.</p>

</div>
</div>
<a id="a2d0ee1f8b032593a7fad7ef97dc9e14b" name="a2d0ee1f8b032593a7fad7ef97dc9e14b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d0ee1f8b032593a7fad7ef97dc9e14b">&#9670;&nbsp;</a></span>solve_2()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned int tcg::poly_ops::solve_2 </td>
          <td>(</td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>c</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>s</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>tol</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves the 2nd degree equation: $c[2] t^2 + c[1] t + c[0] = 0$. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of #real# solutions found under the specified divide-by tolerance</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>The returned solutions are sorted, with $s[0] &lt;= s[1]$ </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>Polynomial coefficients array </td></tr>
    <tr><td class="paramname">s</td><td>Solutions array </td></tr>
    <tr><td class="paramname">tol</td><td>Leading coefficient tolerance, the equation has no solution if the leading coefficient is below this threshold </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  193</span>{</div>
<div class="line"><span class="lineno">  194</span>  <span class="keywordflow">if</span> (std::abs(c[2]) &lt;= tol)</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacetcg_1_1poly__ops.html#aa241ac7ed1e6875500825065ac00bb40">solve_1</a>(c, s, tol);  <span class="comment">// Reduces to first degree</span></div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>  Scalar nc[2] = {</div>
<div class="line"><span class="lineno">  198</span>      c[0] / c[2],</div>
<div class="line"><span class="lineno">  199</span>      c[1] / (c[2] + c[2])};  <span class="comment">// NOTE: nc[1] gets further divided by 2</span></div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>  Scalar delta = nc[1] * nc[1] - nc[0];</div>
<div class="line"><span class="lineno">  202</span>  <span class="keywordflow">if</span> (delta &lt; 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>  delta = sqrt(delta);</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>  s[0] = -delta - nc[1];</div>
<div class="line"><span class="lineno">  207</span>  s[1] = delta - nc[1];</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>  <span class="keywordflow">return</span> 2;</div>
<div class="line"><span class="lineno">  210</span>}</div>
<div class="ttc" id="anamespacetcg_1_1poly__ops_html_aa241ac7ed1e6875500825065ac00bb40"><div class="ttname"><a href="namespacetcg_1_1poly__ops.html#aa241ac7ed1e6875500825065ac00bb40">tcg::poly_ops::solve_1</a></div><div class="ttdeci">unsigned int solve_1(Scalar c[2], Scalar s[1], Scalar tol=0)</div><div class="ttdoc">Solves the 1st degree equation: $c[1] t + c[0] = 0$.</div><div class="ttdef"><b>Definition:</b> poly_ops.h:164</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00164">solve_1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="#l00223">solve_3()</a>.</p>

</div>
</div>
<a id="aef47a1bb2cd66679b420dc8bff023ba5" name="aef47a1bb2cd66679b420dc8bff023ba5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef47a1bb2cd66679b420dc8bff023ba5">&#9670;&nbsp;</a></span>solve_3()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned int tcg::poly_ops::solve_3 </td>
          <td>(</td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>c</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>s</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>tol</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves the 3rd degree equation: $c[3]t^3 + c[2] t^2 + c[1] t + c[0] = 0$. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of #real# solutions found under the specified divide-by tolerance</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>The returned solutions are sorted, with $s[0] &lt;= s[1] &lt;= s[2]$ if the leading coefficient is below this threshold </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>Polynomial coefficients array </td></tr>
    <tr><td class="paramname">s</td><td>Solutions array </td></tr>
    <tr><td class="paramname">tol</td><td>Leading coefficient tolerance, the equation is reduced to 2nd degree </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  228</span>{</div>
<div class="line"><span class="lineno">  229</span>  <span class="keywordflow">if</span> (std::abs(c[3]) &lt;= tol)</div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacetcg_1_1poly__ops.html#a2d0ee1f8b032593a7fad7ef97dc9e14b">solve_2</a>(c, s, tol);  <span class="comment">// Reduces to second degree</span></div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>  Scalar nc[3] = {c[0] / c[3], c[1] / c[3], c[2] / c[3]};</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>  Scalar b2     = nc[2] * nc[2];</div>
<div class="line"><span class="lineno">  235</span>  Scalar p      = nc[1] - b2 / 3;</div>
<div class="line"><span class="lineno">  236</span>  Scalar q      = nc[2] * (b2 + b2 - 9 * nc[1]) / 27 + nc[0];</div>
<div class="line"><span class="lineno">  237</span>  Scalar p3     = p * p * p;</div>
<div class="line"><span class="lineno">  238</span>  Scalar d      = q * q + 4 * p3 / 27;</div>
<div class="line"><span class="lineno">  239</span>  Scalar offset = -nc[2] / 3;</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>  <span class="keywordflow">if</span> (d &gt;= 0) {</div>
<div class="line"><span class="lineno">  242</span>    <span class="comment">// Single solution</span></div>
<div class="line"><span class="lineno">  243</span>    Scalar z = sqrt(d);</div>
<div class="line"><span class="lineno">  244</span>    Scalar u = (-q + z) / 2;</div>
<div class="line"><span class="lineno">  245</span>    Scalar v = (-q - z) / 2;</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    u = (u &lt; 0) ? -pow(-u, 1 / Scalar(3)) : pow(u, 1 / Scalar(3));</div>
<div class="line"><span class="lineno">  248</span>    v = (v &lt; 0) ? -pow(-v, 1 / Scalar(3)) : pow(v, 1 / Scalar(3));</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>    s[0] = offset + u + v;</div>
<div class="line"><span class="lineno">  251</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  252</span>  }</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>  assert(p3 &lt; 0);</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>  Scalar u = sqrt(-p / Scalar(3));</div>
<div class="line"><span class="lineno">  257</span>  Scalar v = acos(-sqrt(-27 / p3) * q / Scalar(2)) / Scalar(3);</div>
<div class="line"><span class="lineno">  258</span>  Scalar m = cos(v), n = sin(v) * 1.7320508075688772935274463415059;  <span class="comment">// sqrt(3)</span></div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>  s[0] = offset - u * (n + m);</div>
<div class="line"><span class="lineno">  261</span>  s[1] = offset + u * (n - m);</div>
<div class="line"><span class="lineno">  262</span>  s[2] = offset + u * (m + m);</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>  assert(s[0] &lt;= s[1] &amp;&amp; s[1] &lt;= s[2]);</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>  <span class="keywordflow">return</span> 3;</div>
<div class="line"><span class="lineno">  267</span>}</div>
<div class="ttc" id="anamespacetcg_1_1poly__ops_html_a2d0ee1f8b032593a7fad7ef97dc9e14b"><div class="ttname"><a href="namespacetcg_1_1poly__ops.html#a2d0ee1f8b032593a7fad7ef97dc9e14b">tcg::poly_ops::solve_2</a></div><div class="ttdeci">unsigned int solve_2(Scalar c[3], Scalar s[2], Scalar tol=0)</div><div class="ttdoc">Solves the 2nd degree equation: $c[2] t^2 + c[1] t + c[0] = 0$.</div><div class="ttdef"><b>Definition:</b> poly_ops.h:187</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00187">solve_2()</a>.</p>

</div>
</div>
<a id="a0947d0d2f6953ac9ef649b7f26f55e36" name="a0947d0d2f6953ac9ef649b7f26f55e36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0947d0d2f6953ac9ef649b7f26f55e36">&#9670;&nbsp;</a></span>sub()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename A , typename B , typename C , int deg&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void tcg::poly_ops::sub </td>
          <td>(</td>
          <td class="paramtype">const A(&amp;)&#160;</td>
          <td class="paramname"><em>poly1</em>[deg], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const B(&amp;)&#160;</td>
          <td class="paramname"><em>poly2</em>[deg], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">C(&amp;)&#160;</td>
          <td class="paramname"><em>result</em>[deg]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subtracts two polynomials /p poly1 and <code>poly2</code> and returns the difference <code>poly1 - poly2</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">poly1</td><td>First polynomial addendum. </td></tr>
    <tr><td class="paramname">poly2</td><td>Second polynomial addendum. </td></tr>
    <tr><td class="paramname">result</td><td>Resulting difference. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">   83</span>{</div>
<div class="line"><span class="lineno">   84</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d != deg; ++d) result[d] = poly1[d] - poly2[d];</div>
<div class="line"><span class="lineno">   85</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
