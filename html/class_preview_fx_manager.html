<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: PreviewFxManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#signals">Signals</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-slots">Protected Slots</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="class_preview_fx_manager-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PreviewFxManager Class Reference<span class="mlabels"><span class="mlabel">final</span></span></div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="">previewfxmanager.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PreviewFxManager:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_preview_fx_manager.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="signals" name="signals"></a>
Signals</h2></td></tr>
<tr class="memitem:a9b42e8da3aa5c3e5fbff0f550d233570"><td class="memItemLeft" align="right" valign="top"><a id="a9b42e8da3aa5c3e5fbff0f550d233570" name="a9b42e8da3aa5c3e5fbff0f550d233570"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>startedFrame</b> (unsigned long fxId, <a class="el" href="struct_t_render_port_1_1_render_data.html">TRenderPort::RenderData</a> renderData)</td></tr>
<tr class="separator:a9b42e8da3aa5c3e5fbff0f550d233570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52184e69bb26182aa60c87ef25c8ee6d"><td class="memItemLeft" align="right" valign="top"><a id="a52184e69bb26182aa60c87ef25c8ee6d" name="a52184e69bb26182aa60c87ef25c8ee6d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>renderedFrame</b> (unsigned long fxId, <a class="el" href="struct_t_render_port_1_1_render_data.html">TRenderPort::RenderData</a> renderData)</td></tr>
<tr class="separator:a52184e69bb26182aa60c87ef25c8ee6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e6b2668ed1fcc6e8e3b28c61771b059"><td class="memItemLeft" align="right" valign="top"><a id="a3e6b2668ed1fcc6e8e3b28c61771b059" name="a3e6b2668ed1fcc6e8e3b28c61771b059"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>refreshViewRects</b> (unsigned long fxId)</td></tr>
<tr class="separator:a3e6b2668ed1fcc6e8e3b28c61771b059"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5a633f9f858d2ea0e6ccee709d495b74"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_flip_book.html">FlipBook</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a5a633f9f858d2ea0e6ccee709d495b74">showNewPreview</a> (<a class="el" href="class_t_smart_pointer_t.html">TFxP</a> fx, bool forceFlipbook=false)</td></tr>
<tr class="separator:a5a633f9f858d2ea0e6ccee709d495b74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20c15e33d5294fb7644af987745d395b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a20c15e33d5294fb7644af987745d395b">refreshView</a> (<a class="el" href="class_t_smart_pointer_t.html">TFxP</a> fx)</td></tr>
<tr class="memdesc:a20c15e33d5294fb7644af987745d395b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the fx's preview on the associated flipbooks' current views.  <a href="class_preview_fx_manager.html#a20c15e33d5294fb7644af987745d395b">More...</a><br /></td></tr>
<tr class="separator:a20c15e33d5294fb7644af987745d395b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6878f95e1fe7332a1b8654d9fe75e2a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a6878f95e1fe7332a1b8654d9fe75e2a0">detach</a> (<a class="el" href="class_flip_book.html">FlipBook</a> *flipbook)</td></tr>
<tr class="separator:a6878f95e1fe7332a1b8654d9fe75e2a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad87d57fda744ab77992cd27d16b938d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#ad87d57fda744ab77992cd27d16b938d9">freeze</a> (<a class="el" href="class_flip_book.html">FlipBook</a> *flipbook)</td></tr>
<tr class="memdesc:ad87d57fda744ab77992cd27d16b938d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Freezes the specified flipbook.  <a href="class_preview_fx_manager.html#ad87d57fda744ab77992cd27d16b938d9">More...</a><br /></td></tr>
<tr class="separator:ad87d57fda744ab77992cd27d16b938d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8064084ad56427682cbf63bda46708"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a3a8064084ad56427682cbf63bda46708">unfreeze</a> (<a class="el" href="class_flip_book.html">FlipBook</a> *flipbook)</td></tr>
<tr class="separator:a3a8064084ad56427682cbf63bda46708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cf458cfc0955a610007cb537638d592"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a3cf458cfc0955a610007cb537638d592">reset</a> (<a class="el" href="class_t_smart_pointer_t.html">TFxP</a> fx)</td></tr>
<tr class="separator:a3cf458cfc0955a610007cb537638d592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e9f7dec7025ae3ab51734dbe8efe676"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a0e9f7dec7025ae3ab51734dbe8efe676">reset</a> (bool detachFlipbooks=true)</td></tr>
<tr class="memdesc:a0e9f7dec7025ae3ab51734dbe8efe676"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the <a class="el" href="class_preview_fx_manager.html">PreviewFxManager</a> together with all internal rendering objects.  <a href="class_preview_fx_manager.html#a0e9f7dec7025ae3ab51734dbe8efe676">More...</a><br /></td></tr>
<tr class="separator:a0e9f7dec7025ae3ab51734dbe8efe676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76b7231f43b848e03de56425fe6d9e78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a76b7231f43b848e03de56425fe6d9e78">reset</a> (<a class="el" href="class_t_smart_pointer_t.html">TFxP</a> fx, int frame)</td></tr>
<tr class="separator:a76b7231f43b848e03de56425fe6d9e78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4156d45683027be3ba3f1d9bcb76641a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a4156d45683027be3ba3f1d9bcb76641a">isSubCameraActive</a> (<a class="el" href="class_t_smart_pointer_t.html">TFxP</a> fx)</td></tr>
<tr class="separator:a4156d45683027be3ba3f1d9bcb76641a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a540923ef1e799396ddf8bba11bb3c8c6"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_preview_fx_manager.html">PreviewFxManager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a540923ef1e799396ddf8bba11bb3c8c6">instance</a> ()</td></tr>
<tr class="memdesc:a540923ef1e799396ddf8bba11bb3c8c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the instance of the <a class="el" href="class_preview_fx_manager.html">PreviewFxManager</a> object.  <a href="class_preview_fx_manager.html#a540923ef1e799396ddf8bba11bb3c8c6">More...</a><br /></td></tr>
<tr class="separator:a540923ef1e799396ddf8bba11bb3c8c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c365dff55ec1d15552c50a10961ea2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a69c365dff55ec1d15552c50a10961ea2">suspendRendering</a> (bool suspend)</td></tr>
<tr class="separator:a69c365dff55ec1d15552c50a10961ea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-slots" name="pro-slots"></a>
Protected Slots</h2></td></tr>
<tr class="memitem:a85f16d9fc52b7f8aa1107820edc7c577"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a85f16d9fc52b7f8aa1107820edc7c577">onLevelChanged</a> ()</td></tr>
<tr class="separator:a85f16d9fc52b7f8aa1107820edc7c577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accbd0bf1cf5db637b9061dbc2a351f5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#accbd0bf1cf5db637b9061dbc2a351f5f">onFxChanged</a> ()</td></tr>
<tr class="separator:accbd0bf1cf5db637b9061dbc2a351f5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8943baba2266000556d3ce8341d2f22b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a8943baba2266000556d3ce8341d2f22b">onXsheetChanged</a> ()</td></tr>
<tr class="separator:a8943baba2266000556d3ce8341d2f22b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab98667688dfdfa1ef71dcb1a21f094af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#ab98667688dfdfa1ef71dcb1a21f094af">onObjectChanged</a> (bool isDragging)</td></tr>
<tr class="separator:ab98667688dfdfa1ef71dcb1a21f094af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6048e5a20b905a5f52f89e43a24c7c58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a6048e5a20b905a5f52f89e43a24c7c58">onStartedFrame</a> (unsigned long fxId, <a class="el" href="struct_t_render_port_1_1_render_data.html">TRenderPort::RenderData</a> renderData)</td></tr>
<tr class="separator:a6048e5a20b905a5f52f89e43a24c7c58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a752299d7f319eb3b00d3e2f4b328f6a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a752299d7f319eb3b00d3e2f4b328f6a0">onRenderedFrame</a> (unsigned long fxId, <a class="el" href="struct_t_render_port_1_1_render_data.html">TRenderPort::RenderData</a> renderData)</td></tr>
<tr class="separator:a752299d7f319eb3b00d3e2f4b328f6a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ff213fc7a8578c760139a1b3e8a58a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#a5ff213fc7a8578c760139a1b3e8a58a7">onRefreshViewRects</a> (unsigned long id)</td></tr>
<tr class="separator:a5ff213fc7a8578c760139a1b3e8a58a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:abe94a88f2ecb81d57a14b8fed98e91c7"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preview_fx_manager.html#abe94a88f2ecb81d57a14b8fed98e91c7">PreviewFxInstance</a></td></tr>
<tr class="separator:abe94a88f2ecb81d57a14b8fed98e91c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Manages the 'Preview Fx' requests and updates all contextually opened FlipBooks when needed. The class provides the medium between the 'Preview Fx' command and management of both Toonz rendering classes and Flipbooks. <br  />
 <br  />
The <a class="el" href="class_preview_fx_manager.html#a5a633f9f858d2ea0e6ccee709d495b74">showNewPreview()</a> method invocation takes place when users activate the 'Preview' command from the right-click menu of fxs in the schematic. It initializes a <a class="el" href="class_t_renderer.html">TRenderer</a> object and starts the render of passed fx over the preview properties range; at the same time, a new Flipbook is opened to visualize the images produced by the render process as frames are finalized. <br  />
 <br  />
The <a class="el" href="class_preview_fx_manager.html#a20c15e33d5294fb7644af987745d395b" title="Updates the fx&#39;s preview on the associated flipbooks&#39; current views.">refreshView()</a> command is available to update an fx's view upon request (this is typically handled by flipbooks). The manager always renders the area strictly necessary to correctly update all flipbooks' current view; in particular, previously rendered portions of flipbook views are retained, and excluded from further calculations. <br  />
Observe that invalidation signals coming from <a class="el" href="class_t_xsh_level_handle.html">TXshLevelHandle</a>, <a class="el" href="class_t_fx_handle.html">TFxHandle</a> and <a class="el" href="class_t_xsheet_handle.html">TXsheetHandle</a> classes are automatically intercepted to update all FlipBooks created under the manager. <br  />
 <br  />
Additional <a class="el" href="class_preview_fx_manager.html#a3cf458cfc0955a610007cb537638d592">reset()</a> methods are available to clear the manager about a single fx or the whole scene's fxs.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="class_flip_book.html" title="The FlipBook class provides to view level images.">FlipBook</a>, <a class="el" href="class_t_xsh_level_handle.html">TXshLevelHandle</a>, <a class="el" href="class_t_fx_handle.html">TFxHandle</a>, <a class="el" href="class_t_xsheet_handle.html">TXsheetHandle</a> classes. </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a6878f95e1fe7332a1b8654d9fe75e2a0" name="a6878f95e1fe7332a1b8654d9fe75e2a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6878f95e1fe7332a1b8654d9fe75e2a0">&#9670;&nbsp;</a></span>detach()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::detach </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_flip_book.html">FlipBook</a> *&#160;</td>
          <td class="paramname"><em>flipbook</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Detaches the specified flipbook from the manager's control. Optionally, the flipbooks may keep the already previewed images instead of discarding them - however, observe that these images may be <b>cloned</b> from the preview originals, in case some flipbook is still actively previewing the same fx. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1418</span>                                                {</div>
<div class="line"><span class="lineno"> 1419</span>  <span class="comment">// Retrieve its previewed fx</span></div>
<div class="line"><span class="lineno"> 1420</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> fx(flipbook-&gt;getPreviewedFx());</div>
<div class="line"><span class="lineno"> 1421</span>  <span class="keywordflow">if</span> (!fx) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1422</span> </div>
<div class="line"><span class="lineno"> 1423</span>  <span class="comment">// Search the flip among attached ones</span></div>
<div class="line"><span class="lineno"> 1424</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1425</span>      m_previewInstances.find(fx-&gt;getIdentifier());</div>
<div class="line"><span class="lineno"> 1426</span>  <span class="keywordflow">if</span> (it == m_previewInstances.end()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1427</span> </div>
<div class="line"><span class="lineno"> 1428</span>  <a class="code hl_class" href="class_preview_fx_instance.html">PreviewFxInstance</a> *previewInstance = it.value();</div>
<div class="line"><span class="lineno"> 1429</span> </div>
<div class="line"><span class="lineno"> 1430</span>  <span class="comment">// Detach the flipbook (does nothing if flipbook is frozen)</span></div>
<div class="line"><span class="lineno"> 1431</span>  previewInstance-&gt;detachFlipbook(flipbook);</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>  <span class="comment">// Eventually, it could be in frozens; detach it from there too</span></div>
<div class="line"><span class="lineno"> 1434</span>  std::set&lt;FlipBook *&gt; &amp;frozenFlips = previewInstance-&gt;m_frozenFlips;</div>
<div class="line"><span class="lineno"> 1435</span> </div>
<div class="line"><span class="lineno"> 1436</span>  std::set&lt;FlipBook *&gt;::iterator jt = frozenFlips.find(flipbook);</div>
<div class="line"><span class="lineno"> 1437</span>  <span class="keywordflow">if</span> (jt != frozenFlips.end()) {</div>
<div class="line"><span class="lineno"> 1438</span>    flipbook-&gt;clearCache();</div>
<div class="line"><span class="lineno"> 1439</span>    <span class="keyword">delete</span> flipbook-&gt;getProgressBarStatus();</div>
<div class="line"><span class="lineno"> 1440</span>    frozenFlips.erase(jt);</div>
<div class="line"><span class="lineno"> 1441</span>  }</div>
<div class="line"><span class="lineno"> 1442</span> </div>
<div class="line"><span class="lineno"> 1443</span>  <span class="comment">// Finally, delete the preview instance if no flipbook (active or frozen)</span></div>
<div class="line"><span class="lineno"> 1444</span>  <span class="comment">// remain</span></div>
<div class="line"><span class="lineno"> 1445</span>  <span class="keywordflow">if</span> (previewInstance-&gt;m_flipbooks.empty() &amp;&amp;</div>
<div class="line"><span class="lineno"> 1446</span>      previewInstance-&gt;m_frozenFlips.empty()) {</div>
<div class="line"><span class="lineno"> 1447</span>    <span class="keyword">delete</span> it.value();</div>
<div class="line"><span class="lineno"> 1448</span>    m_previewInstances.erase(it);</div>
<div class="line"><span class="lineno"> 1449</span>  }</div>
<div class="line"><span class="lineno"> 1450</span>}</div>
<div class="ttc" id="aclass_preview_fx_instance_html"><div class="ttname"><a href="class_preview_fx_instance.html">PreviewFxInstance</a></div><div class="ttdef"><b>Definition:</b> previewfxmanager.cpp:174</div></div>
<div class="ttc" id="aclass_t_smart_pointer_t_html"><div class="ttname"><a href="class_t_smart_pointer_t.html">TSmartPointerT&lt; TFx &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad87d57fda744ab77992cd27d16b938d9" name="ad87d57fda744ab77992cd27d16b938d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad87d57fda744ab77992cd27d16b938d9">&#9670;&nbsp;</a></span>freeze()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::freeze </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_flip_book.html">FlipBook</a> *&#160;</td>
          <td class="paramname"><em>flipbook</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Freezes the specified flipbook. </p>
<p >Observe that detached flipbooks which maintain the previewed images also maintain the internal reference to the previewed fx returned by the FlipBook::getPreviewedFx() method, so the flipbook may be re-attached (ie un-freezed) to the same preview fx. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1360</span>                                                {</div>
<div class="line"><span class="lineno"> 1361</span>  <span class="comment">// Retrieve its previewed fx</span></div>
<div class="line"><span class="lineno"> 1362</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> fx(flipbook-&gt;getPreviewedFx());</div>
<div class="line"><span class="lineno"> 1363</span>  <span class="keywordflow">if</span> (!fx) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1364</span> </div>
<div class="line"><span class="lineno"> 1365</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1366</span>      m_previewInstances.find(fx-&gt;getIdentifier());</div>
<div class="line"><span class="lineno"> 1367</span>  <span class="keywordflow">if</span> (it == m_previewInstances.end()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1368</span> </div>
<div class="line"><span class="lineno"> 1369</span>  <a class="code hl_class" href="class_preview_fx_instance.html">PreviewFxInstance</a> *previewInstance = it.value();</div>
<div class="line"><span class="lineno"> 1370</span> </div>
<div class="line"><span class="lineno"> 1371</span>  <span class="comment">// First off, detach the flipbook from the preview instance and</span></div>
<div class="line"><span class="lineno"> 1372</span>  <span class="comment">// insert it among the instance&#39;s frozen ones</span></div>
<div class="line"><span class="lineno"> 1373</span>  previewInstance-&gt;detachFlipbook(flipbook);</div>
<div class="line"><span class="lineno"> 1374</span>  previewInstance-&gt;m_frozenFlips.insert(flipbook);</div>
<div class="line"><span class="lineno"> 1375</span> </div>
<div class="line"><span class="lineno"> 1376</span>  <span class="comment">// Then, perform the level copy</span></div>
<div class="line"><span class="lineno"> 1377</span>  {</div>
<div class="line"><span class="lineno"> 1378</span>    std::string levelName(<span class="stringliteral">&quot;freezed&quot;</span> + std::to_string(flipbook-&gt;getPoolIndex()) +</div>
<div class="line"><span class="lineno"> 1379</span>                          <span class="stringliteral">&quot;.noext&quot;</span>);</div>
<div class="line"><span class="lineno"> 1380</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 1381</span> </div>
<div class="line"><span class="lineno"> 1382</span>    <span class="comment">// Clone the preview images</span></div>
<div class="line"><span class="lineno"> 1383</span>    <span class="keywordflow">for</span> (i = previewInstance-&gt;m_start; i &lt;= previewInstance-&gt;m_end;</div>
<div class="line"><span class="lineno"> 1384</span>         i += previewInstance-&gt;m_step) {</div>
<div class="line"><span class="lineno"> 1385</span>      <a class="code hl_class" href="class_t_smart_pointer_t.html">TImageP</a> cachedImage =</div>
<div class="line"><span class="lineno"> 1386</span>          TImageCache::instance()-&gt;<a class="code hl_function" href="class_t_image_cache.html#aea3ac2752efd6fa9689f5a7c1e895e41">get</a>(getCacheId(fx, i), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1387</span>      <span class="keywordflow">if</span> (cachedImage)</div>
<div class="line"><span class="lineno"> 1388</span>        TImageCache::instance()-&gt;<a class="code hl_function" href="class_t_image_cache.html#a124eae4cf370288f42c22b3477cb5163">add</a>(levelName + std::to_string(i),</div>
<div class="line"><span class="lineno"> 1389</span>                                     cachedImage-&gt;<a class="code hl_function" href="class_t_image.html#a3632b96b398057030a4adfe6917d2e28">cloneImage</a>());</div>
<div class="line"><span class="lineno"> 1390</span>    }</div>
<div class="line"><span class="lineno"> 1391</span> </div>
<div class="line"><span class="lineno"> 1392</span>    <span class="comment">// Associate a level with the cached images</span></div>
<div class="line"><span class="lineno"> 1393</span>    <a class="code hl_class" href="class_t_level_p.html">TLevelP</a> freezedLevel;</div>
<div class="line"><span class="lineno"> 1394</span>    freezedLevel-&gt;setName(levelName);</div>
<div class="line"><span class="lineno"> 1395</span>    <span class="keywordflow">for</span> (i = 0; i &lt; previewInstance-&gt;m_level-&gt;getFrameCount(); ++i)</div>
<div class="line"><span class="lineno"> 1396</span>      freezedLevel-&gt;setFrame(<a class="code hl_class" href="class_t_frame_id.html">TFrameId</a>(i), 0);</div>
<div class="line"><span class="lineno"> 1397</span>    flipbook-&gt;<a class="code hl_function" href="class_flip_book.html#ac70c72b88200e2821ea83f4273cb34e4">setLevel</a>(fx.getPointer(), previewInstance-&gt;m_xsheet.getPointer(),</div>
<div class="line"><span class="lineno"> 1398</span>                       freezedLevel.getPointer(), 0,</div>
<div class="line"><span class="lineno"> 1399</span>                       previewInstance-&gt;m_start + 1, previewInstance-&gt;m_end + 1,</div>
<div class="line"><span class="lineno"> 1400</span>                       previewInstance-&gt;m_step, flipbook-&gt;getCurrentFrame(),</div>
<div class="line"><span class="lineno"> 1401</span>                       previewInstance-&gt;m_snd.getPointer());</div>
<div class="line"><span class="lineno"> 1402</span> </div>
<div class="line"><span class="lineno"> 1403</span>    <span class="comment">// Also, the associated PB must be cloned</span></div>
<div class="line"><span class="lineno"> 1404</span>    std::vector&lt;UCHAR&gt; *newPBStatuses = <span class="keyword">new</span> std::vector&lt;UCHAR&gt;;</div>
<div class="line"><span class="lineno"> 1405</span>    *newPBStatuses                    = previewInstance-&gt;m_pbStatus;</div>
<div class="line"><span class="lineno"> 1406</span>    flipbook-&gt;setProgressBarStatus(newPBStatuses);</div>
<div class="line"><span class="lineno"> 1407</span> </div>
<div class="line"><span class="lineno"> 1408</span>    <span class="comment">// Traverse the PB: frames under rendering must be signed as uncompleted</span></div>
<div class="line"><span class="lineno"> 1409</span>    std::vector&lt;UCHAR&gt;::iterator it;</div>
<div class="line"><span class="lineno"> 1410</span>    <span class="keywordflow">for</span> (it = newPBStatuses-&gt;begin(); it != newPBStatuses-&gt;end(); ++it)</div>
<div class="line"><span class="lineno"> 1411</span>      <span class="keywordflow">if</span> (*it == FlipSlider::PBFrameStarted)</div>
<div class="line"><span class="lineno"> 1412</span>        *it = FlipSlider::PBFrameNotStarted;</div>
<div class="line"><span class="lineno"> 1413</span>  }</div>
<div class="line"><span class="lineno"> 1414</span>}</div>
<div class="ttc" id="aclass_flip_book_html_ac70c72b88200e2821ea83f4273cb34e4"><div class="ttname"><a href="class_flip_book.html#ac70c72b88200e2821ea83f4273cb34e4">FlipBook::setLevel</a></div><div class="ttdeci">void setLevel(const TFilePath &amp;path, TPalette *palette=0, int from=-1, int to=-1, int step=1, int shrink=1, TSoundTrack *snd=0, bool append=false, bool isToonzOutput=false)</div><div class="ttdef"><b>Definition:</b> flipbook.cpp:1024</div></div>
<div class="ttc" id="aclass_t_frame_id_html"><div class="ttname"><a href="class_t_frame_id.html">TFrameId</a></div><div class="ttdef"><b>Definition:</b> tfilepath.h:29</div></div>
<div class="ttc" id="aclass_t_image_cache_html_a124eae4cf370288f42c22b3477cb5163"><div class="ttname"><a href="class_t_image_cache.html#a124eae4cf370288f42c22b3477cb5163">TImageCache::add</a></div><div class="ttdeci">void add(const std::string &amp;id, const TImageP &amp;img, bool overwrite=true)</div><div class="ttdef"><b>Definition:</b> timagecache.cpp:1153</div></div>
<div class="ttc" id="aclass_t_image_cache_html_aea3ac2752efd6fa9689f5a7c1e895e41"><div class="ttname"><a href="class_t_image_cache.html#aea3ac2752efd6fa9689f5a7c1e895e41">TImageCache::get</a></div><div class="ttdeci">TImageP get(const std::string &amp;id, bool toBeModified) const</div><div class="ttdef"><b>Definition:</b> timagecache.cpp:1672</div></div>
<div class="ttc" id="aclass_t_image_html_a3632b96b398057030a4adfe6917d2e28"><div class="ttname"><a href="class_t_image.html#a3632b96b398057030a4adfe6917d2e28">TImage::cloneImage</a></div><div class="ttdeci">virtual TImage * cloneImage() const =0</div></div>
<div class="ttc" id="aclass_t_level_p_html"><div class="ttname"><a href="class_t_level_p.html">TLevelP</a></div><div class="ttdef"><b>Definition:</b> tlevel.h:77</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l01153">TImageCache::add()</a>, <a class="el" href="class_t_image.html#a3632b96b398057030a4adfe6917d2e28">TImage::cloneImage()</a>, <a class="el" href="#l01672">TImageCache::get()</a>, and <a class="el" href="#l01024">FlipBook::setLevel()</a>.</p>

</div>
</div>
<a id="a540923ef1e799396ddf8bba11bb3c8c6" name="a540923ef1e799396ddf8bba11bb3c8c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a540923ef1e799396ddf8bba11bb3c8c6">&#9670;&nbsp;</a></span>instance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_preview_fx_manager.html">PreviewFxManager</a> * PreviewFxManager::instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the instance of the <a class="el" href="class_preview_fx_manager.html">PreviewFxManager</a> object. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1219</span>                                             {</div>
<div class="line"><span class="lineno"> 1220</span>  <span class="keyword">static</span> <a class="code hl_class" href="class_preview_fx_manager.html">PreviewFxManager</a> _instance;</div>
<div class="line"><span class="lineno"> 1221</span>  <span class="keywordflow">return</span> &amp;_instance;</div>
<div class="line"><span class="lineno"> 1222</span>}</div>
<div class="ttc" id="aclass_preview_fx_manager_html"><div class="ttname"><a href="class_preview_fx_manager.html">PreviewFxManager</a></div><div class="ttdef"><b>Definition:</b> previewfxmanager.h:58</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4156d45683027be3ba3f1d9bcb76641a" name="a4156d45683027be3ba3f1d9bcb76641a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4156d45683027be3ba3f1d9bcb76641a">&#9670;&nbsp;</a></span>isSubCameraActive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PreviewFxManager::isSubCameraActive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TFxP</a>&#160;</td>
          <td class="paramname"><em>fx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >return true if the preview fx instance for specified fx is with sub-camera activated </p>
<div class="fragment"><div class="line"><span class="lineno"> 1277</span>                                                {</div>
<div class="line"><span class="lineno"> 1278</span>  <span class="keywordflow">if</span> (!fx) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1279</span> </div>
<div class="line"><span class="lineno"> 1280</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> fxId = fx-&gt;getIdentifier();</div>
<div class="line"><span class="lineno"> 1281</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1282</span>      m_previewInstances.find(fxId);</div>
<div class="line"><span class="lineno"> 1283</span>  <span class="keywordflow">if</span> (it == m_previewInstances.end()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1284</span> </div>
<div class="line"><span class="lineno"> 1285</span>  <span class="keywordflow">return</span> it.value()-&gt;isSubCameraActive();</div>
<div class="line"><span class="lineno"> 1286</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="accbd0bf1cf5db637b9061dbc2a351f5f" name="accbd0bf1cf5db637b9061dbc2a351f5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accbd0bf1cf5db637b9061dbc2a351f5f">&#9670;&nbsp;</a></span>onFxChanged</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::onFxChanged </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1475</span>                                   {</div>
<div class="line"><span class="lineno"> 1476</span>  <span class="comment">// Examinate all RenderInstances for ancestors of current fx</span></div>
<div class="line"><span class="lineno"> 1477</span>  <span class="keywordflow">if</span> (m_previewInstances.size()) {</div>
<div class="line"><span class="lineno"> 1478</span>    <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> fx = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#a1d1d4b484617e7a938040554beca6282">getCurrentFx</a>()-&gt;getFx();</div>
<div class="line"><span class="lineno"> 1479</span> </div>
<div class="line"><span class="lineno"> 1480</span>    QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it;</div>
<div class="line"><span class="lineno"> 1481</span>    <span class="keywordflow">for</span> (it = m_previewInstances.begin(); it != m_previewInstances.end(); ++it)</div>
<div class="line"><span class="lineno"> 1482</span>    <span class="comment">// if(areAncestorAndDescendant(it.value()-&gt;m_fx, fx))  //Currently not</span></div>
<div class="line"><span class="lineno"> 1483</span>    <span class="comment">// trespassing sub-xsheet boundaries</span></div>
<div class="line"><span class="lineno"> 1484</span>    {</div>
<div class="line"><span class="lineno"> 1485</span>      <span class="comment">// in case the flipbook is frozen</span></div>
<div class="line"><span class="lineno"> 1486</span>      <span class="keywordflow">if</span> (it.value()-&gt;m_flipbooks.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1487</span>      it.value()-&gt;updateAliases();</div>
<div class="line"><span class="lineno"> 1488</span>      emit refreshViewRects(it.key());</div>
<div class="line"><span class="lineno"> 1489</span>      <span class="comment">// it.value()-&gt;refreshViewRects();</span></div>
<div class="line"><span class="lineno"> 1490</span>    }</div>
<div class="line"><span class="lineno"> 1491</span>  }</div>
<div class="line"><span class="lineno"> 1492</span>}</div>
<div class="ttc" id="aclass_t_app_html_a1d1d4b484617e7a938040554beca6282"><div class="ttname"><a href="class_t_app.html#a1d1d4b484617e7a938040554beca6282">TApp::getCurrentFx</a></div><div class="ttdeci">TFxHandle * getCurrentFx() const override</div><div class="ttdef"><b>Definition:</b> tapp.h:146</div></div>
<div class="ttc" id="aclass_t_app_html_a24088f8647d5d9447fcec6b9b9bbf9eb"><div class="ttname"><a href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a></div><div class="ttdeci">static TApp * instance()</div><div class="ttdef"><b>Definition:</b> tapp.cpp:215</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85f16d9fc52b7f8aa1107820edc7c577" name="a85f16d9fc52b7f8aa1107820edc7c577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85f16d9fc52b7f8aa1107820edc7c577">&#9670;&nbsp;</a></span>onLevelChanged</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::onLevelChanged </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1454</span>                                      {</div>
<div class="line"><span class="lineno"> 1455</span>  <span class="keywordflow">if</span> (m_previewInstances.size()) {</div>
<div class="line"><span class="lineno"> 1456</span>    <span class="comment">// Build the level name as an alias keyword. All cache images associated</span></div>
<div class="line"><span class="lineno"> 1457</span>    <span class="comment">// with an alias containing the level name will be updated.</span></div>
<div class="line"><span class="lineno"> 1458</span>    <a class="code hl_class" href="class_t_xsh_level.html">TXshLevel</a> *xl = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>()-&gt;getLevel();</div>
<div class="line"><span class="lineno"> 1459</span>    std::string aliasKeyword;</div>
<div class="line"><span class="lineno"> 1460</span>    <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> fp = xl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#ab8ffcf067cadf0e1c4081b54ffde249d">getPath</a>();</div>
<div class="line"><span class="lineno"> 1461</span>    aliasKeyword = ::to_string(fp.<a class="code hl_function" href="class_t_file_path.html#a1437b0e0720e9258b622f68b6858e95d">withType</a>(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><span class="lineno"> 1462</span> </div>
<div class="line"><span class="lineno"> 1463</span>    QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it;</div>
<div class="line"><span class="lineno"> 1464</span>    <span class="keywordflow">for</span> (it = m_previewInstances.begin(); it != m_previewInstances.end();</div>
<div class="line"><span class="lineno"> 1465</span>         ++it) {</div>
<div class="line"><span class="lineno"> 1466</span>      it.value()-&gt;updateAliasKeyword(aliasKeyword);</div>
<div class="line"><span class="lineno"> 1467</span>      emit refreshViewRects(it.key());</div>
<div class="line"><span class="lineno"> 1468</span>      <span class="comment">// it.value()-&gt;refreshViewRects();</span></div>
<div class="line"><span class="lineno"> 1469</span>    }</div>
<div class="line"><span class="lineno"> 1470</span>  }</div>
<div class="line"><span class="lineno"> 1471</span>}</div>
<div class="ttc" id="aclass_t_app_html_ad2923c9feaaa44ecd9cdd0fa029aa8aa"><div class="ttname"><a href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">TApp::getCurrentLevel</a></div><div class="ttdeci">TXshLevelHandle * getCurrentLevel() const override</div><div class="ttdef"><b>Definition:</b> tapp.h:122</div></div>
<div class="ttc" id="aclass_t_file_path_html"><div class="ttname"><a href="class_t_file_path.html">TFilePath</a></div><div class="ttdef"><b>Definition:</b> tfilepath.h:134</div></div>
<div class="ttc" id="aclass_t_file_path_html_a1437b0e0720e9258b622f68b6858e95d"><div class="ttname"><a href="class_t_file_path.html#a1437b0e0720e9258b622f68b6858e95d">TFilePath::withType</a></div><div class="ttdeci">TFilePath withType(const std::string &amp;type) const</div><div class="ttdef"><b>Definition:</b> tfilepath.cpp:774</div></div>
<div class="ttc" id="aclass_t_xsh_level_html"><div class="ttname"><a href="class_t_xsh_level.html">TXshLevel</a></div><div class="ttdoc">The TXshLevel class is the base class of level managers in xsheet.</div><div class="ttdef"><b>Definition:</b> txshlevel.h:50</div></div>
<div class="ttc" id="aclass_t_xsh_level_html_ab8ffcf067cadf0e1c4081b54ffde249d"><div class="ttname"><a href="class_t_xsh_level.html#ab8ffcf067cadf0e1c4081b54ffde249d">TXshLevel::getPath</a></div><div class="ttdeci">virtual TFilePath getPath() const</div><div class="ttdoc">Return the file path associated with the level.</div><div class="ttdef"><b>Definition:</b> txshlevel.h:121</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab98667688dfdfa1ef71dcb1a21f094af" name="ab98667688dfdfa1ef71dcb1a21f094af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab98667688dfdfa1ef71dcb1a21f094af">&#9670;&nbsp;</a></span>onObjectChanged</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::onObjectChanged </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isDragging</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1517</span>                                                      {</div>
<div class="line"><span class="lineno"> 1518</span>  <span class="keywordflow">if</span> (isDragging) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1519</span>  <span class="comment">// Update all rendered frames, if necessary</span></div>
<div class="line"><span class="lineno"> 1520</span>  <span class="keywordflow">if</span> (m_previewInstances.size()) {</div>
<div class="line"><span class="lineno"> 1521</span>    QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it;</div>
<div class="line"><span class="lineno"> 1522</span>    <span class="keywordflow">for</span> (it = m_previewInstances.begin(); it != m_previewInstances.end();</div>
<div class="line"><span class="lineno"> 1523</span>         ++it) {</div>
<div class="line"><span class="lineno"> 1524</span>      <span class="comment">// in case the flipbook is frozen</span></div>
<div class="line"><span class="lineno"> 1525</span>      <span class="keywordflow">if</span> (it.value()-&gt;m_flipbooks.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1526</span>      it.value()-&gt;updateFrameRange();</div>
<div class="line"><span class="lineno"> 1527</span>      it.value()-&gt;updateFlipbookTitles();</div>
<div class="line"><span class="lineno"> 1528</span>      it.value()-&gt;updateAliases();</div>
<div class="line"><span class="lineno"> 1529</span>      emit refreshViewRects(it.key());</div>
<div class="line"><span class="lineno"> 1530</span>      <span class="comment">// it.value()-&gt;refreshViewRects();</span></div>
<div class="line"><span class="lineno"> 1531</span>    }</div>
<div class="line"><span class="lineno"> 1532</span>  }</div>
<div class="line"><span class="lineno"> 1533</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ff213fc7a8578c760139a1b3e8a58a7" name="a5ff213fc7a8578c760139a1b3e8a58a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ff213fc7a8578c760139a1b3e8a58a7">&#9670;&nbsp;</a></span>onRefreshViewRects</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::onRefreshViewRects </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >This slot is necessary to prevent problems with current implementation of the event-looping PreviewFxInstance::refreshViewRects function. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1306</span>                                                          {</div>
<div class="line"><span class="lineno"> 1307</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1308</span>      m_previewInstances.find(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno"> 1309</span>  <span class="keywordflow">if</span> (it != m_previewInstances.end()) it.value()-&gt;refreshViewRects();</div>
<div class="line"><span class="lineno"> 1310</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a752299d7f319eb3b00d3e2f4b328f6a0" name="a752299d7f319eb3b00d3e2f4b328f6a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a752299d7f319eb3b00d3e2f4b328f6a0">&#9670;&nbsp;</a></span>onRenderedFrame</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::onRenderedFrame </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>fxId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_t_render_port_1_1_render_data.html">TRenderPort::RenderData</a>&#160;</td>
          <td class="paramname"><em>renderData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1664</span>                                                                         {</div>
<div class="line"><span class="lineno"> 1665</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1666</span>      m_previewInstances.find(fxId);</div>
<div class="line"><span class="lineno"> 1667</span>  <span class="keywordflow">if</span> (it != m_previewInstances.end()) {</div>
<div class="line"><span class="lineno"> 1668</span>    <span class="comment">// Invoke the corresponding function. This happens in the MAIN THREAD</span></div>
<div class="line"><span class="lineno"> 1669</span>    it.value()-&gt;doOnRenderRasterCompleted(renderData);</div>
<div class="line"><span class="lineno"> 1670</span>  }</div>
<div class="line"><span class="lineno"> 1671</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6048e5a20b905a5f52f89e43a24c7c58" name="a6048e5a20b905a5f52f89e43a24c7c58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6048e5a20b905a5f52f89e43a24c7c58">&#9670;&nbsp;</a></span>onStartedFrame</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::onStartedFrame </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>fxId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_t_render_port_1_1_render_data.html">TRenderPort::RenderData</a>&#160;</td>
          <td class="paramname"><em>renderData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1652</span>                                                                        {</div>
<div class="line"><span class="lineno"> 1653</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1654</span>      m_previewInstances.find(fxId);</div>
<div class="line"><span class="lineno"> 1655</span>  <span class="keywordflow">if</span> (it != m_previewInstances.end()) {</div>
<div class="line"><span class="lineno"> 1656</span>    <span class="comment">// Invoke the corresponding function. This happens in the MAIN THREAD</span></div>
<div class="line"><span class="lineno"> 1657</span>    it.value()-&gt;doOnRenderRasterStarted(renderData);</div>
<div class="line"><span class="lineno"> 1658</span>  }</div>
<div class="line"><span class="lineno"> 1659</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8943baba2266000556d3ce8341d2f22b" name="a8943baba2266000556d3ce8341d2f22b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8943baba2266000556d3ce8341d2f22b">&#9670;&nbsp;</a></span>onXsheetChanged</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::onXsheetChanged </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1496</span>                                       {</div>
<div class="line"><span class="lineno"> 1497</span>  <span class="comment">// Update all rendered frames, if necessary</span></div>
<div class="line"><span class="lineno"> 1498</span>  <span class="keywordflow">if</span> (m_previewInstances.size()) {</div>
<div class="line"><span class="lineno"> 1499</span>    QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it;</div>
<div class="line"><span class="lineno"> 1500</span>    <span class="keywordflow">for</span> (it = m_previewInstances.begin(); it != m_previewInstances.end();</div>
<div class="line"><span class="lineno"> 1501</span>         ++it) {</div>
<div class="line"><span class="lineno"> 1502</span>      <span class="comment">// in case the flipbook is frozen</span></div>
<div class="line"><span class="lineno"> 1503</span>      <span class="keywordflow">if</span> (it.value()-&gt;m_flipbooks.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1504</span>      it.value()-&gt;updateRenderSettings();</div>
<div class="line"><span class="lineno"> 1505</span>      it.value()-&gt;updateCamera();</div>
<div class="line"><span class="lineno"> 1506</span>      it.value()-&gt;updateFrameRange();</div>
<div class="line"><span class="lineno"> 1507</span>      it.value()-&gt;updateFlipbookTitles();</div>
<div class="line"><span class="lineno"> 1508</span>      it.value()-&gt;updateAliases();</div>
<div class="line"><span class="lineno"> 1509</span>      emit refreshViewRects(it.key());</div>
<div class="line"><span class="lineno"> 1510</span>      <span class="comment">// it.value()-&gt;refreshViewRects();</span></div>
<div class="line"><span class="lineno"> 1511</span>    }</div>
<div class="line"><span class="lineno"> 1512</span>  }</div>
<div class="line"><span class="lineno"> 1513</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a20c15e33d5294fb7644af987745d395b" name="a20c15e33d5294fb7644af987745d395b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20c15e33d5294fb7644af987745d395b">&#9670;&nbsp;</a></span>refreshView()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::refreshView </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TFxP</a>&#160;</td>
          <td class="paramname"><em>fx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the fx's preview on the associated flipbooks' current views. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1290</span>                                          {</div>
<div class="line"><span class="lineno"> 1291</span>  <span class="keywordflow">if</span> (!fx) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1292</span> </div>
<div class="line"><span class="lineno"> 1293</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> fxId = fx-&gt;getIdentifier();</div>
<div class="line"><span class="lineno"> 1294</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1295</span>      m_previewInstances.find(fxId);</div>
<div class="line"><span class="lineno"> 1296</span>  <span class="keywordflow">if</span> (it == m_previewInstances.end()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1297</span> </div>
<div class="line"><span class="lineno"> 1298</span>  it.value()-&gt;refreshViewRects();</div>
<div class="line"><span class="lineno"> 1299</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e9f7dec7025ae3ab51734dbe8efe676" name="a0e9f7dec7025ae3ab51734dbe8efe676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e9f7dec7025ae3ab51734dbe8efe676">&#9670;&nbsp;</a></span>reset() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::reset </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>detachFlipbooks</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets the <a class="el" href="class_preview_fx_manager.html">PreviewFxManager</a> together with all internal rendering objects. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1583</span>                                                 {</div>
<div class="line"><span class="lineno"> 1584</span>  <span class="comment">// Hard copy the instances pointers</span></div>
<div class="line"><span class="lineno"> 1585</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt; previewInstances =</div>
<div class="line"><span class="lineno"> 1586</span>      m_previewInstances;</div>
<div class="line"><span class="lineno"> 1587</span> </div>
<div class="line"><span class="lineno"> 1588</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it;</div>
<div class="line"><span class="lineno"> 1589</span>  <span class="keywordflow">for</span> (it = previewInstances.begin(); it != previewInstances.end(); ++it) {</div>
<div class="line"><span class="lineno"> 1590</span>    <span class="comment">// Just like the above, stopRendering(true) event-LOOPS...</span></div>
<div class="line"><span class="lineno"> 1591</span>    it.value()-&gt;m_renderer.stopRendering(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1592</span> </div>
<div class="line"><span class="lineno"> 1593</span>    <span class="keywordflow">if</span> (m_previewInstances.find(it.key()) == m_previewInstances.end()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1594</span> </div>
<div class="line"><span class="lineno"> 1595</span>    <span class="keywordflow">if</span> (detachFlipbooks) {</div>
<div class="line"><span class="lineno"> 1596</span>      <span class="comment">// Reset all associated flipbooks</span></div>
<div class="line"><span class="lineno"> 1597</span>      <a class="code hl_class" href="class_preview_fx_instance.html">PreviewFxInstance</a> *previewInstance = it.value();</div>
<div class="line"><span class="lineno"> 1598</span> </div>
<div class="line"><span class="lineno"> 1599</span>      <span class="comment">// Hard copy, since detach manipulates the original</span></div>
<div class="line"><span class="lineno"> 1600</span>      std::set&lt;FlipBook *&gt; flipbooks = previewInstance-&gt;m_flipbooks;</div>
<div class="line"><span class="lineno"> 1601</span> </div>
<div class="line"><span class="lineno"> 1602</span>      std::set&lt;FlipBook *&gt;::iterator jt;</div>
<div class="line"><span class="lineno"> 1603</span>      <span class="keywordflow">for</span> (jt = flipbooks.begin(); jt != flipbooks.end(); ++jt) {</div>
<div class="line"><span class="lineno"> 1604</span>        <span class="comment">// Detach and reset the flipbook</span></div>
<div class="line"><span class="lineno"> 1605</span>        (*jt)-&gt;reset();  <span class="comment">// The detachment happens in here</span></div>
<div class="line"><span class="lineno"> 1606</span>      }</div>
<div class="line"><span class="lineno"> 1607</span> </div>
<div class="line"><span class="lineno"> 1608</span>      <span class="comment">/*- Frozen</span></div>
<div class="line"><span class="lineno"> 1609</span><span class="comment">       * FlippreviewInstance</span></div>
<div class="line"><span class="lineno"> 1610</span><span class="comment">       * -*/</span></div>
<div class="line"><span class="lineno"> 1611</span>      <span class="keywordflow">if</span> (m_previewInstances.find(it.key()) == m_previewInstances.end())</div>
<div class="line"><span class="lineno"> 1612</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1613</span> </div>
<div class="line"><span class="lineno"> 1614</span>      <span class="comment">// Same for frozen ones</span></div>
<div class="line"><span class="lineno"> 1615</span> </div>
<div class="line"><span class="lineno"> 1616</span>      <span class="keywordflow">if</span> (!previewInstance-&gt;m_frozenFlips.empty() &amp;&amp;</div>
<div class="line"><span class="lineno"> 1617</span>          previewInstance-&gt;m_frozenFlips.size() &lt; 20) {</div>
<div class="line"><span class="lineno"> 1618</span>        std::set&lt;FlipBook *&gt; frozenFlips = previewInstance-&gt;m_frozenFlips;</div>
<div class="line"><span class="lineno"> 1619</span>        <span class="keywordflow">for</span> (jt = frozenFlips.begin(); jt != frozenFlips.end(); ++jt) {</div>
<div class="line"><span class="lineno"> 1620</span>          <span class="comment">// Detach and reset the flipbook</span></div>
<div class="line"><span class="lineno"> 1621</span>          (*jt)-&gt;reset();  <span class="comment">// The detachment happens in here</span></div>
<div class="line"><span class="lineno"> 1622</span>        }</div>
<div class="line"><span class="lineno"> 1623</span>      }</div>
<div class="line"><span class="lineno"> 1624</span> </div>
<div class="line"><span class="lineno"> 1625</span>      <span class="comment">// The Preview instance should have been deleted at this point (due to</span></div>
<div class="line"><span class="lineno"> 1626</span>      <span class="comment">// flipbook detachments)</span></div>
<div class="line"><span class="lineno"> 1627</span>      assert(m_previewInstances.find(it.key()) == m_previewInstances.end());</div>
<div class="line"><span class="lineno"> 1628</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1629</span>      it.value()-&gt;reset();</div>
<div class="line"><span class="lineno"> 1630</span>      it.value()-&gt;refreshViewRects();</div>
<div class="line"><span class="lineno"> 1631</span>    }</div>
<div class="line"><span class="lineno"> 1632</span>  }</div>
<div class="line"><span class="lineno"> 1633</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3cf458cfc0955a610007cb537638d592" name="a3cf458cfc0955a610007cb537638d592"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cf458cfc0955a610007cb537638d592">&#9670;&nbsp;</a></span>reset() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TFxP</a>&#160;</td>
          <td class="paramname"><em>fx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Resets the <a class="el" href="class_preview_fx_manager.html">PreviewFxManager</a> for input fx. All previously rendered previews for it are cleared. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1539</span>                                    {</div>
<div class="line"><span class="lineno"> 1540</span>  <span class="keywordflow">if</span> (!fx) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1541</span> </div>
<div class="line"><span class="lineno"> 1542</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> fxId = fx-&gt;getIdentifier();</div>
<div class="line"><span class="lineno"> 1543</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1544</span>      m_previewInstances.find(fxId);</div>
<div class="line"><span class="lineno"> 1545</span>  <span class="keywordflow">if</span> (it == m_previewInstances.end()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1546</span> </div>
<div class="line"><span class="lineno"> 1547</span>  it.value()-&gt;m_renderer.stopRendering(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1548</span> </div>
<div class="line"><span class="lineno"> 1549</span>  <span class="comment">// stopRendering(true) LOOPS and may destroy the preview instance. Recheck for</span></div>
<div class="line"><span class="lineno"> 1550</span>  <span class="comment">// its presence</span></div>
<div class="line"><span class="lineno"> 1551</span>  it = m_previewInstances.find(fxId);</div>
<div class="line"><span class="lineno"> 1552</span>  <span class="keywordflow">if</span> (it != m_previewInstances.end()) {</div>
<div class="line"><span class="lineno"> 1553</span>    it.value()-&gt;reset();</div>
<div class="line"><span class="lineno"> 1554</span>    it.value()-&gt;refreshViewRects();</div>
<div class="line"><span class="lineno"> 1555</span>  }</div>
<div class="line"><span class="lineno"> 1556</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="#l01226">showNewPreview()</a>.</p>

</div>
</div>
<a id="a76b7231f43b848e03de56425fe6d9e78" name="a76b7231f43b848e03de56425fe6d9e78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76b7231f43b848e03de56425fe6d9e78">&#9670;&nbsp;</a></span>reset() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TFxP</a>&#160;</td>
          <td class="paramname"><em>fx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>frame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Resets the <a class="el" href="class_preview_fx_manager.html">PreviewFxManager</a> for input fx at frame. The previous rendered preview is cleared. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1560</span>                                               {</div>
<div class="line"><span class="lineno"> 1561</span>  <span class="keywordflow">if</span> (!fx) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1562</span> </div>
<div class="line"><span class="lineno"> 1563</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> fxId = fx-&gt;getIdentifier();</div>
<div class="line"><span class="lineno"> 1564</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1565</span>      m_previewInstances.find(fxId);</div>
<div class="line"><span class="lineno"> 1566</span>  <span class="keywordflow">if</span> (it == m_previewInstances.end()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1567</span> </div>
<div class="line"><span class="lineno"> 1568</span>  <span class="keywordflow">if</span> (it.value()-&gt;m_start &gt; it.value()-&gt;m_end) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1569</span> </div>
<div class="line"><span class="lineno"> 1570</span>  it.value()-&gt;m_renderer.stopRendering(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1571</span> </div>
<div class="line"><span class="lineno"> 1572</span>  <span class="comment">// stopRendering(true) LOOPS and may destroy the preview instance. Recheck for</span></div>
<div class="line"><span class="lineno"> 1573</span>  <span class="comment">// its presence</span></div>
<div class="line"><span class="lineno"> 1574</span>  it = m_previewInstances.find(fxId);</div>
<div class="line"><span class="lineno"> 1575</span>  <span class="keywordflow">if</span> (it != m_previewInstances.end()) {</div>
<div class="line"><span class="lineno"> 1576</span>    it.value()-&gt;reset(frame);</div>
<div class="line"><span class="lineno"> 1577</span>    it.value()-&gt;refreshViewRects();</div>
<div class="line"><span class="lineno"> 1578</span>  }</div>
<div class="line"><span class="lineno"> 1579</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a633f9f858d2ea0e6ccee709d495b74" name="a5a633f9f858d2ea0e6ccee709d495b74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a633f9f858d2ea0e6ccee709d495b74">&#9670;&nbsp;</a></span>showNewPreview()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_flip_book.html">FlipBook</a> * PreviewFxManager::showNewPreview </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TFxP</a>&#160;</td>
          <td class="paramname"><em>fx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>forceFlipbook</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Starts a preview instance for passed fx. If explicitly requested, a new flipbook is created to host the preview, otherwise the Preference settings are used. In the former case, the view refresh must be explicitly invoked using the <a class="el" href="class_preview_fx_manager.html#a20c15e33d5294fb7644af987745d395b" title="Updates the fx&#39;s preview on the associated flipbooks&#39; current views.">refreshView()</a> command, in order to allow changes of the flipbook's view affine before it. The associated flipbook is returned, in case it has been created. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1226</span>                                                                      {</div>
<div class="line"><span class="lineno"> 1227</span>  <span class="keywordflow">if</span> (!fx) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1228</span> </div>
<div class="line"><span class="lineno"> 1229</span>  <span class="comment">/*-- fxIdFx --*/</span></div>
<div class="line"><span class="lineno"> 1230</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> fxId                 = fx-&gt;getIdentifier();</div>
<div class="line"><span class="lineno"> 1231</span>  <a class="code hl_class" href="class_preview_fx_instance.html">PreviewFxInstance</a> *previewInstance = 0;</div>
<div class="line"><span class="lineno"> 1232</span> </div>
<div class="line"><span class="lineno"> 1233</span>  <span class="comment">/*-- PreviewFxInstanceFx --*/</span></div>
<div class="line"><span class="lineno"> 1234</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1235</span>      m_previewInstances.find(fxId);</div>
<div class="line"><span class="lineno"> 1236</span>  <span class="keywordflow">if</span> (it == m_previewInstances.end()) {</div>
<div class="line"><span class="lineno"> 1237</span>    <a class="code hl_class" href="class_t_xsheet.html">TXsheet</a> *xsh    = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">getCurrentXsheet</a>()-&gt;getXsheet();</div>
<div class="line"><span class="lineno"> 1238</span>    previewInstance = <span class="keyword">new</span> <a class="code hl_class" href="class_preview_fx_instance.html">PreviewFxInstance</a>(fx, xsh);</div>
<div class="line"><span class="lineno"> 1239</span>    m_previewInstances.insert(fxId, previewInstance);</div>
<div class="line"><span class="lineno"> 1240</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1241</span>    previewInstance = it.value();</div>
<div class="line"><span class="lineno"> 1242</span>    <span class="comment">/*-- PreviewFxPreview --*/</span></div>
<div class="line"><span class="lineno"> 1243</span>    <span class="keywordflow">if</span> (!forceFlipbook &amp;&amp;</div>
<div class="line"><span class="lineno"> 1244</span>        !Preferences::instance()-&gt;previewAlwaysOpenNewFlipEnabled()) {</div>
<div class="line"><span class="lineno"> 1245</span>      <span class="comment">// Search the first visible flipbook to be raised. If not found, add a new</span></div>
<div class="line"><span class="lineno"> 1246</span>      <span class="comment">// one.</span></div>
<div class="line"><span class="lineno"> 1247</span>      <span class="comment">/*--</span></div>
<div class="line"><span class="lineno"> 1248</span><span class="comment">       * FxFlipbookVisiblereset()</span></div>
<div class="line"><span class="lineno"> 1249</span><span class="comment">       * --*/</span></div>
<div class="line"><span class="lineno"> 1250</span>      std::set&lt;FlipBook *&gt; &amp;flipbooks = previewInstance-&gt;m_flipbooks;</div>
<div class="line"><span class="lineno"> 1251</span>      std::set&lt;FlipBook *&gt;::iterator jt;</div>
<div class="line"><span class="lineno"> 1252</span>      <span class="keywordflow">for</span> (jt = flipbooks.begin(); jt != flipbooks.end(); ++jt)</div>
<div class="line"><span class="lineno"> 1253</span>        <span class="keywordflow">if</span> ((*jt)-&gt;isVisible()) {</div>
<div class="line"><span class="lineno"> 1254</span>          <a class="code hl_function" href="class_preview_fx_manager.html#a3cf458cfc0955a610007cb537638d592">reset</a>(fx);  <span class="comment">// Also recalculate the preview</span></div>
<div class="line"><span class="lineno"> 1255</span>          (*jt)-&gt;parentWidget()-&gt;raise();</div>
<div class="line"><span class="lineno"> 1256</span>          <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1257</span>        }</div>
<div class="line"><span class="lineno"> 1258</span>    }</div>
<div class="line"><span class="lineno"> 1259</span>  }</div>
<div class="line"><span class="lineno"> 1260</span> </div>
<div class="line"><span class="lineno"> 1261</span>  <a class="code hl_class" href="class_flip_book.html">FlipBook</a> *result = 0;</div>
<div class="line"><span class="lineno"> 1262</span>  <span class="comment">/*-- resultFlipbooksetLevel --*/</span></div>
<div class="line"><span class="lineno"> 1263</span>  previewInstance-&gt;addFlipbook(result);</div>
<div class="line"><span class="lineno"> 1264</span> </div>
<div class="line"><span class="lineno"> 1265</span>  <span class="comment">/*-- Flipbook forceFlipbookfalse --*/</span></div>
<div class="line"><span class="lineno"> 1266</span>  <span class="keywordflow">if</span> (!forceFlipbook) <span class="comment">/*-- startRender --*/</span></div>
<div class="line"><span class="lineno"> 1267</span>    previewInstance-&gt;refreshViewRects();</div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1270</span>}</div>
<div class="ttc" id="aclass_flip_book_html"><div class="ttname"><a href="class_flip_book.html">FlipBook</a></div><div class="ttdoc">The FlipBook class provides to view level images.</div><div class="ttdef"><b>Definition:</b> flipbook.h:110</div></div>
<div class="ttc" id="aclass_preview_fx_manager_html_a3cf458cfc0955a610007cb537638d592"><div class="ttname"><a href="class_preview_fx_manager.html#a3cf458cfc0955a610007cb537638d592">PreviewFxManager::reset</a></div><div class="ttdeci">void reset(TFxP fx)</div><div class="ttdef"><b>Definition:</b> previewfxmanager.cpp:1539</div></div>
<div class="ttc" id="aclass_t_app_html_a13f509e753824cb0500787f68bb51a09"><div class="ttname"><a href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">TApp::getCurrentXsheet</a></div><div class="ttdeci">TXsheetHandle * getCurrentXsheet() const override</div><div class="ttdef"><b>Definition:</b> tapp.h:110</div></div>
<div class="ttc" id="aclass_t_xsheet_html"><div class="ttname"><a href="class_t_xsheet.html">TXsheet</a></div><div class="ttdef"><b>Definition:</b> txsheet.h:132</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00110">TApp::getCurrentXsheet()</a>, <a class="el" href="#l00215">TApp::instance()</a>, and <a class="el" href="#l01539">reset()</a>.</p>

</div>
</div>
<a id="a69c365dff55ec1d15552c50a10961ea2" name="a69c365dff55ec1d15552c50a10961ea2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69c365dff55ec1d15552c50a10961ea2">&#9670;&nbsp;</a></span>suspendRendering()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::suspendRendering </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>suspend</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >The suspendRendering method allows suspension of the previewer's rendering activity for safety purposes, typically related to the fact that no rendering process should actually be performed as the underlying scene is about to change or being destroyed. Upon suspension, further rendering requests are silently rejected - and currently active ones are canceled and waited until they are no longer active. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1684</span>                                                    {</div>
<div class="line"><span class="lineno"> 1685</span>  suspendedRendering = suspend;</div>
<div class="line"><span class="lineno"> 1686</span>  <span class="keywordflow">if</span> (suspend &amp;&amp; previewerInstance) {</div>
<div class="line"><span class="lineno"> 1687</span>    QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it;</div>
<div class="line"><span class="lineno"> 1688</span>    <span class="keywordflow">for</span> (it = previewerInstance-&gt;m_previewInstances.begin();</div>
<div class="line"><span class="lineno"> 1689</span>         it != previewerInstance-&gt;m_previewInstances.end(); ++it) {</div>
<div class="line"><span class="lineno"> 1690</span>      it.value()-&gt;m_renderer.stopRendering(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1691</span>    }</div>
<div class="line"><span class="lineno"> 1692</span>  }</div>
<div class="line"><span class="lineno"> 1693</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a8064084ad56427682cbf63bda46708" name="a3a8064084ad56427682cbf63bda46708"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a8064084ad56427682cbf63bda46708">&#9670;&nbsp;</a></span>unfreeze()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PreviewFxManager::unfreeze </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_flip_book.html">FlipBook</a> *&#160;</td>
          <td class="paramname"><em>flipbook</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1314</span>                                                  {</div>
<div class="line"><span class="lineno"> 1315</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> fx(flipbook-&gt;getPreviewedFx());</div>
<div class="line"><span class="lineno"> 1316</span>  <span class="keywordflow">if</span> (!fx) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1317</span> </div>
<div class="line"><span class="lineno"> 1318</span>  QMap&lt;unsigned long, PreviewFxInstance *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1319</span>      m_previewInstances.find(fx-&gt;getIdentifier());</div>
<div class="line"><span class="lineno"> 1320</span>  <span class="keywordflow">if</span> (it == m_previewInstances.end()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1321</span> </div>
<div class="line"><span class="lineno"> 1322</span>  <a class="code hl_class" href="class_preview_fx_instance.html">PreviewFxInstance</a> *previewInstance = it.value();</div>
<div class="line"><span class="lineno"> 1323</span>  std::set&lt;FlipBook *&gt; &amp;frozenFlips  = previewInstance-&gt;m_frozenFlips;</div>
<div class="line"><span class="lineno"> 1324</span> </div>
<div class="line"><span class="lineno"> 1325</span>  std::set&lt;FlipBook *&gt;::iterator jt = frozenFlips.find(flipbook);</div>
<div class="line"><span class="lineno"> 1326</span>  <span class="keywordflow">if</span> (jt == frozenFlips.end()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span>  <span class="comment">// Re-attach to the preview instance</span></div>
<div class="line"><span class="lineno"> 1329</span>  {</div>
<div class="line"><span class="lineno"> 1330</span>    frozenFlips.erase(jt);</div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span>    <span class="comment">// Before attaching, remove any old flipbook level from the cache</span></div>
<div class="line"><span class="lineno"> 1333</span>    flipbook-&gt;clearCache();</div>
<div class="line"><span class="lineno"> 1334</span> </div>
<div class="line"><span class="lineno"> 1335</span>    <span class="comment">// Also any associated pb status</span></div>
<div class="line"><span class="lineno"> 1336</span>    <span class="keyword">delete</span> flipbook-&gt;getProgressBarStatus();</div>
<div class="line"><span class="lineno"> 1337</span>    flipbook-&gt;setProgressBarStatus(NULL);</div>
<div class="line"><span class="lineno"> 1338</span> </div>
<div class="line"><span class="lineno"> 1339</span>    previewInstance-&gt;addFlipbook(flipbook);</div>
<div class="line"><span class="lineno"> 1340</span> </div>
<div class="line"><span class="lineno"> 1341</span>    <span class="comment">// recompute frames, if necessary (call the same process as</span></div>
<div class="line"><span class="lineno"> 1342</span>    <span class="comment">// PreviewFxManager::onXsheetChanged())</span></div>
<div class="line"><span class="lineno"> 1343</span>    previewInstance-&gt;updateRenderSettings();</div>
<div class="line"><span class="lineno"> 1344</span>    previewInstance-&gt;updateCamera();</div>
<div class="line"><span class="lineno"> 1345</span>    previewInstance-&gt;updateFrameRange();</div>
<div class="line"><span class="lineno"> 1346</span>    previewInstance-&gt;updateFlipbookTitles();</div>
<div class="line"><span class="lineno"> 1347</span>    previewInstance-&gt;updateAliases();</div>
<div class="line"><span class="lineno"> 1348</span> </div>
<div class="line"><span class="lineno"> 1349</span>    previewInstance-&gt;refreshViewRects();</div>
<div class="line"><span class="lineno"> 1350</span>  }</div>
<div class="line"><span class="lineno"> 1351</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="abe94a88f2ecb81d57a14b8fed98e91c7" name="abe94a88f2ecb81d57a14b8fed98e91c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe94a88f2ecb81d57a14b8fed98e91c7">&#9670;&nbsp;</a></span>PreviewFxInstance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="class_preview_fx_instance.html">PreviewFxInstance</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>E:/opentoonz/toonz/sources/toonz/<a class="el" href="">previewfxmanager.h</a></li>
<li>E:/opentoonz/toonz/sources/toonz/<a class="el" href="">previewfxmanager.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
