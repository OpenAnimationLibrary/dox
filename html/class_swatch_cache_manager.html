<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: SwatchCacheManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="class_swatch_cache_manager-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">SwatchCacheManager Class Reference<span class="mlabels"><span class="mlabel">final</span></span></div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for SwatchCacheManager:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_swatch_cache_manager.png" usemap="#SwatchCacheManager_map" alt=""/>
  <map id="SwatchCacheManager_map" name="SwatchCacheManager_map">
<area href="class_t_fx_cache_manager_delegate.html" alt="TFxCacheManagerDelegate" shape="rect" coords="0,56,171,80"/>
<area href="class_t_render_resource_manager.html" alt="TRenderResourceManager" shape="rect" coords="0,0,171,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a46115a875ba194955bce7a18f4a3a083"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_swatch_cache_manager.html#a46115a875ba194955bce7a18f4a3a083">setFx</a> (const <a class="el" href="class_t_smart_pointer_t.html">TFxP</a> &amp;actualFx)</td></tr>
<tr class="separator:a46115a875ba194955bce7a18f4a3a083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f65791ebee6f430e0192b98408522fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_swatch_cache_manager.html#a6f65791ebee6f430e0192b98408522fe">clearSwatchResults</a> ()</td></tr>
<tr class="separator:a6f65791ebee6f430e0192b98408522fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9dd145834b2dfe5cfd3970309ed1799"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_swatch_cache_manager.html#ad9dd145834b2dfe5cfd3970309ed1799">getResource</a> (<a class="el" href="class_t_cache_resource_p.html">TCacheResourceP</a> &amp;resource, const std::string &amp;alias, const <a class="el" href="class_t_smart_pointer_t.html">TFxP</a> &amp;fx, double frame, const <a class="el" href="class_t_render_settings.html">TRenderSettings</a> &amp;rs, <a class="el" href="struct_resource_declaration.html">ResourceDeclaration</a> *resData) override</td></tr>
<tr class="separator:ad9dd145834b2dfe5cfd3970309ed1799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a823767e18dfec120165cd84945d18802"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_swatch_cache_manager.html#a823767e18dfec120165cd84945d18802">renderHasOwnership</a> () override</td></tr>
<tr class="separator:a823767e18dfec120165cd84945d18802"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_t_fx_cache_manager_delegate"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_t_fx_cache_manager_delegate')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_t_fx_cache_manager_delegate.html">TFxCacheManagerDelegate</a></td></tr>
<tr class="memitem:add4499791383ece09d3e3fc3584a1522 inherit pub_methods_class_t_fx_cache_manager_delegate"><td class="memItemLeft" align="right" valign="top"><a id="add4499791383ece09d3e3fc3584a1522" name="add4499791383ece09d3e3fc3584a1522"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>getResource</b> (<a class="el" href="class_t_cache_resource_p.html">TCacheResourceP</a> &amp;resource, const std::string &amp;alias, const <a class="el" href="class_t_smart_pointer_t.html">TFxP</a> &amp;fx, double frame, const <a class="el" href="class_t_render_settings.html">TRenderSettings</a> &amp;rs, <a class="el" href="struct_resource_declaration.html">ResourceDeclaration</a> *resData)=0</td></tr>
<tr class="separator:add4499791383ece09d3e3fc3584a1522 inherit pub_methods_class_t_fx_cache_manager_delegate"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6b482e6c651e4359229909b0751fef4 inherit pub_methods_class_t_fx_cache_manager_delegate"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_fx_cache_manager_delegate.html#ac6b482e6c651e4359229909b0751fef4">onRenderInstanceStart</a> (unsigned long renderId) override</td></tr>
<tr class="separator:ac6b482e6c651e4359229909b0751fef4 inherit pub_methods_class_t_fx_cache_manager_delegate"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_t_render_resource_manager"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_t_render_resource_manager')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_t_render_resource_manager.html">TRenderResourceManager</a></td></tr>
<tr class="memitem:a73ebf8351fc31f4b5bda59efe5f33bc4 inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#a73ebf8351fc31f4b5bda59efe5f33bc4">onRenderInstanceStart</a> (unsigned long id)</td></tr>
<tr class="separator:a73ebf8351fc31f4b5bda59efe5f33bc4 inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9db5f4c3868c80a40510d627bb3e56e inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#aa9db5f4c3868c80a40510d627bb3e56e">onRenderInstanceEnd</a> (unsigned long id)</td></tr>
<tr class="separator:aa9db5f4c3868c80a40510d627bb3e56e inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d51cf7f77a517629ab0424f98f40476 inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#a2d51cf7f77a517629ab0424f98f40476">onRenderFrameStart</a> (double f)</td></tr>
<tr class="separator:a2d51cf7f77a517629ab0424f98f40476 inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a1838e9bb5e34e002ec7206359c07e1 inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#a6a1838e9bb5e34e002ec7206359c07e1">onRenderFrameEnd</a> (double f)</td></tr>
<tr class="separator:a6a1838e9bb5e34e002ec7206359c07e1 inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81660da50daf6031078f40664627994d inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#a81660da50daf6031078f40664627994d">onRenderStatusStart</a> (int renderStatus)</td></tr>
<tr class="separator:a81660da50daf6031078f40664627994d inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b6d6975d4978f84b0e0cb5d60c25cc4 inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#a3b6d6975d4978f84b0e0cb5d60c25cc4">onRenderStatusEnd</a> (int renderStatus)</td></tr>
<tr class="separator:a3b6d6975d4978f84b0e0cb5d60c25cc4 inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affd1dfa5de168ea5b7cedeb88de538c4 inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#affd1dfa5de168ea5b7cedeb88de538c4">renderHasOwnership</a> ()</td></tr>
<tr class="separator:affd1dfa5de168ea5b7cedeb88de538c4 inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a7886866ea2228012cdf3c091f4135076"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_swatch_cache_manager.html">SwatchCacheManager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_swatch_cache_manager.html#a7886866ea2228012cdf3c091f4135076">instance</a> ()</td></tr>
<tr class="separator:a7886866ea2228012cdf3c091f4135076"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >The swatch cache delegate is used to temporary store intermediate rendering results in cache when an fx is being edited. Input fxs of an edited fx are typically requested to produce the same results multiple times as parameters of their schematic parent change - so, caching these results is a remunerative practice as long as the fx is open for edit.</p>
<p >This delegate stores resources on two different levels: one is directly related to swatch rendering, while the other is used to cache results on the other rendering contexts.</p>
<p >In the swatch case, we store the above mentioned input results associated with the current scene scale, releasing them when the scene scale changes; plus, the resource associated with the current output is also stored.</p>
<p >In other rendering contexts, the scene scale can be assumed constant - so the above distinction is unnecessary. All results from the input fxs are stored until the edited fx is unset from the swatch.</p>
<p >Please observe that variations in the scene context - such as frame change, schematic changes, scene changes and so on - actually cause the fx to be re-set for edit in the swatch. Once this happens, the previously stored results are conveniently flushed from the cache. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a59b924d9aaa54354f65ba16a4b336006" name="a59b924d9aaa54354f65ba16a4b336006"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59b924d9aaa54354f65ba16a4b336006">&#9670;&nbsp;</a></span>SwatchCacheManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SwatchCacheManager::SwatchCacheManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   89</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac938bf84c3f8346bb365504de229bb87" name="ac938bf84c3f8346bb365504de229bb87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac938bf84c3f8346bb365504de229bb87">&#9670;&nbsp;</a></span>~SwatchCacheManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SwatchCacheManager::~SwatchCacheManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   90</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6f65791ebee6f430e0192b98408522fe" name="a6f65791ebee6f430e0192b98408522fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f65791ebee6f430e0192b98408522fe">&#9670;&nbsp;</a></span>clearSwatchResults()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SwatchCacheManager::clearSwatchResults </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1192</span>                                            {</div>
<div class="line"><span class="lineno"> 1193</span>  QMutexLocker locker(&amp;m_mutex);</div>
<div class="line"><span class="lineno"> 1194</span> </div>
<div class="line"><span class="lineno"> 1195</span>  <span class="keywordflow">if</span> (m_currEditedFxResult) m_currEditedFxResult-&gt;releaseLock();</div>
<div class="line"><span class="lineno"> 1196</span>  m_currEditedFxResult = <a class="code hl_class" href="class_t_cache_resource_p.html">TCacheResourceP</a>();</div>
<div class="line"><span class="lineno"> 1197</span> </div>
<div class="line"><span class="lineno"> 1198</span>  std::set&lt;TCacheResourceP&gt;::iterator it;</div>
<div class="line"><span class="lineno"> 1199</span>  <span class="keywordflow">for</span> (it = m_swatchCacheContainer.begin(); it != m_swatchCacheContainer.end();</div>
<div class="line"><span class="lineno"> 1200</span>       ++it)</div>
<div class="line"><span class="lineno"> 1201</span>    (*it)-&gt;releaseLock();</div>
<div class="line"><span class="lineno"> 1202</span>  m_swatchCacheContainer.clear();</div>
<div class="line"><span class="lineno"> 1203</span>}</div>
<div class="ttc" id="aclass_t_cache_resource_p_html"><div class="ttname"><a href="class_t_cache_resource_p.html">TCacheResourceP</a></div><div class="ttdef"><b>Definition:</b> tcacheresource.h:245</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9dd145834b2dfe5cfd3970309ed1799" name="ad9dd145834b2dfe5cfd3970309ed1799"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9dd145834b2dfe5cfd3970309ed1799">&#9670;&nbsp;</a></span>getResource()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SwatchCacheManager::getResource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_cache_resource_p.html">TCacheResourceP</a> &amp;&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>alias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_smart_pointer_t.html">TFxP</a> &amp;&#160;</td>
          <td class="paramname"><em>fx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_render_settings.html">TRenderSettings</a> &amp;&#160;</td>
          <td class="paramname"><em>rs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_resource_declaration.html">ResourceDeclaration</a> *&#160;</td>
          <td class="paramname"><em>resData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="class_t_fx_cache_manager_delegate.html">TFxCacheManagerDelegate</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1210</span>                                                                   {</div>
<div class="line"><span class="lineno"> 1211</span>  <span class="comment">// Only FX RESULTS are interesting - plus, avoid if we&#39;re not currently</span></div>
<div class="line"><span class="lineno"> 1212</span>  <span class="comment">// editing an fx.</span></div>
<div class="line"><span class="lineno"> 1213</span>  <span class="keywordflow">if</span> (!(fx &amp;&amp; m_setFxId &gt; 0)) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>  QMutexLocker locker(&amp;m_mutex);</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span>  <span class="comment">// Cache the result in case the fx&#39;s id is among the stored ones.</span></div>
<div class="line"><span class="lineno"> 1218</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> fxId = fx-&gt;getIdentifier();</div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>  <span class="keywordflow">if</span> (fxId == m_setFxId &amp;&amp; rs.<a class="code hl_variable" href="class_t_render_settings.html#a4903fdcd70fc5cc539133ac3d7c53316">m_isSwatch</a>) {</div>
<div class="line"><span class="lineno"> 1221</span>    <span class="keywordflow">if</span> (!resource) resource = <a class="code hl_class" href="class_t_cache_resource_p.html">TCacheResourceP</a>(alias, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1222</span> </div>
<div class="line"><span class="lineno"> 1223</span>    resource-&gt;addLock();</div>
<div class="line"><span class="lineno"> 1224</span>    <span class="keywordflow">if</span> (m_currEditedFxResult) m_currEditedFxResult-&gt;releaseLock();</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>    m_currEditedFxResult = resource;</div>
<div class="line"><span class="lineno"> 1227</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1228</span>  }</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>  <span class="keywordflow">if</span> (m_childrenFxIds.find(fxId) != m_childrenFxIds.end()) {</div>
<div class="line"><span class="lineno"> 1231</span>    <span class="keywordflow">if</span> (!resource) resource = <a class="code hl_class" href="class_t_cache_resource_p.html">TCacheResourceP</a>(alias, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1232</span> </div>
<div class="line"><span class="lineno"> 1233</span>    <span class="keywordflow">if</span> (rs.<a class="code hl_variable" href="class_t_render_settings.html#a4903fdcd70fc5cc539133ac3d7c53316">m_isSwatch</a>) {</div>
<div class="line"><span class="lineno"> 1234</span>      std::set&lt;TCacheResourceP&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1235</span>          m_swatchCacheContainer.find(resource);</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>      <span class="keywordflow">if</span> (it == m_swatchCacheContainer.end()) {</div>
<div class="line"><span class="lineno"> 1238</span>        resource-&gt;addLock();</div>
<div class="line"><span class="lineno"> 1239</span>        m_swatchCacheContainer.insert(resource);</div>
<div class="line"><span class="lineno"> 1240</span>      }</div>
<div class="line"><span class="lineno"> 1241</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1242</span><span class="preprocessor">#ifdef USE_SQLITE_HDPOOL</span></div>
<div class="line"><span class="lineno"> 1243</span>      resource-&gt;enableBackup();</div>
<div class="line"><span class="lineno"> 1244</span>      TCacheResourcePool::instance()-&gt;addReference(resource, <span class="stringliteral">&quot;S&quot;</span>);</div>
<div class="line"><span class="lineno"> 1245</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1246</span>      std::set&lt;TCacheResourceP&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1247</span>          m_genericCacheContainer.find(resource);</div>
<div class="line"><span class="lineno"> 1248</span> </div>
<div class="line"><span class="lineno"> 1249</span>      <span class="keywordflow">if</span> (it == m_genericCacheContainer.end()) {</div>
<div class="line"><span class="lineno"> 1250</span>        resource-&gt;addLock();</div>
<div class="line"><span class="lineno"> 1251</span>        m_genericCacheContainer.insert(resource);</div>
<div class="line"><span class="lineno"> 1252</span>      }</div>
<div class="line"><span class="lineno"> 1253</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1254</span>    }</div>
<div class="line"><span class="lineno"> 1255</span>  }</div>
<div class="line"><span class="lineno"> 1256</span>}</div>
<div class="ttc" id="aclass_t_render_settings_html_a4903fdcd70fc5cc539133ac3d7c53316"><div class="ttname"><a href="class_t_render_settings.html#a4903fdcd70fc5cc539133ac3d7c53316">TRenderSettings::m_isSwatch</a></div><div class="ttdeci">bool m_isSwatch</div><div class="ttdef"><b>Definition:</b> trasterfx.h:136</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7886866ea2228012cdf3c091f4135076" name="a7886866ea2228012cdf3c091f4135076"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7886866ea2228012cdf3c091f4135076">&#9670;&nbsp;</a></span>instance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_swatch_cache_manager.html">SwatchCacheManager</a> * SwatchCacheManager::instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1125</span>                                                 {</div>
<div class="line"><span class="lineno"> 1126</span>  <span class="keyword">static</span> <a class="code hl_class" href="class_swatch_cache_manager.html">SwatchCacheManager</a> theInstance;</div>
<div class="line"><span class="lineno"> 1127</span>  <span class="keywordflow">return</span> &amp;theInstance;</div>
<div class="line"><span class="lineno"> 1128</span>}</div>
<div class="ttc" id="aclass_swatch_cache_manager_html"><div class="ttname"><a href="class_swatch_cache_manager.html">SwatchCacheManager</a></div><div class="ttdef"><b>Definition:</b> swatchviewer.cpp:76</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a823767e18dfec120165cd84945d18802" name="a823767e18dfec120165cd84945d18802"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a823767e18dfec120165cd84945d18802">&#9670;&nbsp;</a></span>renderHasOwnership()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SwatchCacheManager::renderHasOwnership </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="class_t_render_resource_manager.html">TRenderResourceManager</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  105</span>{ <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a46115a875ba194955bce7a18f4a3a083" name="a46115a875ba194955bce7a18f4a3a083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46115a875ba194955bce7a18f4a3a083">&#9670;&nbsp;</a></span>setFx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SwatchCacheManager::setFx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_smart_pointer_t.html">TFxP</a> &amp;&#160;</td>
          <td class="paramname"><em>actualFx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1132</span>                                             {</div>
<div class="line"><span class="lineno"> 1133</span>  QMutexLocker locker(&amp;m_mutex);</div>
<div class="line"><span class="lineno"> 1134</span> </div>
<div class="line"><span class="lineno"> 1135</span>  <span class="comment">// Update the fxs id data</span></div>
<div class="line"><span class="lineno"> 1136</span>  <span class="keywordflow">if</span> (fx == <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a>()) {</div>
<div class="line"><span class="lineno"> 1137</span>    <span class="comment">// Clear if no fx is set</span></div>
<div class="line"><span class="lineno"> 1138</span>    m_setFxId = 0;</div>
<div class="line"><span class="lineno"> 1139</span>    m_childrenFxIds.clear();</div>
<div class="line"><span class="lineno"> 1140</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1141</span>    m_setFxId = fx-&gt;getIdentifier();</div>
<div class="line"><span class="lineno"> 1142</span>    m_childrenFxIds.clear();</div>
<div class="line"><span class="lineno"> 1143</span>    assert(m_setFxId != 0);</div>
<div class="line"><span class="lineno"> 1144</span> </div>
<div class="line"><span class="lineno"> 1145</span>    <a class="code hl_class" href="class_t_raster_fx.html">TRasterFx</a> *rfx = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_raster_fx.html">TRasterFx</a> *<span class="keyword">&gt;</span>(fx.getPointer());</div>
<div class="line"><span class="lineno"> 1146</span>    assert(rfx);</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fx-&gt;getInputPortCount(); ++i) {</div>
<div class="line"><span class="lineno"> 1149</span>      <span class="comment">// Fxs not allowing cache on the input port are skipped</span></div>
<div class="line"><span class="lineno"> 1150</span>      <span class="keywordflow">if</span> (!rfx-&gt;allowUserCacheOnPort(i)) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1151</span> </div>
<div class="line"><span class="lineno"> 1152</span>      <a class="code hl_class" href="class_t_fx_port.html">TFxPort</a> *iport = fx-&gt;getInputPort(i);</div>
<div class="line"><span class="lineno"> 1153</span>      <span class="keywordflow">if</span> (iport &amp;&amp; iport-&gt;isConnected()) {</div>
<div class="line"><span class="lineno"> 1154</span>        <a class="code hl_class" href="class_t_fx.html">TFx</a> *child = iport-&gt;getFx();</div>
<div class="line"><span class="lineno"> 1155</span> </div>
<div class="line"><span class="lineno"> 1156</span>        <span class="comment">// In the zerary case, extract the actual fx</span></div>
<div class="line"><span class="lineno"> 1157</span>        <a class="code hl_class" href="class_t_zerary_column_fx.html">TZeraryColumnFx</a> *zcfx = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_zerary_column_fx.html">TZeraryColumnFx</a> *<span class="keyword">&gt;</span>(child);</div>
<div class="line"><span class="lineno"> 1158</span>        <span class="keywordflow">if</span> (zcfx) child       = zcfx-&gt;getZeraryFx();</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>        assert(child &amp;&amp; child-&gt;getIdentifier() != 0);</div>
<div class="line"><span class="lineno"> 1161</span>        m_childrenFxIds.insert(child-&gt;getIdentifier());</div>
<div class="line"><span class="lineno"> 1162</span>      }</div>
<div class="line"><span class="lineno"> 1163</span>    }</div>
<div class="line"><span class="lineno"> 1164</span>  }</div>
<div class="line"><span class="lineno"> 1165</span> </div>
<div class="line"><span class="lineno"> 1166</span>  <span class="comment">// NOTE: Check if this should be avoided in some case...</span></div>
<div class="line"><span class="lineno"> 1167</span> </div>
<div class="line"><span class="lineno"> 1168</span>  <span class="comment">// Release the locks and clear the resources</span></div>
<div class="line"><span class="lineno"> 1169</span>  <span class="keywordflow">if</span> (m_currEditedFxResult) m_currEditedFxResult-&gt;releaseLock();</div>
<div class="line"><span class="lineno"> 1170</span>  m_currEditedFxResult = <a class="code hl_class" href="class_t_cache_resource_p.html">TCacheResourceP</a>();</div>
<div class="line"><span class="lineno"> 1171</span> </div>
<div class="line"><span class="lineno"> 1172</span>  std::set&lt;TCacheResourceP&gt;::iterator it;</div>
<div class="line"><span class="lineno"> 1173</span>  <span class="keywordflow">for</span> (it = m_swatchCacheContainer.begin(); it != m_swatchCacheContainer.end();</div>
<div class="line"><span class="lineno"> 1174</span>       ++it)</div>
<div class="line"><span class="lineno"> 1175</span>    (*it)-&gt;releaseLock();</div>
<div class="line"><span class="lineno"> 1176</span>  m_swatchCacheContainer.clear();</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span><span class="preprocessor">#ifdef USE_SQLITE_HDPOOL</span></div>
<div class="line"><span class="lineno"> 1179</span>  TCacheResourcePool::instance()-&gt;releaseReferences(<span class="stringliteral">&quot;S&quot;</span>);</div>
<div class="line"><span class="lineno"> 1180</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1181</span>  <span class="keywordflow">for</span> (it = m_genericCacheContainer.begin();</div>
<div class="line"><span class="lineno"> 1182</span>       it != m_genericCacheContainer.end(); ++it)</div>
<div class="line"><span class="lineno"> 1183</span>    (*it)-&gt;releaseLock();</div>
<div class="line"><span class="lineno"> 1184</span>  m_genericCacheContainer.clear();</div>
<div class="line"><span class="lineno"> 1185</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1186</span>}</div>
<div class="ttc" id="aclass_t_fx_html"><div class="ttname"><a href="class_t_fx.html">TFx</a></div><div class="ttdef"><b>Definition:</b> tfx.h:352</div></div>
<div class="ttc" id="aclass_t_fx_port_html"><div class="ttname"><a href="class_t_fx_port.html">TFxPort</a></div><div class="ttdef"><b>Definition:</b> tfx.h:43</div></div>
<div class="ttc" id="aclass_t_raster_fx_html"><div class="ttname"><a href="class_t_raster_fx.html">TRasterFx</a></div><div class="ttdoc">TRasterFx is the base class for any renderable Toonz Fx.</div><div class="ttdef"><b>Definition:</b> tfxdef.h:74</div></div>
<div class="ttc" id="aclass_t_smart_pointer_t_html"><div class="ttname"><a href="class_t_smart_pointer_t.html">TSmartPointerT&lt; TFx &gt;</a></div></div>
<div class="ttc" id="aclass_t_zerary_column_fx_html"><div class="ttname"><a href="class_t_zerary_column_fx.html">TZeraryColumnFx</a></div><div class="ttdef"><b>Definition:</b> tcolumnfx.h:176</div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>E:/opentoonz/toonz/sources/toonzqt/<a class="el" href="">swatchviewer.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
