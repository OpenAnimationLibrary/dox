<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: TLevelWriterTzl Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="class_t_level_writer_tzl-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">TLevelWriterTzl Class Reference<span class="mlabels"><span class="mlabel">final</span></span></div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for TLevelWriterTzl:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_t_level_writer_tzl.png" usemap="#TLevelWriterTzl_map" alt=""/>
  <map id="TLevelWriterTzl_map" name="TLevelWriterTzl_map">
<area href="class_t_level_writer.html" alt="TLevelWriter" shape="rect" coords="0,56,100,80"/>
<area href="class_t_smart_object.html" alt="TSmartObject" shape="rect" coords="0,0,100,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aaa8bf8d9232828c7231a0c7f91faacaa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#aaa8bf8d9232828c7231a0c7f91faacaa">TLevelWriterTzl</a> (const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;path, <a class="el" href="class_t_property_group.html">TPropertyGroup</a> *winfo)</td></tr>
<tr class="separator:aaa8bf8d9232828c7231a0c7f91faacaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67e9bda1d1213888e101677e9df61496"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#a67e9bda1d1213888e101677e9df61496">setPalette</a> (<a class="el" href="class_t_palette.html">TPalette</a> *palette) override</td></tr>
<tr class="separator:a67e9bda1d1213888e101677e9df61496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c3bad6d9871bdcc57befa492636b77b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#a3c3bad6d9871bdcc57befa492636b77b">setOverwritePaletteFlag</a> (bool overwrite) override</td></tr>
<tr class="separator:a3c3bad6d9871bdcc57befa492636b77b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52b3d608e4f3efea6185df0da82288b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#a52b3d608e4f3efea6185df0da82288b3">renumberFids</a> (const std::map&lt; <a class="el" href="class_t_frame_id.html">TFrameId</a>, <a class="el" href="class_t_frame_id.html">TFrameId</a> &gt; &amp;renumberTable) override</td></tr>
<tr class="memdesc:a52b3d608e4f3efea6185df0da82288b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps a list of existing level frames to a new list of frames.  <a href="class_t_level_writer_tzl.html#a52b3d608e4f3efea6185df0da82288b3">More...</a><br /></td></tr>
<tr class="separator:a52b3d608e4f3efea6185df0da82288b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae9d3879deb37fcc5b6cd8ded0089b4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#aae9d3879deb37fcc5b6cd8ded0089b4b">setIconSize</a> (<a class="el" href="class_t_dimension_t.html">TDimension</a> iconSize) override</td></tr>
<tr class="separator:aae9d3879deb37fcc5b6cd8ded0089b4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0071cabf4d4c23fbfb64c847677aaa2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_dimension_t.html">TDimension</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#ad0071cabf4d4c23fbfb64c847677aaa2">getIconSize</a> () const override</td></tr>
<tr class="separator:ad0071cabf4d4c23fbfb64c847677aaa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ac7a3a9170610c78f1aa2d486fc934c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_image_writer_p.html">TImageWriterP</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#a8ac7a3a9170610c78f1aa2d486fc934c">getFrameWriter</a> (<a class="el" href="class_t_frame_id.html">TFrameId</a> fid) override</td></tr>
<tr class="separator:a8ac7a3a9170610c78f1aa2d486fc934c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab71207fb203b45c857e1d6d78b65b9b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#ab71207fb203b45c857e1d6d78b65b9b2">save</a> (const <a class="el" href="class_t_smart_pointer_t.html">TImageP</a> &amp;img)</td></tr>
<tr class="separator:ab71207fb203b45c857e1d6d78b65b9b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02e09a8ab99455f1aeb3518501055067"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#a02e09a8ab99455f1aeb3518501055067">save</a> (const <a class="el" href="class_t_smart_pointer_t.html">TImageP</a> &amp;img, const <a class="el" href="class_t_frame_id.html">TFrameId</a> &amp;fid)</td></tr>
<tr class="separator:a02e09a8ab99455f1aeb3518501055067"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0e510c90f1b17ecef03a9df85e2480"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#a3e0e510c90f1b17ecef03a9df85e2480">saveIcon</a> (const <a class="el" href="class_t_smart_pointer_t.html">TImageP</a> &amp;img, const <a class="el" href="class_t_frame_id.html">TFrameId</a> &amp;fid)</td></tr>
<tr class="separator:a3e0e510c90f1b17ecef03a9df85e2480"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47766e2b57e1b830af0d4f0cde36d48e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#a47766e2b57e1b830af0d4f0cde36d48e">checkIconSize</a> (const <a class="el" href="class_t_dimension_t.html">TDimension</a> &amp;newSize)</td></tr>
<tr class="memdesc:a47766e2b57e1b830af0d4f0cde36d48e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks the icons size stored inside an already existing level file, and compares it with the specified newSize.  <a href="class_t_level_writer_tzl.html#a47766e2b57e1b830af0d4f0cde36d48e">More...</a><br /></td></tr>
<tr class="separator:a47766e2b57e1b830af0d4f0cde36d48e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac54e00cebbb44364eda8eda05cd046aa"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#ac54e00cebbb44364eda8eda05cd046aa">resizeIcons</a> (const <a class="el" href="class_t_dimension_t.html">TDimension</a> &amp;newSize)</td></tr>
<tr class="separator:ac54e00cebbb44364eda8eda05cd046aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a912407df1edf71bbd8ab6a643ad4994c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#a912407df1edf71bbd8ab6a643ad4994c">remove</a> (const <a class="el" href="class_t_frame_id.html">TFrameId</a> &amp;fid)</td></tr>
<tr class="separator:a912407df1edf71bbd8ab6a643ad4994c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a014f5fcd43fc973231caff83a1c4aa2a"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#a014f5fcd43fc973231caff83a1c4aa2a">getFreeSpace</a> ()</td></tr>
<tr class="separator:a014f5fcd43fc973231caff83a1c4aa2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaea2ac5affb123a89dd812b52140fe28"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#aaea2ac5affb123a89dd812b52140fe28">optimize</a> ()</td></tr>
<tr class="separator:aaea2ac5affb123a89dd812b52140fe28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_t_level_writer"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_t_level_writer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_t_level_writer.html">TLevelWriter</a></td></tr>
<tr class="memitem:a72e02a2dcef7343d13df225e28719ab9 inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a72e02a2dcef7343d13df225e28719ab9">TLevelWriter</a> (const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;path, <a class="el" href="class_t_property_group.html">TPropertyGroup</a> *winfo=0)</td></tr>
<tr class="separator:a72e02a2dcef7343d13df225e28719ab9 inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8798dad86101c3acdd60d0ed4edfdde2 inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a8798dad86101c3acdd60d0ed4edfdde2">setCreator</a> (const QString &amp;creator)</td></tr>
<tr class="separator:a8798dad86101c3acdd60d0ed4edfdde2 inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a0693afefd5d89138a35fa29d4b9859 inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a7a0693afefd5d89138a35fa29d4b9859">setPalette</a> (<a class="el" href="class_t_palette.html">TPalette</a> *)</td></tr>
<tr class="separator:a7a0693afefd5d89138a35fa29d4b9859 inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9601072045f5255ec54be59b74ee0c69 inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a9601072045f5255ec54be59b74ee0c69">setOverwritePaletteFlag</a> (bool overwrite)</td></tr>
<tr class="separator:a9601072045f5255ec54be59b74ee0c69 inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa060a07f822355ccb029882f437407b9 inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#aa060a07f822355ccb029882f437407b9">renumberFids</a> (const std::map&lt; <a class="el" href="class_t_frame_id.html">TFrameId</a>, <a class="el" href="class_t_frame_id.html">TFrameId</a> &gt; &amp;table)</td></tr>
<tr class="memdesc:aa060a07f822355ccb029882f437407b9 inherit pub_methods_class_t_level_writer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps a list of existing level frames to a new list of frames.  <a href="class_t_level_writer.html#aa060a07f822355ccb029882f437407b9">More...</a><br /></td></tr>
<tr class="separator:aa060a07f822355ccb029882f437407b9 inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9630158c2c53a60eeda102f28a4aae5c inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a9630158c2c53a60eeda102f28a4aae5c">setIconSize</a> (<a class="el" href="class_t_dimension_t.html">TDimension</a>)</td></tr>
<tr class="separator:a9630158c2c53a60eeda102f28a4aae5c inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae59dd2773a9e5320b0e71d6dfc524ea3 inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="class_t_dimension_t.html">TDimension</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#ae59dd2773a9e5320b0e71d6dfc524ea3">getIconSize</a> () const</td></tr>
<tr class="separator:ae59dd2773a9e5320b0e71d6dfc524ea3 inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63e3cf77eab8eeb149fdd61c2c22098a inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="class_t_image_writer_p.html">TImageWriterP</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a63e3cf77eab8eeb149fdd61c2c22098a">getFrameWriter</a> (<a class="el" href="class_t_frame_id.html">TFrameId</a>)</td></tr>
<tr class="separator:a63e3cf77eab8eeb149fdd61c2c22098a inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4df06bd26b5a1845af406cdd2466c10e inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_image_writer_p.html">TImageWriterP</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a4df06bd26b5a1845af406cdd2466c10e">getFrameWriter</a> (int f)</td></tr>
<tr class="separator:a4df06bd26b5a1845af406cdd2466c10e inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c450ab74f58f08c3b72880ccbfd1fef inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_property_group.html">TPropertyGroup</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a7c450ab74f58f08c3b72880ccbfd1fef">getProperties</a> ()</td></tr>
<tr class="separator:a7c450ab74f58f08c3b72880ccbfd1fef inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78e2583ab05d360752c764cb5df6cc45 inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a78e2583ab05d360752c764cb5df6cc45">save</a> (const <a class="el" href="class_t_level_p.html">TLevelP</a> &amp;level)</td></tr>
<tr class="separator:a78e2583ab05d360752c764cb5df6cc45 inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a950ef5bb3fbba920489e2c93ab3d66dc inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a950ef5bb3fbba920489e2c93ab3d66dc">saveSoundTrack</a> (<a class="el" href="class_t_sound_track.html">TSoundTrack</a> *st)</td></tr>
<tr class="separator:a950ef5bb3fbba920489e2c93ab3d66dc inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e8e682d4fd9da62ffe0743a70914b6c inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a8e8e682d4fd9da62ffe0743a70914b6c">setFrameRate</a> (double fps)</td></tr>
<tr class="separator:a8e8e682d4fd9da62ffe0743a70914b6c inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d17e8a52fa677deb0b89fe52cc486a0 inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_file_path.html">TFilePath</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a6d17e8a52fa677deb0b89fe52cc486a0">getFilePath</a> () const</td></tr>
<tr class="separator:a6d17e8a52fa677deb0b89fe52cc486a0 inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a311f6645704af4f0379fca5586aad3a5 inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_t_content_history.html">TContentHistory</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a311f6645704af4f0379fca5586aad3a5">getContentHistory</a> () const</td></tr>
<tr class="separator:a311f6645704af4f0379fca5586aad3a5 inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8e702e8382e7aa79351ddbb7f8d243e inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_content_history.html">TContentHistory</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#aa8e702e8382e7aa79351ddbb7f8d243e">getContentHistory</a> ()</td></tr>
<tr class="separator:aa8e702e8382e7aa79351ddbb7f8d243e inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00f3e90adfcf8cf52681717907774ba2 inherit pub_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a00f3e90adfcf8cf52681717907774ba2">setContentHistory</a> (<a class="el" href="class_t_content_history.html">TContentHistory</a> *contentHistory)</td></tr>
<tr class="separator:a00f3e90adfcf8cf52681717907774ba2 inherit pub_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_t_smart_object"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_t_smart_object')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_t_smart_object.html">TSmartObject</a></td></tr>
<tr class="memitem:ab9a1e31b7e2b8c9b141fe9ce7e8cf489 inherit pub_methods_class_t_smart_object"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_smart_object.html#ab9a1e31b7e2b8c9b141fe9ce7e8cf489">TSmartObject</a> (ClassCode classCode)</td></tr>
<tr class="separator:ab9a1e31b7e2b8c9b141fe9ce7e8cf489 inherit pub_methods_class_t_smart_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a76a715c1785eb545fa3ef2f6e06928 inherit pub_methods_class_t_smart_object"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_smart_object.html#a4a76a715c1785eb545fa3ef2f6e06928">addRef</a> ()</td></tr>
<tr class="separator:a4a76a715c1785eb545fa3ef2f6e06928 inherit pub_methods_class_t_smart_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99750961461978d73f55a4a54e6f874e inherit pub_methods_class_t_smart_object"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_smart_object.html#a99750961461978d73f55a4a54e6f874e">release</a> ()</td></tr>
<tr class="separator:a99750961461978d73f55a4a54e6f874e inherit pub_methods_class_t_smart_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1f1dab21fd93f07fdf6c86661d738a5 inherit pub_methods_class_t_smart_object"><td class="memItemLeft" align="right" valign="top">TINT32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_smart_object.html#ac1f1dab21fd93f07fdf6c86661d738a5">getRefCount</a> () const</td></tr>
<tr class="separator:ac1f1dab21fd93f07fdf6c86661d738a5 inherit pub_methods_class_t_smart_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a48b83f490ee81907fa24a1f47d14d87f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_t_level_writer.html">TLevelWriter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer_tzl.html#a48b83f490ee81907fa24a1f47d14d87f">create</a> (const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;f, <a class="el" href="class_t_property_group.html">TPropertyGroup</a> *winfo)</td></tr>
<tr class="separator:a48b83f490ee81907fa24a1f47d14d87f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_class_t_level_writer"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_class_t_level_writer')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="class_t_level_writer.html">TLevelWriter</a></td></tr>
<tr class="memitem:aa1266647ee0e12127ecfb3eccd24a0c7 inherit pub_static_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#aa1266647ee0e12127ecfb3eccd24a0c7">getSupportedFormats</a> (QStringList &amp;names, bool onlyRenderFormats)</td></tr>
<tr class="separator:aa1266647ee0e12127ecfb3eccd24a0c7 inherit pub_static_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2b71be887d542ba608ec23bfc58317a inherit pub_static_methods_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#aa2b71be887d542ba608ec23bfc58317a">define</a> (QString extension, TLevelWriterCreateProc *proc, bool isRenderFormat)</td></tr>
<tr class="separator:aa2b71be887d542ba608ec23bfc58317a inherit pub_static_methods_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_class_t_smart_object"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_class_t_smart_object')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="class_t_smart_object.html">TSmartObject</a></td></tr>
<tr class="memitem:a41e6552e87694c0edba6acc7e57b5752 inherit pub_static_methods_class_t_smart_object"><td class="memItemLeft" align="right" valign="top">static TINT32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_smart_object.html#a41e6552e87694c0edba6acc7e57b5752">getInstanceCount</a> (ClassCode code)</td></tr>
<tr class="separator:a41e6552e87694c0edba6acc7e57b5752 inherit pub_static_methods_class_t_smart_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_class_t_smart_object"><td colspan="2" onclick="javascript:toggleInherit('pub_types_class_t_smart_object')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="class_t_smart_object.html">TSmartObject</a></td></tr>
<tr class="memitem:a3bc37f54976a445f30c99753a478feae inherit pub_types_class_t_smart_object"><td class="memItemLeft" align="right" valign="top">typedef short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_smart_object.html#a3bc37f54976a445f30c99753a478feae">ClassCode</a></td></tr>
<tr class="separator:a3bc37f54976a445f30c99753a478feae inherit pub_types_class_t_smart_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_class_t_level_writer"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_class_t_level_writer')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="class_t_level_writer.html">TLevelWriter</a></td></tr>
<tr class="memitem:ab305b98bccff4876fbe8482278248383 inherit pro_attribs_class_t_level_writer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_file_path.html">TFilePath</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#ab305b98bccff4876fbe8482278248383">m_path</a></td></tr>
<tr class="separator:ab305b98bccff4876fbe8482278248383 inherit pro_attribs_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0401656ef9f16668b97bccc8b125abe4 inherit pro_attribs_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a0401656ef9f16668b97bccc8b125abe4">m_frameRate</a></td></tr>
<tr class="separator:a0401656ef9f16668b97bccc8b125abe4 inherit pro_attribs_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cbebca27e1e22dcb23e11fec273818c inherit pro_attribs_class_t_level_writer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_property_group.html">TPropertyGroup</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a2cbebca27e1e22dcb23e11fec273818c">m_properties</a></td></tr>
<tr class="separator:a2cbebca27e1e22dcb23e11fec273818c inherit pro_attribs_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a404e0563ec9fb641079247a720860797 inherit pro_attribs_class_t_level_writer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_content_history.html">TContentHistory</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#a404e0563ec9fb641079247a720860797">m_contentHistory</a></td></tr>
<tr class="separator:a404e0563ec9fb641079247a720860797 inherit pro_attribs_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3ab74b5105fc1dafc1b72106f8a8609 inherit pro_attribs_class_t_level_writer"><td class="memItemLeft" align="right" valign="top">QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_level_writer.html#ae3ab74b5105fc1dafc1b72106f8a8609">m_creator</a></td></tr>
<tr class="separator:ae3ab74b5105fc1dafc1b72106f8a8609 inherit pro_attribs_class_t_level_writer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"></div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aaa8bf8d9232828c7231a0c7f91faacaa" name="aaa8bf8d9232828c7231a0c7f91faacaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa8bf8d9232828c7231a0c7f91faacaa">&#9670;&nbsp;</a></span>TLevelWriterTzl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TLevelWriterTzl::TLevelWriterTzl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_property_group.html">TPropertyGroup</a> *&#160;</td>
          <td class="paramname"><em>winfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  515</span>    : <a class="code hl_class" href="class_t_level_writer.html">TLevelWriter</a>(path, info)</div>
<div class="line"><span class="lineno">  516</span>    , m_headerWritten(<span class="keyword">false</span>)</div>
<div class="line"><span class="lineno">  517</span>    , m_creatorWritten(<span class="keyword">false</span>)</div>
<div class="line"><span class="lineno">  518</span>    , m_chan(0)</div>
<div class="line"><span class="lineno">  519</span>    , m_frameCountPos(0)</div>
<div class="line"><span class="lineno">  520</span>    , m_frameCount(0)</div>
<div class="line"><span class="lineno">  521</span>    , m_palette(0)</div>
<div class="line"><span class="lineno">  522</span>    , m_res(0, 0)</div>
<div class="line"><span class="lineno">  523</span>    , m_exists(<span class="keyword">false</span>)</div>
<div class="line"><span class="lineno">  524</span>    , m_version(currentVersion())</div>
<div class="line"><span class="lineno">  525</span>    , m_updatedIconsSize(<span class="keyword">false</span>)</div>
<div class="line"><span class="lineno">  526</span>    , m_currentIconSize(0, 0)</div>
<div class="line"><span class="lineno">  527</span>    , m_iconSize(<a class="code hl_class" href="class_t_dimension_t.html">TDimension</a>(80, 60))</div>
<div class="line"><span class="lineno">  528</span>    , m_userIconSize(<a class="code hl_class" href="class_t_dimension_t.html">TDimension</a>(80, 60))</div>
<div class="line"><span class="lineno">  529</span>    , m_adjustRatio(<span class="keyword">false</span>)</div>
<div class="line"><span class="lineno">  530</span>    , m_codec(<span class="keyword">new</span> <a class="code hl_class" href="class_t_raster_codec_l_z_o.html">TRasterCodecLZO</a>(<span class="stringliteral">&quot;LZO&quot;</span>, <span class="keyword">true</span>))</div>
<div class="line"><span class="lineno">  531</span>    , m_overwritePaletteFlag(<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  532</span>  m_path        = path;</div>
<div class="line"><span class="lineno">  533</span>  m_palettePath = path.withNoFrame().<a class="code hl_function" href="class_t_file_path.html#a1437b0e0720e9258b622f68b6858e95d">withType</a>(<span class="stringliteral">&quot;tpl&quot;</span>);</div>
<div class="line"><span class="lineno">  534</span>  <a class="code hl_class" href="class_t_file_status.html">TFileStatus</a> fs(path);</div>
<div class="line"><span class="lineno">  535</span>  m_magic     = (m_version == 14) ? <span class="stringliteral">&quot;TLV14B1a&quot;</span> : <span class="stringliteral">&quot;TLV15B1a&quot;</span>;  <span class="comment">// actual version</span></div>
<div class="line"><span class="lineno">  536</span>  erasedFrame = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  537</span>  <span class="comment">// version TLV10B1a: first version</span></div>
<div class="line"><span class="lineno">  538</span>  <span class="comment">// version TLV11B1a: added frameIds</span></div>
<div class="line"><span class="lineno">  539</span>  <span class="comment">// version TLV12B1a: incremental writings</span></div>
<div class="line"><span class="lineno">  540</span>  <span class="comment">// version TLV13B1a: added thumbnails</span></div>
<div class="line"><span class="lineno">  541</span>  <span class="comment">// version TLV14B1a: add creator string (fixed size = CREATOR_LENGTH char)</span></div>
<div class="line"><span class="lineno">  542</span>  <span class="comment">// version TLV15B1a: support multiple suffixes</span></div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>  <span class="keywordflow">if</span> (fs.doesExist()) {</div>
<div class="line"><span class="lineno">  545</span>    <span class="comment">// if (!fs.isWritable())</span></div>
<div class="line"><span class="lineno">  546</span>    m_chan = fopen(path, <span class="stringliteral">&quot;rb+&quot;</span>);</div>
<div class="line"><span class="lineno">  547</span>    <span class="comment">/*--- 誰かが開いている、または権限が無いとき ---*/</span></div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordflow">if</span> (!m_chan) {</div>
<div class="line"><span class="lineno">  549</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="class_t_system_exception.html">TSystemException</a>(path, <span class="stringliteral">&quot;can&#39;t fopen.&quot;</span>);</div>
<div class="line"><span class="lineno">  550</span>    }</div>
<div class="line"><span class="lineno">  551</span>    <span class="comment">/*--- TLVファイルのヘッダが正しく読めなかった場合 ---*/</span></div>
<div class="line"><span class="lineno">  552</span>    <span class="keywordflow">if</span> (!readHeaderAndOffsets(m_chan, m_frameOffsTable, m_iconOffsTable, m_res,</div>
<div class="line"><span class="lineno">  553</span>                              m_version, m_creator, &amp;m_frameCount,</div>
<div class="line"><span class="lineno">  554</span>                              &amp;m_offsetTablePos, &amp;m_iconOffsetTablePos, 0)) {</div>
<div class="line"><span class="lineno">  555</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="class_t_system_exception.html">TSystemException</a>(path, <span class="stringliteral">&quot;can&#39;t readHeaderAndOffsets.&quot;</span>);</div>
<div class="line"><span class="lineno">  556</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  557</span>      <span class="keywordflow">if</span> (m_version &gt;= 12) buildFreeChunksTable();</div>
<div class="line"><span class="lineno">  558</span>      m_headerWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  559</span>      m_exists        = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  560</span>      <span class="keywordflow">if</span> (m_version &gt;= 14)</div>
<div class="line"><span class="lineno">  561</span>        m_frameCountPos = 8 + CREATOR_LENGTH + 3 * <span class="keyword">sizeof</span>(TINT32);</div>
<div class="line"><span class="lineno">  562</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  563</span>        m_frameCountPos = 8 + 3 * <span class="keyword">sizeof</span>(TINT32);</div>
<div class="line"><span class="lineno">  564</span>    }</div>
<div class="line"><span class="lineno">  565</span>  }</div>
<div class="line"><span class="lineno">  566</span>  <span class="keywordflow">if</span> (!m_exists) {</div>
<div class="line"><span class="lineno">  567</span>    <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> parentDir = path.<a class="code hl_function" href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">getParentDir</a>();</div>
<div class="line"><span class="lineno">  568</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="class_t_file_status.html">TFileStatus</a>(parentDir).doesExist()) {</div>
<div class="line"><span class="lineno">  569</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  570</span>        TSystem::mkDir(parentDir);</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>      } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno">  573</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  574</span>      }</div>
<div class="line"><span class="lineno">  575</span>    }</div>
<div class="line"><span class="lineno">  576</span>    m_chan = fopen(path, <span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">if</span> (!m_chan) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">if</span> (!writeVersionAndCreator(m_chan, m_magic, m_creator)) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  579</span>  }</div>
<div class="line"><span class="lineno">  580</span>}</div>
<div class="ttc" id="aclass_t_dimension_t_html"><div class="ttname"><a href="class_t_dimension_t.html">TDimensionT&lt; int &gt;</a></div></div>
<div class="ttc" id="aclass_t_file_path_html"><div class="ttname"><a href="class_t_file_path.html">TFilePath</a></div><div class="ttdef"><b>Definition:</b> tfilepath.h:134</div></div>
<div class="ttc" id="aclass_t_file_path_html_a1437b0e0720e9258b622f68b6858e95d"><div class="ttname"><a href="class_t_file_path.html#a1437b0e0720e9258b622f68b6858e95d">TFilePath::withType</a></div><div class="ttdeci">TFilePath withType(const std::string &amp;type) const</div><div class="ttdef"><b>Definition:</b> tfilepath.cpp:774</div></div>
<div class="ttc" id="aclass_t_file_path_html_a1f5014e9c396bc2268820c19bc15657d"><div class="ttname"><a href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">TFilePath::getParentDir</a></div><div class="ttdeci">TFilePath getParentDir() const</div><div class="ttdef"><b>Definition:</b> tfilepath.cpp:683</div></div>
<div class="ttc" id="aclass_t_file_status_html"><div class="ttname"><a href="class_t_file_status.html">TFileStatus</a></div><div class="ttdef"><b>Definition:</b> tsystem.h:36</div></div>
<div class="ttc" id="aclass_t_level_writer_html"><div class="ttname"><a href="class_t_level_writer.html">TLevelWriter</a></div><div class="ttdef"><b>Definition:</b> tlevel_io.h:129</div></div>
<div class="ttc" id="aclass_t_raster_codec_l_z_o_html"><div class="ttname"><a href="class_t_raster_codec_l_z_o.html">TRasterCodecLZO</a></div><div class="ttdef"><b>Definition:</b> tcodec.h:136</div></div>
<div class="ttc" id="aclass_t_system_exception_html"><div class="ttname"><a href="class_t_system_exception.html">TSystemException</a></div><div class="ttdef"><b>Definition:</b> tsystem.h:65</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa0ca0b191422693160c34e9cb3d9dca1" name="aa0ca0b191422693160c34e9cb3d9dca1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0ca0b191422693160c34e9cb3d9dca1">&#9670;&nbsp;</a></span>~TLevelWriterTzl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TLevelWriterTzl::~TLevelWriterTzl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  584</span>                                  {</div>
<div class="line"><span class="lineno">  585</span>  <span class="keywordflow">if</span> (m_version &lt; currentVersion()) {</div>
<div class="line"><span class="lineno">  586</span>    <span class="keywordflow">if</span> (!convertToLatestVersion()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  587</span>    assert(m_version == currentVersion());</div>
<div class="line"><span class="lineno">  588</span>  }</div>
<div class="line"><span class="lineno">  589</span>  <span class="keyword">delete</span> m_codec;</div>
<div class="line"><span class="lineno">  590</span> </div>
<div class="line"><span class="lineno">  591</span>  TINT32 offsetMapPos     = 0;</div>
<div class="line"><span class="lineno">  592</span>  TINT32 iconOffsetMapPos = 0;</div>
<div class="line"><span class="lineno">  593</span>  <span class="keywordflow">if</span> (!m_chan) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>  assert(m_frameCount == (<span class="keywordtype">int</span>)m_frameOffsTable.size());</div>
<div class="line"><span class="lineno">  596</span>  assert(m_frameCount == (<span class="keywordtype">int</span>)m_iconOffsTable.size());</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>  offsetMapPos = (m_exists ? m_offsetTablePos : ftell(m_chan));</div>
<div class="line"><span class="lineno">  599</span>  fseek(m_chan, offsetMapPos, SEEK_SET);</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>  TzlOffsetMap::iterator it = m_frameOffsTable.begin();</div>
<div class="line"><span class="lineno">  602</span>  <span class="keywordflow">for</span> (; it != m_frameOffsTable.end(); ++it) {</div>
<div class="line"><span class="lineno">  603</span>    <a class="code hl_class" href="class_t_frame_id.html">TFrameId</a> fid      = it-&gt;first;</div>
<div class="line"><span class="lineno">  604</span>    TINT32 num        = fid.getNumber();</div>
<div class="line"><span class="lineno">  605</span>    QByteArray suffix = fid.getLetter().toUtf8();</div>
<div class="line"><span class="lineno">  606</span>    TINT32 offs       = it-&gt;second.m_offs;</div>
<div class="line"><span class="lineno">  607</span>    TINT32 length     = it-&gt;second.m_length;</div>
<div class="line"><span class="lineno">  608</span>    tfwrite(&amp;num, 1, m_chan);</div>
<div class="line"><span class="lineno">  609</span>    <span class="keywordflow">if</span> (m_version &gt;= 15) {  <span class="comment">// write the suffix length before data</span></div>
<div class="line"><span class="lineno">  610</span>      TINT32 suffixLength = suffix.size();</div>
<div class="line"><span class="lineno">  611</span>      tfwrite(&amp;suffixLength, 1, m_chan);</div>
<div class="line"><span class="lineno">  612</span>      tfwrite(suffix.constData(), suffixLength, m_chan);</div>
<div class="line"><span class="lineno">  613</span>    } <span class="keywordflow">else</span>  <span class="comment">// write only the first byte</span></div>
<div class="line"><span class="lineno">  614</span>      tfwrite(suffix.constData(), 1, m_chan);</div>
<div class="line"><span class="lineno">  615</span>    tfwrite(&amp;offs, 1, m_chan);</div>
<div class="line"><span class="lineno">  616</span>    tfwrite(&amp;length, 1, m_chan);</div>
<div class="line"><span class="lineno">  617</span>  }</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>  <span class="comment">// Write Icon Offset Table after frameOffsTable</span></div>
<div class="line"><span class="lineno">  620</span>  iconOffsetMapPos =</div>
<div class="line"><span class="lineno">  621</span>      ftell(m_chan);  <span class="comment">//(m_exists?m_iconOffsetTablePos: ftell(m_chan));</span></div>
<div class="line"><span class="lineno">  622</span>  fseek(m_chan, iconOffsetMapPos, SEEK_SET);</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>  TzlOffsetMap::iterator iconIt = m_iconOffsTable.begin();</div>
<div class="line"><span class="lineno">  625</span>  <span class="keywordflow">for</span> (; iconIt != m_iconOffsTable.end(); ++iconIt) {</div>
<div class="line"><span class="lineno">  626</span>    <a class="code hl_class" href="class_t_frame_id.html">TFrameId</a> fid           = iconIt-&gt;first;</div>
<div class="line"><span class="lineno">  627</span>    TINT32 num             = fid.getNumber();</div>
<div class="line"><span class="lineno">  628</span>    QByteArray suffix      = fid.getLetter().toUtf8();</div>
<div class="line"><span class="lineno">  629</span>    TINT32 thumbnailOffs   = iconIt-&gt;second.m_offs;</div>
<div class="line"><span class="lineno">  630</span>    TINT32 thumbnailLength = iconIt-&gt;second.m_length;</div>
<div class="line"><span class="lineno">  631</span>    tfwrite(&amp;num, 1, m_chan);</div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordflow">if</span> (m_version &gt;= 15) {  <span class="comment">// write the suffix length before data</span></div>
<div class="line"><span class="lineno">  633</span>      TINT32 suffixLength = suffix.size();</div>
<div class="line"><span class="lineno">  634</span>      tfwrite(&amp;suffixLength, 1, m_chan);</div>
<div class="line"><span class="lineno">  635</span>      tfwrite(suffix.constData(), suffixLength, m_chan);</div>
<div class="line"><span class="lineno">  636</span>    } <span class="keywordflow">else</span>  <span class="comment">// write only the first byte</span></div>
<div class="line"><span class="lineno">  637</span>      tfwrite(suffix.constData(), 1, m_chan);</div>
<div class="line"><span class="lineno">  638</span>    tfwrite(&amp;thumbnailOffs, 1, m_chan);</div>
<div class="line"><span class="lineno">  639</span>    tfwrite(&amp;thumbnailLength, 1, m_chan);</div>
<div class="line"><span class="lineno">  640</span>  }</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>  fseek(m_chan, m_frameCountPos, SEEK_SET);</div>
<div class="line"><span class="lineno">  643</span>  TINT32 frameCount = m_frameCount;</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>  tfwrite(&amp;frameCount, 1, m_chan);</div>
<div class="line"><span class="lineno">  646</span>  tfwrite(&amp;offsetMapPos, 1, m_chan);</div>
<div class="line"><span class="lineno">  647</span>  tfwrite(&amp;iconOffsetMapPos, 1, m_chan);</div>
<div class="line"><span class="lineno">  648</span>  fclose(m_chan);</div>
<div class="line"><span class="lineno">  649</span>  m_chan = 0;</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>  <span class="keywordflow">if</span> (m_palette &amp;&amp; m_overwritePaletteFlag &amp;&amp;</div>
<div class="line"><span class="lineno">  652</span>      (m_palette-&gt;<a class="code hl_function" href="class_t_palette.html#a4e573ec80c4779bcdb543e4b743a8c34">getDirtyFlag</a>() ||</div>
<div class="line"><span class="lineno">  653</span>       !TSystem::doesExistFileOrLevel(m_palettePath))) {</div>
<div class="line"><span class="lineno">  654</span>    <a class="code hl_class" href="class_t_o_stream.html">TOStream</a> os(m_palettePath);</div>
<div class="line"><span class="lineno">  655</span>    os &lt;&lt; m_palette;</div>
<div class="line"><span class="lineno">  656</span>    m_palette-&gt;release();</div>
<div class="line"><span class="lineno">  657</span>  }</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>  <span class="keywordflow">if</span> (m_contentHistory) {</div>
<div class="line"><span class="lineno">  660</span>    <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> historyFp = m_path.withNoFrame().<a class="code hl_function" href="class_t_file_path.html#a1437b0e0720e9258b622f68b6858e95d">withType</a>(<span class="stringliteral">&quot;hst&quot;</span>);</div>
<div class="line"><span class="lineno">  661</span>    FILE *historyChan   = fopen(historyFp, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  662</span>    <span class="keywordflow">if</span> (historyChan) {</div>
<div class="line"><span class="lineno">  663</span>      std::string historyData = m_contentHistory-&gt;<a class="code hl_function" href="class_t_content_history.html#aac53dd08c6fc7fa07ba1c8c5beb51131">serialize</a>().toStdString();</div>
<div class="line"><span class="lineno">  664</span>      fwrite(&amp;historyData[0], 1, historyData.length(), historyChan);</div>
<div class="line"><span class="lineno">  665</span>      fclose(historyChan);</div>
<div class="line"><span class="lineno">  666</span>    }</div>
<div class="line"><span class="lineno">  667</span>  }</div>
<div class="line"><span class="lineno">  668</span>  <span class="comment">// Se lo spazio libero (cioè la somma di tutti i buchi che si sono creati tra</span></div>
<div class="line"><span class="lineno">  669</span>  <span class="comment">// i frame)</span></div>
<div class="line"><span class="lineno">  670</span>  <span class="comment">// è maggiore di una certa soglia oppure è stato rimosso almeno un frame</span></div>
<div class="line"><span class="lineno">  671</span>  <span class="comment">// allora ottimizzo il file</span></div>
<div class="line"><span class="lineno">  672</span>  <span class="comment">// (in pratica risalvo il file da capo senza buchi).</span></div>
<div class="line"><span class="lineno">  673</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="class_t_level_writer_tzl.html#a014f5fcd43fc973231caff83a1c4aa2a">getFreeSpace</a>() &gt; 0.3 || erasedFrame) <a class="code hl_function" href="class_t_level_writer_tzl.html#aaea2ac5affb123a89dd812b52140fe28">optimize</a>();</div>
<div class="line"><span class="lineno">  674</span>}</div>
<div class="ttc" id="aclass_t_content_history_html_aac53dd08c6fc7fa07ba1c8c5beb51131"><div class="ttname"><a href="class_t_content_history.html#aac53dd08c6fc7fa07ba1c8c5beb51131">TContentHistory::serialize</a></div><div class="ttdeci">const QString serialize() const</div><div class="ttdoc">the returned string is only for visualitation and serialization</div><div class="ttdef"><b>Definition:</b> tcontenthistory.cpp:180</div></div>
<div class="ttc" id="aclass_t_frame_id_html"><div class="ttname"><a href="class_t_frame_id.html">TFrameId</a></div><div class="ttdef"><b>Definition:</b> tfilepath.h:29</div></div>
<div class="ttc" id="aclass_t_level_writer_tzl_html_a014f5fcd43fc973231caff83a1c4aa2a"><div class="ttname"><a href="class_t_level_writer_tzl.html#a014f5fcd43fc973231caff83a1c4aa2a">TLevelWriterTzl::getFreeSpace</a></div><div class="ttdeci">float getFreeSpace()</div><div class="ttdef"><b>Definition:</b> tiio_tzl.cpp:1388</div></div>
<div class="ttc" id="aclass_t_level_writer_tzl_html_aaea2ac5affb123a89dd812b52140fe28"><div class="ttname"><a href="class_t_level_writer_tzl.html#aaea2ac5affb123a89dd812b52140fe28">TLevelWriterTzl::optimize</a></div><div class="ttdeci">bool optimize()</div><div class="ttdef"><b>Definition:</b> tiio_tzl.cpp:1407</div></div>
<div class="ttc" id="aclass_t_o_stream_html"><div class="ttname"><a href="class_t_o_stream.html">TOStream</a></div><div class="ttdoc">Toonz's XML-like output file parser.</div><div class="ttdef"><b>Definition:</b> tstream.h:186</div></div>
<div class="ttc" id="aclass_t_palette_html_a4e573ec80c4779bcdb543e4b743a8c34"><div class="ttname"><a href="class_t_palette.html#a4e573ec80c4779bcdb543e4b743a8c34">TPalette::getDirtyFlag</a></div><div class="ttdeci">bool getDirtyFlag()</div><div class="ttdef"><b>Definition:</b> tpalette.h:247</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a47766e2b57e1b830af0d4f0cde36d48e" name="a47766e2b57e1b830af0d4f0cde36d48e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47766e2b57e1b830af0d4f0cde36d48e">&#9670;&nbsp;</a></span>checkIconSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TLevelWriterTzl::checkIconSize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_dimension_t.html">TDimension</a> &amp;&#160;</td>
          <td class="paramname"><em>newSize</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks the icons size stored inside an already existing level file, and compares it with the specified newSize. </p>
<dl class="section return"><dt>Returns</dt><dd>Whether the specified newSize <em>matches</em> the icons size in the level file. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1288</span>                                                             {</div>
<div class="line"><span class="lineno"> 1289</span>  assert(m_version &gt;= 13);</div>
<div class="line"><span class="lineno"> 1290</span> </div>
<div class="line"><span class="lineno"> 1291</span>  <span class="keywordflow">if</span> (!m_exists || m_iconOffsTable.empty() || !m_chan || m_version &lt; 13)</div>
<div class="line"><span class="lineno"> 1292</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1293</span> </div>
<div class="line"><span class="lineno"> 1294</span>  <span class="comment">// Read the size of icons in the file</span></div>
<div class="line"><span class="lineno"> 1295</span>  TINT32 iconLx = 0, iconLy = 0;</div>
<div class="line"><span class="lineno"> 1296</span> </div>
<div class="line"><span class="lineno"> 1297</span>  <span class="keywordtype">long</span> currentPos =</div>
<div class="line"><span class="lineno"> 1298</span>      ftell(m_chan);  <span class="comment">// Backup current reading position in the file</span></div>
<div class="line"><span class="lineno"> 1299</span> </div>
<div class="line"><span class="lineno"> 1300</span>  TzlOffsetMap::iterator it = m_iconOffsTable.begin();</div>
<div class="line"><span class="lineno"> 1301</span>  <span class="keywordtype">long</span> offs                 = it-&gt;second.m_offs;</div>
<div class="line"><span class="lineno"> 1302</span> </div>
<div class="line"><span class="lineno"> 1303</span>  fseek(m_chan, offs, SEEK_SET);</div>
<div class="line"><span class="lineno"> 1304</span> </div>
<div class="line"><span class="lineno"> 1305</span>  fread(&amp;iconLx, <span class="keyword">sizeof</span>(TINT32), 1, m_chan);</div>
<div class="line"><span class="lineno"> 1306</span>  fread(&amp;iconLy, <span class="keyword">sizeof</span>(TINT32), 1, m_chan);</div>
<div class="line"><span class="lineno"> 1307</span> </div>
<div class="line"><span class="lineno"> 1308</span>  fseek(m_chan, currentPos,</div>
<div class="line"><span class="lineno"> 1309</span>        SEEK_SET);  <span class="comment">// Reset to the original position in the file</span></div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>  assert(iconLx &gt; 0 &amp;&amp; iconLy &gt; 0);</div>
<div class="line"><span class="lineno"> 1312</span>  <span class="keywordflow">if</span> (iconLx &lt;= 0 || iconLy &lt;= 0 || iconLx &gt; m_res.lx || iconLy &gt; m_res.ly)</div>
<div class="line"><span class="lineno"> 1313</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1314</span> </div>
<div class="line"><span class="lineno"> 1315</span>  m_currentIconSize = <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a>(</div>
<div class="line"><span class="lineno"> 1316</span>      iconLx, iconLy);  <span class="comment">// This is not performed if the above pre-emptive</span></div>
<div class="line"><span class="lineno"> 1317</span>                        <span class="comment">// bailout kicks in. BTW, m_currentIconSize</span></div>
<div class="line"><span class="lineno"> 1318</span>                        <span class="comment">// is currently UNUSED! Should be cleaned up...</span></div>
<div class="line"><span class="lineno"> 1319</span>  <span class="comment">// Compare newSize against read icon size in the file</span></div>
<div class="line"><span class="lineno"> 1320</span>  <span class="keywordflow">return</span> (m_currentIconSize == newSize);</div>
<div class="line"><span class="lineno"> 1321</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="#l01254">setIconSize()</a>.</p>

</div>
</div>
<a id="a48b83f490ee81907fa24a1f47d14d87f" name="a48b83f490ee81907fa24a1f47d14d87f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48b83f490ee81907fa24a1f47d14d87f">&#9670;&nbsp;</a></span>create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="class_t_level_writer.html">TLevelWriter</a> * TLevelWriterTzl::create </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_property_group.html">TPropertyGroup</a> *&#160;</td>
          <td class="paramname"><em>winfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  111</span>                                                                         {</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_class" href="class_t_level_writer_tzl.html">TLevelWriterTzl</a>(f, winfo);</div>
<div class="line"><span class="lineno">  113</span>  }</div>
<div class="ttc" id="aclass_t_level_writer_tzl_html"><div class="ttname"><a href="class_t_level_writer_tzl.html">TLevelWriterTzl</a></div><div class="ttdef"><b>Definition:</b> tiio_tzl.h:33</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ac7a3a9170610c78f1aa2d486fc934c" name="a8ac7a3a9170610c78f1aa2d486fc934c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ac7a3a9170610c78f1aa2d486fc934c">&#9670;&nbsp;</a></span>getFrameWriter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_image_writer_p.html">TImageWriterP</a> TLevelWriterTzl::getFrameWriter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_frame_id.html">TFrameId</a>&#160;</td>
          <td class="paramname"><em>fid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="class_t_level_writer.html">TLevelWriter</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  678</span>                                                          {</div>
<div class="line"><span class="lineno">  679</span>  <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_class" href="class_t_image_writer_tzl.html">TImageWriterTzl</a>(<span class="keyword">this</span>, fid);</div>
<div class="line"><span class="lineno">  680</span>}</div>
<div class="ttc" id="aclass_t_image_writer_tzl_html"><div class="ttname"><a href="class_t_image_writer_tzl.html">TImageWriterTzl</a></div><div class="ttdef"><b>Definition:</b> tiio_tzl.cpp:393</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a014f5fcd43fc973231caff83a1c4aa2a" name="a014f5fcd43fc973231caff83a1c4aa2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a014f5fcd43fc973231caff83a1c4aa2a">&#9670;&nbsp;</a></span>getFreeSpace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float TLevelWriterTzl::getFreeSpace </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">  Da informazioni relativamente allo spazio libero presente su file.
  Ritorna un numero compreso tra 0 e 1: 0 nessuno spazio libero, 1
</pre><p> tutto lo spazio è libero. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1388</span>                                    {</div>
<div class="line"><span class="lineno"> 1389</span>  <span class="keywordflow">if</span> (m_exists &amp;&amp; m_version &gt;= 13) {</div>
<div class="line"><span class="lineno"> 1390</span>    TINT32 freeSpace                = 0;</div>
<div class="line"><span class="lineno"> 1391</span>    std::set&lt;TzlChunk&gt;::iterator it = m_freeChunks.begin();</div>
<div class="line"><span class="lineno"> 1392</span>    <span class="keywordflow">for</span> (; it != m_freeChunks.end(); ++it) freeSpace += it-&gt;m_length;</div>
<div class="line"><span class="lineno"> 1393</span> </div>
<div class="line"><span class="lineno"> 1394</span>    TINT32 totalSpace = 0;</div>
<div class="line"><span class="lineno"> 1395</span>    if (m_version == 13)</div>
<div class="line"><span class="lineno"> 1396</span>      totalSpace = m_offsetTablePos - 6 * <span class="keyword">sizeof</span>(TINT32) - 4 * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) -</div>
<div class="line"><span class="lineno"> 1397</span>                   8 * <span class="keyword">sizeof</span>(char);</div>
<div class="line"><span class="lineno"> 1398</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_version &gt;= 14)</div>
<div class="line"><span class="lineno"> 1399</span>      totalSpace = m_offsetTablePos - 6 * <span class="keyword">sizeof</span>(TINT32) - 4 * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) -</div>
<div class="line"><span class="lineno"> 1400</span>                   8 * <span class="keyword">sizeof</span>(char) - CREATOR_LENGTH * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>);</div>
<div class="line"><span class="lineno"> 1401</span>    assert(totalSpace &gt; 0);</div>
<div class="line"><span class="lineno"> 1402</span>    <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)freeSpace / totalSpace;</div>
<div class="line"><span class="lineno"> 1403</span>  }</div>
<div class="line"><span class="lineno"> 1404</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1405</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0071cabf4d4c23fbfb64c847677aaa2" name="ad0071cabf4d4c23fbfb64c847677aaa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0071cabf4d4c23fbfb64c847677aaa2">&#9670;&nbsp;</a></span>getIconSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_dimension_t.html">TDimension</a> TLevelWriterTzl::getIconSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="class_t_level_writer.html">TLevelWriter</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>{ <span class="keywordflow">return</span> m_iconSize; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaea2ac5affb123a89dd812b52140fe28" name="aaea2ac5affb123a89dd812b52140fe28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaea2ac5affb123a89dd812b52140fe28">&#9670;&nbsp;</a></span>optimize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TLevelWriterTzl::optimize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Save the file without freeSpace. Salva tutti i frame in maniera continua, senza buchi. Return TRUE if successfully. </p>
<div class="fragment"><div class="line"><span class="lineno"> 1407</span>                               {</div>
<div class="line"><span class="lineno"> 1408</span>  <a class="code hl_class" href="class_t_file_status.html">TFileStatus</a> fs(m_path);</div>
<div class="line"><span class="lineno"> 1409</span>  assert(fs.doesExist());</div>
<div class="line"><span class="lineno"> 1410</span> </div>
<div class="line"><span class="lineno"> 1411</span>  std::string tempName = <span class="stringliteral">&quot;~&quot;</span> + m_path.<a class="code hl_function" href="class_t_file_path.html#af94f9b0aeceb6cdb980fa1789473503a">getName</a>() + <span class="stringliteral">&quot;tmp&amp;.tlv&quot;</span>;</div>
<div class="line"><span class="lineno"> 1412</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> tempPath =</div>
<div class="line"><span class="lineno"> 1413</span>      TSystem::getTempDir() + tempName;  <span class="comment">// Path temporaneo del file ottimizzato</span></div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span>  <span class="keywordflow">if</span> (TSystem::doesExistFileOrLevel(tempPath)) TSystem::deleteFile(tempPath);</div>
<div class="line"><span class="lineno"> 1416</span> </div>
<div class="line"><span class="lineno"> 1417</span>  <a class="code hl_class" href="class_t_level_writer_p.html">TLevelWriterP</a> lw(tempPath);</div>
<div class="line"><span class="lineno"> 1418</span> </div>
<div class="line"><span class="lineno"> 1419</span>  <a class="code hl_class" href="class_t_level_reader_p.html">TLevelReaderP</a> lr(m_path);</div>
<div class="line"><span class="lineno"> 1420</span>  lw-&gt;setIconSize(m_userIconSize);</div>
<div class="line"><span class="lineno"> 1421</span>  <a class="code hl_class" href="class_t_level_p.html">TLevelP</a> level = lr-&gt;loadInfo();</div>
<div class="line"><span class="lineno"> 1422</span>  <span class="keywordflow">if</span> (!level || level-&gt;getFrameCount() == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1423</span>  TLevel::Iterator levelIt = level-&gt;begin();</div>
<div class="line"><span class="lineno"> 1424</span>  <span class="keywordflow">for</span> (; levelIt != level-&gt;end(); ++levelIt) {</div>
<div class="line"><span class="lineno"> 1425</span>    <a class="code hl_class" href="class_t_toonz_image_p.html">TToonzImageP</a> img = lr-&gt;getFrameReader(levelIt-&gt;first)-&gt;load();</div>
<div class="line"><span class="lineno"> 1426</span>    assert(img);</div>
<div class="line"><span class="lineno"> 1427</span>    lw-&gt;getFrameWriter(levelIt-&gt;first)-&gt;save(img);</div>
<div class="line"><span class="lineno"> 1428</span>  }</div>
<div class="line"><span class="lineno"> 1429</span>  lr = <a class="code hl_class" href="class_t_level_reader_p.html">TLevelReaderP</a>();</div>
<div class="line"><span class="lineno"> 1430</span>  lw = <a class="code hl_class" href="class_t_level_writer_p.html">TLevelWriterP</a>();</div>
<div class="line"><span class="lineno"> 1431</span> </div>
<div class="line"><span class="lineno"> 1432</span>  <span class="comment">// Se il file tempPath (ottimizzato) è stato creato</span></div>
<div class="line"><span class="lineno"> 1433</span>  <span class="comment">// lo copio sostituendolo ad m_path</span></div>
<div class="line"><span class="lineno"> 1434</span>  <span class="keywordflow">if</span> (TSystem::doesExistFileOrLevel(tempPath)) {</div>
<div class="line"><span class="lineno"> 1435</span>    assert(m_path != tempPath);</div>
<div class="line"><span class="lineno"> 1436</span>    <span class="keywordflow">if</span> (TSystem::doesExistFileOrLevel(m_path))</div>
<div class="line"><span class="lineno"> 1437</span>      TSystem::deleteFile(m_path);  <span class="comment">// Cancello il file non ottimizzato</span></div>
<div class="line"><span class="lineno"> 1438</span>    TSystem::copyFile(m_path, tempPath);</div>
<div class="line"><span class="lineno"> 1439</span>    TSystem::deleteFile(tempPath);</div>
<div class="line"><span class="lineno"> 1440</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1441</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1442</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1443</span>}</div>
<div class="ttc" id="aclass_t_file_path_html_af94f9b0aeceb6cdb980fa1789473503a"><div class="ttname"><a href="class_t_file_path.html#af94f9b0aeceb6cdb980fa1789473503a">TFilePath::getName</a></div><div class="ttdeci">std::string getName() const</div><div class="ttdef"><b>Definition:</b> tfilepath.cpp:636</div></div>
<div class="ttc" id="aclass_t_level_p_html"><div class="ttname"><a href="class_t_level_p.html">TLevelP</a></div><div class="ttdef"><b>Definition:</b> tlevel.h:77</div></div>
<div class="ttc" id="aclass_t_level_reader_p_html"><div class="ttname"><a href="class_t_level_reader_p.html">TLevelReaderP</a></div><div class="ttdef"><b>Definition:</b> tlevel_io.h:109</div></div>
<div class="ttc" id="aclass_t_level_writer_p_html"><div class="ttname"><a href="class_t_level_writer_p.html">TLevelWriterP</a></div><div class="ttdef"><b>Definition:</b> tlevel_io.h:214</div></div>
<div class="ttc" id="aclass_t_toonz_image_p_html"><div class="ttname"><a href="class_t_toonz_image_p.html">TToonzImageP</a></div><div class="ttdef"><b>Definition:</b> ttoonzimage.h:126</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00636">TFilePath::getName()</a>.</p>

</div>
</div>
<a id="a912407df1edf71bbd8ab6a643ad4994c" name="a912407df1edf71bbd8ab6a643ad4994c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a912407df1edf71bbd8ab6a643ad4994c">&#9670;&nbsp;</a></span>remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TLevelWriterTzl::remove </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_frame_id.html">TFrameId</a> &amp;&#160;</td>
          <td class="paramname"><em>fid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1227</span>                                                {</div>
<div class="line"><span class="lineno"> 1228</span>  TzlOffsetMap::iterator it = m_frameOffsTable.find(fid);</div>
<div class="line"><span class="lineno"> 1229</span>  <span class="comment">// se il fid non esiste non faccio nulla</span></div>
<div class="line"><span class="lineno"> 1230</span>  <span class="keywordflow">if</span> (it == m_frameOffsTable.end()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1231</span>  <span class="comment">// aggiungo spazio vuoto</span></div>
<div class="line"><span class="lineno"> 1232</span>  <span class="comment">// m_freeChunks.insert(TzlChunk(it-&gt;second.m_offs, it-&gt;second.m_length));</span></div>
<div class="line"><span class="lineno"> 1233</span>  addFreeChunk(it-&gt;second.m_offs, it-&gt;second.m_length);</div>
<div class="line"><span class="lineno"> 1234</span>  <span class="comment">// cancello l&#39;immagine dalla tabella</span></div>
<div class="line"><span class="lineno"> 1235</span>  m_frameOffsTable.erase(it);</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>  <span class="keywordflow">if</span> (m_iconOffsTable.size() &gt; 0) {</div>
<div class="line"><span class="lineno"> 1238</span>    TzlOffsetMap::iterator iconIt = m_iconOffsTable.find(fid);</div>
<div class="line"><span class="lineno"> 1239</span>    <span class="comment">// deve necessariamente esserci anche l&#39;iconcina</span></div>
<div class="line"><span class="lineno"> 1240</span>    assert(iconIt != m_iconOffsTable.end());</div>
<div class="line"><span class="lineno"> 1241</span>    <span class="keywordflow">if</span> (iconIt == m_iconOffsTable.end()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1242</span>    <span class="comment">// aggiungo spazio vuoto</span></div>
<div class="line"><span class="lineno"> 1243</span>    <span class="comment">// m_freeChunks.insert(TzlChunk(iconIt-&gt;second.m_offs,</span></div>
<div class="line"><span class="lineno"> 1244</span>    <span class="comment">// iconIt-&gt;second.m_length));</span></div>
<div class="line"><span class="lineno"> 1245</span>    addFreeChunk(iconIt-&gt;second.m_offs, iconIt-&gt;second.m_length);</div>
<div class="line"><span class="lineno"> 1246</span>    <span class="comment">// Cancello la relativa icona</span></div>
<div class="line"><span class="lineno"> 1247</span>    m_iconOffsTable.erase(iconIt);</div>
<div class="line"><span class="lineno"> 1248</span>    erasedFrame = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1249</span>  }</div>
<div class="line"><span class="lineno"> 1250</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a52b3d608e4f3efea6185df0da82288b3" name="a52b3d608e4f3efea6185df0da82288b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52b3d608e4f3efea6185df0da82288b3">&#9670;&nbsp;</a></span>renumberFids()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TLevelWriterTzl::renumberFids </td>
          <td>(</td>
          <td class="paramtype">const std::map&lt; <a class="el" href="class_t_frame_id.html">TFrameId</a>, <a class="el" href="class_t_frame_id.html">TFrameId</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>table</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maps a list of existing level frames to a new list of frames. </p>
<p >This function allows an existing level to reorganize (or discard) its <em>disk</em> content. It is typically implemented by TLevelWriters that support <em> random access writing &lt;\I&gt;, which can therefore write new frames on top of an existing level. <br  />
<br  />
This function requires that frames present on disk <em>and</em> in the table be remapped, while frames on disk <em>not</em> in the table be <b>deleted</b>. Eventual frames present in the table but not on disk are ignored. <br  />
<br  />
The default implementation provides renumbering for standard Toonz multi-file level types (levelName.####c.ext), and does nothing if the specified path is not compatible with the multi-file format. </em></p>

<p>Reimplemented from <a class="el" href="class_t_level_writer.html#aa060a07f822355ccb029882f437407b9">TLevelWriter</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1124</span>                                                     {</div>
<div class="line"><span class="lineno"> 1125</span>  m_renumberTable = renumberTable;</div>
<div class="line"><span class="lineno"> 1126</span>  <span class="keywordflow">if</span> (m_version &lt; 13) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1127</span>  <span class="keywordflow">if</span> (m_frameOffsTable.empty() || !m_exists) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>  <span class="comment">// Rimozione dei frame non presenti nella prima colonna di renumberTable</span></div>
<div class="line"><span class="lineno"> 1130</span>  std::map&lt;TFrameId, TzlChunk&gt; frameOffsTableTemp;</div>
<div class="line"><span class="lineno"> 1131</span>  frameOffsTableTemp        = m_frameOffsTable;</div>
<div class="line"><span class="lineno"> 1132</span>  TzlOffsetMap::iterator it = frameOffsTableTemp.begin();</div>
<div class="line"><span class="lineno"> 1133</span>  <span class="keywordflow">while</span> (it != frameOffsTableTemp.end()) {</div>
<div class="line"><span class="lineno"> 1134</span>    <a class="code hl_class" href="class_t_frame_id.html">TFrameId</a> fid                                     = it-&gt;first;</div>
<div class="line"><span class="lineno"> 1135</span>    std::map&lt;TFrameId, TFrameId&gt;::const_iterator it2 = renumberTable.find(fid);</div>
<div class="line"><span class="lineno"> 1136</span>    <span class="keywordflow">if</span> (it2 == renumberTable.end()) remove(fid);</div>
<div class="line"><span class="lineno"> 1137</span>    it++;</div>
<div class="line"><span class="lineno"> 1138</span>  }</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>  std::map&lt;TFrameId, TzlChunk&gt; frameOffsTable, iconOffsTable;</div>
<div class="line"><span class="lineno"> 1141</span>  <span class="comment">// Renumber Frame</span></div>
<div class="line"><span class="lineno"> 1142</span>  std::map&lt;TFrameId, TFrameId&gt;::const_iterator it3 = renumberTable.begin();</div>
<div class="line"><span class="lineno"> 1143</span>  <span class="keywordflow">while</span> (it3 != renumberTable.end()) {</div>
<div class="line"><span class="lineno"> 1144</span>    <a class="code hl_class" href="class_t_frame_id.html">TFrameId</a> fidToRenumber        = it3-&gt;first;</div>
<div class="line"><span class="lineno"> 1145</span>    TzlOffsetMap::iterator it     = m_frameOffsTable.find(fidToRenumber);</div>
<div class="line"><span class="lineno"> 1146</span>    TzlOffsetMap::iterator iconIt = m_iconOffsTable.find(fidToRenumber);</div>
<div class="line"><span class="lineno"> 1147</span>    <span class="keywordflow">if</span> (it != m_frameOffsTable.end()) frameOffsTable[it3-&gt;second] = it-&gt;second;</div>
<div class="line"><span class="lineno"> 1148</span>    <span class="keywordflow">if</span> (m_iconOffsTable.size() &gt; 0 &amp;&amp; iconIt != m_iconOffsTable.end())</div>
<div class="line"><span class="lineno"> 1149</span>      iconOffsTable[it3-&gt;second] = iconIt-&gt;second;</div>
<div class="line"><span class="lineno"> 1150</span>    it3++;</div>
<div class="line"><span class="lineno"> 1151</span>  }</div>
<div class="line"><span class="lineno"> 1152</span> </div>
<div class="line"><span class="lineno"> 1153</span>  m_frameOffsTable.clear();</div>
<div class="line"><span class="lineno"> 1154</span>  m_frameOffsTable = frameOffsTable;</div>
<div class="line"><span class="lineno"> 1155</span>  m_iconOffsTable.clear();</div>
<div class="line"><span class="lineno"> 1156</span>  m_iconOffsTable = iconOffsTable;</div>
<div class="line"><span class="lineno"> 1157</span>  m_frameCount    = m_frameOffsTable.size();</div>
<div class="line"><span class="lineno"> 1158</span>  <span class="comment">// buildFreeChunksTable();</span></div>
<div class="line"><span class="lineno"> 1159</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac54e00cebbb44364eda8eda05cd046aa" name="ac54e00cebbb44364eda8eda05cd046aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac54e00cebbb44364eda8eda05cd046aa">&#9670;&nbsp;</a></span>resizeIcons()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TLevelWriterTzl::resizeIcons </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_dimension_t.html">TDimension</a> &amp;&#160;</td>
          <td class="paramname"><em>newSize</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1325</span>                                                           {</div>
<div class="line"><span class="lineno"> 1326</span>  <span class="keywordflow">if</span> (!m_exists) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1327</span>  <span class="keywordflow">if</span> (m_iconOffsTable.empty()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1328</span>  <span class="keywordflow">if</span> (!m_chan) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1329</span>  assert(m_version &gt;= 13);</div>
<div class="line"><span class="lineno"> 1330</span> </div>
<div class="line"><span class="lineno"> 1331</span>  <span class="comment">// faccio una copia di m_path per poi usarla per la resizeIcons()</span></div>
<div class="line"><span class="lineno"> 1332</span>  fclose(m_chan);</div>
<div class="line"><span class="lineno"> 1333</span>  m_chan = 0;</div>
<div class="line"><span class="lineno"> 1334</span>  <a class="code hl_class" href="class_t_file_status.html">TFileStatus</a> fs(m_path);</div>
<div class="line"><span class="lineno"> 1335</span>  assert(fs.doesExist());</div>
<div class="line"><span class="lineno"> 1336</span>  <span class="keywordflow">if</span> (!fs.doesExist()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1337</span>  std::string tempName = <span class="stringliteral">&quot;~&quot;</span> + m_path.<a class="code hl_function" href="class_t_file_path.html#af94f9b0aeceb6cdb980fa1789473503a">getName</a>() + <span class="stringliteral">&quot;tmpIcon&amp;.tlv&quot;</span>;</div>
<div class="line"><span class="lineno"> 1338</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> tempPath   = TSystem::getTempDir() + tempName;</div>
<div class="line"><span class="lineno"> 1339</span>  <span class="keywordflow">if</span> (TSystem::doesExistFileOrLevel(m_path)) {</div>
<div class="line"><span class="lineno"> 1340</span>    assert(m_path != tempPath);</div>
<div class="line"><span class="lineno"> 1341</span>    <span class="keywordflow">if</span> (TSystem::doesExistFileOrLevel(tempPath)) TSystem::deleteFile(tempPath);</div>
<div class="line"><span class="lineno"> 1342</span>    TSystem::copyFile(tempPath, m_path);</div>
<div class="line"><span class="lineno"> 1343</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1344</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1345</span>  m_chan = fopen(m_path, <span class="stringliteral">&quot;rb+&quot;</span>);</div>
<div class="line"><span class="lineno"> 1346</span>  assert(m_chan);</div>
<div class="line"><span class="lineno"> 1347</span> </div>
<div class="line"><span class="lineno"> 1348</span>  assert(TSystem::doesExistFileOrLevel(tempPath));</div>
<div class="line"><span class="lineno"> 1349</span>  <span class="keywordflow">if</span> (!TSystem::doesExistFileOrLevel(tempPath)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1350</span>  <a class="code hl_class" href="class_t_level_reader_p.html">TLevelReaderP</a> lr(tempPath);</div>
<div class="line"><span class="lineno"> 1351</span>  <a class="code hl_class" href="class_t_level_p.html">TLevelP</a> level = lr-&gt;loadInfo();</div>
<div class="line"><span class="lineno"> 1352</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1353</span><span class="comment">  if(m_currentIconSize.lx&gt;newSize.lx &amp;&amp; m_currentIconSize.ly&gt;newSize.ly)</span></div>
<div class="line"><span class="lineno"> 1354</span><span class="comment">  {</span></div>
<div class="line"><span class="lineno"> 1355</span><span class="comment">          for(TLevel::Iterator it=level-&gt;begin(); it != level-&gt;end(); ++it)</span></div>
<div class="line"><span class="lineno"> 1356</span><span class="comment">          {</span></div>
<div class="line"><span class="lineno"> 1357</span><span class="comment">                  TImageReaderP ir = lr-&gt;getFrameReader(it-&gt;first);</span></div>
<div class="line"><span class="lineno"> 1358</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1359</span><span class="comment">                  // carico l&#39;iconcina</span></div>
<div class="line"><span class="lineno"> 1360</span><span class="comment">            TImageP img = ir-&gt;loadIcon();</span></div>
<div class="line"><span class="lineno"> 1361</span><span class="comment">                  TImageP icon;</span></div>
<div class="line"><span class="lineno"> 1362</span><span class="comment">                  createIcon(img,icon);</span></div>
<div class="line"><span class="lineno"> 1363</span><span class="comment">                  saveIcon(icon,it-&gt;first);</span></div>
<div class="line"><span class="lineno"> 1364</span><span class="comment">          }</span></div>
<div class="line"><span class="lineno"> 1365</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 1366</span><span class="comment">  else</span></div>
<div class="line"><span class="lineno"> 1367</span><span class="comment">  {              */</span></div>
<div class="line"><span class="lineno"> 1368</span>  <span class="comment">// leggo tutte le immagini da file e creo le iconcine da da zero</span></div>
<div class="line"><span class="lineno"> 1369</span>  <span class="keywordflow">for</span> (TLevel::Iterator it = level-&gt;begin(); it != level-&gt;end(); ++it) {</div>
<div class="line"><span class="lineno"> 1370</span>    <span class="comment">// carico l&#39;iconcina</span></div>
<div class="line"><span class="lineno"> 1371</span>    <a class="code hl_class" href="class_t_smart_pointer_t.html">TImageP</a> img = lr-&gt;getFrameReader(it-&gt;first)-&gt;load();</div>
<div class="line"><span class="lineno"> 1372</span>    <span class="comment">// creo e salvo</span></div>
<div class="line"><span class="lineno"> 1373</span>    <a class="code hl_class" href="class_t_smart_pointer_t.html">TImageP</a> icon;</div>
<div class="line"><span class="lineno"> 1374</span>    createIcon(img, icon);</div>
<div class="line"><span class="lineno"> 1375</span>    saveIcon(icon, it-&gt;first);</div>
<div class="line"><span class="lineno"> 1376</span>  }</div>
<div class="line"><span class="lineno"> 1377</span> </div>
<div class="line"><span class="lineno"> 1378</span>  <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1379</span>  lr = <a class="code hl_class" href="class_t_level_reader_p.html">TLevelReaderP</a>();</div>
<div class="line"><span class="lineno"> 1380</span>  <span class="comment">// delete m_tempPath</span></div>
<div class="line"><span class="lineno"> 1381</span>  <span class="keywordflow">if</span> (TSystem::doesExistFileOrLevel(tempPath)) {</div>
<div class="line"><span class="lineno"> 1382</span>    TSystem::deleteFile(tempPath);</div>
<div class="line"><span class="lineno"> 1383</span>  }</div>
<div class="line"><span class="lineno"> 1384</span> </div>
<div class="line"><span class="lineno"> 1385</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1386</span>}</div>
<div class="ttc" id="aclass_t_smart_pointer_t_html"><div class="ttname"><a href="class_t_smart_pointer_t.html">TSmartPointerT&lt; TImage &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab71207fb203b45c857e1d6d78b65b9b2" name="ab71207fb203b45c857e1d6d78b65b9b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab71207fb203b45c857e1d6d78b65b9b2">&#9670;&nbsp;</a></span>save() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TLevelWriterTzl::save </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_smart_pointer_t.html">TImageP</a> &amp;&#160;</td>
          <td class="paramname"><em>img</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1108</span>{ doSave(img, <a class="code hl_class" href="class_t_frame_id.html">TFrameId</a>()); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a02e09a8ab99455f1aeb3518501055067" name="a02e09a8ab99455f1aeb3518501055067"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02e09a8ab99455f1aeb3518501055067">&#9670;&nbsp;</a></span>save() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TLevelWriterTzl::save </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_smart_pointer_t.html">TImageP</a> &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_frame_id.html">TFrameId</a> &amp;&#160;</td>
          <td class="paramname"><em>fid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1105</span>                                                                  {</div>
<div class="line"><span class="lineno"> 1106</span>  doSave(img, fid);</div>
<div class="line"><span class="lineno"> 1107</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e0e510c90f1b17ecef03a9df85e2480" name="a3e0e510c90f1b17ecef03a9df85e2480"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e0e510c90f1b17ecef03a9df85e2480">&#9670;&nbsp;</a></span>saveIcon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TLevelWriterTzl::saveIcon </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_smart_pointer_t.html">TImageP</a> &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_frame_id.html">TFrameId</a> &amp;&#160;</td>
          <td class="paramname"><em>fid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1110</span>                                                                      {</div>
<div class="line"><span class="lineno"> 1111</span>  <span class="comment">// salvo su file come icona</span></div>
<div class="line"><span class="lineno"> 1112</span>  saveImage(img, fid, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1113</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae9d3879deb37fcc5b6cd8ded0089b4b" name="aae9d3879deb37fcc5b6cd8ded0089b4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae9d3879deb37fcc5b6cd8ded0089b4b">&#9670;&nbsp;</a></span>setIconSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TLevelWriterTzl::setIconSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_dimension_t.html">TDimension</a>&#160;</td>
          <td class="paramname"><em>iconSize</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">         Setta le dimensioni dell'iconcina nel file.
         ATTENZIONE: va necessariamente richiamata prima di
</pre><p> <a class="el" href="class_t_level_writer_tzl.html#a52b3d608e4f3efea6185df0da82288b3" title="Maps a list of existing level frames to a new list of frames.">renumberFids()</a>! </p>

<p>Reimplemented from <a class="el" href="class_t_level_writer.html">TLevelWriter</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1254</span>                                                     {</div>
<div class="line"><span class="lineno"> 1255</span>  assert(iconSize.lx &gt; 0 &amp;&amp; iconSize.ly &gt; 0);</div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span>  m_iconSize     = <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a>(iconSize.lx, iconSize.ly);</div>
<div class="line"><span class="lineno"> 1258</span>  m_userIconSize = <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a>(</div>
<div class="line"><span class="lineno"> 1259</span>      iconSize.lx, iconSize.ly);  <span class="comment">// Used in TLevelWriterTzl::optimize().</span></div>
<div class="line"><span class="lineno"> 1260</span>                                  <span class="comment">// Observe that m_iconSize may change below.</span></div>
<div class="line"><span class="lineno"> 1261</span>  <span class="keywordflow">if</span> (m_version &gt;= 13 &amp;&amp; m_exists) {</div>
<div class="line"><span class="lineno"> 1262</span>    <span class="comment">// A supported level file already exists at the specified path</span></div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>    <span class="comment">// Check whether icons stored in the file already</span></div>
<div class="line"><span class="lineno"> 1265</span>    <span class="comment">// have the required size</span></div>
<div class="line"><span class="lineno"> 1266</span>    <span class="keywordflow">if</span> (!m_updatedIconsSize)  <span class="comment">// m_updatedIconsSize tells whether</span></div>
<div class="line"><span class="lineno"> 1267</span>      m_updatedIconsSize =</div>
<div class="line"><span class="lineno"> 1268</span>          <a class="code hl_function" href="class_t_level_writer_tzl.html#a47766e2b57e1b830af0d4f0cde36d48e">checkIconSize</a>(m_iconSize);  <span class="comment">// icon sizes in the file match m_iconSize</span></div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span>    <span class="keywordflow">if</span> (!m_updatedIconsSize) {</div>
<div class="line"><span class="lineno"> 1271</span>      <span class="comment">// Icons in the stored file mismatch with the</span></div>
<div class="line"><span class="lineno"> 1272</span>      <span class="comment">// required size. They need to be resized.</span></div>
<div class="line"><span class="lineno"> 1273</span>      m_updatedIconsSize = resizeIcons(m_iconSize);</div>
<div class="line"><span class="lineno"> 1274</span>      assert(m_updatedIconsSize);</div>
<div class="line"><span class="lineno"> 1275</span>    }</div>
<div class="line"><span class="lineno"> 1276</span>  }</div>
<div class="line"><span class="lineno"> 1277</span>}</div>
<div class="ttc" id="aclass_t_level_writer_tzl_html_a47766e2b57e1b830af0d4f0cde36d48e"><div class="ttname"><a href="class_t_level_writer_tzl.html#a47766e2b57e1b830af0d4f0cde36d48e">TLevelWriterTzl::checkIconSize</a></div><div class="ttdeci">bool checkIconSize(const TDimension &amp;newSize)</div><div class="ttdoc">Checks the icons size stored inside an already existing level file, and compares it with the specifie...</div><div class="ttdef"><b>Definition:</b> tiio_tzl.cpp:1288</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l01288">checkIconSize()</a>.</p>

</div>
</div>
<a id="a3c3bad6d9871bdcc57befa492636b77b" name="a3c3bad6d9871bdcc57befa492636b77b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c3bad6d9871bdcc57befa492636b77b">&#9670;&nbsp;</a></span>setOverwritePaletteFlag()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TLevelWriterTzl::setOverwritePaletteFlag </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>overwrite</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="class_t_level_writer.html">TLevelWriter</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   69</span>                                                        {</div>
<div class="line"><span class="lineno">   70</span>    m_overwritePaletteFlag = overwrite;</div>
<div class="line"><span class="lineno">   71</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a67e9bda1d1213888e101677e9df61496" name="a67e9bda1d1213888e101677e9df61496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67e9bda1d1213888e101677e9df61496">&#9670;&nbsp;</a></span>setPalette()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TLevelWriterTzl::setPalette </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette.html">TPalette</a> *&#160;</td>
          <td class="paramname"><em>palette</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="class_t_level_writer.html">TLevelWriter</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1116</span>                                                  {</div>
<div class="line"><span class="lineno"> 1117</span>  <span class="keywordflow">if</span> (!m_palette) {</div>
<div class="line"><span class="lineno"> 1118</span>    m_palette = palette;</div>
<div class="line"><span class="lineno"> 1119</span>    m_palette-&gt;addRef();</div>
<div class="line"><span class="lineno"> 1120</span>  }</div>
<div class="line"><span class="lineno"> 1121</span>}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>E:/opentoonz/toonz/sources/image/tzl/<a class="el" href="">tiio_tzl.h</a></li>
<li>E:/opentoonz/toonz/sources/image/tzl/<a class="el" href="">tiio_tzl.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
