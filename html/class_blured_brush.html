<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: BluredBrush Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_blured_brush-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">BluredBrush Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4fd7053a6994351091aa58f8b28b0a49"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_blured_brush.html#a4fd7053a6994351091aa58f8b28b0a49">BluredBrush</a> (const <a class="el" href="class_t_raster_p_t.html">TRaster32P</a> &amp;ras, int size, const QRadialGradient &amp;gradient, bool doDynamicOpacity)</td></tr>
<tr class="separator:a4fd7053a6994351091aa58f8b28b0a49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae70010abd97eb8de59285169563d9387"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_blured_brush.html#ae70010abd97eb8de59285169563d9387">addPoint</a> (const <a class="el" href="class_t_thick_point.html">TThickPoint</a> &amp;p, double opacity)</td></tr>
<tr class="separator:ae70010abd97eb8de59285169563d9387"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee1baee2f7fc5e65c1f32a7549230d14"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_blured_brush.html#aee1baee2f7fc5e65c1f32a7549230d14">addArc</a> (const <a class="el" href="class_t_thick_point.html">TThickPoint</a> &amp;pa, const <a class="el" href="class_t_thick_point.html">TThickPoint</a> &amp;pb, const <a class="el" href="class_t_thick_point.html">TThickPoint</a> &amp;pc, double opacityA, double opacityC)</td></tr>
<tr class="separator:aee1baee2f7fc5e65c1f32a7549230d14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae02d735d718ffa93ad3604888600463c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_rect_t.html">TRect</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_blured_brush.html#ae02d735d718ffa93ad3604888600463c">getBoundFromPoints</a> (const std::vector&lt; <a class="el" href="class_t_thick_point.html">TThickPoint</a> &gt; &amp;points) const</td></tr>
<tr class="separator:ae02d735d718ffa93ad3604888600463c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31fccd519dfb3bc063bccb6473292493"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_blured_brush.html#a31fccd519dfb3bc063bccb6473292493">updateDrawing</a> (const <a class="el" href="class_t_raster_p_t.html">TRasterCM32P</a> rasCM, const <a class="el" href="class_t_raster_p_t.html">TRasterCM32P</a> rasBackupCM, const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;bbox, int styleId, int drawOrderMode, bool lockAlpha) const</td></tr>
<tr class="separator:a31fccd519dfb3bc063bccb6473292493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a709316ebf36981cd70650e59b748a381"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_blured_brush.html#a709316ebf36981cd70650e59b748a381">eraseDrawing</a> (const <a class="el" href="class_t_raster_p_t.html">TRasterCM32P</a> rasCM, const <a class="el" href="class_t_raster_p_t.html">TRasterCM32P</a> rasBackupCM, const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;bbox, bool selective, int selectedStyleId, const std::wstring &amp;mode) const</td></tr>
<tr class="separator:a709316ebf36981cd70650e59b748a381"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee3f2487431e31023231423abfbee250"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_blured_brush.html#aee3f2487431e31023231423abfbee250">setAboveStyleIds</a> (QSet&lt; int &gt; &amp;ids)</td></tr>
<tr class="separator:aee3f2487431e31023231423abfbee250"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43419288deb3a79283feabe10dbae67e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_blured_brush.html#a43419288deb3a79283feabe10dbae67e">updateDrawing</a> (const <a class="el" href="class_t_smart_pointer_t.html">TRasterP</a> ras, const <a class="el" href="class_t_smart_pointer_t.html">TRasterP</a> rasBackup, const TPixel32 &amp;color, const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;bbox, double opacity) const</td></tr>
<tr class="separator:a43419288deb3a79283feabe10dbae67e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbc5d9e8a7d7bd5dc7b1f4de96d1cc46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_blured_brush.html#abbc5d9e8a7d7bd5dc7b1f4de96d1cc46">eraseDrawing</a> (const <a class="el" href="class_t_smart_pointer_t.html">TRasterP</a> ras, const <a class="el" href="class_t_smart_pointer_t.html">TRasterP</a> rasBackup, const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;bbox, double opacity) const</td></tr>
<tr class="separator:abbc5d9e8a7d7bd5dc7b1f4de96d1cc46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"></div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4fd7053a6994351091aa58f8b28b0a49" name="a4fd7053a6994351091aa58f8b28b0a49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fd7053a6994351091aa58f8b28b0a49">&#9670;&nbsp;</a></span>BluredBrush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BluredBrush::BluredBrush </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_raster_p_t.html">TRaster32P</a> &amp;&#160;</td>
          <td class="paramname"><em>ras</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QRadialGradient &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>doDynamicOpacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  178</span>    : m_ras(ras)</div>
<div class="line"><span class="lineno">  179</span>    , m_size(size)</div>
<div class="line"><span class="lineno">  180</span>    , m_lastPoint(0, 0)</div>
<div class="line"><span class="lineno">  181</span>    , m_oldOpacity(0)</div>
<div class="line"><span class="lineno">  182</span>    , m_enableDynamicOpacity(doDynamicOpacity) {</div>
<div class="line"><span class="lineno">  183</span>  m_rasImage = rasterToQImage(m_ras, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  184</span>  m_gradient = gradient;</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>  <span class="keywordflow">if</span> (colorTable.size() == 0) {</div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordflow">for</span> (i = 0; i &lt; 256; i++) colorTable.append(QColor(i, i, i).rgb());</div>
<div class="line"><span class="lineno">  189</span>  }</div>
<div class="line"><span class="lineno">  190</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ff637d9d362a8980d887318c2996ee0" name="a2ff637d9d362a8980d887318c2996ee0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ff637d9d362a8980d887318c2996ee0">&#9670;&nbsp;</a></span>~BluredBrush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BluredBrush::~BluredBrush </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  194</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aee1baee2f7fc5e65c1f32a7549230d14" name="aee1baee2f7fc5e65c1f32a7549230d14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee1baee2f7fc5e65c1f32a7549230d14">&#9670;&nbsp;</a></span>addArc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BluredBrush::addArc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_thick_point.html">TThickPoint</a> &amp;&#160;</td>
          <td class="paramname"><em>pa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_thick_point.html">TThickPoint</a> &amp;&#160;</td>
          <td class="paramname"><em>pb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_thick_point.html">TThickPoint</a> &amp;&#160;</td>
          <td class="paramname"><em>pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>opacityA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>opacityC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  222</span>                                          {</div>
<div class="line"><span class="lineno">  223</span>  QPainter painter(&amp;m_rasImage);</div>
<div class="line"><span class="lineno">  224</span>  painter.setRenderHint(QPainter::Antialiasing);</div>
<div class="line"><span class="lineno">  225</span>  painter.setPen(Qt::NoPen);</div>
<div class="line"><span class="lineno">  226</span>  <span class="comment">// painter.setBrush(m_gradient);</span></div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>  <a class="code hl_class" href="class_t_thick_quadratic.html">TThickQuadratic</a> q(pa, pb, pc);</div>
<div class="line"><span class="lineno">  229</span>  <span class="keywordtype">double</span> brushRadius = m_size * 0.5;</div>
<div class="line"><span class="lineno">  230</span>  <span class="keywordtype">double</span> t           = 0;</div>
<div class="line"><span class="lineno">  231</span>  <span class="keywordflow">while</span> (t &lt;= 1) {</div>
<div class="line"><span class="lineno">  232</span>    t = getNextPadPosition(q, t);</div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordflow">if</span> (t &gt; 1) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_class" href="class_t_thick_point.html">TThickPoint</a> point  = q.getThickPoint(t);</div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordtype">double</span> radius      = point.thick * 0.5;</div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordtype">double</span> scaleFactor = radius / brushRadius;</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>    painter.setMatrix(QMatrix(scaleFactor, 0.0, 0.0, scaleFactor,</div>
<div class="line"><span class="lineno">  239</span>                              point.x - radius, point.y - radius),</div>
<div class="line"><span class="lineno">  240</span>                      <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordflow">if</span> (m_enableDynamicOpacity) {</div>
<div class="line"><span class="lineno">  242</span>      <span class="keywordtype">double</span> opacity = opacityA + ((opacityC - opacityA) * t);</div>
<div class="line"><span class="lineno">  243</span>      <span class="keywordflow">if</span> (fabs(opacity - m_oldOpacity) &gt; 0.01)</div>
<div class="line"><span class="lineno">  244</span>        opacity =</div>
<div class="line"><span class="lineno">  245</span>            opacity &gt; m_oldOpacity ? m_oldOpacity + 0.01 : m_oldOpacity - 0.01;</div>
<div class="line"><span class="lineno">  246</span>      painter.setOpacity(opacity);</div>
<div class="line"><span class="lineno">  247</span>      painter.setCompositionMode(QPainter::CompositionMode_DestinationAtop);</div>
<div class="line"><span class="lineno">  248</span>      m_oldOpacity = opacity;</div>
<div class="line"><span class="lineno">  249</span>      painter.setBrush(QColor(0, 0, 0, 255));</div>
<div class="line"><span class="lineno">  250</span>    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  251</span>      painter.setBrush(m_gradient);</div>
<div class="line"><span class="lineno">  252</span>    painter.drawEllipse(0, 0, m_size, m_size);</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>    m_lastPoint = point;</div>
<div class="line"><span class="lineno">  255</span>  }</div>
<div class="line"><span class="lineno">  256</span>  painter.end();</div>
<div class="line"><span class="lineno">  257</span>}</div>
<div class="ttc" id="aclass_t_thick_point_html"><div class="ttname"><a href="class_t_thick_point.html">TThickPoint</a></div><div class="ttdef"><b>Definition:</b> tgeometry.h:366</div></div>
<div class="ttc" id="aclass_t_thick_quadratic_html"><div class="ttname"><a href="class_t_thick_quadratic.html">TThickQuadratic</a></div><div class="ttdef"><b>Definition:</b> tcurves.h:416</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae70010abd97eb8de59285169563d9387" name="ae70010abd97eb8de59285169563d9387"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae70010abd97eb8de59285169563d9387">&#9670;&nbsp;</a></span>addPoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BluredBrush::addPoint </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_thick_point.html">TThickPoint</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>opacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  198</span>                                                               {</div>
<div class="line"><span class="lineno">  199</span>  <span class="keywordtype">double</span> radius      = p.thick * 0.5;</div>
<div class="line"><span class="lineno">  200</span>  <span class="keywordtype">double</span> brushRadius = m_size * 0.5;</div>
<div class="line"><span class="lineno">  201</span>  <span class="keywordtype">double</span> scaleFactor = radius / brushRadius;</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>  QPainter painter(&amp;m_rasImage);</div>
<div class="line"><span class="lineno">  204</span>  painter.setRenderHint(QPainter::Antialiasing);</div>
<div class="line"><span class="lineno">  205</span>  painter.setPen(Qt::NoPen);</div>
<div class="line"><span class="lineno">  206</span>  painter.setBrush(m_gradient);</div>
<div class="line"><span class="lineno">  207</span>  painter.setMatrix(</div>
<div class="line"><span class="lineno">  208</span>      QMatrix(scaleFactor, 0.0, 0.0, scaleFactor, p.x - radius, p.y - radius),</div>
<div class="line"><span class="lineno">  209</span>      <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  210</span>  <span class="keywordflow">if</span> (m_enableDynamicOpacity) painter.setOpacity(opacity);</div>
<div class="line"><span class="lineno">  211</span>  painter.drawEllipse(0, 0, m_size, m_size);</div>
<div class="line"><span class="lineno">  212</span>  painter.end();</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>  m_lastPoint  = p;</div>
<div class="line"><span class="lineno">  215</span>  m_oldOpacity = opacity;</div>
<div class="line"><span class="lineno">  216</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a709316ebf36981cd70650e59b748a381" name="a709316ebf36981cd70650e59b748a381"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a709316ebf36981cd70650e59b748a381">&#9670;&nbsp;</a></span>eraseDrawing() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BluredBrush::eraseDrawing </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_raster_p_t.html">TRasterCM32P</a>&#160;</td>
          <td class="paramname"><em>rasCM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_raster_p_t.html">TRasterCM32P</a>&#160;</td>
          <td class="paramname"><em>rasBackupCM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;&#160;</td>
          <td class="paramname"><em>bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>selective</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>selectedStyleId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::wstring &amp;&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  405</span>                                                             {</div>
<div class="line"><span class="lineno">  406</span>  <span class="keywordflow">if</span> (!rasCM) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> rasRect    = rasCM-&gt;getBounds();</div>
<div class="line"><span class="lineno">  409</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> targetRect = bbox * rasRect;</div>
<div class="line"><span class="lineno">  410</span>  <span class="keywordflow">if</span> (targetRect.<a class="code hl_function" href="class_t_rect_t.html#a53ce09c6112f8a019b43ad82d721a93b">isEmpty</a>()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>  rasCM-&gt;extract(targetRect)-&gt;copy(rasBackupCM-&gt;extract(targetRect));</div>
<div class="line"><span class="lineno">  413</span>  eraseFromRasterCM(rasCM-&gt;extract(targetRect), m_ras-&gt;extract(targetRect),</div>
<div class="line"><span class="lineno">  414</span>                    selective, selectedStyleId, mode);</div>
<div class="line"><span class="lineno">  415</span>}</div>
<div class="ttc" id="aclass_t_rect_t_html"><div class="ttname"><a href="class_t_rect_t.html">TRectT&lt; int &gt;</a></div></div>
<div class="ttc" id="aclass_t_rect_t_html_a53ce09c6112f8a019b43ad82d721a93b"><div class="ttname"><a href="class_t_rect_t.html#a53ce09c6112f8a019b43ad82d721a93b">TRectT::isEmpty</a></div><div class="ttdeci">bool isEmpty() const</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abbc5d9e8a7d7bd5dc7b1f4de96d1cc46" name="abbc5d9e8a7d7bd5dc7b1f4de96d1cc46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbc5d9e8a7d7bd5dc7b1f4de96d1cc46">&#9670;&nbsp;</a></span>eraseDrawing() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BluredBrush::eraseDrawing </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_smart_pointer_t.html">TRasterP</a>&#160;</td>
          <td class="paramname"><em>ras</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_smart_pointer_t.html">TRasterP</a>&#160;</td>
          <td class="paramname"><em>rasBackup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;&#160;</td>
          <td class="paramname"><em>bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>opacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  339</span>                                                                        {</div>
<div class="line"><span class="lineno">  340</span>  <span class="keywordflow">if</span> (!ras) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> rasRect    = ras-&gt;getBounds();</div>
<div class="line"><span class="lineno">  343</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> targetRect = bbox * rasRect;</div>
<div class="line"><span class="lineno">  344</span>  <span class="keywordflow">if</span> (targetRect.<a class="code hl_function" href="class_t_rect_t.html#a53ce09c6112f8a019b43ad82d721a93b">isEmpty</a>()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  345</span>  QRect qTargetRect(targetRect.<a class="code hl_variable" href="class_t_rect_t.html#ac008cbc625f50d8b3c180c8eb2594cdb">x0</a>, targetRect.y0, targetRect.getLx(),</div>
<div class="line"><span class="lineno">  346</span>                    targetRect.getLy());</div>
<div class="line"><span class="lineno">  347</span>  <span class="keywordflow">if</span> (ras-&gt;getPixelSize() == 4) {</div>
<div class="line"><span class="lineno">  348</span>    QImage image = rasterToQImage(ras, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  349</span>    QPainter p(&amp;image);</div>
<div class="line"><span class="lineno">  350</span>    p.setClipRect(qTargetRect);</div>
<div class="line"><span class="lineno">  351</span>    p.setCompositionMode(QPainter::CompositionMode_Source);</div>
<div class="line"><span class="lineno">  352</span>    p.drawImage(qTargetRect, rasterToQImage(rasBackup, <span class="keyword">true</span>), qTargetRect);</div>
<div class="line"><span class="lineno">  353</span>    p.setCompositionMode(QPainter::CompositionMode_DestinationOut);</div>
<div class="line"><span class="lineno">  354</span>    p.setOpacity(opacity);</div>
<div class="line"><span class="lineno">  355</span>    p.drawImage(qTargetRect, m_rasImage, qTargetRect);</div>
<div class="line"><span class="lineno">  356</span>    p.end();</div>
<div class="line"><span class="lineno">  357</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ras-&gt;getPixelSize() != 4) {</div>
<div class="line"><span class="lineno">  358</span>    QImage targetImage = rasterToQImage(rasBackup).copy(qTargetRect);</div>
<div class="line"><span class="lineno">  359</span>    targetImage        = targetImage.convertToFormat(</div>
<div class="line"><span class="lineno">  360</span>        QImage::Format_ARGB32_Premultiplied, colorTable);</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>    QImage app(qTargetRect.size(), QImage::Format_ARGB32_Premultiplied);</div>
<div class="line"><span class="lineno">  363</span>    QPainter p2(&amp;app);</div>
<div class="line"><span class="lineno">  364</span>    p2.setBrush(QColor(255, 255, 255));</div>
<div class="line"><span class="lineno">  365</span>    p2.drawRect(app.rect().adjusted(-1, -1, 0, 0));</div>
<div class="line"><span class="lineno">  366</span>    p2.setCompositionMode(QPainter::CompositionMode_DestinationIn);</div>
<div class="line"><span class="lineno">  367</span>    p2.drawImage(QPoint(), m_rasImage, qTargetRect);</div>
<div class="line"><span class="lineno">  368</span>    p2.end();</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>    QPainter p(&amp;targetImage);</div>
<div class="line"><span class="lineno">  371</span>    p.setOpacity(opacity);</div>
<div class="line"><span class="lineno">  372</span>    p.drawImage(QPoint(), app, app.rect());</div>
<div class="line"><span class="lineno">  373</span>    p.end();</div>
<div class="line"><span class="lineno">  374</span>    targetImage =</div>
<div class="line"><span class="lineno">  375</span>        targetImage.convertToFormat(QImage::Format_Indexed8, colorTable);</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>    <a class="code hl_class" href="class_t_raster_p_t.html">TRasterGR8P</a> targetRas = rasterFromQImage(targetImage);</div>
<div class="line"><span class="lineno">  378</span>    ras-&gt;copy(targetRas, targetRect.getP00());</div>
<div class="line"><span class="lineno">  379</span>  }</div>
<div class="line"><span class="lineno">  380</span>}</div>
<div class="ttc" id="aclass_t_raster_p_t_html"><div class="ttname"><a href="class_t_raster_p_t.html">TRasterPT&lt; TPixelGR8 &gt;</a></div></div>
<div class="ttc" id="aclass_t_rect_t_html_ac008cbc625f50d8b3c180c8eb2594cdb"><div class="ttname"><a href="class_t_rect_t.html#ac008cbc625f50d8b3c180c8eb2594cdb">TRectT::x0</a></div><div class="ttdeci">T x0</div><div class="ttdef"><b>Definition:</b> tgeometry.h:557</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae02d735d718ffa93ad3604888600463c" name="ae02d735d718ffa93ad3604888600463c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae02d735d718ffa93ad3604888600463c">&#9670;&nbsp;</a></span>getBoundFromPoints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_rect_t.html">TRect</a> BluredBrush::getBoundFromPoints </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="class_t_thick_point.html">TThickPoint</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  420</span>                                                {</div>
<div class="line"><span class="lineno">  421</span>  assert(points.size() &lt;= 3);</div>
<div class="line"><span class="lineno">  422</span>  <a class="code hl_class" href="class_t_thick_point.html">TThickPoint</a> p = points[0];</div>
<div class="line"><span class="lineno">  423</span>  <span class="keywordtype">double</span> radius = p.thick * 0.5;</div>
<div class="line"><span class="lineno">  424</span>  <a class="code hl_class" href="class_t_rect_t.html">TRectD</a> rectD(p - <a class="code hl_class" href="class_t_point_t.html">TPointD</a>(radius, radius), p + <a class="code hl_class" href="class_t_point_t.html">TPointD</a>(radius, radius));</div>
<div class="line"><span class="lineno">  425</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  426</span>  <span class="keywordflow">for</span> (i = 1; i &lt; (int)points.size(); i++) {</div>
<div class="line"><span class="lineno">  427</span>    p      = points[i];</div>
<div class="line"><span class="lineno">  428</span>    radius = p.thick * 0.5;</div>
<div class="line"><span class="lineno">  429</span>    rectD  = rectD +</div>
<div class="line"><span class="lineno">  430</span>            <a class="code hl_class" href="class_t_rect_t.html">TRectD</a>(p - <a class="code hl_class" href="class_t_point_t.html">TPointD</a>(radius, radius), p + <a class="code hl_class" href="class_t_point_t.html">TPointD</a>(radius, radius));</div>
<div class="line"><span class="lineno">  431</span>  }</div>
<div class="line"><span class="lineno">  432</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> rect(tfloor(rectD.x0), tfloor(rectD.y0), tceil(rectD.x1),</div>
<div class="line"><span class="lineno">  433</span>             tceil(rectD.y1));</div>
<div class="line"><span class="lineno">  434</span>  <span class="keywordflow">return</span> rect;</div>
<div class="line"><span class="lineno">  435</span>}</div>
<div class="ttc" id="aclass_t_point_t_html"><div class="ttname"><a href="class_t_point_t.html">TPointT&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aee3f2487431e31023231423abfbee250" name="aee3f2487431e31023231423abfbee250"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee3f2487431e31023231423abfbee250">&#9670;&nbsp;</a></span>setAboveStyleIds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void BluredBrush::setAboveStyleIds </td>
          <td>(</td>
          <td class="paramtype">QSet&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>ids</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   49</span>{ m_aboveStyleIds = ids; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a31fccd519dfb3bc063bccb6473292493" name="a31fccd519dfb3bc063bccb6473292493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31fccd519dfb3bc063bccb6473292493">&#9670;&nbsp;</a></span>updateDrawing() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BluredBrush::updateDrawing </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_raster_p_t.html">TRasterCM32P</a>&#160;</td>
          <td class="paramname"><em>rasCM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_raster_p_t.html">TRasterCM32P</a>&#160;</td>
          <td class="paramname"><em>rasBackupCM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;&#160;</td>
          <td class="paramname"><em>bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>styleId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>drawOrderMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>lockAlpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  387</span>                                                                         {</div>
<div class="line"><span class="lineno">  388</span>  <span class="keywordflow">if</span> (!rasCM) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> rasRect    = rasCM-&gt;getBounds();</div>
<div class="line"><span class="lineno">  391</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> targetRect = bbox * rasRect;</div>
<div class="line"><span class="lineno">  392</span>  <span class="keywordflow">if</span> (targetRect.<a class="code hl_function" href="class_t_rect_t.html#a53ce09c6112f8a019b43ad82d721a93b">isEmpty</a>()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>  rasCM-&gt;copy(rasBackupCM-&gt;extract(targetRect), targetRect.getP00());</div>
<div class="line"><span class="lineno">  395</span>  putOnRasterCM(rasCM-&gt;extract(targetRect), m_ras-&gt;extract(targetRect), styleId,</div>
<div class="line"><span class="lineno">  396</span>                drawOrderMode, lockAlpha, m_aboveStyleIds);</div>
<div class="line"><span class="lineno">  397</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a43419288deb3a79283feabe10dbae67e" name="a43419288deb3a79283feabe10dbae67e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43419288deb3a79283feabe10dbae67e">&#9670;&nbsp;</a></span>updateDrawing() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BluredBrush::updateDrawing </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_smart_pointer_t.html">TRasterP</a>&#160;</td>
          <td class="paramname"><em>ras</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_smart_pointer_t.html">TRasterP</a>&#160;</td>
          <td class="paramname"><em>rasBackup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TPixel32 &amp;&#160;</td>
          <td class="paramname"><em>color</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_rect_t.html">TRect</a> &amp;&#160;</td>
          <td class="paramname"><em>bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>opacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  292</span>                                                      {</div>
<div class="line"><span class="lineno">  293</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> rasRect    = ras-&gt;getBounds();</div>
<div class="line"><span class="lineno">  294</span>  <a class="code hl_class" href="class_t_rect_t.html">TRect</a> targetRect = bbox * rasRect;</div>
<div class="line"><span class="lineno">  295</span>  <span class="keywordflow">if</span> (targetRect.<a class="code hl_function" href="class_t_rect_t.html#a53ce09c6112f8a019b43ad82d721a93b">isEmpty</a>()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  296</span>  QImage image = rasterToQImage(ras, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  297</span>  QRect qTargetRect(targetRect.<a class="code hl_variable" href="class_t_rect_t.html#ac008cbc625f50d8b3c180c8eb2594cdb">x0</a>, targetRect.y0, targetRect.getLx(),</div>
<div class="line"><span class="lineno">  298</span>                    targetRect.getLy());</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>  QImage app(qTargetRect.size(), QImage::Format_ARGB32_Premultiplied);</div>
<div class="line"><span class="lineno">  301</span>  QPainter p2(&amp;app);</div>
<div class="line"><span class="lineno">  302</span>  p2.setBrush(QColor(color.r, color.g, color.b));</div>
<div class="line"><span class="lineno">  303</span>  p2.drawRect(app.rect().adjusted(-1, -1, 0, 0));</div>
<div class="line"><span class="lineno">  304</span>  p2.setCompositionMode(QPainter::CompositionMode_DestinationIn);</div>
<div class="line"><span class="lineno">  305</span>  p2.drawImage(QPoint(), m_rasImage, qTargetRect);</div>
<div class="line"><span class="lineno">  306</span>  p2.end();</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>  <span class="keywordflow">if</span> (ras-&gt;getPixelSize() == 4) {</div>
<div class="line"><span class="lineno">  309</span>    QPainter p(&amp;image);</div>
<div class="line"><span class="lineno">  310</span>    p.setClipRect(qTargetRect);</div>
<div class="line"><span class="lineno">  311</span>    p.setCompositionMode(QPainter::CompositionMode_Source);</div>
<div class="line"><span class="lineno">  312</span>    p.drawImage(qTargetRect, rasterToQImage(rasBackup, <span class="keyword">true</span>), qTargetRect);</div>
<div class="line"><span class="lineno">  313</span>    p.end();</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>    p.begin(&amp;image);</div>
<div class="line"><span class="lineno">  316</span>    p.setOpacity(m_enableDynamicOpacity ? 1 : opacity);</div>
<div class="line"><span class="lineno">  317</span>    p.drawImage(qTargetRect, app, app.rect());</div>
<div class="line"><span class="lineno">  318</span>    p.end();</div>
<div class="line"><span class="lineno">  319</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  320</span>    QImage targetImage = rasterToQImage(rasBackup).copy(qTargetRect);</div>
<div class="line"><span class="lineno">  321</span>    targetImage        = targetImage.convertToFormat(</div>
<div class="line"><span class="lineno">  322</span>        QImage::Format_ARGB32_Premultiplied, colorTable);</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>    QPainter p(&amp;targetImage);</div>
<div class="line"><span class="lineno">  325</span>    p.setOpacity(m_enableDynamicOpacity ? 1 : opacity);</div>
<div class="line"><span class="lineno">  326</span>    p.drawImage(QPoint(), app, app.rect());</div>
<div class="line"><span class="lineno">  327</span>    p.end();</div>
<div class="line"><span class="lineno">  328</span>    targetImage =</div>
<div class="line"><span class="lineno">  329</span>        targetImage.convertToFormat(QImage::Format_Indexed8, colorTable);</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>    <a class="code hl_class" href="class_t_raster_p_t.html">TRasterGR8P</a> targetRas = rasterFromQImage(targetImage);</div>
<div class="line"><span class="lineno">  332</span>    ras-&gt;copy(targetRas, targetRect.getP00());</div>
<div class="line"><span class="lineno">  333</span>  }</div>
<div class="line"><span class="lineno">  334</span>}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>E:/opentoonz/toonz/sources/tnztools/<a class="el" href="">bluredbrush.h</a></li>
<li>E:/opentoonz/toonz/sources/tnztools/<a class="el" href="">bluredbrush.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
