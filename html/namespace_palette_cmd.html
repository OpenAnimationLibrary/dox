<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: PaletteCmd Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">PaletteCmd Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Provides a collection of methods to manage <b><a class="el" href="class_t_palette.html" title="The class representing a Toonz palette object.">TPalette</a></b>.  
<a href="namespace_palette_cmd.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_palette_cmd_1_1_color_model_loading_configuration.html">ColorModelLoadingConfiguration</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a19a0dfe694ea14e38e5b63e1f8f3429b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><b>ColorModelPltBehavior</b> { <b>KeepColorModelPlt</b> = 0
, <b>ReplaceColorModelPlt</b>
, <b>AddColorModelPlt</b>
 }</td></tr>
<tr class="separator:a19a0dfe694ea14e38e5b63e1f8f3429b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a125b7cbde6109a1b84622fbd78efa610"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><b>ColorModelRasterPickType</b> { <b>PickEveryColors</b> = 0
, <b>IntegrateSimilarColors</b>
, <b>PickColorChipGrid</b>
 }</td></tr>
<tr class="separator:a125b7cbde6109a1b84622fbd78efa610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa62297dcc18e3198376d2e8e6fc976b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><b>ColorChipOrder</b> { <b>UpperLeft</b> = 0
, <b>LowerLeft</b>
, <b>LeftUpper</b>
 }</td></tr>
<tr class="separator:afa62297dcc18e3198376d2e8e6fc976b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a462cdcbc9c985d216b719a6b8619ab2d"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#a462cdcbc9c985d216b719a6b8619ab2d">arrangeStyles</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle, int dstPageIndex, int dstIndexInPage, int srcPageIndex, const std::set&lt; int &gt; &amp;srcIndicesInPage)</td></tr>
<tr class="separator:a462cdcbc9c985d216b719a6b8619ab2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a539a7e06a519d1d646027e21ebc95e97"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#a539a7e06a519d1d646027e21ebc95e97">createStyle</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle, <a class="el" href="class_t_palette_1_1_page.html">TPalette::Page</a> *page)</td></tr>
<tr class="separator:a539a7e06a519d1d646027e21ebc95e97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe6098bed818ae0f12e5ab08c753d294"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#afe6098bed818ae0f12e5ab08c753d294">addStyles</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle, int pageIndex, int indexInPage, const std::vector&lt; <a class="el" href="class_t_color_style.html">TColorStyle</a> * &gt; &amp;styles)</td></tr>
<tr class="separator:afe6098bed818ae0f12e5ab08c753d294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcf0c23a9a8c973314e552053d8f0c81"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#afcf0c23a9a8c973314e552053d8f0c81">eraseStyles</a> (const std::set&lt; <a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> * &gt; &amp;levels, const std::vector&lt; int &gt; &amp;styleIds)</td></tr>
<tr class="memdesc:afcf0c23a9a8c973314e552053d8f0c81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Erases <em>image entities</em> whose style is any of the specified ones.  <a href="namespace_palette_cmd.html#afcf0c23a9a8c973314e552053d8f0c81">More...</a><br /></td></tr>
<tr class="separator:afcf0c23a9a8c973314e552053d8f0c81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a465dde67c45f742753592b1d5a807d17"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#a465dde67c45f742753592b1d5a807d17">addPage</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle, std::wstring name=L&quot;&quot;, bool withUndo=true)</td></tr>
<tr class="separator:a465dde67c45f742753592b1d5a807d17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1cf00d41fc881d9468a42df17279ab0"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#ac1cf00d41fc881d9468a42df17279ab0">destroyPage</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle, int pageIndex)</td></tr>
<tr class="separator:ac1cf00d41fc881d9468a42df17279ab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e43b40fc4a702614ce9bf4b9fca29a"><td class="memItemLeft" align="right" valign="top">DVAPI int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#af8e43b40fc4a702614ce9bf4b9fca29a">loadReferenceImage</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle, const <a class="el" href="struct_palette_cmd_1_1_color_model_loading_configuration.html">ColorModelLoadingConfiguration</a> &amp;config, const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;_fp, <a class="el" href="class_toonz_scene.html">ToonzScene</a> *scene, const std::vector&lt; int &gt; &amp;frames=std::vector&lt; int &gt;())</td></tr>
<tr class="separator:af8e43b40fc4a702614ce9bf4b9fca29a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75213302b1303d48304f99ac5ba175dd"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#a75213302b1303d48304f99ac5ba175dd">removeReferenceImage</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle)</td></tr>
<tr class="separator:a75213302b1303d48304f99ac5ba175dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60c275f8a21dd866a91dd84630e3654"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#ad60c275f8a21dd866a91dd84630e3654">movePalettePage</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle, int srcIndex, int dstIndex)</td></tr>
<tr class="separator:ad60c275f8a21dd866a91dd84630e3654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a402113f4bd931e0144d15a8b0cb002c4"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#a402113f4bd931e0144d15a8b0cb002c4">renamePalettePage</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle, int pageIndex, const std::wstring &amp;newName)</td></tr>
<tr class="separator:a402113f4bd931e0144d15a8b0cb002c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2c398e5ac92c0586bf6af4ab4d918e9"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#ab2c398e5ac92c0586bf6af4ab4d918e9">renamePaletteStyle</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle, const std::wstring &amp;newName)</td></tr>
<tr class="separator:ab2c398e5ac92c0586bf6af4ab4d918e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad4d7fb8494fb9d6240352e78c9c6b9f"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#aad4d7fb8494fb9d6240352e78c9c6b9f">organizePaletteStyle</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle, int styleId, const <a class="el" href="struct_t_color_style_1_1_picked_position.html">TColorStyle::PickedPosition</a> &amp;point)</td></tr>
<tr class="separator:aad4d7fb8494fb9d6240352e78c9c6b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade4586ecdaf9fd428f531d9b98012e30"><td class="memItemLeft" align="right" valign="top">DVAPI void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_palette_cmd.html#ade4586ecdaf9fd428f531d9b98012e30">pickColorByUsingPickedPosition</a> (<a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *paletteHandle, <a class="el" href="class_t_smart_pointer_t.html">TImageP</a> img, int frame)</td></tr>
<tr class="separator:ade4586ecdaf9fd428f531d9b98012e30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Provides a collection of methods to manage <b><a class="el" href="class_t_palette.html" title="The class representing a Toonz palette object.">TPalette</a></b>. </p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="afa62297dcc18e3198376d2e8e6fc976b" name="afa62297dcc18e3198376d2e8e6fc976b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa62297dcc18e3198376d2e8e6fc976b">&#9670;&nbsp;</a></span>ColorChipOrder</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum PaletteCmd::ColorChipOrder</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   81</span>{ UpperLeft = 0, LowerLeft, LeftUpper };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a19a0dfe694ea14e38e5b63e1f8f3429b" name="a19a0dfe694ea14e38e5b63e1f8f3429b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19a0dfe694ea14e38e5b63e1f8f3429b">&#9670;&nbsp;</a></span>ColorModelPltBehavior</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum PaletteCmd::ColorModelPltBehavior</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   69</span>                           {</div>
<div class="line"><span class="lineno">   70</span>  KeepColorModelPlt = 0,</div>
<div class="line"><span class="lineno">   71</span>  ReplaceColorModelPlt,</div>
<div class="line"><span class="lineno">   72</span>  AddColorModelPlt</div>
<div class="line"><span class="lineno">   73</span>};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a125b7cbde6109a1b84622fbd78efa610" name="a125b7cbde6109a1b84622fbd78efa610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a125b7cbde6109a1b84622fbd78efa610">&#9670;&nbsp;</a></span>ColorModelRasterPickType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum PaletteCmd::ColorModelRasterPickType</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   75</span>                              {</div>
<div class="line"><span class="lineno">   76</span>  PickEveryColors = 0,</div>
<div class="line"><span class="lineno">   77</span>  IntegrateSimilarColors,</div>
<div class="line"><span class="lineno">   78</span>  PickColorChipGrid</div>
<div class="line"><span class="lineno">   79</span>};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a465dde67c45f742753592b1d5a807d17" name="a465dde67c45f742753592b1d5a807d17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a465dde67c45f742753592b1d5a807d17">&#9670;&nbsp;</a></span>addPage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::addPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::wstring&#160;</td>
          <td class="paramname"><em>name</em> = <code>L&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>withUndo</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  683</span>                                        {</div>
<div class="line"><span class="lineno">  684</span>  <a class="code hl_class" href="class_t_palette.html">TPalette</a> *palette = paletteHandle-&gt;getPalette();</div>
<div class="line"><span class="lineno">  685</span>  <span class="keywordflow">if</span> (name == L<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  686</span>    name = L<span class="stringliteral">&quot;page &quot;</span> + std::to_wstring(palette-&gt;getPageCount() + 1);</div>
<div class="line"><span class="lineno">  687</span>  <a class="code hl_class" href="class_t_palette_1_1_page.html">TPalette::Page</a> *page = palette-&gt;addPage(name);</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span>  palette-&gt;setDirtyFlag(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>  paletteHandle-&gt;notifyPaletteChanged();</div>
<div class="line"><span class="lineno">  692</span>  <span class="keywordflow">if</span> (withUndo)</div>
<div class="line"><span class="lineno">  693</span>    TUndoManager::manager()-&gt;add(</div>
<div class="line"><span class="lineno">  694</span>        <span class="keyword">new</span> AddPageUndo(paletteHandle, page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a0e09146e776286b87fc90283c561d19d">getIndex</a>(), name));</div>
<div class="line"><span class="lineno">  695</span>}</div>
<div class="ttc" id="aclass_t_palette_1_1_page_html"><div class="ttname"><a href="class_t_palette_1_1_page.html">TPalette::Page</a></div><div class="ttdoc">A palette page is a restricted view of a palette instance.</div><div class="ttdef"><b>Definition:</b> tpalette.h:94</div></div>
<div class="ttc" id="aclass_t_palette_1_1_page_html_a0e09146e776286b87fc90283c561d19d"><div class="ttname"><a href="class_t_palette_1_1_page.html#a0e09146e776286b87fc90283c561d19d">TPalette::Page::getIndex</a></div><div class="ttdeci">int getIndex() const</div><div class="ttdoc">Returns the page index in the palette.</div><div class="ttdef"><b>Definition:</b> tpalette.h:117</div></div>
<div class="ttc" id="aclass_t_palette_html"><div class="ttname"><a href="class_t_palette.html">TPalette</a></div><div class="ttdoc">The class representing a Toonz palette object.</div><div class="ttdef"><b>Definition:</b> tpalette.h:85</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe6098bed818ae0f12e5ab08c753d294" name="afe6098bed818ae0f12e5ab08c753d294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe6098bed818ae0f12e5ab08c753d294">&#9670;&nbsp;</a></span>addStyles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::addStyles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pageIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>indexInPage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="class_t_color_style.html">TColorStyle</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>styles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  465</span>                                                                   {</div>
<div class="line"><span class="lineno">  466</span>  <a class="code hl_class" href="class_t_palette.html">TPalette</a> *palette = paletteHandle-&gt;getPalette();</div>
<div class="line"><span class="lineno">  467</span>  assert(0 &lt;= pageIndex &amp;&amp; pageIndex &lt; palette-&gt;getPageCount());</div>
<div class="line"><span class="lineno">  468</span>  <a class="code hl_class" href="class_t_palette_1_1_page.html">TPalette::Page</a> *page = palette-&gt;getPage(pageIndex);</div>
<div class="line"><span class="lineno">  469</span>  assert(page);</div>
<div class="line"><span class="lineno">  470</span>  assert(0 &lt;= indexInPage &amp;&amp; indexInPage &lt;= page-&gt;getStyleCount());</div>
<div class="line"><span class="lineno">  471</span>  <span class="keywordtype">int</span> count = styles.size();</div>
<div class="line"><span class="lineno">  472</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; i++) {</div>
<div class="line"><span class="lineno">  473</span>    page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#aba6f78043e4370496a1bb7b7be5bd792">insertStyle</a>(indexInPage + i, styles[i]-&gt;clone());</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    <span class="comment">/*-- StudioPaletteから持ち込んだ場合、その元の名前をoriginalNameに入れる</span></div>
<div class="line"><span class="lineno">  476</span><span class="comment">     * --*/</span></div>
<div class="line"><span class="lineno">  477</span>    <span class="keywordflow">if</span> (styles[i]-&gt;getGlobalName() != L<span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><span class="lineno">  478</span>      <span class="comment">/*--</span></div>
<div class="line"><span class="lineno">  479</span><span class="comment">       * もし元のStyleにOriginalNameが無ければ（コピー元がStudioPaletteからということ）--*/</span></div>
<div class="line"><span class="lineno">  480</span>      <span class="keywordflow">if</span> (styles[i]-&gt;getOriginalName() == L<span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><span class="lineno">  481</span>        <span class="comment">/*-- 元のStyleの名前をペースト先のOriginalNameに入れる --*/</span></div>
<div class="line"><span class="lineno">  482</span>        page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#abe9e434ff44cbe1fde53f32aa7978f9c">getStyle</a>(indexInPage + i)-&gt;<a class="code hl_function" href="class_t_color_style.html#a22061dd49a8282e8af93840441998532">setOriginalName</a>(styles[i]-&gt;getName());</div>
<div class="line"><span class="lineno">  483</span>      }</div>
<div class="line"><span class="lineno">  484</span>    }</div>
<div class="line"><span class="lineno">  485</span>    <span class="comment">/*--</span></div>
<div class="line"><span class="lineno">  486</span><span class="comment">     * それ以外の場合は、clone()でそれぞれの名前をコピーしているので、そのままでOK</span></div>
<div class="line"><span class="lineno">  487</span><span class="comment">     * --*/</span></div>
<div class="line"><span class="lineno">  488</span>  }</div>
<div class="line"><span class="lineno">  489</span>  TUndoManager::manager()-&gt;add(</div>
<div class="line"><span class="lineno">  490</span>      <span class="keyword">new</span> AddStylesUndo(palette, pageIndex, indexInPage, count, paletteHandle));</div>
<div class="line"><span class="lineno">  491</span>  palette-&gt;setDirtyFlag(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  492</span>}</div>
<div class="ttc" id="aclass_t_color_style_html_a22061dd49a8282e8af93840441998532"><div class="ttname"><a href="class_t_color_style.html#a22061dd49a8282e8af93840441998532">TColorStyle::setOriginalName</a></div><div class="ttdeci">void setOriginalName(std::wstring name)</div><div class="ttdoc">If the style is originally copied from studio palette, set this.</div><div class="ttdef"><b>Definition:</b> tcolorstyles.h:204</div></div>
<div class="ttc" id="aclass_t_palette_1_1_page_html_aba6f78043e4370496a1bb7b7be5bd792"><div class="ttname"><a href="class_t_palette_1_1_page.html#aba6f78043e4370496a1bb7b7be5bd792">TPalette::Page::insertStyle</a></div><div class="ttdeci">void insertStyle(int indexInPage, int styleId)</div><div class="ttdoc">to this page.</div><div class="ttdef"><b>Definition:</b> tpalette.cpp:173</div></div>
<div class="ttc" id="aclass_t_palette_1_1_page_html_abe9e434ff44cbe1fde53f32aa7978f9c"><div class="ttname"><a href="class_t_palette_1_1_page.html#abe9e434ff44cbe1fde53f32aa7978f9c">TPalette::Page::getStyle</a></div><div class="ttdeci">TColorStyle * getStyle(int indexInPage) const</div><div class="ttdoc">found.</div><div class="ttdef"><b>Definition:</b> tpalette.cpp:122</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a462cdcbc9c985d216b719a6b8619ab2d" name="a462cdcbc9c985d216b719a6b8619ab2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a462cdcbc9c985d216b719a6b8619ab2d">&#9670;&nbsp;</a></span>arrangeStyles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::arrangeStyles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dstPageIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dstIndexInPage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>srcPageIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>srcIndicesInPage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  263</span>                                                                    {</div>
<div class="line"><span class="lineno">  264</span>  <span class="keywordflow">if</span> (dstPageIndex == srcPageIndex &amp;&amp;</div>
<div class="line"><span class="lineno">  265</span>      dstIndexInPage == *srcIndicesInPage.begin())</div>
<div class="line"><span class="lineno">  266</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  267</span>  ArrangeStylesUndo *undo =</div>
<div class="line"><span class="lineno">  268</span>      <span class="keyword">new</span> ArrangeStylesUndo(paletteHandle, dstPageIndex, dstIndexInPage,</div>
<div class="line"><span class="lineno">  269</span>                            srcPageIndex, srcIndicesInPage);</div>
<div class="line"><span class="lineno">  270</span>  undo-&gt;redo();</div>
<div class="line"><span class="lineno">  271</span>  TUndoManager::manager()-&gt;add(undo);</div>
<div class="line"><span class="lineno">  272</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a539a7e06a519d1d646027e21ebc95e97" name="a539a7e06a519d1d646027e21ebc95e97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a539a7e06a519d1d646027e21ebc95e97">&#9670;&nbsp;</a></span>createStyle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::createStyle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_palette_1_1_page.html">TPalette::Page</a> *&#160;</td>
          <td class="paramname"><em>page</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  334</span>                                                 {</div>
<div class="line"><span class="lineno">  335</span>  <span class="keywordtype">int</span> index         = paletteHandle-&gt;getStyleIndex();</div>
<div class="line"><span class="lineno">  336</span>  <a class="code hl_class" href="class_t_palette.html">TPalette</a> *palette = paletteHandle-&gt;getPalette();</div>
<div class="line"><span class="lineno">  337</span>  <span class="keywordtype">int</span> newIndex;</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>  <span class="keywordtype">int</span> UnpagedId = palette-&gt;getFirstUnpagedStyle();</div>
<div class="line"><span class="lineno">  340</span>  <span class="keywordflow">if</span> (UnpagedId != -1 &amp;&amp; !palette-&gt;isCleanupPalette()) {</div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">if</span> (index == -1)</div>
<div class="line"><span class="lineno">  342</span>      palette-&gt;getStyle(UnpagedId)-&gt;setMainColor(TPixel32::Black);</div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  344</span>      palette-&gt;getStyle(UnpagedId)-&gt;setMainColor(</div>
<div class="line"><span class="lineno">  345</span>          palette-&gt;getStyle(index)-&gt;getMainColor());</div>
<div class="line"><span class="lineno">  346</span>    newIndex = page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a6836aae497ab21f4ec1af5f026c68d5f">addStyle</a>(UnpagedId);</div>
<div class="line"><span class="lineno">  347</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!palette-&gt;isCleanupPalette()) {</div>
<div class="line"><span class="lineno">  348</span>    <span class="keywordflow">if</span> (index == -1)</div>
<div class="line"><span class="lineno">  349</span>      newIndex = page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a6836aae497ab21f4ec1af5f026c68d5f">addStyle</a>(TPixel32::Black);</div>
<div class="line"><span class="lineno">  350</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  351</span>      <a class="code hl_class" href="class_t_color_style.html">TColorStyle</a> *style          = palette-&gt;getStyle(index);</div>
<div class="line"><span class="lineno">  352</span>      <a class="code hl_class" href="class_t_cleanup_style.html">TCleanupStyle</a> *cleanupStyle = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_cleanup_style.html">TCleanupStyle</a> *<span class="keyword">&gt;</span>(style);</div>
<div class="line"><span class="lineno">  353</span>      <span class="keywordflow">if</span> ((cleanupStyle || index == 0) &amp;&amp; palette-&gt;isCleanupPalette()) {</div>
<div class="line"><span class="lineno">  354</span>        <a class="code hl_class" href="class_t_color_cleanup_style.html">TColorCleanupStyle</a> *newCleanupStyle = <span class="keyword">new</span> <a class="code hl_class" href="class_t_color_cleanup_style.html">TColorCleanupStyle</a>();</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">if</span> (cleanupStyle) {</div>
<div class="line"><span class="lineno">  356</span>          <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  357</span>          <span class="keywordflow">for</span> (i = 0; i &lt; cleanupStyle-&gt;<a class="code hl_function" href="class_t_cleanup_style.html#a3c591761c3880d68dd18e66453f58ddd">getParamCount</a>(); i++)</div>
<div class="line"><span class="lineno">  358</span>            newCleanupStyle-&gt;<a class="code hl_function" href="class_t_cleanup_style.html#aa74f6eb493135c2404f4a13d5548f41a">setColorParamValue</a>(</div>
<div class="line"><span class="lineno">  359</span>                i, cleanupStyle-&gt;<a class="code hl_function" href="class_t_cleanup_style.html#a90f8b64ceb5042751d4324c9ec2c6837">getColorParamValue</a>(i));</div>
<div class="line"><span class="lineno">  360</span>        }</div>
<div class="line"><span class="lineno">  361</span>        newIndex = page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a6836aae497ab21f4ec1af5f026c68d5f">addStyle</a>(newCleanupStyle);</div>
<div class="line"><span class="lineno">  362</span>      } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  363</span>        newIndex = page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a6836aae497ab21f4ec1af5f026c68d5f">addStyle</a>(style-&gt;<a class="code hl_function" href="class_t_color_style.html#abd78dd4e3ff3e2e78b647195f7622aa7">getMainColor</a>());</div>
<div class="line"><span class="lineno">  364</span>    }</div>
<div class="line"><span class="lineno">  365</span>  } <span class="keywordflow">else</span> <span class="comment">/*- CleanupPaletteの場合 -*/</span></div>
<div class="line"><span class="lineno">  366</span>  {</div>
<div class="line"><span class="lineno">  367</span>    newIndex = page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a6836aae497ab21f4ec1af5f026c68d5f">addStyle</a>(<span class="keyword">new</span> <a class="code hl_class" href="class_t_color_cleanup_style.html">TColorCleanupStyle</a>(TPixel32::Red));</div>
<div class="line"><span class="lineno">  368</span>  }</div>
<div class="line"><span class="lineno">  369</span>  <span class="keywordtype">int</span> newStyleId = page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a3d6eed995ee8b1c22d50a73911a45786">getStyleId</a>(newIndex);</div>
<div class="line"><span class="lineno">  370</span>  <span class="comment">/*-  StudioPalette上でStyleを追加した場合、GlobalNameを自動で割り振る -*/</span></div>
<div class="line"><span class="lineno">  371</span>  <span class="keywordflow">if</span> (palette-&gt;getGlobalName() != L<span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><span class="lineno">  372</span>    <a class="code hl_class" href="class_t_color_style.html">TColorStyle</a> *cs = palette-&gt;getStyle(newStyleId);</div>
<div class="line"><span class="lineno">  373</span>    std::wstring gname =</div>
<div class="line"><span class="lineno">  374</span>        L<span class="stringliteral">&quot;-&quot;</span> + palette-&gt;getGlobalName() + L<span class="stringliteral">&quot;-&quot;</span> + std::to_wstring(newStyleId);</div>
<div class="line"><span class="lineno">  375</span>    cs-&gt;<a class="code hl_function" href="class_t_color_style.html#af6a3579e3785b9addcf434574bc89367">setGlobalName</a>(gname);</div>
<div class="line"><span class="lineno">  376</span>  }</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>  page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#abe9e434ff44cbe1fde53f32aa7978f9c">getStyle</a>(newIndex)-&gt;<a class="code hl_function" href="class_t_color_style.html#aeb25e0ae1708d473bd551b0d0c9bf4a9">setName</a>(</div>
<div class="line"><span class="lineno">  379</span>      QString(<span class="stringliteral">&quot;color_%1&quot;</span>).arg(newStyleId).toStdWString());</div>
<div class="line"><span class="lineno">  380</span>  paletteHandle-&gt;setStyleIndex(newStyleId);</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>  palette-&gt;setDirtyFlag(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  383</span>  paletteHandle-&gt;notifyPaletteChanged();</div>
<div class="line"><span class="lineno">  384</span>  TUndoManager::manager()-&gt;add(<span class="keyword">new</span> CreateStyleUndo(</div>
<div class="line"><span class="lineno">  385</span>      paletteHandle, page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a0e09146e776286b87fc90283c561d19d">getIndex</a>(), page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a3d6eed995ee8b1c22d50a73911a45786">getStyleId</a>(newIndex)));</div>
<div class="line"><span class="lineno">  386</span>}</div>
<div class="ttc" id="aclass_t_cleanup_style_html"><div class="ttname"><a href="class_t_cleanup_style.html">TCleanupStyle</a></div><div class="ttdef"><b>Definition:</b> cleanupcolorstyles.h:22</div></div>
<div class="ttc" id="aclass_t_cleanup_style_html_a3c591761c3880d68dd18e66453f58ddd"><div class="ttname"><a href="class_t_cleanup_style.html#a3c591761c3880d68dd18e66453f58ddd">TCleanupStyle::getParamCount</a></div><div class="ttdeci">int getParamCount() const override</div><div class="ttdef"><b>Definition:</b> cleanupcolorstyles.h:39</div></div>
<div class="ttc" id="aclass_t_cleanup_style_html_a90f8b64ceb5042751d4324c9ec2c6837"><div class="ttname"><a href="class_t_cleanup_style.html#a90f8b64ceb5042751d4324c9ec2c6837">TCleanupStyle::getColorParamValue</a></div><div class="ttdeci">TPixel32 getColorParamValue(int index) const override</div><div class="ttdoc">Returns the value of the color of index index.</div><div class="ttdef"><b>Definition:</b> cleanupcolorstyles.cpp:75</div></div>
<div class="ttc" id="aclass_t_cleanup_style_html_aa74f6eb493135c2404f4a13d5548f41a"><div class="ttname"><a href="class_t_cleanup_style.html#aa74f6eb493135c2404f4a13d5548f41a">TCleanupStyle::setColorParamValue</a></div><div class="ttdeci">void setColorParamValue(int index, const TPixel32 &amp;color) override</div><div class="ttdoc">Sets the index-th color value.</div><div class="ttdef"><b>Definition:</b> cleanupcolorstyles.cpp:81</div></div>
<div class="ttc" id="aclass_t_color_cleanup_style_html"><div class="ttname"><a href="class_t_color_cleanup_style.html">TColorCleanupStyle</a></div><div class="ttdef"><b>Definition:</b> cleanupcolorstyles.h:70</div></div>
<div class="ttc" id="aclass_t_color_style_html"><div class="ttname"><a href="class_t_color_style.html">TColorStyle</a></div><div class="ttdoc">Abstract class representing a color style in a Toonz palette.</div><div class="ttdef"><b>Definition:</b> tcolorstyles.h:84</div></div>
<div class="ttc" id="aclass_t_color_style_html_abd78dd4e3ff3e2e78b647195f7622aa7"><div class="ttname"><a href="class_t_color_style.html#abd78dd4e3ff3e2e78b647195f7622aa7">TColorStyle::getMainColor</a></div><div class="ttdeci">virtual TPixel32 getMainColor() const</div><div class="ttdoc">Returns the style's main color, or black if none.</div><div class="ttdef"><b>Definition:</b> tcolorstyles.h:245</div></div>
<div class="ttc" id="aclass_t_color_style_html_aeb25e0ae1708d473bd551b0d0c9bf4a9"><div class="ttname"><a href="class_t_color_style.html#aeb25e0ae1708d473bd551b0d0c9bf4a9">TColorStyle::setName</a></div><div class="ttdeci">void setName(std::wstring name)</div><div class="ttdoc">Sets the style's user-defined name.</div><div class="ttdef"><b>Definition:</b> tcolorstyles.h:187</div></div>
<div class="ttc" id="aclass_t_color_style_html_af6a3579e3785b9addcf434574bc89367"><div class="ttname"><a href="class_t_color_style.html#af6a3579e3785b9addcf434574bc89367">TColorStyle::setGlobalName</a></div><div class="ttdeci">void setGlobalName(std::wstring name)</div><div class="ttdoc">Sets the global name of the style.</div><div class="ttdef"><b>Definition:</b> tcolorstyles.h:197</div></div>
<div class="ttc" id="aclass_t_palette_1_1_page_html_a3d6eed995ee8b1c22d50a73911a45786"><div class="ttname"><a href="class_t_palette_1_1_page.html#a3d6eed995ee8b1c22d50a73911a45786">TPalette::Page::getStyleId</a></div><div class="ttdeci">int getStyleId(int indexInPage) const</div><div class="ttdef"><b>Definition:</b> tpalette.cpp:132</div></div>
<div class="ttc" id="aclass_t_palette_1_1_page_html_a6836aae497ab21f4ec1af5f026c68d5f"><div class="ttname"><a href="class_t_palette_1_1_page.html#a6836aae497ab21f4ec1af5f026c68d5f">TPalette::Page::addStyle</a></div><div class="ttdeci">int addStyle(int styleId)</div><div class="ttdef"><b>Definition:</b> tpalette.cpp:142</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1cf00d41fc881d9468a42df17279ab0" name="ac1cf00d41fc881d9468a42df17279ab0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1cf00d41fc881d9468a42df17279ab0">&#9670;&nbsp;</a></span>destroyPage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::destroyPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pageIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  747</span>                                                                         {</div>
<div class="line"><span class="lineno">  748</span>  <a class="code hl_class" href="class_t_palette.html">TPalette</a> *palette = paletteHandle-&gt;getPalette();</div>
<div class="line"><span class="lineno">  749</span>  assert(0 &lt;= pageIndex &amp;&amp; pageIndex &lt; palette-&gt;getPageCount());</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>  TUndoManager::manager()-&gt;add(<span class="keyword">new</span> DestroyPageUndo(paletteHandle, pageIndex));</div>
<div class="line"><span class="lineno">  752</span>  palette-&gt;erasePage(pageIndex);</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>  palette-&gt;setDirtyFlag(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>  paletteHandle-&gt;notifyPaletteChanged();</div>
<div class="line"><span class="lineno">  757</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afcf0c23a9a8c973314e552053d8f0c81" name="afcf0c23a9a8c973314e552053d8f0c81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcf0c23a9a8c973314e552053d8f0c81">&#9670;&nbsp;</a></span>eraseStyles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::eraseStyles </td>
          <td>(</td>
          <td class="paramtype">const std::set&lt; <a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>levels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>styleIds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Erases <em>image entities</em> whose style is any of the specified ones. </p>
<p >This function applies to <em>all objects contained in the images of a level</em>; for example, all strokes and regions of the <code><a class="el" href="class_t_vector_image.html">TVectorImage</a></code>s in a level.</p>
<dl class="section remark"><dt>Remarks</dt><dd>This command does not provide an undo for level types whose images are raster-based (specifically, fullcolor and TLV images), due to memory occupation concerns. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  523</span>                                                             {</div>
<div class="line"><span class="lineno">  524</span>  <span class="keyword">typedef</span> std::pair&lt;const TXshSimpleLevelP, std::vector&lt;TVectorImageP&gt;&gt;</div>
<div class="line"><span class="lineno">  525</span>      LevelImages;</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>  <span class="keyword">struct </span>Undo final : <span class="keyword">public</span> <a class="code hl_class" href="class_t_undo.html">TUndo</a> {</div>
<div class="line"><span class="lineno">  528</span>    std::set&lt;TXshSimpleLevel *&gt; m_levels;</div>
<div class="line"><span class="lineno">  529</span>    std::vector&lt;int&gt; m_styleIds;</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>    <span class="keyword">mutable</span> std::map&lt;TXshSimpleLevelP, std::vector&lt;TVectorImageP&gt;&gt;</div>
<div class="line"><span class="lineno">  532</span>        m_imagesByLevel;</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>  <span class="keyword">public</span>:</div>
<div class="line"><span class="lineno">  535</span>    Undo(<span class="keyword">const</span> std::set&lt;TXshSimpleLevel *&gt; &amp;levels,</div>
<div class="line"><span class="lineno">  536</span>         <span class="keyword">const</span> std::vector&lt;int&gt; &amp;styleIds)</div>
<div class="line"><span class="lineno">  537</span>        : m_levels(levels), m_styleIds(styleIds) {</div>
<div class="line"><span class="lineno">  538</span>      tcg::substitute(m_imagesByLevel,</div>
<div class="line"><span class="lineno">  539</span>                      levels | boost::adaptors::filtered(isVector) |</div>
<div class="line"><span class="lineno">  540</span>                          boost::adaptors::transformed(toEmptyLevelImages));</div>
<div class="line"><span class="lineno">  541</span>    }</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordtype">bool</span> isValid()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !m_levels.empty(); }</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>    <span class="keywordtype">void</span> redo()<span class="keyword"> const override </span>{</div>
<div class="line"><span class="lineno">  546</span>      std::for_each(m_imagesByLevel.begin(), m_imagesByLevel.end(),</div>
<div class="line"><span class="lineno">  547</span>                    cloneImages);</div>
<div class="line"><span class="lineno">  548</span>      eraseStylesInLevels(m_levels, m_styleIds);</div>
<div class="line"><span class="lineno">  549</span>    }</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>    <span class="keywordtype">void</span> undo()<span class="keyword"> const override </span>{</div>
<div class="line"><span class="lineno">  552</span>      std::for_each(m_imagesByLevel.begin(), m_imagesByLevel.end(),</div>
<div class="line"><span class="lineno">  553</span>                    restoreImages);</div>
<div class="line"><span class="lineno">  554</span>    }</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordtype">int</span> getSize()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> 10 &lt;&lt; 20; }  <span class="comment">// At max 10 per 100 MB</span></div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>  <span class="keyword">private</span>:</div>
<div class="line"><span class="lineno">  559</span>    <span class="keyword">static</span> <span class="keywordtype">bool</span> isVector(<span class="keyword">const</span> <a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *level) {</div>
<div class="line"><span class="lineno">  560</span>      <span class="keywordflow">return</span> (assert(level), level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() == PLI_XSHLEVEL);</div>
<div class="line"><span class="lineno">  561</span>    }</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>    <span class="keyword">static</span> LevelImages toEmptyLevelImages(<a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *level) {</div>
<div class="line"><span class="lineno">  564</span>      <span class="keywordflow">return</span> LevelImages(level, std::vector&lt;TVectorImageP&gt;());</div>
<div class="line"><span class="lineno">  565</span>    }</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>    <span class="keyword">static</span> <span class="keywordtype">void</span> copyStrokeIds(<span class="keyword">const</span> <a class="code hl_class" href="class_t_vector_image.html">TVectorImage</a> &amp;src, <a class="code hl_class" href="class_t_vector_image.html">TVectorImage</a> &amp;dst) {</div>
<div class="line"><span class="lineno">  568</span>      UINT s, sCount = src.<a class="code hl_function" href="class_t_vector_image.html#add44e109ce62ba075799c0602724a841">getStrokeCount</a>();</div>
<div class="line"><span class="lineno">  569</span>      <span class="keywordflow">for</span> (s = 0; s != sCount; ++s)</div>
<div class="line"><span class="lineno">  570</span>        dst.<a class="code hl_function" href="class_t_vector_image.html#a1aa2f3ab6c30a6f8a64b2cb35072ffeb">getStroke</a>(s)-&gt;setId(src.<a class="code hl_function" href="class_t_vector_image.html#a1aa2f3ab6c30a6f8a64b2cb35072ffeb">getStroke</a>(s)-&gt;getId());</div>
<div class="line"><span class="lineno">  571</span>    }</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>    <span class="keyword">static</span> <a class="code hl_class" href="class_t_vector_image_p.html">TVectorImageP</a> cloneImage(<span class="keyword">const</span> <a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> &amp;level, <span class="keywordtype">int</span> f) {</div>
<div class="line"><span class="lineno">  574</span>      <a class="code hl_class" href="class_t_vector_image_p.html">TVectorImageP</a> src = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="class_t_vector_image_p.html">TVectorImageP</a><span class="keyword">&gt;</span>(</div>
<div class="line"><span class="lineno">  575</span>          level.getFrame(level.<a class="code hl_function" href="class_t_xsh_simple_level.html#abb72e2ab0c1baeda0a8af3146003181d">getFrameId</a>(f), <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  576</span>      <a class="code hl_class" href="class_t_vector_image_p.html">TVectorImageP</a> dst = src-&gt;clone();</div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>      copyStrokeIds(*src, *dst);</div>
<div class="line"><span class="lineno">  579</span>      <span class="keywordflow">return</span> dst;</div>
<div class="line"><span class="lineno">  580</span>    }</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>    <span class="keyword">static</span> <span class="keywordtype">void</span> cloneImages(LevelImages &amp;levelImages) {</div>
<div class="line"><span class="lineno">  583</span>      <a class="code hl_function" href="range__utility_8h.html#a6e998835f065bb4b10d59722f3ec9019">tcg::substitute</a>(</div>
<div class="line"><span class="lineno">  584</span>          levelImages.second,</div>
<div class="line"><span class="lineno">  585</span>          boost::counting_range(0, levelImages.first-&gt;getFrameCount()) |</div>
<div class="line"><span class="lineno">  586</span>              boost::adaptors::transformed(boost::bind(</div>
<div class="line"><span class="lineno">  587</span>                  cloneImage, boost::cref(*levelImages.first), _1)));</div>
<div class="line"><span class="lineno">  588</span>    }</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>    <span class="keyword">static</span> <span class="keywordtype">void</span> restoreImage(<span class="keyword">const</span> <a class="code hl_class" href="class_t_smart_pointer_t.html">TXshSimpleLevelP</a> &amp;level, <span class="keywordtype">int</span> f,</div>
<div class="line"><span class="lineno">  591</span>                             <span class="keyword">const</span> <a class="code hl_class" href="class_t_vector_image_p.html">TVectorImageP</a> &amp;vi) {</div>
<div class="line"><span class="lineno">  592</span>      level-&gt;setFrame(level-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#abb72e2ab0c1baeda0a8af3146003181d">getFrameId</a>(f), vi.getPointer());</div>
<div class="line"><span class="lineno">  593</span>    }</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>    <span class="keyword">static</span> <span class="keywordtype">void</span> restoreImages(LevelImages &amp;levelImages) {</div>
<div class="line"><span class="lineno">  596</span>      <span class="keywordtype">int</span> f, fCount = std::min(levelImages.first-&gt;getFrameCount(),</div>
<div class="line"><span class="lineno">  597</span>                               <span class="keywordtype">int</span>(levelImages.second.size()));</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>      <span class="keywordflow">for</span> (f = 0; f != fCount; ++f)</div>
<div class="line"><span class="lineno">  600</span>        restoreImage(levelImages.first, f, levelImages.second[f]);</div>
<div class="line"><span class="lineno">  601</span>    }</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>  };  <span class="comment">// Undo</span></div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>  <span class="keywordflow">if</span> (levels.empty() || styleIds.empty()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span>  std::unique_ptr&lt;TUndo&gt; undo(<span class="keyword">new</span> Undo(levels, styleIds));</div>
<div class="line"><span class="lineno">  608</span>  <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span>Undo &amp;<span class="keyword">&gt;</span>(*undo).isValid()) {</div>
<div class="line"><span class="lineno">  609</span>    undo-&gt;redo();</div>
<div class="line"><span class="lineno">  610</span>    TUndoManager::manager()-&gt;add(undo.release());</div>
<div class="line"><span class="lineno">  611</span>  }</div>
<div class="line"><span class="lineno">  612</span>}</div>
<div class="ttc" id="aclass_t_smart_pointer_t_html"><div class="ttname"><a href="class_t_smart_pointer_t.html">TSmartPointerT&lt; TXshSimpleLevel &gt;</a></div></div>
<div class="ttc" id="aclass_t_undo_html"><div class="ttname"><a href="class_t_undo.html">TUndo</a></div><div class="ttdef"><b>Definition:</b> tundo.h:29</div></div>
<div class="ttc" id="aclass_t_vector_image_html"><div class="ttname"><a href="class_t_vector_image.html">TVectorImage</a></div><div class="ttdef"><b>Definition:</b> tvectorimage.h:58</div></div>
<div class="ttc" id="aclass_t_vector_image_html_a1aa2f3ab6c30a6f8a64b2cb35072ffeb"><div class="ttname"><a href="class_t_vector_image.html#a1aa2f3ab6c30a6f8a64b2cb35072ffeb">TVectorImage::getStroke</a></div><div class="ttdeci">TStroke * getStroke(UINT index) const</div><div class="ttdoc">Get a TStroke stroke at index position.</div><div class="ttdef"><b>Definition:</b> tvectorimage.cpp:524</div></div>
<div class="ttc" id="aclass_t_vector_image_html_add44e109ce62ba075799c0602724a841"><div class="ttname"><a href="class_t_vector_image.html#add44e109ce62ba075799c0602724a841">TVectorImage::getStrokeCount</a></div><div class="ttdeci">UINT getStrokeCount() const</div><div class="ttdoc">Return the strokes' count.</div><div class="ttdef"><b>Definition:</b> tvectorimage.cpp:388</div></div>
<div class="ttc" id="aclass_t_vector_image_p_html"><div class="ttname"><a href="class_t_vector_image_p.html">TVectorImageP</a></div><div class="ttdef"><b>Definition:</b> tvectorimage.h:417</div></div>
<div class="ttc" id="aclass_t_xsh_level_html_a1a147f1e970a62120c0bbaf0020a8932"><div class="ttname"><a href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">TXshLevel::getType</a></div><div class="ttdeci">int getType() const</div><div class="ttdef"><b>Definition:</b> txshlevel.h:81</div></div>
<div class="ttc" id="aclass_t_xsh_simple_level_html"><div class="ttname"><a href="class_t_xsh_simple_level.html">TXshSimpleLevel</a></div><div class="ttdoc">The TXshLevel specialization for image levels.</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.h:60</div></div>
<div class="ttc" id="aclass_t_xsh_simple_level_html_abb72e2ab0c1baeda0a8af3146003181d"><div class="ttname"><a href="class_t_xsh_simple_level.html#abb72e2ab0c1baeda0a8af3146003181d">TXshSimpleLevel::getFrameId</a></div><div class="ttdeci">const TFrameId &amp; getFrameId(int index) const</div><div class="ttdoc">Returns the frame id at specified index.</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.cpp:460</div></div>
<div class="ttc" id="arange__utility_8h_html_a6e998835f065bb4b10d59722f3ec9019"><div class="ttname"><a href="range__utility_8h.html#a6e998835f065bb4b10d59722f3ec9019">tcg::substitute</a></div><div class="ttdeci">C &amp; substitute(C &amp;c, const Rng &amp;rng)</div><div class="ttdoc">Substitutes a container's content with the one inside a Boost range.</div><div class="ttdef"><b>Definition:</b> range_utility.h:29</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00460">TXshSimpleLevel::getFrameId()</a>, <a class="el" href="#l00524">TVectorImage::getStroke()</a>, <a class="el" href="#l00388">TVectorImage::getStrokeCount()</a>, and <a class="el" href="#l00081">TXshLevel::getType()</a>.</p>

</div>
</div>
<a id="af8e43b40fc4a702614ce9bf4b9fca29a" name="af8e43b40fc4a702614ce9bf4b9fca29a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8e43b40fc4a702614ce9bf4b9fca29a">&#9670;&nbsp;</a></span>loadReferenceImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PaletteCmd::loadReferenceImage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_palette_cmd_1_1_color_model_loading_configuration.html">ColorModelLoadingConfiguration</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>_fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_toonz_scene.html">ToonzScene</a> *&#160;</td>
          <td class="paramname"><em>scene</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>frames</em> = <code>std::vector&lt;int&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  990</span>                                                                 {</div>
<div class="line"><span class="lineno">  991</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TPaletteP</a> levelPalette = paletteHandle-&gt;getPalette();</div>
<div class="line"><span class="lineno">  992</span>  <span class="keywordflow">if</span> (!levelPalette) <span class="keywordflow">return</span> 2;</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>  <span class="keywordtype">int</span> ret =</div>
<div class="line"><span class="lineno">  995</span>      loadRefImage(paletteHandle, config, levelPalette, _fp, scene, frames);</div>
<div class="line"><span class="lineno">  996</span>  <span class="keywordflow">if</span> (ret != 0) <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  997</span> </div>
<div class="line"><span class="lineno">  998</span>  <span class="comment">// when choosing replace(Keep the destination palette), dirty flag is</span></div>
<div class="line"><span class="lineno">  999</span>  <span class="comment">// unchanged</span></div>
<div class="line"><span class="lineno"> 1000</span>  <span class="keywordflow">if</span> (config.behavior != ReplaceColorModelPlt) {</div>
<div class="line"><span class="lineno"> 1001</span>    levelPalette-&gt;<a class="code hl_function" href="class_t_palette.html#a382fa102abee4e69e386cb5a4d8d5184">setDirtyFlag</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1002</span>    paletteHandle-&gt;notifyPaletteDirtyFlagChanged();</div>
<div class="line"><span class="lineno"> 1003</span>  }</div>
<div class="line"><span class="lineno"> 1004</span> </div>
<div class="line"><span class="lineno"> 1005</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1006</span>}</div>
<div class="ttc" id="aclass_t_palette_html_a382fa102abee4e69e386cb5a4d8d5184"><div class="ttname"><a href="class_t_palette.html#a382fa102abee4e69e386cb5a4d8d5184">TPalette::setDirtyFlag</a></div><div class="ttdeci">void setDirtyFlag(bool dirtyFlag)</div><div class="ttdef"><b>Definition:</b> tpalette.h:240</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad60c275f8a21dd866a91dd84630e3654" name="ad60c275f8a21dd866a91dd84630e3654"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60c275f8a21dd866a91dd84630e3654">&#9670;&nbsp;</a></span>movePalettePage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::movePalettePage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>srcIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dstIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1064</span>                                               {</div>
<div class="line"><span class="lineno"> 1065</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TPaletteP</a> palette = paletteHandle-&gt;getPalette();</div>
<div class="line"><span class="lineno"> 1066</span>  palette-&gt;movePage(palette-&gt;getPage(srcIndex), dstIndex);</div>
<div class="line"><span class="lineno"> 1067</span>  TUndoManager::manager()-&gt;add(</div>
<div class="line"><span class="lineno"> 1068</span>      <span class="keyword">new</span> MovePageUndo(paletteHandle, srcIndex, dstIndex));</div>
<div class="line"><span class="lineno"> 1069</span>  paletteHandle-&gt;notifyPaletteChanged();</div>
<div class="line"><span class="lineno"> 1070</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aad4d7fb8494fb9d6240352e78c9c6b9f" name="aad4d7fb8494fb9d6240352e78c9c6b9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad4d7fb8494fb9d6240352e78c9c6b9f">&#9670;&nbsp;</a></span>organizePaletteStyle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::organizePaletteStyle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>styleId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_t_color_style_1_1_picked_position.html">TColorStyle::PickedPosition</a> &amp;&#160;</td>
          <td class="paramname"><em>point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1249</span>                                            {</div>
<div class="line"><span class="lineno"> 1250</span>  <span class="keywordflow">if</span> (!paletteHandle) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1251</span>  <a class="code hl_class" href="class_t_palette.html">TPalette</a> *palette = paletteHandle-&gt;getPalette();</div>
<div class="line"><span class="lineno"> 1252</span>  <span class="keywordflow">if</span> (!palette) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1253</span>  <span class="comment">// if the style is already in the first page, then do nothing</span></div>
<div class="line"><span class="lineno"> 1254</span>  <a class="code hl_class" href="class_t_palette_1_1_page.html">TPalette::Page</a> *page = palette-&gt;getStylePage(styleId);</div>
<div class="line"><span class="lineno"> 1255</span>  <span class="keywordflow">if</span> (!page || page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a0e09146e776286b87fc90283c561d19d">getIndex</a>() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span>  <span class="keywordtype">int</span> indexInPage = page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a5d85ded487f7152a95ccbab63c5aecd5">search</a>(styleId);</div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span>  TUndoManager::manager()-&gt;beginBlock();</div>
<div class="line"><span class="lineno"> 1260</span> </div>
<div class="line"><span class="lineno"> 1261</span>  <span class="comment">// call arrangeStyles() to move style to the first page</span></div>
<div class="line"><span class="lineno"> 1262</span>  arrangeStyles(paletteHandle, 0, palette-&gt;getPage(0)-&gt;getStyleCount(),</div>
<div class="line"><span class="lineno"> 1263</span>                page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#a0e09146e776286b87fc90283c561d19d">getIndex</a>(), {indexInPage});</div>
<div class="line"><span class="lineno"> 1264</span>  <span class="comment">// then set the picked position</span></div>
<div class="line"><span class="lineno"> 1265</span>  setStylePickedPositionUndo *undo =</div>
<div class="line"><span class="lineno"> 1266</span>      <span class="keyword">new</span> setStylePickedPositionUndo(paletteHandle, styleId, point);</div>
<div class="line"><span class="lineno"> 1267</span>  undo-&gt;redo();</div>
<div class="line"><span class="lineno"> 1268</span>  TUndoManager::manager()-&gt;add(undo);</div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span>  TUndoManager::manager()-&gt;endBlock();</div>
<div class="line"><span class="lineno"> 1271</span>}</div>
<div class="ttc" id="aclass_t_palette_1_1_page_html_a5d85ded487f7152a95ccbab63c5aecd5"><div class="ttname"><a href="class_t_palette_1_1_page.html#a5d85ded487f7152a95ccbab63c5aecd5">TPalette::Page::search</a></div><div class="ttdeci">int search(int styleId) const</div><div class="ttdef"><b>Definition:</b> tpalette.cpp:215</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ade4586ecdaf9fd428f531d9b98012e30" name="ade4586ecdaf9fd428f531d9b98012e30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade4586ecdaf9fd428f531d9b98012e30">&#9670;&nbsp;</a></span>pickColorByUsingPickedPosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::pickColorByUsingPickedPosition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TImageP</a>&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>frame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1341</span>                                                                        {</div>
<div class="line"><span class="lineno"> 1342</span>  <a class="code hl_class" href="class_t_raster_image_p.html">TRasterImageP</a> ri = img;</div>
<div class="line"><span class="lineno"> 1343</span>  <span class="keywordflow">if</span> (!ri) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1344</span> </div>
<div class="line"><span class="lineno"> 1345</span>  <a class="code hl_class" href="class_t_palette.html">TPalette</a> *currentPalette = paletteHandle-&gt;getPalette();</div>
<div class="line"><span class="lineno"> 1346</span>  <span class="keywordflow">if</span> (!currentPalette) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1347</span> </div>
<div class="line"><span class="lineno"> 1348</span>  <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a> imgSize = ri-&gt;getRaster()-&gt;getSize();</div>
<div class="line"><span class="lineno"> 1349</span>  QHash&lt;int, QPair&lt;TPixel32, TPixel32&gt;&gt; styleList;</div>
<div class="line"><span class="lineno"> 1350</span> </div>
<div class="line"><span class="lineno"> 1351</span>  <span class="comment">// For all styles (starting from #1 as #0 is reserved for the transparent)</span></div>
<div class="line"><span class="lineno"> 1352</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sId = 1; sId &lt; currentPalette-&gt;<a class="code hl_function" href="class_t_palette.html#a5a562f2d3a5fa256fcb4bb2be5b45534">getStyleCount</a>(); sId++) {</div>
<div class="line"><span class="lineno"> 1353</span>    <a class="code hl_class" href="class_t_color_style.html">TColorStyle</a> *style = currentPalette-&gt;<a class="code hl_function" href="class_t_palette.html#a0f6a4eda7dafb0a9f2b43160cfec81e4">getStyle</a>(sId);</div>
<div class="line"><span class="lineno"> 1354</span>    <a class="code hl_class" href="class_t_point_t.html">TPoint</a> pp          = style-&gt;getPickedPosition().pos;</div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keywordtype">int</span> pickedFrame    = style-&gt;getPickedPosition().frame;</div>
<div class="line"><span class="lineno"> 1356</span>    <span class="comment">// If style has a valid picked position</span></div>
<div class="line"><span class="lineno"> 1357</span>    <span class="keywordflow">if</span> (pp != <a class="code hl_class" href="class_t_point_t.html">TPoint</a>() &amp;&amp; frame == pickedFrame &amp;&amp; pp.x &gt;= 0 &amp;&amp;</div>
<div class="line"><span class="lineno"> 1358</span>        pp.x &lt; imgSize.lx &amp;&amp; pp.y &gt;= 0 &amp;&amp; pp.y &lt; imgSize.ly &amp;&amp;</div>
<div class="line"><span class="lineno"> 1359</span>        style-&gt;<a class="code hl_function" href="class_t_color_style.html#a90ad0a12f571c18a5e842acddf1c9a90">hasMainColor</a>()) {</div>
<div class="line"><span class="lineno"> 1360</span>      TPixel32 beforeColor = style-&gt;<a class="code hl_function" href="class_t_color_style.html#abd78dd4e3ff3e2e78b647195f7622aa7">getMainColor</a>();</div>
<div class="line"><span class="lineno"> 1361</span>      TPixel32 afterColor  = pickColor(ri, pp);</div>
<div class="line"><span class="lineno"> 1362</span>      style-&gt;<a class="code hl_function" href="class_t_color_style.html#a7298dce9321f51cfb21f3fcb13701240">setMainColor</a>(afterColor);</div>
<div class="line"><span class="lineno"> 1363</span>      <span class="comment">//... store the style in the list for undo</span></div>
<div class="line"><span class="lineno"> 1364</span>      styleList.insert(sId, QPair&lt;TPixel32, TPixel32&gt;(beforeColor, afterColor));</div>
<div class="line"><span class="lineno"> 1365</span>    }</div>
<div class="line"><span class="lineno"> 1366</span>  }</div>
<div class="line"><span class="lineno"> 1367</span> </div>
<div class="line"><span class="lineno"> 1368</span>  <span class="comment">// if some style has been changed, then register undo and notify changes</span></div>
<div class="line"><span class="lineno"> 1369</span>  <span class="keywordflow">if</span> (!styleList.isEmpty()) {</div>
<div class="line"><span class="lineno"> 1370</span>    pickColorByUsingPickedPositionUndo *undo =</div>
<div class="line"><span class="lineno"> 1371</span>        <span class="keyword">new</span> pickColorByUsingPickedPositionUndo(paletteHandle, styleList);</div>
<div class="line"><span class="lineno"> 1372</span>    TUndoManager::manager()-&gt;add(undo);</div>
<div class="line"><span class="lineno"> 1373</span>    paletteHandle-&gt;notifyColorStyleChanged(<span class="keyword">false</span>, <span class="keyword">true</span>);  <span class="comment">// set dirty flag here</span></div>
<div class="line"><span class="lineno"> 1374</span>  }</div>
<div class="line"><span class="lineno"> 1375</span>}</div>
<div class="ttc" id="aclass_t_color_style_html_a7298dce9321f51cfb21f3fcb13701240"><div class="ttname"><a href="class_t_color_style.html#a7298dce9321f51cfb21f3fcb13701240">TColorStyle::setMainColor</a></div><div class="ttdeci">virtual void setMainColor(const TPixel32 &amp;color)</div><div class="ttdoc">Sets the main color, if it has one.</div><div class="ttdef"><b>Definition:</b> tcolorstyles.h:248</div></div>
<div class="ttc" id="aclass_t_color_style_html_a90ad0a12f571c18a5e842acddf1c9a90"><div class="ttname"><a href="class_t_color_style.html#a90ad0a12f571c18a5e842acddf1c9a90">TColorStyle::hasMainColor</a></div><div class="ttdeci">virtual bool hasMainColor() const</div><div class="ttdoc">Returns whether the style has a reference main color.</div><div class="ttdef"><b>Definition:</b> tcolorstyles.h:242</div></div>
<div class="ttc" id="aclass_t_dimension_t_html"><div class="ttname"><a href="class_t_dimension_t.html">TDimensionT&lt; int &gt;</a></div></div>
<div class="ttc" id="aclass_t_palette_html_a0f6a4eda7dafb0a9f2b43160cfec81e4"><div class="ttname"><a href="class_t_palette.html#a0f6a4eda7dafb0a9f2b43160cfec81e4">TPalette::getStyle</a></div><div class="ttdeci">TColorStyle * getStyle(int styleId) const</div><div class="ttdef"><b>Definition:</b> tpalette.cpp:283</div></div>
<div class="ttc" id="aclass_t_palette_html_a5a562f2d3a5fa256fcb4bb2be5b45534"><div class="ttname"><a href="class_t_palette.html#a5a562f2d3a5fa256fcb4bb2be5b45534">TPalette::getStyleCount</a></div><div class="ttdeci">int getStyleCount() const</div><div class="ttdoc">Returns the number of the color styles in the palette.</div><div class="ttdef"><b>Definition:</b> tpalette.h:255</div></div>
<div class="ttc" id="aclass_t_point_t_html"><div class="ttname"><a href="class_t_point_t.html">TPointT&lt; int &gt;</a></div></div>
<div class="ttc" id="aclass_t_raster_image_p_html"><div class="ttname"><a href="class_t_raster_image_p.html">TRasterImageP</a></div><div class="ttdef"><b>Definition:</b> trasterimage.h:148</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a75213302b1303d48304f99ac5ba175dd" name="a75213302b1303d48304f99ac5ba175dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75213302b1303d48304f99ac5ba175dd">&#9670;&nbsp;</a></span>removeReferenceImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::removeReferenceImage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1012</span>                                                                   {</div>
<div class="line"><span class="lineno"> 1013</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TPaletteP</a> levelPalette = paletteHandle-&gt;getPalette();</div>
<div class="line"><span class="lineno"> 1014</span>  <span class="keywordflow">if</span> (!levelPalette) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1015</span>  <a class="code hl_class" href="class_t_undo.html">TUndo</a> *undo = <span class="keyword">new</span> SetReferenceImageUndo(levelPalette, paletteHandle);</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span>  levelPalette-&gt;<a class="code hl_function" href="class_t_palette.html#a971fd2aac3c14754d6cdcb0679cf6893">setRefImg</a>(<a class="code hl_class" href="class_t_smart_pointer_t.html">TImageP</a>());</div>
<div class="line"><span class="lineno"> 1018</span>  levelPalette-&gt;<a class="code hl_function" href="class_t_palette.html#a3009b4c976d9458d71dca9ea176bd7e1">setRefImgPath</a>(<a class="code hl_class" href="class_t_file_path.html">TFilePath</a>());</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span>  std::vector&lt;TFrameId&gt; fids;</div>
<div class="line"><span class="lineno"> 1021</span>  levelPalette-&gt;<a class="code hl_function" href="class_t_palette.html#a807070f5c3f7033531f455f08ee489c4">setRefLevelFids</a>(fids, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span>  levelPalette-&gt;<a class="code hl_function" href="class_t_palette.html#a382fa102abee4e69e386cb5a4d8d5184">setDirtyFlag</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1024</span>  paletteHandle-&gt;notifyPaletteChanged();</div>
<div class="line"><span class="lineno"> 1025</span> </div>
<div class="line"><span class="lineno"> 1026</span>  TUndoManager::manager()-&gt;add(undo);</div>
<div class="line"><span class="lineno"> 1027</span>}</div>
<div class="ttc" id="aclass_t_file_path_html"><div class="ttname"><a href="class_t_file_path.html">TFilePath</a></div><div class="ttdef"><b>Definition:</b> tfilepath.h:134</div></div>
<div class="ttc" id="aclass_t_palette_html_a3009b4c976d9458d71dca9ea176bd7e1"><div class="ttname"><a href="class_t_palette.html#a3009b4c976d9458d71dca9ea176bd7e1">TPalette::setRefImgPath</a></div><div class="ttdeci">void setRefImgPath(const TFilePath &amp;fp)</div><div class="ttdoc">Sets the path filename of the reference image.</div><div class="ttdef"><b>Definition:</b> tpalette.cpp:1040</div></div>
<div class="ttc" id="aclass_t_palette_html_a807070f5c3f7033531f455f08ee489c4"><div class="ttname"><a href="class_t_palette.html#a807070f5c3f7033531f455f08ee489c4">TPalette::setRefLevelFids</a></div><div class="ttdeci">void setRefLevelFids(const std::vector&lt; TFrameId &gt; fids, bool specified)</div><div class="ttdef"><b>Definition:</b> tpalette.cpp:1028</div></div>
<div class="ttc" id="aclass_t_palette_html_a971fd2aac3c14754d6cdcb0679cf6893"><div class="ttname"><a href="class_t_palette.html#a971fd2aac3c14754d6cdcb0679cf6893">TPalette::setRefImg</a></div><div class="ttdeci">void setRefImg(const TImageP &amp;img)</div><div class="ttdef"><b>Definition:</b> tpalette.cpp:1019</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a402113f4bd931e0144d15a8b0cb002c4" name="a402113f4bd931e0144d15a8b0cb002c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a402113f4bd931e0144d15a8b0cb002c4">&#9670;&nbsp;</a></span>renamePalettePage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::renamePalettePage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pageIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::wstring &amp;&#160;</td>
          <td class="paramname"><em>newName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1118</span>                                                              {</div>
<div class="line"><span class="lineno"> 1119</span>  <span class="keywordflow">if</span> (!paletteHandle) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1120</span>  <a class="code hl_class" href="class_t_palette.html">TPalette</a> *palette = paletteHandle-&gt;getPalette();</div>
<div class="line"><span class="lineno"> 1121</span>  <span class="keywordflow">if</span> (!palette) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1122</span>  <span class="keywordflow">if</span> (pageIndex &lt; 0 || pageIndex &gt;= palette-&gt;getPageCount()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1123</span>  RenamePageUndo *undo = <span class="keyword">new</span> RenamePageUndo(paletteHandle, pageIndex, newName);</div>
<div class="line"><span class="lineno"> 1124</span>  paletteHandle-&gt;notifyPaletteChanged();</div>
<div class="line"><span class="lineno"> 1125</span>  <a class="code hl_class" href="class_t_palette_1_1_page.html">TPalette::Page</a> *page = palette-&gt;getPage(pageIndex);</div>
<div class="line"><span class="lineno"> 1126</span>  assert(page);</div>
<div class="line"><span class="lineno"> 1127</span>  page-&gt;<a class="code hl_function" href="class_t_palette_1_1_page.html#acd6c0eb1874647e8af39da95459cfdde">setName</a>(newName);</div>
<div class="line"><span class="lineno"> 1128</span>  palette-&gt;setDirtyFlag(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1129</span>  paletteHandle-&gt;notifyPaletteChanged();</div>
<div class="line"><span class="lineno"> 1130</span>  TUndoManager::manager()-&gt;add(undo);</div>
<div class="line"><span class="lineno"> 1131</span>}</div>
<div class="ttc" id="aclass_t_palette_1_1_page_html_acd6c0eb1874647e8af39da95459cfdde"><div class="ttname"><a href="class_t_palette_1_1_page.html#acd6c0eb1874647e8af39da95459cfdde">TPalette::Page::setName</a></div><div class="ttdeci">void setName(std::wstring name)</div><div class="ttdoc">Sets the name of the page.</div><div class="ttdef"><b>Definition:</b> tpalette.h:109</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2c398e5ac92c0586bf6af4ab4d918e9" name="ab2c398e5ac92c0586bf6af4ab4d918e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2c398e5ac92c0586bf6af4ab4d918e9">&#9670;&nbsp;</a></span>renamePaletteStyle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PaletteCmd::renamePaletteStyle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_handle.html">TPaletteHandle</a> *&#160;</td>
          <td class="paramname"><em>paletteHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::wstring &amp;&#160;</td>
          <td class="paramname"><em>newName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1184</span>                                                               {</div>
<div class="line"><span class="lineno"> 1185</span>  <span class="keywordflow">if</span> (!paletteHandle) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1186</span>  <a class="code hl_class" href="class_t_palette.html">TPalette</a> *palette = paletteHandle-&gt;getPalette();</div>
<div class="line"><span class="lineno"> 1187</span>  <span class="keywordflow">if</span> (!palette) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1188</span>  <a class="code hl_class" href="class_t_color_style.html">TColorStyle</a> *style = paletteHandle-&gt;getStyle();</div>
<div class="line"><span class="lineno"> 1189</span>  <span class="keywordflow">if</span> (!style) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1190</span>  <span class="keywordflow">if</span> (style-&gt;<a class="code hl_function" href="class_t_color_style.html#a611de20d126c5838456f9113b4682c4f">getName</a>() == newName) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1191</span> </div>
<div class="line"><span class="lineno"> 1192</span>  RenamePaletteStyleUndo *undo =</div>
<div class="line"><span class="lineno"> 1193</span>      <span class="keyword">new</span> RenamePaletteStyleUndo(paletteHandle, newName);</div>
<div class="line"><span class="lineno"> 1194</span>  style-&gt;<a class="code hl_function" href="class_t_color_style.html#aeb25e0ae1708d473bd551b0d0c9bf4a9">setName</a>(newName);</div>
<div class="line"><span class="lineno"> 1195</span>  palette-&gt;setDirtyFlag(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1196</span>  paletteHandle-&gt;notifyColorStyleChanged(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1197</span>  TUndoManager::manager()-&gt;add(undo);</div>
<div class="line"><span class="lineno"> 1198</span>}</div>
<div class="ttc" id="aclass_t_color_style_html_a611de20d126c5838456f9113b4682c4f"><div class="ttname"><a href="class_t_color_style.html#a611de20d126c5838456f9113b4682c4f">TColorStyle::getName</a></div><div class="ttdeci">std::wstring getName() const</div><div class="ttdoc">Returns the style's user-defined name.</div><div class="ttdef"><b>Definition:</b> tcolorstyles.h:190</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
