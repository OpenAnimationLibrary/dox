<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: TFxCacheManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="class_t_fx_cache_manager-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">TFxCacheManager Class Reference<span class="mlabels"><span class="mlabel">final</span></span></div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="">tfxcachemanager.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for TFxCacheManager:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_t_fx_cache_manager.png" usemap="#TFxCacheManager_map" alt=""/>
  <map id="TFxCacheManager_map" name="TFxCacheManager_map">
<area href="class_t_render_resource_manager.html" alt="TRenderResourceManager" shape="rect" coords="0,0,165,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_fx_cache_manager_1_1_imp.html">Imp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7780c7d19f93b7bbeeb60b71db0b5a0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_fx_cache_manager.html#a7780c7d19f93b7bbeeb60b71db0b5a0e">add</a> (const std::string &amp;cacheId, <a class="el" href="class_t_smart_pointer_t.html">TImageP</a> img)</td></tr>
<tr class="separator:a7780c7d19f93b7bbeeb60b71db0b5a0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53f975fa38ea23a1943d5e631de65309"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_fx_cache_manager.html#a53f975fa38ea23a1943d5e631de65309">remove</a> (const std::string &amp;cacheId)</td></tr>
<tr class="separator:a53f975fa38ea23a1943d5e631de65309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a910e6276ca8ec11c330406e687a277f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_fx_cache_manager.html#a910e6276ca8ec11c330406e687a277f6">onRenderStatusStart</a> (int renderStatus) override</td></tr>
<tr class="separator:a910e6276ca8ec11c330406e687a277f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4c1ca95fa7cc174dca0820fad042db0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_fx_cache_manager.html#aa4c1ca95fa7cc174dca0820fad042db0">onRenderStatusEnd</a> (int renderStatus) override</td></tr>
<tr class="separator:aa4c1ca95fa7cc174dca0820fad042db0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_t_render_resource_manager"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_t_render_resource_manager')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_t_render_resource_manager.html">TRenderResourceManager</a></td></tr>
<tr class="memitem:a73ebf8351fc31f4b5bda59efe5f33bc4 inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#a73ebf8351fc31f4b5bda59efe5f33bc4">onRenderInstanceStart</a> (unsigned long id)</td></tr>
<tr class="separator:a73ebf8351fc31f4b5bda59efe5f33bc4 inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9db5f4c3868c80a40510d627bb3e56e inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#aa9db5f4c3868c80a40510d627bb3e56e">onRenderInstanceEnd</a> (unsigned long id)</td></tr>
<tr class="separator:aa9db5f4c3868c80a40510d627bb3e56e inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d51cf7f77a517629ab0424f98f40476 inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#a2d51cf7f77a517629ab0424f98f40476">onRenderFrameStart</a> (double f)</td></tr>
<tr class="separator:a2d51cf7f77a517629ab0424f98f40476 inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a1838e9bb5e34e002ec7206359c07e1 inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#a6a1838e9bb5e34e002ec7206359c07e1">onRenderFrameEnd</a> (double f)</td></tr>
<tr class="separator:a6a1838e9bb5e34e002ec7206359c07e1 inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81660da50daf6031078f40664627994d inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#a81660da50daf6031078f40664627994d">onRenderStatusStart</a> (int renderStatus)</td></tr>
<tr class="separator:a81660da50daf6031078f40664627994d inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b6d6975d4978f84b0e0cb5d60c25cc4 inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#a3b6d6975d4978f84b0e0cb5d60c25cc4">onRenderStatusEnd</a> (int renderStatus)</td></tr>
<tr class="separator:a3b6d6975d4978f84b0e0cb5d60c25cc4 inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affd1dfa5de168ea5b7cedeb88de538c4 inherit pub_methods_class_t_render_resource_manager"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_render_resource_manager.html#affd1dfa5de168ea5b7cedeb88de538c4">renderHasOwnership</a> ()</td></tr>
<tr class="separator:affd1dfa5de168ea5b7cedeb88de538c4 inherit pub_methods_class_t_render_resource_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a49f759dce50b6b7f791d5271f0b4496f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_t_fx_cache_manager.html">TFxCacheManager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_fx_cache_manager.html#a49f759dce50b6b7f791d5271f0b4496f">instance</a> ()</td></tr>
<tr class="separator:a49f759dce50b6b7f791d5271f0b4496f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a564517dc204d69d4a5dae314c324d836"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_fx_cache_manager.html#a564517dc204d69d4a5dae314c324d836">ResourceBuilder</a></td></tr>
<tr class="separator:a564517dc204d69d4a5dae314c324d836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a376a495947174f544668dc7c1ef9bd64"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_fx_cache_manager.html#a376a495947174f544668dc7c1ef9bd64">TFxCacheManagerDelegate</a></td></tr>
<tr class="separator:a376a495947174f544668dc7c1ef9bd64"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >The <a class="el" href="class_t_fx_cache_manager.html">TFxCacheManager</a> is the main resource manager that deals with fx nodes caching inside Toonz rendering processes. During a render process, a considerable amount of time can be saved if any intermediate rendered result used more than once is saved in cache and reused multiple times rather than rebuilding it every time. In some cases, the user may even know that some specific intermediate result is useful for rendering purposes, and could explicitly require that it needs to be cached. <br  />
 <br  />
In Toonz's rendering workflow, these operations are managed by the <a class="el" href="class_t_fx_cache_manager.html">TFxCacheManager</a> class, which delegates specific caching procedures to a group of <a class="el" href="class_t_fx_cache_manager_delegate.html">TFxCacheManagerDelegate</a> instances. <br  />
 <br  />
Access to a cache resource is performed through the getResource() method, which requires a description of the resource (as specified in the <a class="el" href="class_t_cache_resource.html">TCacheResource</a> class) and some information - namely, the fx, render settings and frame - about the circumstances of the request. If the resource is managed by some manager delegate, it will be returned. <br  />
 <br  />
Resource uploads and downloads must be notified through the apposite methods to inform the manager delegates appropriately. These notifications can be invoked without need that the associated method is actually invoked for the resource - this is especially required when the <a class="el" href="class_t_renderer.html">TRenderer</a> instance is simulating the actual render process for predictive purposes.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="class_t_cache_resource.html">TCacheResource</a>, <a class="el" href="class_t_passive_cache_manager.html">TPassiveCacheManager</a>, <a class="el" href="class_t_predictive_cache_manager.html">TPredictiveCacheManager</a> and <a class="el" href="class_t_renderer.html">TRenderer</a> classes </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a621d87e22fda8b227cc773138fdd72a7" name="a621d87e22fda8b227cc773138fdd72a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a621d87e22fda8b227cc773138fdd72a7">&#9670;&nbsp;</a></span>TFxCacheManager()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TFxCacheManager::TFxCacheManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  161</span>: m_imp(<span class="keyword">new</span> Imp) {}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0443b7364b47d31463178e9f28ba1130" name="a0443b7364b47d31463178e9f28ba1130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0443b7364b47d31463178e9f28ba1130">&#9670;&nbsp;</a></span>~TFxCacheManager()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TFxCacheManager::~TFxCacheManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  165</span>                                  {</div>
<div class="line"><span class="lineno">  166</span>  <span class="comment">// Release all the static-cached images</span></div>
<div class="line"><span class="lineno">  167</span>  std::set&lt;std::string&gt;::iterator it;</div>
<div class="line"><span class="lineno">  168</span>  <span class="keywordflow">for</span> (it = m_staticCacheIds.begin(); it != m_staticCacheIds.end(); ++it)</div>
<div class="line"><span class="lineno">  169</span>    TImageCache::instance()-&gt;<a class="code hl_function" href="class_t_image_cache.html#a57d63227dfe2532b0aed22c47113be66">remove</a>(*it);</div>
<div class="line"><span class="lineno">  170</span>}</div>
<div class="ttc" id="aclass_t_image_cache_html_a57d63227dfe2532b0aed22c47113be66"><div class="ttname"><a href="class_t_image_cache.html#a57d63227dfe2532b0aed22c47113be66">TImageCache::remove</a></div><div class="ttdeci">void remove(const std::string &amp;id)</div><div class="ttdoc">Removes from the image cache the image associated to passed id.</div><div class="ttdef"><b>Definition:</b> timagecache.cpp:1260</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7780c7d19f93b7bbeeb60b71db0b5a0e" name="a7780c7d19f93b7bbeeb60b71db0b5a0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7780c7d19f93b7bbeeb60b71db0b5a0e">&#9670;&nbsp;</a></span>add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TFxCacheManager::add </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>cacheId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_smart_pointer_t.html">TImageP</a>&#160;</td>
          <td class="paramname"><em>img</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  181</span>                                                               {</div>
<div class="line"><span class="lineno">  182</span>  TImageCache::instance()-&gt;<a class="code hl_function" href="class_t_image_cache.html#a124eae4cf370288f42c22b3477cb5163">add</a>(cacheId, img);</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>  QMutexLocker locker(&amp;m_imp-&gt;m_mutex);</div>
<div class="line"><span class="lineno">  185</span>  m_staticCacheIds.insert(cacheId);</div>
<div class="line"><span class="lineno">  186</span>}</div>
<div class="ttc" id="aclass_t_image_cache_html_a124eae4cf370288f42c22b3477cb5163"><div class="ttname"><a href="class_t_image_cache.html#a124eae4cf370288f42c22b3477cb5163">TImageCache::add</a></div><div class="ttdeci">void add(const std::string &amp;id, const TImageP &amp;img, bool overwrite=true)</div><div class="ttdef"><b>Definition:</b> timagecache.cpp:1153</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a49f759dce50b6b7f791d5271f0b4496f" name="a49f759dce50b6b7f791d5271f0b4496f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49f759dce50b6b7f791d5271f0b4496f">&#9670;&nbsp;</a></span>instance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_fx_cache_manager.html">TFxCacheManager</a> * TFxCacheManager::instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  174</span>                                           {</div>
<div class="line"><span class="lineno">  175</span>  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="class_t_fx_cache_manager.html">TFxCacheManager</a> *<span class="keyword">&gt;</span>(</div>
<div class="line"><span class="lineno">  176</span>      TFxCacheManager::gen()-&gt;getManager(<a class="code hl_function" href="class_t_renderer.html#ab120ad7931abf8858c10459d66f4c659">TRenderer::renderId</a>()));</div>
<div class="line"><span class="lineno">  177</span>}</div>
<div class="ttc" id="aclass_t_fx_cache_manager_html"><div class="ttname"><a href="class_t_fx_cache_manager.html">TFxCacheManager</a></div><div class="ttdef"><b>Definition:</b> tfxcachemanager.h:203</div></div>
<div class="ttc" id="aclass_t_renderer_html_ab120ad7931abf8858c10459d66f4c659"><div class="ttname"><a href="class_t_renderer.html#ab120ad7931abf8858c10459d66f4c659">TRenderer::renderId</a></div><div class="ttdeci">static unsigned long renderId()</div><div class="ttdef"><b>Definition:</b> trenderer.cpp:485</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4c1ca95fa7cc174dca0820fad042db0" name="aa4c1ca95fa7cc174dca0820fad042db0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4c1ca95fa7cc174dca0820fad042db0">&#9670;&nbsp;</a></span>onRenderStatusEnd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TFxCacheManager::onRenderStatusEnd </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>renderStatus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="class_t_render_resource_manager.html">TRenderResourceManager</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  326</span>                                                        {</div>
<div class="line"><span class="lineno">  327</span>  <span class="keywordflow">if</span> (renderStatus == TRenderer::FIRSTRUN) {</div>
<div class="line"><span class="lineno">  328</span>    Imp::ResourceInstanceDataMap &amp;resMap = m_imp-&gt;m_resourcesData;</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>    Imp::ResourceInstanceDataMap::iterator it;</div>
<div class="line"><span class="lineno">  331</span>    <span class="keywordflow">for</span> (it = resMap.begin(); it != resMap.end();) {</div>
<div class="line"><span class="lineno">  332</span>      m_imp-&gt;prepareTilesToCalculate(it-&gt;second);</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>      <span class="comment">// Cannot be done. The resource could still be feasible to caching,</span></div>
<div class="line"><span class="lineno">  335</span>      <span class="comment">// due to external requests.</span></div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>      <span class="comment">// Erase all resource datas which have been declared and prepared only</span></div>
<div class="line"><span class="lineno">  338</span>      <span class="comment">// once</span></div>
<div class="line"><span class="lineno">  339</span>      <span class="comment">/*if(it-&gt;second.m_tiles.size() == 1 &amp;&amp;</span></div>
<div class="line"><span class="lineno">  340</span><span class="comment">it-&gt;second.m_simData-&gt;m_tiles.size() == 1)</span></div>
<div class="line"><span class="lineno">  341</span><span class="comment">{</span></div>
<div class="line"><span class="lineno">  342</span><span class="comment">it = resMap.erase(it);</span></div>
<div class="line"><span class="lineno">  343</span><span class="comment">continue;</span></div>
<div class="line"><span class="lineno">  344</span><span class="comment">}*/</span></div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>      ++it;</div>
<div class="line"><span class="lineno">  347</span>    }</div>
<div class="line"><span class="lineno">  348</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (renderStatus == TRenderer::TESTRUN) {</div>
<div class="line"><span class="lineno">  349</span>    Imp::ResourceInstanceDataMap &amp;resMap = m_imp-&gt;m_resourcesData;</div>
<div class="line"><span class="lineno">  350</span>    Imp::ResourceInstanceDataMap::iterator it;</div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">for</span> (it = resMap.begin(); it != resMap.end();) {</div>
<div class="line"><span class="lineno">  352</span>      <span class="comment">// Release all resource declarations which are declared to be used only</span></div>
<div class="line"><span class="lineno">  353</span>      <span class="comment">// once.</span></div>
<div class="line"><span class="lineno">  354</span>      <span class="keywordflow">if</span> (it-&gt;second.m_tiles.size() == 1 &amp;&amp;</div>
<div class="line"><span class="lineno">  355</span>          it-&gt;second.m_tiles[0].m_refCount == 1) {</div>
<div class="line"><span class="lineno">  356</span>        Imp::ResourceInstanceDataMap::iterator jt = it++;</div>
<div class="line"><span class="lineno">  357</span>        resMap.erase(jt);</div>
<div class="line"><span class="lineno">  358</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  359</span>      }</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>      <span class="comment">// In any case, release all simulation datas - they are no longer useful.</span></div>
<div class="line"><span class="lineno">  362</span>      <span class="comment">// An associated cache resource avoids deletion only in case some manager</span></div>
<div class="line"><span class="lineno">  363</span>      <span class="comment">// retained it.</span></div>
<div class="line"><span class="lineno">  364</span>      it-&gt;second.m_rawData = 0;</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>      ++it;</div>
<div class="line"><span class="lineno">  367</span>    }</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span><span class="preprocessor">#ifdef WRITEGENERAL</span></div>
<div class="line"><span class="lineno">  370</span>    DIAGNOSTICS_SET(<span class="stringliteral">&quot;Declarations used more than once&quot;</span>, resMap.size());</div>
<div class="line"><span class="lineno">  371</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>    m_imp-&gt;m_rawData.clear();</div>
<div class="line"><span class="lineno">  374</span>  }</div>
<div class="line"><span class="lineno">  375</span><span class="preprocessor">#ifdef WRITEGENERAL</span></div>
<div class="line"><span class="lineno">  376</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  377</span>    <span class="comment">// Print the number of not depleted declarations</span></div>
<div class="line"><span class="lineno">  378</span>    Imp::ResourceInstanceDataMap &amp;resMap = m_imp-&gt;m_resourcesData;</div>
<div class="line"><span class="lineno">  379</span>    Imp::ResourceInstanceDataMap::iterator it;</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>    DIAGNOSTICS_ADD(</div>
<div class="line"><span class="lineno">  382</span>        prefixErr + <span class="stringliteral">&quot;Computing | Declarations survived after Test Run&quot;</span>,</div>
<div class="line"><span class="lineno">  383</span>        resMap.size());</div>
<div class="line"><span class="lineno">  384</span>    <span class="keywordflow">if</span> (resMap.size() &gt; 0) {</div>
<div class="line"><span class="lineno">  385</span>      <span class="keywordflow">for</span> (it = resMap.begin(); it != resMap.end(); ++it) {</div>
<div class="line"><span class="lineno">  386</span>        DIAGNOSTICS_STR(prefixErr + <span class="stringliteral">&quot;Survived Declarations | &quot;</span> +</div>
<div class="line"><span class="lineno">  387</span>                        QString::fromStdString(it-&gt;first).left(40));</div>
<div class="line"><span class="lineno">  388</span>      }</div>
<div class="line"><span class="lineno">  389</span>    }</div>
<div class="line"><span class="lineno">  390</span>  }</div>
<div class="line"><span class="lineno">  391</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  392</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a910e6276ca8ec11c330406e687a277f6" name="a910e6276ca8ec11c330406e687a277f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a910e6276ca8ec11c330406e687a277f6">&#9670;&nbsp;</a></span>onRenderStatusStart()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TFxCacheManager::onRenderStatusStart </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>renderStatus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="class_t_render_resource_manager.html">TRenderResourceManager</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  299</span>                                                          {</div>
<div class="line"><span class="lineno">  300</span>  <span class="comment">// Store current render status</span></div>
<div class="line"><span class="lineno">  301</span>  m_imp-&gt;m_renderStatus = renderStatus;</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span><span class="preprocessor">#ifdef WRITESTACK</span></div>
<div class="line"><span class="lineno">  304</span>  <span class="keywordflow">if</span> (renderStatus == TRenderer::TESTRUN) {</div>
<div class="line"><span class="lineno">  305</span>    DIAGNOSTICS_GLOSTRSET(<span class="stringliteral">&quot;status&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>);</div>
<div class="line"><span class="lineno">  306</span>    DIAGNOSTICS_GLOSET(<span class="stringliteral">&quot;testInst&quot;</span>, DIAGNOSTICS_GLOGET(<span class="stringliteral">&quot;compInst&quot;</span>) + 1);</div>
<div class="line"><span class="lineno">  307</span>    DIAGNOSTICS_GLOSTRSET(<span class="stringliteral">&quot;instVar&quot;</span>,</div>
<div class="line"><span class="lineno">  308</span>                          QString::number(DIAGNOSTICS_GLOGET(<span class="stringliteral">&quot;testInst&quot;</span>)));</div>
<div class="line"><span class="lineno">  309</span>    DIAGNOSTICS_GLOSTRSET(</div>
<div class="line"><span class="lineno">  310</span>        <span class="stringliteral">&quot;testRenderStr&quot;</span>,</div>
<div class="line"><span class="lineno">  311</span>        <span class="stringliteral">&quot;Render #&quot;</span> + QString::number(DIAGNOSTICS_GLOGET(<span class="stringliteral">&quot;testInst&quot;</span>)) + <span class="stringliteral">&quot; | &quot;</span>);</div>
<div class="line"><span class="lineno">  312</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (renderStatus == TRenderer::COMPUTING) {</div>
<div class="line"><span class="lineno">  313</span>    DIAGNOSTICS_GLOSTRSET(<span class="stringliteral">&quot;status&quot;</span>, <span class="stringliteral">&quot;comp&quot;</span>);</div>
<div class="line"><span class="lineno">  314</span>    DIAGNOSTICS_GLOSTRSET(<span class="stringliteral">&quot;instVar&quot;</span>,</div>
<div class="line"><span class="lineno">  315</span>                          QString::number(DIAGNOSTICS_GLOGET(<span class="stringliteral">&quot;compInst&quot;</span>)));</div>
<div class="line"><span class="lineno">  316</span>    DIAGNOSTICS_GLOSTRSET(</div>
<div class="line"><span class="lineno">  317</span>        <span class="stringliteral">&quot;compRenderStr&quot;</span>,</div>
<div class="line"><span class="lineno">  318</span>        <span class="stringliteral">&quot;Render #&quot;</span> + QString::number(DIAGNOSTICS_GLOGET(<span class="stringliteral">&quot;compInst&quot;</span>)) + <span class="stringliteral">&quot; | &quot;</span>);</div>
<div class="line"><span class="lineno">  319</span>    DIAGNOSTICS_GLOSET(DIAGNOSTICS_THRSTRGET(<span class="stringliteral">&quot;stackVar&quot;</span>), 0);</div>
<div class="line"><span class="lineno">  320</span>  }</div>
<div class="line"><span class="lineno">  321</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  322</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a53f975fa38ea23a1943d5e631de65309" name="a53f975fa38ea23a1943d5e631de65309"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53f975fa38ea23a1943d5e631de65309">&#9670;&nbsp;</a></span>remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TFxCacheManager::remove </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>cacheId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  190</span>                                                     {</div>
<div class="line"><span class="lineno">  191</span>  TImageCache::instance()-&gt;<a class="code hl_function" href="class_t_image_cache.html#a57d63227dfe2532b0aed22c47113be66">remove</a>(cacheId);</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>  QMutexLocker locker(&amp;m_imp-&gt;m_mutex);</div>
<div class="line"><span class="lineno">  194</span>  m_staticCacheIds.erase(cacheId);</div>
<div class="line"><span class="lineno">  195</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a564517dc204d69d4a5dae314c324d836" name="a564517dc204d69d4a5dae314c324d836"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a564517dc204d69d4a5dae314c324d836">&#9670;&nbsp;</a></span>ResourceBuilder</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="class_resource_builder.html">ResourceBuilder</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a376a495947174f544668dc7c1ef9bd64" name="a376a495947174f544668dc7c1ef9bd64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a376a495947174f544668dc7c1ef9bd64">&#9670;&nbsp;</a></span>TFxCacheManagerDelegate</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="class_t_fx_cache_manager_delegate.html">TFxCacheManagerDelegate</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>E:/opentoonz/toonz/sources/include/<a class="el" href="">tfxcachemanager.h</a></li>
<li>E:/opentoonz/toonz/sources/common/tfx/<a class="el" href="">tfxcachemanager.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
