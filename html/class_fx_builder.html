<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: FxBuilder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="class_fx_builder-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">FxBuilder Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8ea63072330ed73d674ab7f46c6c71fb"><td class="memItemLeft" align="right" valign="top"><a id="a8ea63072330ed73d674ab7f46c6c71fb" name="a8ea63072330ed73d674ab7f46c6c71fb"></a>
virtual <a class="el" href="class_t_fx.html">TFx</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>create</b> ()=0</td></tr>
<tr class="separator:a8ea63072330ed73d674ab7f46c6c71fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b36d3d2e4519905709916d8ead67b32"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a6b36d3d2e4519905709916d8ead67b32">FxBuilder</a> (<a class="el" href="class_toonz_scene.html">ToonzScene</a> *scene, <a class="el" href="class_t_xsheet.html">TXsheet</a> *xsh, double frame, int whichLevels, bool isPreview=false, bool expandXSheet=true)</td></tr>
<tr class="separator:a6b36d3d2e4519905709916d8ead67b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb1d1d5091403098a59b18343630d5cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_smart_pointer_t.html">TFxP</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#acb1d1d5091403098a59b18343630d5cb">buildFx</a> ()</td></tr>
<tr class="separator:acb1d1d5091403098a59b18343630d5cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6a20f86015205c3f4c3172f04cb3563"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_smart_pointer_t.html">TFxP</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#ac6a20f86015205c3f4c3172f04cb3563">buildFx</a> (const <a class="el" href="class_t_smart_pointer_t.html">TFxP</a> &amp;root, BSFX_Transforms_Enum transforms)</td></tr>
<tr class="separator:ac6a20f86015205c3f4c3172f04cb3563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4024bf49b3f6b19ba3fe964807f5741"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_placed_fx.html">PlacedFx</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a> (<a class="el" href="class_t_level_column_fx.html">TLevelColumnFx</a> *fx)</td></tr>
<tr class="memdesc:af4024bf49b3f6b19ba3fe964807f5741"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and returns a <a class="el" href="class_placed_fx.html" title="PlacedFx is the enriched form of a TRasterFx during render-tree building.">PlacedFx</a> for a <a class="el" href="class_t_level_column_fx.html">TLevelColumnFx</a>.  <a href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">More...</a><br /></td></tr>
<tr class="separator:af4024bf49b3f6b19ba3fe964807f5741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86621eb84b5875b07b55ea40ff1d3666"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_placed_fx.html">PlacedFx</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a86621eb84b5875b07b55ea40ff1d3666">makePF</a> (<a class="el" href="class_t_palette_column_fx.html">TPaletteColumnFx</a> *fx)</td></tr>
<tr class="separator:a86621eb84b5875b07b55ea40ff1d3666"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a667b5d262be3d9eaadcd9b07c963e042"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_placed_fx.html">PlacedFx</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a667b5d262be3d9eaadcd9b07c963e042">makePF</a> (<a class="el" href="class_t_zerary_column_fx.html">TZeraryColumnFx</a> *fx)</td></tr>
<tr class="separator:a667b5d262be3d9eaadcd9b07c963e042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1308f052cb48063d9f09070aa3cb5011"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_placed_fx.html">PlacedFx</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a1308f052cb48063d9f09070aa3cb5011">makePF</a> (<a class="el" href="class_t_xsheet_fx.html">TXsheetFx</a> *fx)</td></tr>
<tr class="separator:a1308f052cb48063d9f09070aa3cb5011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2cd5c3ff5f84d9ee57c8aa120499d3f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_placed_fx.html">PlacedFx</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#af2cd5c3ff5f84d9ee57c8aa120499d3f">makePFfromUnaryFx</a> (<a class="el" href="class_t_fx.html">TFx</a> *fx)</td></tr>
<tr class="separator:af2cd5c3ff5f84d9ee57c8aa120499d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58c42d6b54479ccf18a383cf41c47c18"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_placed_fx.html">PlacedFx</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a58c42d6b54479ccf18a383cf41c47c18">makePFfromGenericFx</a> (<a class="el" href="class_t_fx.html">TFx</a> *fx)</td></tr>
<tr class="separator:a58c42d6b54479ccf18a383cf41c47c18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a105b12f0f084a99b7f9c07720b1abad1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_placed_fx.html">PlacedFx</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a105b12f0f084a99b7f9c07720b1abad1">makePF</a> (<a class="el" href="class_t_fx.html">TFx</a> *fx)</td></tr>
<tr class="separator:a105b12f0f084a99b7f9c07720b1abad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48745e61176afd14b1061c85ac90deef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_smart_pointer_t.html">TFxP</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a48745e61176afd14b1061c85ac90deef">getFxWithColumnMovements</a> (const <a class="el" href="class_placed_fx.html">PlacedFx</a> &amp;pf)</td></tr>
<tr class="separator:a48745e61176afd14b1061c85ac90deef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb678d126b7110d9eb2777fc27933c34"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#afb678d126b7110d9eb2777fc27933c34">addPlasticDeformerFx</a> (<a class="el" href="class_placed_fx.html">PlacedFx</a> &amp;pf)</td></tr>
<tr class="separator:afb678d126b7110d9eb2777fc27933c34"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a7605d87ea2fd2da04e8e653e227591b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_toonz_scene.html">ToonzScene</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a7605d87ea2fd2da04e8e653e227591b2">m_scene</a></td></tr>
<tr class="separator:a7605d87ea2fd2da04e8e653e227591b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b0cb40853b2c631ce2226d3e8fbee27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_xsheet.html">TXsheet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a8b0cb40853b2c631ce2226d3e8fbee27">m_xsh</a></td></tr>
<tr class="separator:a8b0cb40853b2c631ce2226d3e8fbee27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebedc07193e4c1c3f7836eee158d307b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_affine.html">TAffine</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#aebedc07193e4c1c3f7836eee158d307b">m_cameraAff</a></td></tr>
<tr class="separator:aebedc07193e4c1c3f7836eee158d307b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab193cbe36ac178a47e89352104fb72f7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#ab193cbe36ac178a47e89352104fb72f7">m_cameraZ</a></td></tr>
<tr class="separator:ab193cbe36ac178a47e89352104fb72f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e3accce3ade7141906b6c8290c0dc83"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a7e3accce3ade7141906b6c8290c0dc83">m_frame</a></td></tr>
<tr class="separator:a7e3accce3ade7141906b6c8290c0dc83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a847ef9f9181a798f01f56aafb31c9456"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a847ef9f9181a798f01f56aafb31c9456">m_whichLevels</a></td></tr>
<tr class="separator:a847ef9f9181a798f01f56aafb31c9456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40e338c0b1fc2412bbf8058aaa247293"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a40e338c0b1fc2412bbf8058aaa247293">m_isPreview</a></td></tr>
<tr class="separator:a40e338c0b1fc2412bbf8058aaa247293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4a1bbd35d06c3843732c737587c71c6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#ae4a1bbd35d06c3843732c737587c71c6">m_expandXSheet</a></td></tr>
<tr class="separator:ae4a1bbd35d06c3843732c737587c71c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbef4e5db9b886b35f22d18557d626f0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#abbef4e5db9b886b35f22d18557d626f0">m_particleDescendentCount</a></td></tr>
<tr class="separator:abbef4e5db9b886b35f22d18557d626f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a047a6e90b2c124db3704a7870e88543b"><td class="memItemLeft" align="right" valign="top">QMap&lt; std::wstring, QPair&lt; <a class="el" href="class_t_smart_pointer_t.html">TFxP</a>, bool &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fx_builder.html#a047a6e90b2c124db3704a7870e88543b">m_globalControlledFx</a></td></tr>
<tr class="separator:a047a6e90b2c124db3704a7870e88543b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"></div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a731954fc28728ce40986c032a47f1d11" name="a731954fc28728ce40986c032a47f1d11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a731954fc28728ce40986c032a47f1d11">&#9670;&nbsp;</a></span>~FxBuilder()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual FxBuilder::~FxBuilder </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   28</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b36d3d2e4519905709916d8ead67b32" name="a6b36d3d2e4519905709916d8ead67b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b36d3d2e4519905709916d8ead67b32">&#9670;&nbsp;</a></span>FxBuilder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FxBuilder::FxBuilder </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_toonz_scene.html">ToonzScene</a> *&#160;</td>
          <td class="paramname"><em>scene</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsheet.html">TXsheet</a> *&#160;</td>
          <td class="paramname"><em>xsh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichLevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isPreview</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>expandXSheet</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  588</span>    : m_scene(scene)</div>
<div class="line"><span class="lineno">  589</span>    , m_xsh(xsh)</div>
<div class="line"><span class="lineno">  590</span>    , m_frame(frame)</div>
<div class="line"><span class="lineno">  591</span>    , m_whichLevels(whichLevels)</div>
<div class="line"><span class="lineno">  592</span>    , m_isPreview(isPreview)</div>
<div class="line"><span class="lineno">  593</span>    , m_expandXSheet(expandXSheet)</div>
<div class="line"><span class="lineno">  594</span>    , m_particleDescendentCount(0) {</div>
<div class="line"><span class="lineno">  595</span>  <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> cameraId;</div>
<div class="line"><span class="lineno">  596</span>  <span class="keywordflow">if</span> (m_isPreview)</div>
<div class="line"><span class="lineno">  597</span>    cameraId = m_xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#a5dc925584e35e1678f5678b79c470959">getStageObjectTree</a>()-&gt;getCurrentPreviewCameraId();</div>
<div class="line"><span class="lineno">  598</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  599</span>    cameraId = m_xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#a5dc925584e35e1678f5678b79c470959">getStageObjectTree</a>()-&gt;<a class="code hl_function" href="class_t_stage_object_tree.html#a7d63ae5d60c3a3aacf5da58c108ac167">getCurrentCameraId</a>();</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>  <a class="code hl_class" href="class_t_stage_object.html">TStageObject</a> *camera = m_xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#a13d9b9c08ca8dde39769f5644e046ee5">getStageObject</a>(cameraId);</div>
<div class="line"><span class="lineno">  602</span>  m_cameraAff          = camera-&gt;getPlacement(m_frame);</div>
<div class="line"><span class="lineno">  603</span>  m_cameraZ            = camera-&gt;<a class="code hl_function" href="class_t_stage_object.html#a52b1a3ec50ed35fbc07c9a3b64ecc21c">getZ</a>(m_frame);</div>
<div class="line"><span class="lineno">  604</span>}</div>
<div class="ttc" id="aclass_t_stage_object_html"><div class="ttname"><a href="class_t_stage_object.html">TStageObject</a></div><div class="ttdef"><b>Definition:</b> tstageobject.h:95</div></div>
<div class="ttc" id="aclass_t_stage_object_html_a52b1a3ec50ed35fbc07c9a3b64ecc21c"><div class="ttname"><a href="class_t_stage_object.html#a52b1a3ec50ed35fbc07c9a3b64ecc21c">TStageObject::getZ</a></div><div class="ttdeci">double getZ(double frame)</div><div class="ttdef"><b>Definition:</b> tstageobject.cpp:1423</div></div>
<div class="ttc" id="aclass_t_stage_object_id_html"><div class="ttname"><a href="class_t_stage_object_id.html">TStageObjectId</a></div><div class="ttdef"><b>Definition:</b> tstageobjectid.h:36</div></div>
<div class="ttc" id="aclass_t_stage_object_tree_html_a7d63ae5d60c3a3aacf5da58c108ac167"><div class="ttname"><a href="class_t_stage_object_tree.html#a7d63ae5d60c3a3aacf5da58c108ac167">TStageObjectTree::getCurrentCameraId</a></div><div class="ttdeci">TStageObjectId getCurrentCameraId() const</div><div class="ttdef"><b>Definition:</b> tstageobjecttree.cpp:508</div></div>
<div class="ttc" id="aclass_t_xsheet_html_a13d9b9c08ca8dde39769f5644e046ee5"><div class="ttname"><a href="class_t_xsheet.html#a13d9b9c08ca8dde39769f5644e046ee5">TXsheet::getStageObject</a></div><div class="ttdeci">TStageObject * getStageObject(const TStageObjectId &amp;id) const</div><div class="ttdef"><b>Definition:</b> txsheet.cpp:542</div></div>
<div class="ttc" id="aclass_t_xsheet_html_a5dc925584e35e1678f5678b79c470959"><div class="ttname"><a href="class_t_xsheet.html#a5dc925584e35e1678f5678b79c470959">TXsheet::getStageObjectTree</a></div><div class="ttdeci">TStageObjectTree * getStageObjectTree() const</div><div class="ttdef"><b>Definition:</b> txsheet.cpp:549</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="afb678d126b7110d9eb2777fc27933c34" name="afb678d126b7110d9eb2777fc27933c34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb678d126b7110d9eb2777fc27933c34">&#9670;&nbsp;</a></span>addPlasticDeformerFx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FxBuilder::addPlasticDeformerFx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_placed_fx.html">PlacedFx</a> &amp;&#160;</td>
          <td class="paramname"><em>pf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  659</span>                                                 {</div>
<div class="line"><span class="lineno">  660</span>  <a class="code hl_class" href="class_t_stage_object.html">TStageObject</a> *obj =</div>
<div class="line"><span class="lineno">  661</span>      m_xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#a13d9b9c08ca8dde39769f5644e046ee5">getStageObject</a>(TStageObjectId::ColumnId(pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a>));</div>
<div class="line"><span class="lineno">  662</span>  <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> parentId(obj-&gt;<a class="code hl_function" href="class_t_stage_object.html#afb4724a8cc2ef7eb2c6c7585834210f2">getParent</a>());</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>  <span class="keywordflow">if</span> (parentId.isColumn() &amp;&amp; obj-&gt;<a class="code hl_function" href="class_t_stage_object.html#a6025ddfaaae4ebe384894230d69f0b46">getParentHandle</a>()[0] != <span class="charliteral">&#39;H&#39;</span>) {</div>
<div class="line"><span class="lineno">  665</span>    <span class="keyword">const</span> <a class="code hl_class" href="class_t_smart_pointer_t.html">SkDP</a> &amp;sd =</div>
<div class="line"><span class="lineno">  666</span>        m_xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#a13d9b9c08ca8dde39769f5644e046ee5">getStageObject</a>(parentId)-&gt;<a class="code hl_function" href="class_t_stage_object.html#af2c5d9f172e73e4cb09b769700df3acb">getPlasticSkeletonDeformation</a>();</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>    <span class="keyword">const</span> <a class="code hl_class" href="class_t_xsh_cell.html">TXshCell</a> &amp;parentCell = m_xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#a1ae81edf03bc7527176c84478c350f57">getCell</a>(m_frame, parentId.getIndex());</div>
<div class="line"><span class="lineno">  669</span>    <a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *parentSl  = parentCell.<a class="code hl_function" href="class_t_xsh_cell.html#a8898cc47eba24e59477bfba8e2511f1d">getSimpleLevel</a>();</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>    <span class="keywordflow">if</span> (sd &amp;&amp; parentSl &amp;&amp; (parentSl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() == MESH_XSHLEVEL)) {</div>
<div class="line"><span class="lineno">  672</span>      <span class="comment">// Plastic Deformer case - add the corresponding fx,</span></div>
<div class="line"><span class="lineno">  673</span>      <span class="comment">// absorb the dpi and local column placement affines</span></div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>      <a class="code hl_class" href="class_plastic_deformer_fx.html">PlasticDeformerFx</a> *plasticFx = <span class="keyword">new</span> <a class="code hl_class" href="class_plastic_deformer_fx.html">PlasticDeformerFx</a>;</div>
<div class="line"><span class="lineno">  676</span>      plasticFx-&gt;<a class="code hl_variable" href="class_plastic_deformer_fx.html#aa0d443233d404b44a7e63852a169ebc3">m_xsh</a>             = m_xsh;</div>
<div class="line"><span class="lineno">  677</span>      plasticFx-&gt;<a class="code hl_variable" href="class_plastic_deformer_fx.html#a33941c5b65ba7bbc34e7bb883fae1789">m_col</a>             = parentId.getIndex();</div>
<div class="line"><span class="lineno">  678</span>      plasticFx-&gt;<a class="code hl_variable" href="class_plastic_deformer_fx.html#a941793d2367b5fbf9a47edb906d4e49f">m_texPlacement</a>    = obj-&gt;<a class="code hl_function" href="class_t_stage_object.html#a37868110f695275d9e2027fb47870515">getLocalPlacement</a>(m_frame);</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span>      <span class="keywordflow">if</span> (!plasticFx-&gt;<a class="code hl_function" href="class_t_fx.html#a2f3083c0f21b5a3579b7124db70c06a7">connect</a>(<span class="stringliteral">&quot;source&quot;</span>, pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>.getPointer()))</div>
<div class="line"><span class="lineno">  681</span>        assert(!<span class="stringliteral">&quot;Could not connect ports!&quot;</span>);</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>      pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>  = plasticFx;</div>
<div class="line"><span class="lineno">  684</span>      pf.m_aff = pf.m_aff * plasticFx-&gt;<a class="code hl_variable" href="class_plastic_deformer_fx.html#a941793d2367b5fbf9a47edb906d4e49f">m_texPlacement</a>.<a class="code hl_function" href="class_t_affine.html#a570529b96b1ec5abc711aaa9aac09ff9">inv</a>();</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  687</span>    }</div>
<div class="line"><span class="lineno">  688</span>  }</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  691</span>}</div>
<div class="ttc" id="aclass_placed_fx_html_aab44f6db03fdb9520b8af551c73c26ea"><div class="ttname"><a href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">PlacedFx::m_columnIndex</a></div><div class="ttdeci">int m_columnIndex</div><div class="ttdoc">This fx's column index.</div><div class="ttdef"><b>Definition:</b> scenefx.cpp:243</div></div>
<div class="ttc" id="aclass_placed_fx_html_af8263bb84b35a0b77d078b6025f96546"><div class="ttname"><a href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">PlacedFx::m_fx</a></div><div class="ttdeci">TFxP m_fx</div><div class="ttdoc">The referenced fx.</div><div class="ttdef"><b>Definition:</b> scenefx.cpp:246</div></div>
<div class="ttc" id="aclass_plastic_deformer_fx_html"><div class="ttname"><a href="class_plastic_deformer_fx.html">PlasticDeformerFx</a></div><div class="ttdef"><b>Definition:</b> plasticdeformerfx.h:28</div></div>
<div class="ttc" id="aclass_plastic_deformer_fx_html_a33941c5b65ba7bbc34e7bb883fae1789"><div class="ttname"><a href="class_plastic_deformer_fx.html#a33941c5b65ba7bbc34e7bb883fae1789">PlasticDeformerFx::m_col</a></div><div class="ttdeci">int m_col</div><div class="ttdoc">The input column index.</div><div class="ttdef"><b>Definition:</b> plasticdeformerfx.h:35</div></div>
<div class="ttc" id="aclass_plastic_deformer_fx_html_a941793d2367b5fbf9a47edb906d4e49f"><div class="ttname"><a href="class_plastic_deformer_fx.html#a941793d2367b5fbf9a47edb906d4e49f">PlasticDeformerFx::m_texPlacement</a></div><div class="ttdeci">TAffine m_texPlacement</div><div class="ttdoc">Texture to mesh reference transform.</div><div class="ttdef"><b>Definition:</b> plasticdeformerfx.h:36</div></div>
<div class="ttc" id="aclass_plastic_deformer_fx_html_aa0d443233d404b44a7e63852a169ebc3"><div class="ttname"><a href="class_plastic_deformer_fx.html#aa0d443233d404b44a7e63852a169ebc3">PlasticDeformerFx::m_xsh</a></div><div class="ttdeci">TXsheet * m_xsh</div><div class="ttdoc">The Fx's enclosing Xsheet.</div><div class="ttdef"><b>Definition:</b> plasticdeformerfx.h:34</div></div>
<div class="ttc" id="aclass_t_affine_html_a570529b96b1ec5abc711aaa9aac09ff9"><div class="ttname"><a href="class_t_affine.html#a570529b96b1ec5abc711aaa9aac09ff9">TAffine::inv</a></div><div class="ttdeci">TAffine inv() const</div><div class="ttdef"><b>Definition:</b> tgeometry.cpp:55</div></div>
<div class="ttc" id="aclass_t_fx_html_a2f3083c0f21b5a3579b7124db70c06a7"><div class="ttname"><a href="class_t_fx.html#a2f3083c0f21b5a3579b7124db70c06a7">TFx::connect</a></div><div class="ttdeci">bool connect(const std::string &amp;name, TFx *other)</div><div class="ttdoc">Equivalent to getInputPort(name)-&gt;setFx(other).</div><div class="ttdef"><b>Definition:</b> tfx.cpp:534</div></div>
<div class="ttc" id="aclass_t_smart_pointer_t_html"><div class="ttname"><a href="class_t_smart_pointer_t.html">TSmartPointerT&lt; PlasticSkeletonDeformation &gt;</a></div></div>
<div class="ttc" id="aclass_t_stage_object_html_a37868110f695275d9e2027fb47870515"><div class="ttname"><a href="class_t_stage_object.html#a37868110f695275d9e2027fb47870515">TStageObject::getLocalPlacement</a></div><div class="ttdeci">TAffine getLocalPlacement(double frame)</div><div class="ttdef"><b>Definition:</b> tstageobject.h:413</div></div>
<div class="ttc" id="aclass_t_stage_object_html_a6025ddfaaae4ebe384894230d69f0b46"><div class="ttname"><a href="class_t_stage_object.html#a6025ddfaaae4ebe384894230d69f0b46">TStageObject::getParentHandle</a></div><div class="ttdeci">const std::string &amp; getParentHandle() const</div><div class="ttdef"><b>Definition:</b> tstageobject.h:277</div></div>
<div class="ttc" id="aclass_t_stage_object_html_af2c5d9f172e73e4cb09b769700df3acb"><div class="ttname"><a href="class_t_stage_object.html#af2c5d9f172e73e4cb09b769700df3acb">TStageObject::getPlasticSkeletonDeformation</a></div><div class="ttdeci">PlasticSkeletonDeformationP getPlasticSkeletonDeformation() const</div><div class="ttdoc">Returns the stored skeleton deformation, if any.</div><div class="ttdef"><b>Definition:</b> tstageobject.cpp:1144</div></div>
<div class="ttc" id="aclass_t_stage_object_html_afb4724a8cc2ef7eb2c6c7585834210f2"><div class="ttname"><a href="class_t_stage_object.html#afb4724a8cc2ef7eb2c6c7585834210f2">TStageObject::getParent</a></div><div class="ttdeci">TStageObjectId getParent() const</div><div class="ttdef"><b>Definition:</b> tstageobject.cpp:632</div></div>
<div class="ttc" id="aclass_t_xsh_cell_html"><div class="ttname"><a href="class_t_xsh_cell.html">TXshCell</a></div><div class="ttdef"><b>Definition:</b> txshcell.h:35</div></div>
<div class="ttc" id="aclass_t_xsh_cell_html_a8898cc47eba24e59477bfba8e2511f1d"><div class="ttname"><a href="class_t_xsh_cell.html#a8898cc47eba24e59477bfba8e2511f1d">TXshCell::getSimpleLevel</a></div><div class="ttdeci">TXshSimpleLevel * getSimpleLevel() const</div><div class="ttdef"><b>Definition:</b> txshcell.cpp:19</div></div>
<div class="ttc" id="aclass_t_xsh_level_html_a1a147f1e970a62120c0bbaf0020a8932"><div class="ttname"><a href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">TXshLevel::getType</a></div><div class="ttdeci">int getType() const</div><div class="ttdef"><b>Definition:</b> txshlevel.h:81</div></div>
<div class="ttc" id="aclass_t_xsh_simple_level_html"><div class="ttname"><a href="class_t_xsh_simple_level.html">TXshSimpleLevel</a></div><div class="ttdoc">The TXshLevel specialization for image levels.</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.h:60</div></div>
<div class="ttc" id="aclass_t_xsheet_html_a1ae81edf03bc7527176c84478c350f57"><div class="ttname"><a href="class_t_xsheet.html#a1ae81edf03bc7527176c84478c350f57">TXsheet::getCell</a></div><div class="ttdeci">const TXshCell &amp; getCell(int row, int col) const</div><div class="ttdef"><b>Definition:</b> txsheet.cpp:233</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb1d1d5091403098a59b18343630d5cb" name="acb1d1d5091403098a59b18343630d5cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb1d1d5091403098a59b18343630d5cb">&#9670;&nbsp;</a></span>buildFx() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_smart_pointer_t.html">TFxP</a> FxBuilder::buildFx </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  608</span>                        {</div>
<div class="line"><span class="lineno">  609</span>  <a class="code hl_class" href="class_t_fx.html">TFx</a> *outputFx = m_xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#adc7c74cce346abf3699bb250eb17a9c2">getFxDag</a>()-&gt;getOutputFx(0);</div>
<div class="line"><span class="lineno">  610</span>  <span class="keywordflow">if</span> (!outputFx || outputFx-&gt;getInputPortCount() != 1 ||</div>
<div class="line"><span class="lineno">  611</span>      outputFx-&gt;getInputPort(0)-&gt;getFx() == 0)</div>
<div class="line"><span class="lineno">  612</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a>();</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>  outputFx-&gt;setName(L<span class="stringliteral">&quot;OutputFx&quot;</span>);</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>  assert(m_particleDescendentCount == 0);</div>
<div class="line"><span class="lineno">  617</span>  <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> pf = <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(outputFx-&gt;getInputPort(0)-&gt;getFx());</div>
<div class="line"><span class="lineno">  618</span>  assert(m_particleDescendentCount == 0);</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>  <a class="code hl_class" href="class_t_affine.html">TAffine</a> cameraFullAff = m_cameraAff * <a class="code hl_class" href="class_t_scale.html">TScale</a>((1000 + m_cameraZ) / 1000);</div>
<div class="line"><span class="lineno">  621</span>  <span class="keywordflow">return</span> TFxUtil::makeAffine(pf.makeFx(), cameraFullAff.<a class="code hl_function" href="class_t_affine.html#a570529b96b1ec5abc711aaa9aac09ff9">inv</a>());</div>
<div class="line"><span class="lineno">  622</span>}</div>
<div class="ttc" id="aclass_fx_builder_html_af4024bf49b3f6b19ba3fe964807f5741"><div class="ttname"><a href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">FxBuilder::makePF</a></div><div class="ttdeci">PlacedFx makePF(TLevelColumnFx *fx)</div><div class="ttdoc">Creates and returns a PlacedFx for a TLevelColumnFx.</div><div class="ttdef"><b>Definition:</b> scenefx.cpp:787</div></div>
<div class="ttc" id="aclass_placed_fx_html"><div class="ttname"><a href="class_placed_fx.html">PlacedFx</a></div><div class="ttdoc">PlacedFx is the enriched form of a TRasterFx during render-tree building.</div><div class="ttdef"><b>Definition:</b> scenefx.cpp:239</div></div>
<div class="ttc" id="aclass_t_affine_html"><div class="ttname"><a href="class_t_affine.html">TAffine</a></div><div class="ttdoc">This is the base class for the affine transformations.</div><div class="ttdef"><b>Definition:</b> tgeometry.h:864</div></div>
<div class="ttc" id="aclass_t_fx_html"><div class="ttname"><a href="class_t_fx.html">TFx</a></div><div class="ttdef"><b>Definition:</b> tfx.h:352</div></div>
<div class="ttc" id="aclass_t_scale_html"><div class="ttname"><a href="class_t_scale.html">TScale</a></div><div class="ttdef"><b>Definition:</b> tgeometry.h:1133</div></div>
<div class="ttc" id="aclass_t_xsheet_html_adc7c74cce346abf3699bb250eb17a9c2"><div class="ttname"><a href="class_t_xsheet.html#adc7c74cce346abf3699bb250eb17a9c2">TXsheet::getFxDag</a></div><div class="ttdeci">FxDag * getFxDag() const</div><div class="ttdef"><b>Definition:</b> txsheet.cpp:1564</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6a20f86015205c3f4c3172f04cb3563" name="ac6a20f86015205c3f4c3172f04cb3563"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6a20f86015205c3f4c3172f04cb3563">&#9670;&nbsp;</a></span>buildFx() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_smart_pointer_t.html">TFxP</a> FxBuilder::buildFx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_smart_pointer_t.html">TFxP</a> &amp;&#160;</td>
          <td class="paramname"><em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BSFX_Transforms_Enum&#160;</td>
          <td class="paramname"><em>transforms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  626</span>                                                                         {</div>
<div class="line"><span class="lineno">  627</span>  assert(m_particleDescendentCount == 0);</div>
<div class="line"><span class="lineno">  628</span>  <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> pf = <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(root.getPointer());</div>
<div class="line"><span class="lineno">  629</span>  assert(m_particleDescendentCount == 0);</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> fx = (transforms &amp; BSFX_COLUMN_TR) ? pf.makeFx() : pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>;</div>
<div class="line"><span class="lineno">  632</span>  <span class="keywordflow">if</span> (transforms &amp; BSFX_CAMERA_TR) {</div>
<div class="line"><span class="lineno">  633</span>    <a class="code hl_class" href="class_t_affine.html">TAffine</a> cameraFullAff = m_cameraAff * <a class="code hl_class" href="class_t_scale.html">TScale</a>((1000 + m_cameraZ) / 1000);</div>
<div class="line"><span class="lineno">  634</span>    fx                    = TFxUtil::makeAffine(fx, cameraFullAff.<a class="code hl_function" href="class_t_affine.html#a570529b96b1ec5abc711aaa9aac09ff9">inv</a>());</div>
<div class="line"><span class="lineno">  635</span>  }</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>  <span class="keywordflow">return</span> fx;</div>
<div class="line"><span class="lineno">  638</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a48745e61176afd14b1061c85ac90deef" name="a48745e61176afd14b1061c85ac90deef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48745e61176afd14b1061c85ac90deef">&#9670;&nbsp;</a></span>getFxWithColumnMovements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_smart_pointer_t.html">TFxP</a> FxBuilder::getFxWithColumnMovements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_placed_fx.html">PlacedFx</a> &amp;&#160;</td>
          <td class="paramname"><em>pf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  642</span>                                                           {</div>
<div class="line"><span class="lineno">  643</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> fx = pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>;</div>
<div class="line"><span class="lineno">  644</span>  <span class="keywordflow">if</span> (!fx) <span class="keywordflow">return</span> fx;</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>  <span class="keywordflow">if</span> (pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a> == -1) <span class="keywordflow">return</span> pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>;</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>  <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> <span class="keywordtype">id</span>    = TStageObjectId::ColumnId(pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a>);</div>
<div class="line"><span class="lineno">  649</span>  <a class="code hl_class" href="class_t_stage_object.html">TStageObject</a> *pegbar = m_xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#a13d9b9c08ca8dde39769f5644e046ee5">getStageObject</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>  <a class="code hl_class" href="class_affine_fx.html">AffineFx</a> *affFx = <span class="keyword">new</span> <a class="code hl_class" href="class_affine_fx.html">AffineFx</a>(m_xsh, pegbar);</div>
<div class="line"><span class="lineno">  652</span>  affFx-&gt;getInputPort(0)-&gt;setFx(fx.getPointer());</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>  <span class="keywordflow">return</span> affFx;</div>
<div class="line"><span class="lineno">  655</span>}</div>
<div class="ttc" id="aclass_affine_fx_html"><div class="ttname"><a href="class_affine_fx.html">AffineFx</a></div><div class="ttdef"><b>Definition:</b> scenefx.cpp:166</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a105b12f0f084a99b7f9c07720b1abad1" name="a105b12f0f084a99b7f9c07720b1abad1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a105b12f0f084a99b7f9c07720b1abad1">&#9670;&nbsp;</a></span>makePF() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_placed_fx.html">PlacedFx</a> FxBuilder::makePF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_fx.html">TFx</a> *&#160;</td>
          <td class="paramname"><em>fx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  695</span>                                  {</div>
<div class="line"><span class="lineno">  696</span>  <span class="keywordflow">if</span> (!fx) <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_level_column_fx.html">TLevelColumnFx</a> *lcfx = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_level_column_fx.html">TLevelColumnFx</a> *<span class="keyword">&gt;</span>(fx))</div>
<div class="line"><span class="lineno">  699</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(lcfx);</div>
<div class="line"><span class="lineno">  700</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_palette_column_fx.html">TPaletteColumnFx</a> *pcfx = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_palette_column_fx.html">TPaletteColumnFx</a> *<span class="keyword">&gt;</span>(fx))</div>
<div class="line"><span class="lineno">  701</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(pcfx);</div>
<div class="line"><span class="lineno">  702</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_zerary_column_fx.html">TZeraryColumnFx</a> *zcfx = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_zerary_column_fx.html">TZeraryColumnFx</a> *<span class="keyword">&gt;</span>(fx))</div>
<div class="line"><span class="lineno">  703</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(zcfx);</div>
<div class="line"><span class="lineno">  704</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_xsheet_fx.html">TXsheetFx</a> *xsfx = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_xsheet_fx.html">TXsheetFx</a> *<span class="keyword">&gt;</span>(fx))</div>
<div class="line"><span class="lineno">  705</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(xsfx);</div>
<div class="line"><span class="lineno">  706</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fx-&gt;getInputPortCount() == 1)</div>
<div class="line"><span class="lineno">  707</span>    <span class="keywordflow">return</span> makePFfromUnaryFx(fx);</div>
<div class="line"><span class="lineno">  708</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  709</span>    <span class="keywordflow">return</span> makePFfromGenericFx(fx);</div>
<div class="line"><span class="lineno">  710</span>}</div>
<div class="ttc" id="aclass_t_level_column_fx_html"><div class="ttname"><a href="class_t_level_column_fx.html">TLevelColumnFx</a></div><div class="ttdef"><b>Definition:</b> tcolumnfx.h:62</div></div>
<div class="ttc" id="aclass_t_palette_column_fx_html"><div class="ttname"><a href="class_t_palette_column_fx.html">TPaletteColumnFx</a></div><div class="ttdef"><b>Definition:</b> tcolumnfx.h:130</div></div>
<div class="ttc" id="aclass_t_xsheet_fx_html"><div class="ttname"><a href="class_t_xsheet_fx.html">TXsheetFx</a></div><div class="ttdef"><b>Definition:</b> tcolumnfx.h:223</div></div>
<div class="ttc" id="aclass_t_zerary_column_fx_html"><div class="ttname"><a href="class_t_zerary_column_fx.html">TZeraryColumnFx</a></div><div class="ttdef"><b>Definition:</b> tcolumnfx.h:176</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af4024bf49b3f6b19ba3fe964807f5741" name="af4024bf49b3f6b19ba3fe964807f5741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4024bf49b3f6b19ba3fe964807f5741">&#9670;&nbsp;</a></span>makePF() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_placed_fx.html">PlacedFx</a> FxBuilder::makePF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_level_column_fx.html">TLevelColumnFx</a> *&#160;</td>
          <td class="paramname"><em>fx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and returns a <a class="el" href="class_placed_fx.html" title="PlacedFx is the enriched form of a TRasterFx during render-tree building.">PlacedFx</a> for a <a class="el" href="class_t_level_column_fx.html">TLevelColumnFx</a>. </p>
<div class="fragment"><div class="line"><span class="lineno">  787</span>                                               {</div>
<div class="line"><span class="lineno">  788</span>  assert(m_scene);</div>
<div class="line"><span class="lineno">  789</span>  assert(lcfx);</div>
<div class="line"><span class="lineno">  790</span>  assert(lcfx-&gt;getColumn());</div>
<div class="line"><span class="lineno">  791</span>  <span class="keywordflow">if</span> (!lcfx || !lcfx-&gt;getColumn() || lcfx-&gt;getColumn()-&gt;isEmpty())</div>
<div class="line"><span class="lineno">  792</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno">  793</span> </div>
<div class="line"><span class="lineno">  794</span>  <span class="keywordflow">if</span> (!lcfx-&gt;getColumn()-&gt;isPreviewVisible())  <span class="comment">// This is the &#39;eye&#39; icon</span></div>
<div class="line"><span class="lineno">  795</span>                                               <span class="comment">// property in the column header</span></div>
<div class="line"><span class="lineno">  796</span>                                               <span class="comment">// interface</span></div>
<div class="line"><span class="lineno">  797</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();  <span class="comment">// that disables rendering of this particular column</span></div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span>  <span class="comment">// Retrieve the corresponding xsheet cell to build up</span></div>
<div class="line"><span class="lineno">  800</span>  <span class="comment">/*--  --*/</span></div>
<div class="line"><span class="lineno">  801</span>  <a class="code hl_class" href="class_t_xsh_cell.html">TXshCell</a> cell  = lcfx-&gt;getColumn()-&gt;getCell(tfloor(m_frame));</div>
<div class="line"><span class="lineno">  802</span>  <span class="keywordtype">int</span> levelFrame = cell.m_frameId.getNumber() - 1;</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>  <span class="comment">/*--  ParticlesFx  --*/</span></div>
<div class="line"><span class="lineno">  805</span>  <span class="comment">// -&gt; even if the cell is empty, pass the affine infotmation of the column to</span></div>
<div class="line"><span class="lineno">  806</span>  <span class="comment">// the subsequent nodes</span></div>
<div class="line"><span class="lineno">  807</span>  <span class="comment">// if (m_particleDescendentCount == 0 &amp;&amp; cell.isEmpty()) return PlacedFx();</span></div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>  <span class="keywordflow">if</span> (m_whichLevels == TOutputProperties::AnimatedOnly) {</div>
<div class="line"><span class="lineno">  810</span>    <span class="comment">// In case only &#39;animated levels&#39; are selected to be rendered, exclude all</span></div>
<div class="line"><span class="lineno">  811</span>    <span class="comment">// &#39;backgrounds&#39; - that is,</span></div>
<div class="line"><span class="lineno">  812</span>    <span class="comment">// fullcolor levels...</span></div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>    <span class="comment">// Still, I wonder if this is still used in Toonz. I don&#39;t remember seeing</span></div>
<div class="line"><span class="lineno">  815</span>    <span class="comment">// it anywhere :\ ?</span></div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>    <a class="code hl_class" href="class_t_xsh_level.html">TXshLevel</a> *xl = cell.m_level.getPointer();</div>
<div class="line"><span class="lineno">  818</span>    <span class="comment">// if the cell is empty, use a level of the first occupied cell instead.</span></div>
<div class="line"><span class="lineno">  819</span>    <span class="keywordflow">if</span> (!xl) {</div>
<div class="line"><span class="lineno">  820</span>      <span class="keywordtype">int</span> r0, r1;</div>
<div class="line"><span class="lineno">  821</span>      <span class="keywordflow">if</span> (lcfx-&gt;getColumn()-&gt;getRange(r0, r1) &gt; 0)</div>
<div class="line"><span class="lineno">  822</span>        xl = lcfx-&gt;getColumn()-&gt;getCell(r0).m_level.getPointer();</div>
<div class="line"><span class="lineno">  823</span>    }</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>    <span class="comment">/*-- ParticleFxTexture --*/</span></div>
<div class="line"><span class="lineno">  826</span>    <span class="keywordflow">if</span> (m_particleDescendentCount == 0) {</div>
<div class="line"><span class="lineno">  827</span>      <span class="keywordflow">if</span> (!xl ||</div>
<div class="line"><span class="lineno">  828</span>          (xl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() != PLI_XSHLEVEL &amp;&amp; xl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() != TZP_XSHLEVEL &amp;&amp;</div>
<div class="line"><span class="lineno">  829</span>           xl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() != CHILD_XSHLEVEL))</div>
<div class="line"><span class="lineno">  830</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno">  831</span>    }</div>
<div class="line"><span class="lineno">  832</span>    <span class="comment">/*-- ParticleFxTexture --*/</span></div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  834</span>      <span class="keywordflow">if</span> (xl &amp;&amp; xl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() != PLI_XSHLEVEL &amp;&amp;</div>
<div class="line"><span class="lineno">  835</span>          xl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() != TZP_XSHLEVEL &amp;&amp; xl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() != CHILD_XSHLEVEL)</div>
<div class="line"><span class="lineno">  836</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno">  837</span>    }</div>
<div class="line"><span class="lineno">  838</span>  }</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>  <span class="comment">// Build a PlacedFx for the column - start with the standard version for</span></div>
<div class="line"><span class="lineno">  841</span>  <span class="comment">// common (image) levels</span></div>
<div class="line"><span class="lineno">  842</span>  <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> pf;</div>
<div class="line"><span class="lineno">  843</span>  pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a> = lcfx-&gt;getColumn()-&gt;getIndex();</div>
<div class="line"><span class="lineno">  844</span>  <span class="comment">// Build column placement</span></div>
<div class="line"><span class="lineno">  845</span>  <span class="keywordtype">bool</span> columnVisible =</div>
<div class="line"><span class="lineno">  846</span>      getColumnPlacement(pf, m_xsh, m_frame, pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a>, m_isPreview);</div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span>  <span class="comment">// if the cell is empty, only inherits its placement</span></div>
<div class="line"><span class="lineno">  849</span>  <span class="keywordflow">if</span> ((m_particleDescendentCount == 0 &amp;&amp; cell.<a class="code hl_function" href="class_t_xsh_cell.html#a5d20229e7bcd19957b123959e58a833e">isEmpty</a>())) <span class="keywordflow">return</span> pf;</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>  pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a> = lcfx;</div>
<div class="line"><span class="lineno">  852</span> </div>
<div class="line"><span class="lineno">  853</span>  <span class="comment">/*-- subXsheetBuildFx --*/</span></div>
<div class="line"><span class="lineno">  854</span>  <span class="keywordflow">if</span> (!cell.<a class="code hl_function" href="class_t_xsh_cell.html#a5d20229e7bcd19957b123959e58a833e">isEmpty</a>() &amp;&amp; cell.m_level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a6ef7d48e41f4f214b414e959512e6377">getChildLevel</a>()) {</div>
<div class="line"><span class="lineno">  855</span>    <span class="comment">// Treat the sub-xsheet case - build the sub-render-tree and reassign stuff</span></div>
<div class="line"><span class="lineno">  856</span>    <span class="comment">// to pf</span></div>
<div class="line"><span class="lineno">  857</span>    <a class="code hl_class" href="class_t_xsheet.html">TXsheet</a> *xsh = cell.m_level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a6ef7d48e41f4f214b414e959512e6377">getChildLevel</a>()-&gt;<a class="code hl_function" href="class_t_xsh_child_level.html#ad2676276ae1db83a898a3eef10e0ace8">getXsheet</a>();</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>    <span class="comment">// Build the sub-render-tree</span></div>
<div class="line"><span class="lineno">  860</span>    <a class="code hl_class" href="class_fx_builder.html">FxBuilder</a> builder(m_scene, xsh, levelFrame, m_whichLevels, m_isPreview);</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>    <span class="comment">// Then, add the TimeShuffleFx</span></div>
<div class="line"><span class="lineno">  863</span>    pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a> = timeShuffle(builder.buildFx(), levelFrame, lcfx-&gt;getTimeRegion(),</div>
<div class="line"><span class="lineno">  864</span>                          lcfx-&gt;getColumn());</div>
<div class="line"><span class="lineno">  865</span>    pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;setIdentifier(lcfx-&gt;getIdentifier());</div>
<div class="line"><span class="lineno">  866</span>    pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;getAttributes()-&gt;passiveCacheDataIdx() =</div>
<div class="line"><span class="lineno">  867</span>        lcfx-&gt;getAttributes()-&gt;passiveCacheDataIdx();</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>    <span class="comment">// If the level should sustain a Plastic deformation, add the corresponding</span></div>
<div class="line"><span class="lineno">  870</span>    <span class="comment">// fx</span></div>
<div class="line"><span class="lineno">  871</span>    addPlasticDeformerFx(pf);</div>
<div class="line"><span class="lineno">  872</span>  }</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>  <span class="keywordflow">if</span> (columnVisible) {</div>
<div class="line"><span class="lineno">  875</span>    <span class="comment">// Column is visible, alright</span></div>
<div class="line"><span class="lineno">  876</span>    <a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *sl = cell.<a class="code hl_function" href="class_t_xsh_cell.html#a5d20229e7bcd19957b123959e58a833e">isEmpty</a>() ? 0 : cell.m_level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a023065559cff76164ecb6344c586ba27">getSimpleLevel</a>();</div>
<div class="line"><span class="lineno">  877</span>    <span class="keywordflow">if</span> (sl) {</div>
<div class="line"><span class="lineno">  878</span>      <span class="comment">// If the level should sustain a Plastic deformation, add the</span></div>
<div class="line"><span class="lineno">  879</span>      <span class="comment">// corresponding fx</span></div>
<div class="line"><span class="lineno">  880</span>      <span class="keywordflow">if</span> (!addPlasticDeformerFx(pf)) {</div>
<div class="line"><span class="lineno">  881</span>        <span class="comment">// Common (image) level case - add an NaAffineFx to compensate for the</span></div>
<div class="line"><span class="lineno">  882</span>        <span class="comment">// image&#39;s dpi</span></div>
<div class="line"><span class="lineno">  883</span>        <a class="code hl_class" href="class_t_affine.html">TAffine</a> dpiAff = ::getDpiAffine(</div>
<div class="line"><span class="lineno">  884</span>            sl, cell.m_frameId, <span class="keyword">true</span>);  <span class="comment">// true stands for &#39;force full-sampling&#39;</span></div>
<div class="line"><span class="lineno">  885</span>        pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a> = TFxUtil::makeAffine(pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>, dpiAff);</div>
<div class="line"><span class="lineno">  886</span>        <span class="keywordflow">if</span> (pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>) pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;setName(L<span class="stringliteral">&quot;LevelColumn AffineFx&quot;</span>);</div>
<div class="line"><span class="lineno">  887</span>      }</div>
<div class="line"><span class="lineno">  888</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  889</span>      <span class="comment">// Okay, weird code ensues. This is what happens on non-common image</span></div>
<div class="line"><span class="lineno">  890</span>      <span class="comment">// cases, which should be:</span></div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>      <span class="comment">//  1. Sub-Xsheet cases - and it really shouldn&#39;t</span></div>
<div class="line"><span class="lineno">  893</span>      <span class="comment">//  2. Empty cell cases - with m_particles_blabla &gt; 0; and again I don&#39;t</span></div>
<div class="line"><span class="lineno">  894</span>      <span class="comment">//  get why on earth this should happen...</span></div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span>      <span class="comment">// Please, note that (1) is a bug, although it happens when inserting a</span></div>
<div class="line"><span class="lineno">  897</span>      <span class="comment">// common level and a sub-xsh</span></div>
<div class="line"><span class="lineno">  898</span>      <span class="comment">// level in the same column...</span></div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>      <span class="comment">// when a cell not exists, there is no way to keep the dpi of the image!</span></div>
<div class="line"><span class="lineno">  901</span>      <span class="comment">// in this case it is kept the dpi of the first cell not empty in the</span></div>
<div class="line"><span class="lineno">  902</span>      <span class="comment">// column!</span></div>
<div class="line"><span class="lineno">  903</span>      <span class="comment">/*--</span></div>
<div class="line"><span class="lineno">  904</span><span class="comment">       * Dpi</span></div>
<div class="line"><span class="lineno">  905</span><span class="comment">       * --*/</span></div>
<div class="line"><span class="lineno">  906</span>      <a class="code hl_class" href="class_t_xsh_level_column.html">TXshLevelColumn</a> *column = lcfx-&gt;getColumn();</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>      <span class="keywordtype">int</span> r0, r1;</div>
<div class="line"><span class="lineno">  909</span>      <span class="keywordflow">if</span> (column-&gt;getRange(r0, r1) &gt; 0)</div>
<div class="line"><span class="lineno">  910</span>        sl = column-&gt;getCell(r0).m_level-&gt;getSimpleLevel();</div>
<div class="line"><span class="lineno">  911</span>      <span class="keywordflow">if</span> (sl) {</div>
<div class="line"><span class="lineno">  912</span>        <a class="code hl_class" href="class_t_affine.html">TAffine</a> dpiAff =</div>
<div class="line"><span class="lineno">  913</span>            ::getDpiAffine(sl, column-&gt;getCell(r0).m_frameId, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  914</span>        pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a> = TFxUtil::makeAffine(pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>, dpiAff);</div>
<div class="line"><span class="lineno">  915</span>      }</div>
<div class="line"><span class="lineno">  916</span>    }</div>
<div class="line"><span class="lineno">  917</span> </div>
<div class="line"><span class="lineno">  918</span>    <span class="comment">// Apply column&#39;s color filter and semi-transparency for rendering</span></div>
<div class="line"><span class="lineno">  919</span>    <a class="code hl_class" href="class_t_xsh_level_column.html">TXshLevelColumn</a> *column = lcfx-&gt;getColumn();</div>
<div class="line"><span class="lineno">  920</span>    <span class="keywordflow">if</span> (m_scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a8ef96fedc17d7def810ac419b0939254">getProperties</a>()-&gt;isColumnColorFilterOnRenderEnabled() &amp;&amp;</div>
<div class="line"><span class="lineno">  921</span>        (column-&gt;getFilterColorId() != TXshColumn::FilterNone ||</div>
<div class="line"><span class="lineno">  922</span>         (column-&gt;isCamstandVisible() &amp;&amp; column-&gt;getOpacity() != 255))) {</div>
<div class="line"><span class="lineno">  923</span>      TPixel32 colorScale = column-&gt;getFilterColor();</div>
<div class="line"><span class="lineno">  924</span>      colorScale.m        = column-&gt;getOpacity();</div>
<div class="line"><span class="lineno">  925</span>      pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>             = TFxUtil::makeColumnColorFilter(pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>, colorScale);</div>
<div class="line"><span class="lineno">  926</span>    }</div>
<div class="line"><span class="lineno">  927</span> </div>
<div class="line"><span class="lineno">  928</span>    <span class="keywordflow">return</span> pf;</div>
<div class="line"><span class="lineno">  929</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  930</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno">  931</span>}</div>
<div class="ttc" id="aclass_fx_builder_html"><div class="ttname"><a href="class_fx_builder.html">FxBuilder</a></div><div class="ttdef"><b>Definition:</b> fxbrowser.h:26</div></div>
<div class="ttc" id="aclass_t_xsh_cell_html_a5d20229e7bcd19957b123959e58a833e"><div class="ttname"><a href="class_t_xsh_cell.html#a5d20229e7bcd19957b123959e58a833e">TXshCell::isEmpty</a></div><div class="ttdeci">bool isEmpty() const</div><div class="ttdef"><b>Definition:</b> txshcell.h:78</div></div>
<div class="ttc" id="aclass_t_xsh_child_level_html_ad2676276ae1db83a898a3eef10e0ace8"><div class="ttname"><a href="class_t_xsh_child_level.html#ad2676276ae1db83a898a3eef10e0ace8">TXshChildLevel::getXsheet</a></div><div class="ttdeci">TXsheet * getXsheet()</div><div class="ttdef"><b>Definition:</b> txshchildlevel.h:65</div></div>
<div class="ttc" id="aclass_t_xsh_level_column_html"><div class="ttname"><a href="class_t_xsh_level_column.html">TXshLevelColumn</a></div><div class="ttdef"><b>Definition:</b> txshlevelcolumn.h:37</div></div>
<div class="ttc" id="aclass_t_xsh_level_html"><div class="ttname"><a href="class_t_xsh_level.html">TXshLevel</a></div><div class="ttdoc">The TXshLevel class is the base class of level managers in xsheet.</div><div class="ttdef"><b>Definition:</b> txshlevel.h:50</div></div>
<div class="ttc" id="aclass_t_xsh_level_html_a023065559cff76164ecb6344c586ba27"><div class="ttname"><a href="class_t_xsh_level.html#a023065559cff76164ecb6344c586ba27">TXshLevel::getSimpleLevel</a></div><div class="ttdeci">virtual TXshSimpleLevel * getSimpleLevel()</div><div class="ttdoc">Method (to be overridden in subclasses) to downcast to TXshSimpleLevel.</div><div class="ttdef"><b>Definition:</b> txshlevel.h:95</div></div>
<div class="ttc" id="aclass_t_xsh_level_html_a6ef7d48e41f4f214b414e959512e6377"><div class="ttname"><a href="class_t_xsh_level.html#a6ef7d48e41f4f214b414e959512e6377">TXshLevel::getChildLevel</a></div><div class="ttdeci">virtual TXshChildLevel * getChildLevel()</div><div class="ttdoc">Method (to be overridden in subclasses) to downcast to TXshChildLevel.</div><div class="ttdef"><b>Definition:</b> txshlevel.h:98</div></div>
<div class="ttc" id="aclass_t_xsheet_html"><div class="ttname"><a href="class_t_xsheet.html">TXsheet</a></div><div class="ttdef"><b>Definition:</b> txsheet.h:132</div></div>
<div class="ttc" id="aclass_toonz_scene_html_a8ef96fedc17d7def810ac419b0939254"><div class="ttname"><a href="class_toonz_scene.html#a8ef96fedc17d7def810ac419b0939254">ToonzScene::getProperties</a></div><div class="ttdeci">TSceneProperties * getProperties() const</div><div class="ttdoc">&lt; Returns a pointer to the scene's properties.</div><div class="ttdef"><b>Definition:</b> toonzscene.h:87</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00085">TXshCellColumn::getCell()</a>, <a class="el" href="#l00098">TXshLevel::getChildLevel()</a>, <a class="el" href="#l00087">ToonzScene::getProperties()</a>, <a class="el" href="#l00039">TXshCellColumn::getRange()</a>, <a class="el" href="#l00095">TXshLevel::getSimpleLevel()</a>, <a class="el" href="#l00081">TXshLevel::getType()</a>, <a class="el" href="#l00065">TXshChildLevel::getXsheet()</a>, <a class="el" href="#l00078">TXshCell::isEmpty()</a>, <a class="el" href="#l00343">TXshCellColumn::isEmpty()</a>, <a class="el" href="#l00641">TXshColumn::isPreviewVisible()</a>, <a class="el" href="#l00243">PlacedFx::m_columnIndex</a>, and <a class="el" href="#l00246">PlacedFx::m_fx</a>.</p>

</div>
</div>
<a id="a86621eb84b5875b07b55ea40ff1d3666" name="a86621eb84b5875b07b55ea40ff1d3666"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86621eb84b5875b07b55ea40ff1d3666">&#9670;&nbsp;</a></span>makePF() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_placed_fx.html">PlacedFx</a> FxBuilder::makePF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_palette_column_fx.html">TPaletteColumnFx</a> *&#160;</td>
          <td class="paramname"><em>fx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  935</span>                                                 {</div>
<div class="line"><span class="lineno">  936</span>  assert(pcfx);</div>
<div class="line"><span class="lineno">  937</span>  assert(pcfx-&gt;getColumn());</div>
<div class="line"><span class="lineno">  938</span>  <span class="keywordflow">if</span> (!pcfx-&gt;getColumn()-&gt;isPreviewVisible()) <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span>  <a class="code hl_class" href="class_t_xsh_cell.html">TXshCell</a> cell = pcfx-&gt;getColumn()-&gt;getCell(tfloor(m_frame));</div>
<div class="line"><span class="lineno">  941</span>  <span class="keywordflow">if</span> (cell.<a class="code hl_function" href="class_t_xsh_cell.html#a5d20229e7bcd19957b123959e58a833e">isEmpty</a>()) <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno">  942</span> </div>
<div class="line"><span class="lineno">  943</span>  <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> pf;</div>
<div class="line"><span class="lineno">  944</span>  pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a> = pcfx-&gt;getColumn()-&gt;getIndex();</div>
<div class="line"><span class="lineno">  945</span>  pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>          = pcfx;</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span>  <span class="keywordflow">return</span> pf;</div>
<div class="line"><span class="lineno">  948</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1308f052cb48063d9f09070aa3cb5011" name="a1308f052cb48063d9f09070aa3cb5011"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1308f052cb48063d9f09070aa3cb5011">&#9670;&nbsp;</a></span>makePF() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_placed_fx.html">PlacedFx</a> FxBuilder::makePF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_xsheet_fx.html">TXsheetFx</a> *&#160;</td>
          <td class="paramname"><em>fx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  714</span>                                        {</div>
<div class="line"><span class="lineno">  715</span>  <span class="keywordflow">if</span> (!m_expandXSheet)  <span class="comment">// Xsheet expansion is typically blocked for render-tree</span></div>
<div class="line"><span class="lineno">  716</span>                        <span class="comment">// building of post-xsheet fxs only.</span></div>
<div class="line"><span class="lineno">  717</span>  {</div>
<div class="line"><span class="lineno">  718</span>    <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> ret(fx);</div>
<div class="line"><span class="lineno">  719</span>    ret.m_isPostXsheetNode = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  720</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  721</span>  }</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>  <span class="comment">// Expand the render-tree from terminal fxs</span></div>
<div class="line"><span class="lineno">  724</span>  <a class="code hl_class" href="class_t_fx_set.html">TFxSet</a> *fxs = m_xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#adc7c74cce346abf3699bb250eb17a9c2">getFxDag</a>()-&gt;getTerminalFxs();</div>
<div class="line"><span class="lineno">  725</span>  <span class="keywordtype">int</span> m       = fxs-&gt;getFxCount();</div>
<div class="line"><span class="lineno">  726</span>  <span class="keywordflow">if</span> (m == 0) {</div>
<div class="line"><span class="lineno">  727</span>    <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> ret;</div>
<div class="line"><span class="lineno">  728</span>    ret.m_isPostXsheetNode = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  729</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  730</span>  }</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>  std::vector&lt;PlacedFx&gt; pfs(m);</div>
<div class="line"><span class="lineno">  733</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  734</span>  <span class="keywordflow">for</span> (i = 0; i &lt; m; i++) {</div>
<div class="line"><span class="lineno">  735</span>    <span class="comment">// Expand each terminal fx</span></div>
<div class="line"><span class="lineno">  736</span>    <a class="code hl_class" href="class_t_fx.html">TFx</a> *fx = fxs-&gt;getFx(i);</div>
<div class="line"><span class="lineno">  737</span>    assert(fx);</div>
<div class="line"><span class="lineno">  738</span>    pfs[i] = <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(fx);  <span class="comment">// Builds the sub-render-trees here</span></div>
<div class="line"><span class="lineno">  739</span>  }</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>  <span class="comment">/*--</span></div>
<div class="line"><span class="lineno">  742</span><span class="comment">   * XsheetPlacedFxOver</span></div>
<div class="line"><span class="lineno">  743</span><span class="comment">   * --*/</span></div>
<div class="line"><span class="lineno">  744</span>  std::sort(pfs.begin(),</div>
<div class="line"><span class="lineno">  745</span>            pfs.end());  <span class="comment">// Sort each terminal depending on Z/SO/Column index</span></div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>  <span class="comment">// Compose them in a cascade of overs (or affines &#39;leftXsheetPort&#39; cases)</span></div>
<div class="line"><span class="lineno">  748</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> currentFx =</div>
<div class="line"><span class="lineno">  749</span>      pfs[0].makeFx();  <span class="comment">// Adds an NaAffineFx if pf.m_aff is not the identity</span></div>
<div class="line"><span class="lineno">  750</span>  <span class="keywordflow">for</span> (i = 1; i &lt; m; i++) {</div>
<div class="line"><span class="lineno">  751</span>    <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> fx = pfs[i].makeFx();  <span class="comment">// See above</span></div>
<div class="line"><span class="lineno">  752</span>    <span class="keywordflow">if</span> (pfs[i].m_leftXsheetPort) {</div>
<div class="line"><span class="lineno">  753</span>      <span class="comment">// LeftXsheetPort cases happen for those fxs like Add, Multiply, etc that</span></div>
<div class="line"><span class="lineno">  754</span>      <span class="comment">// declare an xsheet-like input port.</span></div>
<div class="line"><span class="lineno">  755</span>      <span class="comment">// That is, all terminal fxs below ours are attached COMPOSED to enter the</span></div>
<div class="line"><span class="lineno">  756</span>      <span class="comment">// fx&#39;s leftXsheet input port.</span></div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>      <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> inputFx = currentFx;</div>
<div class="line"><span class="lineno">  759</span>      inputFx      = TFxUtil::makeAffine(inputFx, pfs[i].m_aff.inv());</div>
<div class="line"><span class="lineno">  760</span>      pfs[i].m_leftXsheetPort-&gt;setFx(inputFx.getPointer());</div>
<div class="line"><span class="lineno">  761</span>      currentFx = fx;</div>
<div class="line"><span class="lineno">  762</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  763</span>      <span class="keywordflow">if</span> (Preferences::instance()</div>
<div class="line"><span class="lineno">  764</span>              -&gt;isShowRasterImagesDarkenBlendedInViewerEnabled())</div>
<div class="line"><span class="lineno">  765</span>        currentFx = TFxUtil::makeDarken(currentFx, fx);</div>
<div class="line"><span class="lineno">  766</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  767</span>        currentFx = TFxUtil::makeOver(currentFx, fx);  <span class="comment">// Common over case</span></div>
<div class="line"><span class="lineno">  768</span>    }</div>
<div class="line"><span class="lineno">  769</span>  }</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>  <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> ret(currentFx);</div>
<div class="line"><span class="lineno">  772</span>  ret.m_isPostXsheetNode = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  773</span>  <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  774</span>}</div>
<div class="ttc" id="aclass_t_fx_set_html"><div class="ttname"><a href="class_t_fx_set.html">TFxSet</a></div><div class="ttdef"><b>Definition:</b> tcolumnfxset.h:27</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a667b5d262be3d9eaadcd9b07c963e042" name="a667b5d262be3d9eaadcd9b07c963e042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a667b5d262be3d9eaadcd9b07c963e042">&#9670;&nbsp;</a></span>makePF() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_placed_fx.html">PlacedFx</a> FxBuilder::makePF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_zerary_column_fx.html">TZeraryColumnFx</a> *&#160;</td>
          <td class="paramname"><em>fx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  952</span>                                                {</div>
<div class="line"><span class="lineno">  953</span>  assert(zcfx);</div>
<div class="line"><span class="lineno">  954</span>  assert(zcfx-&gt;getColumn());</div>
<div class="line"><span class="lineno">  955</span> </div>
<div class="line"><span class="lineno">  956</span>  <span class="keywordflow">if</span> (!zcfx-&gt;getColumn()-&gt;isPreviewVisible())  <span class="comment">// ...</span></div>
<div class="line"><span class="lineno">  957</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno">  958</span> </div>
<div class="line"><span class="lineno">  959</span>  <span class="keywordflow">if</span> (!zcfx-&gt;getAttributes()-&gt;isEnabled())  <span class="comment">// ...</span></div>
<div class="line"><span class="lineno">  960</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno">  961</span> </div>
<div class="line"><span class="lineno">  962</span>  <a class="code hl_class" href="class_t_fx.html">TFx</a> *fx = zcfx-&gt;getZeraryFx();</div>
<div class="line"><span class="lineno">  963</span>  <span class="keywordflow">if</span> (!fx || !fx-&gt;getAttributes()-&gt;isEnabled())  <span class="comment">// ... Perhaps these shouldn&#39;t</span></div>
<div class="line"><span class="lineno">  964</span>                                                 <span class="comment">// be tested altogether? Only 1</span></div>
<div class="line"><span class="lineno">  965</span>                                                 <span class="comment">// truly works !</span></div>
<div class="line"><span class="lineno">  966</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>  <a class="code hl_class" href="class_t_xsh_cell.html">TXshCell</a> cell = zcfx-&gt;getColumn()-&gt;getCell(tfloor(m_frame));</div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span>  <span class="comment">// Build</span></div>
<div class="line"><span class="lineno">  971</span>  <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> pf;</div>
<div class="line"><span class="lineno">  972</span>  pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a> = zcfx-&gt;getColumn()-&gt;getIndex();</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>  <span class="comment">// Add the column placement NaAffineFx</span></div>
<div class="line"><span class="lineno">  975</span>  <span class="keywordflow">if</span> (!getColumnPlacement(pf, m_xsh, m_frame, pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a>, m_isPreview))</div>
<div class="line"><span class="lineno">  976</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno">  977</span> </div>
<div class="line"><span class="lineno">  978</span>  <span class="comment">// if the cell is empty, only inherits its placement</span></div>
<div class="line"><span class="lineno">  979</span>  <span class="keywordflow">if</span> (cell.<a class="code hl_function" href="class_t_xsh_cell.html#a5d20229e7bcd19957b123959e58a833e">isEmpty</a>()) <span class="keywordflow">return</span> pf;</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>  <span class="comment">// set m_fx only when the current cell is not empty</span></div>
<div class="line"><span class="lineno">  982</span>  pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a> =</div>
<div class="line"><span class="lineno">  983</span>      fx-&gt;clone(<span class="keyword">false</span>);  <span class="comment">// Detach the fx with a clone. Why? It&#39;s typically done</span></div>
<div class="line"><span class="lineno">  984</span>                         <span class="comment">// to build fx connections in the render-tree freely.</span></div>
<div class="line"><span class="lineno">  985</span>                         <span class="comment">// Here, it&#39;s used just for particles, I guess...</span></div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>  <span class="comment">// Deal with input sub-trees</span></div>
<div class="line"><span class="lineno">  988</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fx-&gt;getInputPortCount(); ++i) {</div>
<div class="line"><span class="lineno">  989</span>    <span class="comment">// Note that only particles should end up here, currently</span></div>
<div class="line"><span class="lineno">  990</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> inputFx = fx-&gt;getInputPort(i)-&gt;getFx()) {</div>
<div class="line"><span class="lineno">  991</span>      <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> inputPF;</div>
<div class="line"><span class="lineno">  992</span> </div>
<div class="line"><span class="lineno">  993</span>      <span class="comment">// if the effect is a particle fx, it is necessary to consider also empty</span></div>
<div class="line"><span class="lineno">  994</span>      <span class="comment">// cells</span></div>
<div class="line"><span class="lineno">  995</span>      <span class="comment">// this causes a connection with the effect and a level also with empty</span></div>
<div class="line"><span class="lineno">  996</span>      <span class="comment">// cells.</span></div>
<div class="line"><span class="lineno">  997</span>      <span class="keywordflow">if</span> (fx-&gt;getFxType() == <span class="stringliteral">&quot;STD_particlesFx&quot;</span> ||</div>
<div class="line"><span class="lineno">  998</span>          fx-&gt;getFxType() == <span class="stringliteral">&quot;STD_iwa_TiledParticlesFx&quot;</span> ||</div>
<div class="line"><span class="lineno">  999</span>          fx-&gt;getFxType() == <span class="stringliteral">&quot;STD_tiledParticlesFx&quot;</span>) {</div>
<div class="line"><span class="lineno"> 1000</span>        m_particleDescendentCount++;</div>
<div class="line"><span class="lineno"> 1001</span>        inputPF = <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(inputFx.getPointer());</div>
<div class="line"><span class="lineno"> 1002</span>        m_particleDescendentCount--;</div>
<div class="line"><span class="lineno"> 1003</span>      } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1004</span>        inputPF = <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(inputFx.getPointer());</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>      inputFx = getFxWithColumnMovements(inputPF);</div>
<div class="line"><span class="lineno"> 1007</span>      <span class="keywordflow">if</span> (!inputFx) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1008</span> </div>
<div class="line"><span class="lineno"> 1009</span>      inputFx = TFxUtil::makeAffine(inputFx, pf.m_aff.<a class="code hl_function" href="class_t_affine.html#a570529b96b1ec5abc711aaa9aac09ff9">inv</a>());</div>
<div class="line"><span class="lineno"> 1010</span>      <span class="keywordflow">if</span> (!pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;<a class="code hl_function" href="class_t_fx.html#a2f3083c0f21b5a3579b7124db70c06a7">connect</a>(pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;getInputPortName(i), inputFx.getPointer()))</div>
<div class="line"><span class="lineno"> 1011</span>        assert(!<span class="stringliteral">&quot;Could not connect ports!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1012</span>    }</div>
<div class="line"><span class="lineno"> 1013</span>  }</div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>  <span class="keywordflow">if</span> (pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;getFxType() == <span class="stringliteral">&quot;STD_iwa_TextFx&quot;</span>) {</div>
<div class="line"><span class="lineno"> 1016</span>    <a class="code hl_class" href="class_text_aware_base_fx.html">TextAwareBaseFx</a> *textFx =</div>
<div class="line"><span class="lineno"> 1017</span>        <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_text_aware_base_fx.html">TextAwareBaseFx</a> *<span class="keyword">&gt;</span>(pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>.getPointer());</div>
<div class="line"><span class="lineno"> 1018</span>    <span class="keywordflow">if</span> (textFx &amp;&amp; textFx-&gt;getSourceType() != TextAwareBaseFx::INPUT_TEXT) {</div>
<div class="line"><span class="lineno"> 1019</span>      <span class="keywordtype">int</span> noteColumnIndex = textFx-&gt;getNoteColumnIndex();</div>
<div class="line"><span class="lineno"> 1020</span>      <span class="keywordtype">bool</span> getNeighbor =</div>
<div class="line"><span class="lineno"> 1021</span>          (textFx-&gt;getSourceType() == TextAwareBaseFx::NEARBY_COLUMN);</div>
<div class="line"><span class="lineno"> 1022</span>      textFx-&gt;setNoteLevelStr(getNoteText(m_xsh, m_frame, pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a>,</div>
<div class="line"><span class="lineno"> 1023</span>                                          noteColumnIndex, getNeighbor));</div>
<div class="line"><span class="lineno"> 1024</span>    }</div>
<div class="line"><span class="lineno"> 1025</span>  }</div>
<div class="line"><span class="lineno"> 1026</span> </div>
<div class="line"><span class="lineno"> 1027</span>  <span class="keywordflow">return</span> pf;</div>
<div class="line"><span class="lineno"> 1028</span>}</div>
<div class="ttc" id="aclass_text_aware_base_fx_html"><div class="ttname"><a href="class_text_aware_base_fx.html">TextAwareBaseFx</a></div><div class="ttdef"><b>Definition:</b> textawarebasefx.h:8</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a58c42d6b54479ccf18a383cf41c47c18" name="a58c42d6b54479ccf18a383cf41c47c18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58c42d6b54479ccf18a383cf41c47c18">&#9670;&nbsp;</a></span>makePFfromGenericFx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_placed_fx.html">PlacedFx</a> FxBuilder::makePFfromGenericFx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_fx.html">TFx</a> *&#160;</td>
          <td class="paramname"><em>fx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1118</span>                                               {</div>
<div class="line"><span class="lineno"> 1119</span>  assert(!<span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_level_column_fx.html">TLevelColumnFx</a> *<span class="keyword">&gt;</span>(fx));</div>
<div class="line"><span class="lineno"> 1120</span>  assert(!<span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_zerary_column_fx.html">TZeraryColumnFx</a> *<span class="keyword">&gt;</span>(fx));</div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span>  <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> pf;</div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span>  <span class="keywordflow">if</span> (!fx-&gt;getAttributes()-&gt;isEnabled()) {</div>
<div class="line"><span class="lineno"> 1125</span>    <span class="keywordflow">if</span> (fx-&gt;getInputPortCount() == 0) <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>    <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> inputFx = fx-&gt;getInputPort(fx-&gt;getPreferredInputPort())-&gt;getFx();</div>
<div class="line"><span class="lineno"> 1128</span>    <span class="keywordflow">if</span> (inputFx) <span class="keywordflow">return</span> <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(inputFx.getPointer());</div>
<div class="line"><span class="lineno"> 1129</span> </div>
<div class="line"><span class="lineno"> 1130</span>    <span class="keywordflow">return</span> pf;</div>
<div class="line"><span class="lineno"> 1131</span>  }</div>
<div class="line"><span class="lineno"> 1132</span> </div>
<div class="line"><span class="lineno"> 1133</span>  <span class="comment">// global controllable fx</span></div>
<div class="line"><span class="lineno"> 1134</span>  <span class="keywordflow">if</span> (fx-&gt;getAttributes()-&gt;hasGlobalControl()) {</div>
<div class="line"><span class="lineno"> 1135</span>    <span class="keywordflow">if</span> (!m_globalControlledFx.contains(fx-&gt;getFxId())) {</div>
<div class="line"><span class="lineno"> 1136</span>      <a class="code hl_class" href="class_global_controllable_fx.html">GlobalControllableFx</a> *gcFx = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_global_controllable_fx.html">GlobalControllableFx</a> *<span class="keyword">&gt;</span>(fx);</div>
<div class="line"><span class="lineno"> 1137</span>      <span class="keywordtype">double</span> val                 = gcFx-&gt;getGrobalControlValue(m_frame);</div>
<div class="line"><span class="lineno"> 1138</span>      <span class="keywordflow">if</span> (val &lt; 1.0) {</div>
<div class="line"><span class="lineno"> 1139</span>        <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> inputFx = fx-&gt;getInputPort(fx-&gt;getPreferredInputPort())-&gt;getFx();</div>
<div class="line"><span class="lineno"> 1140</span>        <span class="keywordflow">if</span> (!inputFx) <span class="keywordflow">return</span> pf;</div>
<div class="line"><span class="lineno"> 1141</span>        <span class="comment">// insert cross dissolve fx and mix with the input fx</span></div>
<div class="line"><span class="lineno"> 1142</span>        <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> blendFx = TFx::create(<span class="stringliteral">&quot;blendFx&quot;</span>);</div>
<div class="line"><span class="lineno"> 1143</span>        blendFx-&gt;<a class="code hl_function" href="class_t_fx.html#a2f3083c0f21b5a3579b7124db70c06a7">connect</a>(<span class="stringliteral">&quot;Source1&quot;</span>, fx);</div>
<div class="line"><span class="lineno"> 1144</span>        blendFx-&gt;<a class="code hl_function" href="class_t_fx.html#a2f3083c0f21b5a3579b7124db70c06a7">connect</a>(<span class="stringliteral">&quot;Source2&quot;</span>, inputFx.getPointer());</div>
<div class="line"><span class="lineno"> 1145</span>        m_globalControlledFx.insert(fx-&gt;getFxId(), {blendFx, true});</div>
<div class="line"><span class="lineno"> 1146</span>        <span class="comment">// set the global intensity value to the cross dissolve fx</span></div>
<div class="line"><span class="lineno"> 1147</span>        <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_double_param.html">TDoubleParam</a> *<span class="keyword">&gt;</span>(blendFx-&gt;getParams()-&gt;getParam(<span class="stringliteral">&quot;value&quot;</span>))</div>
<div class="line"><span class="lineno"> 1148</span>            -&gt;setDefaultValue(val * 100.0);</div>
<div class="line"><span class="lineno"> 1149</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(blendFx.getPointer());</div>
<div class="line"><span class="lineno"> 1150</span>      }</div>
<div class="line"><span class="lineno"> 1151</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_globalControlledFx.value(fx-&gt;getFxId()).second)</div>
<div class="line"><span class="lineno"> 1152</span>      m_globalControlledFx[fx-&gt;getFxId()].second = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1153</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1154</span>      m_globalControlledFx[fx-&gt;getFxId()].second = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1155</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(</div>
<div class="line"><span class="lineno"> 1156</span>          m_globalControlledFx.value(fx-&gt;getFxId()).first.getPointer());</div>
<div class="line"><span class="lineno"> 1157</span>    }</div>
<div class="line"><span class="lineno"> 1158</span>  }</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>  <span class="comment">// Multi-input fxs are always cloned - since at least one of its input ports</span></div>
<div class="line"><span class="lineno"> 1161</span>  <span class="comment">// will have an NaAffineFx</span></div>
<div class="line"><span class="lineno"> 1162</span>  <span class="comment">// injected just before its actual input fx.</span></div>
<div class="line"><span class="lineno"> 1163</span>  pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a> = fx-&gt;clone(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>  <span class="keywordtype">bool</span> firstInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span>  <span class="keywordtype">int</span> m = fx-&gt;getInputPortCount();</div>
<div class="line"><span class="lineno"> 1168</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno"> 1169</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> inputFx = fx-&gt;getInputPort(i)-&gt;getFx()) {</div>
<div class="line"><span class="lineno"> 1170</span>      <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> inputPF = <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(inputFx.getPointer());</div>
<div class="line"><span class="lineno"> 1171</span>      inputFx          = inputPF.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>;</div>
<div class="line"><span class="lineno"> 1172</span>      <span class="comment">// check the column index instead of inputFx</span></div>
<div class="line"><span class="lineno"> 1173</span>      <span class="comment">// so that the firstly-found input column always inherits</span></div>
<div class="line"><span class="lineno"> 1174</span>      <span class="comment">// its placement even if the current cell is empty.</span></div>
<div class="line"><span class="lineno"> 1175</span>      <span class="keywordflow">if</span> (inputPF.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a> &lt; 0 &amp;&amp; !inputPF.m_isPostXsheetNode) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1176</span> </div>
<div class="line"><span class="lineno"> 1177</span>      <span class="keywordflow">if</span> (firstInput) {</div>
<div class="line"><span class="lineno"> 1178</span>        firstInput = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span>        <span class="comment">// The first found input PlacedFx carries its placement infos up</span></div>
<div class="line"><span class="lineno"> 1181</span>        pf.m_aff              = inputPF.m_aff;</div>
<div class="line"><span class="lineno"> 1182</span>        pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a>      = inputPF.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a>;</div>
<div class="line"><span class="lineno"> 1183</span>        pf.<a class="code hl_variable" href="class_placed_fx.html#a910b9cb891b480fae5bff3a907faa17a">m_z</a>                = inputPF.<a class="code hl_variable" href="class_placed_fx.html#a910b9cb891b480fae5bff3a907faa17a">m_z</a>;</div>
<div class="line"><span class="lineno"> 1184</span>        pf.<a class="code hl_variable" href="class_placed_fx.html#a19ef25be41afd3a5c402eb962f609e2d">m_so</a>               = inputPF.<a class="code hl_variable" href="class_placed_fx.html#a19ef25be41afd3a5c402eb962f609e2d">m_so</a>;</div>
<div class="line"><span class="lineno"> 1185</span>        pf.m_isPostXsheetNode = inputPF.m_isPostXsheetNode;</div>
<div class="line"><span class="lineno"> 1186</span> </div>
<div class="line"><span class="lineno"> 1187</span>        <span class="comment">/*-- BinaryFx --*/</span></div>
<div class="line"><span class="lineno"> 1188</span>        <span class="keywordflow">if</span> (pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;getAttributes()-&gt;isSpeedAware()) {</div>
<div class="line"><span class="lineno"> 1189</span>          <a class="code hl_class" href="class_motion_aware_base_fx.html">MotionAwareBaseFx</a> *mabfx =</div>
<div class="line"><span class="lineno"> 1190</span>              <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_motion_aware_base_fx.html">MotionAwareBaseFx</a> *<span class="keyword">&gt;</span>(pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>.getPointer());</div>
<div class="line"><span class="lineno"> 1191</span>          <span class="keywordflow">if</span> (mabfx) {</div>
<div class="line"><span class="lineno"> 1192</span>            <span class="keywordtype">double</span> shutterStart = mabfx-&gt;getShutterStart()-&gt;getValue(m_frame);</div>
<div class="line"><span class="lineno"> 1193</span>            <span class="keywordtype">double</span> shutterEnd   = mabfx-&gt;getShutterEnd()-&gt;getValue(m_frame);</div>
<div class="line"><span class="lineno"> 1194</span>            <span class="keywordtype">int</span> traceResolution = mabfx-&gt;getTraceResolution()-&gt;getValue();</div>
<div class="line"><span class="lineno"> 1195</span>            <span class="comment">/*-- NoneId --*/</span></div>
<div class="line"><span class="lineno"> 1196</span>            MotionObjectType type   = mabfx-&gt;getMotionObjectType();</div>
<div class="line"><span class="lineno"> 1197</span>            <span class="keywordtype">int</span> index               = mabfx-&gt;getMotionObjectIndex()-&gt;getValue();</div>
<div class="line"><span class="lineno"> 1198</span>            <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> objectId = getMotionObjectId(type, index);</div>
<div class="line"><span class="lineno"> 1199</span>            pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;getAttributes()-&gt;setMotionPoints(getColumnMotionPoints(</div>
<div class="line"><span class="lineno"> 1200</span>                m_xsh, m_frame, pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a>, objectId, m_isPreview,</div>
<div class="line"><span class="lineno"> 1201</span>                shutterStart, shutterEnd, traceResolution));</div>
<div class="line"><span class="lineno"> 1202</span>          }</div>
<div class="line"><span class="lineno"> 1203</span>        }</div>
<div class="line"><span class="lineno"> 1204</span> </div>
<div class="line"><span class="lineno"> 1205</span>        <span class="keywordflow">if</span> (!inputFx) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1206</span> </div>
<div class="line"><span class="lineno"> 1207</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!inputFx)</div>
<div class="line"><span class="lineno"> 1208</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1209</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1210</span>        <span class="comment">// The follow-ups traduce their PlacedFx::m_aff into an NaAffineFx,</span></div>
<div class="line"><span class="lineno"> 1211</span>        <span class="comment">// instead</span></div>
<div class="line"><span class="lineno"> 1212</span>        inputFx = getFxWithColumnMovements(inputPF);</div>
<div class="line"><span class="lineno"> 1213</span>        inputFx = TFxUtil::makeAffine(inputFx, pf.m_aff.<a class="code hl_function" href="class_t_affine.html#a570529b96b1ec5abc711aaa9aac09ff9">inv</a>());</div>
<div class="line"><span class="lineno"> 1214</span>      }</div>
<div class="line"><span class="lineno"> 1215</span> </div>
<div class="line"><span class="lineno"> 1216</span>      <span class="keywordflow">if</span> (!pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;<a class="code hl_function" href="class_t_fx.html#a2f3083c0f21b5a3579b7124db70c06a7">connect</a>(pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;getInputPortName(i), inputFx.getPointer()))</div>
<div class="line"><span class="lineno"> 1217</span>        assert(!<span class="stringliteral">&quot;Could not connect ports!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1218</span>    }</div>
<div class="line"><span class="lineno"> 1219</span>  }</div>
<div class="line"><span class="lineno"> 1220</span> </div>
<div class="line"><span class="lineno"> 1221</span>  <span class="comment">// The xsheet-like input port is activated and brought upwards whenever it is</span></div>
<div class="line"><span class="lineno"> 1222</span>  <span class="comment">// both</span></div>
<div class="line"><span class="lineno"> 1223</span>  <span class="comment">// specified by the fx, and there is no input fx attached to it.</span></div>
<div class="line"><span class="lineno"> 1224</span>  <span class="keywordflow">if</span> (pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;getXsheetPort() &amp;&amp; pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;getXsheetPort()-&gt;getFx() == 0)</div>
<div class="line"><span class="lineno"> 1225</span>    pf.m_leftXsheetPort = pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>-&gt;getXsheetPort();</div>
<div class="line"><span class="lineno"> 1226</span> </div>
<div class="line"><span class="lineno"> 1227</span>  <span class="keywordflow">return</span> pf;</div>
<div class="line"><span class="lineno"> 1228</span>}</div>
<div class="ttc" id="aclass_global_controllable_fx_html"><div class="ttname"><a href="class_global_controllable_fx.html">GlobalControllableFx</a></div><div class="ttdef"><b>Definition:</b> globalcontrollablefx.h:10</div></div>
<div class="ttc" id="aclass_motion_aware_base_fx_html"><div class="ttname"><a href="class_motion_aware_base_fx.html">MotionAwareBaseFx</a></div><div class="ttdef"><b>Definition:</b> motionawarebasefx.h:18</div></div>
<div class="ttc" id="aclass_placed_fx_html_a19ef25be41afd3a5c402eb962f609e2d"><div class="ttname"><a href="class_placed_fx.html#a19ef25be41afd3a5c402eb962f609e2d">PlacedFx::m_so</a></div><div class="ttdeci">double m_so</div><div class="ttdoc">Same as above, for stacking order.</div><div class="ttdef"><b>Definition:</b> scenefx.cpp:242</div></div>
<div class="ttc" id="aclass_placed_fx_html_a910b9cb891b480fae5bff3a907faa17a"><div class="ttname"><a href="class_placed_fx.html#a910b9cb891b480fae5bff3a907faa17a">PlacedFx::m_z</a></div><div class="ttdeci">double m_z</div><div class="ttdoc">Z value for this fx's column.</div><div class="ttdef"><b>Definition:</b> scenefx.cpp:241</div></div>
<div class="ttc" id="aclass_t_double_param_html"><div class="ttname"><a href="class_t_double_param.html">TDoubleParam</a></div><div class="ttdef"><b>Definition:</b> tdoubleparam.h:54</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af2cd5c3ff5f84d9ee57c8aa120499d3f" name="af2cd5c3ff5f84d9ee57c8aa120499d3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2cd5c3ff5f84d9ee57c8aa120499d3f">&#9670;&nbsp;</a></span>makePFfromUnaryFx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_placed_fx.html">PlacedFx</a> FxBuilder::makePFfromUnaryFx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_fx.html">TFx</a> *&#160;</td>
          <td class="paramname"><em>fx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1032</span>                                             {</div>
<div class="line"><span class="lineno"> 1033</span>  assert(!<span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_level_column_fx.html">TLevelColumnFx</a> *<span class="keyword">&gt;</span>(fx));</div>
<div class="line"><span class="lineno"> 1034</span>  assert(!<span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_zerary_column_fx.html">TZeraryColumnFx</a> *<span class="keyword">&gt;</span>(fx));</div>
<div class="line"><span class="lineno"> 1035</span>  assert(fx-&gt;getInputPortCount() == 1);</div>
<div class="line"><span class="lineno"> 1036</span> </div>
<div class="line"><span class="lineno"> 1037</span>  <a class="code hl_class" href="class_t_fx.html">TFx</a> *inputFx = fx-&gt;getInputPort(0)-&gt;getFx();</div>
<div class="line"><span class="lineno"> 1038</span>  <span class="keywordflow">if</span> (!inputFx) <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno"> 1039</span> </div>
<div class="line"><span class="lineno"> 1040</span>  <span class="comment">// global controllable fx</span></div>
<div class="line"><span class="lineno"> 1041</span>  <span class="keywordflow">if</span> (fx-&gt;getAttributes()-&gt;hasGlobalControl()) {</div>
<div class="line"><span class="lineno"> 1042</span>    <span class="keywordflow">if</span> (!m_globalControlledFx.contains(fx-&gt;getFxId())) {</div>
<div class="line"><span class="lineno"> 1043</span>      <a class="code hl_class" href="class_global_controllable_fx.html">GlobalControllableFx</a> *gcFx = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_global_controllable_fx.html">GlobalControllableFx</a> *<span class="keyword">&gt;</span>(fx);</div>
<div class="line"><span class="lineno"> 1044</span>      <span class="keywordtype">double</span> val                 = gcFx-&gt;getGrobalControlValue(m_frame);</div>
<div class="line"><span class="lineno"> 1045</span>      <span class="keywordflow">if</span> (val &lt; 1.0) {</div>
<div class="line"><span class="lineno"> 1046</span>        <span class="comment">// insert cross dissolve fx and mix with the input fx</span></div>
<div class="line"><span class="lineno"> 1047</span>        <a class="code hl_class" href="class_t_smart_pointer_t.html">TFxP</a> blendFx = TFx::create(<span class="stringliteral">&quot;blendFx&quot;</span>);</div>
<div class="line"><span class="lineno"> 1048</span>        blendFx-&gt;<a class="code hl_function" href="class_t_fx.html#a2f3083c0f21b5a3579b7124db70c06a7">connect</a>(<span class="stringliteral">&quot;Source1&quot;</span>, fx);</div>
<div class="line"><span class="lineno"> 1049</span>        blendFx-&gt;<a class="code hl_function" href="class_t_fx.html#a2f3083c0f21b5a3579b7124db70c06a7">connect</a>(<span class="stringliteral">&quot;Source2&quot;</span>, inputFx);</div>
<div class="line"><span class="lineno"> 1050</span>        <span class="comment">// set the global intensity value to the cross dissolve fx</span></div>
<div class="line"><span class="lineno"> 1051</span>        <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_double_param.html">TDoubleParam</a> *<span class="keyword">&gt;</span>(blendFx-&gt;getParams()-&gt;getParam(<span class="stringliteral">&quot;value&quot;</span>))</div>
<div class="line"><span class="lineno"> 1052</span>            -&gt;setDefaultValue(val * 100.0);</div>
<div class="line"><span class="lineno"> 1053</span>        m_globalControlledFx.insert(fx-&gt;getFxId(), {blendFx, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno"> 1054</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(blendFx.getPointer());</div>
<div class="line"><span class="lineno"> 1055</span>      }</div>
<div class="line"><span class="lineno"> 1056</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_globalControlledFx.value(fx-&gt;getFxId()).second)</div>
<div class="line"><span class="lineno"> 1057</span>      m_globalControlledFx[fx-&gt;getFxId()].second = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1058</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1059</span>      m_globalControlledFx[fx-&gt;getFxId()].second = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1060</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(</div>
<div class="line"><span class="lineno"> 1061</span>          m_globalControlledFx.value(fx-&gt;getFxId()).first.getPointer());</div>
<div class="line"><span class="lineno"> 1062</span>    }</div>
<div class="line"><span class="lineno"> 1063</span>  }</div>
<div class="line"><span class="lineno"> 1064</span> </div>
<div class="line"><span class="lineno"> 1065</span>  <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a> pf = <a class="code hl_function" href="class_fx_builder.html#af4024bf49b3f6b19ba3fe964807f5741">makePF</a>(inputFx);  <span class="comment">// Build sub-render-tree</span></div>
<div class="line"><span class="lineno"> 1066</span>  <span class="keywordflow">if</span> (pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a> &lt; 0 &amp;&amp; !pf.m_isPostXsheetNode) <span class="keywordflow">return</span> <a class="code hl_class" href="class_placed_fx.html">PlacedFx</a>();</div>
<div class="line"><span class="lineno"> 1067</span>  <span class="comment">// inherit the column placement even if the current cell is empty</span></div>
<div class="line"><span class="lineno"> 1068</span>  <span class="keywordflow">if</span> (!pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>) <span class="keywordflow">return</span> pf;</div>
<div class="line"><span class="lineno"> 1069</span> </div>
<div class="line"><span class="lineno"> 1070</span>  <span class="keywordflow">if</span> (fx-&gt;getAttributes()-&gt;isEnabled()) {</div>
<div class="line"><span class="lineno"> 1071</span>    <span class="comment">// Fx is enabled, so insert it in the render-tree</span></div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>    <span class="comment">// Clone this fx necessary</span></div>
<div class="line"><span class="lineno"> 1074</span>    <span class="keywordflow">if</span> (pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>.getPointer() != inputFx ||  <span class="comment">// As in an earlier makePF, clone</span></div>
<div class="line"><span class="lineno"> 1075</span>                                            <span class="comment">// whenever input connections have</span></div>
<div class="line"><span class="lineno"> 1076</span>                                            <span class="comment">// changed</span></div>
<div class="line"><span class="lineno"> 1077</span>        fx-&gt;getAttributes()-&gt;isSpeedAware() ||  <span class="comment">// In the &#39;speedAware&#39; case,</span></div>
<div class="line"><span class="lineno"> 1078</span>                                                <span class="comment">// we&#39;ll alter the fx&#39;s</span></div>
<div class="line"><span class="lineno"> 1079</span>                                                <span class="comment">// attributes (see below)</span></div>
<div class="line"><span class="lineno"> 1080</span>        <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_macro_fx.html">TMacroFx</a> *<span class="keyword">&gt;</span>(fx))  <span class="comment">// As for macros... I&#39;m not sure. Not</span></div>
<div class="line"><span class="lineno"> 1081</span>                                       <span class="comment">// even who wrote this *understood*</span></div>
<div class="line"><span class="lineno"> 1082</span>    <span class="comment">// why - it just solved a bug  X( . Investigate!</span></div>
<div class="line"><span class="lineno"> 1083</span>    {</div>
<div class="line"><span class="lineno"> 1084</span>      fx = fx-&gt;clone(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1085</span>      <span class="keywordflow">if</span> (!fx-&gt;<a class="code hl_function" href="class_t_fx.html#a2f3083c0f21b5a3579b7124db70c06a7">connect</a>(fx-&gt;getInputPortName(0), pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a>.getPointer()))</div>
<div class="line"><span class="lineno"> 1086</span>        assert(!<span class="stringliteral">&quot;Could not connect ports!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1087</span>    }</div>
<div class="line"><span class="lineno"> 1088</span> </div>
<div class="line"><span class="lineno"> 1089</span>    pf.<a class="code hl_variable" href="class_placed_fx.html#af8263bb84b35a0b77d078b6025f96546">m_fx</a> = fx;</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>    <span class="keywordflow">if</span> (fx-&gt;getAttributes()-&gt;isSpeedAware()) {</div>
<div class="line"><span class="lineno"> 1092</span>      <span class="comment">/*--  --*/</span></div>
<div class="line"><span class="lineno"> 1093</span>      <a class="code hl_class" href="class_motion_aware_base_fx.html">MotionAwareBaseFx</a> *mabfx = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_motion_aware_base_fx.html">MotionAwareBaseFx</a> *<span class="keyword">&gt;</span>(fx);</div>
<div class="line"><span class="lineno"> 1094</span>      <span class="keywordflow">if</span> (mabfx) {</div>
<div class="line"><span class="lineno"> 1095</span>        <span class="keywordtype">double</span> shutterStart = mabfx-&gt;getShutterStart()-&gt;getValue(m_frame);</div>
<div class="line"><span class="lineno"> 1096</span>        <span class="keywordtype">double</span> shutterEnd   = mabfx-&gt;getShutterEnd()-&gt;getValue(m_frame);</div>
<div class="line"><span class="lineno"> 1097</span>        <span class="keywordtype">int</span> traceResolution = mabfx-&gt;getTraceResolution()-&gt;getValue();</div>
<div class="line"><span class="lineno"> 1098</span>        <span class="comment">/*-- NoneId --*/</span></div>
<div class="line"><span class="lineno"> 1099</span>        MotionObjectType type   = mabfx-&gt;getMotionObjectType();</div>
<div class="line"><span class="lineno"> 1100</span>        <span class="keywordtype">int</span> index               = mabfx-&gt;getMotionObjectIndex()-&gt;getValue();</div>
<div class="line"><span class="lineno"> 1101</span>        <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> objectId = getMotionObjectId(type, index);</div>
<div class="line"><span class="lineno"> 1102</span>        fx-&gt;getAttributes()-&gt;setMotionPoints(getColumnMotionPoints(</div>
<div class="line"><span class="lineno"> 1103</span>            m_xsh, m_frame, pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a>, objectId, m_isPreview,</div>
<div class="line"><span class="lineno"> 1104</span>            shutterStart, shutterEnd, traceResolution));</div>
<div class="line"><span class="lineno"> 1105</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1106</span>        <a class="code hl_class" href="class_t_point_t.html">TPointD</a> speed =</div>
<div class="line"><span class="lineno"> 1107</span>            getColumnSpeed(m_xsh, m_frame, pf.<a class="code hl_variable" href="class_placed_fx.html#aab44f6db03fdb9520b8af551c73c26ea">m_columnIndex</a>, m_isPreview);</div>
<div class="line"><span class="lineno"> 1108</span>        fx-&gt;getAttributes()-&gt;setSpeed(speed);</div>
<div class="line"><span class="lineno"> 1109</span>      }</div>
<div class="line"><span class="lineno"> 1110</span>    }</div>
<div class="line"><span class="lineno"> 1111</span>  }</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>  <span class="keywordflow">return</span> pf;</div>
<div class="line"><span class="lineno"> 1114</span>}</div>
<div class="ttc" id="aclass_t_macro_fx_html"><div class="ttname"><a href="class_t_macro_fx.html">TMacroFx</a></div><div class="ttdef"><b>Definition:</b> tmacrofx.h:24</div></div>
<div class="ttc" id="aclass_t_point_t_html"><div class="ttname"><a href="class_t_point_t.html">TPointT&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aebedc07193e4c1c3f7836eee158d307b" name="aebedc07193e4c1c3f7836eee158d307b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebedc07193e4c1c3f7836eee158d307b">&#9670;&nbsp;</a></span>m_cameraAff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_affine.html">TAffine</a> FxBuilder::m_cameraAff</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab193cbe36ac178a47e89352104fb72f7" name="ab193cbe36ac178a47e89352104fb72f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab193cbe36ac178a47e89352104fb72f7">&#9670;&nbsp;</a></span>m_cameraZ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double FxBuilder::m_cameraZ</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae4a1bbd35d06c3843732c737587c71c6" name="ae4a1bbd35d06c3843732c737587c71c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4a1bbd35d06c3843732c737587c71c6">&#9670;&nbsp;</a></span>m_expandXSheet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FxBuilder::m_expandXSheet</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7e3accce3ade7141906b6c8290c0dc83" name="a7e3accce3ade7141906b6c8290c0dc83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e3accce3ade7141906b6c8290c0dc83">&#9670;&nbsp;</a></span>m_frame</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double FxBuilder::m_frame</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a047a6e90b2c124db3704a7870e88543b" name="a047a6e90b2c124db3704a7870e88543b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a047a6e90b2c124db3704a7870e88543b">&#9670;&nbsp;</a></span>m_globalControlledFx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QMap&lt;std::wstring, QPair&lt;<a class="el" href="class_t_smart_pointer_t.html">TFxP</a>, bool&gt; &gt; FxBuilder::m_globalControlledFx</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a40e338c0b1fc2412bbf8058aaa247293" name="a40e338c0b1fc2412bbf8058aaa247293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40e338c0b1fc2412bbf8058aaa247293">&#9670;&nbsp;</a></span>m_isPreview</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FxBuilder::m_isPreview</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abbef4e5db9b886b35f22d18557d626f0" name="abbef4e5db9b886b35f22d18557d626f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbef4e5db9b886b35f22d18557d626f0">&#9670;&nbsp;</a></span>m_particleDescendentCount</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FxBuilder::m_particleDescendentCount</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7605d87ea2fd2da04e8e653e227591b2" name="a7605d87ea2fd2da04e8e653e227591b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7605d87ea2fd2da04e8e653e227591b2">&#9670;&nbsp;</a></span>m_scene</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_toonz_scene.html">ToonzScene</a>* FxBuilder::m_scene</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a847ef9f9181a798f01f56aafb31c9456" name="a847ef9f9181a798f01f56aafb31c9456"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a847ef9f9181a798f01f56aafb31c9456">&#9670;&nbsp;</a></span>m_whichLevels</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FxBuilder::m_whichLevels</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8b0cb40853b2c631ce2226d3e8fbee27" name="a8b0cb40853b2c631ce2226d3e8fbee27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b0cb40853b2c631ce2226d3e8fbee27">&#9670;&nbsp;</a></span>m_xsh</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_xsheet.html">TXsheet</a>* FxBuilder::m_xsh</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>E:/opentoonz/toonz/sources/include/tw/<a class="el" href="">fxbrowser.h</a></li>
<li>E:/opentoonz/toonz/sources/toonzlib/<a class="el" href="">scenefx.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
