<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: MeshTexturizer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_mesh_texturizer-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">MeshTexturizer Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="class_mesh_texturizer.html" title="The MeshTexturizer class acts as a management wrapper to OpenGL texturing capabilities,...">MeshTexturizer</a> class acts as a management wrapper to OpenGL texturing capabilities, in particular concerning texture virtualization.  
 <a href="class_mesh_texturizer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="">meshtexturizer.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mesh_texturizer_1_1_imp.html">Imp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mesh_texturizer_1_1_texture_data.html">TextureData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The MeshTexturizer-owned data about a texture.  <a href="struct_mesh_texturizer_1_1_texture_data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a6492b42f79d7e43ab31ee5c3c32db745"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745">PremultMode</a> { <a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745a86bd8d532023068b55ac6b5b6df7ef72">NONPREMULTIPLIED</a>
, <a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745ab457bc0430439655e8ccae45d6b77278">PREMULTIPLIED</a>
 }</td></tr>
<tr class="memdesc:a6492b42f79d7e43ab31ee5c3c32db745"><td class="mdescLeft">&#160;</td><td class="mdescRight">Premultiplication specifier for texture binding.  <a href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745">More...</a><br /></td></tr>
<tr class="separator:a6492b42f79d7e43ab31ee5c3c32db745"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3fa598cb63981464e2bf7846490ab1f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mesh_texturizer.html#a3fa598cb63981464e2bf7846490ab1f8">bindTexture</a> (const <a class="el" href="class_t_raster_p_t.html">TRaster32P</a> &amp;ras, const <a class="el" href="class_t_rect_t.html">TRectD</a> &amp;geometry, <a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745">PremultMode</a> premultiplyMode=<a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745a86bd8d532023068b55ac6b5b6df7ef72">NONPREMULTIPLIED</a>)</td></tr>
<tr class="separator:a3fa598cb63981464e2bf7846490ab1f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34014cab75532d14c48017d8e37d27a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_mesh_texturizer_1_1_texture_data.html">TextureData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mesh_texturizer.html#a34014cab75532d14c48017d8e37d27a6">getTextureData</a> (int textureId)</td></tr>
<tr class="separator:a34014cab75532d14c48017d8e37d27a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5c84d3378c2f45046849133e6fd0207"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mesh_texturizer.html#ab5c84d3378c2f45046849133e6fd0207">rebindTexture</a> (int textureId, const <a class="el" href="class_t_raster_p_t.html">TRaster32P</a> &amp;ras, const <a class="el" href="class_t_rect_t.html">TRectD</a> &amp;geometry, <a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745">PremultMode</a> premultiplyMode=<a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745a86bd8d532023068b55ac6b5b6df7ef72">NONPREMULTIPLIED</a>)</td></tr>
<tr class="separator:ab5c84d3378c2f45046849133e6fd0207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe81d212c56c9b739e4988143570383b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mesh_texturizer.html#abe81d212c56c9b739e4988143570383b">unbindTexture</a> (int textureId)</td></tr>
<tr class="memdesc:abe81d212c56c9b739e4988143570383b"><td class="mdescLeft">&#160;</td><td class="mdescRight">id to a new image.  <a href="class_mesh_texturizer.html#abe81d212c56c9b739e4988143570383b">More...</a><br /></td></tr>
<tr class="separator:abe81d212c56c9b739e4988143570383b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >The <a class="el" href="class_mesh_texturizer.html" title="The MeshTexturizer class acts as a management wrapper to OpenGL texturing capabilities,...">MeshTexturizer</a> class acts as a management wrapper to OpenGL texturing capabilities, in particular concerning texture virtualization. </p>
<p >The first step in OpenGL texturing requires copying a texture into the video ram (<em>VRAM</em>). Now, OpenGL documentation specifies that, although there is no limit to the <em>number</em> of allowed textures, there <em>are</em> limits to the <b>size</b> of said textures, which can be tested by asking OpenGL whether it can accommodate specific texture requests or not.</p>
<p >Technically, the <a class="el" href="class_mesh_texturizer.html" title="The MeshTexturizer class acts as a management wrapper to OpenGL texturing capabilities,...">MeshTexturizer</a> class acts as a virtualization manager that can be used to allow texturization with arbitrary texture sizes. The manager accepts raster images that are cut up into tiles and bound to VRAM.</p>
<p >Please, observe that the number of texture objects is typically not an issue, as OpenGL is able to swap texture objects between RAM and VRAM, depending on which textures have been used most frequently. In other words, since <a class="el" href="class_mesh_texturizer.html" title="The MeshTexturizer class acts as a management wrapper to OpenGL texturing capabilities,...">MeshTexturizer</a> ensures the granularity required by OpenGL, textures can be used until the process runs out of memory - of course, swapping can be a source of slowdowns, though.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Subdivision into tiles is designed to work for both premultiplied <em>and</em> non-premultiplied textures. </dd>
<dd>
<a class="el" href="class_mesh_texturizer.html" title="The MeshTexturizer class acts as a management wrapper to OpenGL texturing capabilities,...">MeshTexturizer</a> instances are thread-safe. </dd></dl>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a6492b42f79d7e43ab31ee5c3c32db745" name="a6492b42f79d7e43ab31ee5c3c32db745"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6492b42f79d7e43ab31ee5c3c32db745">&#9670;&nbsp;</a></span>PremultMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745">MeshTexturizer::PremultMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Premultiplication specifier for texture binding. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a6492b42f79d7e43ab31ee5c3c32db745a86bd8d532023068b55ac6b5b6df7ef72" name="a6492b42f79d7e43ab31ee5c3c32db745a86bd8d532023068b55ac6b5b6df7ef72"></a>NONPREMULTIPLIED&#160;</td><td class="fielddoc"><p ><a class="el" href="struct_texture.html">Texture</a> is not premultiplied. </p>
</td></tr>
<tr><td class="fieldname"><a id="a6492b42f79d7e43ab31ee5c3c32db745ab457bc0430439655e8ccae45d6b77278" name="a6492b42f79d7e43ab31ee5c3c32db745ab457bc0430439655e8ccae45d6b77278"></a>PREMULTIPLIED&#160;</td><td class="fielddoc"><p ><a class="el" href="struct_texture.html">Texture</a> is premultiplied. </p>
</td></tr>
</table>
<div class="fragment"><div class="line"><span class="lineno">   72</span>  { <a class="code hl_enumvalue" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745a86bd8d532023068b55ac6b5b6df7ef72">NONPREMULTIPLIED</a>,  </div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_enumvalue" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745ab457bc0430439655e8ccae45d6b77278">PREMULTIPLIED</a>,     </div>
<div class="line"><span class="lineno">   74</span>  };</div>
<div class="ttc" id="aclass_mesh_texturizer_html_a6492b42f79d7e43ab31ee5c3c32db745a86bd8d532023068b55ac6b5b6df7ef72"><div class="ttname"><a href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745a86bd8d532023068b55ac6b5b6df7ef72">MeshTexturizer::NONPREMULTIPLIED</a></div><div class="ttdeci">@ NONPREMULTIPLIED</div><div class="ttdoc">Texture is not premultiplied.</div><div class="ttdef"><b>Definition:</b> meshtexturizer.h:72</div></div>
<div class="ttc" id="aclass_mesh_texturizer_html_a6492b42f79d7e43ab31ee5c3c32db745ab457bc0430439655e8ccae45d6b77278"><div class="ttname"><a href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745ab457bc0430439655e8ccae45d6b77278">MeshTexturizer::PREMULTIPLIED</a></div><div class="ttdeci">@ PREMULTIPLIED</div><div class="ttdoc">Texture is premultiplied.</div><div class="ttdef"><b>Definition:</b> meshtexturizer.h:73</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a18e2bfed2b2a4dcbf5a7a78a394fd8d8" name="a18e2bfed2b2a4dcbf5a7a78a394fd8d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18e2bfed2b2a4dcbf5a7a78a394fd8d8">&#9670;&nbsp;</a></span>MeshTexturizer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MeshTexturizer::MeshTexturizer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  248</span>: m_imp(<span class="keyword">new</span> Imp) {}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab238e8d73ad73a270e314a9f8d2a0368" name="ab238e8d73ad73a270e314a9f8d2a0368"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab238e8d73ad73a270e314a9f8d2a0368">&#9670;&nbsp;</a></span>~MeshTexturizer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MeshTexturizer::~MeshTexturizer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  252</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a3fa598cb63981464e2bf7846490ab1f8" name="a3fa598cb63981464e2bf7846490ab1f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fa598cb63981464e2bf7846490ab1f8">&#9670;&nbsp;</a></span>bindTexture()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MeshTexturizer::bindTexture </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_raster_p_t.html">TRaster32P</a> &amp;&#160;</td>
          <td class="paramname"><em>ras</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_rect_t.html">TRectD</a> &amp;&#160;</td>
          <td class="paramname"><em>geometry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745">PremultMode</a>&#160;</td>
          <td class="paramname"><em>premultiplyMode</em> = <code><a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745a86bd8d532023068b55ac6b5b6df7ef72">NONPREMULTIPLIED</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >The <a class="el" href="class_mesh_texturizer.html#a3fa598cb63981464e2bf7846490ab1f8">bindTexture()</a> function is used to specify a 32-bit fullcolor raster as a texture to be used for mesh rendering. The supplied geometry rect defines its position with respect to compiled meshes. </p><dl class="section remark"><dt>Remarks</dt><dd>The premultiplication specifier is used to tell the texturizer how to add a proper transparent border surrounding texture tiles. This border is essential to draw transparent pixels beyond a texture tile's content. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The internal id used to reference to the input raster. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">geometry</td><td>Moves a <em>copy</em> of the supplied raster image to VRAM, </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  257</span>                                                             {</div>
<div class="line"><span class="lineno">  258</span>  QWriteLocker locker(&amp;m_imp-&gt;m_lock);</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>  <span class="comment">// Backup the state of some specific OpenGL variables that will be changed</span></div>
<div class="line"><span class="lineno">  261</span>  <span class="comment">// throughout the code</span></div>
<div class="line"><span class="lineno">  262</span>  <span class="keywordtype">int</span> row_length, alignment;</div>
<div class="line"><span class="lineno">  263</span>  glGetIntegerv(GL_UNPACK_ROW_LENGTH, &amp;row_length);</div>
<div class="line"><span class="lineno">  264</span>  glGetIntegerv(GL_UNPACK_ALIGNMENT, &amp;alignment);</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>  <span class="comment">// Initialize a new texture data</span></div>
<div class="line"><span class="lineno">  267</span>  <span class="keywordtype">int</span> dataIdx =</div>
<div class="line"><span class="lineno">  268</span>      m_imp-&gt;m_textureDatas.push_back(std::make_shared&lt;TextureData&gt;(geom));</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>  <span class="comment">// Textures must have 2-power sizes. So, let&#39;s start with the smallest 2 power</span></div>
<div class="line"><span class="lineno">  271</span>  <span class="comment">// &gt;= ras&#39;s sizes.</span></div>
<div class="line"><span class="lineno">  272</span>  <span class="keywordtype">int</span> textureLx =</div>
<div class="line"><span class="lineno">  273</span>      <a class="code hl_function" href="namespacetcg_1_1numeric__ops.html#ac52e0f198805e231c1497086c535d185">tcg::numeric_ops::GE_2Power</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)ras-&gt;getLx() + TOTAL_BORDER_2);</div>
<div class="line"><span class="lineno">  274</span>  <span class="keywordtype">int</span> textureLy =</div>
<div class="line"><span class="lineno">  275</span>      <a class="code hl_function" href="namespacetcg_1_1numeric__ops.html#ac52e0f198805e231c1497086c535d185">tcg::numeric_ops::GE_2Power</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)ras-&gt;getLy() + TOTAL_BORDER_2);</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>  <span class="comment">// We&#39;ll assume a strict granularity max of 2048 x 2048 textures, if it is</span></div>
<div class="line"><span class="lineno">  278</span>  <span class="comment">// possible.</span></div>
<div class="line"><span class="lineno">  279</span>  textureLx = std::min(textureLx, getMaxTextureTileSize());</div>
<div class="line"><span class="lineno">  280</span>  textureLy = std::min(textureLy, getMaxTextureTileSize());</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>  <span class="comment">// Allocate a suitable texture raster. The texture will include a transparent</span></div>
<div class="line"><span class="lineno">  283</span>  <span class="comment">// 1-pix border</span></div>
<div class="line"><span class="lineno">  284</span>  <span class="comment">// that is needed to perform texture mapping with GL_CLAMP transparent</span></div>
<div class="line"><span class="lineno">  285</span>  <span class="comment">// wrapping</span></div>
<div class="line"><span class="lineno">  286</span>  <a class="code hl_class" href="class_t_raster_p_t.html">TRaster32P</a> tex(textureLx, textureLy);</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>  <span class="comment">// Now, let&#39;s tile the specified raster. We&#39;ll start from the lower-left</span></div>
<div class="line"><span class="lineno">  289</span>  <span class="comment">// corner in case</span></div>
<div class="line"><span class="lineno">  290</span>  <span class="comment">// the raster can be completely included in just one tile</span></div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>  <span class="keywordtype">int</span> lx = ras-&gt;getLx(), ly = ras-&gt;getLy();</div>
<div class="line"><span class="lineno">  293</span>  <span class="keywordtype">int</span> tileLx = textureLx - TOTAL_BORDER_2,</div>
<div class="line"><span class="lineno">  294</span>      tileLy = textureLy - TOTAL_BORDER_2;  <span class="comment">// Texture size without border</span></div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>  <span class="keywordtype">int</span> xEntireCells = (lx - 1) / tileLx,</div>
<div class="line"><span class="lineno">  297</span>      yEntireCells =</div>
<div class="line"><span class="lineno">  298</span>          (ly - 1) /</div>
<div class="line"><span class="lineno">  299</span>          tileLy;  <span class="comment">// +1 so in case l == tileL, we get the remainder case</span></div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>  <span class="keywordtype">int</span> lastTexLx = <a class="code hl_function" href="namespacetcg_1_1numeric__ops.html#ac52e0f198805e231c1497086c535d185">tcg::numeric_ops::GE_2Power</a>(</div>
<div class="line"><span class="lineno">  302</span>      (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(lx - xEntireCells * tileLx + TOTAL_BORDER_2));</div>
<div class="line"><span class="lineno">  303</span>  <span class="keywordtype">int</span> lastTexLy = <a class="code hl_function" href="namespacetcg_1_1numeric__ops.html#ac52e0f198805e231c1497086c535d185">tcg::numeric_ops::GE_2Power</a>(</div>
<div class="line"><span class="lineno">  304</span>      (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(ly - yEntireCells * tileLy + TOTAL_BORDER_2));</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>  <span class="keywordtype">int</span> lastTileLx = lastTexLx - TOTAL_BORDER_2,</div>
<div class="line"><span class="lineno">  307</span>      lastTileLy = lastTexLy - TOTAL_BORDER_2;</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>  <span class="keywordtype">bool</span> premultiplied = (premultiplyMode == <a class="code hl_enumvalue" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745ab457bc0430439655e8ccae45d6b77278">PREMULTIPLIED</a>);</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>  <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno">  312</span>  <span class="keywordflow">for</span> (i = 0; i &lt; yEntireCells; ++i) {</div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordflow">for</span> (j = 0; j &lt; xEntireCells; ++j)</div>
<div class="line"><span class="lineno">  314</span>      <span class="comment">// Perform a (possibly subdividing) allocation of the specified tile</span></div>
<div class="line"><span class="lineno">  315</span>      m_imp-&gt;allocateTextures(dataIdx, ras, tex, j * tileLx, i * tileLy, tileLx,</div>
<div class="line"><span class="lineno">  316</span>                              tileLy, premultiplied);</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>    m_imp-&gt;allocateTextures(dataIdx, ras, tex, j * tileLx, i * tileLy,</div>
<div class="line"><span class="lineno">  319</span>                            lastTileLx, tileLy, premultiplied);</div>
<div class="line"><span class="lineno">  320</span>  }</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>  <span class="keywordflow">for</span> (j = 0; j &lt; xEntireCells; ++j)</div>
<div class="line"><span class="lineno">  323</span>    m_imp-&gt;allocateTextures(dataIdx, ras, tex, j * tileLx, i * tileLy, tileLx,</div>
<div class="line"><span class="lineno">  324</span>                            lastTileLy, premultiplied);</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>  m_imp-&gt;allocateTextures(dataIdx, ras, tex, j * tileLx, i * tileLy, lastTileLx,</div>
<div class="line"><span class="lineno">  327</span>                          lastTileLy, premultiplied);</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>  <span class="comment">// Restore OpenGL variables</span></div>
<div class="line"><span class="lineno">  330</span>  glPixelStorei(GL_UNPACK_ROW_LENGTH, row_length);</div>
<div class="line"><span class="lineno">  331</span>  glPixelStorei(GL_UNPACK_ALIGNMENT, alignment);</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>  <span class="keywordflow">return</span> dataIdx;</div>
<div class="line"><span class="lineno">  334</span>}</div>
<div class="ttc" id="aclass_t_raster_p_t_html"><div class="ttname"><a href="class_t_raster_p_t.html">TRasterPT&lt; TPixel32 &gt;</a></div></div>
<div class="ttc" id="anamespacetcg_1_1numeric__ops_html_ac52e0f198805e231c1497086c535d185"><div class="ttname"><a href="namespacetcg_1_1numeric__ops.html#ac52e0f198805e231c1497086c535d185">tcg::numeric_ops::GE_2Power</a></div><div class="ttdeci">UScalar GE_2Power(UScalar val)</div><div class="ttdef"><b>Definition:</b> numeric_ops.h:200</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00200">tcg::numeric_ops::GE_2Power()</a>, and <a class="el" href="#l00073">PREMULTIPLIED</a>.</p>

<p class="reference">Referenced by <a class="el" href="#l00136">TTexturesStorage::loadTexture()</a>, and <a class="el" href="#l00338">rebindTexture()</a>.</p>

</div>
</div>
<a id="a34014cab75532d14c48017d8e37d27a6" name="a34014cab75532d14c48017d8e37d27a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34014cab75532d14c48017d8e37d27a6">&#9670;&nbsp;</a></span>getTextureData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_mesh_texturizer_1_1_texture_data.html">MeshTexturizer::TextureData</a> * MeshTexturizer::getTextureData </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>textureId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >and assigns an identification number to it. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ras</td><td><a class="el" href="struct_texture.html">Texture</a> to be copied to VRAM. </td></tr>
    <tr><td class="paramname">geometry</td><td>The texture's geometry in the world - with respect to compiled meshes. </td></tr>
    <tr><td class="paramname">premultiplyMode</td><td>Specified whether ras is to be intended premultiplied or not.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>The pointer returned by <a class="el" href="class_mesh_texturizer.html#a34014cab75532d14c48017d8e37d27a6">getTextureData()</a> is <b>owned by this class</b> - it must not be deleted. Retrieves the texture data built from a previously </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  358</span>                                                                       {</div>
<div class="line"><span class="lineno">  359</span>  QReadLocker locker(&amp;m_imp-&gt;m_lock);</div>
<div class="line"><span class="lineno">  360</span>  <span class="keywordflow">return</span> m_imp-&gt;getTextureData(textureId);</div>
<div class="line"><span class="lineno">  361</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="#l00136">TTexturesStorage::loadTexture()</a>.</p>

</div>
</div>
<a id="ab5c84d3378c2f45046849133e6fd0207" name="ab5c84d3378c2f45046849133e6fd0207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5c84d3378c2f45046849133e6fd0207">&#9670;&nbsp;</a></span>rebindTexture()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MeshTexturizer::rebindTexture </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>textureId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_raster_p_t.html">TRaster32P</a> &amp;&#160;</td>
          <td class="paramname"><em>ras</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_rect_t.html">TRectD</a> &amp;&#160;</td>
          <td class="paramname"><em>geometry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745">PremultMode</a>&#160;</td>
          <td class="paramname"><em>premultiplyMode</em> = <code><a class="el" href="class_mesh_texturizer.html#a6492b42f79d7e43ab31ee5c3c32db745a86bd8d532023068b55ac6b5b6df7ef72">NONPREMULTIPLIED</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >bound texture image.</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">textureId</td><td>Identifier of the texture to be retrieved </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>See summary.</dd></dl>
<p>The texture identifier specified to <a class="el" href="class_mesh_texturizer.html#ab5c84d3378c2f45046849133e6fd0207">rebindTexture()</a> is retained, and the effect is that of an <a class="el" href="class_mesh_texturizer.html#abe81d212c56c9b739e4988143570383b" title="id to a new image.">unbindTexture()</a> - <a class="el" href="class_mesh_texturizer.html#a3fa598cb63981464e2bf7846490ab1f8">bindTexture()</a> combo. </p><dl class="section note"><dt>Note</dt><dd>Pre-compiled mesh data against the old texture can be retained <b>if</b> the newly supplied texture size and geometry are the <b>same</b> as the old one. <br  />
 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">geometry</td><td>Rebinds the image bound to the specified texture </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  340</span>                                                                {</div>
<div class="line"><span class="lineno">  341</span>  QWriteLocker locker(&amp;m_imp-&gt;m_lock);</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>  <a class="code hl_function" href="class_mesh_texturizer.html#abe81d212c56c9b739e4988143570383b">unbindTexture</a>(texId);</div>
<div class="line"><span class="lineno">  344</span>  <span class="keywordtype">int</span> newTexId = <a class="code hl_function" href="class_mesh_texturizer.html#a3fa598cb63981464e2bf7846490ab1f8">bindTexture</a>(ras, geom, premultiplyMode);</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>  assert(texId == newTexId);</div>
<div class="line"><span class="lineno">  347</span>}</div>
<div class="ttc" id="aclass_mesh_texturizer_html_a3fa598cb63981464e2bf7846490ab1f8"><div class="ttname"><a href="class_mesh_texturizer.html#a3fa598cb63981464e2bf7846490ab1f8">MeshTexturizer::bindTexture</a></div><div class="ttdeci">int bindTexture(const TRaster32P &amp;ras, const TRectD &amp;geometry, PremultMode premultiplyMode=NONPREMULTIPLIED)</div><div class="ttdef"><b>Definition:</b> meshtexturizer.cpp:256</div></div>
<div class="ttc" id="aclass_mesh_texturizer_html_abe81d212c56c9b739e4988143570383b"><div class="ttname"><a href="class_mesh_texturizer.html#abe81d212c56c9b739e4988143570383b">MeshTexturizer::unbindTexture</a></div><div class="ttdeci">void unbindTexture(int textureId)</div><div class="ttdoc">id to a new image.</div><div class="ttdef"><b>Definition:</b> meshtexturizer.cpp:351</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00256">bindTexture()</a>, and <a class="el" href="#l00351">unbindTexture()</a>.</p>

</div>
</div>
<a id="abe81d212c56c9b739e4988143570383b" name="abe81d212c56c9b739e4988143570383b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe81d212c56c9b739e4988143570383b">&#9670;&nbsp;</a></span>unbindTexture()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MeshTexturizer::unbindTexture </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>textureId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>id to a new image. </p>
<p >Deletes the texture associated to the passed id.</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">textureId</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  351</span>                                            {</div>
<div class="line"><span class="lineno">  352</span>  QWriteLocker locker(&amp;m_imp-&gt;m_lock);</div>
<div class="line"><span class="lineno">  353</span>  m_imp-&gt;m_textureDatas.erase(texId);</div>
<div class="line"><span class="lineno">  354</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="#l00338">rebindTexture()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>E:/opentoonz/toonz/sources/include/ext/<a class="el" href="">meshtexturizer.h</a></li>
<li>E:/opentoonz/toonz/sources/tnzext/<a class="el" href="">meshtexturizer.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
