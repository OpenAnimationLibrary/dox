<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: IoCmd Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">IoCmd Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Contains command functions related to Toonz I/O. <br  />
  
<a href="namespace_io_cmd.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_io_cmd_1_1_converting_popup.html">ConvertingPopup</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_io_cmd_1_1_export_level_options.html">ExportLevelOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collection of options accepted by the export level command.  <a href="struct_io_cmd_1_1_export_level_options.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_io_cmd_1_1_load_resource_arguments.html">LoadResourceArguments</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Composite data used describing a group of Toonz resources to be loaded.  <a href="struct_io_cmd_1_1_load_resource_arguments.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_io_cmd_1_1_overwrite_callbacks.html">OverwriteCallbacks</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_io_cmd_1_1_progress_callbacks.html">ProgressCallbacks</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a2e85d0d7111af66de5d2ec589939c43a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><b>SaveSceneFlags</b> { <b>SILENTLY_OVERWRITE</b> = 0x1
, <b>SAVE_SUBXSHEET</b> = 0x2
, <b>AUTO_SAVE</b> = 0x4
 }</td></tr>
<tr class="separator:a2e85d0d7111af66de5d2ec589939c43a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afbfa3598864913d35bef6b4cb75c1e45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_smart_pointer_t.html">TImageP</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#afbfa3598864913d35bef6b4cb75c1e45">exportedImage</a> (const std::string &amp;ext, const <a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> &amp;sl, const <a class="el" href="class_t_frame_id.html">TFrameId</a> &amp;fid, const <a class="el" href="struct_io_cmd_1_1_export_level_options.html">ExportLevelOptions</a> &amp;opts=<a class="el" href="struct_io_cmd_1_1_export_level_options.html">ExportLevelOptions</a>())</td></tr>
<tr class="memdesc:afbfa3598864913d35bef6b4cb75c1e45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Intended for preview purposes, computes the image that will be exported by the <a class="el" href="namespace_io_cmd.html#a99bbb49fbdaab858ec5310ab8c72521a" title="Exports passed level to the specified path.">exportLevel()</a> command.  <a href="namespace_io_cmd.html#afbfa3598864913d35bef6b4cb75c1e45">More...</a><br /></td></tr>
<tr class="separator:afbfa3598864913d35bef6b4cb75c1e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99bbb49fbdaab858ec5310ab8c72521a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a99bbb49fbdaab858ec5310ab8c72521a">exportLevel</a> (const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;path, <a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *sl=0, <a class="el" href="struct_io_cmd_1_1_export_level_options.html">ExportLevelOptions</a> opts=<a class="el" href="struct_io_cmd_1_1_export_level_options.html">ExportLevelOptions</a>(), <a class="el" href="struct_io_cmd_1_1_overwrite_callbacks.html">OverwriteCallbacks</a> *overwriteCB=0, <a class="el" href="struct_io_cmd_1_1_progress_callbacks.html">ProgressCallbacks</a> *progressCB=0)</td></tr>
<tr class="memdesc:a99bbb49fbdaab858ec5310ab8c72521a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exports passed level to the specified path.  <a href="namespace_io_cmd.html#a99bbb49fbdaab858ec5310ab8c72521a">More...</a><br /></td></tr>
<tr class="separator:a99bbb49fbdaab858ec5310ab8c72521a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0744065a16191fcb9785de9edcef0c39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a0744065a16191fcb9785de9edcef0c39">newScene</a> ()</td></tr>
<tr class="separator:a0744065a16191fcb9785de9edcef0c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93737c840f2f6389c72c65e178186fc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#aa93737c840f2f6389c72c65e178186fc">loadScene</a> (<a class="el" href="class_toonz_scene.html">ToonzScene</a> &amp;scene, const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;scenePath, bool import)</td></tr>
<tr class="separator:aa93737c840f2f6389c72c65e178186fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacb798ecd90262670a20d3cdc9730d92"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#aacb798ecd90262670a20d3cdc9730d92">loadScene</a> (const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;scenePath, bool updateRecentFile=true, bool checkSaveOldScene=true)</td></tr>
<tr class="separator:aacb798ecd90262670a20d3cdc9730d92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a576f240ddca3be721c59540731b8547f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a576f240ddca3be721c59540731b8547f">loadScene</a> ()</td></tr>
<tr class="separator:a576f240ddca3be721c59540731b8547f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a869809aa031fe7dccc55472657e459ae"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a869809aa031fe7dccc55472657e459ae">loadSubScene</a> ()</td></tr>
<tr class="separator:a869809aa031fe7dccc55472657e459ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6331f41f6a68e8fac4d25fbf12a9596"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#af6331f41f6a68e8fac4d25fbf12a9596">loadSubScene</a> (const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;scenePath)</td></tr>
<tr class="separator:af6331f41f6a68e8fac4d25fbf12a9596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62f202786d36605ae3e1c4d3b99651a3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a62f202786d36605ae3e1c4d3b99651a3">saveScene</a> (const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;fp, int flags)</td></tr>
<tr class="separator:a62f202786d36605ae3e1c4d3b99651a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7115d1d248236e7274bfe5f947f028a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#aa7115d1d248236e7274bfe5f947f028a">saveScene</a> (int flags=0)</td></tr>
<tr class="separator:aa7115d1d248236e7274bfe5f947f028a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98582f18716776eccfc2332996cd615b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a98582f18716776eccfc2332996cd615b">saveLevel</a> (const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;fp)</td></tr>
<tr class="separator:a98582f18716776eccfc2332996cd615b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1553ac159a224b46c7ab172b048125e9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a1553ac159a224b46c7ab172b048125e9">saveLevel</a> ()</td></tr>
<tr class="separator:a1553ac159a224b46c7ab172b048125e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace7b0a1cc73ddbfc14483d3415609396"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#ace7b0a1cc73ddbfc14483d3415609396">saveLevel</a> (const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;fp, <a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *sl, bool overwrite)</td></tr>
<tr class="separator:ace7b0a1cc73ddbfc14483d3415609396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af73b59e57b994553e045e193655d8a8c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#af73b59e57b994553e045e193655d8a8c">saveLevel</a> (<a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *sl)</td></tr>
<tr class="separator:af73b59e57b994553e045e193655d8a8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7e81603b00421a5921bdf482a458758"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#ac7e81603b00421a5921bdf482a458758">saveAll</a> (int flags=0)</td></tr>
<tr class="separator:ac7e81603b00421a5921bdf482a458758"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1872b1c5260e011f557d45631eed83c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a1872b1c5260e011f557d45631eed83c5">saveNonSceneFiles</a> ()</td></tr>
<tr class="separator:a1872b1c5260e011f557d45631eed83c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e9b7393f785dd784c38efe0788b45a4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a3e9b7393f785dd784c38efe0788b45a4">saveSound</a> (const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;fp, <a class="el" href="class_t_xsh_sound_level.html">TXshSoundLevel</a> *sc, bool overwrite)</td></tr>
<tr class="separator:a3e9b7393f785dd784c38efe0788b45a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d61d8a7c69ed6a011f7addd5adb1390"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a0d61d8a7c69ed6a011f7addd5adb1390">saveSound</a> (<a class="el" href="class_t_xsh_sound_level.html">TXshSoundLevel</a> *sc)</td></tr>
<tr class="separator:a0d61d8a7c69ed6a011f7addd5adb1390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107f6d3100b922e0c09e9b4aa1a8602a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a107f6d3100b922e0c09e9b4aa1a8602a">loadResources</a> (<a class="el" href="struct_io_cmd_1_1_load_resource_arguments.html">LoadResourceArguments</a> &amp;args, bool updateRecentFiles=true, <a class="el" href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html">LoadResourceArguments::ScopedBlock</a> *sb=0)</td></tr>
<tr class="separator:a107f6d3100b922e0c09e9b4aa1a8602a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e4a4aacfc92a744c3eb69ee087946db"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a0e4a4aacfc92a744c3eb69ee087946db">loadResourceFolders</a> (<a class="el" href="struct_io_cmd_1_1_load_resource_arguments.html">LoadResourceArguments</a> &amp;args, <a class="el" href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html">LoadResourceArguments::ScopedBlock</a> *sb=0)</td></tr>
<tr class="separator:a0e4a4aacfc92a744c3eb69ee087946db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a717e5aae0e8ee4b19a6e58cbda8bfecf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a717e5aae0e8ee4b19a6e58cbda8bfecf">exposeLevel</a> (<a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *sl, int row, int col, bool insert=false, bool overWrite=false)</td></tr>
<tr class="separator:a717e5aae0e8ee4b19a6e58cbda8bfecf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1923da5539d48874d2ae236af8462e98"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a1923da5539d48874d2ae236af8462e98">exposeLevel</a> (<a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *sl, int row, int col, const std::vector&lt; <a class="el" href="class_t_frame_id.html">TFrameId</a> &gt; &amp;fids, bool insert=false, bool overWrite=false)</td></tr>
<tr class="separator:a1923da5539d48874d2ae236af8462e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e6da51135e070996c599fe16bd4bbd3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a5e6da51135e070996c599fe16bd4bbd3">saveSceneIfNeeded</a> (QString msg)</td></tr>
<tr class="separator:a5e6da51135e070996c599fe16bd4bbd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfb5ff0c0d7c59bef7802b8ce55d15fc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#abfb5ff0c0d7c59bef7802b8ce55d15fc">exposeComment</a> (int row, int &amp;col, QList&lt; QString &gt; commentList, QString fileName)</td></tr>
<tr class="memdesc:abfb5ff0c0d7c59bef7802b8ce55d15fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create and expose column with comment in <b>commentList</b>.  <a href="namespace_io_cmd.html#abfb5ff0c0d7c59bef7802b8ce55d15fc">More...</a><br /></td></tr>
<tr class="separator:abfb5ff0c0d7c59bef7802b8ce55d15fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2faadbbacdf21975a71dfaaa0f30f6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#a4f2faadbbacdf21975a71dfaaa0f30f6">importLipSync</a> (<a class="el" href="class_t_file_path.html">TFilePath</a> levelPath, QList&lt; <a class="el" href="class_t_frame_id.html">TFrameId</a> &gt; frameList, QList&lt; QString &gt; commentList, QString fileName)</td></tr>
<tr class="separator:a4f2faadbbacdf21975a71dfaaa0f30f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa512f1a040d635719070d84e1fe4e733"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_io_cmd.html#aa512f1a040d635719070d84e1fe4e733">takeCareSceneFolderItemsOnSaveSceneAs</a> (<a class="el" href="class_toonz_scene.html">ToonzScene</a> *scene, const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;newPath, <a class="el" href="class_t_xsheet.html">TXsheet</a> *subxsh, QHash&lt; <a class="el" href="class_t_xsh_level.html">TXshLevel</a> *, <a class="el" href="class_t_file_path.html">TFilePath</a> &gt; &amp;orgLevelPaths)</td></tr>
<tr class="separator:aa512f1a040d635719070d84e1fe4e733"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Contains command functions related to Toonz I/O. <br  />
 </p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a2e85d0d7111af66de5d2ec589939c43a" name="a2e85d0d7111af66de5d2ec589939c43a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e85d0d7111af66de5d2ec589939c43a">&#9670;&nbsp;</a></span>SaveSceneFlags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum IoCmd::SaveSceneFlags</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  186</span>                    {</div>
<div class="line"><span class="lineno">  187</span>  SILENTLY_OVERWRITE = 0x1,</div>
<div class="line"><span class="lineno">  188</span>  SAVE_SUBXSHEET     = 0x2,</div>
<div class="line"><span class="lineno">  189</span>  AUTO_SAVE          = 0x4</div>
<div class="line"><span class="lineno">  190</span>};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="afbfa3598864913d35bef6b4cb75c1e45" name="afbfa3598864913d35bef6b4cb75c1e45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbfa3598864913d35bef6b4cb75c1e45">&#9670;&nbsp;</a></span>exportedImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_smart_pointer_t.html">TImageP</a> IoCmd::exportedImage </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>sl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_frame_id.html">TFrameId</a> &amp;&#160;</td>
          <td class="paramname"><em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_io_cmd_1_1_export_level_options.html">ExportLevelOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em> = <code><a class="el" href="struct_io_cmd_1_1_export_level_options.html">ExportLevelOptions</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Intended for preview purposes, computes the image that will be exported by the <a class="el" href="namespace_io_cmd.html#a99bbb49fbdaab858ec5310ab8c72521a" title="Exports passed level to the specified path.">exportLevel()</a> command. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Supplied image <em>may</em> be the one retrievable by sl, depending on whether the specified options require it to be modified.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The image that will be exported by the <a class="el" href="namespace_io_cmd.html#a99bbb49fbdaab858ec5310ab8c72521a" title="Exports passed level to the specified path.">exportLevel()</a> command. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ext</td><td>File extension - like <em>tga</em>, <em>tlv</em>, <em>png</em>, etc... </td></tr>
    <tr><td class="paramname">sl</td><td>Level host of the image to be exported. </td></tr>
    <tr><td class="paramname">fid</td><td>Frame of the image in sl. </td></tr>
    <tr><td class="paramname">opts</td><td>Export options. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  397</span>                                                             {</div>
<div class="line"><span class="lineno">  398</span>  ImageExporter exporter(sl, opts);</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>  <span class="keywordflow">return</span> exporter.exportedImage(fid, (ext == <span class="stringliteral">&quot;tlv&quot;</span>) ? TZP_TYPE : OVL_TYPE);</div>
<div class="line"><span class="lineno">  401</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a99bbb49fbdaab858ec5310ab8c72521a" name="a99bbb49fbdaab858ec5310ab8c72521a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99bbb49fbdaab858ec5310ab8c72521a">&#9670;&nbsp;</a></span>exportLevel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::exportLevel </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *&#160;</td>
          <td class="paramname"><em>sl</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_io_cmd_1_1_export_level_options.html">ExportLevelOptions</a>&#160;</td>
          <td class="paramname"><em>opts</em> = <code><a class="el" href="struct_io_cmd_1_1_export_level_options.html">ExportLevelOptions</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_io_cmd_1_1_overwrite_callbacks.html">OverwriteCallbacks</a> *&#160;</td>
          <td class="paramname"><em>overwriteCB</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_io_cmd_1_1_progress_callbacks.html">ProgressCallbacks</a> *&#160;</td>
          <td class="paramname"><em>progressCB</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exports passed level to the specified path. </p>
<dl class="section return"><dt>Returns</dt><dd>Whether the level was successfully exported <em>in its entirety</em>. User cancels are reported as failures, even if a part of the level has been successfully exported.</dd></dl>
<p>This function performs level export depending on the specified path's extension, and optional parameters. If no input level is specified for the export, this function attempts the export of currently active level (if any).</p>
<p >This function allows external callbacks to deal with overwrite and progress notifications. If no callback is supplied to the function, default ones will be used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>File path to export the level to. </td></tr>
    <tr><td class="paramname">sl</td><td>Level to export; if <code>0</code>, current level will be used. </td></tr>
    <tr><td class="paramname">opts</td><td>Export options. </td></tr>
    <tr><td class="paramname">overwriteCB</td><td>External callbacks to overwrite requests. </td></tr>
    <tr><td class="paramname">progressCB</td><td>External callbacks to progress notifications. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  416</span>                                                       {</div>
<div class="line"><span class="lineno">  417</span>  <span class="keyword">struct </span>Locals {</div>
<div class="line"><span class="lineno">  418</span>    <span class="keyword">const</span> <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> &amp;m_path;</div>
<div class="line"><span class="lineno">  419</span>    <a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *m_sl;</div>
<div class="line"><span class="lineno">  420</span>    <span class="keyword">const</span> <a class="code hl_struct" href="struct_io_cmd_1_1_export_level_options.html">ExportLevelOptions</a> &amp;m_opts;</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>    <a class="code hl_struct" href="struct_io_cmd_1_1_overwrite_callbacks.html">OverwriteCallbacks</a> *m_overwriteCB;</div>
<div class="line"><span class="lineno">  423</span>    <a class="code hl_struct" href="struct_io_cmd_1_1_progress_callbacks.html">ProgressCallbacks</a> *m_progressCB;</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordtype">bool</span> exportToMultifile() {</div>
<div class="line"><span class="lineno">  426</span>      ImageExporter exporter(*m_sl, m_opts);</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>      TXshLevelType outputLevelType =</div>
<div class="line"><span class="lineno">  429</span>          (m_path.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() == <span class="stringliteral">&quot;tlv&quot;</span>) ? TZP_TYPE : OVL_TYPE;</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>      <span class="keywordtype">bool</span> firstTime = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  432</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m_sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a3fe127306d6669a3eb9e9d8802660d7b">getFrameCount</a>(); ++i) {</div>
<div class="line"><span class="lineno">  433</span>        <span class="keywordflow">if</span> (m_progressCB-&gt;canceled()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>        <span class="comment">// Prepare frame export path</span></div>
<div class="line"><span class="lineno">  436</span>        <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> fpout;</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>        <span class="keywordflow">if</span> (m_opts.<a class="code hl_variable" href="struct_io_cmd_1_1_export_level_options.html#ad03d9f575e978f592f7793d3be93b500">m_forRetas</a>) {</div>
<div class="line"><span class="lineno">  439</span>          QString pathOut =</div>
<div class="line"><span class="lineno">  440</span>              QString::fromStdWString(m_path.<a class="code hl_function" href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">getParentDir</a>().getWideString()) +</div>
<div class="line"><span class="lineno">  441</span>              <span class="stringliteral">&quot;\\&quot;</span> + QString::fromStdString(m_path.<a class="code hl_function" href="class_t_file_path.html#af94f9b0aeceb6cdb980fa1789473503a">getName</a>()) +</div>
<div class="line"><span class="lineno">  442</span>              QString::fromStdString(m_sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a07279a40ffad2c6ccc597c0a418f78fb">index2fid</a>(i).expand()) + <span class="stringliteral">&quot;.&quot;</span> +</div>
<div class="line"><span class="lineno">  443</span>              QString::fromStdString(m_path.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>());</div>
<div class="line"><span class="lineno">  444</span>          fpout = <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>(pathOut.toStdString());</div>
<div class="line"><span class="lineno">  445</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  446</span>          fpout = <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>(m_path.<a class="code hl_function" href="class_t_file_path.html#a12f35b225e1882372ad7e02ad7fce543">withFrame</a>(m_sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a07279a40ffad2c6ccc597c0a418f78fb">index2fid</a>(i)));</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>        <span class="comment">// Ask for overwrite permission in case a level with the built path</span></div>
<div class="line"><span class="lineno">  449</span>        <span class="comment">// already exists</span></div>
<div class="line"><span class="lineno">  450</span>        <span class="keywordflow">if</span> (firstTime) {</div>
<div class="line"><span class="lineno">  451</span>          firstTime = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>          <span class="keywordflow">if</span> (TSystem::doesExistFileOrLevel(fpout)) {</div>
<div class="line"><span class="lineno">  454</span>            QApplication::restoreOverrideCursor();</div>
<div class="line"><span class="lineno">  455</span>            <span class="keywordtype">bool</span> overwrite = m_overwriteCB-&gt;<a class="code hl_function" href="struct_io_cmd_1_1_overwrite_callbacks.html#a38783ba3d36c85d69e87faaf13f38d30">overwriteRequest</a>(fpout);</div>
<div class="line"><span class="lineno">  456</span>            QApplication::setOverrideCursor(Qt::WaitCursor);</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>            <span class="keywordflow">if</span> (!overwrite) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  459</span>          }</div>
<div class="line"><span class="lineno">  460</span>        }</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>        <span class="comment">// Retrieve the image to export at current frame</span></div>
<div class="line"><span class="lineno">  463</span>        <a class="code hl_class" href="class_t_smart_pointer_t.html">TImageP</a> img =</div>
<div class="line"><span class="lineno">  464</span>            exporter.exportedImage(m_sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a07279a40ffad2c6ccc597c0a418f78fb">index2fid</a>(i), outputLevelType);</div>
<div class="line"><span class="lineno">  465</span>        assert(img);</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>        <span class="comment">// Save the prepared fullcolor image to file</span></div>
<div class="line"><span class="lineno">  468</span>        <a class="code hl_class" href="class_t_image_writer.html">TImageWriter</a> iw(fpout);</div>
<div class="line"><span class="lineno">  469</span>        iw.setProperties(m_opts.<a class="code hl_variable" href="struct_io_cmd_1_1_export_level_options.html#a7037b7cdde2fb931afd66ff9392fab13">m_props</a>);</div>
<div class="line"><span class="lineno">  470</span>        iw.save(img);</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>        m_progressCB-&gt;setValue(i + 1);</div>
<div class="line"><span class="lineno">  473</span>      }</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  476</span>    }</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>    <span class="keywordtype">bool</span> exportToTlv() {</div>
<div class="line"><span class="lineno">  479</span>      <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> fp(m_path.withNoFrame());</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>      <span class="comment">// Remove any existing level</span></div>
<div class="line"><span class="lineno">  482</span>      <span class="keywordflow">if</span> (TSystem::doesExistFileOrLevel(fp)) {</div>
<div class="line"><span class="lineno">  483</span>        <span class="keywordtype">bool</span> overwrite = m_overwriteCB-&gt;<a class="code hl_function" href="struct_io_cmd_1_1_overwrite_callbacks.html#a38783ba3d36c85d69e87faaf13f38d30">overwriteRequest</a>(fp);</div>
<div class="line"><span class="lineno">  484</span>        <span class="keywordflow">if</span> (!overwrite) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>        TSystem::deleteFile(fp);</div>
<div class="line"><span class="lineno">  487</span>      }</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>      TSystem::removeFileOrLevel(fp.withType(<span class="stringliteral">&quot;tpl&quot;</span>));</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>      <span class="comment">// Export level</span></div>
<div class="line"><span class="lineno">  492</span>      <a class="code hl_class" href="class_t_level_writer_p.html">TLevelWriterP</a> lw(fp);</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>      ImageExporter exporter(*m_sl, m_opts);</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m_sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a3fe127306d6669a3eb9e9d8802660d7b">getFrameCount</a>(); ++i) {</div>
<div class="line"><span class="lineno">  497</span>        <span class="keywordflow">if</span> (m_progressCB-&gt;canceled()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>        <span class="keyword">const</span> <a class="code hl_class" href="class_t_frame_id.html">TFrameId</a> &amp;fid = m_sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a07279a40ffad2c6ccc597c0a418f78fb">index2fid</a>(i);</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>        <a class="code hl_class" href="class_t_smart_pointer_t.html">TImageP</a> img = exporter.exportedImage(fid, TZP_TYPE);</div>
<div class="line"><span class="lineno">  502</span>        assert(img);</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>        lw-&gt;getFrameWriter(fid)-&gt;save(img);</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>        m_progressCB-&gt;setValue(i + 1);</div>
<div class="line"><span class="lineno">  507</span>      }</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  510</span>    }</div>
<div class="line"><span class="lineno">  511</span>  };  <span class="comment">// Locals</span></div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>  <span class="comment">// Use default values in case some were not specified by input</span></div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>  <span class="comment">// Level</span></div>
<div class="line"><span class="lineno">  516</span>  <span class="keywordflow">if</span> (!sl) {</div>
<div class="line"><span class="lineno">  517</span>    sl = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>()-&gt;getSimpleLevel();</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>    <span class="keywordflow">if</span> (!sl) {</div>
<div class="line"><span class="lineno">  520</span>      DVGui::error(QObject::tr(<span class="stringliteral">&quot;No level selected!&quot;</span>));</div>
<div class="line"><span class="lineno">  521</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  522</span>    }</div>
<div class="line"><span class="lineno">  523</span>  }</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>  <span class="keywordflow">if</span> (sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a7c256d2745209a181a2dbccdec949c5e">isEmpty</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>  <span class="comment">// Output properties</span></div>
<div class="line"><span class="lineno">  528</span>  <span class="keywordflow">if</span> (!opts.<a class="code hl_variable" href="struct_io_cmd_1_1_export_level_options.html#a7037b7cdde2fb931afd66ff9392fab13">m_props</a>) {</div>
<div class="line"><span class="lineno">  529</span>    <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a> *scene = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;getScene();</div>
<div class="line"><span class="lineno">  530</span>    opts.<a class="code hl_variable" href="struct_io_cmd_1_1_export_level_options.html#a7037b7cdde2fb931afd66ff9392fab13">m_props</a> =</div>
<div class="line"><span class="lineno">  531</span>        scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a8ef96fedc17d7def810ac419b0939254">getProperties</a>()-&gt;<a class="code hl_function" href="class_t_scene_properties.html#abea7b4b8e4f0cedbf753b26ec30b5331">getOutputProperties</a>()-&gt;<a class="code hl_function" href="class_t_output_properties.html#a9ef174e6f6239219fa563b037246c8d4">getFileFormatProperties</a>(</div>
<div class="line"><span class="lineno">  532</span>            path.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>());</div>
<div class="line"><span class="lineno">  533</span>  }</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>  <span class="comment">// Camera (todo)</span></div>
<div class="line"><span class="lineno">  536</span>  assert(opts.<a class="code hl_variable" href="struct_io_cmd_1_1_export_level_options.html#a8df94678a4989d05c5d59b564bd8d603">m_camera</a>.<a class="code hl_function" href="class_t_camera.html#a9a7c573e7a2c397ffae4b747809ea2a5">getRes</a>().lx &gt; 0 &amp;&amp; opts.<a class="code hl_variable" href="struct_io_cmd_1_1_export_level_options.html#a8df94678a4989d05c5d59b564bd8d603">m_camera</a>.<a class="code hl_function" href="class_t_camera.html#a9a7c573e7a2c397ffae4b747809ea2a5">getRes</a>().ly &gt; 0);</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>  <span class="comment">// Callbacks</span></div>
<div class="line"><span class="lineno">  539</span>  std::unique_ptr&lt;OverwriteCallbacks&gt; overwriteDefault(</div>
<div class="line"><span class="lineno">  540</span>      overwriteCB ? 0 : (overwriteCB = <span class="keyword">new</span> ExportOverwriteCB()));</div>
<div class="line"><span class="lineno">  541</span>  std::unique_ptr&lt;ProgressCallbacks&gt; progressDefault(</div>
<div class="line"><span class="lineno">  542</span>      progressCB ? 0 : (progressCB = <span class="keyword">new</span> ExportProgressCB()));</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>  <span class="comment">// Initialize variables</span></div>
<div class="line"><span class="lineno">  545</span>  Locals locals = {path, sl, opts, overwriteCB, progressCB};</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>  progressCB-&gt;setProcessedName(QString::fromStdWString(path.getWideString()));</div>
<div class="line"><span class="lineno">  548</span>  progressCB-&gt;setRange(0, sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a3fe127306d6669a3eb9e9d8802660d7b">getFrameCount</a>());</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span>  <span class="comment">// Export level</span></div>
<div class="line"><span class="lineno">  551</span>  BusyCursorOverride cursorOverride;</div>
<div class="line"><span class="lineno">  552</span>  QCoreApplication::processEvents();  <span class="comment">// Refresh screen.   ...But WHY is this</span></div>
<div class="line"><span class="lineno">  553</span>                                      <span class="comment">//                      necessary?</span></div>
<div class="line"><span class="lineno">  554</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  555</span>    <span class="keywordflow">return</span> (path.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() == <span class="stringliteral">&quot;tlv&quot;</span>) ? assert(sl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() == PLI_XSHLEVEL),</div>
<div class="line"><span class="lineno">  556</span>           locals.exportToTlv() : locals.exportToMultifile();</div>
<div class="line"><span class="lineno">  557</span>  } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  559</span>  }</div>
<div class="line"><span class="lineno">  560</span>}</div>
<div class="ttc" id="aclass_t_app_html_a24088f8647d5d9447fcec6b9b9bbf9eb"><div class="ttname"><a href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a></div><div class="ttdeci">static TApp * instance()</div><div class="ttdef"><b>Definition:</b> tapp.cpp:215</div></div>
<div class="ttc" id="aclass_t_app_html_abbbf1fae564e9e510826eda4f6637d20"><div class="ttname"><a href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">TApp::getCurrentScene</a></div><div class="ttdeci">TSceneHandle * getCurrentScene() const override</div><div class="ttdef"><b>Definition:</b> tapp.h:106</div></div>
<div class="ttc" id="aclass_t_app_html_ad2923c9feaaa44ecd9cdd0fa029aa8aa"><div class="ttname"><a href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">TApp::getCurrentLevel</a></div><div class="ttdeci">TXshLevelHandle * getCurrentLevel() const override</div><div class="ttdef"><b>Definition:</b> tapp.h:122</div></div>
<div class="ttc" id="aclass_t_camera_html_a9a7c573e7a2c397ffae4b747809ea2a5"><div class="ttname"><a href="class_t_camera.html#a9a7c573e7a2c397ffae4b747809ea2a5">TCamera::getRes</a></div><div class="ttdeci">const TDimension &amp; getRes() const</div><div class="ttdef"><b>Definition:</b> tcamera.h:72</div></div>
<div class="ttc" id="aclass_t_file_path_html"><div class="ttname"><a href="class_t_file_path.html">TFilePath</a></div><div class="ttdef"><b>Definition:</b> tfilepath.h:134</div></div>
<div class="ttc" id="aclass_t_file_path_html_a12f35b225e1882372ad7e02ad7fce543"><div class="ttname"><a href="class_t_file_path.html#a12f35b225e1882372ad7e02ad7fce543">TFilePath::withFrame</a></div><div class="ttdeci">TFilePath withFrame(const TFrameId &amp;frame, TFrameId::FrameFormat format=TFrameId::USE_CURRENT_FORMAT) const</div><div class="ttdef"><b>Definition:</b> tfilepath.cpp:860</div></div>
<div class="ttc" id="aclass_t_file_path_html_a1f5014e9c396bc2268820c19bc15657d"><div class="ttname"><a href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">TFilePath::getParentDir</a></div><div class="ttdeci">TFilePath getParentDir() const</div><div class="ttdef"><b>Definition:</b> tfilepath.cpp:683</div></div>
<div class="ttc" id="aclass_t_file_path_html_aefca624df1a5468a4c78ec6d5dbfae26"><div class="ttname"><a href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">TFilePath::getType</a></div><div class="ttdeci">std::string getType() const</div><div class="ttdef"><b>Definition:</b> tfilepath.h:225</div></div>
<div class="ttc" id="aclass_t_file_path_html_af94f9b0aeceb6cdb980fa1789473503a"><div class="ttname"><a href="class_t_file_path.html#af94f9b0aeceb6cdb980fa1789473503a">TFilePath::getName</a></div><div class="ttdeci">std::string getName() const</div><div class="ttdef"><b>Definition:</b> tfilepath.cpp:636</div></div>
<div class="ttc" id="aclass_t_frame_id_html"><div class="ttname"><a href="class_t_frame_id.html">TFrameId</a></div><div class="ttdef"><b>Definition:</b> tfilepath.h:29</div></div>
<div class="ttc" id="aclass_t_image_writer_html"><div class="ttname"><a href="class_t_image_writer.html">TImageWriter</a></div><div class="ttdef"><b>Definition:</b> timage_io.h:205</div></div>
<div class="ttc" id="aclass_t_level_writer_p_html"><div class="ttname"><a href="class_t_level_writer_p.html">TLevelWriterP</a></div><div class="ttdef"><b>Definition:</b> tlevel_io.h:214</div></div>
<div class="ttc" id="aclass_t_output_properties_html_a9ef174e6f6239219fa563b037246c8d4"><div class="ttname"><a href="class_t_output_properties.html#a9ef174e6f6239219fa563b037246c8d4">TOutputProperties::getFileFormatProperties</a></div><div class="ttdeci">TPropertyGroup * getFileFormatProperties(std::string ext)</div><div class="ttdef"><b>Definition:</b> outputproperties.cpp:156</div></div>
<div class="ttc" id="aclass_t_scene_properties_html_abea7b4b8e4f0cedbf753b26ec30b5331"><div class="ttname"><a href="class_t_scene_properties.html#abea7b4b8e4f0cedbf753b26ec30b5331">TSceneProperties::getOutputProperties</a></div><div class="ttdeci">TOutputProperties * getOutputProperties() const</div><div class="ttdef"><b>Definition:</b> sceneproperties.h:145</div></div>
<div class="ttc" id="aclass_t_smart_pointer_t_html"><div class="ttname"><a href="class_t_smart_pointer_t.html">TSmartPointerT&lt; TImage &gt;</a></div></div>
<div class="ttc" id="aclass_t_xsh_level_html_a1a147f1e970a62120c0bbaf0020a8932"><div class="ttname"><a href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">TXshLevel::getType</a></div><div class="ttdeci">int getType() const</div><div class="ttdef"><b>Definition:</b> txshlevel.h:81</div></div>
<div class="ttc" id="aclass_t_xsh_simple_level_html"><div class="ttname"><a href="class_t_xsh_simple_level.html">TXshSimpleLevel</a></div><div class="ttdoc">The TXshLevel specialization for image levels.</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.h:60</div></div>
<div class="ttc" id="aclass_t_xsh_simple_level_html_a07279a40ffad2c6ccc597c0a418f78fb"><div class="ttname"><a href="class_t_xsh_simple_level.html#a07279a40ffad2c6ccc597c0a418f78fb">TXshSimpleLevel::index2fid</a></div><div class="ttdeci">TFrameId index2fid(int index) const</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.cpp:544</div></div>
<div class="ttc" id="aclass_t_xsh_simple_level_html_a3fe127306d6669a3eb9e9d8802660d7b"><div class="ttname"><a href="class_t_xsh_simple_level.html#a3fe127306d6669a3eb9e9d8802660d7b">TXshSimpleLevel::getFrameCount</a></div><div class="ttdeci">int getFrameCount() const override</div><div class="ttdoc">Returns the level's frames count.</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.h:158</div></div>
<div class="ttc" id="aclass_t_xsh_simple_level_html_a7c256d2745209a181a2dbccdec949c5e"><div class="ttname"><a href="class_t_xsh_simple_level.html#a7c256d2745209a181a2dbccdec949c5e">TXshSimpleLevel::isEmpty</a></div><div class="ttdeci">bool isEmpty() const override</div><div class="ttdoc">Returns whether the level is empty.</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.h:147</div></div>
<div class="ttc" id="aclass_toonz_scene_html"><div class="ttname"><a href="class_toonz_scene.html">ToonzScene</a></div><div class="ttdef"><b>Definition:</b> toonzscene.h:42</div></div>
<div class="ttc" id="aclass_toonz_scene_html_a8ef96fedc17d7def810ac419b0939254"><div class="ttname"><a href="class_toonz_scene.html#a8ef96fedc17d7def810ac419b0939254">ToonzScene::getProperties</a></div><div class="ttdeci">TSceneProperties * getProperties() const</div><div class="ttdoc">&lt; Returns a pointer to the scene's properties.</div><div class="ttdef"><b>Definition:</b> toonzscene.h:87</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_export_level_options_html"><div class="ttname"><a href="struct_io_cmd_1_1_export_level_options.html">IoCmd::ExportLevelOptions</a></div><div class="ttdoc">Collection of options accepted by the export level command.</div><div class="ttdef"><b>Definition:</b> exportlevelcommand.h:62</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_export_level_options_html_a7037b7cdde2fb931afd66ff9392fab13"><div class="ttname"><a href="struct_io_cmd_1_1_export_level_options.html#a7037b7cdde2fb931afd66ff9392fab13">IoCmd::ExportLevelOptions::m_props</a></div><div class="ttdeci">const TPropertyGroup * m_props</div><div class="ttdoc">File Format Properties for the export.</div><div class="ttdef"><b>Definition:</b> exportlevelcommand.h:63</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_export_level_options_html_a8df94678a4989d05c5d59b564bd8d603"><div class="ttname"><a href="struct_io_cmd_1_1_export_level_options.html#a8df94678a4989d05c5d59b564bd8d603">IoCmd::ExportLevelOptions::m_camera</a></div><div class="ttdeci">TCamera m_camera</div><div class="ttdoc">Stores field and resolution settings for PLI exports.</div><div class="ttdef"><b>Definition:</b> exportlevelcommand.h:66</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_export_level_options_html_ad03d9f575e978f592f7793d3be93b500"><div class="ttname"><a href="struct_io_cmd_1_1_export_level_options.html#ad03d9f575e978f592f7793d3be93b500">IoCmd::ExportLevelOptions::m_forRetas</a></div><div class="ttdeci">bool m_forRetas</div><div class="ttdef"><b>Definition:</b> exportlevelcommand.h:76</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_overwrite_callbacks_html"><div class="ttname"><a href="struct_io_cmd_1_1_overwrite_callbacks.html">IoCmd::OverwriteCallbacks</a></div><div class="ttdef"><b>Definition:</b> exportlevelcommand.h:36</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_overwrite_callbacks_html_a38783ba3d36c85d69e87faaf13f38d30"><div class="ttname"><a href="struct_io_cmd_1_1_overwrite_callbacks.html#a38783ba3d36c85d69e87faaf13f38d30">IoCmd::OverwriteCallbacks::overwriteRequest</a></div><div class="ttdeci">virtual bool overwriteRequest(const TFilePath &amp;fp)=0</div><div class="ttdoc">Returns whether an overwrite must be performed.</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_progress_callbacks_html"><div class="ttname"><a href="struct_io_cmd_1_1_progress_callbacks.html">IoCmd::ProgressCallbacks</a></div><div class="ttdef"><b>Definition:</b> exportlevelcommand.h:45</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00122">TApp::getCurrentLevel()</a>, <a class="el" href="#l00106">TApp::getCurrentScene()</a>, <a class="el" href="#l00156">TOutputProperties::getFileFormatProperties()</a>, <a class="el" href="#l00158">TXshSimpleLevel::getFrameCount()</a>, <a class="el" href="#l00636">TFilePath::getName()</a>, <a class="el" href="#l00145">TSceneProperties::getOutputProperties()</a>, <a class="el" href="#l00683">TFilePath::getParentDir()</a>, <a class="el" href="#l00087">ToonzScene::getProperties()</a>, <a class="el" href="#l00072">TCamera::getRes()</a>, <a class="el" href="#l00225">TFilePath::getType()</a>, <a class="el" href="#l00081">TXshLevel::getType()</a>, <a class="el" href="#l00544">TXshSimpleLevel::index2fid()</a>, <a class="el" href="#l00215">TApp::instance()</a>, <a class="el" href="#l00147">TXshSimpleLevel::isEmpty()</a>, <a class="el" href="#l00066">IoCmd::ExportLevelOptions::m_camera</a>, <a class="el" href="#l00076">IoCmd::ExportLevelOptions::m_forRetas</a>, <a class="el" href="#l00063">IoCmd::ExportLevelOptions::m_props</a>, <a class="el" href="struct_io_cmd_1_1_overwrite_callbacks.html#a38783ba3d36c85d69e87faaf13f38d30">IoCmd::OverwriteCallbacks::overwriteRequest()</a>, <a class="el" href="#l00860">TFilePath::withFrame()</a>, and <a class="el" href="#l00774">TFilePath::withType()</a>.</p>

<p class="reference">Referenced by <a class="el" href="#l00610">ExportLevelPopup::execute()</a>.</p>

</div>
</div>
<a id="abfb5ff0c0d7c59bef7802b8ce55d15fc" name="abfb5ff0c0d7c59bef7802b8ce55d15fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfb5ff0c0d7c59bef7802b8ce55d15fc">&#9670;&nbsp;</a></span>exposeComment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::exposeComment </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QList&lt; QString &gt;&#160;</td>
          <td class="paramname"><em>commentList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>fileName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create and expose column with comment in <b>commentList</b>. </p>
<div class="fragment"><div class="line"><span class="lineno"> 2647</span>                                            {</div>
<div class="line"><span class="lineno"> 2648</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app                         = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 2649</span>  <a class="code hl_class" href="class_t_xsheet.html">TXsheet</a> *xsh                      = app-&gt;<a class="code hl_function" href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">getCurrentXsheet</a>()-&gt;getXsheet();</div>
<div class="line"><span class="lineno"> 2650</span>  <a class="code hl_class" href="class_t_xsh_sound_text_column.html">TXshSoundTextColumn</a> *textSoundCol = <span class="keyword">new</span> <a class="code hl_class" href="class_t_xsh_sound_text_column.html">TXshSoundTextColumn</a>();</div>
<div class="line"><span class="lineno"> 2651</span>  textSoundCol-&gt;<a class="code hl_function" href="class_t_xsh_column.html#ad4badbad6279671e8a42037873647de9">setXsheet</a>(xsh);</div>
<div class="line"><span class="lineno"> 2652</span>  textSoundCol-&gt;createSoundTextLevel(row, commentList);</div>
<div class="line"><span class="lineno"> 2653</span>  <span class="keywordtype">bool</span> columnInserted = beforeCellsInsert(xsh, row, col, commentList.size(),</div>
<div class="line"><span class="lineno"> 2654</span>                                          TXshColumn::eSoundTextType);</div>
<div class="line"><span class="lineno"> 2655</span>  xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#a5ea42662e27e52ef36ce77b4a5d8e06c">insertColumn</a>(col, textSoundCol);</div>
<div class="line"><span class="lineno"> 2656</span> </div>
<div class="line"><span class="lineno"> 2657</span>  <span class="comment">// Setto il nome di dafult della colonna al nome del file magpie.</span></div>
<div class="line"><span class="lineno"> 2658</span>  <a class="code hl_class" href="class_t_stage_object.html">TStageObject</a> *obj = xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#a13d9b9c08ca8dde39769f5644e046ee5">getStageObject</a>(TStageObjectId::ColumnId(col));</div>
<div class="line"><span class="lineno"> 2659</span>  std::string str   = fileName.toStdString();</div>
<div class="line"><span class="lineno"> 2660</span>  obj-&gt;setName(str);</div>
<div class="line"><span class="lineno"> 2661</span> </div>
<div class="line"><span class="lineno"> 2662</span>  TUndoManager::manager()-&gt;add(</div>
<div class="line"><span class="lineno"> 2663</span>      <span class="keyword">new</span> ExposeCommentUndo(textSoundCol, col, columnInserted, fileName));</div>
<div class="line"><span class="lineno"> 2664</span> </div>
<div class="line"><span class="lineno"> 2665</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2666</span>}</div>
<div class="ttc" id="aclass_t_app_html"><div class="ttname"><a href="class_t_app.html">TApp</a></div><div class="ttdoc">This is the instance of the main application.</div><div class="ttdef"><b>Definition:</b> tapp.h:66</div></div>
<div class="ttc" id="aclass_t_app_html_a13f509e753824cb0500787f68bb51a09"><div class="ttname"><a href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">TApp::getCurrentXsheet</a></div><div class="ttdeci">TXsheetHandle * getCurrentXsheet() const override</div><div class="ttdef"><b>Definition:</b> tapp.h:110</div></div>
<div class="ttc" id="aclass_t_stage_object_html"><div class="ttname"><a href="class_t_stage_object.html">TStageObject</a></div><div class="ttdef"><b>Definition:</b> tstageobject.h:95</div></div>
<div class="ttc" id="aclass_t_xsh_column_html_ad4badbad6279671e8a42037873647de9"><div class="ttname"><a href="class_t_xsh_column.html#ad4badbad6279671e8a42037873647de9">TXshColumn::setXsheet</a></div><div class="ttdeci">virtual void setXsheet(TXsheet *xsheet)</div><div class="ttdef"><b>Definition:</b> txshcolumn.h:232</div></div>
<div class="ttc" id="aclass_t_xsh_sound_text_column_html"><div class="ttname"><a href="class_t_xsh_sound_text_column.html">TXshSoundTextColumn</a></div><div class="ttdef"><b>Definition:</b> txshsoundtextcolumn.h:27</div></div>
<div class="ttc" id="aclass_t_xsheet_html"><div class="ttname"><a href="class_t_xsheet.html">TXsheet</a></div><div class="ttdef"><b>Definition:</b> txsheet.h:132</div></div>
<div class="ttc" id="aclass_t_xsheet_html_a13d9b9c08ca8dde39769f5644e046ee5"><div class="ttname"><a href="class_t_xsheet.html#a13d9b9c08ca8dde39769f5644e046ee5">TXsheet::getStageObject</a></div><div class="ttdeci">TStageObject * getStageObject(const TStageObjectId &amp;id) const</div><div class="ttdef"><b>Definition:</b> txsheet.cpp:542</div></div>
<div class="ttc" id="aclass_t_xsheet_html_a5ea42662e27e52ef36ce77b4a5d8e06c"><div class="ttname"><a href="class_t_xsheet.html#a5ea42662e27e52ef36ce77b4a5d8e06c">TXsheet::insertColumn</a></div><div class="ttdeci">void insertColumn(int index, TXshColumn::ColumnType type=TXshColumn::eLevelType)</div><div class="ttdef"><b>Definition:</b> txsheet.cpp:1324</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00110">TApp::getCurrentXsheet()</a>, <a class="el" href="#l00542">TXsheet::getStageObject()</a>, <a class="el" href="#l01324">TXsheet::insertColumn()</a>, <a class="el" href="#l00215">TApp::instance()</a>, and <a class="el" href="#l00232">TXshColumn::setXsheet()</a>.</p>

</div>
</div>
<a id="a717e5aae0e8ee4b19a6e58cbda8bfecf" name="a717e5aae0e8ee4b19a6e58cbda8bfecf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a717e5aae0e8ee4b19a6e58cbda8bfecf">&#9670;&nbsp;</a></span>exposeLevel() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::exposeLevel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *&#160;</td>
          <td class="paramname"><em>sl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>insert</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>overWrite</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2604</span>                                        {</div>
<div class="line"><span class="lineno"> 2605</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app    = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 2606</span>  <a class="code hl_class" href="class_t_xsheet.html">TXsheet</a> *xsh = app-&gt;<a class="code hl_function" href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">getCurrentXsheet</a>()-&gt;getXsheet();</div>
<div class="line"><span class="lineno"> 2607</span>  assert(xsh);</div>
<div class="line"><span class="lineno"> 2608</span>  std::vector&lt;TFrameId&gt; fids;</div>
<div class="line"><span class="lineno"> 2609</span>  sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a567daee4ca12a0e92445bcf98a6541f1">getFids</a>(fids);</div>
<div class="line"><span class="lineno"> 2610</span>  <span class="keywordflow">return</span> exposeLevel(sl, row, col, fids, insert, overWrite);</div>
<div class="line"><span class="lineno"> 2611</span>}</div>
<div class="ttc" id="aclass_t_xsh_simple_level_html_a567daee4ca12a0e92445bcf98a6541f1"><div class="ttname"><a href="class_t_xsh_simple_level.html#a567daee4ca12a0e92445bcf98a6541f1">TXshSimpleLevel::getFids</a></div><div class="ttdeci">std::vector&lt; TFrameId &gt; getFids() const</div><div class="ttdoc">Returns a copy of the level's frame ids.</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.cpp:448</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1923da5539d48874d2ae236af8462e98" name="a1923da5539d48874d2ae236af8462e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1923da5539d48874d2ae236af8462e98">&#9670;&nbsp;</a></span>exposeLevel() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::exposeLevel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *&#160;</td>
          <td class="paramname"><em>sl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="class_t_frame_id.html">TFrameId</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>fids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>insert</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>overWrite</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2619</span>                                        {</div>
<div class="line"><span class="lineno"> 2620</span>  assert(sl);</div>
<div class="line"><span class="lineno"> 2621</span> </div>
<div class="line"><span class="lineno"> 2622</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app    = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 2623</span>  <a class="code hl_class" href="class_t_xsheet.html">TXsheet</a> *xsh = app-&gt;<a class="code hl_function" href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">getCurrentXsheet</a>()-&gt;getXsheet();</div>
<div class="line"><span class="lineno"> 2624</span>  assert(xsh);</div>
<div class="line"><span class="lineno"> 2625</span>  <span class="keywordtype">int</span> frameCount         = fids.size();</div>
<div class="line"><span class="lineno"> 2626</span>  <span class="keywordtype">bool</span> insertEmptyColumn = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2627</span>  <span class="keywordflow">if</span> (!insert &amp;&amp; !overWrite)</div>
<div class="line"><span class="lineno"> 2628</span>    insertEmptyColumn = beforeCellsInsert(</div>
<div class="line"><span class="lineno"> 2629</span>        xsh, row, col, fids.size(), <a class="code hl_function" href="class_t_xsh_column.html#ae8f60aa38588cfb590725ce632ee6d02">TXshColumn::toColumnType</a>(sl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>()));</div>
<div class="line"><span class="lineno"> 2630</span>  ExposeType type = eNone;</div>
<div class="line"><span class="lineno"> 2631</span>  <span class="keywordflow">if</span> (insert) type = eShiftCells;</div>
<div class="line"><span class="lineno"> 2632</span>  <span class="keywordflow">if</span> (overWrite) type = eOverWrite;</div>
<div class="line"><span class="lineno"> 2633</span>  ExposeLevelUndo *undo =</div>
<div class="line"><span class="lineno"> 2634</span>      <span class="keyword">new</span> ExposeLevelUndo(sl, row, col, frameCount, insertEmptyColumn, type);</div>
<div class="line"><span class="lineno"> 2635</span>  xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#ad2812514a3f36e1a61cbf71aa7f21cd5">exposeLevel</a>(row, col, sl, fids, overWrite);</div>
<div class="line"><span class="lineno"> 2636</span>  undo-&gt;setFids(fids);</div>
<div class="line"><span class="lineno"> 2637</span>  TUndoManager::manager()-&gt;add(undo);</div>
<div class="line"><span class="lineno"> 2638</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">getCurrentXsheet</a>()-&gt;notifyXsheetChanged();</div>
<div class="line"><span class="lineno"> 2639</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2640</span>}</div>
<div class="ttc" id="aclass_t_xsh_column_html_ae8f60aa38588cfb590725ce632ee6d02"><div class="ttname"><a href="class_t_xsh_column.html#ae8f60aa38588cfb590725ce632ee6d02">TXshColumn::toColumnType</a></div><div class="ttdeci">static ColumnType toColumnType(int levelType)</div><div class="ttdoc">Returns the column type used to store levels of the specified type.</div><div class="ttdef"><b>Definition:</b> txshcolumn.cpp:522</div></div>
<div class="ttc" id="aclass_t_xsheet_html_ad2812514a3f36e1a61cbf71aa7f21cd5"><div class="ttname"><a href="class_t_xsheet.html#ad2812514a3f36e1a61cbf71aa7f21cd5">TXsheet::exposeLevel</a></div><div class="ttdeci">int exposeLevel(int row, int col, TXshLevel *xl, bool overwrite=false)</div><div class="ttdef"><b>Definition:</b> txsheet.cpp:1045</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f2faadbbacdf21975a71dfaaa0f30f6" name="a4f2faadbbacdf21975a71dfaaa0f30f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f2faadbbacdf21975a71dfaaa0f30f6">&#9670;&nbsp;</a></span>importLipSync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::importLipSync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_file_path.html">TFilePath</a>&#160;</td>
          <td class="paramname"><em>levelPath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QList&lt; <a class="el" href="class_t_frame_id.html">TFrameId</a> &gt;&#160;</td>
          <td class="paramname"><em>frameList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QList&lt; QString &gt;&#160;</td>
          <td class="paramname"><em>commentList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>fileName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2673</span>                                                                        {</div>
<div class="line"><span class="lineno"> 2674</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 2675</span>  <span class="keywordtype">int</span> col   = app-&gt;<a class="code hl_function" href="class_t_app.html#a1e294e7cff300851d12a8c3d196943f6">getCurrentColumn</a>()-&gt;getColumnIndex();</div>
<div class="line"><span class="lineno"> 2676</span>  <span class="keywordtype">int</span> row   = app-&gt;<a class="code hl_function" href="class_t_app.html#a35516f8175dab3ccdf3d6d3c3e5f59ae">getCurrentFrame</a>()-&gt;getFrameIndex();</div>
<div class="line"><span class="lineno"> 2677</span> </div>
<div class="line"><span class="lineno"> 2678</span>  <a class="code hl_struct" href="struct_io_cmd_1_1_load_resource_arguments.html">IoCmd::LoadResourceArguments</a> args;</div>
<div class="line"><span class="lineno"> 2679</span>  <a class="code hl_struct" href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html">IoCmd::LoadResourceArguments::ScopedBlock</a> sb;</div>
<div class="line"><span class="lineno"> 2680</span> </div>
<div class="line"><span class="lineno"> 2681</span>  <span class="comment">// Create text column</span></div>
<div class="line"><span class="lineno"> 2682</span>  <a class="code hl_function" href="namespace_io_cmd.html#abfb5ff0c0d7c59bef7802b8ce55d15fc">IoCmd::exposeComment</a>(row, col, commentList, fileName);</div>
<div class="line"><span class="lineno"> 2683</span> </div>
<div class="line"><span class="lineno"> 2684</span>  <span class="comment">// Load Level</span></div>
<div class="line"><span class="lineno"> 2685</span>  args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>.push_back(levelPath);</div>
<div class="line"><span class="lineno"> 2686</span>  args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#aa69846d3da53cf7e64af73da3116c26a">expose</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2687</span> </div>
<div class="line"><span class="lineno"> 2688</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespace_io_cmd.html#a107f6d3100b922e0c09e9b4aa1a8602a">IoCmd::loadResources</a>(args, <span class="keyword">false</span>, &amp;sb)) {</div>
<div class="line"><span class="lineno"> 2689</span>    DVGui::error(QObject::tr(<span class="stringliteral">&quot;It is not possible to load the level %1&quot;</span>)</div>
<div class="line"><span class="lineno"> 2690</span>                     .arg(toQString(levelPath)));</div>
<div class="line"><span class="lineno"> 2691</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2692</span>  }</div>
<div class="line"><span class="lineno"> 2693</span> </div>
<div class="line"><span class="lineno"> 2694</span>  <span class="comment">// Expose Level in xsheet</span></div>
<div class="line"><span class="lineno"> 2695</span>  assert(args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a25af81323f9227d846e6aa7dbd4d6908">loadedLevels</a>.size() == 1);</div>
<div class="line"><span class="lineno"> 2696</span>  <a class="code hl_class" href="class_t_xsh_level.html">TXshLevel</a> *loadedLevel = args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a25af81323f9227d846e6aa7dbd4d6908">loadedLevels</a>.at(0);</div>
<div class="line"><span class="lineno"> 2697</span> </div>
<div class="line"><span class="lineno"> 2698</span>  std::vector&lt;TFrameId&gt; fids;</div>
<div class="line"><span class="lineno"> 2699</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; frameList.size(); i++) fids.push_back(frameList.at(i));</div>
<div class="line"><span class="lineno"> 2700</span> </div>
<div class="line"><span class="lineno"> 2701</span>  <span class="keywordflow">if</span> (!IoCmd::exposeLevel(loadedLevel-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a023065559cff76164ecb6344c586ba27">getSimpleLevel</a>(), row, col, fids)) {</div>
<div class="line"><span class="lineno"> 2702</span>    DVGui::error(QObject::tr(<span class="stringliteral">&quot;It is not possible to load the level %1&quot;</span>)</div>
<div class="line"><span class="lineno"> 2703</span>                     .arg(toQString(levelPath)));</div>
<div class="line"><span class="lineno"> 2704</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2705</span>  }</div>
<div class="line"><span class="lineno"> 2706</span> </div>
<div class="line"><span class="lineno"> 2707</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2708</span>}</div>
<div class="ttc" id="aclass_t_app_html_a1e294e7cff300851d12a8c3d196943f6"><div class="ttname"><a href="class_t_app.html#a1e294e7cff300851d12a8c3d196943f6">TApp::getCurrentColumn</a></div><div class="ttdeci">TColumnHandle * getCurrentColumn() const override</div><div class="ttdef"><b>Definition:</b> tapp.h:118</div></div>
<div class="ttc" id="aclass_t_app_html_a35516f8175dab3ccdf3d6d3c3e5f59ae"><div class="ttname"><a href="class_t_app.html#a35516f8175dab3ccdf3d6d3c3e5f59ae">TApp::getCurrentFrame</a></div><div class="ttdeci">TFrameHandle * getCurrentFrame() const override</div><div class="ttdef"><b>Definition:</b> tapp.h:114</div></div>
<div class="ttc" id="aclass_t_xsh_level_html"><div class="ttname"><a href="class_t_xsh_level.html">TXshLevel</a></div><div class="ttdoc">The TXshLevel class is the base class of level managers in xsheet.</div><div class="ttdef"><b>Definition:</b> txshlevel.h:50</div></div>
<div class="ttc" id="aclass_t_xsh_level_html_a023065559cff76164ecb6344c586ba27"><div class="ttname"><a href="class_t_xsh_level.html#a023065559cff76164ecb6344c586ba27">TXshLevel::getSimpleLevel</a></div><div class="ttdeci">virtual TXshSimpleLevel * getSimpleLevel()</div><div class="ttdoc">Method (to be overridden in subclasses) to downcast to TXshSimpleLevel.</div><div class="ttdef"><b>Definition:</b> txshlevel.h:95</div></div>
<div class="ttc" id="anamespace_io_cmd_html_a107f6d3100b922e0c09e9b4aa1a8602a"><div class="ttname"><a href="namespace_io_cmd.html#a107f6d3100b922e0c09e9b4aa1a8602a">IoCmd::loadResources</a></div><div class="ttdeci">int loadResources(LoadResourceArguments &amp;args, bool updateRecentFiles=true, LoadResourceArguments::ScopedBlock *sb=0)</div><div class="ttdef"><b>Definition:</b> iocommand.cpp:2357</div></div>
<div class="ttc" id="anamespace_io_cmd_html_abfb5ff0c0d7c59bef7802b8ce55d15fc"><div class="ttname"><a href="namespace_io_cmd.html#abfb5ff0c0d7c59bef7802b8ce55d15fc">IoCmd::exposeComment</a></div><div class="ttdeci">bool exposeComment(int row, int &amp;col, QList&lt; QString &gt; commentList, QString fileName)</div><div class="ttdoc">Create and expose column with comment in commentList.</div><div class="ttdef"><b>Definition:</b> iocommand.cpp:2646</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block_html"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html">IoCmd::LoadResourceArguments::ScopedBlock</a></div><div class="ttdoc">Scope variable hosting a loading process.</div><div class="ttdef"><b>Definition:</b> iocommand.h:65</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_html"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments.html">IoCmd::LoadResourceArguments</a></div><div class="ttdoc">Composite data used describing a group of Toonz resources to be loaded.</div><div class="ttdef"><b>Definition:</b> iocommand.h:59</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_html_a25af81323f9227d846e6aa7dbd4d6908"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments.html#a25af81323f9227d846e6aa7dbd4d6908">IoCmd::LoadResourceArguments::loadedLevels</a></div><div class="ttdeci">std::vector&lt; TXshLevel * &gt; loadedLevels</div><div class="ttdef"><b>Definition:</b> iocommand.h:127</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_html_a5175016c278fd5a031f149abf4f77cb1"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">IoCmd::LoadResourceArguments::resourceDatas</a></div><div class="ttdeci">std::vector&lt; ResourceData &gt; resourceDatas</div><div class="ttdoc">[In/Out] Data identifying a single resource.</div><div class="ttdef"><b>Definition:</b> iocommand.h:105</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_html_aa69846d3da53cf7e64af73da3116c26a"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments.html#aa69846d3da53cf7e64af73da3116c26a">IoCmd::LoadResourceArguments::expose</a></div><div class="ttdeci">bool expose</div><div class="ttdef"><b>Definition:</b> iocommand.h:124</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e4a4aacfc92a744c3eb69ee087946db" name="a0e4a4aacfc92a744c3eb69ee087946db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e4a4aacfc92a744c3eb69ee087946db">&#9670;&nbsp;</a></span>loadResourceFolders()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IoCmd::loadResourceFolders </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_io_cmd_1_1_load_resource_arguments.html">LoadResourceArguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html">LoadResourceArguments::ScopedBlock</a> *&#160;</td>
          <td class="paramname"><em>sb</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Loads the specified folders in current xsheet. </p><dl class="section return"><dt>Returns</dt><dd>The actually loaded levels count. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">args</td><td>Resource folders to be loaded. </td></tr>
    <tr><td class="paramname">sb</td><td>Load block. May be nonzero in order to extend block data access and finalization. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  522</span>                                                                     {</div>
<div class="line"><span class="lineno">  523</span>  <span class="keyword">struct </span>locals {</div>
<div class="line"><span class="lineno">  524</span>    <span class="keyword">static</span> LRArgs::ResourceData toResourceData(<span class="keyword">const</span> Resource &amp;rsrc) {</div>
<div class="line"><span class="lineno">  525</span>      LRArgs::ResourceData rd(rsrc.m_path.absoluteResourcePath());</div>
<div class="line"><span class="lineno">  526</span>      rd.m_options = rsrc.m_levelOptions;</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>      <span class="keywordflow">return</span> rd;</div>
<div class="line"><span class="lineno">  529</span>    }</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>    <span class="keyword">static</span> <span class="keywordtype">bool</span> isExternPath(<span class="keyword">const</span> <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a> &amp;scene,</div>
<div class="line"><span class="lineno">  532</span>                             <span class="keyword">const</span> LRArgs::ResourceData &amp;rd) {</div>
<div class="line"><span class="lineno">  533</span>      <span class="keywordflow">return</span> scene.<a class="code hl_function" href="class_toonz_scene.html#a657e45d8e257f7c2047022b75dc8600d">isExternPath</a>(rd.m_path);</div>
<div class="line"><span class="lineno">  534</span>    }</div>
<div class="line"><span class="lineno">  535</span>  };  <span class="comment">// locals</span></div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>  boost::optional&lt;LRArgs::ScopedBlock&gt; sb_;</div>
<div class="line"><span class="lineno">  538</span>  <span class="keywordflow">if</span> (!sb) sb = (sb_ = boost::in_place()).get_ptr();</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>  <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a> *scene = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;getScene();</div>
<div class="line"><span class="lineno">  541</span>  assert(scene);</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>  <span class="comment">// Loading options popup</span></div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>  <span class="comment">// Deal with import decision</span></div>
<div class="line"><span class="lineno">  546</span>  <span class="keywordtype">bool</span> <span class="keyword">import</span> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  547</span>  {</div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordflow">if</span> (std::any_of(</div>
<div class="line"><span class="lineno">  549</span>            args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>.begin(), args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>.end(),</div>
<div class="line"><span class="lineno">  550</span>            boost::bind(locals::isExternPath, boost::cref(*scene), _1))) {</div>
<div class="line"><span class="lineno">  551</span>      <span class="comment">// Ask for data import in this case</span></div>
<div class="line"><span class="lineno">  552</span>      <span class="keywordtype">int</span> resolutionButton = DVGui::MsgBox(</div>
<div class="line"><span class="lineno">  553</span>          QObject::tr(<span class="stringliteral">&quot;Selected folders don&#39;t belong to the current project.\n&quot;</span></div>
<div class="line"><span class="lineno">  554</span>                      <span class="stringliteral">&quot;Do you want to import them or load from their original &quot;</span></div>
<div class="line"><span class="lineno">  555</span>                      <span class="stringliteral">&quot;location?&quot;</span>),</div>
<div class="line"><span class="lineno">  556</span>          QObject::tr(<span class="stringliteral">&quot;Load&quot;</span>), QObject::tr(<span class="stringliteral">&quot;Import&quot;</span>), QObject::tr(<span class="stringliteral">&quot;Cancel&quot;</span>));</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>      <span class="keyword">enum</span> { CLOSED, LOAD, IMPORT, CANCELED };</div>
<div class="line"><span class="lineno">  559</span>      <span class="keywordflow">switch</span> (resolutionButton) {</div>
<div class="line"><span class="lineno">  560</span>      <span class="keywordflow">case</span> CLOSED:</div>
<div class="line"><span class="lineno">  561</span>      <span class="keywordflow">case</span> CANCELED:</div>
<div class="line"><span class="lineno">  562</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>      <span class="keywordflow">case</span> IMPORT:</div>
<div class="line"><span class="lineno">  565</span>        <span class="keyword">import</span> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  566</span>      }</div>
<div class="line"><span class="lineno">  567</span>    }</div>
<div class="line"><span class="lineno">  568</span>  }</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>  <span class="comment">// Select resources to be loaded</span></div>
<div class="line"><span class="lineno">  571</span>  std::vector&lt;Resource&gt; resources;</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>  boost::for_each(</div>
<div class="line"><span class="lineno">  574</span>      args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a> |</div>
<div class="line"><span class="lineno">  575</span>          boost::adaptors::transformed(boost::bind&lt;const TFilePath &amp;&gt;(</div>
<div class="line"><span class="lineno">  576</span>              &amp;LRArgs::ResourceData::m_path, _1)),</div>
<div class="line"><span class="lineno">  577</span>      boost::bind(::buildResources, boost::ref(resources), _1, <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>()));</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>  <span class="comment">// Import them if required</span></div>
<div class="line"><span class="lineno">  580</span>  <span class="keywordflow">if</span> (<span class="keyword">import</span>) ::import(*scene, resources, *sb);</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>  <span class="comment">// Temporarily substitute args&#39; import policy</span></div>
<div class="line"><span class="lineno">  583</span>  <span class="keyword">struct </span>SubstImportPolicy {</div>
<div class="line"><span class="lineno">  584</span>    LRArgs &amp;m_args;</div>
<div class="line"><span class="lineno">  585</span>    LRArgs::ImportPolicy m_policy;</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>    SubstImportPolicy(LRArgs &amp;args, LRArgs::ImportPolicy policy)</div>
<div class="line"><span class="lineno">  588</span>        : m_args(args), m_policy(args.importPolicy) {</div>
<div class="line"><span class="lineno">  589</span>      args.importPolicy = policy;</div>
<div class="line"><span class="lineno">  590</span>    }</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>    ~SubstImportPolicy() { m_args.importPolicy = m_policy; }</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>  } substImportPolicy(args, <span class="keyword">import</span> ? LRArgs::IMPORT : LRArgs::LOAD);</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>  <span class="comment">// Perform loading via loadResources()</span></div>
<div class="line"><span class="lineno">  597</span>  args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>.assign(</div>
<div class="line"><span class="lineno">  598</span>      boost::make_transform_iterator(resources.begin(), locals::toResourceData),</div>
<div class="line"><span class="lineno">  599</span>      boost::make_transform_iterator(resources.end(), locals::toResourceData));</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_io_cmd.html#a107f6d3100b922e0c09e9b4aa1a8602a">IoCmd::loadResources</a>(args, <span class="keyword">false</span>, sb);</div>
<div class="line"><span class="lineno">  602</span>}</div>
<div class="ttc" id="aclass_toonz_scene_html_a657e45d8e257f7c2047022b75dc8600d"><div class="ttname"><a href="class_toonz_scene.html#a657e45d8e257f7c2047022b75dc8600d">ToonzScene::isExternPath</a></div><div class="ttdeci">bool isExternPath(const TFilePath &amp;fp) const</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:1457</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00106">TApp::getCurrentScene()</a>, <a class="el" href="#l00215">TApp::instance()</a>, <a class="el" href="#l01457">ToonzScene::isExternPath()</a>, <a class="el" href="#l02357">loadResources()</a>, and <a class="el" href="#l00105">IoCmd::LoadResourceArguments::resourceDatas</a>.</p>

<p class="reference">Referenced by <a class="el" href="#l02357">loadResources()</a>.</p>

</div>
</div>
<a id="a107f6d3100b922e0c09e9b4aa1a8602a" name="a107f6d3100b922e0c09e9b4aa1a8602a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a107f6d3100b922e0c09e9b4aa1a8602a">&#9670;&nbsp;</a></span>loadResources()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IoCmd::loadResources </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_io_cmd_1_1_load_resource_arguments.html">LoadResourceArguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>updateRecentFiles</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html">LoadResourceArguments::ScopedBlock</a> *&#160;</td>
          <td class="paramname"><em>sb</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section note"><dt>Note</dt><dd>Will fallback to <a class="el" href="namespace_io_cmd.html#a0e4a4aacfc92a744c3eb69ee087946db">loadResourceFolders()</a> in case all argument paths are folders. <br  />
 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">args</td><td>Resources to be loaded. </td></tr>
    <tr><td class="paramname">updateRecentFiles</td><td>Whether Toonz's <em>Recent Files</em> list must be updated. </td></tr>
    <tr><td class="paramname">sb</td><td>Load block. May be nonzero in order to extend block data access and finalization. Loads a group of resources by path. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The actually loaded levels count. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 2358</span>                                              {</div>
<div class="line"><span class="lineno"> 2359</span>  <span class="keyword">struct </span>locals {</div>
<div class="line"><span class="lineno"> 2360</span>    <span class="keyword">static</span> <span class="keywordtype">bool</span> isDir(<span class="keyword">const</span> <a class="code hl_struct" href="struct_io_cmd_1_1_load_resource_arguments_1_1_resource_data.html">LoadResourceArguments::ResourceData</a> &amp;rd) {</div>
<div class="line"><span class="lineno"> 2361</span>      <span class="keywordflow">return</span> QFileInfo(rd.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments_1_1_resource_data.html#a5bba0a59458b3487b03c8b1c84fea3c3">m_path</a>.getQString()).isDir();</div>
<div class="line"><span class="lineno"> 2362</span>    }</div>
<div class="line"><span class="lineno"> 2363</span>  };  <span class="comment">// locals</span></div>
<div class="line"><span class="lineno"> 2364</span> </div>
<div class="line"><span class="lineno"> 2365</span>  <span class="keywordflow">if</span> (args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>.empty()) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2366</span> </div>
<div class="line"><span class="lineno"> 2367</span>  <span class="comment">// Redirect to resource folders loading in case they&#39;re all dirs</span></div>
<div class="line"><span class="lineno"> 2368</span>  <span class="keywordflow">if</span> (std::all_of(args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>.begin(), args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>.end(),</div>
<div class="line"><span class="lineno"> 2369</span>                  locals::isDir))</div>
<div class="line"><span class="lineno"> 2370</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_io_cmd.html#a0e4a4aacfc92a744c3eb69ee087946db">loadResourceFolders</a>(args, sb);</div>
<div class="line"><span class="lineno"> 2371</span> </div>
<div class="line"><span class="lineno"> 2372</span>  boost::optional&lt;LoadScopedBlock&gt; sb_;</div>
<div class="line"><span class="lineno"> 2373</span>  <span class="keywordflow">if</span> (!sb) sb = (sb_ = boost::in_place()).get_ptr();</div>
<div class="line"><span class="lineno"> 2374</span> </div>
<div class="line"><span class="lineno"> 2375</span>  <span class="keywordtype">int</span> &amp;row0 = args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a841efe5b92fc94bcd62d15c331d76d7d">row0</a>, &amp;col0 = args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a06a4463ae47ce6583f81b513b651e03a">col0</a>, &amp;row1 = args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a4735e60a793fe8885cd0f3255faf2914">row1</a>,</div>
<div class="line"><span class="lineno"> 2376</span>      &amp;col1 = args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#afd8529f5422883575f0e3f5011b6de78">col1</a>;</div>
<div class="line"><span class="lineno"> 2377</span> </div>
<div class="line"><span class="lineno"> 2378</span>  <span class="comment">// Setup local variables</span></div>
<div class="line"><span class="lineno"> 2379</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app         = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 2380</span>  <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a> *scene = app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;getScene();</div>
<div class="line"><span class="lineno"> 2381</span>  <a class="code hl_class" href="class_t_xsheet.html">TXsheet</a> *xsh      = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ae3c828e3223fd809fd59189233d0576a">getXsheet</a>();</div>
<div class="line"><span class="lineno"> 2382</span>  <span class="comment">// use current frame/column if row/col is not set</span></div>
<div class="line"><span class="lineno"> 2383</span>  <span class="keywordflow">if</span> (row0 == -1) row0 = app-&gt;<a class="code hl_function" href="class_t_app.html#a35516f8175dab3ccdf3d6d3c3e5f59ae">getCurrentFrame</a>()-&gt;getFrameIndex();</div>
<div class="line"><span class="lineno"> 2384</span>  <span class="keywordflow">if</span> (col0 == -1) col0 = app-&gt;<a class="code hl_function" href="class_t_app.html#a1e294e7cff300851d12a8c3d196943f6">getCurrentColumn</a>()-&gt;getColumnIndex();</div>
<div class="line"><span class="lineno"> 2385</span> </div>
<div class="line"><span class="lineno"> 2386</span>  <span class="keywordtype">int</span> rCount = args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>.size(), loadedCount = 0;</div>
<div class="line"><span class="lineno"> 2387</span>  <span class="keywordtype">bool</span> isSoundLevel = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2388</span> </div>
<div class="line"><span class="lineno"> 2389</span>  <span class="comment">// show wait cursor in case of caching all images because it is time consuming</span></div>
<div class="line"><span class="lineno"> 2390</span>  <span class="keywordflow">if</span> (args.cachingBehavior == LoadResourceArguments::ALL_ICONS_AND_IMAGES)</div>
<div class="line"><span class="lineno"> 2391</span>    QApplication::setOverrideCursor(Qt::WaitCursor);</div>
<div class="line"><span class="lineno"> 2392</span> </div>
<div class="line"><span class="lineno"> 2393</span>  <span class="comment">// Initialize progress dialog</span></div>
<div class="line"><span class="lineno"> 2394</span>  <a class="code hl_class" href="class_d_v_gui_1_1_progress_dialog.html">DVGui::ProgressDialog</a> *progressDialog =</div>
<div class="line"><span class="lineno"> 2395</span>      (rCount &gt; 1) ? &amp;sb-&gt;<a class="code hl_function" href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html#a679b890db3bf0ba3fd212e814b507c4d">progressDialog</a>() : 0;</div>
<div class="line"><span class="lineno"> 2396</span> </div>
<div class="line"><span class="lineno"> 2397</span>  <span class="keywordflow">if</span> (progressDialog) {</div>
<div class="line"><span class="lineno"> 2398</span>    progressDialog-&gt;setModal(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2399</span>    progressDialog-&gt;setMinimum(0);</div>
<div class="line"><span class="lineno"> 2400</span>    progressDialog-&gt;setMaximum(rCount);</div>
<div class="line"><span class="lineno"> 2401</span>    progressDialog-&gt;show();</div>
<div class="line"><span class="lineno"> 2402</span>  }</div>
<div class="line"><span class="lineno"> 2403</span> </div>
<div class="line"><span class="lineno"> 2404</span>  <span class="comment">// Initialize import dialog</span></div>
<div class="line"><span class="lineno"> 2405</span>  ResourceImportDialog importDialog;</div>
<div class="line"><span class="lineno"> 2406</span>  <span class="keywordflow">if</span> (args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a7d1d2640d9f2f1e82e1b55584b2519c5">importPolicy</a> != LoadResourceArguments::ASK_USER) {</div>
<div class="line"><span class="lineno"> 2407</span>    importDialog.setImportEnabled(args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a7d1d2640d9f2f1e82e1b55584b2519c5">importPolicy</a> ==</div>
<div class="line"><span class="lineno"> 2408</span>                                  LoadResourceArguments::IMPORT);</div>
<div class="line"><span class="lineno"> 2409</span>  }</div>
<div class="line"><span class="lineno"> 2410</span> </div>
<div class="line"><span class="lineno"> 2411</span>  std::vector&lt;TFilePath&gt; paths;</div>
<div class="line"><span class="lineno"> 2412</span>  <span class="keywordtype">int</span> all = 0;</div>
<div class="line"><span class="lineno"> 2413</span> </div>
<div class="line"><span class="lineno"> 2414</span>  <span class="comment">// Loop for all the resources to load</span></div>
<div class="line"><span class="lineno"> 2415</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r != rCount; ++r) {</div>
<div class="line"><span class="lineno"> 2416</span>    <span class="keywordflow">if</span> (importDialog.aborted()) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2417</span> </div>
<div class="line"><span class="lineno"> 2418</span>    QString origName =</div>
<div class="line"><span class="lineno"> 2419</span>        args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>[r].m_path.withoutParentDir().getQString();</div>
<div class="line"><span class="lineno"> 2420</span> </div>
<div class="line"><span class="lineno"> 2421</span>    LoadResourceArguments::ResourceData rd(args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>[r]);</div>
<div class="line"><span class="lineno"> 2422</span>    <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> &amp;path = rd.m_path;</div>
<div class="line"><span class="lineno"> 2423</span> </div>
<div class="line"><span class="lineno"> 2424</span>    <span class="keywordflow">if</span> (!rd.m_path.isLevelName())</div>
<div class="line"><span class="lineno"> 2425</span>      path = <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>(path.getLevelNameW()).<a class="code hl_function" href="class_t_file_path.html#a09d12d68c4264183e0268dde6f592b2e">withParentDir</a>(path.<a class="code hl_function" href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">getParentDir</a>());</div>
<div class="line"><span class="lineno"> 2426</span> </div>
<div class="line"><span class="lineno"> 2427</span>    <span class="keywordflow">if</span> (std::find(paths.begin(), paths.end(), path) != paths.end()) {</div>
<div class="line"><span class="lineno"> 2428</span>      <span class="keywordflow">if</span> (!all) {</div>
<div class="line"><span class="lineno"> 2429</span>        QString question =</div>
<div class="line"><span class="lineno"> 2430</span>            QObject::tr(</div>
<div class="line"><span class="lineno"> 2431</span>                <span class="stringliteral">&quot;File &#39;%1&#39; will reload level &#39;%2&#39; as a duplicate column in the &quot;</span></div>
<div class="line"><span class="lineno"> 2432</span>                <span class="stringliteral">&quot;xsheet.\n\nAllow duplicate?&quot;</span>)</div>
<div class="line"><span class="lineno"> 2433</span>                .arg(origName)</div>
<div class="line"><span class="lineno"> 2434</span>                .arg(QString::fromStdString(path.<a class="code hl_function" href="class_t_file_path.html#af94f9b0aeceb6cdb980fa1789473503a">getName</a>()));</div>
<div class="line"><span class="lineno"> 2435</span>        QString Yes    = QObject::tr(<span class="stringliteral">&quot;Allow&quot;</span>);</div>
<div class="line"><span class="lineno"> 2436</span>        QString YesAll = QObject::tr(<span class="stringliteral">&quot;Allow All Dups&quot;</span>);</div>
<div class="line"><span class="lineno"> 2437</span>        QString No     = QObject::tr(<span class="stringliteral">&quot;No&quot;</span>);</div>
<div class="line"><span class="lineno"> 2438</span>        QString NoAll  = QObject::tr(<span class="stringliteral">&quot;No to All Dups&quot;</span>);</div>
<div class="line"><span class="lineno"> 2439</span>        <span class="keywordtype">int</span> ret        = DVGui::MsgBox(question, Yes, YesAll, No, NoAll, 0);</div>
<div class="line"><span class="lineno"> 2440</span>        <span class="keywordflow">switch</span> (ret) {</div>
<div class="line"><span class="lineno"> 2441</span>        <span class="keywordflow">case</span> 2:</div>
<div class="line"><span class="lineno"> 2442</span>          all = 1;  <span class="comment">// YesAll</span></div>
<div class="line"><span class="lineno"> 2443</span>        <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno"> 2444</span>          <span class="keywordflow">break</span>;  <span class="comment">// Yes</span></div>
<div class="line"><span class="lineno"> 2445</span>        <span class="keywordflow">case</span> 4:</div>
<div class="line"><span class="lineno"> 2446</span>          all = 2;  <span class="comment">// NoAll</span></div>
<div class="line"><span class="lineno"> 2447</span>        <span class="keywordflow">case</span> 3:</div>
<div class="line"><span class="lineno"> 2448</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2449</span>        }</div>
<div class="line"><span class="lineno"> 2450</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (all == 2)</div>
<div class="line"><span class="lineno"> 2451</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2452</span>    }</div>
<div class="line"><span class="lineno"> 2453</span>    paths.push_back(path);</div>
<div class="line"><span class="lineno"> 2454</span> </div>
<div class="line"><span class="lineno"> 2455</span>    <span class="keywordflow">if</span> (progressDialog) {</div>
<div class="line"><span class="lineno"> 2456</span>      <span class="keywordflow">if</span> (progressDialog-&gt;wasCanceled())</div>
<div class="line"><span class="lineno"> 2457</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2458</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2459</span>        progressDialog-&gt;setLabelText(</div>
<div class="line"><span class="lineno"> 2460</span>            DVGui::ProgressDialog::tr(<span class="stringliteral">&quot;Loading \&quot;%1\&quot;...&quot;</span>)</div>
<div class="line"><span class="lineno"> 2461</span>                .arg(path.getQString()));</div>
<div class="line"><span class="lineno"> 2462</span>        progressDialog-&gt;setValue(r);</div>
<div class="line"><span class="lineno"> 2463</span> </div>
<div class="line"><span class="lineno"> 2464</span>        QCoreApplication::processEvents();</div>
<div class="line"><span class="lineno"> 2465</span>      }</div>
<div class="line"><span class="lineno"> 2466</span>    }</div>
<div class="line"><span class="lineno"> 2467</span> </div>
<div class="line"><span class="lineno"> 2468</span>    <span class="keywordtype">bool</span> isLastResource = (r == rCount - 1);</div>
<div class="line"><span class="lineno"> 2469</span>    importDialog.setIsLastResource(isLastResource);</div>
<div class="line"><span class="lineno"> 2470</span> </div>
<div class="line"><span class="lineno"> 2471</span>    <span class="keywordtype">bool</span> isScene = (TFileType::getInfo(path) == TFileType::TOONZSCENE);</div>
<div class="line"><span class="lineno"> 2472</span> </div>
<div class="line"><span class="lineno"> 2473</span>    <span class="keywordflow">if</span> (scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a657e45d8e257f7c2047022b75dc8600d">isExternPath</a>(path) || isScene) {</div>
<div class="line"><span class="lineno"> 2474</span>      <span class="comment">// extern resource: import or link?</span></div>
<div class="line"><span class="lineno"> 2475</span>      <span class="keywordtype">int</span> ret = importDialog.askImportQuestion(path);</div>
<div class="line"><span class="lineno"> 2476</span>      <span class="keywordflow">if</span> (ret == ResourceImportDialog::A_CANCEL) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2477</span>    }</div>
<div class="line"><span class="lineno"> 2478</span> </div>
<div class="line"><span class="lineno"> 2479</span>    <span class="comment">// for the scene file</span></div>
<div class="line"><span class="lineno"> 2480</span>    <a class="code hl_class" href="class_t_xsh_level.html">TXshLevel</a> *xl = 0;</div>
<div class="line"><span class="lineno"> 2481</span>    <span class="keywordflow">if</span> (isScene) {</div>
<div class="line"><span class="lineno"> 2482</span>      <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> oldDstFolder = importDialog.getDstFolder();</div>
<div class="line"><span class="lineno"> 2483</span>      <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> dstFolder = (Preferences::instance()-&gt;isSubsceneFolderEnabled())</div>
<div class="line"><span class="lineno"> 2484</span>                                ? <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>(path.<a class="code hl_function" href="class_t_file_path.html#af94f9b0aeceb6cdb980fa1789473503a">getName</a>())</div>
<div class="line"><span class="lineno"> 2485</span>                                : <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>();</div>
<div class="line"><span class="lineno"> 2486</span> </div>
<div class="line"><span class="lineno"> 2487</span>      importDialog.setDstFolder(dstFolder);</div>
<div class="line"><span class="lineno"> 2488</span>      importDialog.setIsLastResource(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2489</span> </div>
<div class="line"><span class="lineno"> 2490</span>      <span class="comment">// load the scene as subXsheet</span></div>
<div class="line"><span class="lineno"> 2491</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2492</span>        xl = loadChildLevel(scene, path, row0, col0, importDialog);</div>
<div class="line"><span class="lineno"> 2493</span>        <span class="keywordflow">if</span> (dstFolder != <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>())</div>
<div class="line"><span class="lineno"> 2494</span>          app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;notifyCastFolderAdded(</div>
<div class="line"><span class="lineno"> 2495</span>              scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ac1a8bf0d2cec4f59c87b0001991264b5">getLevelSet</a>()-&gt;getDefaultFolder() + dstFolder);</div>
<div class="line"><span class="lineno"> 2496</span>        <span class="comment">// increment the number of resources actually loaded</span></div>
<div class="line"><span class="lineno"> 2497</span>        ++loadedCount;</div>
<div class="line"><span class="lineno"> 2498</span>        <span class="comment">// move the column to the right</span></div>
<div class="line"><span class="lineno"> 2499</span>        ++col0;</div>
<div class="line"><span class="lineno"> 2500</span>        <span class="comment">// register the loaded level to args</span></div>
<div class="line"><span class="lineno"> 2501</span>        args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a25af81323f9227d846e6aa7dbd4d6908">loadedLevels</a>.push_back(xl);</div>
<div class="line"><span class="lineno"> 2502</span>        app-&gt;<a class="code hl_function" href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">getCurrentXsheet</a>()-&gt;notifyXsheetSoundChanged();</div>
<div class="line"><span class="lineno"> 2503</span>      } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno"> 2504</span>      }</div>
<div class="line"><span class="lineno"> 2505</span> </div>
<div class="line"><span class="lineno"> 2506</span>      importDialog.setIsLastResource(isLastResource);</div>
<div class="line"><span class="lineno"> 2507</span>      importDialog.setDstFolder(oldDstFolder);</div>
<div class="line"><span class="lineno"> 2508</span> </div>
<div class="line"><span class="lineno"> 2509</span>      app-&gt;<a class="code hl_function" href="class_t_app.html#a1e294e7cff300851d12a8c3d196943f6">getCurrentColumn</a>()-&gt;setColumnIndex(col0);</div>
<div class="line"><span class="lineno"> 2510</span> </div>
<div class="line"><span class="lineno"> 2511</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2512</span>    }</div>
<div class="line"><span class="lineno"> 2513</span>    <span class="comment">// for other level files</span></div>
<div class="line"><span class="lineno"> 2514</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2515</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2516</span>        path = importDialog.process(scene, 0, path);</div>
<div class="line"><span class="lineno"> 2517</span>        <span class="comment">// path = scene-&gt;decodeFilePath(codedPath);</span></div>
<div class="line"><span class="lineno"> 2518</span>      } <span class="keywordflow">catch</span> (std::string msg) {</div>
<div class="line"><span class="lineno"> 2519</span>        error(QString::fromStdString(msg));</div>
<div class="line"><span class="lineno"> 2520</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2521</span>      }</div>
<div class="line"><span class="lineno"> 2522</span> </div>
<div class="line"><span class="lineno"> 2523</span>      <span class="keywordflow">if</span> (importDialog.aborted()) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2524</span>    }</div>
<div class="line"><span class="lineno"> 2525</span>    <span class="keywordflow">if</span> (path.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() == <span class="stringliteral">&quot;psd&quot;</span>) {</div>
<div class="line"><span class="lineno"> 2526</span>      <span class="keyword">static</span> <a class="code hl_class" href="class_psd_settings_popup.html">PsdSettingsPopup</a> *popup = 0;</div>
<div class="line"><span class="lineno"> 2527</span>      <span class="keywordflow">if</span> (!popup) {</div>
<div class="line"><span class="lineno"> 2528</span>        popup = <span class="keyword">new</span> <a class="code hl_class" href="class_psd_settings_popup.html">PsdSettingsPopup</a>();</div>
<div class="line"><span class="lineno"> 2529</span>      }</div>
<div class="line"><span class="lineno"> 2530</span>      popup-&gt;setPath(path);</div>
<div class="line"><span class="lineno"> 2531</span> </div>
<div class="line"><span class="lineno"> 2532</span>      <span class="keywordtype">int</span> ret = popup-&gt;exec();</div>
<div class="line"><span class="lineno"> 2533</span>      <span class="keywordflow">if</span> (ret == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2534</span> </div>
<div class="line"><span class="lineno"> 2535</span>      loadedCount += loadPSDResource(args, updateRecentFile, popup);</div>
<div class="line"><span class="lineno"> 2536</span> </div>
<div class="line"><span class="lineno"> 2537</span>      <span class="keywordflow">if</span> (updateRecentFile)</div>
<div class="line"><span class="lineno"> 2538</span>        RecentFiles::instance()-&gt;addFilePath(</div>
<div class="line"><span class="lineno"> 2539</span>            toQString(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(path)), RecentFiles::Level);</div>
<div class="line"><span class="lineno"> 2540</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2541</span>      <span class="comment">// reuse TFrameIds retrieved by FileBrowser</span></div>
<div class="line"><span class="lineno"> 2542</span>      std::vector&lt;TFrameId&gt; fIds;</div>
<div class="line"><span class="lineno"> 2543</span>      <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)args.frameIdsSet.size() &gt; r)  <span class="comment">// if there is fIds to be reused</span></div>
<div class="line"><span class="lineno"> 2544</span>      {</div>
<div class="line"><span class="lineno"> 2545</span>        fIds = args.frameIdsSet[r];</div>
<div class="line"><span class="lineno"> 2546</span>      }</div>
<div class="line"><span class="lineno"> 2547</span> </div>
<div class="line"><span class="lineno"> 2548</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2549</span>        xl = ::loadResource(</div>
<div class="line"><span class="lineno"> 2550</span>            scene, rd, args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a145368ccf000dac53d511c77d2829e66">castFolder</a>, row0, col0, row1, col1, args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#aa69846d3da53cf7e64af73da3116c26a">expose</a>,</div>
<div class="line"><span class="lineno"> 2551</span>#if (__cplusplus &gt; 199711L)</div>
<div class="line"><span class="lineno"> 2552</span>            std::move(fIds),</div>
<div class="line"><span class="lineno"> 2553</span>#<span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2554</span>            fIds,</div>
<div class="line"><span class="lineno"> 2555</span>#endif</div>
<div class="line"><span class="lineno"> 2556</span>            args.xFrom, args.xTo, args.levelName, args.step, args.inc,</div>
<div class="line"><span class="lineno"> 2557</span>            args.frameCount, args.doesFileActuallyExist);</div>
<div class="line"><span class="lineno"> 2558</span>        <span class="keywordflow">if</span> (updateRecentFile) {</div>
<div class="line"><span class="lineno"> 2559</span>          RecentFiles::instance()-&gt;addFilePath(</div>
<div class="line"><span class="lineno"> 2560</span>              toQString(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(path)), RecentFiles::Level);</div>
<div class="line"><span class="lineno"> 2561</span>        }</div>
<div class="line"><span class="lineno"> 2562</span>      } <span class="keywordflow">catch</span> (<a class="code hl_class" href="class_t_exception.html">TException</a> &amp;e) {</div>
<div class="line"><span class="lineno"> 2563</span>        error(QString::fromStdWString(e.getMessage()));</div>
<div class="line"><span class="lineno"> 2564</span>      }</div>
<div class="line"><span class="lineno"> 2565</span>      <span class="comment">// if load success</span></div>
<div class="line"><span class="lineno"> 2566</span>      <span class="keywordflow">if</span> (xl) {</div>
<div class="line"><span class="lineno"> 2567</span>        isSoundLevel = isSoundLevel || xl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() == SND_XSHLEVEL;</div>
<div class="line"><span class="lineno"> 2568</span>        <span class="comment">// register the loaded level to args</span></div>
<div class="line"><span class="lineno"> 2569</span>        args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a25af81323f9227d846e6aa7dbd4d6908">loadedLevels</a>.push_back(xl);</div>
<div class="line"><span class="lineno"> 2570</span>        <span class="comment">// increment the number of loaded resources</span></div>
<div class="line"><span class="lineno"> 2571</span>        ++loadedCount;</div>
<div class="line"><span class="lineno"> 2572</span> </div>
<div class="line"><span class="lineno"> 2573</span>        <span class="comment">// load the image data of all frames to cache at the beginning</span></div>
<div class="line"><span class="lineno"> 2574</span>        <span class="keywordflow">if</span> (args.cachingBehavior != LoadResourceArguments::ON_DEMAND) {</div>
<div class="line"><span class="lineno"> 2575</span>          <a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *simpleLevel = xl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a023065559cff76164ecb6344c586ba27">getSimpleLevel</a>();</div>
<div class="line"><span class="lineno"> 2576</span>          <span class="keywordflow">if</span> (simpleLevel &amp;&amp; simpleLevel-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() == TZP_XSHLEVEL) {</div>
<div class="line"><span class="lineno"> 2577</span>            <span class="keywordtype">bool</span> cacheImagesAsWell =</div>
<div class="line"><span class="lineno"> 2578</span>                (args.cachingBehavior ==</div>
<div class="line"><span class="lineno"> 2579</span>                 LoadResourceArguments::ALL_ICONS_AND_IMAGES);</div>
<div class="line"><span class="lineno"> 2580</span>            simpleLevel-&gt;loadAllIconsAndPutInCache(cacheImagesAsWell);</div>
<div class="line"><span class="lineno"> 2581</span>          }</div>
<div class="line"><span class="lineno"> 2582</span>        }</div>
<div class="line"><span class="lineno"> 2583</span>      }</div>
<div class="line"><span class="lineno"> 2584</span>    }</div>
<div class="line"><span class="lineno"> 2585</span>  }</div>
<div class="line"><span class="lineno"> 2586</span> </div>
<div class="line"><span class="lineno"> 2587</span>  <span class="keywordflow">if</span> (loadedCount) app-&gt;<a class="code hl_function" href="class_t_app.html#a35516f8175dab3ccdf3d6d3c3e5f59ae">getCurrentFrame</a>()-&gt;setFrameIndex(row0);</div>
<div class="line"><span class="lineno"> 2588</span> </div>
<div class="line"><span class="lineno"> 2589</span>  sb-&gt;<a class="code hl_function" href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html#ae0b3928706b6cf9b7347a5994a6adefa">data</a>().m_loadedCount += loadedCount;</div>
<div class="line"><span class="lineno"> 2590</span>  sb-&gt;<a class="code hl_function" href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html#ae0b3928706b6cf9b7347a5994a6adefa">data</a>().m_hasSoundLevel = sb-&gt;<a class="code hl_function" href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html#ae0b3928706b6cf9b7347a5994a6adefa">data</a>().m_hasSoundLevel || isSoundLevel;</div>
<div class="line"><span class="lineno"> 2591</span> </div>
<div class="line"><span class="lineno"> 2592</span>  <span class="comment">// revert the cursor</span></div>
<div class="line"><span class="lineno"> 2593</span>  <span class="keywordflow">if</span> (args.cachingBehavior == LoadResourceArguments::ALL_ICONS_AND_IMAGES)</div>
<div class="line"><span class="lineno"> 2594</span>    QApplication::restoreOverrideCursor();</div>
<div class="line"><span class="lineno"> 2595</span> </div>
<div class="line"><span class="lineno"> 2596</span>  <span class="keywordflow">return</span> loadedCount;</div>
<div class="line"><span class="lineno"> 2597</span>}</div>
<div class="ttc" id="aclass_d_v_gui_1_1_progress_dialog_html"><div class="ttname"><a href="class_d_v_gui_1_1_progress_dialog.html">DVGui::ProgressDialog</a></div><div class="ttdef"><b>Definition:</b> dvdialog.h:296</div></div>
<div class="ttc" id="aclass_psd_settings_popup_html"><div class="ttname"><a href="class_psd_settings_popup.html">PsdSettingsPopup</a></div><div class="ttdef"><b>Definition:</b> psdsettingspopup.h:26</div></div>
<div class="ttc" id="aclass_t_exception_html"><div class="ttname"><a href="class_t_exception.html">TException</a></div><div class="ttdef"><b>Definition:</b> texception.h:18</div></div>
<div class="ttc" id="aclass_t_file_path_html_a09d12d68c4264183e0268dde6f592b2e"><div class="ttname"><a href="class_t_file_path.html#a09d12d68c4264183e0268dde6f592b2e">TFilePath::withParentDir</a></div><div class="ttdeci">TFilePath withParentDir(const TFilePath &amp;dir) const</div><div class="ttdef"><b>Definition:</b> tfilepath.cpp:853</div></div>
<div class="ttc" id="aclass_toonz_scene_html_aa2ed57dfbae7f8cf02a4abe47ed533c6"><div class="ttname"><a href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">ToonzScene::decodeFilePath</a></div><div class="ttdeci">TFilePath decodeFilePath(const TFilePath &amp;) const</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:1231</div></div>
<div class="ttc" id="aclass_toonz_scene_html_ac1a8bf0d2cec4f59c87b0001991264b5"><div class="ttname"><a href="class_toonz_scene.html#ac1a8bf0d2cec4f59c87b0001991264b5">ToonzScene::getLevelSet</a></div><div class="ttdeci">TLevelSet * getLevelSet() const</div><div class="ttdoc">Returns a pointer to the scene's Level Set.</div><div class="ttdef"><b>Definition:</b> toonzscene.h:93</div></div>
<div class="ttc" id="aclass_toonz_scene_html_ae3c828e3223fd809fd59189233d0576a"><div class="ttname"><a href="class_toonz_scene.html#ae3c828e3223fd809fd59189233d0576a">ToonzScene::getXsheet</a></div><div class="ttdeci">TXsheet * getXsheet() const</div><div class="ttdoc">Returns a pointer to the scene's current xsheet.</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:957</div></div>
<div class="ttc" id="anamespace_io_cmd_html_a0e4a4aacfc92a744c3eb69ee087946db"><div class="ttname"><a href="namespace_io_cmd.html#a0e4a4aacfc92a744c3eb69ee087946db">IoCmd::loadResourceFolders</a></div><div class="ttdeci">int loadResourceFolders(LoadResourceArguments &amp;args, LoadResourceArguments::ScopedBlock *sb=0)</div><div class="ttdef"><b>Definition:</b> loadfoldercommand.cpp:521</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_1_1_resource_data_html"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments_1_1_resource_data.html">IoCmd::LoadResourceArguments::ResourceData</a></div><div class="ttdoc">Data about a single resource to be loaded.</div><div class="ttdef"><b>Definition:</b> iocommand.h:85</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_1_1_resource_data_html_a5bba0a59458b3487b03c8b1c84fea3c3"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments_1_1_resource_data.html#a5bba0a59458b3487b03c8b1c84fea3c3">IoCmd::LoadResourceArguments::ResourceData::m_path</a></div><div class="ttdeci">TFilePath m_path</div><div class="ttdoc">Path of the resource to be loaded.</div><div class="ttdef"><b>Definition:</b> iocommand.h:86</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block_html_a679b890db3bf0ba3fd212e814b507c4d"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html#a679b890db3bf0ba3fd212e814b507c4d">IoCmd::LoadResourceArguments::ScopedBlock::progressDialog</a></div><div class="ttdeci">DVGui::ProgressDialog &amp; progressDialog() const</div><div class="ttdoc">included posting of the embedded undo block.</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block_html_ae0b3928706b6cf9b7347a5994a6adefa"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html#ae0b3928706b6cf9b7347a5994a6adefa">IoCmd::LoadResourceArguments::ScopedBlock::data</a></div><div class="ttdeci">Data &amp; data() const</div><div class="ttdoc">Internal data used by the loading procedure.</div><div class="ttdef"><b>Definition:</b> iocommand.h:76</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_html_a06a4463ae47ce6583f81b513b651e03a"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments.html#a06a4463ae47ce6583f81b513b651e03a">IoCmd::LoadResourceArguments::col0</a></div><div class="ttdeci">int col0</div><div class="ttdef"><b>Definition:</b> iocommand.h:116</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_html_a145368ccf000dac53d511c77d2829e66"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments.html#a145368ccf000dac53d511c77d2829e66">IoCmd::LoadResourceArguments::castFolder</a></div><div class="ttdeci">TFilePath castFolder</div><div class="ttdef"><b>Definition:</b> iocommand.h:110</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_html_a4735e60a793fe8885cd0f3255faf2914"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments.html#a4735e60a793fe8885cd0f3255faf2914">IoCmd::LoadResourceArguments::row1</a></div><div class="ttdeci">int row1</div><div class="ttdef"><b>Definition:</b> iocommand.h:118</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_html_a7d1d2640d9f2f1e82e1b55584b2519c5"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments.html#a7d1d2640d9f2f1e82e1b55584b2519c5">IoCmd::LoadResourceArguments::importPolicy</a></div><div class="ttdeci">ImportPolicy importPolicy</div><div class="ttdef"><b>Definition:</b> iocommand.h:122</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_html_a841efe5b92fc94bcd62d15c331d76d7d"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments.html#a841efe5b92fc94bcd62d15c331d76d7d">IoCmd::LoadResourceArguments::row0</a></div><div class="ttdeci">int row0</div><div class="ttdef"><b>Definition:</b> iocommand.h:114</div></div>
<div class="ttc" id="astruct_io_cmd_1_1_load_resource_arguments_html_afd8529f5422883575f0e3f5011b6de78"><div class="ttname"><a href="struct_io_cmd_1_1_load_resource_arguments.html#afd8529f5422883575f0e3f5011b6de78">IoCmd::LoadResourceArguments::col1</a></div><div class="ttdeci">int col1</div><div class="ttdef"><b>Definition:</b> iocommand.h:119</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00110">IoCmd::LoadResourceArguments::castFolder</a>, <a class="el" href="#l00116">IoCmd::LoadResourceArguments::col0</a>, <a class="el" href="#l00119">IoCmd::LoadResourceArguments::col1</a>, <a class="el" href="#l00076">IoCmd::LoadResourceArguments::ScopedBlock::data()</a>, <a class="el" href="#l01231">ToonzScene::decodeFilePath()</a>, <a class="el" href="#l00124">IoCmd::LoadResourceArguments::expose</a>, <a class="el" href="#l00118">TApp::getCurrentColumn()</a>, <a class="el" href="#l00114">TApp::getCurrentFrame()</a>, <a class="el" href="#l00106">TApp::getCurrentScene()</a>, <a class="el" href="#l00110">TApp::getCurrentXsheet()</a>, <a class="el" href="#l00093">ToonzScene::getLevelSet()</a>, <a class="el" href="#l00636">TFilePath::getName()</a>, <a class="el" href="#l00683">TFilePath::getParentDir()</a>, <a class="el" href="#l00095">TXshLevel::getSimpleLevel()</a>, <a class="el" href="#l00225">TFilePath::getType()</a>, <a class="el" href="#l00081">TXshLevel::getType()</a>, <a class="el" href="#l00957">ToonzScene::getXsheet()</a>, <a class="el" href="#l00122">IoCmd::LoadResourceArguments::importPolicy</a>, <a class="el" href="#l00215">TApp::instance()</a>, <a class="el" href="#l01457">ToonzScene::isExternPath()</a>, <a class="el" href="#l00127">IoCmd::LoadResourceArguments::loadedLevels</a>, <a class="el" href="#l00521">loadResourceFolders()</a>, <a class="el" href="#l02318">LoadScopedBlock::Data::m_hasSoundLevel</a>, <a class="el" href="#l02317">LoadScopedBlock::Data::m_loadedCount</a>, <a class="el" href="#l00086">IoCmd::LoadResourceArguments::ResourceData::m_path</a>, <a class="el" href="struct_io_cmd_1_1_load_resource_arguments_1_1_scoped_block.html#a679b890db3bf0ba3fd212e814b507c4d">IoCmd::LoadResourceArguments::ScopedBlock::progressDialog()</a>, <a class="el" href="#l00105">IoCmd::LoadResourceArguments::resourceDatas</a>, <a class="el" href="#l00114">IoCmd::LoadResourceArguments::row0</a>, <a class="el" href="#l00118">IoCmd::LoadResourceArguments::row1</a>, and <a class="el" href="#l00853">TFilePath::withParentDir()</a>.</p>

<p class="reference">Referenced by <a class="el" href="#l01166">LoadLevelPopup::execute()</a>, <a class="el" href="#l01550">SaveLevelAsPopup::execute()</a>, <a class="el" href="#l01783">ReplaceLevelPopup::execute()</a>, and <a class="el" href="#l00521">loadResourceFolders()</a>.</p>

</div>
</div>
<a id="a576f240ddca3be721c59540731b8547f" name="a576f240ddca3be721c59540731b8547f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a576f240ddca3be721c59540731b8547f">&#9670;&nbsp;</a></span>loadScene() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::loadScene </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2091</span>                      {</div>
<div class="line"><span class="lineno"> 2092</span>  <a class="code hl_class" href="class_t_selection.html">TSelection</a> *oldSelection =</div>
<div class="line"><span class="lineno"> 2093</span>      <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#a6e0ee1978807a89009571ed5ce44323b">getCurrentSelection</a>()-&gt;getSelection();</div>
<div class="line"><span class="lineno"> 2094</span>  <a class="code hl_class" href="class_file_selection.html">FileSelection</a> *fileSelection =</div>
<div class="line"><span class="lineno"> 2095</span>      <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_file_selection.html">FileSelection</a> *<span class="keyword">&gt;</span>(TSelection::getCurrent());</div>
<div class="line"><span class="lineno"> 2096</span>  <span class="keywordflow">if</span> (fileSelection) {</div>
<div class="line"><span class="lineno"> 2097</span>    std::vector&lt;TFilePath&gt; files;</div>
<div class="line"><span class="lineno"> 2098</span>    fileSelection-&gt;getSelectedFiles(files);</div>
<div class="line"><span class="lineno"> 2099</span>    <span class="keywordflow">if</span> (files.size() == 1 &amp;&amp; files[0] != <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>() &amp;&amp;</div>
<div class="line"><span class="lineno"> 2100</span>        files[0].<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() == <span class="stringliteral">&quot;tnz&quot;</span>)</div>
<div class="line"><span class="lineno"> 2101</span>      <span class="keywordflow">return</span> loadScene(files[0]);</div>
<div class="line"><span class="lineno"> 2102</span>  }</div>
<div class="line"><span class="lineno"> 2103</span> </div>
<div class="line"><span class="lineno"> 2104</span>  <span class="keyword">static</span> <a class="code hl_class" href="class_load_scene_popup.html">LoadScenePopup</a> *popup = 0;</div>
<div class="line"><span class="lineno"> 2105</span>  <span class="keywordflow">if</span> (!popup) {</div>
<div class="line"><span class="lineno"> 2106</span>    popup = <span class="keyword">new</span> <a class="code hl_class" href="class_load_scene_popup.html">LoadScenePopup</a>();</div>
<div class="line"><span class="lineno"> 2107</span>  }</div>
<div class="line"><span class="lineno"> 2108</span>  <span class="keywordtype">int</span> ret = popup-&gt;exec();</div>
<div class="line"><span class="lineno"> 2109</span>  <span class="keywordflow">if</span> (ret == QDialog::Accepted) {</div>
<div class="line"><span class="lineno"> 2110</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2111</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2112</span>    <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#a6e0ee1978807a89009571ed5ce44323b">getCurrentSelection</a>()-&gt;setSelection(oldSelection);</div>
<div class="line"><span class="lineno"> 2113</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2114</span>  }</div>
<div class="line"><span class="lineno"> 2115</span>}</div>
<div class="ttc" id="aclass_file_selection_html"><div class="ttname"><a href="class_file_selection.html">FileSelection</a></div><div class="ttdef"><b>Definition:</b> fileselection.h:16</div></div>
<div class="ttc" id="aclass_load_scene_popup_html"><div class="ttname"><a href="class_load_scene_popup.html">LoadScenePopup</a></div><div class="ttdef"><b>Definition:</b> filebrowserpopup.h:206</div></div>
<div class="ttc" id="aclass_t_app_html_a6e0ee1978807a89009571ed5ce44323b"><div class="ttname"><a href="class_t_app.html#a6e0ee1978807a89009571ed5ce44323b">TApp::getCurrentSelection</a></div><div class="ttdeci">TSelectionHandle * getCurrentSelection() const override</div><div class="ttdef"><b>Definition:</b> tapp.h:134</div></div>
<div class="ttc" id="aclass_t_selection_html"><div class="ttname"><a href="class_t_selection.html">TSelection</a></div><div class="ttdef"><b>Definition:</b> selection.h:26</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aacb798ecd90262670a20d3cdc9730d92" name="aacb798ecd90262670a20d3cdc9730d92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacb798ecd90262670a20d3cdc9730d92">&#9670;&nbsp;</a></span>loadScene() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::loadScene </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>scenePath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>updateRecentFile</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>checkSaveOldScene</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1833</span>                                              {</div>
<div class="line"><span class="lineno"> 1834</span>  RenderingSuspender suspender;</div>
<div class="line"><span class="lineno"> 1835</span> </div>
<div class="line"><span class="lineno"> 1836</span>  <span class="keywordflow">if</span> (checkSaveOldScene)</div>
<div class="line"><span class="lineno"> 1837</span>    <span class="keywordflow">if</span> (!saveSceneIfNeeded(QApplication::tr(<span class="stringliteral">&quot;Load Scene&quot;</span>))) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1838</span>  assert(!path.isEmpty());</div>
<div class="line"><span class="lineno"> 1839</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> scenePath = path;</div>
<div class="line"><span class="lineno"> 1840</span>  <span class="keywordtype">bool</span> importScene    = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1841</span>  <span class="keywordtype">bool</span> isXdts         = scenePath.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() == <span class="stringliteral">&quot;xdts&quot;</span>;</div>
<div class="line"><span class="lineno"> 1842</span>  <span class="keywordflow">if</span> (scenePath.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() == <span class="stringliteral">&quot;&quot;</span>) scenePath = scenePath.<a class="code hl_function" href="class_t_file_path.html#a1437b0e0720e9258b622f68b6858e95d">withType</a>(<span class="stringliteral">&quot;tnz&quot;</span>);</div>
<div class="line"><span class="lineno"> 1843</span>  <span class="keywordflow">if</span> (scenePath.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() != <span class="stringliteral">&quot;tnz&quot;</span> &amp;&amp; !isXdts) {</div>
<div class="line"><span class="lineno"> 1844</span>    QString msg;</div>
<div class="line"><span class="lineno"> 1845</span>    msg = QObject::tr(<span class="stringliteral">&quot;File %1 doesn&#39;t look like a TOONZ Scene&quot;</span>)</div>
<div class="line"><span class="lineno"> 1846</span>              .arg(QString::fromStdWString(scenePath.getWideString()));</div>
<div class="line"><span class="lineno"> 1847</span>    DVGui::error(msg);</div>
<div class="line"><span class="lineno"> 1848</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1849</span>  }</div>
<div class="line"><span class="lineno"> 1850</span>  <span class="keywordflow">if</span> (!TSystem::doesExistFileOrLevel(scenePath)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1851</span> </div>
<div class="line"><span class="lineno"> 1852</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> scenePathTemp(scenePath.getWideString() +</div>
<div class="line"><span class="lineno"> 1853</span>                          QString(<span class="stringliteral">&quot;.tmp&quot;</span>).toStdWString());</div>
<div class="line"><span class="lineno"> 1854</span>  <span class="keywordflow">if</span> (TSystem::doesExistFileOrLevel(scenePathTemp)) {</div>
<div class="line"><span class="lineno"> 1855</span>    QString question =</div>
<div class="line"><span class="lineno"> 1856</span>        QObject::tr(</div>
<div class="line"><span class="lineno"> 1857</span>            <span class="stringliteral">&quot;A prior save of Scene &#39;%1&#39; was critically interrupted. \n\</span></div>
<div class="line"><span class="lineno"> 1858</span><span class="stringliteral">\nA partial save file was generated and changes may be manually salvaged from &#39;%2&#39;.\n\</span></div>
<div class="line"><span class="lineno"> 1859</span><span class="stringliteral">\nDo you wish to continue loading the last good save or stop and try to salvage the prior save?&quot;</span>)</div>
<div class="line"><span class="lineno"> 1860</span>            .arg(QString::fromStdWString(scenePath.getWideString()))</div>
<div class="line"><span class="lineno"> 1861</span>            .arg(QString::fromStdWString(scenePathTemp.getWideString()));</div>
<div class="line"><span class="lineno"> 1862</span>    QString continueAnswer = QObject::tr(<span class="stringliteral">&quot;Continue&quot;</span>);</div>
<div class="line"><span class="lineno"> 1863</span>    QString cancelAnswer   = QObject::tr(<span class="stringliteral">&quot;Cancel&quot;</span>);</div>
<div class="line"><span class="lineno"> 1864</span>    <span class="keywordtype">int</span> ret = DVGui::MsgBox(question, continueAnswer, cancelAnswer, 0);</div>
<div class="line"><span class="lineno"> 1865</span>    <span class="keywordflow">if</span> (ret == 2)</div>
<div class="line"><span class="lineno"> 1866</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1867</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1868</span>      TSystem::removeFileOrLevel(scenePathTemp);</div>
<div class="line"><span class="lineno"> 1869</span>  }</div>
<div class="line"><span class="lineno"> 1870</span> </div>
<div class="line"><span class="lineno"> 1871</span>  <a class="code hl_class" href="class_t_project_manager.html">TProjectManager</a> *pm    = <a class="code hl_function" href="class_t_project_manager.html#a150ca0d6e2eb171b8117b0c5f03dbfad">TProjectManager::instance</a>();</div>
<div class="line"><span class="lineno"> 1872</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TProjectP</a> sceneProject = pm-&gt;<a class="code hl_function" href="class_t_project_manager.html#adcc7fc8cb7656b12f54b773ee6448735">loadSceneProject</a>(scenePath);</div>
<div class="line"><span class="lineno"> 1873</span>  <span class="keywordflow">if</span> (!sceneProject) {</div>
<div class="line"><span class="lineno"> 1874</span>    QString msg;</div>
<div class="line"><span class="lineno"> 1875</span>    msg = QObject::tr(</div>
<div class="line"><span class="lineno"> 1876</span>              <span class="stringliteral">&quot;It is not possible to load the scene %1 because it does not &quot;</span></div>
<div class="line"><span class="lineno"> 1877</span>              <span class="stringliteral">&quot;belong to any project.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1878</span>              .arg(QString::fromStdWString(scenePath.getWideString()));</div>
<div class="line"><span class="lineno"> 1879</span>    DVGui::warning(msg);</div>
<div class="line"><span class="lineno"> 1880</span>  }</div>
<div class="line"><span class="lineno"> 1881</span>  <span class="keywordflow">if</span> (sceneProject &amp;&amp; !sceneProject-&gt;isCurrent()) {</div>
<div class="line"><span class="lineno"> 1882</span>    QString currentProjectName = QString::fromStdWString(</div>
<div class="line"><span class="lineno"> 1883</span>        pm-&gt;<a class="code hl_function" href="class_t_project_manager.html#a5267cfeae48d4e7585c3fc56d8d5b0b3">getCurrentProject</a>()-&gt;getName().getWideString());</div>
<div class="line"><span class="lineno"> 1884</span>    QString sceneProjectName =</div>
<div class="line"><span class="lineno"> 1885</span>        QString::fromStdWString(sceneProject-&gt;getName().getWideString());</div>
<div class="line"><span class="lineno"> 1886</span> </div>
<div class="line"><span class="lineno"> 1887</span>    <span class="comment">/*QString question = &quot;The Scene &#39;&quot;</span></div>
<div class="line"><span class="lineno"> 1888</span><span class="comment">            + QString::fromStdWString(scenePath.getWideString())</span></div>
<div class="line"><span class="lineno"> 1889</span><span class="comment">+ &quot;&#39; belongs to project &#39;&quot; + sceneProjectName + &quot;&#39;.\n&quot;</span></div>
<div class="line"><span class="lineno"> 1890</span><span class="comment">+ &quot;What do you want to do?&quot;;*/</span></div>
<div class="line"><span class="lineno"> 1891</span>    QString question =</div>
<div class="line"><span class="lineno"> 1892</span>        QObject::tr(</div>
<div class="line"><span class="lineno"> 1893</span>            <span class="stringliteral">&quot;The Scene &#39;%1&#39; belongs to project &#39;%2&#39;.\nWhat do you want to do?&quot;</span>)</div>
<div class="line"><span class="lineno"> 1894</span>            .arg(QString::fromStdWString(scenePath.getWideString()))</div>
<div class="line"><span class="lineno"> 1895</span>            .arg(sceneProjectName);</div>
<div class="line"><span class="lineno"> 1896</span>    QString importAnswer        = QObject::tr(<span class="stringliteral">&quot;Import Scene&quot;</span>);</div>
<div class="line"><span class="lineno"> 1897</span>    QString switchProjectAnswer = QObject::tr(<span class="stringliteral">&quot;Change Project&quot;</span>);</div>
<div class="line"><span class="lineno"> 1898</span>    QString cancelAnswer        = QObject::tr(<span class="stringliteral">&quot;Cancel&quot;</span>);</div>
<div class="line"><span class="lineno"> 1899</span>    <span class="keywordtype">int</span> ret = DVGui::MsgBox(question, importAnswer, switchProjectAnswer,</div>
<div class="line"><span class="lineno"> 1900</span>                            cancelAnswer, 0);</div>
<div class="line"><span class="lineno"> 1901</span>    <span class="keywordflow">if</span> (ret == 3 || ret == 0) {</div>
<div class="line"><span class="lineno"> 1902</span>      newScene();</div>
<div class="line"><span class="lineno"> 1903</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1904</span>    }</div>
<div class="line"><span class="lineno"> 1905</span>    <span class="keywordflow">if</span> (ret == 2)</div>
<div class="line"><span class="lineno"> 1906</span>      pm-&gt;<a class="code hl_function" href="class_t_project_manager.html#aa55b362becc698e787db40c822f79bc3">setCurrentProjectPath</a>(sceneProject-&gt;getProjectPath());</div>
<div class="line"><span class="lineno"> 1907</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1908</span>      importScene = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1909</span>  }</div>
<div class="line"><span class="lineno"> 1910</span>  QApplication::setOverrideCursor(Qt::WaitCursor);</div>
<div class="line"><span class="lineno"> 1911</span> </div>
<div class="line"><span class="lineno"> 1912</span>  TUndoManager::manager()-&gt;reset();</div>
<div class="line"><span class="lineno"> 1913</span>  IconGenerator::instance()-&gt;clearRequests();</div>
<div class="line"><span class="lineno"> 1914</span>  IconGenerator::instance()-&gt;clearSceneIcons();</div>
<div class="line"><span class="lineno"> 1915</span>  ImageManager::instance()-&gt;<a class="code hl_function" href="class_image_manager.html#af1cdc120ba64146849566808dfdb8f9c">clear</a>();</div>
<div class="line"><span class="lineno"> 1916</span> </div>
<div class="line"><span class="lineno"> 1917</span>  CacheFxCommand::instance()-&gt;onNewScene();</div>
<div class="line"><span class="lineno"> 1918</span> </div>
<div class="line"><span class="lineno"> 1919</span><span class="preprocessor">#ifdef USE_SQLITE_HDPOOL</span></div>
<div class="line"><span class="lineno"> 1920</span>  <span class="comment">// INTERMEDIATE CACHE RESULTS MANAGEMENT: Clear all resources not accessed in</span></div>
<div class="line"><span class="lineno"> 1921</span>  <span class="comment">// the last 2 sessions</span></div>
<div class="line"><span class="lineno"> 1922</span>  TCacheResourcePool::instance()-&gt;clearAccessedAfterSessions(</div>
<div class="line"><span class="lineno"> 1923</span>      1);  <span class="comment">// 0 would be after this session</span></div>
<div class="line"><span class="lineno"> 1924</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1925</span> </div>
<div class="line"><span class="lineno"> 1926</span>  <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a> *scene = <span class="keyword">new</span> <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a>();</div>
<div class="line"><span class="lineno"> 1927</span>  TImageStyle::setCurrentScene(scene);</div>
<div class="line"><span class="lineno"> 1928</span>  printf(<span class="stringliteral">&quot;%s:%s Progressing:\n&quot;</span>, __FILE__, __FUNCTION__);</div>
<div class="line"><span class="lineno"> 1929</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1930</span>    <span class="keywordflow">if</span> (isXdts)</div>
<div class="line"><span class="lineno"> 1931</span>      XdtsIo::loadXdtsScene(scene, scenePath);</div>
<div class="line"><span class="lineno"> 1932</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1933</span>      <span class="comment">/*-- Load --*/</span></div>
<div class="line"><span class="lineno"> 1934</span>      scene-&gt;load(scenePath);</div>
<div class="line"><span class="lineno"> 1935</span>    <span class="comment">// import if needed</span></div>
<div class="line"><span class="lineno"> 1936</span>    <a class="code hl_class" href="class_t_project_manager.html">TProjectManager</a> *pm      = <a class="code hl_function" href="class_t_project_manager.html#a150ca0d6e2eb171b8117b0c5f03dbfad">TProjectManager::instance</a>();</div>
<div class="line"><span class="lineno"> 1937</span>    <a class="code hl_class" href="class_t_smart_pointer_t.html">TProjectP</a> currentProject = pm-&gt;<a class="code hl_function" href="class_t_project_manager.html#a5267cfeae48d4e7585c3fc56d8d5b0b3">getCurrentProject</a>();</div>
<div class="line"><span class="lineno"> 1938</span>    <span class="keywordflow">if</span> (!scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#afec1477d4fe0bb1e1152e80c3a0b20ab">getProject</a>() || scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#afec1477d4fe0bb1e1152e80c3a0b20ab">getProject</a>()-&gt;<a class="code hl_function" href="class_t_project.html#ab97b51d9527c7ede8dc52dc0007dc27b">getProjectPath</a>() !=</div>
<div class="line"><span class="lineno"> 1939</span>                                    currentProject-&gt;getProjectPath()) {</div>
<div class="line"><span class="lineno"> 1940</span>      ResourceImportDialog resourceLoader;</div>
<div class="line"><span class="lineno"> 1941</span>      <span class="comment">// resourceLoader.setImportEnabled(true);</span></div>
<div class="line"><span class="lineno"> 1942</span>      <a class="code hl_class" href="class_resource_importer.html">ResourceImporter</a> importer(scene, currentProject.getPointer(),</div>
<div class="line"><span class="lineno"> 1943</span>                                resourceLoader);</div>
<div class="line"><span class="lineno"> 1944</span>      <a class="code hl_class" href="class_scene_resources.html">SceneResources</a> resources(scene, scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ae3c828e3223fd809fd59189233d0576a">getXsheet</a>());</div>
<div class="line"><span class="lineno"> 1945</span>      resources.accept(&amp;importer);</div>
<div class="line"><span class="lineno"> 1946</span>      scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a815ecf4f07a92f9f9fef693f762c1228">setScenePath</a>(importer.getImportedScenePath());</div>
<div class="line"><span class="lineno"> 1947</span>      scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa7aac33fc53c47ea5baff597e5f18a9b">setProject</a>(currentProject.getPointer());</div>
<div class="line"><span class="lineno"> 1948</span>    }</div>
<div class="line"><span class="lineno"> 1949</span>    VersionControlManager::instance()-&gt;setFrameRange(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ac1a8bf0d2cec4f59c87b0001991264b5">getLevelSet</a>());</div>
<div class="line"><span class="lineno"> 1950</span>  } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno"> 1951</span>    printf(<span class="stringliteral">&quot;%s:%s Exception ...:\n&quot;</span>, __FILE__, __FUNCTION__);</div>
<div class="line"><span class="lineno"> 1952</span>    QString msg;</div>
<div class="line"><span class="lineno"> 1953</span>    msg = QObject::tr(</div>
<div class="line"><span class="lineno"> 1954</span>              <span class="stringliteral">&quot;There were problems loading the scene %1.\n Some files may be &quot;</span></div>
<div class="line"><span class="lineno"> 1955</span>              <span class="stringliteral">&quot;missing.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1956</span>              .arg(QString::fromStdWString(scenePath.getWideString()));</div>
<div class="line"><span class="lineno"> 1957</span>    DVGui::warning(msg);</div>
<div class="line"><span class="lineno"> 1958</span>  }</div>
<div class="line"><span class="lineno"> 1959</span>  printf(<span class="stringliteral">&quot;%s:%s end load:\n&quot;</span>, __FILE__, __FUNCTION__);</div>
<div class="line"><span class="lineno"> 1960</span>  <a class="code hl_class" href="class_t_project.html">TProject</a> *project = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#afec1477d4fe0bb1e1152e80c3a0b20ab">getProject</a>();</div>
<div class="line"><span class="lineno"> 1961</span>  <span class="keywordflow">if</span> (!project) {</div>
<div class="line"><span class="lineno"> 1962</span>    project = <span class="keyword">new</span> <a class="code hl_class" href="class_t_project.html">TProject</a>();</div>
<div class="line"><span class="lineno"> 1963</span>    project-&gt;setFolder(<span class="stringliteral">&quot;project&quot;</span>, scenePath);</div>
<div class="line"><span class="lineno"> 1964</span>    scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa7aac33fc53c47ea5baff597e5f18a9b">setProject</a>(project);</div>
<div class="line"><span class="lineno"> 1965</span>  }</div>
<div class="line"><span class="lineno"> 1966</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 1967</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;setScene(scene);</div>
<div class="line"><span class="lineno"> 1968</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;notifyNameSceneChange();</div>
<div class="line"><span class="lineno"> 1969</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#a35516f8175dab3ccdf3d6d3c3e5f59ae">getCurrentFrame</a>()-&gt;setFrame(0);</div>
<div class="line"><span class="lineno"> 1970</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#a1e294e7cff300851d12a8c3d196943f6">getCurrentColumn</a>()-&gt;setColumnIndex(0);</div>
<div class="line"><span class="lineno"> 1971</span>  <a class="code hl_class" href="class_t_palette.html">TPalette</a> *palette = 0;</div>
<div class="line"><span class="lineno"> 1972</span>  <span class="keywordflow">if</span> (app-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>() &amp;&amp; app-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>()-&gt;getSimpleLevel())</div>
<div class="line"><span class="lineno"> 1973</span>    palette = app-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>()-&gt;getSimpleLevel()-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a9aea4f8e34caef293d5e5c7694047564">getPalette</a>();</div>
<div class="line"><span class="lineno"> 1974</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#a33dbcbc578915e0b69fe6927b74cf426">getCurrentPalette</a>()-&gt;setPalette(palette);</div>
<div class="line"><span class="lineno"> 1975</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">getCurrentXsheet</a>()-&gt;notifyXsheetSoundChanged();</div>
<div class="line"><span class="lineno"> 1976</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#a0d91c122eec2b756b7c4780014e49f9e">getCurrentObject</a>()-&gt;setIsSpline(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1977</span> </div>
<div class="line"><span class="lineno"> 1978</span>  Previewer::clearAll();</div>
<div class="line"><span class="lineno"> 1979</span>  <a class="code hl_function" href="class_preview_fx_manager.html#a540923ef1e799396ddf8bba11bb3c8c6">PreviewFxManager::instance</a>()-&gt;<a class="code hl_function" href="class_preview_fx_manager.html#a3cf458cfc0955a610007cb537638d592">reset</a>();</div>
<div class="line"><span class="lineno"> 1980</span>  <span class="comment">// updateCleanupSettingsPopup();</span></div>
<div class="line"><span class="lineno"> 1981</span>  <span class="comment">/*- CleanupParameter -*/</span></div>
<div class="line"><span class="lineno"> 1982</span>  <a class="code hl_class" href="class_cleanup_parameters.html">CleanupParameters</a> *cp = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a8ef96fedc17d7def810ac419b0939254">getProperties</a>()-&gt;<a class="code hl_function" href="class_t_scene_properties.html#a84e6735bb0b0ea5054b9592c9612aff9">getCleanupParameters</a>();</div>
<div class="line"><span class="lineno"> 1983</span>  CleanupParameters::GlobalParameters.assign(cp);</div>
<div class="line"><span class="lineno"> 1984</span> </div>
<div class="line"><span class="lineno"> 1985</span>  CacheFxCommand::instance()-&gt;onSceneLoaded();</div>
<div class="line"><span class="lineno"> 1986</span> </div>
<div class="line"><span class="lineno"> 1987</span><span class="preprocessor">#ifdef USE_SQLITE_HDPOOL</span></div>
<div class="line"><span class="lineno"> 1988</span>  TCacheResourcePool::instance()-&gt;<a class="code hl_function" href="class_t_cache_resource_pool.html#afc0d81a64dacaacdad079fb1c3edb9f8">setPath</a>(</div>
<div class="line"><span class="lineno"> 1989</span>      QString::fromStdWString(</div>
<div class="line"><span class="lineno"> 1990</span>          ToonzFolder::getCacheRootFolder().getWideString()),</div>
<div class="line"><span class="lineno"> 1991</span>      QString::fromStdWString(project-&gt;<a class="code hl_function" href="class_t_project.html#a258a4b6435978b730722a92ab104cd89">getName</a>().getWideName()),</div>
<div class="line"><span class="lineno"> 1992</span>      QString::fromStdWString(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a1fa0a1cbf9eb6360d980392acc99924b">getSceneName</a>()));</div>
<div class="line"><span class="lineno"> 1993</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1994</span> </div>
<div class="line"><span class="lineno"> 1995</span>  UnitParameters::setFieldGuideAspectRatio(</div>
<div class="line"><span class="lineno"> 1996</span>      scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a8ef96fedc17d7def810ac419b0939254">getProperties</a>()-&gt;<a class="code hl_function" href="class_t_scene_properties.html#ab4d1ebda4565709e8b66387c72b03fdb">getFieldGuideAspectRatio</a>());</div>
<div class="line"><span class="lineno"> 1997</span>  IconGenerator::instance()-&gt;invalidateSceneIcon();</div>
<div class="line"><span class="lineno"> 1998</span>  DvDirModel::instance()-&gt;refreshFolder(scenePath.<a class="code hl_function" href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">getParentDir</a>());</div>
<div class="line"><span class="lineno"> 1999</span>  <span class="comment">// set dirty for xdts files since converted tnz is not yet saved</span></div>
<div class="line"><span class="lineno"> 2000</span>  <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;setDirtyFlag(isXdts);</div>
<div class="line"><span class="lineno"> 2001</span>  History::instance()-&gt;addItem(scenePath);</div>
<div class="line"><span class="lineno"> 2002</span>  <span class="keywordflow">if</span> (updateRecentFile)</div>
<div class="line"><span class="lineno"> 2003</span>    RecentFiles::instance()-&gt;addFilePath(</div>
<div class="line"><span class="lineno"> 2004</span>        toQString(scenePath), RecentFiles::Scene,</div>
<div class="line"><span class="lineno"> 2005</span>        QString::fromStdString(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#afec1477d4fe0bb1e1152e80c3a0b20ab">getProject</a>()-&gt;<a class="code hl_function" href="class_t_project.html#a258a4b6435978b730722a92ab104cd89">getName</a>().<a class="code hl_function" href="class_t_file_path.html#af94f9b0aeceb6cdb980fa1789473503a">getName</a>()));</div>
<div class="line"><span class="lineno"> 2006</span>  QApplication::restoreOverrideCursor();</div>
<div class="line"><span class="lineno"> 2007</span> </div>
<div class="line"><span class="lineno"> 2008</span>  <span class="keywordtype">int</span> forbiddenLevelCount = 0;</div>
<div class="line"><span class="lineno"> 2009</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ac1a8bf0d2cec4f59c87b0001991264b5">getLevelSet</a>()-&gt;getLevelCount(); i++) {</div>
<div class="line"><span class="lineno"> 2010</span>    <a class="code hl_class" href="class_t_xsh_level.html">TXshLevel</a> *xl = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ac1a8bf0d2cec4f59c87b0001991264b5">getLevelSet</a>()-&gt;getLevel(i);</div>
<div class="line"><span class="lineno"> 2011</span>    <span class="keywordflow">if</span> (xl &amp;&amp; xl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a023065559cff76164ecb6344c586ba27">getSimpleLevel</a>() &amp;&amp;</div>
<div class="line"><span class="lineno"> 2012</span>        xl-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a023065559cff76164ecb6344c586ba27">getSimpleLevel</a>()-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#ad412dd5c3a6ae3ff20a480dc728b26d2">getProperties</a>()-&gt;<a class="code hl_function" href="class_level_properties.html#a068ff23123a2afeeedbe2eeacccf6299">isForbidden</a>())</div>
<div class="line"><span class="lineno"> 2013</span>      forbiddenLevelCount++;</div>
<div class="line"><span class="lineno"> 2014</span>  }</div>
<div class="line"><span class="lineno"> 2015</span>  <span class="keywordflow">if</span> (forbiddenLevelCount &gt; 0) {</div>
<div class="line"><span class="lineno"> 2016</span>    QString msg;</div>
<div class="line"><span class="lineno"> 2017</span>    msg = QObject::tr(</div>
<div class="line"><span class="lineno"> 2018</span>              <span class="stringliteral">&quot;There were problems loading the scene %1.\nSome levels have not &quot;</span></div>
<div class="line"><span class="lineno"> 2019</span>              <span class="stringliteral">&quot;been loaded because their version is not supported&quot;</span>)</div>
<div class="line"><span class="lineno"> 2020</span>              .arg(QString::fromStdWString(scenePath.getWideString()));</div>
<div class="line"><span class="lineno"> 2021</span>    DVGui::warning(msg);</div>
<div class="line"><span class="lineno"> 2022</span>  }</div>
<div class="line"><span class="lineno"> 2023</span> </div>
<div class="line"><span class="lineno"> 2024</span>  <span class="keywordtype">bool</span> exist = TSystem::doesExistFileOrLevel(</div>
<div class="line"><span class="lineno"> 2025</span>      scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad42b52b671b094f66e003c4b7ebefd45">getScenePath</a>()));</div>
<div class="line"><span class="lineno"> 2026</span>  QAction *act = CommandManager::instance()-&gt;getAction(MI_RevertScene);</div>
<div class="line"><span class="lineno"> 2027</span>  <span class="keywordflow">if</span> (act) act-&gt;setEnabled(exist);</div>
<div class="line"><span class="lineno"> 2028</span> </div>
<div class="line"><span class="lineno"> 2029</span>  <span class="comment">// check if the output dpi is incompatible with pixels only mode</span></div>
<div class="line"><span class="lineno"> 2030</span>  <span class="keywordflow">if</span> (Preferences::instance()-&gt;getPixelsOnly()) {</div>
<div class="line"><span class="lineno"> 2031</span>    <a class="code hl_class" href="class_t_point_t.html">TPointD</a> dpi = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a750b5ab623ccec744013b0c83bf20abc">getCurrentCamera</a>()-&gt;<a class="code hl_function" href="class_t_camera.html#adf45510b5dc53f6481308ef489fbd5a9">getDpi</a>();</div>
<div class="line"><span class="lineno"> 2032</span>    <span class="keywordflow">if</span> (!areAlmostEqual(dpi.x, Stage::standardDpi, 0.1) ||</div>
<div class="line"><span class="lineno"> 2033</span>        !areAlmostEqual(dpi.y, Stage::standardDpi, 0.1)) {</div>
<div class="line"><span class="lineno"> 2034</span>      QString question = QObject::tr(</div>
<div class="line"><span class="lineno"> 2035</span>          <span class="stringliteral">&quot;This scene is incompatible with pixels only mode of the current &quot;</span></div>
<div class="line"><span class="lineno"> 2036</span>          <span class="stringliteral">&quot;OpenToonz version.\nWhat would you like to do?&quot;</span>);</div>
<div class="line"><span class="lineno"> 2037</span>      QString turnOffPixelAnswer = QObject::tr(<span class="stringliteral">&quot;Turn off pixels only mode&quot;</span>);</div>
<div class="line"><span class="lineno"> 2038</span>      QString resizeSceneAnswer =</div>
<div class="line"><span class="lineno"> 2039</span>          QObject::tr(<span class="stringliteral">&quot;Keep pixels only mode on and resize the scene&quot;</span>);</div>
<div class="line"><span class="lineno"> 2040</span>      <span class="keywordtype">int</span> ret =</div>
<div class="line"><span class="lineno"> 2041</span>          DVGui::MsgBox(question, turnOffPixelAnswer, resizeSceneAnswer, 0);</div>
<div class="line"><span class="lineno"> 2042</span>      <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line"><span class="lineno"> 2043</span>      }                     <span class="comment">// do nothing</span></div>
<div class="line"><span class="lineno"> 2044</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == 1) {  <span class="comment">// Turn off pixels only mode</span></div>
<div class="line"><span class="lineno"> 2045</span>        Preferences::instance()-&gt;setValue(pixelsOnly, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2046</span>        app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;notifyPixelUnitSelected(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2047</span>      } <span class="keywordflow">else</span> {  <span class="comment">// ret = 2 : Resize the scene</span></div>
<div class="line"><span class="lineno"> 2048</span>        <a class="code hl_class" href="class_t_dimension_t.html">TDimensionD</a> camSize = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a750b5ab623ccec744013b0c83bf20abc">getCurrentCamera</a>()-&gt;<a class="code hl_function" href="class_t_camera.html#a6f561eca912177c2150b3e57816f02f6">getSize</a>();</div>
<div class="line"><span class="lineno"> 2049</span>        <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a> camRes(camSize.lx * Stage::standardDpi,</div>
<div class="line"><span class="lineno"> 2050</span>                          camSize.ly * Stage::standardDpi);</div>
<div class="line"><span class="lineno"> 2051</span>        scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a750b5ab623ccec744013b0c83bf20abc">getCurrentCamera</a>()-&gt;<a class="code hl_function" href="class_t_camera.html#a10db423cceb7e3696e6db43409c565f4">setRes</a>(camRes);</div>
<div class="line"><span class="lineno"> 2052</span>        app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;setDirtyFlag(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2053</span>        app-&gt;<a class="code hl_function" href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">getCurrentXsheet</a>()-&gt;notifyXsheetChanged();</div>
<div class="line"><span class="lineno"> 2054</span>      }</div>
<div class="line"><span class="lineno"> 2055</span>    }</div>
<div class="line"><span class="lineno"> 2056</span>  }</div>
<div class="line"><span class="lineno"> 2057</span> </div>
<div class="line"><span class="lineno"> 2058</span>  <span class="comment">// Check if the scene saved with the previous version AND the premultiply</span></div>
<div class="line"><span class="lineno"> 2059</span>  <span class="comment">// option is set to PNG level setting</span></div>
<div class="line"><span class="lineno"> 2060</span>  <span class="keywordflow">if</span> (scene-&gt;getVersionNumber() &lt;</div>
<div class="line"><span class="lineno"> 2061</span>      VersionNumber(71, 1)) {  <span class="comment">// V1.4 = 71.0 , V1.5 = 71.1</span></div>
<div class="line"><span class="lineno"> 2062</span>    QStringList modifiedPNGLevelNames;</div>
<div class="line"><span class="lineno"> 2063</span>    std::vector&lt;TXshLevel *&gt; levels;</div>
<div class="line"><span class="lineno"> 2064</span>    scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ac1a8bf0d2cec4f59c87b0001991264b5">getLevelSet</a>()-&gt;listLevels(levels);</div>
<div class="line"><span class="lineno"> 2065</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> level : levels) {</div>
<div class="line"><span class="lineno"> 2066</span>      <span class="keywordflow">if</span> (!level || !level-&gt;getSimpleLevel()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2067</span>      <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> path = level-&gt;getPath();</div>
<div class="line"><span class="lineno"> 2068</span>      <span class="keywordflow">if</span> (path.isEmpty() || path.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() != <span class="stringliteral">&quot;png&quot;</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2069</span>      <span class="keywordflow">if</span> (level-&gt;getSimpleLevel()-&gt;getProperties()-&gt;doPremultiply()) {</div>
<div class="line"><span class="lineno"> 2070</span>        level-&gt;getSimpleLevel()-&gt;getProperties()-&gt;setDoPremultiply(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2071</span>        modifiedPNGLevelNames.append(QString::fromStdWString(level-&gt;getName()));</div>
<div class="line"><span class="lineno"> 2072</span>      }</div>
<div class="line"><span class="lineno"> 2073</span>    }</div>
<div class="line"><span class="lineno"> 2074</span>    <span class="keywordflow">if</span> (!modifiedPNGLevelNames.isEmpty()) {</div>
<div class="line"><span class="lineno"> 2075</span>      DVGui::info(QObject::tr(<span class="stringliteral">&quot;The Premultiply options in the following levels &quot;</span></div>
<div class="line"><span class="lineno"> 2076</span>                              <span class="stringliteral">&quot;are disabled, since PNG files are premultiplied &quot;</span></div>
<div class="line"><span class="lineno"> 2077</span>                              <span class="stringliteral">&quot;on loading in the current version: %1&quot;</span>)</div>
<div class="line"><span class="lineno"> 2078</span>                      .arg(modifiedPNGLevelNames.join(<span class="stringliteral">&quot;, &quot;</span>)));</div>
<div class="line"><span class="lineno"> 2079</span>      app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;setDirtyFlag(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2080</span>    }</div>
<div class="line"><span class="lineno"> 2081</span>  }</div>
<div class="line"><span class="lineno"> 2082</span> </div>
<div class="line"><span class="lineno"> 2083</span>  printf(<span class="stringliteral">&quot;%s:%s loadScene() completed :\n&quot;</span>, __FILE__, __FUNCTION__);</div>
<div class="line"><span class="lineno"> 2084</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2085</span>}</div>
<div class="ttc" id="aclass_cleanup_parameters_html"><div class="ttname"><a href="class_cleanup_parameters.html">CleanupParameters</a></div><div class="ttdef"><b>Definition:</b> cleanupparameters.h:128</div></div>
<div class="ttc" id="aclass_image_manager_html_af1cdc120ba64146849566808dfdb8f9c"><div class="ttname"><a href="class_image_manager.html#af1cdc120ba64146849566808dfdb8f9c">ImageManager::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> imagemanager.cpp:269</div></div>
<div class="ttc" id="aclass_level_properties_html_a068ff23123a2afeeedbe2eeacccf6299"><div class="ttname"><a href="class_level_properties.html#a068ff23123a2afeeedbe2eeacccf6299">LevelProperties::isForbidden</a></div><div class="ttdeci">bool isForbidden() const</div><div class="ttdoc">Returns whether the level is forbidden for editing.</div><div class="ttdef"><b>Definition:</b> levelproperties.h:168</div></div>
<div class="ttc" id="aclass_preview_fx_manager_html_a3cf458cfc0955a610007cb537638d592"><div class="ttname"><a href="class_preview_fx_manager.html#a3cf458cfc0955a610007cb537638d592">PreviewFxManager::reset</a></div><div class="ttdeci">void reset(TFxP fx)</div><div class="ttdef"><b>Definition:</b> previewfxmanager.cpp:1539</div></div>
<div class="ttc" id="aclass_preview_fx_manager_html_a540923ef1e799396ddf8bba11bb3c8c6"><div class="ttname"><a href="class_preview_fx_manager.html#a540923ef1e799396ddf8bba11bb3c8c6">PreviewFxManager::instance</a></div><div class="ttdeci">static PreviewFxManager * instance()</div><div class="ttdoc">Returns the instance of the PreviewFxManager object.</div><div class="ttdef"><b>Definition:</b> previewfxmanager.cpp:1219</div></div>
<div class="ttc" id="aclass_resource_importer_html"><div class="ttname"><a href="class_resource_importer.html">ResourceImporter</a></div><div class="ttdef"><b>Definition:</b> sceneresources.h:330</div></div>
<div class="ttc" id="aclass_scene_resources_html"><div class="ttname"><a href="class_scene_resources.html">SceneResources</a></div><div class="ttdef"><b>Definition:</b> sceneresources.h:268</div></div>
<div class="ttc" id="aclass_t_app_html_a0d91c122eec2b756b7c4780014e49f9e"><div class="ttname"><a href="class_t_app.html#a0d91c122eec2b756b7c4780014e49f9e">TApp::getCurrentObject</a></div><div class="ttdeci">TObjectHandle * getCurrentObject() const override</div><div class="ttdef"><b>Definition:</b> tapp.h:130</div></div>
<div class="ttc" id="aclass_t_app_html_a33dbcbc578915e0b69fe6927b74cf426"><div class="ttname"><a href="class_t_app.html#a33dbcbc578915e0b69fe6927b74cf426">TApp::getCurrentPalette</a></div><div class="ttdeci">TPaletteHandle * getCurrentPalette() const override</div><div class="ttdef"><b>Definition:</b> tapp.cpp:253</div></div>
<div class="ttc" id="aclass_t_cache_resource_pool_html_afc0d81a64dacaacdad079fb1c3edb9f8"><div class="ttname"><a href="class_t_cache_resource_pool.html#afc0d81a64dacaacdad079fb1c3edb9f8">TCacheResourcePool::setPath</a></div><div class="ttdeci">void setPath(QString cacheRoot, QString projectName, QString sceneName)</div><div class="ttdef"><b>Definition:</b> tcacheresourcepool.cpp:79</div></div>
<div class="ttc" id="aclass_t_camera_html_a10db423cceb7e3696e6db43409c565f4"><div class="ttname"><a href="class_t_camera.html#a10db423cceb7e3696e6db43409c565f4">TCamera::setRes</a></div><div class="ttdeci">void setRes(const TDimension &amp;res)</div><div class="ttdef"><b>Definition:</b> tcamera.cpp:50</div></div>
<div class="ttc" id="aclass_t_camera_html_a6f561eca912177c2150b3e57816f02f6"><div class="ttname"><a href="class_t_camera.html#a6f561eca912177c2150b3e57816f02f6">TCamera::getSize</a></div><div class="ttdeci">const TDimensionD &amp; getSize() const</div><div class="ttdef"><b>Definition:</b> tcamera.h:55</div></div>
<div class="ttc" id="aclass_t_camera_html_adf45510b5dc53f6481308ef489fbd5a9"><div class="ttname"><a href="class_t_camera.html#adf45510b5dc53f6481308ef489fbd5a9">TCamera::getDpi</a></div><div class="ttdeci">TPointD getDpi() const</div><div class="ttdef"><b>Definition:</b> tcamera.cpp:62</div></div>
<div class="ttc" id="aclass_t_dimension_t_html"><div class="ttname"><a href="class_t_dimension_t.html">TDimensionT&lt; double &gt;</a></div></div>
<div class="ttc" id="aclass_t_file_path_html_a1437b0e0720e9258b622f68b6858e95d"><div class="ttname"><a href="class_t_file_path.html#a1437b0e0720e9258b622f68b6858e95d">TFilePath::withType</a></div><div class="ttdeci">TFilePath withType(const std::string &amp;type) const</div><div class="ttdef"><b>Definition:</b> tfilepath.cpp:774</div></div>
<div class="ttc" id="aclass_t_palette_html"><div class="ttname"><a href="class_t_palette.html">TPalette</a></div><div class="ttdoc">The class representing a Toonz palette object.</div><div class="ttdef"><b>Definition:</b> tpalette.h:85</div></div>
<div class="ttc" id="aclass_t_point_t_html"><div class="ttname"><a href="class_t_point_t.html">TPointT&lt; double &gt;</a></div></div>
<div class="ttc" id="aclass_t_project_html"><div class="ttname"><a href="class_t_project.html">TProject</a></div><div class="ttdoc">Define and handle a toonz project.</div><div class="ttdef"><b>Definition:</b> tproject.h:24</div></div>
<div class="ttc" id="aclass_t_project_html_a258a4b6435978b730722a92ab104cd89"><div class="ttname"><a href="class_t_project.html#a258a4b6435978b730722a92ab104cd89">TProject::getName</a></div><div class="ttdeci">TFilePath getName() const</div><div class="ttdef"><b>Definition:</b> tproject.h:49</div></div>
<div class="ttc" id="aclass_t_project_html_ab97b51d9527c7ede8dc52dc0007dc27b"><div class="ttname"><a href="class_t_project.html#ab97b51d9527c7ede8dc52dc0007dc27b">TProject::getProjectPath</a></div><div class="ttdeci">TFilePath getProjectPath() const</div><div class="ttdef"><b>Definition:</b> tproject.h:50</div></div>
<div class="ttc" id="aclass_t_project_manager_html"><div class="ttname"><a href="class_t_project_manager.html">TProjectManager</a></div><div class="ttdoc">Manages all toonz projects. The class provides all needed method to retrieve projects paths,...</div><div class="ttdef"><b>Definition:</b> tproject.h:106</div></div>
<div class="ttc" id="aclass_t_project_manager_html_a150ca0d6e2eb171b8117b0c5f03dbfad"><div class="ttname"><a href="class_t_project_manager.html#a150ca0d6e2eb171b8117b0c5f03dbfad">TProjectManager::instance</a></div><div class="ttdeci">static TProjectManager * instance()</div><div class="ttdef"><b>Definition:</b> tproject.cpp:777</div></div>
<div class="ttc" id="aclass_t_project_manager_html_a5267cfeae48d4e7585c3fc56d8d5b0b3"><div class="ttname"><a href="class_t_project_manager.html#a5267cfeae48d4e7585c3fc56d8d5b0b3">TProjectManager::getCurrentProject</a></div><div class="ttdeci">TProjectP getCurrentProject()</div><div class="ttdef"><b>Definition:</b> tproject.cpp:993</div></div>
<div class="ttc" id="aclass_t_project_manager_html_aa55b362becc698e787db40c822f79bc3"><div class="ttname"><a href="class_t_project_manager.html#aa55b362becc698e787db40c822f79bc3">TProjectManager::setCurrentProjectPath</a></div><div class="ttdeci">void setCurrentProjectPath(const TFilePath &amp;fp)</div><div class="ttdef"><b>Definition:</b> tproject.cpp:958</div></div>
<div class="ttc" id="aclass_t_project_manager_html_adcc7fc8cb7656b12f54b773ee6448735"><div class="ttname"><a href="class_t_project_manager.html#adcc7fc8cb7656b12f54b773ee6448735">TProjectManager::loadSceneProject</a></div><div class="ttdeci">TProjectP loadSceneProject(const TFilePath &amp;scenePath)</div><div class="ttdef"><b>Definition:</b> tproject.cpp:1015</div></div>
<div class="ttc" id="aclass_t_scene_properties_html_a84e6735bb0b0ea5054b9592c9612aff9"><div class="ttname"><a href="class_t_scene_properties.html#a84e6735bb0b0ea5054b9592c9612aff9">TSceneProperties::getCleanupParameters</a></div><div class="ttdeci">CleanupParameters * getCleanupParameters() const</div><div class="ttdef"><b>Definition:</b> sceneproperties.h:159</div></div>
<div class="ttc" id="aclass_t_scene_properties_html_ab4d1ebda4565709e8b66387c72b03fdb"><div class="ttname"><a href="class_t_scene_properties.html#ab4d1ebda4565709e8b66387c72b03fdb">TSceneProperties::getFieldGuideAspectRatio</a></div><div class="ttdeci">double getFieldGuideAspectRatio() const</div><div class="ttdef"><b>Definition:</b> sceneproperties.h:254</div></div>
<div class="ttc" id="aclass_t_xsh_simple_level_html_a9aea4f8e34caef293d5e5c7694047564"><div class="ttname"><a href="class_t_xsh_simple_level.html#a9aea4f8e34caef293d5e5c7694047564">TXshSimpleLevel::getPalette</a></div><div class="ttdeci">TPalette * getPalette() const</div><div class="ttdoc">Returns a pointer to the shared level palette.</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.cpp:424</div></div>
<div class="ttc" id="aclass_t_xsh_simple_level_html_ad412dd5c3a6ae3ff20a480dc728b26d2"><div class="ttname"><a href="class_t_xsh_simple_level.html#ad412dd5c3a6ae3ff20a480dc728b26d2">TXshSimpleLevel::getProperties</a></div><div class="ttdeci">LevelProperties * getProperties() const</div><div class="ttdoc">&lt; Returns a pointer to the owned level properties.</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.h:109</div></div>
<div class="ttc" id="aclass_toonz_scene_html_a1fa0a1cbf9eb6360d980392acc99924b"><div class="ttname"><a href="class_toonz_scene.html#a1fa0a1cbf9eb6360d980392acc99924b">ToonzScene::getSceneName</a></div><div class="ttdeci">std::wstring getSceneName() const</div><div class="ttdoc">Returns the scene's name.</div><div class="ttdef"><b>Definition:</b> toonzscene.h:64</div></div>
<div class="ttc" id="aclass_toonz_scene_html_a750b5ab623ccec744013b0c83bf20abc"><div class="ttname"><a href="class_toonz_scene.html#a750b5ab623ccec744013b0c83bf20abc">ToonzScene::getCurrentCamera</a></div><div class="ttdeci">TCamera * getCurrentCamera()</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:1472</div></div>
<div class="ttc" id="aclass_toonz_scene_html_a815ecf4f07a92f9f9fef693f762c1228"><div class="ttname"><a href="class_toonz_scene.html#a815ecf4f07a92f9f9fef693f762c1228">ToonzScene::setScenePath</a></div><div class="ttdeci">void setScenePath(const TFilePath &amp;p)</div><div class="ttdoc">Sets the scene's file path.</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:338</div></div>
<div class="ttc" id="aclass_toonz_scene_html_aa7aac33fc53c47ea5baff597e5f18a9b"><div class="ttname"><a href="class_toonz_scene.html#aa7aac33fc53c47ea5baff597e5f18a9b">ToonzScene::setProject</a></div><div class="ttdeci">void setProject(TProject *)</div><div class="ttdoc">Associates a scene to a project.</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:322</div></div>
<div class="ttc" id="aclass_toonz_scene_html_ad42b52b671b094f66e003c4b7ebefd45"><div class="ttname"><a href="class_toonz_scene.html#ad42b52b671b094f66e003c4b7ebefd45">ToonzScene::getScenePath</a></div><div class="ttdeci">TFilePath getScenePath() const</div><div class="ttdoc">Returns the scene's file path.</div><div class="ttdef"><b>Definition:</b> toonzscene.h:59</div></div>
<div class="ttc" id="aclass_toonz_scene_html_afec1477d4fe0bb1e1152e80c3a0b20ab"><div class="ttname"><a href="class_toonz_scene.html#afec1477d4fe0bb1e1152e80c3a0b20ab">ToonzScene::getProject</a></div><div class="ttdeci">TProject * getProject() const</div><div class="ttdoc">Returns a pointer to the project holding a scene instance.</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:334</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa93737c840f2f6389c72c65e178186fc" name="aa93737c840f2f6389c72c65e178186fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa93737c840f2f6389c72c65e178186fc">&#9670;&nbsp;</a></span>loadScene() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::loadScene </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_toonz_scene.html">ToonzScene</a> &amp;&#160;</td>
          <td class="paramname"><em>scene</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>scenePath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>import</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1807</span>                                   {</div>
<div class="line"><span class="lineno"> 1808</span>  <span class="keywordflow">if</span> (!TSystem::doesExistFileOrLevel(scenePath)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1809</span>  scene.load(scenePath);</div>
<div class="line"><span class="lineno"> 1810</span>  <span class="comment">// import if needed</span></div>
<div class="line"><span class="lineno"> 1811</span>  <a class="code hl_class" href="class_t_project_manager.html">TProjectManager</a> *pm      = <a class="code hl_function" href="class_t_project_manager.html#a150ca0d6e2eb171b8117b0c5f03dbfad">TProjectManager::instance</a>();</div>
<div class="line"><span class="lineno"> 1812</span>  <a class="code hl_class" href="class_t_smart_pointer_t.html">TProjectP</a> currentProject = pm-&gt;<a class="code hl_function" href="class_t_project_manager.html#a5267cfeae48d4e7585c3fc56d8d5b0b3">getCurrentProject</a>();</div>
<div class="line"><span class="lineno"> 1813</span>  <span class="keywordflow">if</span> (!scene.<a class="code hl_function" href="class_toonz_scene.html#afec1477d4fe0bb1e1152e80c3a0b20ab">getProject</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1814</span>  <span class="keywordflow">if</span> (scene.<a class="code hl_function" href="class_toonz_scene.html#afec1477d4fe0bb1e1152e80c3a0b20ab">getProject</a>()-&gt;<a class="code hl_function" href="class_t_project.html#ab97b51d9527c7ede8dc52dc0007dc27b">getProjectPath</a>() !=</div>
<div class="line"><span class="lineno"> 1815</span>      currentProject-&gt;getProjectPath()) {</div>
<div class="line"><span class="lineno"> 1816</span>    ResourceImportDialog resourceLoader;</div>
<div class="line"><span class="lineno"> 1817</span>    <span class="comment">// resourceLoader.setImportEnabled(true);</span></div>
<div class="line"><span class="lineno"> 1818</span>    <a class="code hl_class" href="class_resource_importer.html">ResourceImporter</a> importer(&amp;scene, currentProject.getPointer(),</div>
<div class="line"><span class="lineno"> 1819</span>                              resourceLoader);</div>
<div class="line"><span class="lineno"> 1820</span>    <a class="code hl_class" href="class_scene_resources.html">SceneResources</a> resources(&amp;scene, scene.<a class="code hl_function" href="class_toonz_scene.html#ae3c828e3223fd809fd59189233d0576a">getXsheet</a>());</div>
<div class="line"><span class="lineno"> 1821</span>    resources.accept(&amp;importer);</div>
<div class="line"><span class="lineno"> 1822</span>    scene.<a class="code hl_function" href="class_toonz_scene.html#a815ecf4f07a92f9f9fef693f762c1228">setScenePath</a>(importer.getImportedScenePath());</div>
<div class="line"><span class="lineno"> 1823</span>    scene.<a class="code hl_function" href="class_toonz_scene.html#aa7aac33fc53c47ea5baff597e5f18a9b">setProject</a>(currentProject.getPointer());</div>
<div class="line"><span class="lineno"> 1824</span>  }</div>
<div class="line"><span class="lineno"> 1825</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1826</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a869809aa031fe7dccc55472657e459ae" name="a869809aa031fe7dccc55472657e459ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a869809aa031fe7dccc55472657e459ae">&#9670;&nbsp;</a></span>loadSubScene() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::loadSubScene </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2120</span>                         {</div>
<div class="line"><span class="lineno"> 2121</span>  <a class="code hl_class" href="class_t_selection.html">TSelection</a> *oldSelection =</div>
<div class="line"><span class="lineno"> 2122</span>      <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#a6e0ee1978807a89009571ed5ce44323b">getCurrentSelection</a>()-&gt;getSelection();</div>
<div class="line"><span class="lineno"> 2123</span>  <a class="code hl_class" href="class_file_selection.html">FileSelection</a> *fileSelection =</div>
<div class="line"><span class="lineno"> 2124</span>      <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_file_selection.html">FileSelection</a> *<span class="keyword">&gt;</span>(TSelection::getCurrent());</div>
<div class="line"><span class="lineno"> 2125</span> </div>
<div class="line"><span class="lineno"> 2126</span>  <span class="keywordflow">if</span> (fileSelection) {</div>
<div class="line"><span class="lineno"> 2127</span>    <a class="code hl_struct" href="struct_io_cmd_1_1_load_resource_arguments.html">IoCmd::LoadResourceArguments</a> args;</div>
<div class="line"><span class="lineno"> 2128</span>    {</div>
<div class="line"><span class="lineno"> 2129</span>      std::vector&lt;TFilePath&gt; filePaths;</div>
<div class="line"><span class="lineno"> 2130</span>      fileSelection-&gt;getSelectedFiles(filePaths);</div>
<div class="line"><span class="lineno"> 2131</span> </div>
<div class="line"><span class="lineno"> 2132</span>      args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>.assign(filePaths.begin(), filePaths.end());</div>
<div class="line"><span class="lineno"> 2133</span>    }</div>
<div class="line"><span class="lineno"> 2134</span> </div>
<div class="line"><span class="lineno"> 2135</span>    <span class="keywordflow">if</span> (args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>.size() == 1 &amp;&amp;</div>
<div class="line"><span class="lineno"> 2136</span>        args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>[0].m_path != <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>() &amp;&amp;</div>
<div class="line"><span class="lineno"> 2137</span>        args.<a class="code hl_variable" href="struct_io_cmd_1_1_load_resource_arguments.html#a5175016c278fd5a031f149abf4f77cb1">resourceDatas</a>[0].m_path.getType() == <span class="stringliteral">&quot;tnz&quot;</span>) {</div>
<div class="line"><span class="lineno"> 2138</span>      <a class="code hl_function" href="namespace_io_cmd.html#a107f6d3100b922e0c09e9b4aa1a8602a">loadResources</a>(args);</div>
<div class="line"><span class="lineno"> 2139</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2140</span>    }</div>
<div class="line"><span class="lineno"> 2141</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2142</span>    <span class="keyword">static</span> <a class="code hl_class" href="class_load_sub_scene_popup.html">LoadSubScenePopup</a> *popup = 0;</div>
<div class="line"><span class="lineno"> 2143</span>    <span class="keywordflow">if</span> (!popup) {</div>
<div class="line"><span class="lineno"> 2144</span>      popup = <span class="keyword">new</span> <a class="code hl_class" href="class_load_sub_scene_popup.html">LoadSubScenePopup</a>();</div>
<div class="line"><span class="lineno"> 2145</span>      popup-&gt;addFilterType(<span class="stringliteral">&quot;tnz&quot;</span>);</div>
<div class="line"><span class="lineno"> 2146</span>    }</div>
<div class="line"><span class="lineno"> 2147</span>    <span class="keywordtype">int</span> ret = popup-&gt;exec();</div>
<div class="line"><span class="lineno"> 2148</span>    <span class="keywordflow">if</span> (ret == QDialog::Accepted) {</div>
<div class="line"><span class="lineno"> 2149</span>      <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;setDirtyFlag(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2150</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2151</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2152</span>      <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#a6e0ee1978807a89009571ed5ce44323b">getCurrentSelection</a>()-&gt;setSelection(oldSelection);</div>
<div class="line"><span class="lineno"> 2153</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2154</span>    }</div>
<div class="line"><span class="lineno"> 2155</span>  }</div>
<div class="line"><span class="lineno"> 2156</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2157</span>}</div>
<div class="ttc" id="aclass_load_sub_scene_popup_html"><div class="ttname"><a href="class_load_sub_scene_popup.html">LoadSubScenePopup</a></div><div class="ttdef"><b>Definition:</b> filebrowserpopup.h:227</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6331f41f6a68e8fac4d25fbf12a9596" name="af6331f41f6a68e8fac4d25fbf12a9596"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6331f41f6a68e8fac4d25fbf12a9596">&#9670;&nbsp;</a></span>loadSubScene() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::loadSubScene </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>scenePath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2159</span>                                                   {</div>
<div class="line"><span class="lineno"> 2160</span>  <a class="code hl_struct" href="struct_io_cmd_1_1_load_resource_arguments.html">IoCmd::LoadResourceArguments</a> args(scenePath);</div>
<div class="line"><span class="lineno"> 2161</span> </div>
<div class="line"><span class="lineno"> 2162</span>  <span class="keywordflow">if</span> (args.resourceDatas.size() == 1 &amp;&amp;</div>
<div class="line"><span class="lineno"> 2163</span>      args.resourceDatas[0].m_path != <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>() &amp;&amp;</div>
<div class="line"><span class="lineno"> 2164</span>      args.resourceDatas[0].m_path.getType() == <span class="stringliteral">&quot;tnz&quot;</span>) {</div>
<div class="line"><span class="lineno"> 2165</span>    <a class="code hl_function" href="namespace_io_cmd.html#a107f6d3100b922e0c09e9b4aa1a8602a">loadResources</a>(args);</div>
<div class="line"><span class="lineno"> 2166</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2167</span>  }</div>
<div class="line"><span class="lineno"> 2168</span> </div>
<div class="line"><span class="lineno"> 2169</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2170</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0744065a16191fcb9785de9edcef0c39" name="a0744065a16191fcb9785de9edcef0c39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0744065a16191fcb9785de9edcef0c39">&#9670;&nbsp;</a></span>newScene()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IoCmd::newScene </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1312</span>                     {</div>
<div class="line"><span class="lineno"> 1313</span>  RenderingSuspender suspender;</div>
<div class="line"><span class="lineno"> 1314</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app        = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 1315</span>  <span class="keywordtype">double</span> cameraDpi = 120;  <span class="comment">// used to be 64 and 53.33333</span></div>
<div class="line"><span class="lineno"> 1316</span> </div>
<div class="line"><span class="lineno"> 1317</span>  <span class="keywordflow">if</span> (!saveSceneIfNeeded(QApplication::tr(<span class="stringliteral">&quot;New Scene&quot;</span>))) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1318</span> </div>
<div class="line"><span class="lineno"> 1319</span>  IconGenerator::instance()-&gt;clearRequests();</div>
<div class="line"><span class="lineno"> 1320</span>  IconGenerator::instance()-&gt;clearSceneIcons();</div>
<div class="line"><span class="lineno"> 1321</span>  ImageManager::instance()-&gt;<a class="code hl_function" href="class_image_manager.html#af1cdc120ba64146849566808dfdb8f9c">clear</a>();</div>
<div class="line"><span class="lineno"> 1322</span>  FullColorPalette::instance()-&gt;clear();</div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>  CacheFxCommand::instance()-&gt;onNewScene();</div>
<div class="line"><span class="lineno"> 1325</span>  CacheFxCommand::instance()-&gt;onSceneLoaded();</div>
<div class="line"><span class="lineno"> 1326</span> </div>
<div class="line"><span class="lineno"> 1327</span><span class="preprocessor">#ifdef USE_SQLITE_HDPOOL</span></div>
<div class="line"><span class="lineno"> 1328</span>  <span class="comment">// INTERMEDIATE CACHE RESULTS MANAGEMENT: Clear all resources not accessed in</span></div>
<div class="line"><span class="lineno"> 1329</span>  <span class="comment">// the last 2 sessions</span></div>
<div class="line"><span class="lineno"> 1330</span>  TCacheResourcePool::instance()-&gt;clearAccessedAfterSessions(</div>
<div class="line"><span class="lineno"> 1331</span>      1);  <span class="comment">// 0 would be after this session</span></div>
<div class="line"><span class="lineno"> 1332</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>  <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a> *scene = <span class="keyword">new</span> <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a>();</div>
<div class="line"><span class="lineno"> 1335</span>  TImageStyle::setCurrentScene(scene);</div>
<div class="line"><span class="lineno"> 1336</span> </div>
<div class="line"><span class="lineno"> 1337</span>  <a class="code hl_class" href="class_t_camera.html">TCamera</a> *camera = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a750b5ab623ccec744013b0c83bf20abc">getCurrentCamera</a>();</div>
<div class="line"><span class="lineno"> 1338</span>  <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a> res(1920, 1080);</div>
<div class="line"><span class="lineno"> 1339</span>  <span class="comment">// TDimension res(768, 576);</span></div>
<div class="line"><span class="lineno"> 1340</span>  camera-&gt;<a class="code hl_function" href="class_t_camera.html#a10db423cceb7e3696e6db43409c565f4">setRes</a>(res);</div>
<div class="line"><span class="lineno"> 1341</span>  camera-&gt;<a class="code hl_function" href="class_t_camera.html#ac17ef8e563e599d7f1df4755e827de83">setSize</a>(</div>
<div class="line"><span class="lineno"> 1342</span>      <a class="code hl_class" href="class_t_dimension_t.html">TDimensionD</a>((<span class="keywordtype">double</span>)res.lx / cameraDpi, (<span class="keywordtype">double</span>)res.ly / cameraDpi));</div>
<div class="line"><span class="lineno"> 1343</span>  scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a8ef96fedc17d7def810ac419b0939254">getProperties</a>()-&gt;<a class="code hl_function" href="class_t_scene_properties.html#a56b62cc35382ceb147e19df2cf11750d">setBgColor</a>(TPixel32::White);</div>
<div class="line"><span class="lineno"> 1344</span>  <a class="code hl_function" href="class_t_project_manager.html#a150ca0d6e2eb171b8117b0c5f03dbfad">TProjectManager::instance</a>()-&gt;<a class="code hl_function" href="class_t_project_manager.html#a930e00976b60a69ae1708bfd08ebf038">initializeScene</a>(scene);</div>
<div class="line"><span class="lineno"> 1345</span>  <span class="keywordflow">if</span> (Preferences::instance()-&gt;getPixelsOnly()) {</div>
<div class="line"><span class="lineno"> 1346</span>    <a class="code hl_class" href="class_t_camera.html">TCamera</a> *updateCamera = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a750b5ab623ccec744013b0c83bf20abc">getCurrentCamera</a>();</div>
<div class="line"><span class="lineno"> 1347</span>    <a class="code hl_class" href="class_t_dimension_t.html">TDimension</a> updateRes  = updateCamera-&gt;<a class="code hl_function" href="class_t_camera.html#a9a7c573e7a2c397ffae4b747809ea2a5">getRes</a>();</div>
<div class="line"><span class="lineno"> 1348</span>    updateCamera-&gt;<a class="code hl_function" href="class_t_camera.html#ac17ef8e563e599d7f1df4755e827de83">setSize</a>(<a class="code hl_class" href="class_t_dimension_t.html">TDimensionD</a>((<span class="keywordtype">double</span>)updateRes.lx / cameraDpi,</div>
<div class="line"><span class="lineno"> 1349</span>                                      (<span class="keywordtype">double</span>)updateRes.ly / cameraDpi));</div>
<div class="line"><span class="lineno"> 1350</span>  }</div>
<div class="line"><span class="lineno"> 1351</span>  <span class="comment">// Must set current scene after initializeScene!!</span></div>
<div class="line"><span class="lineno"> 1352</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;setScene(scene);</div>
<div class="line"><span class="lineno"> 1353</span>  <span class="comment">// initializeScene() load project cleanup palette: set it to cleanup palette</span></div>
<div class="line"><span class="lineno"> 1354</span>  <span class="comment">// handle.</span></div>
<div class="line"><span class="lineno"> 1355</span>  <a class="code hl_class" href="class_t_palette.html">TPalette</a> *palette = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a8ef96fedc17d7def810ac419b0939254">getProperties</a>()</div>
<div class="line"><span class="lineno"> 1356</span>                          -&gt;<a class="code hl_function" href="class_t_scene_properties.html#a84e6735bb0b0ea5054b9592c9612aff9">getCleanupParameters</a>()</div>
<div class="line"><span class="lineno"> 1357</span>                          -&gt;m_cleanupPalette.getPointer();</div>
<div class="line"><span class="lineno"> 1358</span>  <a class="code hl_class" href="class_palette_controller.html">PaletteController</a> *paletteController = app-&gt;getPaletteController();</div>
<div class="line"><span class="lineno"> 1359</span>  paletteController-&gt;getCurrentCleanupPalette()-&gt;setPalette(palette, -1);</div>
<div class="line"><span class="lineno"> 1360</span>  paletteController-&gt;editLevelPalette();</div>
<div class="line"><span class="lineno"> 1361</span> </div>
<div class="line"><span class="lineno"> 1362</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> scenePath = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad42b52b671b094f66e003c4b7ebefd45">getScenePath</a>();</div>
<div class="line"><span class="lineno"> 1363</span>  DvDirModel::instance()-&gt;refreshFolder(scenePath.<a class="code hl_function" href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">getParentDir</a>());</div>
<div class="line"><span class="lineno"> 1364</span> </div>
<div class="line"><span class="lineno"> 1365</span>  Previewer::clearAll();</div>
<div class="line"><span class="lineno"> 1366</span>  <a class="code hl_function" href="class_preview_fx_manager.html#a540923ef1e799396ddf8bba11bb3c8c6">PreviewFxManager::instance</a>()-&gt;<a class="code hl_function" href="class_preview_fx_manager.html#a3cf458cfc0955a610007cb537638d592">reset</a>();</div>
<div class="line"><span class="lineno"> 1367</span> </div>
<div class="line"><span class="lineno"> 1368</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;notifyNameSceneChange();</div>
<div class="line"><span class="lineno"> 1369</span>  IconGenerator::instance()-&gt;invalidateSceneIcon();</div>
<div class="line"><span class="lineno"> 1370</span>  <a class="code hl_class" href="class_tool_handle.html">ToolHandle</a> *toolH = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#ad70b447aff489792cfc3dbac7150a540">getCurrentTool</a>();</div>
<div class="line"><span class="lineno"> 1371</span>  <span class="keywordflow">if</span> (toolH &amp;&amp; toolH-&gt;getTool()) toolH-&gt;getTool()-&gt;reset();</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span>  CommandManager::instance()-&gt;execute(<span class="stringliteral">&quot;T_Hand&quot;</span>);</div>
<div class="line"><span class="lineno"> 1374</span> </div>
<div class="line"><span class="lineno"> 1375</span>  CommandManager::instance()-&gt;enable(MI_SaveSubxsheetAs, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1376</span> </div>
<div class="line"><span class="lineno"> 1377</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;notifySceneChanged();</div>
<div class="line"><span class="lineno"> 1378</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;setDirtyFlag(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1379</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#a0d91c122eec2b756b7c4780014e49f9e">getCurrentObject</a>()-&gt;setIsSpline(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1380</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#a1e294e7cff300851d12a8c3d196943f6">getCurrentColumn</a>()-&gt;setColumnIndex(0);</div>
<div class="line"><span class="lineno"> 1381</span> </div>
<div class="line"><span class="lineno"> 1382</span>  <a class="code hl_class" href="class_cleanup_parameters.html">CleanupParameters</a> *cp = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a8ef96fedc17d7def810ac419b0939254">getProperties</a>()-&gt;<a class="code hl_function" href="class_t_scene_properties.html#a84e6735bb0b0ea5054b9592c9612aff9">getCleanupParameters</a>();</div>
<div class="line"><span class="lineno"> 1383</span>  CleanupParameters::GlobalParameters.assign(cp);</div>
<div class="line"><span class="lineno"> 1384</span> </div>
<div class="line"><span class="lineno"> 1385</span>  <span class="comment">// updateCleanupSettingsPopup();</span></div>
<div class="line"><span class="lineno"> 1386</span> </div>
<div class="line"><span class="lineno"> 1387</span>  <a class="code hl_function" href="class_cleanup_preview_check.html#a231efbbe4e3356757b725452d5efb62d">CleanupPreviewCheck::instance</a>()-&gt;setIsEnabled(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1388</span>  <a class="code hl_function" href="class_camera_test_check.html#adc1033b93dea95f49db36d8fb668e16d">CameraTestCheck::instance</a>()-&gt;setIsEnabled(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1389</span>  <a class="code hl_function" href="class_set_scan_cropbox_check.html#a3dd35523f1e74906ecfd25d62921a490">SetScanCropboxCheck::instance</a>()-&gt;setIsEnabled(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1390</span> </div>
<div class="line"><span class="lineno"> 1391</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;isApplicationStarting())</div>
<div class="line"><span class="lineno"> 1392</span>    QApplication::clipboard()-&gt;clear();</div>
<div class="line"><span class="lineno"> 1393</span>  TSelection::setCurrent(0);</div>
<div class="line"><span class="lineno"> 1394</span>  TUndoManager::manager()-&gt;reset();</div>
<div class="line"><span class="lineno"> 1395</span> </div>
<div class="line"><span class="lineno"> 1396</span>  <span class="keywordtype">bool</span> exist = TSystem::doesExistFileOrLevel(</div>
<div class="line"><span class="lineno"> 1397</span>      scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad42b52b671b094f66e003c4b7ebefd45">getScenePath</a>()));</div>
<div class="line"><span class="lineno"> 1398</span>  QAction *act = CommandManager::instance()-&gt;getAction(MI_RevertScene);</div>
<div class="line"><span class="lineno"> 1399</span>  <span class="keywordflow">if</span> (act) act-&gt;setEnabled(exist);</div>
<div class="line"><span class="lineno"> 1400</span>}</div>
<div class="ttc" id="aclass_camera_test_check_html_adc1033b93dea95f49db36d8fb668e16d"><div class="ttname"><a href="class_camera_test_check.html#adc1033b93dea95f49db36d8fb668e16d">CameraTestCheck::instance</a></div><div class="ttdeci">static CameraTestCheck * instance()</div><div class="ttdef"><b>Definition:</b> stage2.cpp:52</div></div>
<div class="ttc" id="aclass_cleanup_preview_check_html_a231efbbe4e3356757b725452d5efb62d"><div class="ttname"><a href="class_cleanup_preview_check.html#a231efbbe4e3356757b725452d5efb62d">CleanupPreviewCheck::instance</a></div><div class="ttdeci">static CleanupPreviewCheck * instance()</div><div class="ttdef"><b>Definition:</b> stage2.cpp:93</div></div>
<div class="ttc" id="aclass_palette_controller_html"><div class="ttname"><a href="class_palette_controller.html">PaletteController</a></div><div class="ttdef"><b>Definition:</b> palettecontroller.h:35</div></div>
<div class="ttc" id="aclass_set_scan_cropbox_check_html_a3dd35523f1e74906ecfd25d62921a490"><div class="ttname"><a href="class_set_scan_cropbox_check.html#a3dd35523f1e74906ecfd25d62921a490">SetScanCropboxCheck::instance</a></div><div class="ttdeci">static SetScanCropboxCheck * instance()</div><div class="ttdef"><b>Definition:</b> stage2.cpp:131</div></div>
<div class="ttc" id="aclass_t_app_html_ad70b447aff489792cfc3dbac7150a540"><div class="ttname"><a href="class_t_app.html#ad70b447aff489792cfc3dbac7150a540">TApp::getCurrentTool</a></div><div class="ttdeci">ToolHandle * getCurrentTool() const override</div><div class="ttdef"><b>Definition:</b> tapp.h:126</div></div>
<div class="ttc" id="aclass_t_camera_html"><div class="ttname"><a href="class_t_camera.html">TCamera</a></div><div class="ttdoc">The TCamera class provides a camera and allows its management.</div><div class="ttdef"><b>Definition:</b> tcamera.h:33</div></div>
<div class="ttc" id="aclass_t_camera_html_ac17ef8e563e599d7f1df4755e827de83"><div class="ttname"><a href="class_t_camera.html#ac17ef8e563e599d7f1df4755e827de83">TCamera::setSize</a></div><div class="ttdeci">void setSize(const TDimensionD &amp;size, bool preserveDpi=false, bool preserveAR=false)</div><div class="ttdef"><b>Definition:</b> tcamera.cpp:20</div></div>
<div class="ttc" id="aclass_t_project_manager_html_a930e00976b60a69ae1708bfd08ebf038"><div class="ttname"><a href="class_t_project_manager.html#a930e00976b60a69ae1708bfd08ebf038">TProjectManager::initializeScene</a></div><div class="ttdeci">void initializeScene(ToonzScene *scene)</div><div class="ttdef"><b>Definition:</b> tproject.cpp:1106</div></div>
<div class="ttc" id="aclass_t_scene_properties_html_a56b62cc35382ceb147e19df2cf11750d"><div class="ttname"><a href="class_t_scene_properties.html#a56b62cc35382ceb147e19df2cf11750d">TSceneProperties::setBgColor</a></div><div class="ttdeci">void setBgColor(const TPixel32 &amp;color)</div><div class="ttdef"><b>Definition:</b> sceneproperties.cpp:138</div></div>
<div class="ttc" id="aclass_tool_handle_html"><div class="ttname"><a href="class_tool_handle.html">ToolHandle</a></div><div class="ttdef"><b>Definition:</b> toolhandle.h:31</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac7e81603b00421a5921bdf482a458758" name="ac7e81603b00421a5921bdf482a458758"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7e81603b00421a5921bdf482a458758">&#9670;&nbsp;</a></span>saveAll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::saveAll </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1727</span>                             {</div>
<div class="line"><span class="lineno"> 1728</span>  <span class="comment">// try to save as much as possible</span></div>
<div class="line"><span class="lineno"> 1729</span>  <span class="comment">// if anything is wrong, return false</span></div>
<div class="line"><span class="lineno"> 1730</span>  <span class="keywordtype">bool</span> result = saveScene(flags);</div>
<div class="line"><span class="lineno"> 1731</span> </div>
<div class="line"><span class="lineno"> 1732</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app         = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 1733</span>  <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a> *scene = app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;getScene();</div>
<div class="line"><span class="lineno"> 1734</span>  <span class="keywordtype">bool</span> untitled     = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a53cbaf09f551658479eb743e153ab6bc">isUntitled</a>();</div>
<div class="line"><span class="lineno"> 1735</span>  <a class="code hl_class" href="class_scene_resources.html">SceneResources</a> resources(scene, 0);</div>
<div class="line"><span class="lineno"> 1736</span>  resources.save(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad42b52b671b094f66e003c4b7ebefd45">getScenePath</a>());</div>
<div class="line"><span class="lineno"> 1737</span>  resources.updatePaths();</div>
<div class="line"><span class="lineno"> 1738</span> </div>
<div class="line"><span class="lineno"> 1739</span>  <span class="comment">// for update title bar</span></div>
<div class="line"><span class="lineno"> 1740</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>()-&gt;notifyLevelTitleChange();</div>
<div class="line"><span class="lineno"> 1741</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#a33dbcbc578915e0b69fe6927b74cf426">getCurrentPalette</a>()-&gt;notifyPaletteTitleChanged();</div>
<div class="line"><span class="lineno"> 1742</span>  <span class="keywordflow">if</span> (untitled) scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad5e0cf52431bcf95e54faa416f0fc21d">setUntitled</a>();</div>
<div class="line"><span class="lineno"> 1743</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1744</span>}</div>
<div class="ttc" id="aclass_toonz_scene_html_a53cbaf09f551658479eb743e153ab6bc"><div class="ttname"><a href="class_toonz_scene.html#a53cbaf09f551658479eb743e153ab6bc">ToonzScene::isUntitled</a></div><div class="ttdeci">bool isUntitled() const</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:345</div></div>
<div class="ttc" id="aclass_toonz_scene_html_ad5e0cf52431bcf95e54faa416f0fc21d"><div class="ttname"><a href="class_toonz_scene.html#ad5e0cf52431bcf95e54faa416f0fc21d">ToonzScene::setUntitled</a></div><div class="ttdeci">void setUntitled()</div><div class="ttdoc">Marks the scene as explicitly untitled.</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:538</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1553ac159a224b46c7ab172b048125e9" name="a1553ac159a224b46c7ab172b048125e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1553ac159a224b46c7ab172b048125e9">&#9670;&nbsp;</a></span>saveLevel() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::saveLevel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1621</span>                      {</div>
<div class="line"><span class="lineno"> 1622</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 1623</span>  <a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *sl =</div>
<div class="line"><span class="lineno"> 1624</span>      <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *<span class="keyword">&gt;</span>(app-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>()-&gt;getLevel());</div>
<div class="line"><span class="lineno"> 1625</span>  <span class="keywordflow">if</span> (!sl) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1626</span>  <span class="keywordflow">if</span> (sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a668293d53a70cca8811db28d87011c55">getPath</a>() == <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1627</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> path =</div>
<div class="line"><span class="lineno"> 1628</span>      app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;getScene()-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a668293d53a70cca8811db28d87011c55">getPath</a>());</div>
<div class="line"><span class="lineno"> 1629</span>  <span class="keywordflow">if</span> (path == <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1630</span>  <span class="keywordflow">if</span> (path.getWideString()[0] == L<span class="charliteral">&#39;+&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1631</span>  <span class="keywordflow">if</span> (!path.isAbsolute()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1632</span> </div>
<div class="line"><span class="lineno"> 1633</span>  <span class="keywordflow">if</span> (!saveLevel(path, sl, <span class="keyword">true</span>)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1634</span> </div>
<div class="line"><span class="lineno"> 1635</span>  sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a2d43337766628739707849f8808bf300">setDirtyFlag</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1636</span>  <span class="comment">// for update title bar</span></div>
<div class="line"><span class="lineno"> 1637</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>()-&gt;notifyLevelChange();</div>
<div class="line"><span class="lineno"> 1638</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1639</span>}</div>
<div class="ttc" id="aclass_t_xsh_simple_level_html_a2d43337766628739707849f8808bf300"><div class="ttname"><a href="class_t_xsh_simple_level.html#a2d43337766628739707849f8808bf300">TXshSimpleLevel::setDirtyFlag</a></div><div class="ttdeci">void setDirtyFlag(bool on) override</div><div class="ttdoc">Mark the level as &quot;modified&quot;.</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.cpp:320</div></div>
<div class="ttc" id="aclass_t_xsh_simple_level_html_a668293d53a70cca8811db28d87011c55"><div class="ttname"><a href="class_t_xsh_simple_level.html#a668293d53a70cca8811db28d87011c55">TXshSimpleLevel::getPath</a></div><div class="ttdeci">TFilePath getPath() const override</div><div class="ttdoc">Return the file path associated with the level.</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.h:120</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98582f18716776eccfc2332996cd615b" name="a98582f18716776eccfc2332996cd615b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98582f18716776eccfc2332996cd615b">&#9670;&nbsp;</a></span>saveLevel() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::saveLevel </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>fp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1590</span>                                           {</div>
<div class="line"><span class="lineno"> 1591</span>  assert(!path.isEmpty());</div>
<div class="line"><span class="lineno"> 1592</span> </div>
<div class="line"><span class="lineno"> 1593</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 1594</span>  <a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *sl =</div>
<div class="line"><span class="lineno"> 1595</span>      <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *<span class="keyword">&gt;</span>(app-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>()-&gt;getLevel());</div>
<div class="line"><span class="lineno"> 1596</span>  <span class="keywordflow">if</span> (!sl) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1597</span>  std::string ext    = sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a668293d53a70cca8811db28d87011c55">getPath</a>().<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>();</div>
<div class="line"><span class="lineno"> 1598</span>  std::string dotts  = sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a668293d53a70cca8811db28d87011c55">getPath</a>().<a class="code hl_function" href="class_t_file_path.html#a698bbf714436eb6923359044900cde2b">getDots</a>();</div>
<div class="line"><span class="lineno"> 1599</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> realPath = path;</div>
<div class="line"><span class="lineno"> 1600</span>  <span class="keywordflow">if</span> (realPath.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno"> 1601</span>    realPath = <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>(realPath.getWideString() + ::to_wstring(dotts + ext));</div>
<div class="line"><span class="lineno"> 1602</span> </div>
<div class="line"><span class="lineno"> 1603</span>  <span class="keywordtype">bool</span> ret = saveLevel(realPath, sl, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1604</span>  <span class="keywordflow">if</span> (!ret) {  <span class="comment">// save level failed</span></div>
<div class="line"><span class="lineno"> 1605</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1606</span>  }</div>
<div class="line"><span class="lineno"> 1607</span> </div>
<div class="line"><span class="lineno"> 1608</span>  RecentFiles::instance()-&gt;addFilePath(toQString(realPath), RecentFiles::Level);</div>
<div class="line"><span class="lineno"> 1609</span> </div>
<div class="line"><span class="lineno"> 1610</span>  <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()</div>
<div class="line"><span class="lineno"> 1611</span>      -&gt;getPaletteController()</div>
<div class="line"><span class="lineno"> 1612</span>      -&gt;getCurrentLevelPalette()</div>
<div class="line"><span class="lineno"> 1613</span>      -&gt;notifyPaletteSwitched();</div>
<div class="line"><span class="lineno"> 1614</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1615</span>}</div>
<div class="ttc" id="aclass_t_file_path_html_a698bbf714436eb6923359044900cde2b"><div class="ttname"><a href="class_t_file_path.html#a698bbf714436eb6923359044900cde2b">TFilePath::getDots</a></div><div class="ttdeci">std::string getDots() const</div><div class="ttdef"><b>Definition:</b> tfilepath.cpp:539</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ace7b0a1cc73ddbfc14483d3415609396" name="ace7b0a1cc73ddbfc14483d3415609396"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace7b0a1cc73ddbfc14483d3415609396">&#9670;&nbsp;</a></span>saveLevel() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::saveLevel </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *&#160;</td>
          <td class="paramname"><em>sl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1646</span>                                      {</div>
<div class="line"><span class="lineno"> 1647</span>  assert(sl);</div>
<div class="line"><span class="lineno"> 1648</span>  <span class="keywordtype">bool</span> fileDoesExist = TSystem::doesExistFileOrLevel(fp);</div>
<div class="line"><span class="lineno"> 1649</span>  <span class="keywordflow">if</span> (!overwrite &amp;&amp; fileDoesExist) {</div>
<div class="line"><span class="lineno"> 1650</span>    QString question;</div>
<div class="line"><span class="lineno"> 1651</span>    question = QObject::tr(</div>
<div class="line"><span class="lineno"> 1652</span>                   <span class="stringliteral">&quot;The level %1 already exists.\nDo you want to overwrite it?&quot;</span>)</div>
<div class="line"><span class="lineno"> 1653</span>                   .arg(toQString(fp));</div>
<div class="line"><span class="lineno"> 1654</span>    <span class="keywordtype">int</span> ret = DVGui::MsgBox(question, QObject::tr(<span class="stringliteral">&quot;Overwrite&quot;</span>),</div>
<div class="line"><span class="lineno"> 1655</span>                            QObject::tr(<span class="stringliteral">&quot;Cancel&quot;</span>), 0);</div>
<div class="line"><span class="lineno"> 1656</span>    <span class="keywordflow">if</span> (ret == 2 || ret == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1657</span>  }</div>
<div class="line"><span class="lineno"> 1658</span> </div>
<div class="line"><span class="lineno"> 1659</span>  <span class="keywordtype">bool</span> overwritePalette = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1660</span>  <span class="comment">// Confirmation of Overwrite palette</span></div>
<div class="line"><span class="lineno"> 1661</span>  <span class="comment">// open dialog IF  1) the level is dirty, and 2) confirmation of overwrite</span></div>
<div class="line"><span class="lineno"> 1662</span>  <span class="comment">// palette haven&#39;t been asked</span></div>
<div class="line"><span class="lineno"> 1663</span>  <span class="comment">// for PLI file, do nothing</span></div>
<div class="line"><span class="lineno"> 1664</span>  <span class="keywordflow">if</span> (sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a9aea4f8e34caef293d5e5c7694047564">getPalette</a>() &amp;&amp; sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a9aea4f8e34caef293d5e5c7694047564">getPalette</a>()-&gt;<a class="code hl_function" href="class_t_palette.html#acef775ca72db90dfdebb0dcad53a3af2">getAskOverwriteFlag</a>() &amp;&amp;</div>
<div class="line"><span class="lineno"> 1665</span>      sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a668293d53a70cca8811db28d87011c55">getPath</a>().<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() != <span class="stringliteral">&quot;pli&quot;</span>) {</div>
<div class="line"><span class="lineno"> 1666</span>    <span class="comment">/*--  --*/</span></div>
<div class="line"><span class="lineno"> 1667</span>    <span class="keywordflow">if</span> (!fileDoesExist)</div>
<div class="line"><span class="lineno"> 1668</span>      overwritePalette = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1669</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1670</span>      QString question;</div>
<div class="line"><span class="lineno"> 1671</span>      question =</div>
<div class="line"><span class="lineno"> 1672</span>          <span class="stringliteral">&quot;Palette &quot;</span> +</div>
<div class="line"><span class="lineno"> 1673</span>          QString::fromStdWString(sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a9aea4f8e34caef293d5e5c7694047564">getPalette</a>()-&gt;<a class="code hl_function" href="class_t_palette.html#af0bb56df19af40d1a729482efc85f492">getPaletteName</a>()) +</div>
<div class="line"><span class="lineno"> 1674</span>          <span class="stringliteral">&quot;.tpl has been modified. Do you want to overwrite palette as well ?&quot;</span>;</div>
<div class="line"><span class="lineno"> 1675</span>      <span class="keywordtype">int</span> ret =</div>
<div class="line"><span class="lineno"> 1676</span>          DVGui::MsgBox(question, QObject::tr(<span class="stringliteral">&quot;Overwrite Palette&quot;</span>) <span class="comment">/*ret = 1*/</span>,</div>
<div class="line"><span class="lineno"> 1677</span>                        QObject::tr(<span class="stringliteral">&quot;Don&#39;t Overwrite Palette&quot;</span>) <span class="comment">/*ret = 2*/</span>, 0);</div>
<div class="line"><span class="lineno"> 1678</span>      <span class="keywordflow">if</span> (ret == 1) overwritePalette = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1679</span>    }</div>
<div class="line"><span class="lineno"> 1680</span>  }</div>
<div class="line"><span class="lineno"> 1681</span> </div>
<div class="line"><span class="lineno"> 1682</span>  QApplication::setOverrideCursor(Qt::WaitCursor);</div>
<div class="line"><span class="lineno"> 1683</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1684</span>    sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a5ceff3b4f997fbe62be18948fc893404">save</a>(fp, <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>(), overwritePalette);</div>
<div class="line"><span class="lineno"> 1685</span>  } <span class="keywordflow">catch</span> (<a class="code hl_class" href="class_t_system_exception.html">TSystemException</a> se) {</div>
<div class="line"><span class="lineno"> 1686</span>    QApplication::restoreOverrideCursor();</div>
<div class="line"><span class="lineno"> 1687</span>    DVGui::warning(QString::fromStdWString(se.getMessage()));</div>
<div class="line"><span class="lineno"> 1688</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1689</span>  } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno"> 1690</span>    QApplication::restoreOverrideCursor();</div>
<div class="line"><span class="lineno"> 1691</span>    DVGui::error(QObject::tr(<span class="stringliteral">&quot;Couldn&#39;t save %1&quot;</span>).arg(toQString(fp)));</div>
<div class="line"><span class="lineno"> 1692</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1693</span>  }</div>
<div class="line"><span class="lineno"> 1694</span>  IconGenerator::instance()-&gt;invalidate(fp);</div>
<div class="line"><span class="lineno"> 1695</span>  FileBrowser::refreshFolder(fp.<a class="code hl_function" href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">getParentDir</a>());</div>
<div class="line"><span class="lineno"> 1696</span>  History::instance()-&gt;addItem(fp);</div>
<div class="line"><span class="lineno"> 1697</span> </div>
<div class="line"><span class="lineno"> 1698</span>  <span class="keywordflow">if</span> (sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a9aea4f8e34caef293d5e5c7694047564">getPalette</a>()) {</div>
<div class="line"><span class="lineno"> 1699</span>    <span class="keywordflow">if</span> (overwritePalette || sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a668293d53a70cca8811db28d87011c55">getPath</a>().<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() == <span class="stringliteral">&quot;pli&quot;</span>)</div>
<div class="line"><span class="lineno"> 1700</span>      sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a9aea4f8e34caef293d5e5c7694047564">getPalette</a>()-&gt;<a class="code hl_function" href="class_t_palette.html#a382fa102abee4e69e386cb5a4d8d5184">setDirtyFlag</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1701</span>    <span class="keywordflow">else</span>  <span class="comment">// ask only once for save palette</span></div>
<div class="line"><span class="lineno"> 1702</span>      sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a9aea4f8e34caef293d5e5c7694047564">getPalette</a>()-&gt;<a class="code hl_function" href="class_t_palette.html#a988c1603b1f87b4d3e26195781574658">setAskOverwriteFlag</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1703</span>  }</div>
<div class="line"><span class="lineno"> 1704</span> </div>
<div class="line"><span class="lineno"> 1705</span>  RecentFiles::instance()-&gt;addFilePath(toQString(fp), RecentFiles::Level);</div>
<div class="line"><span class="lineno"> 1706</span>  QApplication::restoreOverrideCursor();</div>
<div class="line"><span class="lineno"> 1707</span>  <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>()-&gt;notifyLevelTitleChange();</div>
<div class="line"><span class="lineno"> 1708</span>  <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()</div>
<div class="line"><span class="lineno"> 1709</span>      -&gt;getPaletteController()</div>
<div class="line"><span class="lineno"> 1710</span>      -&gt;getCurrentLevelPalette()</div>
<div class="line"><span class="lineno"> 1711</span>      -&gt;notifyPaletteTitleChanged();</div>
<div class="line"><span class="lineno"> 1712</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1713</span>}</div>
<div class="ttc" id="aclass_t_palette_html_a382fa102abee4e69e386cb5a4d8d5184"><div class="ttname"><a href="class_t_palette.html#a382fa102abee4e69e386cb5a4d8d5184">TPalette::setDirtyFlag</a></div><div class="ttdeci">void setDirtyFlag(bool dirtyFlag)</div><div class="ttdef"><b>Definition:</b> tpalette.h:240</div></div>
<div class="ttc" id="aclass_t_palette_html_a988c1603b1f87b4d3e26195781574658"><div class="ttname"><a href="class_t_palette.html#a988c1603b1f87b4d3e26195781574658">TPalette::setAskOverwriteFlag</a></div><div class="ttdeci">void setAskOverwriteFlag(bool askOverwriteFlag)</div><div class="ttdef"><b>Definition:</b> tpalette.h:345</div></div>
<div class="ttc" id="aclass_t_palette_html_acef775ca72db90dfdebb0dcad53a3af2"><div class="ttname"><a href="class_t_palette.html#acef775ca72db90dfdebb0dcad53a3af2">TPalette::getAskOverwriteFlag</a></div><div class="ttdeci">bool getAskOverwriteFlag()</div><div class="ttdoc">Returns the ask-overwrite flag.</div><div class="ttdef"><b>Definition:</b> tpalette.h:349</div></div>
<div class="ttc" id="aclass_t_palette_html_af0bb56df19af40d1a729482efc85f492"><div class="ttname"><a href="class_t_palette.html#af0bb56df19af40d1a729482efc85f492">TPalette::getPaletteName</a></div><div class="ttdeci">std::wstring getPaletteName() const</div><div class="ttdoc">Returns the name of the palette.</div><div class="ttdef"><b>Definition:</b> tpalette.h:414</div></div>
<div class="ttc" id="aclass_t_system_exception_html"><div class="ttname"><a href="class_t_system_exception.html">TSystemException</a></div><div class="ttdef"><b>Definition:</b> tsystem.h:65</div></div>
<div class="ttc" id="aclass_t_xsh_simple_level_html_a5ceff3b4f997fbe62be18948fc893404"><div class="ttname"><a href="class_t_xsh_simple_level.html#a5ceff3b4f997fbe62be18948fc893404">TXshSimpleLevel::save</a></div><div class="ttdeci">void save() override</div><div class="ttdoc">Saves the level to disk, with the same path deduction from load()</div><div class="ttdef"><b>Definition:</b> txshsimplelevel.cpp:1404</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af73b59e57b994553e045e193655d8a8c" name="af73b59e57b994553e045e193655d8a8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af73b59e57b994553e045e193655d8a8c">&#9670;&nbsp;</a></span>saveLevel() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::saveLevel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *&#160;</td>
          <td class="paramname"><em>sl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1719</span>                                         {</div>
<div class="line"><span class="lineno"> 1720</span>  <span class="keywordflow">return</span> saveLevel(sl-&gt;<a class="code hl_function" href="class_t_xsh_simple_level.html#a668293d53a70cca8811db28d87011c55">getPath</a>(), sl, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1721</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1872b1c5260e011f557d45631eed83c5" name="a1872b1c5260e011f557d45631eed83c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1872b1c5260e011f557d45631eed83c5">&#9670;&nbsp;</a></span>saveNonSceneFiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IoCmd::saveNonSceneFiles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1750</span>                              {</div>
<div class="line"><span class="lineno"> 1751</span>  <span class="comment">// try to save non scene files</span></div>
<div class="line"><span class="lineno"> 1752</span> </div>
<div class="line"><span class="lineno"> 1753</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app         = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 1754</span>  <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a> *scene = app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;getScene();</div>
<div class="line"><span class="lineno"> 1755</span>  <span class="keywordtype">bool</span> untitled     = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a53cbaf09f551658479eb743e153ab6bc">isUntitled</a>();</div>
<div class="line"><span class="lineno"> 1756</span>  <a class="code hl_class" href="class_scene_resources.html">SceneResources</a> resources(scene, 0);</div>
<div class="line"><span class="lineno"> 1757</span>  resources.save(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad42b52b671b094f66e003c4b7ebefd45">getScenePath</a>());</div>
<div class="line"><span class="lineno"> 1758</span>  <span class="keywordflow">if</span> (untitled) scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad5e0cf52431bcf95e54faa416f0fc21d">setUntitled</a>();</div>
<div class="line"><span class="lineno"> 1759</span>  resources.updatePaths();</div>
<div class="line"><span class="lineno"> 1760</span> </div>
<div class="line"><span class="lineno"> 1761</span>  <span class="comment">// for update title bar</span></div>
<div class="line"><span class="lineno"> 1762</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>()-&gt;notifyLevelTitleChange();</div>
<div class="line"><span class="lineno"> 1763</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#a33dbcbc578915e0b69fe6927b74cf426">getCurrentPalette</a>()-&gt;notifyPaletteTitleChanged();</div>
<div class="line"><span class="lineno"> 1764</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a62f202786d36605ae3e1c4d3b99651a3" name="a62f202786d36605ae3e1c4d3b99651a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62f202786d36605ae3e1c4d3b99651a3">&#9670;&nbsp;</a></span>saveScene() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::saveScene </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1406</span>                                                      {</div>
<div class="line"><span class="lineno"> 1407</span>  <span class="keywordtype">bool</span> overwrite     = (flags &amp; SILENTLY_OVERWRITE) != 0;</div>
<div class="line"><span class="lineno"> 1408</span>  <span class="keywordtype">bool</span> saveSubxsheet = (flags &amp; SAVE_SUBXSHEET) != 0;</div>
<div class="line"><span class="lineno"> 1409</span>  <span class="keywordtype">bool</span> isAutosave    = (flags &amp; AUTO_SAVE) != 0;</div>
<div class="line"><span class="lineno"> 1410</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app          = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 1411</span> </div>
<div class="line"><span class="lineno"> 1412</span>  assert(!path.isEmpty());</div>
<div class="line"><span class="lineno"> 1413</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> scenePath = path;</div>
<div class="line"><span class="lineno"> 1414</span>  <span class="keywordflow">if</span> (scenePath.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() == <span class="stringliteral">&quot;&quot;</span>) scenePath = scenePath.<a class="code hl_function" href="class_t_file_path.html#a1437b0e0720e9258b622f68b6858e95d">withType</a>(<span class="stringliteral">&quot;tnz&quot;</span>);</div>
<div class="line"><span class="lineno"> 1415</span>  <span class="keywordflow">if</span> (scenePath.<a class="code hl_function" href="class_t_file_path.html#aefca624df1a5468a4c78ec6d5dbfae26">getType</a>() != <span class="stringliteral">&quot;tnz&quot;</span>) {</div>
<div class="line"><span class="lineno"> 1416</span>    error(</div>
<div class="line"><span class="lineno"> 1417</span>        QObject::tr(<span class="stringliteral">&quot;%1 has an invalid file extension.&quot;</span>).arg(toQString(path)));</div>
<div class="line"><span class="lineno"> 1418</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1419</span>  }</div>
<div class="line"><span class="lineno"> 1420</span>  <a class="code hl_class" href="class_t_file_status.html">TFileStatus</a> dirStatus(scenePath.<a class="code hl_function" href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">getParentDir</a>());</div>
<div class="line"><span class="lineno"> 1421</span>  <span class="keywordflow">if</span> (!(dirStatus.doesExist() &amp;&amp; dirStatus.isWritable())) {</div>
<div class="line"><span class="lineno"> 1422</span>    error(QObject::tr(<span class="stringliteral">&quot;%1 is an invalid path.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1423</span>              .arg(toQString(scenePath.<a class="code hl_function" href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">getParentDir</a>())));</div>
<div class="line"><span class="lineno"> 1424</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1425</span>  }</div>
<div class="line"><span class="lineno"> 1426</span> </div>
<div class="line"><span class="lineno"> 1427</span>  <span class="comment">// notify user if the scene will be saved including any &quot;broken&quot; expression</span></div>
<div class="line"><span class="lineno"> 1428</span>  <span class="comment">// reference</span></div>
<div class="line"><span class="lineno"> 1429</span>  <span class="keywordflow">if</span> (!ExpressionReferenceManager::instance()-&gt;askIfParamIsIgnoredOnSave(</div>
<div class="line"><span class="lineno"> 1430</span>          saveSubxsheet))</div>
<div class="line"><span class="lineno"> 1431</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>  <span class="keywordflow">if</span> (!overwrite &amp;&amp; <a class="code hl_class" href="class_t_file_status.html">TFileStatus</a>(scenePath).doesExist()) {</div>
<div class="line"><span class="lineno"> 1434</span>    QString question;</div>
<div class="line"><span class="lineno"> 1435</span>    question = QObject::tr(</div>
<div class="line"><span class="lineno"> 1436</span>                   <span class="stringliteral">&quot;The scene %1 already exists.\nDo you want to overwrite it?&quot;</span>)</div>
<div class="line"><span class="lineno"> 1437</span>                   .arg(QString::fromStdString(scenePath.<a class="code hl_function" href="class_t_file_path.html#af94f9b0aeceb6cdb980fa1789473503a">getName</a>()));</div>
<div class="line"><span class="lineno"> 1438</span> </div>
<div class="line"><span class="lineno"> 1439</span>    <span class="keywordtype">int</span> ret = DVGui::MsgBox(question, QObject::tr(<span class="stringliteral">&quot;Overwrite&quot;</span>),</div>
<div class="line"><span class="lineno"> 1440</span>                            QObject::tr(<span class="stringliteral">&quot;Cancel&quot;</span>), 0);</div>
<div class="line"><span class="lineno"> 1441</span>    <span class="keywordflow">if</span> (ret == 2 || ret == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1442</span>  }</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>  <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a> *scene = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;getScene();</div>
<div class="line"><span class="lineno"> 1445</span> </div>
<div class="line"><span class="lineno"> 1446</span>  <a class="code hl_class" href="class_t_xsheet.html">TXsheet</a> *xsheet = 0;</div>
<div class="line"><span class="lineno"> 1447</span>  <span class="keywordflow">if</span> (saveSubxsheet) xsheet = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">getCurrentXsheet</a>()-&gt;getXsheet();</div>
<div class="line"><span class="lineno"> 1448</span> </div>
<div class="line"><span class="lineno"> 1449</span>  <span class="comment">// Automatically remove unused levels</span></div>
<div class="line"><span class="lineno"> 1450</span>  <span class="keywordflow">if</span> (!saveSubxsheet &amp;&amp; !isAutosave &amp;&amp;</div>
<div class="line"><span class="lineno"> 1451</span>      Preferences::instance()-&gt;isAutoRemoveUnusedLevelsEnabled()) {</div>
<div class="line"><span class="lineno"> 1452</span>    <span class="keywordflow">if</span> (LevelCmd::removeUnusedLevelsFromCast(<span class="keyword">false</span>))</div>
<div class="line"><span class="lineno"> 1453</span>      DVGui::info(</div>
<div class="line"><span class="lineno"> 1454</span>          QObject::tr(<span class="stringliteral">&quot;Removed unused levels from the scene cast. (This &quot;</span></div>
<div class="line"><span class="lineno"> 1455</span>                      <span class="stringliteral">&quot;behavior can be disabled in Preferences.)&quot;</span>));</div>
<div class="line"><span class="lineno"> 1456</span>  }</div>
<div class="line"><span class="lineno"> 1457</span> </div>
<div class="line"><span class="lineno"> 1458</span>  <span class="comment">// If the scene will be saved in the different folder, check out the scene</span></div>
<div class="line"><span class="lineno"> 1459</span>  <span class="comment">// cast.</span></div>
<div class="line"><span class="lineno"> 1460</span>  <span class="comment">// if the cast contains the level specified with $scenefolder alias,</span></div>
<div class="line"><span class="lineno"> 1461</span>  <span class="comment">// open a warning popup notifying that such level will lose link.</span></div>
<div class="line"><span class="lineno"> 1462</span> </div>
<div class="line"><span class="lineno"> 1463</span>  <span class="comment">// in case of saving subxsheet, the current scene will not be switched to the</span></div>
<div class="line"><span class="lineno"> 1464</span>  <span class="comment">// saved one</span></div>
<div class="line"><span class="lineno"> 1465</span>  <span class="comment">// so the level paths are needed to be reverted after saving</span></div>
<div class="line"><span class="lineno"> 1466</span>  QHash&lt;TXshLevel *, TFilePath&gt; orgLevelPaths;</div>
<div class="line"><span class="lineno"> 1467</span>  <span class="keyword">auto</span> revertOrgLevelPaths = [&amp;] {</div>
<div class="line"><span class="lineno"> 1468</span>    QHash&lt;TXshLevel *, TFilePath&gt;::const_iterator i =</div>
<div class="line"><span class="lineno"> 1469</span>        orgLevelPaths.constBegin();</div>
<div class="line"><span class="lineno"> 1470</span>    <span class="keywordflow">while</span> (i != orgLevelPaths.constEnd()) {</div>
<div class="line"><span class="lineno"> 1471</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *sil = i.key()-&gt;getSimpleLevel())</div>
<div class="line"><span class="lineno"> 1472</span>        sil-&gt;setPath(i.value(), <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1473</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_xsh_palette_level.html">TXshPaletteLevel</a> *pal = i.key()-&gt;getPaletteLevel())</div>
<div class="line"><span class="lineno"> 1474</span>        pal-&gt;setPath(i.value());</div>
<div class="line"><span class="lineno"> 1475</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_xsh_sound_level.html">TXshSoundLevel</a> *sol = i.key()-&gt;getSoundLevel())</div>
<div class="line"><span class="lineno"> 1476</span>        sol-&gt;setPath(i.value());</div>
<div class="line"><span class="lineno"> 1477</span>      ++i;</div>
<div class="line"><span class="lineno"> 1478</span>    }</div>
<div class="line"><span class="lineno"> 1479</span>  };</div>
<div class="line"><span class="lineno"> 1480</span> </div>
<div class="line"><span class="lineno"> 1481</span>  <span class="keywordflow">if</span> (!overwrite) {</div>
<div class="line"><span class="lineno"> 1482</span>    <span class="keywordtype">bool</span> ret = takeCareSceneFolderItemsOnSaveSceneAs(scene, scenePath, xsheet,</div>
<div class="line"><span class="lineno"> 1483</span>                                                     orgLevelPaths);</div>
<div class="line"><span class="lineno"> 1484</span>    <span class="keywordflow">if</span> (!ret) {</div>
<div class="line"><span class="lineno"> 1485</span>      revertOrgLevelPaths();</div>
<div class="line"><span class="lineno"> 1486</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1487</span>    }</div>
<div class="line"><span class="lineno"> 1488</span>  }</div>
<div class="line"><span class="lineno"> 1489</span> </div>
<div class="line"><span class="lineno"> 1490</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> oldFullPath = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad42b52b671b094f66e003c4b7ebefd45">getScenePath</a>());</div>
<div class="line"><span class="lineno"> 1491</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> newFullPath = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(scenePath);</div>
<div class="line"><span class="lineno"> 1492</span> </div>
<div class="line"><span class="lineno"> 1493</span>  QApplication::setOverrideCursor(Qt::WaitCursor);</div>
<div class="line"><span class="lineno"> 1494</span>  <span class="keywordflow">if</span> (app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;getDirtyFlag())</div>
<div class="line"><span class="lineno"> 1495</span>    scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ae3c27b7146c62da156c5d5bffca0e9d7">getContentHistory</a>(<span class="keyword">true</span>)-&gt;<a class="code hl_function" href="class_t_content_history.html#a2f68765ab2651c30dfbbae3f98f73403">modifiedNow</a>();</div>
<div class="line"><span class="lineno"> 1496</span> </div>
<div class="line"><span class="lineno"> 1497</span>  <span class="keywordflow">if</span> (oldFullPath != newFullPath) {</div>
<div class="line"><span class="lineno"> 1498</span>    IconGenerator::instance()-&gt;clearRequests();</div>
<div class="line"><span class="lineno"> 1499</span>    IconGenerator::instance()-&gt;clearSceneIcons();</div>
<div class="line"><span class="lineno"> 1500</span> </div>
<div class="line"><span class="lineno"> 1501</span><span class="preprocessor">#ifdef USE_SQLITE_HDPOOL</span></div>
<div class="line"><span class="lineno"> 1502</span>    <span class="comment">// Open the new cache resources HD pool</span></div>
<div class="line"><span class="lineno"> 1503</span>    TCacheResourcePool::instance()-&gt;<a class="code hl_function" href="class_t_cache_resource_pool.html#afc0d81a64dacaacdad079fb1c3edb9f8">setPath</a>(</div>
<div class="line"><span class="lineno"> 1504</span>        QString::fromStdWString(</div>
<div class="line"><span class="lineno"> 1505</span>            ToonzFolder::getCacheRootFolder().getWideString()),</div>
<div class="line"><span class="lineno"> 1506</span>        QString::fromStdWString(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#afec1477d4fe0bb1e1152e80c3a0b20ab">getProject</a>()-&gt;<a class="code hl_function" href="class_t_project.html#a258a4b6435978b730722a92ab104cd89">getName</a>().getWideName()),</div>
<div class="line"><span class="lineno"> 1507</span>        QString::fromStdWString(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a1fa0a1cbf9eb6360d980392acc99924b">getSceneName</a>()));</div>
<div class="line"><span class="lineno"> 1508</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1509</span>  }</div>
<div class="line"><span class="lineno"> 1510</span> </div>
<div class="line"><span class="lineno"> 1511</span>  <a class="code hl_class" href="class_cleanup_parameters.html">CleanupParameters</a> *cp = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a8ef96fedc17d7def810ac419b0939254">getProperties</a>()-&gt;<a class="code hl_function" href="class_t_scene_properties.html#a84e6735bb0b0ea5054b9592c9612aff9">getCleanupParameters</a>();</div>
<div class="line"><span class="lineno"> 1512</span>  <a class="code hl_class" href="class_cleanup_parameters.html">CleanupParameters</a> oldCP(*cp);</div>
<div class="line"><span class="lineno"> 1513</span>  cp-&gt;assign(&amp;CleanupParameters::GlobalParameters);</div>
<div class="line"><span class="lineno"> 1514</span> </div>
<div class="line"><span class="lineno"> 1515</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1516</span>    scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ac65f5b13baf094ba58e2e74c6949df61">save</a>(scenePath, xsheet);</div>
<div class="line"><span class="lineno"> 1517</span>  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code hl_class" href="class_t_system_exception.html">TSystemException</a> &amp;se) {</div>
<div class="line"><span class="lineno"> 1518</span>    DVGui::warning(QString::fromStdWString(se.getMessage()));</div>
<div class="line"><span class="lineno"> 1519</span>  } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno"> 1520</span>    DVGui::error(QObject::tr(<span class="stringliteral">&quot;Couldn&#39;t save %1&quot;</span>).arg(toQString(scenePath)));</div>
<div class="line"><span class="lineno"> 1521</span>  }</div>
<div class="line"><span class="lineno"> 1522</span> </div>
<div class="line"><span class="lineno"> 1523</span>  cp-&gt;assign(&amp;oldCP);</div>
<div class="line"><span class="lineno"> 1524</span> </div>
<div class="line"><span class="lineno"> 1525</span>  <span class="comment">// in case of saving subxsheet, revert the level paths after saving</span></div>
<div class="line"><span class="lineno"> 1526</span>  revertOrgLevelPaths();</div>
<div class="line"><span class="lineno"> 1527</span> </div>
<div class="line"><span class="lineno"> 1528</span>  <span class="keywordflow">if</span> (!overwrite &amp;&amp; !saveSubxsheet)</div>
<div class="line"><span class="lineno"> 1529</span>    app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;notifyNameSceneChange();</div>
<div class="line"><span class="lineno"> 1530</span>  FileBrowser::refreshFolder(scenePath.<a class="code hl_function" href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">getParentDir</a>());</div>
<div class="line"><span class="lineno"> 1531</span>  IconGenerator::instance()-&gt;invalidate(scenePath);</div>
<div class="line"><span class="lineno"> 1532</span> </div>
<div class="line"><span class="lineno"> 1533</span>  <span class="comment">// Le seguenti notifiche non cambiano il dirty flag del livello o della</span></div>
<div class="line"><span class="lineno"> 1534</span>  <span class="comment">// paletta</span></div>
<div class="line"><span class="lineno"> 1535</span>  <span class="comment">// ma sono necessarie per aggiornare le titlebar dei pannelli.</span></div>
<div class="line"><span class="lineno"> 1536</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#ad2923c9feaaa44ecd9cdd0fa029aa8aa">getCurrentLevel</a>()-&gt;notifyLevelTitleChange();</div>
<div class="line"><span class="lineno"> 1537</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#a33dbcbc578915e0b69fe6927b74cf426">getCurrentPalette</a>()-&gt;notifyPaletteTitleChanged();</div>
<div class="line"><span class="lineno"> 1538</span> </div>
<div class="line"><span class="lineno"> 1539</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;setDirtyFlag(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1540</span> </div>
<div class="line"><span class="lineno"> 1541</span>  History::instance()-&gt;addItem(scenePath);</div>
<div class="line"><span class="lineno"> 1542</span>  RecentFiles::instance()-&gt;addFilePath(</div>
<div class="line"><span class="lineno"> 1543</span>      toQString(scenePath), RecentFiles::Scene,</div>
<div class="line"><span class="lineno"> 1544</span>      QString::fromStdString(app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()</div>
<div class="line"><span class="lineno"> 1545</span>                                 -&gt;getScene()</div>
<div class="line"><span class="lineno"> 1546</span>                                 -&gt;<a class="code hl_function" href="class_toonz_scene.html#afec1477d4fe0bb1e1152e80c3a0b20ab">getProject</a>()</div>
<div class="line"><span class="lineno"> 1547</span>                                 -&gt;<a class="code hl_function" href="class_t_project.html#a258a4b6435978b730722a92ab104cd89">getName</a>()</div>
<div class="line"><span class="lineno"> 1548</span>                                 .<a class="code hl_function" href="class_t_file_path.html#af94f9b0aeceb6cdb980fa1789473503a">getName</a>()));</div>
<div class="line"><span class="lineno"> 1549</span> </div>
<div class="line"><span class="lineno"> 1550</span>  QApplication::restoreOverrideCursor();</div>
<div class="line"><span class="lineno"> 1551</span> </div>
<div class="line"><span class="lineno"> 1552</span>  <span class="keywordtype">bool</span> exist = TSystem::doesExistFileOrLevel(</div>
<div class="line"><span class="lineno"> 1553</span>      scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad42b52b671b094f66e003c4b7ebefd45">getScenePath</a>()));</div>
<div class="line"><span class="lineno"> 1554</span>  QAction *act = CommandManager::instance()-&gt;getAction(MI_RevertScene);</div>
<div class="line"><span class="lineno"> 1555</span>  <span class="keywordflow">if</span> (act) act-&gt;setEnabled(exist);</div>
<div class="line"><span class="lineno"> 1556</span> </div>
<div class="line"><span class="lineno"> 1557</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1558</span>}</div>
<div class="ttc" id="aclass_t_content_history_html_a2f68765ab2651c30dfbbae3f98f73403"><div class="ttname"><a href="class_t_content_history.html#a2f68765ab2651c30dfbbae3f98f73403">TContentHistory::modifiedNow</a></div><div class="ttdeci">void modifiedNow()</div><div class="ttdoc">do not call this method if isLevel==true! (assertion fails)</div><div class="ttdef"><b>Definition:</b> tcontenthistory.cpp:226</div></div>
<div class="ttc" id="aclass_t_file_status_html"><div class="ttname"><a href="class_t_file_status.html">TFileStatus</a></div><div class="ttdef"><b>Definition:</b> tsystem.h:36</div></div>
<div class="ttc" id="aclass_t_xsh_palette_level_html"><div class="ttname"><a href="class_t_xsh_palette_level.html">TXshPaletteLevel</a></div><div class="ttdoc">The TXshPaletteLevel class represents a palette uncoupled from a level.</div><div class="ttdef"><b>Definition:</b> txshpalettelevel.h:33</div></div>
<div class="ttc" id="aclass_t_xsh_sound_level_html"><div class="ttname"><a href="class_t_xsh_sound_level.html">TXshSoundLevel</a></div><div class="ttdef"><b>Definition:</b> txshsoundlevel.h:24</div></div>
<div class="ttc" id="aclass_toonz_scene_html_ac65f5b13baf094ba58e2e74c6949df61"><div class="ttname"><a href="class_toonz_scene.html#ac65f5b13baf094ba58e2e74c6949df61">ToonzScene::save</a></div><div class="ttdeci">void save(const TFilePath &amp;path, TXsheet *subxsheet=0)</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:590</div></div>
<div class="ttc" id="aclass_toonz_scene_html_ae3c27b7146c62da156c5d5bffca0e9d7"><div class="ttname"><a href="class_toonz_scene.html#ae3c27b7146c62da156c5d5bffca0e9d7">ToonzScene::getContentHistory</a></div><div class="ttdeci">TContentHistory * getContentHistory(bool createIfNeeded=false)</div><div class="ttdoc">gets the contentHistory. possibly creates a new one (if createIfNeeded)</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:1484</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7115d1d248236e7274bfe5f947f028a" name="aa7115d1d248236e7274bfe5f947f028a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7115d1d248236e7274bfe5f947f028a">&#9670;&nbsp;</a></span>saveScene() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::saveScene </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1564</span>                               {</div>
<div class="line"><span class="lineno"> 1565</span>  <a class="code hl_class" href="class_t_selection.html">TSelection</a> *oldSelection =</div>
<div class="line"><span class="lineno"> 1566</span>      <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#a6e0ee1978807a89009571ed5ce44323b">getCurrentSelection</a>()-&gt;getSelection();</div>
<div class="line"><span class="lineno"> 1567</span>  <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a> *scene = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;getScene();</div>
<div class="line"><span class="lineno"> 1568</span>  <span class="keywordflow">if</span> (scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#a53cbaf09f551658479eb743e153ab6bc">isUntitled</a>()) {</div>
<div class="line"><span class="lineno"> 1569</span>    <span class="keyword">static</span> <a class="code hl_class" href="class_save_scene_as_popup.html">SaveSceneAsPopup</a> *popup = 0;</div>
<div class="line"><span class="lineno"> 1570</span>    <span class="keywordflow">if</span> (!popup) popup = <span class="keyword">new</span> <a class="code hl_class" href="class_save_scene_as_popup.html">SaveSceneAsPopup</a>();</div>
<div class="line"><span class="lineno"> 1571</span>    <span class="keywordtype">int</span> ret = popup-&gt;exec();</div>
<div class="line"><span class="lineno"> 1572</span>    <span class="keywordflow">if</span> (ret == QDialog::Accepted) {</div>
<div class="line"><span class="lineno"> 1573</span>      <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;setDirtyFlag(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1574</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1575</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1576</span>      <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>()-&gt;<a class="code hl_function" href="class_t_app.html#a6e0ee1978807a89009571ed5ce44323b">getCurrentSelection</a>()-&gt;setSelection(oldSelection);</div>
<div class="line"><span class="lineno"> 1577</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1578</span>    }</div>
<div class="line"><span class="lineno"> 1579</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1580</span>    <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> fp = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad42b52b671b094f66e003c4b7ebefd45">getScenePath</a>();</div>
<div class="line"><span class="lineno"> 1581</span>    <span class="comment">// salva la scena con il nome fp. se fp esiste gia&#39; lo sovrascrive</span></div>
<div class="line"><span class="lineno"> 1582</span>    <span class="keywordflow">return</span> saveScene(fp, SILENTLY_OVERWRITE | flags);</div>
<div class="line"><span class="lineno"> 1583</span>  }</div>
<div class="line"><span class="lineno"> 1584</span>}</div>
<div class="ttc" id="aclass_save_scene_as_popup_html"><div class="ttname"><a href="class_save_scene_as_popup.html">SaveSceneAsPopup</a></div><div class="ttdef"><b>Definition:</b> filebrowserpopup.h:242</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e6da51135e070996c599fe16bd4bbd3" name="a5e6da51135e070996c599fe16bd4bbd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e6da51135e070996c599fe16bd4bbd3">&#9670;&nbsp;</a></span>saveSceneIfNeeded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::saveSceneIfNeeded </td>
          <td>(</td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1230</span>                                         {</div>
<div class="line"><span class="lineno"> 1231</span>  <a class="code hl_class" href="class_t_app.html">TApp</a> *app = <a class="code hl_function" href="class_t_app.html#a24088f8647d5d9447fcec6b9b9bbf9eb">TApp::instance</a>();</div>
<div class="line"><span class="lineno"> 1232</span> </div>
<div class="line"><span class="lineno"> 1233</span>  <span class="keywordflow">if</span> (app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;getDirtyFlag()) {</div>
<div class="line"><span class="lineno"> 1234</span>    QString question;</div>
<div class="line"><span class="lineno"> 1235</span>    question = QObject::tr(</div>
<div class="line"><span class="lineno"> 1236</span>                   <span class="stringliteral">&quot;%1: the current scene has been modified.\n&quot;</span></div>
<div class="line"><span class="lineno"> 1237</span>                   <span class="stringliteral">&quot;What would you like to do?&quot;</span>)</div>
<div class="line"><span class="lineno"> 1238</span>                   .arg(msg);</div>
<div class="line"><span class="lineno"> 1239</span>    <span class="keywordtype">int</span> ret = DVGui::MsgBox(</div>
<div class="line"><span class="lineno"> 1240</span>        question, QObject::tr(<span class="stringliteral">&quot;Save All&quot;</span>), QObject::tr(<span class="stringliteral">&quot;Save Scene Only&quot;</span>),</div>
<div class="line"><span class="lineno"> 1241</span>        QObject::tr(<span class="stringliteral">&quot;Discard Changes&quot;</span>), QObject::tr(<span class="stringliteral">&quot;Cancel&quot;</span>), 0);</div>
<div class="line"><span class="lineno"> 1242</span>    <span class="keywordflow">if</span> (ret == 0 || ret == 4) {</div>
<div class="line"><span class="lineno"> 1243</span>      <span class="comment">// cancel (or closed message box window)</span></div>
<div class="line"><span class="lineno"> 1244</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1245</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == 1) {</div>
<div class="line"><span class="lineno"> 1246</span>      <span class="comment">// save all</span></div>
<div class="line"><span class="lineno"> 1247</span>      <span class="keywordflow">if</span> (!IoCmd::saveAll()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1248</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == 2) {</div>
<div class="line"><span class="lineno"> 1249</span>      <span class="comment">// save</span></div>
<div class="line"><span class="lineno"> 1250</span>      <span class="keywordflow">if</span> (!IoCmd::saveScene()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1251</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == 3) {</div>
<div class="line"><span class="lineno"> 1252</span>    }</div>
<div class="line"><span class="lineno"> 1253</span>  }</div>
<div class="line"><span class="lineno"> 1254</span> </div>
<div class="line"><span class="lineno"> 1255</span>  <a class="code hl_class" href="class_toonz_scene.html">ToonzScene</a> *scene = app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;getScene();</div>
<div class="line"><span class="lineno"> 1256</span>  <span class="keywordflow">if</span> (scene) {</div>
<div class="line"><span class="lineno"> 1257</span>    QStringList dirtyResources;</div>
<div class="line"><span class="lineno"> 1258</span>    {</div>
<div class="line"><span class="lineno"> 1259</span>      <a class="code hl_class" href="class_scene_resources.html">SceneResources</a> resources(scene, 0);</div>
<div class="line"><span class="lineno"> 1260</span>      resources.getDirtyResources(dirtyResources);</div>
<div class="line"><span class="lineno"> 1261</span>    }</div>
<div class="line"><span class="lineno"> 1262</span> </div>
<div class="line"><span class="lineno"> 1263</span>    <span class="keywordflow">if</span> (!dirtyResources.empty()) {</div>
<div class="line"><span class="lineno"> 1264</span>      <span class="comment">// show up to 5 items</span></div>
<div class="line"><span class="lineno"> 1265</span>      <span class="keywordtype">int</span> extraCount = dirtyResources.count() - 5;</div>
<div class="line"><span class="lineno"> 1266</span>      <span class="keywordflow">if</span> (extraCount &gt; 0) {</div>
<div class="line"><span class="lineno"> 1267</span>        dirtyResources = dirtyResources.mid(0, 5);</div>
<div class="line"><span class="lineno"> 1268</span>        dirtyResources.append(</div>
<div class="line"><span class="lineno"> 1269</span>            QObject::tr(<span class="stringliteral">&quot;and %1 more item(s).&quot;</span>).arg(extraCount));</div>
<div class="line"><span class="lineno"> 1270</span>      }</div>
<div class="line"><span class="lineno"> 1271</span> </div>
<div class="line"><span class="lineno"> 1272</span>      QString question;</div>
<div class="line"><span class="lineno"> 1273</span> </div>
<div class="line"><span class="lineno"> 1274</span>      question = msg + <span class="stringliteral">&quot;:&quot;</span> +</div>
<div class="line"><span class="lineno"> 1275</span>                 QObject::tr(<span class="stringliteral">&quot; The following file(s) have been modified.\n\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1276</span> </div>
<div class="line"><span class="lineno"> 1277</span>      question += <span class="stringliteral">&quot;  &quot;</span> + dirtyResources.join(<span class="stringliteral">&quot;\n  &quot;</span>);</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span>      question += <span class="stringliteral">&quot;\n&quot;</span> + QObject::tr(<span class="stringliteral">&quot;\nWhat would you like to do? &quot;</span>);</div>
<div class="line"><span class="lineno"> 1280</span> </div>
<div class="line"><span class="lineno"> 1281</span>      <span class="keywordtype">int</span> ret =</div>
<div class="line"><span class="lineno"> 1282</span>          DVGui::MsgBox(question, QObject::tr(<span class="stringliteral">&quot;Save Changes&quot;</span>),</div>
<div class="line"><span class="lineno"> 1283</span>                        msg + QObject::tr(<span class="stringliteral">&quot; Anyway&quot;</span>), QObject::tr(<span class="stringliteral">&quot;Cancel&quot;</span>), 0);</div>
<div class="line"><span class="lineno"> 1284</span>      <span class="keywordflow">if</span> (ret == 0 || ret == 3) {</div>
<div class="line"><span class="lineno"> 1285</span>        <span class="comment">// cancel (or closed message box window)</span></div>
<div class="line"><span class="lineno"> 1286</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1287</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == 1) {</div>
<div class="line"><span class="lineno"> 1288</span>        <span class="comment">// save non scene files</span></div>
<div class="line"><span class="lineno"> 1289</span>        IoCmd::saveNonSceneFiles();</div>
<div class="line"><span class="lineno"> 1290</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == 2) {</div>
<div class="line"><span class="lineno"> 1291</span>        <span class="comment">// do nothing and continue</span></div>
<div class="line"><span class="lineno"> 1292</span>      }</div>
<div class="line"><span class="lineno"> 1293</span>    }</div>
<div class="line"><span class="lineno"> 1294</span> </div>
<div class="line"><span class="lineno"> 1295</span>    RenderingSuspender suspender;</div>
<div class="line"><span class="lineno"> 1296</span> </div>
<div class="line"><span class="lineno"> 1297</span>    <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> scenePath(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad42b52b671b094f66e003c4b7ebefd45">getScenePath</a>());</div>
<div class="line"><span class="lineno"> 1298</span>    scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad63e1050bdbe8f213f5da4bc852c6f7a">clear</a>();  <span class="comment">// note: this (possibly) removes the &quot;untitled&quot; folder</span></div>
<div class="line"><span class="lineno"> 1299</span>    app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;notifyCastChange();</div>
<div class="line"><span class="lineno"> 1300</span>    <span class="comment">// Si deve notificare anche il cambiamento che ha subito l&#39;xsheet.</span></div>
<div class="line"><span class="lineno"> 1301</span>    app-&gt;<a class="code hl_function" href="class_t_app.html#a13f509e753824cb0500787f68bb51a09">getCurrentXsheet</a>()-&gt;notifyXsheetSwitched();</div>
<div class="line"><span class="lineno"> 1302</span>    FileBrowser::refreshFolder(scenePath.getParentDir());</div>
<div class="line"><span class="lineno"> 1303</span>  }</div>
<div class="line"><span class="lineno"> 1304</span>  app-&gt;<a class="code hl_function" href="class_t_app.html#abbbf1fae564e9e510826eda4f6637d20">getCurrentScene</a>()-&gt;setDirtyFlag(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1305</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1306</span>}</div>
<div class="ttc" id="aclass_toonz_scene_html_ad63e1050bdbe8f213f5da4bc852c6f7a"><div class="ttname"><a href="class_toonz_scene.html#ad63e1050bdbe8f213f5da4bc852c6f7a">ToonzScene::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clears the scene.</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:308</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e9b7393f785dd784c38efe0788b45a4" name="a3e9b7393f785dd784c38efe0788b45a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e9b7393f785dd784c38efe0788b45a4">&#9670;&nbsp;</a></span>saveSound() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::saveSound </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsh_sound_level.html">TXshSoundLevel</a> *&#160;</td>
          <td class="paramname"><em>sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1770</span>                                                                             {</div>
<div class="line"><span class="lineno"> 1771</span>  <span class="keywordflow">if</span> (!overwrite &amp;&amp; TSystem::doesExistFileOrLevel(fp)) {</div>
<div class="line"><span class="lineno"> 1772</span>    QString question;</div>
<div class="line"><span class="lineno"> 1773</span>    question =</div>
<div class="line"><span class="lineno"> 1774</span>        QObject::tr(</div>
<div class="line"><span class="lineno"> 1775</span>            <span class="stringliteral">&quot;The soundtrack %1 already exists.\nDo you want to overwrite it?&quot;</span>)</div>
<div class="line"><span class="lineno"> 1776</span>            .arg(toQString(fp));</div>
<div class="line"><span class="lineno"> 1777</span>    <span class="keywordtype">int</span> ret = DVGui::MsgBox(question, QObject::tr(<span class="stringliteral">&quot;Overwrite&quot;</span>),</div>
<div class="line"><span class="lineno"> 1778</span>                            QObject::tr(<span class="stringliteral">&quot;Cancel&quot;</span>), 0);</div>
<div class="line"><span class="lineno"> 1779</span>    <span class="keywordflow">if</span> (ret == 2 || ret == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1780</span>  }</div>
<div class="line"><span class="lineno"> 1781</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1782</span>    sl-&gt;save(fp);</div>
<div class="line"><span class="lineno"> 1783</span>  } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno"> 1784</span>    DVGui::error(QObject::tr(<span class="stringliteral">&quot;Couldn&#39;t save %1&quot;</span>).arg(toQString(fp)));</div>
<div class="line"><span class="lineno"> 1785</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1786</span>  }</div>
<div class="line"><span class="lineno"> 1787</span>  QApplication::setOverrideCursor(Qt::WaitCursor);</div>
<div class="line"><span class="lineno"> 1788</span>  FileBrowser::refreshFolder(fp.<a class="code hl_function" href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">getParentDir</a>());</div>
<div class="line"><span class="lineno"> 1789</span>  History::instance()-&gt;addItem(fp);</div>
<div class="line"><span class="lineno"> 1790</span>  QApplication::restoreOverrideCursor();</div>
<div class="line"><span class="lineno"> 1791</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1792</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d61d8a7c69ed6a011f7addd5adb1390" name="a0d61d8a7c69ed6a011f7addd5adb1390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d61d8a7c69ed6a011f7addd5adb1390">&#9670;&nbsp;</a></span>saveSound() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::saveSound </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_xsh_sound_level.html">TXshSoundLevel</a> *&#160;</td>
          <td class="paramname"><em>sc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1798</span>                                        {</div>
<div class="line"><span class="lineno"> 1799</span>  <span class="keywordflow">return</span> saveSound(sl-&gt;getPath(), sl, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1800</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa512f1a040d635719070d84e1fe4e733" name="aa512f1a040d635719070d84e1fe4e733"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa512f1a040d635719070d84e1fe4e733">&#9670;&nbsp;</a></span>takeCareSceneFolderItemsOnSaveSceneAs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IoCmd::takeCareSceneFolderItemsOnSaveSceneAs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_toonz_scene.html">ToonzScene</a> *&#160;</td>
          <td class="paramname"><em>scene</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_file_path.html">TFilePath</a> &amp;&#160;</td>
          <td class="paramname"><em>newPath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsheet.html">TXsheet</a> *&#160;</td>
          <td class="paramname"><em>subxsh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QHash&lt; <a class="el" href="class_t_xsh_level.html">TXshLevel</a> *, <a class="el" href="class_t_file_path.html">TFilePath</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>orgLevelPaths</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2718</span>                                                  {</div>
<div class="line"><span class="lineno"> 2719</span>  <span class="keyword">auto</span> setPathToLevel = [&amp;](<a class="code hl_class" href="class_t_xsh_level.html">TXshLevel</a> *level, <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> fp) {</div>
<div class="line"><span class="lineno"> 2720</span>    <span class="comment">// in case of saving subxsheet, the current scene will not be switched to</span></div>
<div class="line"><span class="lineno"> 2721</span>    <span class="comment">// the saved one</span></div>
<div class="line"><span class="lineno"> 2722</span>    <span class="comment">// so the level paths are needed to be reverted after saving</span></div>
<div class="line"><span class="lineno"> 2723</span>    <span class="keywordflow">if</span> (subxsh) orgLevelPaths.insert(level, level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#ab8ffcf067cadf0e1c4081b54ffde249d">getPath</a>());</div>
<div class="line"><span class="lineno"> 2724</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_xsh_simple_level.html">TXshSimpleLevel</a> *sil = level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a023065559cff76164ecb6344c586ba27">getSimpleLevel</a>())</div>
<div class="line"><span class="lineno"> 2725</span>      sil-&gt;setPath(fp, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2726</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_xsh_palette_level.html">TXshPaletteLevel</a> *pal = level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#afdbb7e1664b681225414f59317a32b74">getPaletteLevel</a>())</div>
<div class="line"><span class="lineno"> 2727</span>      pal-&gt;setPath(fp);</div>
<div class="line"><span class="lineno"> 2728</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_xsh_sound_level.html">TXshSoundLevel</a> *sol = level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#aa26f1638f7685304949b33befc0bfcc9">getSoundLevel</a>())</div>
<div class="line"><span class="lineno"> 2729</span>      sol-&gt;setPath(fp);</div>
<div class="line"><span class="lineno"> 2730</span>  };</div>
<div class="line"><span class="lineno"> 2731</span> </div>
<div class="line"><span class="lineno"> 2732</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> oldSceneFolder =</div>
<div class="line"><span class="lineno"> 2733</span>      scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ad42b52b671b094f66e003c4b7ebefd45">getScenePath</a>()).getParentDir();</div>
<div class="line"><span class="lineno"> 2734</span>  <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> newSceneFolder = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(newPath).<a class="code hl_function" href="class_t_file_path.html#a1f5014e9c396bc2268820c19bc15657d">getParentDir</a>();</div>
<div class="line"><span class="lineno"> 2735</span> </div>
<div class="line"><span class="lineno"> 2736</span>  <span class="comment">// in case of saving in the same folder</span></div>
<div class="line"><span class="lineno"> 2737</span>  <span class="keywordflow">if</span> (oldSceneFolder == newSceneFolder) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2738</span> </div>
<div class="line"><span class="lineno"> 2739</span>  <a class="code hl_class" href="class_t_level_set.html">TLevelSet</a> *levelSet = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#ac1a8bf0d2cec4f59c87b0001991264b5">getLevelSet</a>();</div>
<div class="line"><span class="lineno"> 2740</span>  std::vector&lt;TXshLevel *&gt; levels;</div>
<div class="line"><span class="lineno"> 2741</span> </div>
<div class="line"><span class="lineno"> 2742</span>  <span class="comment">// in case of saving subxsheet, checking only used levels.</span></div>
<div class="line"><span class="lineno"> 2743</span>  <span class="keywordflow">if</span> (subxsh) {</div>
<div class="line"><span class="lineno"> 2744</span>    std::set&lt;TXshLevel *&gt; saveSet;</div>
<div class="line"><span class="lineno"> 2745</span>    subxsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#aa0e609bf07ee363201a184c3c7220348">getUsedLevels</a>(saveSet);</div>
<div class="line"><span class="lineno"> 2746</span>    levels = std::vector&lt;TXshLevel *&gt;(saveSet.begin(), saveSet.end());</div>
<div class="line"><span class="lineno"> 2747</span>  }</div>
<div class="line"><span class="lineno"> 2748</span>  <span class="comment">// in case of saving the scene (i.e. top xsheet)</span></div>
<div class="line"><span class="lineno"> 2749</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2750</span>    levelSet-&gt;listLevels(levels);</div>
<div class="line"><span class="lineno"> 2751</span> </div>
<div class="line"><span class="lineno"> 2752</span>  QList&lt;TXshLevel *&gt; sceneFolderLevels;</div>
<div class="line"><span class="lineno"> 2753</span>  QString str;</div>
<div class="line"><span class="lineno"> 2754</span>  <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><span class="lineno"> 2755</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="class_t_xsh_level.html">TXshLevel</a> *level : levels) {</div>
<div class="line"><span class="lineno"> 2756</span>    <span class="keywordflow">if</span> (!level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#ab8ffcf067cadf0e1c4081b54ffde249d">getPath</a>().isEmpty() &amp;&amp;</div>
<div class="line"><span class="lineno"> 2757</span>        <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>(<span class="stringliteral">&quot;$scenefolder&quot;</span>).isAncestorOf(level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#ab8ffcf067cadf0e1c4081b54ffde249d">getPath</a>())) {</div>
<div class="line"><span class="lineno"> 2758</span>      <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> levelFullPath = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#ab8ffcf067cadf0e1c4081b54ffde249d">getPath</a>());</div>
<div class="line"><span class="lineno"> 2759</span>      <span class="comment">// check if the path can be re-coded with the new scene folder path</span></div>
<div class="line"><span class="lineno"> 2760</span>      <span class="keywordflow">if</span> (newSceneFolder.isAncestorOf(levelFullPath)) {</div>
<div class="line"><span class="lineno"> 2761</span>        <span class="comment">// just replace the path without warning</span></div>
<div class="line"><span class="lineno"> 2762</span>        <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> fp =</div>
<div class="line"><span class="lineno"> 2763</span>            <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>(<span class="stringliteral">&quot;$scenefolder&quot;</span>) + (levelFullPath - newSceneFolder);</div>
<div class="line"><span class="lineno"> 2764</span>        setPathToLevel(level, fp);</div>
<div class="line"><span class="lineno"> 2765</span>      }</div>
<div class="line"><span class="lineno"> 2766</span>      <span class="comment">// if re-coding is not possible, then it needs to ask user&#39;s preference</span></div>
<div class="line"><span class="lineno"> 2767</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2768</span>        sceneFolderLevels.append(level);</div>
<div class="line"><span class="lineno"> 2769</span>        <span class="keywordflow">if</span> (count &lt; 10) {</div>
<div class="line"><span class="lineno"> 2770</span>          str.append(<span class="stringliteral">&quot;    &quot;</span> + QString::fromStdWString(level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a3a59fb1bd3261baee4e889a9edbf0ae8">getName</a>()) + <span class="stringliteral">&quot; (&quot;</span> +</div>
<div class="line"><span class="lineno"> 2771</span>                     level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#ab8ffcf067cadf0e1c4081b54ffde249d">getPath</a>().getQString() + <span class="stringliteral">&quot;)\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2772</span>        }</div>
<div class="line"><span class="lineno"> 2773</span>        count++;</div>
<div class="line"><span class="lineno"> 2774</span>      }</div>
<div class="line"><span class="lineno"> 2775</span>    }</div>
<div class="line"><span class="lineno"> 2776</span>  }</div>
<div class="line"><span class="lineno"> 2777</span>  <span class="comment">// list maximum 10 levels</span></div>
<div class="line"><span class="lineno"> 2778</span>  <span class="keywordflow">if</span> (count &gt; 10)</div>
<div class="line"><span class="lineno"> 2779</span>    str.append(QObject::tr(<span class="stringliteral">&quot;    + %1 more level(s) \n&quot;</span>).arg(count - 10));</div>
<div class="line"><span class="lineno"> 2780</span> </div>
<div class="line"><span class="lineno"> 2781</span>  <span class="comment">// in case there is no items with $scenefolder</span></div>
<div class="line"><span class="lineno"> 2782</span>  <span class="keywordflow">if</span> (sceneFolderLevels.isEmpty()) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2783</span> </div>
<div class="line"><span class="lineno"> 2784</span>  str = QObject::tr(</div>
<div class="line"><span class="lineno"> 2785</span>            <span class="stringliteral">&quot;The following level(s) use path with $scenefolder alias.\n\n&quot;</span>) +</div>
<div class="line"><span class="lineno"> 2786</span>        str +</div>
<div class="line"><span class="lineno"> 2787</span>        QObject::tr(</div>
<div class="line"><span class="lineno"> 2788</span>            <span class="stringliteral">&quot;\nThey will not be opened properly when you load the &quot;</span></div>
<div class="line"><span class="lineno"> 2789</span>            <span class="stringliteral">&quot;scene next time.\nWhat do you want to do?&quot;</span>);</div>
<div class="line"><span class="lineno"> 2790</span> </div>
<div class="line"><span class="lineno"> 2791</span>  <span class="keywordtype">int</span> ret = DVGui::MsgBox(</div>
<div class="line"><span class="lineno"> 2792</span>      str, QObject::tr(<span class="stringliteral">&quot;Copy the levels to correspondent paths&quot;</span>),</div>
<div class="line"><span class="lineno"> 2793</span>      QObject::tr(<span class="stringliteral">&quot;Decode all $scenefolder aliases&quot;</span>),</div>
<div class="line"><span class="lineno"> 2794</span>      QObject::tr(<span class="stringliteral">&quot;Save the scene only&quot;</span>), QObject::tr(<span class="stringliteral">&quot;Cancel&quot;</span>), 0);</div>
<div class="line"><span class="lineno"> 2795</span>  <span class="keywordflow">if</span> (ret == 4 || ret == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2796</span> </div>
<div class="line"><span class="lineno"> 2797</span>  <span class="keywordflow">if</span> (ret == 1) {  <span class="comment">// copy the levels case</span></div>
<div class="line"><span class="lineno"> 2798</span>    <span class="keyword">enum</span> OVERWRITEPOLICY { ASK, YES_FOR_ALL, NO_FOR_ALL } policy = ASK;</div>
<div class="line"><span class="lineno"> 2799</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sceneFolderLevels.size(); i++) {</div>
<div class="line"><span class="lineno"> 2800</span>      <a class="code hl_class" href="class_t_xsh_level.html">TXshLevel</a> *level = sceneFolderLevels.at(i);</div>
<div class="line"><span class="lineno"> 2801</span>      <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> fp     = level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#ab8ffcf067cadf0e1c4081b54ffde249d">getPath</a>() - <a class="code hl_class" href="class_t_file_path.html">TFilePath</a>(<span class="stringliteral">&quot;$scenefolder&quot;</span>);</div>
<div class="line"><span class="lineno"> 2802</span>      fp               = fp.<a class="code hl_function" href="class_t_file_path.html#a09d12d68c4264183e0268dde6f592b2e">withParentDir</a>(newSceneFolder);</div>
<div class="line"><span class="lineno"> 2803</span>      <span class="comment">// check the level existence</span></div>
<div class="line"><span class="lineno"> 2804</span>      <span class="keywordflow">if</span> (TSystem::doesExistFileOrLevel(fp)) {</div>
<div class="line"><span class="lineno"> 2805</span>        <span class="keywordtype">bool</span> overwrite = (policy == YES_FOR_ALL);</div>
<div class="line"><span class="lineno"> 2806</span>        <span class="keywordflow">if</span> (policy == ASK) {</div>
<div class="line"><span class="lineno"> 2807</span>          QString question =</div>
<div class="line"><span class="lineno"> 2808</span>              QObject::tr(</div>
<div class="line"><span class="lineno"> 2809</span>                  <span class="stringliteral">&quot;File %1 already exists.\nDo you want to overwrite it?&quot;</span>)</div>
<div class="line"><span class="lineno"> 2810</span>                  .arg(fp.getQString());</div>
<div class="line"><span class="lineno"> 2811</span>          <span class="keywordtype">int</span> ret_overwrite = DVGui::MsgBox(</div>
<div class="line"><span class="lineno"> 2812</span>              question, QObject::tr(<span class="stringliteral">&quot;Overwrite&quot;</span>),</div>
<div class="line"><span class="lineno"> 2813</span>              QObject::tr(<span class="stringliteral">&quot;Overwrite for All&quot;</span>), QObject::tr(<span class="stringliteral">&quot;Don&#39;t Overwrite&quot;</span>),</div>
<div class="line"><span class="lineno"> 2814</span>              QObject::tr(<span class="stringliteral">&quot;Don&#39;t Overwrite for All&quot;</span>), 0);</div>
<div class="line"><span class="lineno"> 2815</span>          <span class="keywordflow">if</span> (ret_overwrite == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2816</span>          <span class="keywordflow">if</span> (ret_overwrite == 1)</div>
<div class="line"><span class="lineno"> 2817</span>            overwrite = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2818</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret_overwrite == 2) {</div>
<div class="line"><span class="lineno"> 2819</span>            overwrite = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2820</span>            policy    = YES_FOR_ALL;</div>
<div class="line"><span class="lineno"> 2821</span>          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret_overwrite == 4)</div>
<div class="line"><span class="lineno"> 2822</span>            policy = NO_FOR_ALL;</div>
<div class="line"><span class="lineno"> 2823</span>        }</div>
<div class="line"><span class="lineno"> 2824</span>        <span class="keywordflow">if</span> (!overwrite) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2825</span>      }</div>
<div class="line"><span class="lineno"> 2826</span> </div>
<div class="line"><span class="lineno"> 2827</span>      <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> srcFp = scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#ab8ffcf067cadf0e1c4081b54ffde249d">getPath</a>());</div>
<div class="line"><span class="lineno"> 2828</span>      <span class="keywordflow">if</span> (!TSystem::copyFileOrLevel(fp, srcFp))</div>
<div class="line"><span class="lineno"> 2829</span>        warning(QObject::tr(<span class="stringliteral">&quot;Failed to overwrite %1&quot;</span>).arg(fp.getQString()));</div>
<div class="line"><span class="lineno"> 2830</span>      <span class="comment">// copy the palette as well</span></div>
<div class="line"><span class="lineno"> 2831</span>      <span class="keywordflow">if</span> (level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#a1a147f1e970a62120c0bbaf0020a8932">getType</a>() == TZP_XSHLEVEL) {</div>
<div class="line"><span class="lineno"> 2832</span>        <span class="keywordflow">if</span> (!TSystem::copyFileOrLevel(fp.<a class="code hl_function" href="class_t_file_path.html#a1437b0e0720e9258b622f68b6858e95d">withType</a>(<span class="stringliteral">&quot;tpl&quot;</span>),</div>
<div class="line"><span class="lineno"> 2833</span>                                      srcFp.<a class="code hl_function" href="class_t_file_path.html#a1437b0e0720e9258b622f68b6858e95d">withType</a>(<span class="stringliteral">&quot;tpl&quot;</span>)))</div>
<div class="line"><span class="lineno"> 2834</span>          warning(QObject::tr(<span class="stringliteral">&quot;Failed to overwrite %1&quot;</span>)</div>
<div class="line"><span class="lineno"> 2835</span>                      .arg(fp.<a class="code hl_function" href="class_t_file_path.html#a1437b0e0720e9258b622f68b6858e95d">withType</a>(<span class="stringliteral">&quot;tpl&quot;</span>).getQString()));</div>
<div class="line"><span class="lineno"> 2836</span>      }</div>
<div class="line"><span class="lineno"> 2837</span>    }</div>
<div class="line"><span class="lineno"> 2838</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == 2) {  <span class="comment">// decode $scenefolder aliases case</span></div>
<div class="line"><span class="lineno"> 2839</span>    Preferences::PathAliasPriority oldPriority =</div>
<div class="line"><span class="lineno"> 2840</span>        Preferences::instance()-&gt;getPathAliasPriority();</div>
<div class="line"><span class="lineno"> 2841</span>    Preferences::instance()-&gt;setValue(pathAliasPriority,</div>
<div class="line"><span class="lineno"> 2842</span>                                      Preferences::ProjectFolderOnly);</div>
<div class="line"><span class="lineno"> 2843</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sceneFolderLevels.size(); i++) {</div>
<div class="line"><span class="lineno"> 2844</span>      <a class="code hl_class" href="class_t_xsh_level.html">TXshLevel</a> *level = sceneFolderLevels.at(i);</div>
<div class="line"><span class="lineno"> 2845</span> </div>
<div class="line"><span class="lineno"> 2846</span>      <span class="comment">// decode and code again</span></div>
<div class="line"><span class="lineno"> 2847</span>      <a class="code hl_class" href="class_t_file_path.html">TFilePath</a> fp =</div>
<div class="line"><span class="lineno"> 2848</span>          scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#abb12422205be4336c3dee1aa5fbdc5e5">codeFilePath</a>(scene-&gt;<a class="code hl_function" href="class_toonz_scene.html#aa2ed57dfbae7f8cf02a4abe47ed533c6">decodeFilePath</a>(level-&gt;<a class="code hl_function" href="class_t_xsh_level.html#ab8ffcf067cadf0e1c4081b54ffde249d">getPath</a>()));</div>
<div class="line"><span class="lineno"> 2849</span>      setPathToLevel(level, fp);</div>
<div class="line"><span class="lineno"> 2850</span>    }</div>
<div class="line"><span class="lineno"> 2851</span>    Preferences::instance()-&gt;setValue(pathAliasPriority, oldPriority);</div>
<div class="line"><span class="lineno"> 2852</span>  }</div>
<div class="line"><span class="lineno"> 2853</span> </div>
<div class="line"><span class="lineno"> 2854</span>  <span class="comment">// Save the scene only case (ret == 3), do nothing</span></div>
<div class="line"><span class="lineno"> 2855</span> </div>
<div class="line"><span class="lineno"> 2856</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2857</span>}</div>
<div class="ttc" id="aclass_t_level_set_html"><div class="ttname"><a href="class_t_level_set.html">TLevelSet</a></div><div class="ttdef"><b>Definition:</b> levelset.h:63</div></div>
<div class="ttc" id="aclass_t_xsh_level_html_a3a59fb1bd3261baee4e889a9edbf0ae8"><div class="ttname"><a href="class_t_xsh_level.html#a3a59fb1bd3261baee4e889a9edbf0ae8">TXshLevel::getName</a></div><div class="ttdeci">std::wstring getName() const</div><div class="ttdoc">Return level name.</div><div class="ttdef"><b>Definition:</b> txshlevel.h:115</div></div>
<div class="ttc" id="aclass_t_xsh_level_html_aa26f1638f7685304949b33befc0bfcc9"><div class="ttname"><a href="class_t_xsh_level.html#aa26f1638f7685304949b33befc0bfcc9">TXshLevel::getSoundLevel</a></div><div class="ttdeci">virtual TXshSoundLevel * getSoundLevel()</div><div class="ttdoc">Method (to be overridden in subclasses) to downcast to TXshSoundLevel.</div><div class="ttdef"><b>Definition:</b> txshlevel.h:108</div></div>
<div class="ttc" id="aclass_t_xsh_level_html_ab8ffcf067cadf0e1c4081b54ffde249d"><div class="ttname"><a href="class_t_xsh_level.html#ab8ffcf067cadf0e1c4081b54ffde249d">TXshLevel::getPath</a></div><div class="ttdeci">virtual TFilePath getPath() const</div><div class="ttdoc">Return the file path associated with the level.</div><div class="ttdef"><b>Definition:</b> txshlevel.h:121</div></div>
<div class="ttc" id="aclass_t_xsh_level_html_afdbb7e1664b681225414f59317a32b74"><div class="ttname"><a href="class_t_xsh_level.html#afdbb7e1664b681225414f59317a32b74">TXshLevel::getPaletteLevel</a></div><div class="ttdeci">virtual TXshPaletteLevel * getPaletteLevel()</div><div class="ttdoc">Method (to be overridden in subclasses) to downcast to TXshPaletteLevel.</div><div class="ttdef"><b>Definition:</b> txshlevel.h:105</div></div>
<div class="ttc" id="aclass_t_xsheet_html_aa0e609bf07ee363201a184c3c7220348"><div class="ttname"><a href="class_t_xsheet.html#aa0e609bf07ee363201a184c3c7220348">TXsheet::getUsedLevels</a></div><div class="ttdeci">void getUsedLevels(std::set&lt; TXshLevel * &gt; &amp;levels) const</div><div class="ttdef"><b>Definition:</b> txsheet.cpp:489</div></div>
<div class="ttc" id="aclass_toonz_scene_html_abb12422205be4336c3dee1aa5fbdc5e5"><div class="ttname"><a href="class_toonz_scene.html#abb12422205be4336c3dee1aa5fbdc5e5">ToonzScene::codeFilePath</a></div><div class="ttdeci">TFilePath codeFilePath(const TFilePath &amp;) const</div><div class="ttdef"><b>Definition:</b> toonzscene.cpp:1328</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
