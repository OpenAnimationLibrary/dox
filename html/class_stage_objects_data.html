<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>opentoonz: StageObjectsData Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">opentoonz
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_stage_objects_data-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">StageObjectsData Class Reference<span class="mlabels"><span class="mlabel">final</span></span></div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="">stageobjectsdata.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for StageObjectsData:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_stage_objects_data.png" usemap="#StageObjectsData_map" alt=""/>
  <map id="StageObjectsData_map" name="StageObjectsData_map">
<area href="class_dv_mime_data.html" alt="DvMimeData" shape="rect" coords="61,56,174,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a460fd4a40aed983184fcd08cccbdbdfa"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><b>FxFlags</b> { <b>eDoClone</b> = 0x1
, <b>eResetFxDagPositions</b>
 }</td></tr>
<tr class="separator:a460fd4a40aed983184fcd08cccbdbdfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae6eb30476a37d63ea3d24da98a9096db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_stage_objects_data.html">StageObjectsData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stage_objects_data.html#ae6eb30476a37d63ea3d24da98a9096db">clone</a> () const override</td></tr>
<tr class="separator:ae6eb30476a37d63ea3d24da98a9096db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa75db1ed8c5cd0412cb353126684b1b1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stage_objects_data.html#aa75db1ed8c5cd0412cb353126684b1b1">isEmpty</a> () const</td></tr>
<tr class="separator:aa75db1ed8c5cd0412cb353126684b1b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1bf651aeb67ce71d2deb874e3d37e26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stage_objects_data.html#ab1bf651aeb67ce71d2deb874e3d37e26">storeObjects</a> (const std::vector&lt; <a class="el" href="class_t_stage_object_id.html">TStageObjectId</a> &gt; &amp;ids, <a class="el" href="class_t_xsheet.html">TXsheet</a> *xsheet, int fxFlags)</td></tr>
<tr class="separator:ab1bf651aeb67ce71d2deb874e3d37e26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64d285aa4bb0f00d17e0f659e1d28ae3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stage_objects_data.html#a64d285aa4bb0f00d17e0f659e1d28ae3">storeColumns</a> (const std::set&lt; int &gt; &amp;columnIndexes, <a class="el" href="class_t_xsheet.html">TXsheet</a> *xsheet, int fxFlags)</td></tr>
<tr class="memdesc:a64d285aa4bb0f00d17e0f659e1d28ae3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overloaded function, stores the specified columns in the supplied xsheet.  <a href="class_stage_objects_data.html#a64d285aa4bb0f00d17e0f659e1d28ae3">More...</a><br /></td></tr>
<tr class="separator:a64d285aa4bb0f00d17e0f659e1d28ae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4716c1e39e02f7ae4ef25a4f670b6b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stage_objects_data.html#ab4716c1e39e02f7ae4ef25a4f670b6b6">storeFxs</a> (const std::set&lt; <a class="el" href="class_t_fx.html">TFx</a> * &gt; &amp;fxs, <a class="el" href="class_t_xsheet.html">TXsheet</a> *xsheet, int fxFlags)</td></tr>
<tr class="memdesc:ab4716c1e39e02f7ae4ef25a4f670b6b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the specified fxs from the xsheet.  <a href="class_stage_objects_data.html#ab4716c1e39e02f7ae4ef25a4f670b6b6">More...</a><br /></td></tr>
<tr class="separator:ab4716c1e39e02f7ae4ef25a4f670b6b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbffc8f0eafc04b34b5247bf1e21fdcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stage_objects_data.html#acbffc8f0eafc04b34b5247bf1e21fdcf">storeColumnFxs</a> (const std::set&lt; int &gt; &amp;columnIndexes, <a class="el" href="class_t_xsheet.html">TXsheet</a> *xsh, int fxFlags)</td></tr>
<tr class="separator:acbffc8f0eafc04b34b5247bf1e21fdcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8273a597f1714f536f9170af58a0e4d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stage_objects_data.html#a8273a597f1714f536f9170af58a0e4d7">storeSplines</a> (const std::list&lt; int &gt; &amp;splineIds, <a class="el" href="class_t_xsheet.html">TXsheet</a> *xsh, int fxFlags)</td></tr>
<tr class="separator:a8273a597f1714f536f9170af58a0e4d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfa93a60503a86ad264f0538d933f161"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stage_objects_data.html#adfa93a60503a86ad264f0538d933f161">checkCircularReferences</a> (<a class="el" href="class_t_xsheet.html">TXsheet</a> *xsheet) const</td></tr>
<tr class="separator:adfa93a60503a86ad264f0538d933f161"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb1ab2a0891bd82400614e2b81f0ce0e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="class_t_stage_object_id.html">TStageObjectId</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stage_objects_data.html#acb1ab2a0891bd82400614e2b81f0ce0e">restoreObjects</a> (std::set&lt; int &gt; &amp;columnIndices, std::list&lt; int &gt; &amp;restoredSplinIds, <a class="el" href="class_t_xsheet.html">TXsheet</a> *xsheet, int fxFlags, const <a class="el" href="class_t_point_t.html">TPointD</a> &amp;pos=TConst::nowhere) const</td></tr>
<tr class="separator:acb1ab2a0891bd82400614e2b81f0ce0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa77025146e667bad54d703cba383657a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="class_t_stage_object_id.html">TStageObjectId</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stage_objects_data.html#aa77025146e667bad54d703cba383657a">restoreObjects</a> (std::set&lt; int &gt; &amp;columnIndices, std::list&lt; int &gt; &amp;restoredSplinIds, <a class="el" href="class_t_xsheet.html">TXsheet</a> *xsheet, int fxFlags, QMap&lt; <a class="el" href="class_t_stage_object_id.html">TStageObjectId</a>, <a class="el" href="class_t_stage_object_id.html">TStageObjectId</a> &gt; &amp;idTable, QMap&lt; <a class="el" href="class_t_fx.html">TFx</a> *, <a class="el" href="class_t_fx.html">TFx</a> * &gt; &amp;fxTable, const <a class="el" href="class_t_point_t.html">TPointD</a> &amp;pos=TConst::nowhere) const</td></tr>
<tr class="separator:aa77025146e667bad54d703cba383657a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_dv_mime_data"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_dv_mime_data')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_dv_mime_data.html">DvMimeData</a></td></tr>
<tr class="memitem:a3c580441bf8de1aa871d551d7ff1c71a inherit pub_methods_class_dv_mime_data"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="class_dv_mime_data.html">DvMimeData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_dv_mime_data.html#a3c580441bf8de1aa871d551d7ff1c71a">clone</a> () const =0</td></tr>
<tr class="separator:a3c580441bf8de1aa871d551d7ff1c71a inherit pub_methods_class_dv_mime_data"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa02a17f20b2f1d6d61a50d7adcdea4ca inherit pub_methods_class_dv_mime_data"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_dv_mime_data.html#aa02a17f20b2f1d6d61a50d7adcdea4ca">releaseData</a> ()</td></tr>
<tr class="separator:aa02a17f20b2f1d6d61a50d7adcdea4ca inherit pub_methods_class_dv_mime_data"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c580441bf8de1aa871d551d7ff1c71a inherit pub_methods_class_dv_mime_data"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="class_dv_mime_data.html">DvMimeData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_dv_mime_data.html#a3c580441bf8de1aa871d551d7ff1c71a">clone</a> () const =0</td></tr>
<tr class="separator:a3c580441bf8de1aa871d551d7ff1c71a inherit pub_methods_class_dv_mime_data"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p ><a class="el" href="class_stage_objects_data.html">StageObjectsData</a> is the class used to store multiple schematic stage object's relational data. </p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a460fd4a40aed983184fcd08cccbdbdfa" name="a460fd4a40aed983184fcd08cccbdbdfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a460fd4a40aed983184fcd08cccbdbdfa">&#9670;&nbsp;</a></span>FxFlags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum StageObjectsData::FxFlags</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   74</span>               {</div>
<div class="line"><span class="lineno">   75</span>    eDoClone = 0x1,  <span class="comment">// Clones sensible stored data</span></div>
<div class="line"><span class="lineno">   76</span>    eResetFxDagPositions =</div>
<div class="line"><span class="lineno">   77</span>        0x2  <span class="comment">// Accepts default positions for newly created FX objects</span></div>
<div class="line"><span class="lineno">   78</span>  };</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aaff2602db90592562cd6ac03daa18bbc" name="aaff2602db90592562cd6ac03daa18bbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaff2602db90592562cd6ac03daa18bbc">&#9670;&nbsp;</a></span>StageObjectsData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StageObjectsData::StageObjectsData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  533</span>: <a class="code hl_class" href="class_dv_mime_data.html">DvMimeData</a>() {}</div>
<div class="ttc" id="aclass_dv_mime_data_html"><div class="ttname"><a href="class_dv_mime_data.html">DvMimeData</a></div><div class="ttdef"><b>Definition:</b> dvmimedata.h:23</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbdddc24d355716acb335cfcc05c9e98" name="acbdddc24d355716acb335cfcc05c9e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbdddc24d355716acb335cfcc05c9e98">&#9670;&nbsp;</a></span>~StageObjectsData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StageObjectsData::~StageObjectsData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  537</span>                                    {</div>
<div class="line"><span class="lineno">  538</span>  <span class="keywordtype">int</span> i, elementsCount = m_elements.size();</div>
<div class="line"><span class="lineno">  539</span>  <span class="keywordflow">for</span> (i = 0; i &lt; elementsCount; ++i) <span class="keyword">delete</span> m_elements[i];</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>  <span class="keywordflow">for</span> (i = 0; i &lt; m_splines.size(); ++i) <span class="keyword">delete</span> m_splines[i];</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>  std::set&lt;TFx *&gt;::iterator it;</div>
<div class="line"><span class="lineno">  544</span>  <span class="keywordflow">for</span> (it = m_fxs.begin(); it != m_fxs.end(); ++it) {</div>
<div class="line"><span class="lineno">  545</span>    <a class="code hl_class" href="class_t_fx.html">TFx</a> *fx = *it;</div>
<div class="line"><span class="lineno">  546</span>    <span class="keywordflow">if</span> (fx) fx-&gt;release();</div>
<div class="line"><span class="lineno">  547</span>  }</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>  <span class="keywordflow">for</span> (it = m_terminalFxs.begin(); it != m_terminalFxs.end(); ++it) {</div>
<div class="line"><span class="lineno">  550</span>    <a class="code hl_class" href="class_t_fx.html">TFx</a> *fx = *it;</div>
<div class="line"><span class="lineno">  551</span>    <span class="keywordflow">if</span> (fx) fx-&gt;release();</div>
<div class="line"><span class="lineno">  552</span>  }</div>
<div class="line"><span class="lineno">  553</span>}</div>
<div class="ttc" id="aclass_t_fx_html"><div class="ttname"><a href="class_t_fx.html">TFx</a></div><div class="ttdef"><b>Definition:</b> tfx.h:352</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="adfa93a60503a86ad264f0538d933f161" name="adfa93a60503a86ad264f0538d933f161"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfa93a60503a86ad264f0538d933f161">&#9670;&nbsp;</a></span>checkCircularReferences()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool StageObjectsData::checkCircularReferences </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_xsheet.html">TXsheet</a> *&#160;</td>
          <td class="paramname"><em>xsheet</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Scans the stored column elements to verify if the specified xsheet is a sub-xsheet in of them (thus creating an impossible '\it{circular reference}'). </p>
<div class="fragment"><div class="line"><span class="lineno">  557</span>                                                                 {</div>
<div class="line"><span class="lineno">  558</span>  <span class="keywordtype">int</span> i, elementsCount = m_elements.size();</div>
<div class="line"><span class="lineno">  559</span>  <span class="keywordflow">for</span> (i = 0; i &lt; elementsCount; ++i) {</div>
<div class="line"><span class="lineno">  560</span>    <a class="code hl_class" href="class_t_column_data_element.html">TColumnDataElement</a> *columnElement =</div>
<div class="line"><span class="lineno">  561</span>        <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_column_data_element.html">TColumnDataElement</a> *<span class="keyword">&gt;</span>(m_elements[i]);</div>
<div class="line"><span class="lineno">  562</span>    <span class="keywordflow">if</span> (!columnElement) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>    <span class="keywordflow">if</span> (xsh-&gt;checkCircularReferences(columnElement-&gt;m_column.getPointer()))</div>
<div class="line"><span class="lineno">  565</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  566</span>  }</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  569</span>}</div>
<div class="ttc" id="aclass_t_column_data_element_html"><div class="ttname"><a href="class_t_column_data_element.html">TColumnDataElement</a></div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:238</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l01583">TXsheet::checkCircularReferences()</a>.</p>

</div>
</div>
<a id="ae6eb30476a37d63ea3d24da98a9096db" name="ae6eb30476a37d63ea3d24da98a9096db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6eb30476a37d63ea3d24da98a9096db">&#9670;&nbsp;</a></span>clone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_stage_objects_data.html">StageObjectsData</a> * StageObjectsData::clone </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Clones this object. </p><dl class="section note"><dt>Note</dt><dd>Clones stored fxs, columns, etc. too. </dd></dl>

<p>Implements <a class="el" href="class_dv_mime_data.html">DvMimeData</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  573</span>                                                {</div>
<div class="line"><span class="lineno">  574</span>  <a class="code hl_class" href="class_stage_objects_data.html">StageObjectsData</a> *data = <span class="keyword">new</span> <a class="code hl_class" href="class_stage_objects_data.html">StageObjectsData</a>();</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>  <span class="comment">// Clone each element (the new data gets ownership)</span></div>
<div class="line"><span class="lineno">  577</span>  <span class="keywordtype">int</span> i, elementsCount = m_elements.size();</div>
<div class="line"><span class="lineno">  578</span>  <span class="keywordflow">for</span> (i = 0; i &lt; elementsCount; ++i)</div>
<div class="line"><span class="lineno">  579</span>    data-&gt;m_elements.append(m_elements[i]-&gt;clone());</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>  <span class="comment">// Clone each spline (the new data gets ownership)</span></div>
<div class="line"><span class="lineno">  582</span>  <span class="keywordflow">for</span> (i = 0; i &lt; m_splines.size(); ++i)</div>
<div class="line"><span class="lineno">  583</span>    data-&gt;m_splines.append(m_splines[i]-&gt;clone());</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>  <span class="comment">// Same for internal fxs</span></div>
<div class="line"><span class="lineno">  586</span>  std::map&lt;TFx *, TFx *&gt; fxTable;  <span class="comment">// And trace the pairings with the originals</span></div>
<div class="line"><span class="lineno">  587</span>  std::set&lt;TFx *&gt;::const_iterator it;</div>
<div class="line"><span class="lineno">  588</span>  <span class="keywordflow">for</span> (it = m_fxs.begin(); it != m_fxs.end(); ++it) {</div>
<div class="line"><span class="lineno">  589</span>    <a class="code hl_class" href="class_t_fx.html">TFx</a> *fxOrig = *it;</div>
<div class="line"><span class="lineno">  590</span>    assert(fxOrig);</div>
<div class="line"><span class="lineno">  591</span>    assert(fxTable.count(fxOrig) == 0);</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>    <a class="code hl_class" href="class_t_fx.html">TFx</a> *fx = fxOrig-&gt;clone(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  594</span>    fx-&gt;getAttributes()-&gt;setId(fxOrig-&gt;getAttributes()-&gt;getId());</div>
<div class="line"><span class="lineno">  595</span>    fx-&gt;getAttributes()-&gt;passiveCacheDataIdx() = -1;</div>
<div class="line"><span class="lineno">  596</span>    fx-&gt;setName(fxOrig-&gt;getName());</div>
<div class="line"><span class="lineno">  597</span>    fx-&gt;setFxId(fxOrig-&gt;getFxId());</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>    fxTable[fxOrig] = fx;</div>
<div class="line"><span class="lineno">  600</span>    fx-&gt;addRef();</div>
<div class="line"><span class="lineno">  601</span>    data-&gt;m_fxs.insert(fx);</div>
<div class="line"><span class="lineno">  602</span>  }</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>  <span class="comment">// Same with terminals</span></div>
<div class="line"><span class="lineno">  605</span>  <span class="keywordflow">for</span> (it = m_terminalFxs.begin(); it != m_terminalFxs.end(); ++it) {</div>
<div class="line"><span class="lineno">  606</span>    <a class="code hl_class" href="class_t_fx.html">TFx</a> *fxOrig = *it;</div>
<div class="line"><span class="lineno">  607</span>    assert(fxOrig);</div>
<div class="line"><span class="lineno">  608</span> </div>
<div class="line"><span class="lineno">  609</span>    <span class="comment">// If the fx was not already cloned above, do it now</span></div>
<div class="line"><span class="lineno">  610</span>    <a class="code hl_class" href="class_t_fx.html">TFx</a> *fx = searchFx(fxTable, fxOrig);</div>
<div class="line"><span class="lineno">  611</span>    <span class="keywordflow">if</span> (!fx) {</div>
<div class="line"><span class="lineno">  612</span>      fx = fxOrig-&gt;clone(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  613</span>      fx-&gt;getAttributes()-&gt;setId(fxOrig-&gt;getAttributes()-&gt;getId());</div>
<div class="line"><span class="lineno">  614</span>      fx-&gt;getAttributes()-&gt;passiveCacheDataIdx() = -1;</div>
<div class="line"><span class="lineno">  615</span>      fx-&gt;setName(fxOrig-&gt;getName());</div>
<div class="line"><span class="lineno">  616</span>      fx-&gt;setFxId(fxOrig-&gt;getFxId());</div>
<div class="line"><span class="lineno">  617</span>      fxTable[fxOrig] = fx;</div>
<div class="line"><span class="lineno">  618</span>    }</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>    fx-&gt;addRef();</div>
<div class="line"><span class="lineno">  621</span>    data-&gt;m_terminalFxs.insert(fx);</div>
<div class="line"><span class="lineno">  622</span>  }</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>  <span class="keywordflow">if</span> (!fxTable.empty())</div>
<div class="line"><span class="lineno">  625</span>    updateFxLinks(fxTable);  <span class="comment">// Applies the traced map pairings to every fx</span></div>
<div class="line"><span class="lineno">  626</span>                             <span class="comment">// descendant of each fx stored in the map.</span></div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>  <span class="comment">// WARNING: m_fxsTable is NOT COPIED / CLONED !!</span></div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>  <span class="keywordflow">return</span> data;</div>
<div class="line"><span class="lineno">  631</span>}</div>
<div class="ttc" id="aclass_stage_objects_data_html"><div class="ttname"><a href="class_stage_objects_data.html">StageObjectsData</a></div><div class="ttdef"><b>Definition:</b> stageobjectsdata.h:54</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa75db1ed8c5cd0412cb353126684b1b1" name="aa75db1ed8c5cd0412cb353126684b1b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa75db1ed8c5cd0412cb353126684b1b1">&#9670;&nbsp;</a></span>isEmpty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool StageObjectsData::isEmpty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   88</span>{ <span class="keywordflow">return</span> m_elements.isEmpty() &amp;&amp; m_splines.isEmpty(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="acb1ab2a0891bd82400614e2b81f0ce0e" name="acb1ab2a0891bd82400614e2b81f0ce0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb1ab2a0891bd82400614e2b81f0ce0e">&#9670;&nbsp;</a></span>restoreObjects() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="class_t_stage_object_id.html">TStageObjectId</a> &gt; StageObjectsData::restoreObjects </td>
          <td>(</td>
          <td class="paramtype">std::set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>columnIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>restoredSplinIds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsheet.html">TXsheet</a> *&#160;</td>
          <td class="paramname"><em>xsheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fxFlags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_point_t.html">TPointD</a> &amp;&#160;</td>
          <td class="paramname"><em>pos</em> = <code>TConst::nowhere</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Restores the stored objects in the supplied xsheet, inserting columns with the specified indices. In case there are more stored columns than specified column indices, the remaining columns are inserted right after the last specified index. Returns the inserted stage object identifiers and updates the columnIndices with all the newly inserted column indices. Additional flags support <a class="el" href="class_t_xsh_column.html" title="The TXshColumn class is the base class of column managers in xsheet.">TXshColumn</a> cloning before insertion. </p>
<div class="fragment"><div class="line"><span class="lineno">  919</span>                                           {</div>
<div class="line"><span class="lineno">  920</span>  QMap&lt;TStageObjectId, TStageObjectId&gt; idTable;</div>
<div class="line"><span class="lineno">  921</span>  QMap&lt;TFx *, TFx *&gt; fxTable;</div>
<div class="line"><span class="lineno">  922</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="class_stage_objects_data.html#acb1ab2a0891bd82400614e2b81f0ce0e">restoreObjects</a>(columnIndices, restoredSpline, xsh, fxFlags, idTable,</div>
<div class="line"><span class="lineno">  923</span>                        fxTable, pos);</div>
<div class="line"><span class="lineno">  924</span>}</div>
<div class="ttc" id="aclass_stage_objects_data_html_acb1ab2a0891bd82400614e2b81f0ce0e"><div class="ttname"><a href="class_stage_objects_data.html#acb1ab2a0891bd82400614e2b81f0ce0e">StageObjectsData::restoreObjects</a></div><div class="ttdeci">std::vector&lt; TStageObjectId &gt; restoreObjects(std::set&lt; int &gt; &amp;columnIndices, std::list&lt; int &gt; &amp;restoredSplinIds, TXsheet *xsheet, int fxFlags, const TPointD &amp;pos=TConst::nowhere) const</div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:917</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00917">restoreObjects()</a>.</p>

<p class="reference">Referenced by <a class="el" href="#l00917">restoreObjects()</a>.</p>

</div>
</div>
<a id="aa77025146e667bad54d703cba383657a" name="aa77025146e667bad54d703cba383657a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa77025146e667bad54d703cba383657a">&#9670;&nbsp;</a></span>restoreObjects() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="class_t_stage_object_id.html">TStageObjectId</a> &gt; StageObjectsData::restoreObjects </td>
          <td>(</td>
          <td class="paramtype">std::set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>columnIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>restoredSplinIds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsheet.html">TXsheet</a> *&#160;</td>
          <td class="paramname"><em>xsheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fxFlags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QMap&lt; <a class="el" href="class_t_stage_object_id.html">TStageObjectId</a>, <a class="el" href="class_t_stage_object_id.html">TStageObjectId</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>idTable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QMap&lt; <a class="el" href="class_t_fx.html">TFx</a> *, <a class="el" href="class_t_fx.html">TFx</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>fxTable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_t_point_t.html">TPointD</a> &amp;&#160;</td>
          <td class="paramname"><em>pos</em> = <code>TConst::nowhere</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  932</span>                                                           {</div>
<div class="line"><span class="lineno">  933</span>  <span class="keywordtype">bool</span> doClone             = (fxFlags &amp; eDoClone);</div>
<div class="line"><span class="lineno">  934</span>  <span class="keywordtype">bool</span> resetFxDagPositions = (fxFlags &amp; eResetFxDagPositions);</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span>  <span class="comment">// QMap&lt;TStageObjectId, TStageObjectId&gt;</span></div>
<div class="line"><span class="lineno">  937</span>  <span class="comment">//    idTable;                     // Trace stored/restored id pairings</span></div>
<div class="line"><span class="lineno">  938</span>  <span class="comment">// std::map&lt;TFx *, TFx *&gt; fxTable;  // Same for fxs here</span></div>
<div class="line"><span class="lineno">  939</span>  std::vector&lt;TStageObjectId&gt; restoredIds;</div>
<div class="line"><span class="lineno">  940</span> </div>
<div class="line"><span class="lineno">  941</span>  std::set&lt;int&gt;::iterator idxt = columnIndices.begin();</div>
<div class="line"><span class="lineno">  942</span>  <span class="keywordtype">int</span> index                    = -1;  <span class="comment">// The actual column insertion index</span></div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>  <span class="keywordtype">int</span> i, elementsCount = m_elements.size();</div>
<div class="line"><span class="lineno">  945</span>  <span class="keywordflow">for</span> (i = 0; i &lt; elementsCount; ++i) {</div>
<div class="line"><span class="lineno">  946</span>    <a class="code hl_class" href="class_t_stage_object_data_element.html">TStageObjectDataElement</a> *element = m_elements[i];</div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>    <a class="code hl_class" href="class_t_camera_data_element.html">TCameraDataElement</a> *cameraElement =</div>
<div class="line"><span class="lineno">  949</span>        <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_camera_data_element.html">TCameraDataElement</a> *<span class="keyword">&gt;</span>(element);</div>
<div class="line"><span class="lineno">  950</span>    <a class="code hl_class" href="class_t_column_data_element.html">TColumnDataElement</a> *columnElement =</div>
<div class="line"><span class="lineno">  951</span>        <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_column_data_element.html">TColumnDataElement</a> *<span class="keyword">&gt;</span>(element);</div>
<div class="line"><span class="lineno">  952</span> </div>
<div class="line"><span class="lineno">  953</span>    <span class="comment">// Restore the object depending on its specific type</span></div>
<div class="line"><span class="lineno">  954</span>    <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> restoredId = TStageObjectId::NoneId;</div>
<div class="line"><span class="lineno">  955</span> </div>
<div class="line"><span class="lineno">  956</span>    <span class="keywordflow">if</span> (!cameraElement &amp;&amp; !columnElement)</div>
<div class="line"><span class="lineno">  957</span>      restoredId = element-&gt;<a class="code hl_function" href="class_t_stage_object_data_element.html#abbd9e7886bc0abfb3334cde40434d08b">restoreObject</a>(xsh, pos != TConst::nowhere);</div>
<div class="line"><span class="lineno">  958</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cameraElement)</div>
<div class="line"><span class="lineno">  959</span>      restoredId = cameraElement-&gt;<a class="code hl_function" href="class_t_camera_data_element.html#aa85bc2f75f09af52dd966d571e956d6a">restoreCamera</a>(xsh, pos != TConst::nowhere);</div>
<div class="line"><span class="lineno">  960</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (columnElement) {</div>
<div class="line"><span class="lineno">  961</span>      <span class="comment">// Build the column insertion index</span></div>
<div class="line"><span class="lineno">  962</span>      <span class="keywordflow">if</span> (idxt != columnIndices.end())</div>
<div class="line"><span class="lineno">  963</span>        index = *idxt++;</div>
<div class="line"><span class="lineno">  964</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  965</span>        ++index;</div>
<div class="line"><span class="lineno">  966</span>        columnIndices.insert(index);</div>
<div class="line"><span class="lineno">  967</span>      }</div>
<div class="line"><span class="lineno">  968</span> </div>
<div class="line"><span class="lineno">  969</span>      <span class="comment">// Restore the column element</span></div>
<div class="line"><span class="lineno">  970</span>      restoredId = columnElement-&gt;<a class="code hl_function" href="class_t_column_data_element.html#a22322066607671d817d6fd36c34e7d6c">restoreColumn</a>(xsh, index, fxFlags,</div>
<div class="line"><span class="lineno">  971</span>                                                pos != TConst::nowhere);</div>
<div class="line"><span class="lineno">  972</span> </div>
<div class="line"><span class="lineno">  973</span>      <a class="code hl_class" href="class_fx_dag.html">FxDag</a> *fxDag = xsh-&gt;getFxDag();</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>      <a class="code hl_class" href="class_t_xsh_column.html">TXshColumn</a> *column       = columnElement-&gt;m_column.getPointer();</div>
<div class="line"><span class="lineno">  976</span>      <a class="code hl_class" href="class_t_xsh_column.html">TXshColumn</a> *pastedColumn = xsh-&gt;getColumn(index);</div>
<div class="line"><span class="lineno">  977</span> </div>
<div class="line"><span class="lineno">  978</span>      <a class="code hl_class" href="class_t_fx.html">TFx</a> *fx       = column-&gt;getFx();</div>
<div class="line"><span class="lineno">  979</span>      <a class="code hl_class" href="class_t_fx.html">TFx</a> *pastedFx = pastedColumn-&gt;getFx();</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>      <span class="keywordflow">if</span> (fx &amp;&amp; pastedFx) fxTable[fx] = pastedFx;</div>
<div class="line"><span class="lineno">  982</span> </div>
<div class="line"><span class="lineno">  983</span>      <span class="comment">// Enforce the correct terminality. Added columns are terminal by default.</span></div>
<div class="line"><span class="lineno">  984</span>      <span class="keywordtype">bool</span> terminal = (fx &amp;&amp; (m_terminalFxs.count(fx) &gt; 0));</div>
<div class="line"><span class="lineno">  985</span>      <span class="keywordflow">if</span> (!terminal) fxDag-&gt;getTerminalFxs()-&gt;removeFx(pastedFx);</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>      <span class="comment">// In case we&#39;ve cloned a zerary fx column, update the actual fx&#39;s data</span></div>
<div class="line"><span class="lineno">  988</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_xsh_zerary_fx_column.html">TXshZeraryFxColumn</a> *zc =</div>
<div class="line"><span class="lineno">  989</span>              <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_xsh_zerary_fx_column.html">TXshZeraryFxColumn</a> *<span class="keyword">&gt;</span>(pastedColumn)) {</div>
<div class="line"><span class="lineno">  990</span>        <a class="code hl_class" href="class_t_zerary_column_fx.html">TZeraryColumnFx</a> *zfx = zc-&gt;getZeraryColumnFx();</div>
<div class="line"><span class="lineno">  991</span>        <a class="code hl_class" href="class_t_fx.html">TFx</a> *zeraryFx        = zfx-&gt;getZeraryFx();</div>
<div class="line"><span class="lineno">  992</span>        <span class="keywordflow">if</span> (zeraryFx) {</div>
<div class="line"><span class="lineno">  993</span>          <span class="keywordflow">if</span> (doClone) {</div>
<div class="line"><span class="lineno">  994</span>            <span class="comment">// if the fx has not unique name then let  assignUniqueId() set the</span></div>
<div class="line"><span class="lineno">  995</span>            <span class="comment">// default name</span></div>
<div class="line"><span class="lineno">  996</span>            <span class="keywordflow">if</span> (zeraryFx-&gt;getName() == zeraryFx-&gt;getFxId())</div>
<div class="line"><span class="lineno">  997</span>              zeraryFx-&gt;setName(L<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  998</span>            fxDag-&gt;assignUniqueId(zeraryFx);</div>
<div class="line"><span class="lineno">  999</span>          } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1000</span>            fxDag-&gt;updateFxIdTable(zeraryFx);</div>
<div class="line"><span class="lineno"> 1001</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_xsh_zerary_fx_column.html">TXshZeraryFxColumn</a> *orig_zc =</div>
<div class="line"><span class="lineno"> 1002</span>                  <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_xsh_zerary_fx_column.html">TXshZeraryFxColumn</a> *<span class="keyword">&gt;</span>(column)) {</div>
<div class="line"><span class="lineno"> 1003</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="class_t_fx.html">TFx</a> *origZeraryFx = orig_zc-&gt;getZeraryColumnFx()-&gt;getZeraryFx())</div>
<div class="line"><span class="lineno"> 1004</span>              fxTable[origZeraryFx] = zeraryFx;</div>
<div class="line"><span class="lineno"> 1005</span>          }</div>
<div class="line"><span class="lineno"> 1006</span>        }</div>
<div class="line"><span class="lineno"> 1007</span>      }</div>
<div class="line"><span class="lineno"> 1008</span>    }</div>
<div class="line"><span class="lineno"> 1009</span> </div>
<div class="line"><span class="lineno"> 1010</span>    <span class="comment">// Remember stored/restored stage object pairings</span></div>
<div class="line"><span class="lineno"> 1011</span>    idTable[element-&gt;<a class="code hl_variable" href="class_t_stage_object_data_element.html#a9f717b885c1f0debcfe2930268a06361">m_params</a>-&gt;m_id] = restoredId;</div>
<div class="line"><span class="lineno"> 1012</span>    restoredIds.push_back(restoredId);</div>
<div class="line"><span class="lineno"> 1013</span>  }</div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>  <span class="comment">// Apply stage object-parental relationships</span></div>
<div class="line"><span class="lineno"> 1016</span>  <span class="keywordflow">for</span> (i = 0; i &lt; elementsCount; ++i) {</div>
<div class="line"><span class="lineno"> 1017</span>    <a class="code hl_class" href="class_t_stage_object_data_element.html">TStageObjectDataElement</a> *element = m_elements[i];</div>
<div class="line"><span class="lineno"> 1018</span> </div>
<div class="line"><span class="lineno"> 1019</span>    <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> <span class="keywordtype">id</span>       = element-&gt;<a class="code hl_variable" href="class_t_stage_object_data_element.html#a9f717b885c1f0debcfe2930268a06361">m_params</a>-&gt;m_id;</div>
<div class="line"><span class="lineno"> 1020</span>    <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> parentId = element-&gt;<a class="code hl_variable" href="class_t_stage_object_data_element.html#a9f717b885c1f0debcfe2930268a06361">m_params</a>-&gt;m_parentId;</div>
<div class="line"><span class="lineno"> 1021</span> </div>
<div class="line"><span class="lineno"> 1022</span>    <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> pastedId       = idTable[id];</div>
<div class="line"><span class="lineno"> 1023</span>    <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> pastedParentId = parentId;</div>
<div class="line"><span class="lineno"> 1024</span> </div>
<div class="line"><span class="lineno"> 1025</span>    <span class="comment">// if the parent object is not restored, redirect to the table</span></div>
<div class="line"><span class="lineno"> 1026</span>    QMap&lt;TStageObjectId, TStageObjectId&gt;::iterator it = idTable.find(parentId);</div>
<div class="line"><span class="lineno"> 1027</span>    pastedParentId =</div>
<div class="line"><span class="lineno"> 1028</span>        (it == idTable.end()) ? TStageObjectId::TableId : it.value();</div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span>    xsh-&gt;setStageObjectParent(pastedId, pastedParentId);</div>
<div class="line"><span class="lineno"> 1031</span>    <a class="code hl_class" href="class_t_stage_object.html">TStageObject</a> *pastedObj = xsh-&gt;getStageObject(pastedId);</div>
<div class="line"><span class="lineno"> 1032</span> </div>
<div class="line"><span class="lineno"> 1033</span>    <span class="comment">// Shouldn&#39;t these be done outside ?</span></div>
<div class="line"><span class="lineno"> 1034</span>    pastedObj-&gt;<a class="code hl_function" href="class_t_stage_object.html#a8478e56c447b15faeda7365de0fd15ea">setHandle</a>(element-&gt;<a class="code hl_variable" href="class_t_stage_object_data_element.html#a9f717b885c1f0debcfe2930268a06361">m_params</a>-&gt;m_handle);</div>
<div class="line"><span class="lineno"> 1035</span>    pastedObj-&gt;<a class="code hl_function" href="class_t_stage_object.html#a8c8e56d26f94b5b655e2e3246ff66ec5">setParentHandle</a>(element-&gt;<a class="code hl_variable" href="class_t_stage_object_data_element.html#a9f717b885c1f0debcfe2930268a06361">m_params</a>-&gt;m_parentHandle);</div>
<div class="line"><span class="lineno"> 1036</span>  }</div>
<div class="line"><span class="lineno"> 1037</span> </div>
<div class="line"><span class="lineno"> 1038</span>  <span class="comment">// Iterate stored fxs</span></div>
<div class="line"><span class="lineno"> 1039</span>  std::set&lt;TFx *&gt;::const_iterator fxt, end = m_fxs.end();</div>
<div class="line"><span class="lineno"> 1040</span>  <span class="keywordflow">for</span> (fxt = m_fxs.begin(); fxt != end; ++fxt) {</div>
<div class="line"><span class="lineno"> 1041</span>    <a class="code hl_class" href="class_t_fx.html">TFx</a> *fxOrig = *fxt, *fx = fxOrig;</div>
<div class="line"><span class="lineno"> 1042</span> </div>
<div class="line"><span class="lineno"> 1043</span>    <span class="comment">// Only NOT COLUMN fxs - ie internal fxs</span></div>
<div class="line"><span class="lineno"> 1044</span>    <span class="keywordflow">if</span> (fxTable.find(fxOrig) != fxTable.end()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1045</span> </div>
<div class="line"><span class="lineno"> 1046</span>    <span class="comment">// Internal fxs</span></div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>    <span class="keywordflow">if</span> (doClone) {</div>
<div class="line"><span class="lineno"> 1049</span>      fx = fxOrig-&gt;clone(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1050</span>      <span class="comment">// if the fx has not unique name then let assignUniqueId() set the default</span></div>
<div class="line"><span class="lineno"> 1051</span>      <span class="comment">// name</span></div>
<div class="line"><span class="lineno"> 1052</span>      <span class="keywordflow">if</span> (fx-&gt;getName() == fx-&gt;getFxId()) fx-&gt;setName(L<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1053</span>      fx-&gt;getAttributes()-&gt;setId(fxOrig-&gt;getAttributes()-&gt;getId());</div>
<div class="line"><span class="lineno"> 1054</span>      fx-&gt;getAttributes()-&gt;passiveCacheDataIdx() = -1;</div>
<div class="line"><span class="lineno"> 1055</span> </div>
<div class="line"><span class="lineno"> 1056</span>      <span class="keywordflow">if</span> (resetFxDagPositions)</div>
<div class="line"><span class="lineno"> 1057</span>        fx-&gt;getAttributes()-&gt;setDagNodePos(TConst::nowhere);</div>
<div class="line"><span class="lineno"> 1058</span> </div>
<div class="line"><span class="lineno"> 1059</span>      xsh-&gt;getFxDag()-&gt;assignUniqueId(</div>
<div class="line"><span class="lineno"> 1060</span>          fx);  <span class="comment">// For now, dragging columns always increment fxid.</span></div>
<div class="line"><span class="lineno"> 1061</span>                <span class="comment">// Could it be more adaptive, avoiding increment</span></div>
<div class="line"><span class="lineno"> 1062</span>                <span class="comment">// if it is not necessary?</span></div>
<div class="line"><span class="lineno"> 1063</span>    }</div>
<div class="line"><span class="lineno"> 1064</span> </div>
<div class="line"><span class="lineno"> 1065</span>    fxTable[fxOrig] = fx;</div>
<div class="line"><span class="lineno"> 1066</span> </div>
<div class="line"><span class="lineno"> 1067</span>    <span class="comment">// Insert the passed fx in the xsheet</span></div>
<div class="line"><span class="lineno"> 1068</span>    <a class="code hl_class" href="class_t_output_fx.html">TOutputFx</a> *outFx = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_output_fx.html">TOutputFx</a> *<span class="keyword">&gt;</span>(fx);</div>
<div class="line"><span class="lineno"> 1069</span>    <span class="keywordflow">if</span> (!outFx)</div>
<div class="line"><span class="lineno"> 1070</span>      xsh-&gt;getFxDag()-&gt;getInternalFxs()-&gt;addFx(fx);</div>
<div class="line"><span class="lineno"> 1071</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1072</span>      xsh-&gt;getFxDag()-&gt;addOutputFx(outFx);</div>
<div class="line"><span class="lineno"> 1073</span> </div>
<div class="line"><span class="lineno"> 1074</span>    <span class="keywordflow">if</span> (m_terminalFxs.count(fxOrig) &gt; 0)</div>
<div class="line"><span class="lineno"> 1075</span>      xsh-&gt;getFxDag()-&gt;getTerminalFxs()-&gt;addFx(fx);</div>
<div class="line"><span class="lineno"> 1076</span> </div>
<div class="line"><span class="lineno"> 1077</span>    <span class="keywordflow">if</span> (!doClone) {</div>
<div class="line"><span class="lineno"> 1078</span>      <span class="comment">// Err.... don&#39;t remember. Inquire further? :|</span></div>
<div class="line"><span class="lineno"> 1079</span>      <span class="keywordtype">int</span> fxTypeCount = xsh-&gt;getFxDag()-&gt;getFxTypeCount(fx);</div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span>      <span class="keywordtype">int</span> maxFxTypeId = std::max(fxTypeCount, fx-&gt;getAttributes()-&gt;getId());</div>
<div class="line"><span class="lineno"> 1082</span>      xsh-&gt;getFxDag()-&gt;updateFxTypeTable(fx, maxFxTypeId);</div>
<div class="line"><span class="lineno"> 1083</span>      xsh-&gt;getFxDag()-&gt;updateFxIdTable(fx);</div>
<div class="line"><span class="lineno"> 1084</span>    }</div>
<div class="line"><span class="lineno"> 1085</span> </div>
<div class="line"><span class="lineno"> 1086</span>    <span class="keywordtype">bool</span> isLinked = (fxOrig-&gt;getLinkedFx() != fxOrig);</div>
<div class="line"><span class="lineno"> 1087</span>    <span class="keywordflow">if</span> (isLinked) {</div>
<div class="line"><span class="lineno"> 1088</span>      <span class="keywordflow">if</span> (m_fxs.find(fxOrig-&gt;getLinkedFx()) == m_fxs.end())</div>
<div class="line"><span class="lineno"> 1089</span>        fx-&gt;linkParams(fxOrig-&gt;getLinkedFx());</div>
<div class="line"><span class="lineno"> 1090</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1091</span>        <a class="code hl_class" href="class_t_fx.html">TFx</a> *linkedFx, *oldLinkedFx = fxOrig-&gt;getLinkedFx();</div>
<div class="line"><span class="lineno"> 1092</span>        <span class="keywordflow">if</span> (doClone) {</div>
<div class="line"><span class="lineno"> 1093</span>          <span class="comment">// Clone the linked fx too</span></div>
<div class="line"><span class="lineno"> 1094</span>          linkedFx = fx-&gt;clone(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1095</span>          linkedFx-&gt;linkParams(fx);</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span>          <span class="comment">// if the fx has not unique name then let assignUniqueId() set the</span></div>
<div class="line"><span class="lineno"> 1098</span>          <span class="comment">// default name</span></div>
<div class="line"><span class="lineno"> 1099</span>          <span class="keywordflow">if</span> (linkedFx-&gt;getName() == linkedFx-&gt;getFxId())</div>
<div class="line"><span class="lineno"> 1100</span>            linkedFx-&gt;setName(L<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1101</span>          linkedFx-&gt;getAttributes()-&gt;setId(</div>
<div class="line"><span class="lineno"> 1102</span>              oldLinkedFx-&gt;getAttributes()-&gt;getId());</div>
<div class="line"><span class="lineno"> 1103</span>          linkedFx-&gt;getAttributes()-&gt;passiveCacheDataIdx() = -1;</div>
<div class="line"><span class="lineno"> 1104</span> </div>
<div class="line"><span class="lineno"> 1105</span>          <span class="keywordflow">if</span> (resetFxDagPositions)</div>
<div class="line"><span class="lineno"> 1106</span>            linkedFx-&gt;getAttributes()-&gt;setDagNodePos(TConst::nowhere);</div>
<div class="line"><span class="lineno"> 1107</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1108</span>            linkedFx-&gt;getAttributes()-&gt;setDagNodePos(</div>
<div class="line"><span class="lineno"> 1109</span>                oldLinkedFx-&gt;getAttributes()-&gt;getDagNodePos());</div>
<div class="line"><span class="lineno"> 1110</span> </div>
<div class="line"><span class="lineno"> 1111</span>          xsh-&gt;getFxDag()-&gt;assignUniqueId(linkedFx);</div>
<div class="line"><span class="lineno"> 1112</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1113</span>          linkedFx = oldLinkedFx;</div>
<div class="line"><span class="lineno"> 1114</span> </div>
<div class="line"><span class="lineno"> 1115</span>        fxTable[oldLinkedFx] = linkedFx;</div>
<div class="line"><span class="lineno"> 1116</span> </div>
<div class="line"><span class="lineno"> 1117</span>        xsh-&gt;getFxDag()-&gt;getInternalFxs()-&gt;addFx(linkedFx);</div>
<div class="line"><span class="lineno"> 1118</span>        <span class="keywordflow">if</span> (m_terminalFxs.count(oldLinkedFx) &gt; 0)</div>
<div class="line"><span class="lineno"> 1119</span>          xsh-&gt;getFxDag()-&gt;getTerminalFxs()-&gt;addFx(linkedFx);</div>
<div class="line"><span class="lineno"> 1120</span> </div>
<div class="line"><span class="lineno"> 1121</span>        <span class="keywordflow">if</span> (!doClone) {</div>
<div class="line"><span class="lineno"> 1122</span>          <span class="keywordtype">int</span> fxTypeCount = xsh-&gt;getFxDag()-&gt;getFxTypeCount(linkedFx);</div>
<div class="line"><span class="lineno"> 1123</span>          <span class="keywordtype">int</span> maxFxTypeId =</div>
<div class="line"><span class="lineno"> 1124</span>              std::max(fxTypeCount, linkedFx-&gt;getAttributes()-&gt;getId());</div>
<div class="line"><span class="lineno"> 1125</span>          xsh-&gt;getFxDag()-&gt;updateFxTypeTable(linkedFx, maxFxTypeId);</div>
<div class="line"><span class="lineno"> 1126</span>          xsh-&gt;getFxDag()-&gt;updateFxIdTable(linkedFx);</div>
<div class="line"><span class="lineno"> 1127</span>        }</div>
<div class="line"><span class="lineno"> 1128</span>      }</div>
<div class="line"><span class="lineno"> 1129</span>    }</div>
<div class="line"><span class="lineno"> 1130</span>  }</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>  <span class="comment">// Update the link, like in functions above</span></div>
<div class="line"><span class="lineno"> 1133</span>  <span class="keywordflow">if</span> (!fxTable.empty() &amp;&amp; doClone) updateFxLinks(fxTable.toStdMap());</div>
<div class="line"><span class="lineno"> 1134</span> </div>
<div class="line"><span class="lineno"> 1135</span>  <span class="comment">// Paste any associated spline (not stored im m_splines)</span></div>
<div class="line"><span class="lineno"> 1136</span>  std::map&lt;TStageObjectSpline *, TStageObjectSpline *&gt; splines;</div>
<div class="line"><span class="lineno"> 1137</span>  <span class="keywordflow">for</span> (i = 0; i &lt; (int)restoredIds.size(); ++i) {</div>
<div class="line"><span class="lineno"> 1138</span>    <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> <span class="keywordtype">id</span> = restoredIds[i];</div>
<div class="line"><span class="lineno"> 1139</span>    <a class="code hl_class" href="class_t_stage_object.html">TStageObject</a> *obj = xsh-&gt;getStageObject(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno"> 1140</span> </div>
<div class="line"><span class="lineno"> 1141</span>    <a class="code hl_class" href="class_t_stage_object_spline.html">TStageObjectSpline</a> *spline = obj-&gt;<a class="code hl_function" href="class_t_stage_object.html#a425cb2dbcefe6ba4e288e1e8bdd16f72">getSpline</a>();</div>
<div class="line"><span class="lineno"> 1142</span>    <span class="keywordflow">if</span> (!spline) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1143</span> </div>
<div class="line"><span class="lineno"> 1144</span>    <a class="code hl_class" href="class_t_stage_object_tree.html">TStageObjectTree</a> *objTree = xsh-&gt;getStageObjectTree();</div>
<div class="line"><span class="lineno"> 1145</span>    <span class="keywordflow">if</span> (objTree-&gt;<a class="code hl_function" href="class_t_stage_object_tree.html#ad7fbf2fc5bdf3d4d009978775c90ec26">containsSpline</a>(</div>
<div class="line"><span class="lineno"> 1146</span>            spline))  <span class="comment">// No need to add it if it&#39;s already there</span></div>
<div class="line"><span class="lineno"> 1147</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1148</span> </div>
<div class="line"><span class="lineno"> 1149</span>    std::map&lt;TStageObjectSpline *, TStageObjectSpline *&gt;::iterator it =</div>
<div class="line"><span class="lineno"> 1150</span>        splines.find(spline);</div>
<div class="line"><span class="lineno"> 1151</span>    <span class="keywordflow">if</span> (it != splines.end()) {</div>
<div class="line"><span class="lineno"> 1152</span>      <span class="comment">// Seems that multiple objects can have the same spline...</span></div>
<div class="line"><span class="lineno"> 1153</span>      <span class="comment">// BTW, shouldn&#39;t this case stop at the continue before ?</span></div>
<div class="line"><span class="lineno"> 1154</span>      obj-&gt;<a class="code hl_function" href="class_t_stage_object.html#a43d90987cedca57a03e277d6140ada14">setSpline</a>(it-&gt;second);</div>
<div class="line"><span class="lineno"> 1155</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1156</span>    }</div>
<div class="line"><span class="lineno"> 1157</span> </div>
<div class="line"><span class="lineno"> 1158</span>    <span class="comment">// The spline was not found. Clone and add it to the xsheet</span></div>
<div class="line"><span class="lineno"> 1159</span>    <a class="code hl_class" href="class_t_stage_object_spline.html">TStageObjectSpline</a> *newSpline = spline-&gt;clone();  <span class="comment">// Not checking doClone ?</span></div>
<div class="line"><span class="lineno"> 1160</span>    objTree-&gt;<a class="code hl_function" href="class_t_stage_object_tree.html#a9aa6e0ceb11a90941b988223bf4a405b">assignUniqueSplineId</a>(newSpline);</div>
<div class="line"><span class="lineno"> 1161</span>    objTree-&gt;<a class="code hl_function" href="class_t_stage_object_tree.html#a5ccbb69161f93632ce7408dfb58bb8be">insertSpline</a>(newSpline);</div>
<div class="line"><span class="lineno"> 1162</span>    obj-&gt;<a class="code hl_function" href="class_t_stage_object.html#a43d90987cedca57a03e277d6140ada14">setSpline</a>(newSpline);</div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span>    splines[spline] = newSpline;</div>
<div class="line"><span class="lineno"> 1165</span>  }</div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span>  <span class="comment">// paste stored path</span></div>
<div class="line"><span class="lineno"> 1168</span>  QList&lt;TSplineDataElement *&gt;::const_iterator splinIt;</div>
<div class="line"><span class="lineno"> 1169</span>  <span class="keywordflow">for</span> (splinIt = m_splines.begin(); splinIt != m_splines.end(); ++splinIt) {</div>
<div class="line"><span class="lineno"> 1170</span>    <a class="code hl_class" href="class_t_stage_object_tree.html">TStageObjectTree</a> *objTree    = xsh-&gt;getStageObjectTree();</div>
<div class="line"><span class="lineno"> 1171</span>    <a class="code hl_class" href="class_t_spline_data_element.html">TSplineDataElement</a> *splineEl = *splinIt;</div>
<div class="line"><span class="lineno"> 1172</span>    <a class="code hl_class" href="class_t_stage_object_spline.html">TStageObjectSpline</a> *spline   = splineEl-&gt;restoreSpline(fxFlags);</div>
<div class="line"><span class="lineno"> 1173</span>    <span class="keywordflow">if</span> (doClone) objTree-&gt;<a class="code hl_function" href="class_t_stage_object_tree.html#a9aa6e0ceb11a90941b988223bf4a405b">assignUniqueSplineId</a>(spline);</div>
<div class="line"><span class="lineno"> 1174</span>    objTree-&gt;<a class="code hl_function" href="class_t_stage_object_tree.html#a5ccbb69161f93632ce7408dfb58bb8be">insertSpline</a>(spline);</div>
<div class="line"><span class="lineno"> 1175</span>    restoredSpline.push_back(spline-&gt;getId());</div>
<div class="line"><span class="lineno"> 1176</span>  }</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>  xsh-&gt;updateFrameCount();</div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span>  <span class="keywordflow">if</span> (pos != TConst::nowhere) {</div>
<div class="line"><span class="lineno"> 1181</span>    <span class="comment">// Update objects positions depending on the externally supplied pos</span></div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span>    <a class="code hl_class" href="class_t_point_t.html">TPointD</a> middlePos;</div>
<div class="line"><span class="lineno"> 1184</span>    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>    <span class="keywordflow">for</span> (i = 0; i &lt; (int)restoredIds.size(); ++i) {</div>
<div class="line"><span class="lineno"> 1187</span>      <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> <span class="keywordtype">id</span> = restoredIds[i];</div>
<div class="line"><span class="lineno"> 1188</span>      <a class="code hl_class" href="class_t_stage_object.html">TStageObject</a> *obj = xsh-&gt;getStageObject(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno"> 1189</span> </div>
<div class="line"><span class="lineno"> 1190</span>      <a class="code hl_class" href="class_t_point_t.html">TPointD</a> oldPos = obj-&gt;<a class="code hl_function" href="class_t_stage_object.html#a4d0ba923b8e950e754d1ca45af0819fc">getDagNodePos</a>();</div>
<div class="line"><span class="lineno"> 1191</span>      <span class="keywordflow">if</span> (oldPos == TConst::nowhere) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="line"><span class="lineno"> 1193</span>      middlePos += oldPos;</div>
<div class="line"><span class="lineno"> 1194</span>      ++count;</div>
<div class="line"><span class="lineno"> 1195</span>    }</div>
<div class="line"><span class="lineno"> 1196</span> </div>
<div class="line"><span class="lineno"> 1197</span>    middlePos      = <a class="code hl_class" href="class_t_point_t.html">TPointD</a>(middlePos.x / count, middlePos.y / count);</div>
<div class="line"><span class="lineno"> 1198</span>    <a class="code hl_class" href="class_t_point_t.html">TPointD</a> offset = pos - middlePos;</div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span>    <span class="keywordflow">for</span> (i = 0; i &lt; (int)restoredIds.size(); ++i) {</div>
<div class="line"><span class="lineno"> 1201</span>      <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> <span class="keywordtype">id</span> = restoredIds[i];</div>
<div class="line"><span class="lineno"> 1202</span>      <a class="code hl_class" href="class_t_stage_object.html">TStageObject</a> *obj = xsh-&gt;getStageObject(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span>      <a class="code hl_class" href="class_t_point_t.html">TPointD</a> oldPos = obj-&gt;<a class="code hl_function" href="class_t_stage_object.html#a4d0ba923b8e950e754d1ca45af0819fc">getDagNodePos</a>();</div>
<div class="line"><span class="lineno"> 1205</span>      <span class="keywordflow">if</span> (oldPos == TConst::nowhere) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1206</span> </div>
<div class="line"><span class="lineno"> 1207</span>      obj-&gt;<a class="code hl_function" href="class_t_stage_object.html#a64e318fa720c638b27abe8cd4f2c9494">setDagNodePos</a>(oldPos + offset);</div>
<div class="line"><span class="lineno"> 1208</span>    }</div>
<div class="line"><span class="lineno"> 1209</span>  }</div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span>  <span class="comment">// reset grammers for all parameters of pasted stage objects and fxs</span></div>
<div class="line"><span class="lineno"> 1212</span>  <span class="comment">// or they fails to refer to other parameters via expression</span></div>
<div class="line"><span class="lineno"> 1213</span>  <span class="comment">// if they are pasted in different xsheet</span></div>
<div class="line"><span class="lineno"> 1214</span>  <a class="code hl_class" href="class_t_syntax_1_1_grammar.html">TSyntax::Grammar</a> *grammer = xsh-&gt;getStageObjectTree()-&gt;getGrammar();</div>
<div class="line"><span class="lineno"> 1215</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keywordtype">id</span> : restoredIds) {</div>
<div class="line"><span class="lineno"> 1216</span>    <a class="code hl_class" href="class_t_stage_object.html">TStageObject</a> *obj = xsh-&gt;getStageObject(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno"> 1217</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c != TStageObject::T_ChannelCount; ++c)</div>
<div class="line"><span class="lineno"> 1218</span>      obj-&gt;<a class="code hl_function" href="class_t_stage_object.html#ae4cf64f5085310a14074ceb54d2b5177">getParam</a>((<a class="code hl_enumeration" href="class_t_stage_object.html#ac7a60ddc803173dc7591f784577cb439">TStageObject::Channel</a>)c)-&gt;setGrammar(grammer);</div>
<div class="line"><span class="lineno"> 1219</span>    <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code hl_class" href="class_t_smart_pointer_t.html">PlasticSkeletonDeformationP</a> &amp;sd =</div>
<div class="line"><span class="lineno"> 1220</span>            obj-&gt;<a class="code hl_function" href="class_t_stage_object.html#af2c5d9f172e73e4cb09b769700df3acb">getPlasticSkeletonDeformation</a>())</div>
<div class="line"><span class="lineno"> 1221</span>      sd-&gt;setGrammar(grammer);</div>
<div class="line"><span class="lineno"> 1222</span>  }</div>
<div class="line"><span class="lineno"> 1223</span>  QMap&lt;TFx *, TFx *&gt;::const_iterator it;</div>
<div class="line"><span class="lineno"> 1224</span>  <span class="keywordflow">for</span> (it = fxTable.constBegin(); it != fxTable.constEnd(); ++it) {</div>
<div class="line"><span class="lineno"> 1225</span>    setGrammerToParams(it.value()-&gt;getParams(), grammer);</div>
<div class="line"><span class="lineno"> 1226</span>  }</div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span>  <span class="keywordflow">return</span> restoredIds;</div>
<div class="line"><span class="lineno"> 1229</span>}</div>
<div class="ttc" id="aclass_fx_dag_html"><div class="ttname"><a href="class_fx_dag.html">FxDag</a></div><div class="ttdef"><b>Definition:</b> fxdag.h:25</div></div>
<div class="ttc" id="aclass_t_camera_data_element_html"><div class="ttname"><a href="class_t_camera_data_element.html">TCameraDataElement</a></div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:390</div></div>
<div class="ttc" id="aclass_t_camera_data_element_html_aa85bc2f75f09af52dd966d571e956d6a"><div class="ttname"><a href="class_t_camera_data_element.html#aa85bc2f75f09af52dd966d571e956d6a">TCameraDataElement::restoreCamera</a></div><div class="ttdeci">TStageObjectId restoreCamera(TXsheet *xsh, bool copyPosition) const</div><div class="ttdoc">Restores the stored camera object.</div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:441</div></div>
<div class="ttc" id="aclass_t_column_data_element_html_a22322066607671d817d6fd36c34e7d6c"><div class="ttname"><a href="class_t_column_data_element.html#a22322066607671d817d6fd36c34e7d6c">TColumnDataElement::restoreColumn</a></div><div class="ttdeci">TStageObjectId restoreColumn(TXsheet *xsh, int index, int fxFlags, bool copyPosition) const</div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:327</div></div>
<div class="ttc" id="aclass_t_output_fx_html"><div class="ttname"><a href="class_t_output_fx.html">TOutputFx</a></div><div class="ttdef"><b>Definition:</b> tcolumnfx.h:258</div></div>
<div class="ttc" id="aclass_t_point_t_html"><div class="ttname"><a href="class_t_point_t.html">TPointT&lt; double &gt;</a></div></div>
<div class="ttc" id="aclass_t_smart_pointer_t_html"><div class="ttname"><a href="class_t_smart_pointer_t.html">TSmartPointerT&lt; PlasticSkeletonDeformation &gt;</a></div></div>
<div class="ttc" id="aclass_t_spline_data_element_html"><div class="ttname"><a href="class_t_spline_data_element.html">TSplineDataElement</a></div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:473</div></div>
<div class="ttc" id="aclass_t_stage_object_data_element_html"><div class="ttname"><a href="class_t_stage_object_data_element.html">TStageObjectDataElement</a></div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:144</div></div>
<div class="ttc" id="aclass_t_stage_object_data_element_html_a9f717b885c1f0debcfe2930268a06361"><div class="ttname"><a href="class_t_stage_object_data_element.html#a9f717b885c1f0debcfe2930268a06361">TStageObjectDataElement::m_params</a></div><div class="ttdeci">TStageObjectParams * m_params</div><div class="ttdoc">Stage object parameters (owned)</div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:148</div></div>
<div class="ttc" id="aclass_t_stage_object_data_element_html_abbd9e7886bc0abfb3334cde40434d08b"><div class="ttname"><a href="class_t_stage_object_data_element.html#abbd9e7886bc0abfb3334cde40434d08b">TStageObjectDataElement::restoreObject</a></div><div class="ttdeci">TStageObjectId restoreObject(TXsheet *xsh, bool copyPosition) const</div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:201</div></div>
<div class="ttc" id="aclass_t_stage_object_html"><div class="ttname"><a href="class_t_stage_object.html">TStageObject</a></div><div class="ttdef"><b>Definition:</b> tstageobject.h:95</div></div>
<div class="ttc" id="aclass_t_stage_object_html_a425cb2dbcefe6ba4e288e1e8bdd16f72"><div class="ttname"><a href="class_t_stage_object.html#a425cb2dbcefe6ba4e288e1e8bdd16f72">TStageObject::getSpline</a></div><div class="ttdeci">TStageObjectSpline * getSpline() const</div><div class="ttdoc">Returns the motion path associated to the object.</div><div class="ttdef"><b>Definition:</b> tstageobject.cpp:650</div></div>
<div class="ttc" id="aclass_t_stage_object_html_a43d90987cedca57a03e277d6140ada14"><div class="ttname"><a href="class_t_stage_object.html#a43d90987cedca57a03e277d6140ada14">TStageObject::setSpline</a></div><div class="ttdeci">void setSpline(TStageObjectSpline *spline)</div><div class="ttdef"><b>Definition:</b> tstageobject.cpp:676</div></div>
<div class="ttc" id="aclass_t_stage_object_html_a4d0ba923b8e950e754d1ca45af0819fc"><div class="ttname"><a href="class_t_stage_object.html#a4d0ba923b8e950e754d1ca45af0819fc">TStageObject::getDagNodePos</a></div><div class="ttdeci">TPointD getDagNodePos() const</div><div class="ttdoc">Returns object's position in the schematic view.</div><div class="ttdef"><b>Definition:</b> tstageobject.h:251</div></div>
<div class="ttc" id="aclass_t_stage_object_html_a64e318fa720c638b27abe8cd4f2c9494"><div class="ttname"><a href="class_t_stage_object.html#a64e318fa720c638b27abe8cd4f2c9494">TStageObject::setDagNodePos</a></div><div class="ttdeci">void setDagNodePos(const TPointD &amp;p)</div><div class="ttdef"><b>Definition:</b> tstageobject.h:258</div></div>
<div class="ttc" id="aclass_t_stage_object_html_a8478e56c447b15faeda7365de0fd15ea"><div class="ttname"><a href="class_t_stage_object.html#a8478e56c447b15faeda7365de0fd15ea">TStageObject::setHandle</a></div><div class="ttdeci">void setHandle(const std::string &amp;s)</div><div class="ttdef"><b>Definition:</b> tstageobject.cpp:775</div></div>
<div class="ttc" id="aclass_t_stage_object_html_a8c8e56d26f94b5b655e2e3246ff66ec5"><div class="ttname"><a href="class_t_stage_object.html#a8c8e56d26f94b5b655e2e3246ff66ec5">TStageObject::setParentHandle</a></div><div class="ttdeci">void setParentHandle(const std::string &amp;s)</div><div class="ttdoc">Sets the name of the pegbar parent handle name.</div><div class="ttdef"><b>Definition:</b> tstageobject.cpp:784</div></div>
<div class="ttc" id="aclass_t_stage_object_html_ac7a60ddc803173dc7591f784577cb439"><div class="ttname"><a href="class_t_stage_object.html#ac7a60ddc803173dc7591f784577cb439">TStageObject::Channel</a></div><div class="ttdeci">Channel</div><div class="ttdoc">Used to describe object parameters.</div><div class="ttdef"><b>Definition:</b> tstageobject.h:121</div></div>
<div class="ttc" id="aclass_t_stage_object_html_ae4cf64f5085310a14074ceb54d2b5177"><div class="ttname"><a href="class_t_stage_object.html#ae4cf64f5085310a14074ceb54d2b5177">TStageObject::getParam</a></div><div class="ttdeci">double getParam(Channel type, double frame) const</div><div class="ttdoc">Returns the TStageObject::Channel value associated with the frame.</div><div class="ttdef"><b>Definition:</b> tstageobject.cpp:1080</div></div>
<div class="ttc" id="aclass_t_stage_object_html_af2c5d9f172e73e4cb09b769700df3acb"><div class="ttname"><a href="class_t_stage_object.html#af2c5d9f172e73e4cb09b769700df3acb">TStageObject::getPlasticSkeletonDeformation</a></div><div class="ttdeci">PlasticSkeletonDeformationP getPlasticSkeletonDeformation() const</div><div class="ttdoc">Returns the stored skeleton deformation, if any.</div><div class="ttdef"><b>Definition:</b> tstageobject.cpp:1144</div></div>
<div class="ttc" id="aclass_t_stage_object_id_html"><div class="ttname"><a href="class_t_stage_object_id.html">TStageObjectId</a></div><div class="ttdef"><b>Definition:</b> tstageobjectid.h:36</div></div>
<div class="ttc" id="aclass_t_stage_object_spline_html"><div class="ttname"><a href="class_t_stage_object_spline.html">TStageObjectSpline</a></div><div class="ttdoc">The TStageObjectSpline class define stage object motion path.</div><div class="ttdef"><b>Definition:</b> tstageobjectspline.h:36</div></div>
<div class="ttc" id="aclass_t_stage_object_tree_html"><div class="ttname"><a href="class_t_stage_object_tree.html">TStageObjectTree</a></div><div class="ttdef"><b>Definition:</b> tstageobjecttree.h:86</div></div>
<div class="ttc" id="aclass_t_stage_object_tree_html_a5ccbb69161f93632ce7408dfb58bb8be"><div class="ttname"><a href="class_t_stage_object_tree.html#a5ccbb69161f93632ce7408dfb58bb8be">TStageObjectTree::insertSpline</a></div><div class="ttdeci">void insertSpline(TStageObjectSpline *)</div><div class="ttdef"><b>Definition:</b> tstageobjecttree.cpp:621</div></div>
<div class="ttc" id="aclass_t_stage_object_tree_html_a9aa6e0ceb11a90941b988223bf4a405b"><div class="ttname"><a href="class_t_stage_object_tree.html#a9aa6e0ceb11a90941b988223bf4a405b">TStageObjectTree::assignUniqueSplineId</a></div><div class="ttdeci">void assignUniqueSplineId(TStageObjectSpline *spline)</div><div class="ttdef"><b>Definition:</b> tstageobjecttree.cpp:592</div></div>
<div class="ttc" id="aclass_t_stage_object_tree_html_ad7fbf2fc5bdf3d4d009978775c90ec26"><div class="ttname"><a href="class_t_stage_object_tree.html#ad7fbf2fc5bdf3d4d009978775c90ec26">TStageObjectTree::containsSpline</a></div><div class="ttdeci">bool containsSpline(TStageObjectSpline *) const</div><div class="ttdef"><b>Definition:</b> tstageobjecttree.cpp:612</div></div>
<div class="ttc" id="aclass_t_syntax_1_1_grammar_html"><div class="ttname"><a href="class_t_syntax_1_1_grammar.html">TSyntax::Grammar</a></div><div class="ttdef"><b>Definition:</b> tgrammar.h:202</div></div>
<div class="ttc" id="aclass_t_xsh_column_html"><div class="ttname"><a href="class_t_xsh_column.html">TXshColumn</a></div><div class="ttdoc">The TXshColumn class is the base class of column managers in xsheet.</div><div class="ttdef"><b>Definition:</b> txshcolumn.h:65</div></div>
<div class="ttc" id="aclass_t_xsh_zerary_fx_column_html"><div class="ttname"><a href="class_t_xsh_zerary_fx_column.html">TXshZeraryFxColumn</a></div><div class="ttdef"><b>Definition:</b> txshzeraryfxcolumn.h:35</div></div>
<div class="ttc" id="aclass_t_zerary_column_fx_html"><div class="ttname"><a href="class_t_zerary_column_fx.html">TZeraryColumnFx</a></div><div class="ttdef"><b>Definition:</b> tcolumnfx.h:176</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbffc8f0eafc04b34b5247bf1e21fdcf" name="acbffc8f0eafc04b34b5247bf1e21fdcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbffc8f0eafc04b34b5247bf1e21fdcf">&#9670;&nbsp;</a></span>storeColumnFxs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StageObjectsData::storeColumnFxs </td>
          <td>(</td>
          <td class="paramtype">const std::set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>columnIndexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsheet.html">TXsheet</a> *&#160;</td>
          <td class="paramname"><em>xsh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fxFlags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Stores the column fxs \it{and their upstream fxs} associated to the specified column indices, <b>without</b> storing the columns stage objects. </p>
<div class="fragment"><div class="line"><span class="lineno">  808</span>                                                                 {</div>
<div class="line"><span class="lineno">  809</span>  <span class="keywordtype">bool</span> doClone             = (fxFlags &amp; eDoClone);</div>
<div class="line"><span class="lineno">  810</span>  <span class="keywordtype">bool</span> resetFxDagPositions = (fxFlags &amp; eResetFxDagPositions);</div>
<div class="line"><span class="lineno">  811</span> </div>
<div class="line"><span class="lineno">  812</span>  std::set&lt;TFx *&gt; internalFxs;</div>
<div class="line"><span class="lineno">  813</span>  xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#adc7c74cce346abf3699bb250eb17a9c2">getFxDag</a>()-&gt;getInternalFxs()-&gt;getFxs(internalFxs);</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>  <span class="comment">// Iterate internal fxs (note: columns NOT included)</span></div>
<div class="line"><span class="lineno">  816</span>  <span class="comment">// NOTE: Could this be too heavy ? Shouldn&#39;t we travel upstream from given</span></div>
<div class="line"><span class="lineno">  817</span>  <span class="comment">// column fxs?</span></div>
<div class="line"><span class="lineno">  818</span>  std::set&lt;TFx *&gt;::iterator it;</div>
<div class="line"><span class="lineno">  819</span>  <span class="keywordflow">for</span> (it = internalFxs.begin(); it != internalFxs.end(); ++it) {</div>
<div class="line"><span class="lineno">  820</span>    <a class="code hl_class" href="class_t_fx.html">TFx</a> *fxOrig = *it, *fx = fxOrig;</div>
<div class="line"><span class="lineno">  821</span> </div>
<div class="line"><span class="lineno">  822</span>    <span class="keywordflow">if</span> (m_fxTable.find(fx) != m_fxTable.end())  <span class="comment">// If already treated</span></div>
<div class="line"><span class="lineno">  823</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>    <span class="keywordflow">if</span> (canGenerate(m_originalColumnFxs,</div>
<div class="line"><span class="lineno">  826</span>                    fx) != CanGenerate)  <span class="comment">// If not completely in the upstream</span></div>
<div class="line"><span class="lineno">  827</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  828</span> </div>
<div class="line"><span class="lineno">  829</span>    <span class="keywordflow">if</span> (doClone) {</div>
<div class="line"><span class="lineno">  830</span>      <span class="comment">// Clone the fx if required</span></div>
<div class="line"><span class="lineno">  831</span>      fx = fxOrig-&gt;clone(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>      fx-&gt;setName(fxOrig-&gt;getName());</div>
<div class="line"><span class="lineno">  834</span>      fx-&gt;getAttributes()-&gt;setId(fxOrig-&gt;getAttributes()-&gt;getId());</div>
<div class="line"><span class="lineno">  835</span>      fx-&gt;getAttributes()-&gt;passiveCacheDataIdx() = -1;</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>      <span class="keywordflow">if</span> (resetFxDagPositions)</div>
<div class="line"><span class="lineno">  838</span>        fx-&gt;getAttributes()-&gt;setDagNodePos(TConst::nowhere);</div>
<div class="line"><span class="lineno">  839</span>    }</div>
<div class="line"><span class="lineno">  840</span> </div>
<div class="line"><span class="lineno">  841</span>    m_fxTable[fxOrig] = fx;</div>
<div class="line"><span class="lineno">  842</span>    fx-&gt;addRef();</div>
<div class="line"><span class="lineno">  843</span>    m_fxs.insert(fx);</div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span>    <span class="keywordflow">if</span> (isColumnSelectionTerminalFx(fxOrig, xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#adc7c74cce346abf3699bb250eb17a9c2">getFxDag</a>()-&gt;getTerminalFxs(),</div>
<div class="line"><span class="lineno">  846</span>                                    m_originalColumnFxs)) {</div>
<div class="line"><span class="lineno">  847</span>      fx-&gt;addRef();</div>
<div class="line"><span class="lineno">  848</span>      m_terminalFxs.insert(fx);</div>
<div class="line"><span class="lineno">  849</span>    }</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordflow">if</span> (fxOrig-&gt;getLinkedFx() != fxOrig)  <span class="comment">// Linked fx</span></div>
<div class="line"><span class="lineno">  852</span>    {</div>
<div class="line"><span class="lineno">  853</span>      <span class="keywordflow">if</span> (canGenerate(m_originalColumnFxs, fxOrig-&gt;getLinkedFx()) !=</div>
<div class="line"><span class="lineno">  854</span>          CanGenerate)</div>
<div class="line"><span class="lineno">  855</span>        fx-&gt;linkParams(fxOrig-&gt;getLinkedFx());</div>
<div class="line"><span class="lineno">  856</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  857</span>        <span class="comment">// Insert the linked fx directly here</span></div>
<div class="line"><span class="lineno">  858</span>        <a class="code hl_class" href="class_t_fx.html">TFx</a> *linkedFx, *oldLinkedFx = fxOrig-&gt;getLinkedFx();</div>
<div class="line"><span class="lineno">  859</span>        <span class="keywordflow">if</span> (doClone) {</div>
<div class="line"><span class="lineno">  860</span>          linkedFx = fx-&gt;clone(<span class="keyword">false</span>);  <span class="comment">// Not oldLinkedFx-&gt;clone() ?</span></div>
<div class="line"><span class="lineno">  861</span>          linkedFx-&gt;linkParams(fx);</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>          linkedFx-&gt;setName(oldLinkedFx-&gt;getName());</div>
<div class="line"><span class="lineno">  864</span>          linkedFx-&gt;getAttributes()-&gt;setId(</div>
<div class="line"><span class="lineno">  865</span>              oldLinkedFx-&gt;getAttributes()-&gt;getId());</div>
<div class="line"><span class="lineno">  866</span>          linkedFx-&gt;getAttributes()-&gt;passiveCacheDataIdx() = -1;</div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span>          <span class="keywordflow">if</span> (resetFxDagPositions)</div>
<div class="line"><span class="lineno">  869</span>            fx-&gt;getAttributes()-&gt;setDagNodePos(TConst::nowhere);  <span class="comment">// Here too ?</span></div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>          xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#adc7c74cce346abf3699bb250eb17a9c2">getFxDag</a>()-&gt;assignUniqueId(linkedFx);</div>
<div class="line"><span class="lineno">  872</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  873</span>          linkedFx = oldLinkedFx;</div>
<div class="line"><span class="lineno">  874</span> </div>
<div class="line"><span class="lineno">  875</span>        m_fxTable[oldLinkedFx] = linkedFx;</div>
<div class="line"><span class="lineno">  876</span>        linkedFx-&gt;addRef();</div>
<div class="line"><span class="lineno">  877</span>        m_fxs.insert(linkedFx);</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>        <span class="keywordflow">if</span> (xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#adc7c74cce346abf3699bb250eb17a9c2">getFxDag</a>()-&gt;getTerminalFxs()-&gt;containsFx(</div>
<div class="line"><span class="lineno">  880</span>                fx-&gt;getLinkedFx()))  <span class="comment">// Here too - isATerminal ?</span></div>
<div class="line"><span class="lineno">  881</span>        {</div>
<div class="line"><span class="lineno">  882</span>          linkedFx-&gt;addRef();</div>
<div class="line"><span class="lineno">  883</span>          m_terminalFxs.insert(linkedFx);</div>
<div class="line"><span class="lineno">  884</span>        }</div>
<div class="line"><span class="lineno">  885</span>      }</div>
<div class="line"><span class="lineno">  886</span>    }</div>
<div class="line"><span class="lineno">  887</span>  }</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>  <span class="comment">// Like in the functions above, update links</span></div>
<div class="line"><span class="lineno">  890</span>  <span class="keywordflow">if</span> (!m_fxTable.empty() &amp;&amp; doClone) updateFxLinks(m_fxTable);</div>
<div class="line"><span class="lineno">  891</span>}</div>
<div class="ttc" id="aclass_t_xsheet_html_adc7c74cce346abf3699bb250eb17a9c2"><div class="ttname"><a href="class_t_xsheet.html#adc7c74cce346abf3699bb250eb17a9c2">TXsheet::getFxDag</a></div><div class="ttdeci">FxDag * getFxDag() const</div><div class="ttdef"><b>Definition:</b> txsheet.cpp:1564</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l01564">TXsheet::getFxDag()</a>.</p>

</div>
</div>
<a id="a64d285aa4bb0f00d17e0f659e1d28ae3" name="a64d285aa4bb0f00d17e0f659e1d28ae3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64d285aa4bb0f00d17e0f659e1d28ae3">&#9670;&nbsp;</a></span>storeColumns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StageObjectsData::storeColumns </td>
          <td>(</td>
          <td class="paramtype">const std::set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>columnIndexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsheet.html">TXsheet</a> *&#160;</td>
          <td class="paramname"><em>xsheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fxFlags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Overloaded function, stores the specified columns in the supplied xsheet. </p>
<div class="fragment"><div class="line"><span class="lineno">  708</span>                                                               {</div>
<div class="line"><span class="lineno">  709</span>  std::vector&lt;TStageObjectId&gt; ids;</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>  std::set&lt;int&gt;::const_iterator it;</div>
<div class="line"><span class="lineno">  712</span>  <span class="keywordflow">for</span> (it = columnIndexes.begin(); it != columnIndexes.end(); ++it)</div>
<div class="line"><span class="lineno">  713</span>    ids.push_back(TStageObjectId::ColumnId(*it));</div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span>  <a class="code hl_function" href="class_stage_objects_data.html#ab1bf651aeb67ce71d2deb874e3d37e26">storeObjects</a>(ids, xsh, fxFlags);</div>
<div class="line"><span class="lineno">  716</span>}</div>
<div class="ttc" id="aclass_stage_objects_data_html_ab1bf651aeb67ce71d2deb874e3d37e26"><div class="ttname"><a href="class_stage_objects_data.html#ab1bf651aeb67ce71d2deb874e3d37e26">StageObjectsData::storeObjects</a></div><div class="ttdeci">void storeObjects(const std::vector&lt; TStageObjectId &gt; &amp;ids, TXsheet *xsheet, int fxFlags)</div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:635</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00635">storeObjects()</a>.</p>

</div>
</div>
<a id="ab4716c1e39e02f7ae4ef25a4f670b6b6" name="ab4716c1e39e02f7ae4ef25a4f670b6b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4716c1e39e02f7ae4ef25a4f670b6b6">&#9670;&nbsp;</a></span>storeFxs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StageObjectsData::storeFxs </td>
          <td>(</td>
          <td class="paramtype">const std::set&lt; <a class="el" href="class_t_fx.html">TFx</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>fxs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsheet.html">TXsheet</a> *&#160;</td>
          <td class="paramname"><em>xsheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fxFlags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores the specified fxs from the xsheet. </p>
<div class="fragment"><div class="line"><span class="lineno">  721</span>                                             {</div>
<div class="line"><span class="lineno">  722</span>  <span class="keywordtype">bool</span> doClone             = (fxFlags &amp; eDoClone);</div>
<div class="line"><span class="lineno">  723</span>  <span class="keywordtype">bool</span> resetFxDagPositions = (fxFlags &amp; eResetFxDagPositions);</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>  <a class="code hl_class" href="class_t_fx_set.html">TFxSet</a> *terminalFxs = xsh-&gt;getFxDag()-&gt;getTerminalFxs();</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>  <span class="comment">// Traverse specified fxs</span></div>
<div class="line"><span class="lineno">  728</span>  std::set&lt;TFx *&gt;::const_iterator it;</div>
<div class="line"><span class="lineno">  729</span>  <span class="keywordflow">for</span> (it = fxs.begin(); it != fxs.end(); ++it) {</div>
<div class="line"><span class="lineno">  730</span>    <a class="code hl_class" href="class_t_fx.html">TFx</a> *fxOrig = *it, *fx = fxOrig;</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>    <span class="keywordflow">if</span> (doClone) {</div>
<div class="line"><span class="lineno">  733</span>      <span class="comment">// If required, clone them</span></div>
<div class="line"><span class="lineno">  734</span>      fx = fxOrig-&gt;clone(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span>      fx-&gt;setName(fxOrig-&gt;getName());</div>
<div class="line"><span class="lineno">  737</span>      fx-&gt;getAttributes()-&gt;setId(fxOrig-&gt;getAttributes()-&gt;getId());</div>
<div class="line"><span class="lineno">  738</span>      fx-&gt;getAttributes()-&gt;passiveCacheDataIdx() = -1;</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>      <span class="keywordflow">if</span> (resetFxDagPositions)</div>
<div class="line"><span class="lineno">  741</span>        fx-&gt;getAttributes()-&gt;setDagNodePos(TConst::nowhere);</div>
<div class="line"><span class="lineno">  742</span>    }</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span>    <span class="comment">// Store them (and the original/clone pairing even if not cloning)</span></div>
<div class="line"><span class="lineno">  745</span>    m_fxTable[fxOrig] = fx;</div>
<div class="line"><span class="lineno">  746</span>    fx-&gt;addRef();</div>
<div class="line"><span class="lineno">  747</span>    m_fxs.insert(fx);</div>
<div class="line"><span class="lineno">  748</span> </div>
<div class="line"><span class="lineno">  749</span>    <span class="comment">// Find out if the fx is a terminal one in the selection. If so, store it</span></div>
<div class="line"><span class="lineno">  750</span>    <span class="comment">// there too.</span></div>
<div class="line"><span class="lineno">  751</span>    <span class="keywordtype">bool</span> isTerminal = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  752</span>    <span class="keywordflow">if</span> (!terminalFxs-&gt;containsFx(</div>
<div class="line"><span class="lineno">  753</span>            fxOrig))  <span class="comment">// If it&#39;s terminal in the xsheet, no doubt</span></div>
<div class="line"><span class="lineno">  754</span>    {</div>
<div class="line"><span class="lineno">  755</span>      <span class="comment">// Otherwise, check terminality with respect to the selection</span></div>
<div class="line"><span class="lineno">  756</span>      <span class="keywordtype">int</span> i, outputConnectionsCount = fxOrig-&gt;getOutputConnectionCount();</div>
<div class="line"><span class="lineno">  757</span>      <span class="keywordflow">for</span> (i = 0; i &lt; outputConnectionsCount; ++i) {</div>
<div class="line"><span class="lineno">  758</span>        <a class="code hl_class" href="class_t_fx.html">TFx</a> *outputFx = fxOrig-&gt;getOutputConnection(i)-&gt;getOwnerFx();</div>
<div class="line"><span class="lineno">  759</span>        <span class="keywordflow">if</span> (outputFx &amp;&amp; fxs.count(outputFx) &gt; 0) {</div>
<div class="line"><span class="lineno">  760</span>          isTerminal = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  761</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  762</span>        }</div>
<div class="line"><span class="lineno">  763</span>      }</div>
<div class="line"><span class="lineno">  764</span>    }</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>    <span class="comment">// Well, excluding true TOutputFxs...</span></div>
<div class="line"><span class="lineno">  767</span>    <a class="code hl_class" href="class_t_output_fx.html">TOutputFx</a> *outFx = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_t_output_fx.html">TOutputFx</a> *<span class="keyword">&gt;</span>(fx);</div>
<div class="line"><span class="lineno">  768</span>    <span class="keywordflow">if</span> (isTerminal &amp;&amp; !outFx) {</div>
<div class="line"><span class="lineno">  769</span>      fx-&gt;addRef();</div>
<div class="line"><span class="lineno">  770</span>      m_terminalFxs.insert(fx);</div>
<div class="line"><span class="lineno">  771</span>    }</div>
<div class="line"><span class="lineno">  772</span>  }</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>  <span class="comment">// Updating terminality of the column fxs too!</span></div>
<div class="line"><span class="lineno">  775</span>  <span class="comment">// WARNING: This requires that storeObjects() is invoked BEFORE this !</span></div>
<div class="line"><span class="lineno">  776</span>  <span class="keywordflow">for</span> (it = m_originalColumnFxs.begin(); it != m_originalColumnFxs.end();</div>
<div class="line"><span class="lineno">  777</span>       ++it) {</div>
<div class="line"><span class="lineno">  778</span>    <a class="code hl_class" href="class_t_fx.html">TFx</a> *fxOrig = *it;</div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span>    <span class="keywordtype">bool</span> isTerminal = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  781</span>    <span class="keywordflow">if</span> (!terminalFxs-&gt;containsFx(fxOrig)) {</div>
<div class="line"><span class="lineno">  782</span>      <span class="keywordtype">int</span> i, outputConnectionsCount = fxOrig-&gt;getOutputConnectionCount();</div>
<div class="line"><span class="lineno">  783</span>      <span class="keywordflow">for</span> (i = 0; i &lt; outputConnectionsCount; ++i) {</div>
<div class="line"><span class="lineno">  784</span>        <a class="code hl_class" href="class_t_fx.html">TFx</a> *outputFx = fxOrig-&gt;getOutputConnection(i)-&gt;getOwnerFx();</div>
<div class="line"><span class="lineno">  785</span>        <span class="keywordflow">if</span> (outputFx &amp;&amp; fxs.count(outputFx) &gt; 0) {</div>
<div class="line"><span class="lineno">  786</span>          isTerminal = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  787</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  788</span>        }</div>
<div class="line"><span class="lineno">  789</span>      }</div>
<div class="line"><span class="lineno">  790</span>    }</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>    <span class="keywordflow">if</span> (isTerminal) {</div>
<div class="line"><span class="lineno">  793</span>      <a class="code hl_class" href="class_t_fx.html">TFx</a> *fx = m_fxTable[fxOrig];</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>      fx-&gt;addRef();</div>
<div class="line"><span class="lineno">  796</span>      m_terminalFxs.insert(fx);</div>
<div class="line"><span class="lineno">  797</span>    }</div>
<div class="line"><span class="lineno">  798</span>  }</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>  <span class="keywordflow">if</span> (!m_fxTable.empty() &amp;&amp; doClone)</div>
<div class="line"><span class="lineno">  801</span>    updateFxLinks(m_fxTable);  <span class="comment">// Apply original/clone pairings</span></div>
<div class="line"><span class="lineno">  802</span>                               <span class="comment">// to fx relatives</span></div>
<div class="line"><span class="lineno">  803</span>}</div>
<div class="ttc" id="aclass_t_fx_set_html"><div class="ttname"><a href="class_t_fx_set.html">TFxSet</a></div><div class="ttdef"><b>Definition:</b> tcolumnfxset.h:27</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l01564">TXsheet::getFxDag()</a>.</p>

</div>
</div>
<a id="ab1bf651aeb67ce71d2deb874e3d37e26" name="ab1bf651aeb67ce71d2deb874e3d37e26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1bf651aeb67ce71d2deb874e3d37e26">&#9670;&nbsp;</a></span>storeObjects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StageObjectsData::storeObjects </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="class_t_stage_object_id.html">TStageObjectId</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsheet.html">TXsheet</a> *&#160;</td>
          <td class="paramname"><em>xsheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fxFlags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Stores the xsheet's specified stage objects (be them cameras, columns, pegbars or else). Additional flags support <a class="el" href="class_t_xsh_column.html" title="The TXshColumn class is the base class of column managers in xsheet.">TXshColumn</a> cloning for columns. </p>
<div class="fragment"><div class="line"><span class="lineno">  636</span>                                                               {</div>
<div class="line"><span class="lineno">  637</span>  assert(</div>
<div class="line"><span class="lineno">  638</span>      m_fxTable.empty());  <span class="comment">// Should be enforced OUTSIDE. Track implicit uses.</span></div>
<div class="line"><span class="lineno">  639</span>  m_fxTable.clear();       <span class="comment">// TO BE REMOVED</span></div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span>  <span class="keywordtype">int</span> i, objCount = ids.size();</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>  <span class="comment">// Discriminate sensible stage object types (ie cameras and columns from the</span></div>
<div class="line"><span class="lineno">  644</span>  <span class="comment">// rest).</span></div>
<div class="line"><span class="lineno">  645</span>  <span class="comment">// Store them in a map, ordered by object index.</span></div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>  std::map&lt;int, TStageObjectId&gt; cameraIds, columnIds, pegbarIds;</div>
<div class="line"><span class="lineno">  648</span>  <span class="keywordflow">for</span> (i = 0; i &lt; objCount; ++i) {</div>
<div class="line"><span class="lineno">  649</span>    <a class="code hl_class" href="class_t_stage_object_id.html">TStageObjectId</a> <span class="keywordtype">id</span> = ids[i];</div>
<div class="line"><span class="lineno">  650</span>    <span class="keywordflow">if</span> (<span class="keywordtype">id</span>.isColumn())</div>
<div class="line"><span class="lineno">  651</span>      columnIds[<span class="keywordtype">id</span>.getIndex()] = id;</div>
<div class="line"><span class="lineno">  652</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">id</span>.isPegbar())</div>
<div class="line"><span class="lineno">  653</span>      pegbarIds[<span class="keywordtype">id</span>.getIndex()] = id;</div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">id</span>.isCamera())</div>
<div class="line"><span class="lineno">  655</span>      cameraIds[<span class="keywordtype">id</span>.getIndex()] = id;</div>
<div class="line"><span class="lineno">  656</span>  }</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>  <span class="comment">// Store a suitable object for each</span></div>
<div class="line"><span class="lineno">  659</span>  std::map&lt;int, TStageObjectId&gt;::iterator it;</div>
<div class="line"><span class="lineno">  660</span>  <span class="keywordflow">for</span> (it = cameraIds.begin(); it != cameraIds.end(); ++it) {</div>
<div class="line"><span class="lineno">  661</span>    <span class="comment">// Cameras</span></div>
<div class="line"><span class="lineno">  662</span>    <a class="code hl_class" href="class_t_camera_data_element.html">TCameraDataElement</a> *cameraElement = <span class="keyword">new</span> <a class="code hl_class" href="class_t_camera_data_element.html">TCameraDataElement</a>();</div>
<div class="line"><span class="lineno">  663</span>    cameraElement-&gt;<a class="code hl_function" href="class_t_camera_data_element.html#ae13b97f7ae052f164de7b710ad3bcd25">storeCamera</a>(it-&gt;second, xsh);</div>
<div class="line"><span class="lineno">  664</span>    m_elements.append(cameraElement);</div>
<div class="line"><span class="lineno">  665</span>  }</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>  <span class="keywordflow">for</span> (it = pegbarIds.begin(); it != pegbarIds.end(); ++it) {</div>
<div class="line"><span class="lineno">  668</span>    <span class="comment">// Pegbars (includes curves)</span></div>
<div class="line"><span class="lineno">  669</span>    <a class="code hl_class" href="class_t_stage_object_data_element.html">TStageObjectDataElement</a> *objElement = <span class="keyword">new</span> <a class="code hl_class" href="class_t_stage_object_data_element.html">TStageObjectDataElement</a>();</div>
<div class="line"><span class="lineno">  670</span>    objElement-&gt;<a class="code hl_function" href="class_t_stage_object_data_element.html#a7e8d6e78c296ce85d47c99a2a65ae4ff">storeObject</a>(it-&gt;second, xsh);</div>
<div class="line"><span class="lineno">  671</span>    m_elements.append(objElement);</div>
<div class="line"><span class="lineno">  672</span>  }</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>  <span class="keywordflow">for</span> (it = columnIds.begin(); it != columnIds.end(); ++it) {</div>
<div class="line"><span class="lineno">  675</span>    <span class="comment">// Columns</span></div>
<div class="line"><span class="lineno">  676</span>    <span class="keywordtype">int</span> colIndex = it-&gt;second.getIndex();</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>    <a class="code hl_class" href="class_t_xsh_column.html">TXshColumn</a> *column = xsh-&gt;getColumn(colIndex);</div>
<div class="line"><span class="lineno">  679</span>    <span class="keywordflow">if</span> (!column) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>    <a class="code hl_class" href="class_t_column_data_element.html">TColumnDataElement</a> *columnElement = <span class="keyword">new</span> <a class="code hl_class" href="class_t_column_data_element.html">TColumnDataElement</a>();</div>
<div class="line"><span class="lineno">  682</span>    columnElement-&gt;<a class="code hl_function" href="class_t_column_data_element.html#afbaf55c99399765b5d42b257cb9802c1">storeColumn</a>(xsh, colIndex, fxFlags);</div>
<div class="line"><span class="lineno">  683</span>    m_elements.append(columnElement);</div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span>    <a class="code hl_class" href="class_t_xsh_column.html">TXshColumn</a> *copiedColumn = columnElement-&gt;m_column.getPointer();</div>
<div class="line"><span class="lineno">  686</span>    <span class="keywordflow">if</span> (column-&gt;getFx() &amp;&amp; copiedColumn-&gt;getFx()) {</div>
<div class="line"><span class="lineno">  687</span>      <span class="comment">// Store column fx pairings (even if the originals are not cloned)</span></div>
<div class="line"><span class="lineno">  688</span>      m_fxTable[column-&gt;getFx()] = copiedColumn-&gt;getFx();</div>
<div class="line"><span class="lineno">  689</span>      m_originalColumnFxs.insert(column-&gt;getFx());</div>
<div class="line"><span class="lineno">  690</span>    }</div>
<div class="line"><span class="lineno">  691</span>  }</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>  <span class="comment">// Insert terminal fxs</span></div>
<div class="line"><span class="lineno">  694</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;e : m_originalColumnFxs) {</div>
<div class="line"><span class="lineno">  695</span>    <span class="keywordflow">if</span> (isColumnSelectionTerminalFx(e, xsh-&gt;getFxDag()-&gt;getTerminalFxs(),</div>
<div class="line"><span class="lineno">  696</span>                                    m_originalColumnFxs)) {</div>
<div class="line"><span class="lineno">  697</span>      <a class="code hl_class" href="class_t_fx.html">TFx</a> *fx = m_fxTable[e];</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>      fx-&gt;addRef();</div>
<div class="line"><span class="lineno">  700</span>      m_terminalFxs.insert(fx);</div>
<div class="line"><span class="lineno">  701</span>    }</div>
<div class="line"><span class="lineno">  702</span>  }</div>
<div class="line"><span class="lineno">  703</span>}</div>
<div class="ttc" id="aclass_t_camera_data_element_html_ae13b97f7ae052f164de7b710ad3bcd25"><div class="ttname"><a href="class_t_camera_data_element.html#ae13b97f7ae052f164de7b710ad3bcd25">TCameraDataElement::storeCamera</a></div><div class="ttdeci">void storeCamera(const TStageObjectId &amp;selectedObj, TXsheet *xsh)</div><div class="ttdoc">Stores the specified camera object.</div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:428</div></div>
<div class="ttc" id="aclass_t_column_data_element_html_afbaf55c99399765b5d42b257cb9802c1"><div class="ttname"><a href="class_t_column_data_element.html#afbaf55c99399765b5d42b257cb9802c1">TColumnDataElement::storeColumn</a></div><div class="ttdeci">void storeColumn(TXsheet *xsheet, int index, int fxFlags)</div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:298</div></div>
<div class="ttc" id="aclass_t_stage_object_data_element_html_a7e8d6e78c296ce85d47c99a2a65ae4ff"><div class="ttname"><a href="class_t_stage_object_data_element.html#a7e8d6e78c296ce85d47c99a2a65ae4ff">TStageObjectDataElement::storeObject</a></div><div class="ttdeci">void storeObject(const TStageObjectId &amp;objectId, TXsheet *xsh)</div><div class="ttdef"><b>Definition:</b> stageobjectsdata.cpp:189</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l01418">TXsheet::getColumn()</a>, <a class="el" href="#l01564">TXsheet::getFxDag()</a>, <a class="el" href="#l00428">TCameraDataElement::storeCamera()</a>, <a class="el" href="#l00298">TColumnDataElement::storeColumn()</a>, and <a class="el" href="#l00189">TStageObjectDataElement::storeObject()</a>.</p>

<p class="reference">Referenced by <a class="el" href="#l00707">storeColumns()</a>.</p>

</div>
</div>
<a id="a8273a597f1714f536f9170af58a0e4d7" name="a8273a597f1714f536f9170af58a0e4d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8273a597f1714f536f9170af58a0e4d7">&#9670;&nbsp;</a></span>storeSplines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StageObjectsData::storeSplines </td>
          <td>(</td>
          <td class="paramtype">const std::list&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>splineIds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_xsheet.html">TXsheet</a> *&#160;</td>
          <td class="paramname"><em>xsh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fxFlags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Stores the splines identified by the <b>splineIds</b> NOTE: a spline will be stored only if no <a class="el" href="class_t_stage_object.html">TStageObject</a> is connected to it, or if no <a class="el" href="class_t_stage_object.html">TStageObject</a> connected is stored by this <a class="el" href="class_stage_objects_data.html">StageObjectsData</a>. </p>
<div class="fragment"><div class="line"><span class="lineno">  896</span>                                                               {</div>
<div class="line"><span class="lineno">  897</span>  std::list&lt;int&gt;::const_iterator it;</div>
<div class="line"><span class="lineno">  898</span>  <span class="keywordflow">for</span> (it = splineIds.begin(); it != splineIds.end(); ++it) {</div>
<div class="line"><span class="lineno">  899</span>    <a class="code hl_class" href="class_t_stage_object_spline.html">TStageObjectSpline</a> *spline = xsh-&gt;<a class="code hl_function" href="class_t_xsheet.html#a5dc925584e35e1678f5678b79c470959">getStageObjectTree</a>()-&gt;<a class="code hl_function" href="class_t_stage_object_tree.html#a13bf3fb9c8a1d9d7579c0c9358aaa2c9">getSplineById</a>(*it);</div>
<div class="line"><span class="lineno">  900</span>    <span class="keywordtype">int</span> j;</div>
<div class="line"><span class="lineno">  901</span>    <span class="keywordtype">bool</span> skipSpline = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  902</span>    <span class="keywordflow">for</span> (j = 0; j &lt; m_elements.size(); j++) {</div>
<div class="line"><span class="lineno">  903</span>      <a class="code hl_class" href="class_t_stage_object_data_element.html">TStageObjectDataElement</a> *element = m_elements[j];</div>
<div class="line"><span class="lineno">  904</span>      <span class="keywordflow">if</span> (spline == element-&gt;<a class="code hl_variable" href="class_t_stage_object_data_element.html#a9f717b885c1f0debcfe2930268a06361">m_params</a>-&gt;m_spline) {</div>
<div class="line"><span class="lineno">  905</span>        skipSpline = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  906</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  907</span>      }</div>
<div class="line"><span class="lineno">  908</span>    }</div>
<div class="line"><span class="lineno">  909</span>    <span class="keywordflow">if</span> (skipSpline) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  910</span>    <a class="code hl_class" href="class_t_spline_data_element.html">TSplineDataElement</a> *splineElement = <span class="keyword">new</span> <a class="code hl_class" href="class_t_spline_data_element.html">TSplineDataElement</a>();</div>
<div class="line"><span class="lineno">  911</span>    splineElement-&gt;storeSpline(spline, fxFlags);</div>
<div class="line"><span class="lineno">  912</span>    m_splines.append(splineElement);</div>
<div class="line"><span class="lineno">  913</span>  }</div>
<div class="line"><span class="lineno">  914</span>}</div>
<div class="ttc" id="aclass_t_stage_object_tree_html_a13bf3fb9c8a1d9d7579c0c9358aaa2c9"><div class="ttname"><a href="class_t_stage_object_tree.html#a13bf3fb9c8a1d9d7579c0c9358aaa2c9">TStageObjectTree::getSplineById</a></div><div class="ttdeci">TStageObjectSpline * getSplineById(int splineId) const</div><div class="ttdef"><b>Definition:</b> tstageobjecttree.cpp:573</div></div>
<div class="ttc" id="aclass_t_xsheet_html_a5dc925584e35e1678f5678b79c470959"><div class="ttname"><a href="class_t_xsheet.html#a5dc925584e35e1678f5678b79c470959">TXsheet::getStageObjectTree</a></div><div class="ttdeci">TStageObjectTree * getStageObjectTree() const</div><div class="ttdef"><b>Definition:</b> txsheet.cpp:549</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00573">TStageObjectTree::getSplineById()</a>, <a class="el" href="#l00549">TXsheet::getStageObjectTree()</a>, and <a class="el" href="#l00148">TStageObjectDataElement::m_params</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>E:/opentoonz/toonz/sources/include/toonzqt/<a class="el" href="">stageobjectsdata.h</a></li>
<li>E:/opentoonz/toonz/sources/toonzqt/<a class="el" href="">stageobjectsdata.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
