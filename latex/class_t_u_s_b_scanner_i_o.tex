\hypertarget{class_t_u_s_b_scanner_i_o}{}\doxysection{TUSBScanner\+IO Class Reference}
\label{class_t_u_s_b_scanner_i_o}\index{TUSBScannerIO@{TUSBScannerIO}}
Inheritance diagram for TUSBScanner\+IO\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_t_u_s_b_scanner_i_o}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{class_t_u_s_b_scanner_i_o_a3dfd9284a49749f602d30befa64a0764}{open}} () override
\item 
void \mbox{\hyperlink{class_t_u_s_b_scanner_i_o_a5ffd73dc33fdbbb2b997a6fc365349f7}{close}} () override
\item 
int \mbox{\hyperlink{class_t_u_s_b_scanner_i_o_ab7f2443999810acb04d89f9657496464}{receive}} (unsigned char $\ast$buffer, int size) override
\item 
int \mbox{\hyperlink{class_t_u_s_b_scanner_i_o_a3c67ca873826c5222e492067cef7813c}{send}} (unsigned char $\ast$buffer, int size) override
\item 
void \mbox{\hyperlink{class_t_u_s_b_scanner_i_o_a4486cfaf842cc84ae18dfb4129c69cbd}{trace}} (bool on) override
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_t_u_s_b_scanner_i_o_a65b07e757512f300ab93debfb08a6281}\label{class_t_u_s_b_scanner_i_o_a65b07e757512f300ab93debfb08a6281}} 
\index{TUSBScannerIO@{TUSBScannerIO}!TUSBScannerIO@{TUSBScannerIO}}
\index{TUSBScannerIO@{TUSBScannerIO}!TUSBScannerIO@{TUSBScannerIO}}
\doxysubsubsection{\texorpdfstring{TUSBScannerIO()}{TUSBScannerIO()}}
{\footnotesize\ttfamily TUSBScanner\+IO\+::\+TUSBScanner\+IO (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00067 : m\_data(\textcolor{keyword}{new} \mbox{\hyperlink{class_t_u_s_b_scanner_i_o_p_d}{TUSBScannerIOPD}}()) \{ TRACE \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_u_s_b_scanner_i_o_aa5d2e3756b9c80bca14a49a66d95d30e}\label{class_t_u_s_b_scanner_i_o_aa5d2e3756b9c80bca14a49a66d95d30e}} 
\index{TUSBScannerIO@{TUSBScannerIO}!````~TUSBScannerIO@{$\sim$TUSBScannerIO}}
\index{````~TUSBScannerIO@{$\sim$TUSBScannerIO}!TUSBScannerIO@{TUSBScannerIO}}
\doxysubsubsection{\texorpdfstring{$\sim$TUSBScannerIO()}{~TUSBScannerIO()}}
{\footnotesize\ttfamily TUSBScanner\+IO\+::$\sim$\+TUSBScanner\+IO (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00207 \{ TRACE \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_t_u_s_b_scanner_i_o_a5ffd73dc33fdbbb2b997a6fc365349f7}\label{class_t_u_s_b_scanner_i_o_a5ffd73dc33fdbbb2b997a6fc365349f7}} 
\index{TUSBScannerIO@{TUSBScannerIO}!close@{close}}
\index{close@{close}!TUSBScannerIO@{TUSBScannerIO}}
\doxysubsubsection{\texorpdfstring{close()}{close()}}
{\footnotesize\ttfamily void TUSBScanner\+IO\+::close (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_scanner_i_o}{TScanner\+IO}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00134                           \{}
\DoxyCodeLine{00135   TRACE}
\DoxyCodeLine{00136 \textcolor{preprocessor}{\#if defined(HAS\_LIBUSB)}}
\DoxyCodeLine{00137   \textcolor{keywordflow}{if} (m\_data-\/>m\_handle) \{}
\DoxyCodeLine{00138     usb\_release\_interface(m\_data-\/>m\_handle, 0);}
\DoxyCodeLine{00139     usb\_close(m\_data-\/>m\_handle);}
\DoxyCodeLine{00140   \}}
\DoxyCodeLine{00141   m\_data-\/>m\_handle = 0;}
\DoxyCodeLine{00142   m\_data-\/>m\_epson  = 0;}
\DoxyCodeLine{00143 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00144 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_u_s_b_scanner_i_o_a3dfd9284a49749f602d30befa64a0764}\label{class_t_u_s_b_scanner_i_o_a3dfd9284a49749f602d30befa64a0764}} 
\index{TUSBScannerIO@{TUSBScannerIO}!open@{open}}
\index{open@{open}!TUSBScannerIO@{TUSBScannerIO}}
\doxysubsubsection{\texorpdfstring{open()}{open()}}
{\footnotesize\ttfamily bool TUSBScanner\+IO\+::open (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_scanner_i_o}{TScanner\+IO}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00088                          \{}
\DoxyCodeLine{00089 \textcolor{preprocessor}{\#if defined(HAS\_LIBUSB)}}
\DoxyCodeLine{00090   \textcolor{keywordflow}{for} (\textcolor{keyword}{struct} usb\_bus *bus = usb\_busses; bus; bus = bus-\/>next) \{}
\DoxyCodeLine{00091     \textcolor{keywordflow}{if} (bus-\/>root\_dev) \{}
\DoxyCodeLine{00092       m\_data-\/>m\_epson = doCheck(bus-\/>root\_dev, 0);}
\DoxyCodeLine{00093       \textcolor{keywordflow}{if} (m\_data-\/>m\_epson) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00094     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00095       \textcolor{keyword}{struct }usb\_device *dev;}
\DoxyCodeLine{00096       \textcolor{keywordflow}{for} (dev = bus-\/>devices; dev; dev = dev-\/>next)}
\DoxyCodeLine{00097         m\_data-\/>m\_epson = doCheck(dev, 0);}
\DoxyCodeLine{00098       \textcolor{keywordflow}{if} (m\_data-\/>m\_epson) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00099     \}}
\DoxyCodeLine{00100   \}}
\DoxyCodeLine{00101   \textcolor{keywordflow}{if} (!m\_data-\/>m\_epson) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00102   cout << \textcolor{stringliteral}{"{}found"{}} << endl;}
\DoxyCodeLine{00103   m\_data-\/>m\_handle = usb\_open(m\_data-\/>m\_epson);}
\DoxyCodeLine{00104   \textcolor{keywordflow}{if} (!m\_data-\/>m\_handle) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00105   cout << \textcolor{stringliteral}{"{}opened"{}} << endl;}
\DoxyCodeLine{00106   m\_data-\/>m\_epR = m\_data-\/>m\_epson-\/>config[0]}
\DoxyCodeLine{00107                       .interface[0]}
\DoxyCodeLine{00108                       .altsetting[0]}
\DoxyCodeLine{00109                       .endpoint[0]}
\DoxyCodeLine{00110                       .bEndpointAddress;}
\DoxyCodeLine{00111   m\_data-\/>m\_epW = m\_data-\/>m\_epson-\/>config[0]}
\DoxyCodeLine{00112                       .interface[0]}
\DoxyCodeLine{00113                       .altsetting[0]}
\DoxyCodeLine{00114                       .endpoint[1]}
\DoxyCodeLine{00115                       .bEndpointAddress;}
\DoxyCodeLine{00116 }
\DoxyCodeLine{00117   \textcolor{keywordtype}{int} rc;}
\DoxyCodeLine{00118   rc = usb\_set\_configuration(m\_data-\/>m\_handle,}
\DoxyCodeLine{00119                              m\_data-\/>m\_epson-\/>config[0].bConfigurationValue);}
\DoxyCodeLine{00120   cout << \textcolor{stringliteral}{"{}rc (config) = "{}} << rc << endl;}
\DoxyCodeLine{00121   \textcolor{keywordtype}{int} ifc = 0;}
\DoxyCodeLine{00122   rc      = usb\_claim\_interface(m\_data-\/>m\_handle, ifc);}
\DoxyCodeLine{00123   \textcolor{keywordflow}{if} ((rc == -\/EBUSY) || (rc == -\/ENOMEM)) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00124   cout << \textcolor{stringliteral}{"{}rc (claim) = "{}} << rc << endl;}
\DoxyCodeLine{00125   cout << \textcolor{stringliteral}{"{}gotit!"{}} << endl;}
\DoxyCodeLine{00126   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00127 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00128   \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00129 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00130 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_u_s_b_scanner_i_o_ab7f2443999810acb04d89f9657496464}\label{class_t_u_s_b_scanner_i_o_ab7f2443999810acb04d89f9657496464}} 
\index{TUSBScannerIO@{TUSBScannerIO}!receive@{receive}}
\index{receive@{receive}!TUSBScannerIO@{TUSBScannerIO}}
\doxysubsubsection{\texorpdfstring{receive()}{receive()}}
{\footnotesize\ttfamily int TUSBScanner\+IO\+::receive (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{buffer,  }\item[{int}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_scanner_i_o}{TScanner\+IO}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00148                                                           \{}
\DoxyCodeLine{00149   TRACE}
\DoxyCodeLine{00150 }
\DoxyCodeLine{00151 \textcolor{preprocessor}{\#if defined(HAS\_LIBUSB)}}
\DoxyCodeLine{00152 }
\DoxyCodeLine{00153   \textcolor{keywordtype}{int} count;}
\DoxyCodeLine{00154   count = usb\_bulk\_read(m\_data-\/>m\_handle, m\_data-\/>m\_epR, (\textcolor{keywordtype}{char} *)buffer, size,}
\DoxyCodeLine{00155                         30 * 1000);}
\DoxyCodeLine{00156 }
\DoxyCodeLine{00157   \textcolor{keywordflow}{if} (m\_data-\/>m\_trace) \{}
\DoxyCodeLine{00158     stringstream os;}
\DoxyCodeLine{00159     os << \textcolor{stringliteral}{"{}receive: size="{}} << size << \textcolor{stringliteral}{"{} got = "{}} << count << \textcolor{stringliteral}{"{} buf="{}};}
\DoxyCodeLine{00160     buf2printable(buffer, count, os);}
\DoxyCodeLine{00161     os << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00162     TSystem::outputDebug(os.str());}
\DoxyCodeLine{00163   \}}
\DoxyCodeLine{00164   \textcolor{keywordflow}{return} count;}
\DoxyCodeLine{00165 }
\DoxyCodeLine{00166 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00167   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00168 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00169 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_u_s_b_scanner_i_o_a3c67ca873826c5222e492067cef7813c}\label{class_t_u_s_b_scanner_i_o_a3c67ca873826c5222e492067cef7813c}} 
\index{TUSBScannerIO@{TUSBScannerIO}!send@{send}}
\index{send@{send}!TUSBScannerIO@{TUSBScannerIO}}
\doxysubsubsection{\texorpdfstring{send()}{send()}}
{\footnotesize\ttfamily int TUSBScanner\+IO\+::send (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{buffer,  }\item[{int}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_scanner_i_o}{TScanner\+IO}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00173                                                        \{}
\DoxyCodeLine{00174   TRACE}
\DoxyCodeLine{00175 }
\DoxyCodeLine{00176 \textcolor{preprocessor}{\#if defined(HAS\_LIBUSB)}}
\DoxyCodeLine{00177   \textcolor{keywordtype}{int} count;}
\DoxyCodeLine{00178   \textcolor{keywordflow}{if} (T != pthread\_self()) \{}
\DoxyCodeLine{00179     cout << \textcolor{stringliteral}{"{}called from another thead"{}} << endl;}
\DoxyCodeLine{00180     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00181   \}}
\DoxyCodeLine{00182 }
\DoxyCodeLine{00183   count = usb\_bulk\_write(m\_data-\/>m\_handle, m\_data-\/>m\_epW, (\textcolor{keywordtype}{char} *)buffer, size,}
\DoxyCodeLine{00184                          30 * 1000);}
\DoxyCodeLine{00185   \textcolor{keywordflow}{if} (m\_data-\/>m\_trace) \{}
\DoxyCodeLine{00186     stringstream os;}
\DoxyCodeLine{00187     os << \textcolor{stringliteral}{"{}send: size="{}} << size << \textcolor{stringliteral}{"{} wrote = "{}} << count << \textcolor{stringliteral}{"{} buf="{}};}
\DoxyCodeLine{00188     buf2printable(buffer, size, os);}
\DoxyCodeLine{00189     os << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00190     TSystem::outputDebug(os.str());}
\DoxyCodeLine{00191   \}}
\DoxyCodeLine{00192   \textcolor{keywordflow}{return} count;}
\DoxyCodeLine{00193 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00194   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00195 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00196 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_u_s_b_scanner_i_o_a4486cfaf842cc84ae18dfb4129c69cbd}\label{class_t_u_s_b_scanner_i_o_a4486cfaf842cc84ae18dfb4129c69cbd}} 
\index{TUSBScannerIO@{TUSBScannerIO}!trace@{trace}}
\index{trace@{trace}!TUSBScannerIO@{TUSBScannerIO}}
\doxysubsubsection{\texorpdfstring{trace()}{trace()}}
{\footnotesize\ttfamily void TUSBScanner\+IO\+::trace (\begin{DoxyParamCaption}\item[{bool}]{on }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_scanner_i_o}{TScanner\+IO}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00200                                  \{}
\DoxyCodeLine{00201   TRACE}
\DoxyCodeLine{00202   m\_data-\/>m\_trace = on;}
\DoxyCodeLine{00203 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/tnzbase/tscanner/\+TScanner\+IO/TUSBScanner\+IO.\+h\item 
E\+:/opentoonz/toonz/sources/tnzbase/tscanner/\+TScanner\+IO/TUSBScanner\+IO\+\_\+\+M.\+cpp\item 
E\+:/opentoonz/toonz/sources/tnzbase/tscanner/\+TScanner\+IO/TUSBScanner\+IO\+\_\+\+W.\+cpp\end{DoxyCompactItemize}
