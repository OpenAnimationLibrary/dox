\hypertarget{class_tool_utils_1_1_undo_pencil}{}\doxysection{Tool\+Utils\+::Undo\+Pencil Class Reference}
\label{class_tool_utils_1_1_undo_pencil}\index{ToolUtils::UndoPencil@{ToolUtils::UndoPencil}}
Inheritance diagram for Tool\+Utils\+::Undo\+Pencil\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_tool_utils_1_1_undo_pencil}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_tool_utils_1_1_undo_pencil_ac7f8f9f0ab1d661e27663f86351e2e78}{Undo\+Pencil}} (\mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$stroke, std\+::vector$<$ \mbox{\hyperlink{class_t_filled_region_inf}{TFilled\+Region\+Inf}} $>$ $\ast$fill\+Information, \mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$level, const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&frame\+Id, bool m\+\_\+created\+Frame, bool m\+\_\+created\+Level, bool autogroup=false, bool autofill=false)
\item 
void \mbox{\hyperlink{class_tool_utils_1_1_undo_pencil_ae4d0a0a615419248b94e4baeeac27a94}{undo}} () const override
\item 
void \mbox{\hyperlink{class_tool_utils_1_1_undo_pencil_aa23b0861e94a9610ba736d63f09a8517}{redo}} () const override
\item 
int \mbox{\hyperlink{class_tool_utils_1_1_undo_pencil_aedfc49c28dadcddc37946e5dbde047ff}{get\+Size}} () const override
\item 
QString \mbox{\hyperlink{class_tool_utils_1_1_undo_pencil_aa9234622005a69556be06a72c0fc3a1d}{get\+Tool\+Name}} () override
\item 
int \mbox{\hyperlink{class_tool_utils_1_1_undo_pencil_ae4d0c229c5fa9f18f7842097a731fcb8}{get\+History\+Type}} () override
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_tool_utils_1_1_undo_pencil_ac7f8f9f0ab1d661e27663f86351e2e78}\label{class_tool_utils_1_1_undo_pencil_ac7f8f9f0ab1d661e27663f86351e2e78}} 
\index{ToolUtils::UndoPencil@{ToolUtils::UndoPencil}!UndoPencil@{UndoPencil}}
\index{UndoPencil@{UndoPencil}!ToolUtils::UndoPencil@{ToolUtils::UndoPencil}}
\doxysubsubsection{\texorpdfstring{UndoPencil()}{UndoPencil()}}
{\footnotesize\ttfamily Tool\+Utils\+::\+Undo\+Pencil\+::\+Undo\+Pencil (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$}]{stroke,  }\item[{std\+::vector$<$ \mbox{\hyperlink{class_t_filled_region_inf}{TFilled\+Region\+Inf}} $>$ $\ast$}]{fill\+Information,  }\item[{\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$}]{level,  }\item[{const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{frame\+Id,  }\item[{bool}]{m\+\_\+created\+Frame,  }\item[{bool}]{m\+\_\+created\+Level,  }\item[{bool}]{autogroup = {\ttfamily false},  }\item[{bool}]{autofill = {\ttfamily false} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01039     : TToolUndo(level, frameId, createdFrame, createdLevel, 0)}
\DoxyCodeLine{01040     , m\_strokeId(stroke-\/>getId())}
\DoxyCodeLine{01041     , m\_fillInformation(fillInformation)}
\DoxyCodeLine{01042     , m\_autogroup(autogroup)}
\DoxyCodeLine{01043     , m\_autofill(autofill) \{}
\DoxyCodeLine{01044   m\_stroke = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}(*stroke);}
\DoxyCodeLine{01045 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_tool_utils_1_1_undo_pencil_a55f393ca0d922eddb19c72a94b13b063}\label{class_tool_utils_1_1_undo_pencil_a55f393ca0d922eddb19c72a94b13b063}} 
\index{ToolUtils::UndoPencil@{ToolUtils::UndoPencil}!````~UndoPencil@{$\sim$UndoPencil}}
\index{````~UndoPencil@{$\sim$UndoPencil}!ToolUtils::UndoPencil@{ToolUtils::UndoPencil}}
\doxysubsubsection{\texorpdfstring{$\sim$UndoPencil()}{~UndoPencil()}}
{\footnotesize\ttfamily Tool\+Utils\+::\+Undo\+Pencil\+::$\sim$\+Undo\+Pencil (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01049                                  \{}
\DoxyCodeLine{01050   \textcolor{keyword}{delete} m\_fillInformation;}
\DoxyCodeLine{01051   \textcolor{keyword}{delete} m\_stroke;}
\DoxyCodeLine{01052 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_tool_utils_1_1_undo_pencil_ae4d0c229c5fa9f18f7842097a731fcb8}\label{class_tool_utils_1_1_undo_pencil_ae4d0c229c5fa9f18f7842097a731fcb8}} 
\index{ToolUtils::UndoPencil@{ToolUtils::UndoPencil}!getHistoryType@{getHistoryType}}
\index{getHistoryType@{getHistoryType}!ToolUtils::UndoPencil@{ToolUtils::UndoPencil}}
\doxysubsubsection{\texorpdfstring{getHistoryType()}{getHistoryType()}}
{\footnotesize\ttfamily int Tool\+Utils\+::\+Undo\+Pencil\+::get\+History\+Type (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_undo}{TUndo}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00316 \{ \textcolor{keywordflow}{return} HistoryType::BrushTool; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_tool_utils_1_1_undo_pencil_aedfc49c28dadcddc37946e5dbde047ff}\label{class_tool_utils_1_1_undo_pencil_aedfc49c28dadcddc37946e5dbde047ff}} 
\index{ToolUtils::UndoPencil@{ToolUtils::UndoPencil}!getSize@{getSize}}
\index{getSize@{getSize}!ToolUtils::UndoPencil@{ToolUtils::UndoPencil}}
\doxysubsubsection{\texorpdfstring{getSize()}{getSize()}}
{\footnotesize\ttfamily int Tool\+Utils\+::\+Undo\+Pencil\+::get\+Size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_undo}{TUndo}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01140                                        \{}
\DoxyCodeLine{01141   \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(*this) +}
\DoxyCodeLine{01142          m\_fillInformation-\/>capacity() * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{class_t_filled_region_inf}{TFilledRegionInf}}) + 500;}
\DoxyCodeLine{01143 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_tool_utils_1_1_undo_pencil_aa9234622005a69556be06a72c0fc3a1d}\label{class_tool_utils_1_1_undo_pencil_aa9234622005a69556be06a72c0fc3a1d}} 
\index{ToolUtils::UndoPencil@{ToolUtils::UndoPencil}!getToolName@{getToolName}}
\index{getToolName@{getToolName}!ToolUtils::UndoPencil@{ToolUtils::UndoPencil}}
\doxysubsubsection{\texorpdfstring{getToolName()}{getToolName()}}
{\footnotesize\ttfamily QString Tool\+Utils\+::\+Undo\+Pencil\+::get\+Tool\+Name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo}{Tool\+Utils\+::\+TTool\+Undo}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00315 \{ \textcolor{keywordflow}{return} QString(\textcolor{stringliteral}{"{}Vector Brush Tool"{}}); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_tool_utils_1_1_undo_pencil_aa23b0861e94a9610ba736d63f09a8517}\label{class_tool_utils_1_1_undo_pencil_aa23b0861e94a9610ba736d63f09a8517}} 
\index{ToolUtils::UndoPencil@{ToolUtils::UndoPencil}!redo@{redo}}
\index{redo@{redo}!ToolUtils::UndoPencil@{ToolUtils::UndoPencil}}
\doxysubsubsection{\texorpdfstring{redo()}{redo()}}
{\footnotesize\ttfamily void Tool\+Utils\+::\+Undo\+Pencil\+::redo (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_undo}{TUndo}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01096                                      \{}
\DoxyCodeLine{01097   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{01098   \textcolor{keywordflow}{if} (!app) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01099 }
\DoxyCodeLine{01100   insertLevelAndFrameIfNeeded();}
\DoxyCodeLine{01101 }
\DoxyCodeLine{01102   \textcolor{comment}{/*if(app-\/>getCurrentFrame()-\/>isEditingScene())}}
\DoxyCodeLine{01103 \textcolor{comment}{  \{}}
\DoxyCodeLine{01104 \textcolor{comment}{          app-\/>getCurrentColumn()-\/>setColumnIndex(m\_col);}}
\DoxyCodeLine{01105 \textcolor{comment}{          app-\/>getCurrentFrame()-\/>setFrame(m\_row);}}
\DoxyCodeLine{01106 \textcolor{comment}{  \}}}
\DoxyCodeLine{01107 \textcolor{comment}{  else}}
\DoxyCodeLine{01108 \textcolor{comment}{          app-\/>getCurrentFrame()-\/>setFid(m\_frameId);*/}}
\DoxyCodeLine{01109 }
\DoxyCodeLine{01110   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} image = m\_level-\/>getFrame(m\_frameId, \textcolor{keyword}{true});}
\DoxyCodeLine{01111   \textcolor{keywordflow}{if} (!image) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01112 }
\DoxyCodeLine{01113   QMutexLocker sl(image-\/>getMutex());}
\DoxyCodeLine{01114   \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}(*m\_stroke);}
\DoxyCodeLine{01115   stroke-\/>setId(m\_strokeId);}
\DoxyCodeLine{01116   image-\/>addStroke(stroke);}
\DoxyCodeLine{01117   \textcolor{keywordflow}{if} (image-\/>isComputedRegionAlmostOnce()) image-\/>findRegions();}
\DoxyCodeLine{01118 }
\DoxyCodeLine{01119   \textcolor{keywordflow}{if} (m\_autogroup \&\& stroke-\/>\mbox{\hyperlink{class_t_stroke_a3565d6c34d3eb02fb1a6993ca626425c}{isSelfLoop}}()) \{}
\DoxyCodeLine{01120     \textcolor{keywordtype}{int} index = image-\/>getStrokeCount() -\/ 1;}
\DoxyCodeLine{01121     image-\/>group(index, 1);}
\DoxyCodeLine{01122     \textcolor{keywordflow}{if} (m\_autofill) \{}
\DoxyCodeLine{01123       \textcolor{comment}{// to avoid filling other strokes, I enter into the new stroke group}}
\DoxyCodeLine{01124       \textcolor{keywordtype}{int} currentGroup = image-\/>exitGroup();}
\DoxyCodeLine{01125       image-\/>enterGroup(index);}
\DoxyCodeLine{01126       image-\/>selectFill(stroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}().enlarge(1, 1), 0, stroke-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}(),}
\DoxyCodeLine{01127                         \textcolor{keyword}{false}, \textcolor{keyword}{true}, \textcolor{keyword}{false});}
\DoxyCodeLine{01128       \textcolor{keywordflow}{if} (currentGroup != -\/1)}
\DoxyCodeLine{01129         image-\/>enterGroup(currentGroup);}
\DoxyCodeLine{01130       \textcolor{keywordflow}{else}}
\DoxyCodeLine{01131         image-\/>exitGroup();}
\DoxyCodeLine{01132     \}}
\DoxyCodeLine{01133   \}}
\DoxyCodeLine{01134   app-\/>getCurrentXsheet()-\/>notifyXsheetChanged();}
\DoxyCodeLine{01135   notifyImageChanged();}
\DoxyCodeLine{01136 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_tool_utils_1_1_undo_pencil_ae4d0a0a615419248b94e4baeeac27a94}\label{class_tool_utils_1_1_undo_pencil_ae4d0a0a615419248b94e4baeeac27a94}} 
\index{ToolUtils::UndoPencil@{ToolUtils::UndoPencil}!undo@{undo}}
\index{undo@{undo}!ToolUtils::UndoPencil@{ToolUtils::UndoPencil}}
\doxysubsubsection{\texorpdfstring{undo()}{undo()}}
{\footnotesize\ttfamily void Tool\+Utils\+::\+Undo\+Pencil\+::undo (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_undo}{TUndo}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01056                                      \{}
\DoxyCodeLine{01057   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{01058   \textcolor{keywordflow}{if} (!app) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01059 }
\DoxyCodeLine{01060   \textcolor{comment}{/*if(app-\/>getCurrentFrame()-\/>isEditingScene() \&\& m\_col!=-\/2 \&\& m\_row!=-\/1)}}
\DoxyCodeLine{01061 \textcolor{comment}{  \{}}
\DoxyCodeLine{01062 \textcolor{comment}{          app-\/>getCurrentColumn()-\/>setColumnIndex(m\_col);}}
\DoxyCodeLine{01063 \textcolor{comment}{          app-\/>getCurrentFrame()-\/>setFrame(m\_row);}}
\DoxyCodeLine{01064 \textcolor{comment}{  \}}}
\DoxyCodeLine{01065 \textcolor{comment}{  else}}
\DoxyCodeLine{01066 \textcolor{comment}{          app-\/>getCurrentFrame()-\/>setFid(m\_frameId);*/}}
\DoxyCodeLine{01067 }
\DoxyCodeLine{01068   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} image = m\_level-\/>getFrame(m\_frameId, \textcolor{keyword}{true});}
\DoxyCodeLine{01069   assert(image);}
\DoxyCodeLine{01070   \textcolor{keywordflow}{if} (!image) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01071 }
\DoxyCodeLine{01072   QMutexLocker sl(image-\/>getMutex());}
\DoxyCodeLine{01073   \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *stroke = image-\/>getStrokeById(m\_strokeId);}
\DoxyCodeLine{01074   \textcolor{keywordflow}{if} (!stroke) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01075   image-\/>deleteStroke(stroke);}
\DoxyCodeLine{01076   \mbox{\hyperlink{class_t_selection}{TSelection}} *selection            = app-\/>getCurrentSelection()-\/>getSelection();}
\DoxyCodeLine{01077   \mbox{\hyperlink{class_stroke_selection}{StrokeSelection}} *strokeSelection = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_stroke_selection}{StrokeSelection}} *\textcolor{keyword}{>}(selection);}
\DoxyCodeLine{01078   \textcolor{keywordflow}{if} (strokeSelection) strokeSelection-\/>selectNone();}
\DoxyCodeLine{01079 }
\DoxyCodeLine{01080   UINT size = m\_fillInformation-\/>size();}
\DoxyCodeLine{01081   \mbox{\hyperlink{class_t_region}{TRegion}} *reg;}
\DoxyCodeLine{01082   \textcolor{keywordflow}{for} (UINT i = 0; i < size; i++) \{}
\DoxyCodeLine{01083     reg = image-\/>getRegion((*m\_fillInformation)[i].m\_regionId);}
\DoxyCodeLine{01084     assert(reg);}
\DoxyCodeLine{01085     \textcolor{keywordflow}{if} (reg) reg-\/>setStyle((*m\_fillInformation)[i].m\_styleId);}
\DoxyCodeLine{01086   \}}
\DoxyCodeLine{01087 }
\DoxyCodeLine{01088   removeLevelAndFrameIfNeeded();}
\DoxyCodeLine{01089 }
\DoxyCodeLine{01090   app-\/>getCurrentXsheet()-\/>notifyXsheetChanged();}
\DoxyCodeLine{01091   notifyImageChanged();}
\DoxyCodeLine{01092 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/tools/toolutils.\+h\item 
E\+:/opentoonz/toonz/sources/tnztools/toolutils.\+cpp\end{DoxyCompactItemize}
