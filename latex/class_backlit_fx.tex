\hypertarget{class_backlit_fx}{}\doxysection{Backlit\+Fx Class Reference}
\label{class_backlit_fx}\index{BacklitFx@{BacklitFx}}
Inheritance diagram for Backlit\+Fx\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.645833cm]{class_backlit_fx}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{class_backlit_fx_a1dd26c9143fe4c97d23b759e70da8372}{do\+Get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&b\+Box)
\item 
void \mbox{\hyperlink{class_backlit_fx_a81ba4a3c4221a15d190194457615e4ee}{do\+Compute}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&ri)
\item 
int \mbox{\hyperlink{class_backlit_fx_acfd611c0c6d5d011896cb11a6450f8e1}{get\+Memory\+Requirement}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info)
\item 
\mbox{\hyperlink{class_t_rect_t}{TRect}} \mbox{\hyperlink{class_backlit_fx_abb93a87494f15a9f84b7b36357495495}{get\+Invalid\+Rect}} (const \mbox{\hyperlink{class_t_rect_t}{TRect}} \&max)
\item 
bool \mbox{\hyperlink{class_backlit_fx_a86bd0764dcd7be18e7f8b6d1517323df}{do\+Get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&bbox, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
void \mbox{\hyperlink{class_backlit_fx_a5fcd467ce8dbc2d321b0f86332de2bc4}{do\+Dry\+Compute}} (\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
void \mbox{\hyperlink{class_backlit_fx_aaac2703cc3e31761c32878ddccf48999}{do\+Compute}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&ri) override
\item 
bool \mbox{\hyperlink{class_backlit_fx_a1b7daff1d7a3e6a14656ee7fc730fed8}{can\+Handle}} (const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info, double frame) override
\item 
int \mbox{\hyperlink{class_backlit_fx_a111f89a878a7f88f5ed585551acb2198}{get\+Memory\+Requirement}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_backlit_fx_a37bf89147954916b5f4adff10d14dd3e}\label{class_backlit_fx_a37bf89147954916b5f4adff10d14dd3e}} 
\index{BacklitFx@{BacklitFx}!BacklitFx@{BacklitFx}}
\index{BacklitFx@{BacklitFx}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{BacklitFx()}{BacklitFx()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Backlit\+Fx\+::\+Backlit\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00018   \{}
\DoxyCodeLine{00019     \textcolor{comment}{// m\_value-\/>setDefaultValue(100);}}
\DoxyCodeLine{00020     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Source"{}}, m\_input);}
\DoxyCodeLine{00021   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_backlit_fx_a9e5785a752e646810f6fc1d627728793}\label{class_backlit_fx_a9e5785a752e646810f6fc1d627728793}} 
\index{BacklitFx@{BacklitFx}!````~BacklitFx@{$\sim$BacklitFx}}
\index{````~BacklitFx@{$\sim$BacklitFx}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{$\sim$BacklitFx()}{~BacklitFx()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Backlit\+Fx\+::$\sim$\+Backlit\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00023 \{\};}

\end{DoxyCode}
\mbox{\Hypertarget{class_backlit_fx_a37bf89147954916b5f4adff10d14dd3e}\label{class_backlit_fx_a37bf89147954916b5f4adff10d14dd3e}} 
\index{BacklitFx@{BacklitFx}!BacklitFx@{BacklitFx}}
\index{BacklitFx@{BacklitFx}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{BacklitFx()}{BacklitFx()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily Backlit\+Fx\+::\+Backlit\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00190               : m\_value(0.0), m\_color(TPixel::White), m\_fade(0.0) \{}
\DoxyCodeLine{00191     m\_color-\/>enableMatte(\textcolor{keyword}{true});}
\DoxyCodeLine{00192     m\_value-\/>setValueRange(0, (std::numeric\_limits<double>::max)());}
\DoxyCodeLine{00193     m\_fade-\/>setValueRange(0.0, 100.0);}
\DoxyCodeLine{00194     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}value"{}}, m\_value);}
\DoxyCodeLine{00195     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}color"{}}, m\_color);}
\DoxyCodeLine{00196     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}fade"{}}, m\_fade);}
\DoxyCodeLine{00197 }
\DoxyCodeLine{00198     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Light"{}}, m\_light);}
\DoxyCodeLine{00199     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Source"{}}, m\_lighted);}
\DoxyCodeLine{00200   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_backlit_fx_a9e5785a752e646810f6fc1d627728793}\label{class_backlit_fx_a9e5785a752e646810f6fc1d627728793}} 
\index{BacklitFx@{BacklitFx}!````~BacklitFx@{$\sim$BacklitFx}}
\index{````~BacklitFx@{$\sim$BacklitFx}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{$\sim$BacklitFx()}{~BacklitFx()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily Backlit\+Fx\+::$\sim$\+Backlit\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00201 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_backlit_fx_a1b7daff1d7a3e6a14656ee7fc730fed8}\label{class_backlit_fx_a1b7daff1d7a3e6a14656ee7fc730fed8}} 
\index{BacklitFx@{BacklitFx}!canHandle@{canHandle}}
\index{canHandle@{canHandle}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{canHandle()}{canHandle()}}
{\footnotesize\ttfamily bool Backlit\+Fx\+::can\+Handle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info,  }\item[{double}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00283                                                                      \{}
\DoxyCodeLine{00284     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00285   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_backlit_fx_a81ba4a3c4221a15d190194457615e4ee}\label{class_backlit_fx_a81ba4a3c4221a15d190194457615e4ee}} 
\index{BacklitFx@{BacklitFx}!doCompute@{doCompute}}
\index{doCompute@{doCompute}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{doCompute()}{doCompute()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Backlit\+Fx\+::do\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{ri }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00099                                                      \{}
\DoxyCodeLine{00100   \textcolor{keywordflow}{if} (!m\_input.isConnected()) \{}
\DoxyCodeLine{00101     tile.getRaster()-\/>clear();}
\DoxyCodeLine{00102     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00103   \}}
\DoxyCodeLine{00104   \mbox{\hyperlink{class_t_tile}{TTile}} srcTile;}
\DoxyCodeLine{00105   srcTile.m\_pos = tile.m\_pos;}
\DoxyCodeLine{00106   \mbox{\hyperlink{class_t_point_t}{TPoint}} srcPos(0, 0);}
\DoxyCodeLine{00107   \mbox{\hyperlink{class_t_dimension_t}{TDimension}} srcSize = tile.getRaster()-\/>getSize();}
\DoxyCodeLine{00108 }
\DoxyCodeLine{00109   \mbox{\hyperlink{class_t_point_t}{TPoint}} center(-\/(\textcolor{keywordtype}{int})tile.m\_pos.x, -\/(\textcolor{keywordtype}{int})tile.m\_pos.y);}
\DoxyCodeLine{00110   center += \mbox{\hyperlink{class_t_point_t}{TPoint}}(10, 10);}
\DoxyCodeLine{00111   \textcolor{keywordflow}{if} (center.x < 0) \{}
\DoxyCodeLine{00112     srcSize.lx += -\/center.x;}
\DoxyCodeLine{00113     srcPos.x += center.x;}
\DoxyCodeLine{00114     srcTile.m\_pos.x += center.x;}
\DoxyCodeLine{00115   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (center.x >= srcSize.lx) \{}
\DoxyCodeLine{00116     srcSize.lx += center.x -\/ srcSize.lx + 1;}
\DoxyCodeLine{00117   \}}
\DoxyCodeLine{00118 }
\DoxyCodeLine{00119   \textcolor{keywordflow}{if} (center.y < 0) \{}
\DoxyCodeLine{00120     srcSize.ly += -\/center.y;}
\DoxyCodeLine{00121     srcPos.y += center.y;}
\DoxyCodeLine{00122     srcTile.m\_pos.y += center.y;}
\DoxyCodeLine{00123   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (center.y >= srcSize.ly) \{}
\DoxyCodeLine{00124     srcSize.ly += center.y -\/ srcSize.ly + 1;}
\DoxyCodeLine{00125   \}}
\DoxyCodeLine{00126 }
\DoxyCodeLine{00127   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})tile.getRaster()) \{}
\DoxyCodeLine{00128     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} src = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}(srcSize);}
\DoxyCodeLine{00129     src-\/>clear();}
\DoxyCodeLine{00130     srcTile.getRaster() = src;}
\DoxyCodeLine{00131 }
\DoxyCodeLine{00132     m\_input-\/>compute(srcTile, frame, ri);}
\DoxyCodeLine{00133 }
\DoxyCodeLine{00134     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} dst = tile.getRaster();}
\DoxyCodeLine{00135     assert(dst);}
\DoxyCodeLine{00136     computeBacklit<TPixel32>(dst, src, srcPos, center);}
\DoxyCodeLine{00137   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})tile.getRaster()) \{}
\DoxyCodeLine{00138     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} src = \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}}(srcSize);}
\DoxyCodeLine{00139     src-\/>clear();}
\DoxyCodeLine{00140     srcTile.getRaster() = src;}
\DoxyCodeLine{00141 }
\DoxyCodeLine{00142     m\_input-\/>compute(srcTile, frame, ri);}
\DoxyCodeLine{00143 }
\DoxyCodeLine{00144     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} dst = tile.getRaster();}
\DoxyCodeLine{00145     assert(dst);}
\DoxyCodeLine{00146     computeBacklit<TPixel64>(dst, src, srcPos, center);}
\DoxyCodeLine{00147   \}}
\DoxyCodeLine{00148 }
\DoxyCodeLine{00149   \textcolor{comment}{// dst-\/>copy(src,srcPos);}}
\DoxyCodeLine{00150 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_backlit_fx_aaac2703cc3e31761c32878ddccf48999}\label{class_backlit_fx_aaac2703cc3e31761c32878ddccf48999}} 
\index{BacklitFx@{BacklitFx}!doCompute@{doCompute}}
\index{doCompute@{doCompute}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{doCompute()}{doCompute()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Backlit\+Fx\+::do\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{ri }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00243                                                      \{}
\DoxyCodeLine{00244     \textcolor{keywordflow}{if} (!m\_light.isConnected()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00245 }
\DoxyCodeLine{00246     \textcolor{keywordflow}{if} (!m\_lighted.isConnected()) \{}
\DoxyCodeLine{00247       m\_light-\/>compute(tile, frame, ri);}
\DoxyCodeLine{00248       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00249     \}}
\DoxyCodeLine{00250 }
\DoxyCodeLine{00251     \textcolor{keywordtype}{double} value = m\_value-\/>getValue(frame);}
\DoxyCodeLine{00252     \textcolor{keywordtype}{double} scale = sqrt(fabs(ri.\mbox{\hyperlink{class_t_render_settings_a1250181bf3fe8e05db005d5faa76b3ea}{m\_affine}}.det()));}
\DoxyCodeLine{00253     \textcolor{keywordtype}{int} brad     = tceil(value * scale);}
\DoxyCodeLine{00254 }
\DoxyCodeLine{00255     \mbox{\hyperlink{class_t_dimension_t}{TDimension}} tileSize(tile.getRaster()-\/>getSize());}
\DoxyCodeLine{00256     \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect(tile.m\_pos, \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}}(tileSize.lx, tileSize.ly));}
\DoxyCodeLine{00257 }
\DoxyCodeLine{00258     \textcolor{comment}{// TRectD}}
\DoxyCodeLine{00259     \textcolor{comment}{// rect(tile.m\_pos,convert(tile.getRaster()-\/>getBounds().getP11())+tile.m\_pos);}}
\DoxyCodeLine{00260     rect = rect.enlarge(brad);}
\DoxyCodeLine{00261     \mbox{\hyperlink{class_t_rect_t}{TRect}} rectI(tfloor(rect.x0), tfloor(rect.y0), tceil(rect.x1) -\/ 1,}
\DoxyCodeLine{00262                 tceil(rect.y1) -\/ 1);}
\DoxyCodeLine{00263     \textcolor{comment}{// m\_light-\/>compute(tile, frame, ri);}}
\DoxyCodeLine{00264     \mbox{\hyperlink{class_t_tile}{TTile}} srcTile;}
\DoxyCodeLine{00265     m\_lighted-\/>allocateAndCompute(srcTile, rect.getP00(), rectI.getSize(),}
\DoxyCodeLine{00266                                   tile.getRaster(), frame, ri);}
\DoxyCodeLine{00267     \mbox{\hyperlink{class_t_tile}{TTile}} ctrTile;}
\DoxyCodeLine{00268     m\_light-\/>allocateAndCompute(ctrTile, rect.getP00(), rectI.getSize(),}
\DoxyCodeLine{00269                                 tile.getRaster(), frame, ri);}
\DoxyCodeLine{00270     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})srcTile.getRaster() \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})tile.getRaster())}
\DoxyCodeLine{00271       backlit((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})srcTile.getRaster(), (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})ctrTile.getRaster(),}
\DoxyCodeLine{00272               (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})ctrTile.getRaster(), value, m\_color-\/>getValue(frame),}
\DoxyCodeLine{00273               m\_fade-\/>getValue(frame) / 100.0, scale);}
\DoxyCodeLine{00274     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})srcTile.getRaster() \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})tile.getRaster())}
\DoxyCodeLine{00275       backlit((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})srcTile.getRaster(), (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})ctrTile.getRaster(),}
\DoxyCodeLine{00276               (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})ctrTile.getRaster(), value, m\_color-\/>getValue(frame),}
\DoxyCodeLine{00277               m\_fade-\/>getValue(frame) / 100.0, scale);}
\DoxyCodeLine{00278     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00279       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::max invalid raster combination"{}});}
\DoxyCodeLine{00280     tile.getRaster()-\/>\mbox{\hyperlink{class_t_raster_a3c590c4ebe4cb8c1f352437692ffd20e}{copy}}(ctrTile.getRaster(), \mbox{\hyperlink{class_t_point_t}{TPoint}}(-\/brad, -\/brad));}
\DoxyCodeLine{00281   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_backlit_fx_a5fcd467ce8dbc2d321b0f86332de2bc4}\label{class_backlit_fx_a5fcd467ce8dbc2d321b0f86332de2bc4}} 
\index{BacklitFx@{BacklitFx}!doDryCompute@{doDryCompute}}
\index{doDryCompute@{doDryCompute}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{doDryCompute()}{doDryCompute()}}
{\footnotesize\ttfamily void Backlit\+Fx\+::do\+Dry\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Declares the computation scheme of this fx for rendering optimization purposes. This is an important function of the Toonz rendering API, and should be reimplemented with the necessary care. The Toonz rendering process makes use of this function to enact most of the optimization steps about the fx computation, in particular fx caching. A correct implementation of this method should follow these rules\+:  The invocation of child node computations should be faithfully reproduced.  TRaster\+Fx\+::compute and TRaster\+Fx\+::allocate\+And\+Compute calls have to be translated to TRaster\+Fx\+::dry\+Compute calls.  This fx is intended for precomputation stage, so the hard rendering code should be skipped here. By default, this method raises a dry\+Compute call to each input port in increasing order, using the TRaster\+Fx\+::transform method to identify the tiles to be passed on input precomputation. 

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_a47ec31d2d4c3a066cd6744fb8c80edf2}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00223                                                           \{}
\DoxyCodeLine{00224     \textcolor{keywordflow}{if} (!m\_light.isConnected()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00225     \textcolor{keywordflow}{if} (!m\_lighted.isConnected()) \{}
\DoxyCodeLine{00226       m\_light-\/>dryCompute(rect, frame, info);}
\DoxyCodeLine{00227       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00228     \}}
\DoxyCodeLine{00229 }
\DoxyCodeLine{00230     \textcolor{keywordtype}{double} value = m\_value-\/>getValue(frame);}
\DoxyCodeLine{00231     \textcolor{keywordtype}{double} scale = sqrt(fabs(info.m\_affine.det()));}
\DoxyCodeLine{00232     \textcolor{keywordtype}{int} brad     = tceil(value * scale);}
\DoxyCodeLine{00233 }
\DoxyCodeLine{00234     \mbox{\hyperlink{class_t_rect_t}{TRectD}} inRect = rect.enlarge(brad);}
\DoxyCodeLine{00235     inRect = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(tfloor(inRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}), tfloor(inRect.y0), tceil(inRect.x1),}
\DoxyCodeLine{00236                     tceil(inRect.y1));}
\DoxyCodeLine{00237 }
\DoxyCodeLine{00238     m\_lighted-\/>dryCompute(inRect, frame, info);}
\DoxyCodeLine{00239     m\_light-\/>dryCompute(inRect, frame, info);}
\DoxyCodeLine{00240   \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00557}{TRect\+T$<$ T $>$\+::x0}}.

\mbox{\Hypertarget{class_backlit_fx_a1dd26c9143fe4c97d23b759e70da8372}\label{class_backlit_fx_a1dd26c9143fe4c97d23b759e70da8372}} 
\index{BacklitFx@{BacklitFx}!doGetBBox@{doGetBBox}}
\index{doGetBBox@{doGetBBox}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{doGetBBox()}{doGetBBox()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily bool Backlit\+Fx\+::do\+Get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{b\+Box }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00035                                                     \{}
\DoxyCodeLine{00036   \textcolor{keywordflow}{if} (m\_input.isConnected()) \{}
\DoxyCodeLine{00037     \textcolor{keywordtype}{bool} ret = m\_input-\/>doGetBBox(frame, bBox);}
\DoxyCodeLine{00038     \textcolor{comment}{// devo scurire bgColor}}
\DoxyCodeLine{00039     \textcolor{keywordflow}{return} ret;}
\DoxyCodeLine{00040   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00041     bBox = \mbox{\hyperlink{class_t_rect_t}{TRectD}}();}
\DoxyCodeLine{00042     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00043   \}}
\DoxyCodeLine{00044 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_backlit_fx_a86bd0764dcd7be18e7f8b6d1517323df}\label{class_backlit_fx_a86bd0764dcd7be18e7f8b6d1517323df}} 
\index{BacklitFx@{BacklitFx}!doGetBBox@{doGetBBox}}
\index{doGetBBox@{doGetBBox}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{doGetBBox()}{doGetBBox()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily bool Backlit\+Fx\+::do\+Get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{bbox,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00203                                                        \{}
\DoxyCodeLine{00204     \textcolor{keywordflow}{if} (getActiveTimeRegion().contains(frame)) \{}
\DoxyCodeLine{00205       \textcolor{keywordflow}{if} (m\_light.isConnected()) \{}
\DoxyCodeLine{00206         \textcolor{keywordflow}{if} (m\_lighted.isConnected()) \{}
\DoxyCodeLine{00207           \mbox{\hyperlink{class_t_rect_t}{TRectD}} b0, b1;}
\DoxyCodeLine{00208           \textcolor{keywordtype}{bool} ret = m\_light-\/>doGetBBox(frame, b0, info);}
\DoxyCodeLine{00209           ret      = ret \&\& m\_lighted-\/>doGetBBox(frame, b1, info);}
\DoxyCodeLine{00210           bbox     = b0.enlarge(tceil(m\_value-\/>getValue(frame))) + b1;}
\DoxyCodeLine{00211           \textcolor{keywordflow}{return} ret;}
\DoxyCodeLine{00212         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00213           \textcolor{keywordflow}{return} m\_light-\/>doGetBBox(frame, bbox, info);}
\DoxyCodeLine{00214     \}}
\DoxyCodeLine{00215       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_lighted.isConnected()) \{}
\DoxyCodeLine{00216         \textcolor{keywordflow}{return} m\_lighted-\/>doGetBBox(frame, bbox, info);}
\DoxyCodeLine{00217       \}}
\DoxyCodeLine{00218     \}}
\DoxyCodeLine{00219     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00220   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_backlit_fx_abb93a87494f15a9f84b7b36357495495}\label{class_backlit_fx_abb93a87494f15a9f84b7b36357495495}} 
\index{BacklitFx@{BacklitFx}!getInvalidRect@{getInvalidRect}}
\index{getInvalidRect@{getInvalidRect}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{getInvalidRect()}{getInvalidRect()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_rect_t}{TRect}} Backlit\+Fx\+::get\+Invalid\+Rect (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRect}} \&}]{max }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00161                                                 \{}
\DoxyCodeLine{00162   \textcolor{keywordflow}{if} (!m\_input.isConnected()) \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_rect_t}{TRect}}();}
\DoxyCodeLine{00163   \mbox{\hyperlink{class_t_rect_t}{TRect}} rect = m\_input-\/>getInvalidRect(max);}
\DoxyCodeLine{00164   \mbox{\hyperlink{class_t_rect_t}{TRect}} ris  = max;}
\DoxyCodeLine{00165 }
\DoxyCodeLine{00166   \textcolor{keywordflow}{if} (rect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} >= 0)}
\DoxyCodeLine{00167     ris.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} = tmin(rect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, max.x1);}
\DoxyCodeLine{00168   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rect.x1 <= 0)}
\DoxyCodeLine{00169     ris.x1 = tmax(rect.x1, max.x0);}
\DoxyCodeLine{00170   \textcolor{keywordflow}{if} (rect.y0 >= 0)}
\DoxyCodeLine{00171     ris.y0 = tmin(rect.y0, max.y1);}
\DoxyCodeLine{00172   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rect.y1 <= 0)}
\DoxyCodeLine{00173     ris.y1 = tmax(rect.y1, max.y0);}
\DoxyCodeLine{00174 }
\DoxyCodeLine{00175   \textcolor{keywordflow}{return} ris;}
\DoxyCodeLine{00176 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_backlit_fx_acfd611c0c6d5d011896cb11a6450f8e1}\label{class_backlit_fx_acfd611c0c6d5d011896cb11a6450f8e1}} 
\index{BacklitFx@{BacklitFx}!getMemoryRequirement@{getMemoryRequirement}}
\index{getMemoryRequirement@{getMemoryRequirement}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{getMemoryRequirement()}{getMemoryRequirement()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily int Backlit\+Fx\+::get\+Memory\+Requirement (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Specifies the approximate size (in Mega\+Bytes) of the maximum allocation instance that this fx will need to perform in order to render the passed input. This method should be reimplemented in order to make the Toonz rendering process aware of the use of big raster memory chunks, at least. Observe that the passed tile geometry is implicitly {\itshape  already allocated \texorpdfstring{$<$}{<}\textbackslash{}i\texorpdfstring{$>$}{>} for the fx output. ~\newline
The default implementation returns 0, assuming that the passed implicit memory size is passed below in node computation without further allocation of resources. Fxs can reimplement this to -\/1 to explicitly disable the Toonz\textquotesingle{}s smart memory handling. ~\newline
 ~\newline
\begin{DoxyNote}{Note}
The rendering process ensures that the passed render settings are {\itshape handled} by the fx before this function is invoked -\/ do not waste code for it. 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRaster\+Fx\+::memory\+Size}} and TRaster\+Fx\+::can\+Handle methods. 
\end{DoxySeeAlso}
}

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_af8eb991c9756f4fb2e48d9f96cbacfba}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00155                                                                  \{}
\DoxyCodeLine{00156   \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRasterFx::memorySize}}(rect, frame, info);}
\DoxyCodeLine{00157 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00560}{TRaster\+Fx\+::memory\+Size()}}.

\mbox{\Hypertarget{class_backlit_fx_a111f89a878a7f88f5ed585551acb2198}\label{class_backlit_fx_a111f89a878a7f88f5ed585551acb2198}} 
\index{BacklitFx@{BacklitFx}!getMemoryRequirement@{getMemoryRequirement}}
\index{getMemoryRequirement@{getMemoryRequirement}!BacklitFx@{BacklitFx}}
\doxysubsubsection{\texorpdfstring{getMemoryRequirement()}{getMemoryRequirement()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily int Backlit\+Fx\+::get\+Memory\+Requirement (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Specifies the approximate size (in Mega\+Bytes) of the maximum allocation instance that this fx will need to perform in order to render the passed input. This method should be reimplemented in order to make the Toonz rendering process aware of the use of big raster memory chunks, at least. Observe that the passed tile geometry is implicitly {\itshape  already allocated \texorpdfstring{$<$}{<}\textbackslash{}i\texorpdfstring{$>$}{>} for the fx output. ~\newline
The default implementation returns 0, assuming that the passed implicit memory size is passed below in node computation without further allocation of resources. Fxs can reimplement this to -\/1 to explicitly disable the Toonz\textquotesingle{}s smart memory handling. ~\newline
 ~\newline
\begin{DoxyNote}{Note}
The rendering process ensures that the passed render settings are {\itshape handled} by the fx before this function is invoked -\/ do not waste code for it. 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRaster\+Fx\+::memory\+Size}} and TRaster\+Fx\+::can\+Handle methods. 
\end{DoxySeeAlso}
}

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_af8eb991c9756f4fb2e48d9f96cbacfba}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00288                                                                  \{}
\DoxyCodeLine{00289     \textcolor{keywordtype}{double} value = m\_value-\/>getValue(frame);}
\DoxyCodeLine{00290     \textcolor{keywordtype}{double} scale = sqrt(fabs(info.m\_affine.det()));}
\DoxyCodeLine{00291     \textcolor{keywordtype}{int} brad     = tceil(value * scale);}
\DoxyCodeLine{00292 }
\DoxyCodeLine{00293     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRasterFx::memorySize}}(rect.enlarge(brad), info.m\_bpp);}
\DoxyCodeLine{00294   \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00560}{TRaster\+Fx\+::memory\+Size()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/stdfx/backlit.\+cpp\item 
E\+:/opentoonz/toonz/sources/stdfx/backlitfx.\+cpp\end{DoxyCompactItemize}
