\hypertarget{class_script_engine}{}\doxysection{Script\+Engine Class Reference}
\label{class_script_engine}\index{ScriptEngine@{ScriptEngine}}
Inheritance diagram for Script\+Engine\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_script_engine}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{class_script_engine_1_1_executor}{Executor}}
\item 
class \mbox{\hyperlink{class_script_engine_1_1_main_thread_evaluation_data}{Main\+Thread\+Evaluation\+Data}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum {\bfseries Output\+Type} \{ \newline
{\bfseries Simple\+Text}
, {\bfseries Warning}
, {\bfseries Execution\+Error}
, {\bfseries Syntax\+Error}
, \newline
{\bfseries Evaluation\+Result}
, {\bfseries Undefined\+Evaluation\+Result}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Signals}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_script_engine_a8aa6d75d3cff27f3d5f183819f8425bd}\label{class_script_engine_a8aa6d75d3cff27f3d5f183819f8425bd}} 
void {\bfseries evaluation\+Done} ()
\item 
\mbox{\Hypertarget{class_script_engine_aa2db4a3e5a999bf4a191b1a17141a8d4}\label{class_script_engine_aa2db4a3e5a999bf4a191b1a17141a8d4}} 
void {\bfseries output} (int type, const QString \&)
\item 
\mbox{\Hypertarget{class_script_engine_a210a5293c9093f079e2d585b617e908a}\label{class_script_engine_a210a5293c9093f079e2d585b617e908a}} 
void {\bfseries main\+Thread\+Evaluation\+Posted} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_script_engine_a57bbd0ee87dd76f7ee4efdd9ee1a5306}{evaluate}} (const QString \&cmd)
\item 
void \mbox{\hyperlink{class_script_engine_a94196019c8652a5822051c05ea16cb62}{interrupt}} ()
\item 
bool \mbox{\hyperlink{class_script_engine_a07987e4d990091b6400acfc59466d48e}{is\+Evaluating}} () const
\item 
bool \mbox{\hyperlink{class_script_engine_a2c4c493a62c21e29bd1c60ddd0d7cbaa}{wait}} (unsigned long time=ULONG\+\_\+\+MAX)
\item 
void \mbox{\hyperlink{class_script_engine_aff8208595bfaa6077cff84df55ee2e20}{emit\+Output}} (Output\+Type type, const QString \&value)
\item 
const QScript\+Value \& \mbox{\hyperlink{class_script_engine_a11a515e523d794be486fe955db706174}{evaluate\+On\+Main\+Thread}} (const QScript\+Value \&fun, const QScript\+Value \&arguments)
\item 
QScript\+Engine $\ast$ \mbox{\hyperlink{class_script_engine_a3bf6152beec997353d99f783c6d2e353}{get\+QScript\+Engine}} () const
\item 
const QScript\+Value \& \mbox{\hyperlink{class_script_engine_a6a783a8cecd173756c5b402a177e1644}{void\+Value}} () const
\end{DoxyCompactItemize}
\doxysubsection*{Protected Slots}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_script_engine_ab5bb5279d7efd48f3f6cc6c40656c9e8}{on\+Terminated}} ()
\item 
void \mbox{\hyperlink{class_script_engine_a1d8e72ba59c14e1e4796195c721b3c91}{on\+Main\+Thread\+Evaluation\+Posted}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Friends}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{class_script_engine_a763b2f90bc53f92d680a635fe28e858e}{Executor}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Member Enumeration Documentation}
\mbox{\Hypertarget{class_script_engine_a5ae7e29bd0071f6fae64d50514828643}\label{class_script_engine_a5ae7e29bd0071f6fae64d50514828643}} 
\index{ScriptEngine@{ScriptEngine}!OutputType@{OutputType}}
\index{OutputType@{OutputType}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{OutputType}{OutputType}}
{\footnotesize\ttfamily enum Script\+Engine\+::\+Output\+Type}


\begin{DoxyCode}{0}
\DoxyCodeLine{00053                   \{}
\DoxyCodeLine{00054     SimpleText,}
\DoxyCodeLine{00055     Warning,}
\DoxyCodeLine{00056     ExecutionError,}
\DoxyCodeLine{00057     SyntaxError,}
\DoxyCodeLine{00058     EvaluationResult,}
\DoxyCodeLine{00059     UndefinedEvaluationResult}
\DoxyCodeLine{00060   \};}

\end{DoxyCode}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_script_engine_ac3bda202e2182cd688bb2c491a2737fb}\label{class_script_engine_ac3bda202e2182cd688bb2c491a2737fb}} 
\index{ScriptEngine@{ScriptEngine}!ScriptEngine@{ScriptEngine}}
\index{ScriptEngine@{ScriptEngine}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{ScriptEngine()}{ScriptEngine()}}
{\footnotesize\ttfamily Script\+Engine\+::\+Script\+Engine (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00180                            : m\_executor(0), m\_engine(\textcolor{keyword}{new} QScriptEngine()) \{}
\DoxyCodeLine{00181   \textcolor{comment}{// I must call TRenderer::initialize(), because a script could cause a}}
\DoxyCodeLine{00182   \textcolor{comment}{// rendering driven by a working thread}}
\DoxyCodeLine{00183   TRenderer::initialize();}
\DoxyCodeLine{00184 }
\DoxyCodeLine{00185   m\_mainThreadEvaluationData = \textcolor{keyword}{new} MainThreadEvaluationData();}
\DoxyCodeLine{00186   QScriptValue global        = m\_engine-\/>globalObject();}
\DoxyCodeLine{00187   QScriptValue ctor;}
\DoxyCodeLine{00188 }
\DoxyCodeLine{00189   QScriptEngine \&engine = *m\_engine;}
\DoxyCodeLine{00190 }
\DoxyCodeLine{00191   defineFunction(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}print"{}}, printFunction);}
\DoxyCodeLine{00192   defineFunction(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}warning"{}}, warningFunction);}
\DoxyCodeLine{00193   defineFunction(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}run"{}}, runFunction);}
\DoxyCodeLine{00194 }
\DoxyCodeLine{00195   \textcolor{comment}{/*}}
\DoxyCodeLine{00196 \textcolor{comment}{QScriptValue print = engine.newFunction(printFunction);}}
\DoxyCodeLine{00197 \textcolor{comment}{print.setData(engine.newQObject(this));}}
\DoxyCodeLine{00198 \textcolor{comment}{engine.globalObject().setProperty("{}print"{}, print);}}
\DoxyCodeLine{00199 \textcolor{comment}{}}
\DoxyCodeLine{00200 \textcolor{comment}{QScriptValue print = engine.newFunction(printFunction);}}
\DoxyCodeLine{00201 \textcolor{comment}{print.setData(engine.newQObject(this));}}
\DoxyCodeLine{00202 \textcolor{comment}{engine.globalObject().setProperty("{}print"{}, print);}}
\DoxyCodeLine{00203 \textcolor{comment}{}}
\DoxyCodeLine{00204 \textcolor{comment}{QScriptValue run = engine.newFunction(runFunction);}}
\DoxyCodeLine{00205 \textcolor{comment}{run.setData(engine.newQObject(this));}}
\DoxyCodeLine{00206 \textcolor{comment}{engine.globalObject().setProperty("{}run"{}, run);}}
\DoxyCodeLine{00207 \textcolor{comment}{}}
\DoxyCodeLine{00208 \textcolor{comment}{*/}}
\DoxyCodeLine{00209   \textcolor{comment}{// QScriptValue g = engine.newFunction(glub);}}
\DoxyCodeLine{00210   \textcolor{comment}{// g.setData(engine.newQObject(this));}}
\DoxyCodeLine{00211   \textcolor{comment}{// engine.globalObject().setProperty("{}glub"{}, g);}}
\DoxyCodeLine{00212 }
\DoxyCodeLine{00213   \textcolor{comment}{// engine.globalObject().setProperty("{}\_engine"{}, engine.newQObject(this));}}
\DoxyCodeLine{00214 }
\DoxyCodeLine{00215   m\_voidValue  = \textcolor{keyword}{new} QScriptValue();}
\DoxyCodeLine{00216   *m\_voidValue = engine.newQObject(\textcolor{keyword}{new} \mbox{\hyperlink{class_t_script_binding_1_1_void}{TScriptBinding::Void}}(),}
\DoxyCodeLine{00217                                    QScriptEngine::AutoOwnership);}
\DoxyCodeLine{00218 }
\DoxyCodeLine{00219   engine.globalObject().setProperty(\textcolor{stringliteral}{"{}void"{}}, *m\_voidValue);}
\DoxyCodeLine{00220 }
\DoxyCodeLine{00221   TScriptBinding::bindAll(engine);}
\DoxyCodeLine{00222   \textcolor{keywordtype}{bool} ret = connect(\textcolor{keyword}{this}, SIGNAL(mainThreadEvaluationPosted()), \textcolor{keyword}{this},}
\DoxyCodeLine{00223                      SLOT(onMainThreadEvaluationPosted()));}
\DoxyCodeLine{00224   assert(ret);}
\DoxyCodeLine{00225 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_script_engine_a6e7f804ad987ed0408b60cfa03850114}\label{class_script_engine_a6e7f804ad987ed0408b60cfa03850114}} 
\index{ScriptEngine@{ScriptEngine}!````~ScriptEngine@{$\sim$ScriptEngine}}
\index{````~ScriptEngine@{$\sim$ScriptEngine}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{$\sim$ScriptEngine()}{~ScriptEngine()}}
{\footnotesize\ttfamily Script\+Engine\+::$\sim$\+Script\+Engine (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00227                             \{}
\DoxyCodeLine{00228   \textcolor{keyword}{delete} m\_mainThreadEvaluationData;}
\DoxyCodeLine{00229   \textcolor{keyword}{delete} m\_voidValue;}
\DoxyCodeLine{00230 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_script_engine_aff8208595bfaa6077cff84df55ee2e20}\label{class_script_engine_aff8208595bfaa6077cff84df55ee2e20}} 
\index{ScriptEngine@{ScriptEngine}!emitOutput@{emitOutput}}
\index{emitOutput@{emitOutput}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{emitOutput()}{emitOutput()}}
{\footnotesize\ttfamily void Script\+Engine\+::emit\+Output (\begin{DoxyParamCaption}\item[{Output\+Type}]{type,  }\item[{const QString \&}]{value }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00061                                                          \{}
\DoxyCodeLine{00062     emit output((\textcolor{keywordtype}{int})type, value);}
\DoxyCodeLine{00063   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_script_engine_a57bbd0ee87dd76f7ee4efdd9ee1a5306}\label{class_script_engine_a57bbd0ee87dd76f7ee4efdd9ee1a5306}} 
\index{ScriptEngine@{ScriptEngine}!evaluate@{evaluate}}
\index{evaluate@{evaluate}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{evaluate()}{evaluate()}}
{\footnotesize\ttfamily void Script\+Engine\+::evaluate (\begin{DoxyParamCaption}\item[{const QString \&}]{cmd }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00252                                               \{}
\DoxyCodeLine{00253   \textcolor{keywordflow}{if} (m\_executor) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00254   m\_executor = \textcolor{keyword}{new} Executor(\textcolor{keyword}{this}, cmd);}
\DoxyCodeLine{00255   connect(m\_executor, SIGNAL(finished()), \textcolor{keyword}{this}, SLOT(onTerminated()));}
\DoxyCodeLine{00256   m\_executor-\/>start();}
\DoxyCodeLine{00257 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_script_engine_a11a515e523d794be486fe955db706174}\label{class_script_engine_a11a515e523d794be486fe955db706174}} 
\index{ScriptEngine@{ScriptEngine}!evaluateOnMainThread@{evaluateOnMainThread}}
\index{evaluateOnMainThread@{evaluateOnMainThread}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{evaluateOnMainThread()}{evaluateOnMainThread()}}
{\footnotesize\ttfamily const QScript\+Value \& Script\+Engine\+::evaluate\+On\+Main\+Thread (\begin{DoxyParamCaption}\item[{const QScript\+Value \&}]{fun,  }\item[{const QScript\+Value \&}]{arguments }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00233                                                             \{}
\DoxyCodeLine{00234   MainThreadEvaluationData *d = m\_mainThreadEvaluationData;}
\DoxyCodeLine{00235   QMutexLocker locker(\&d-\/>m\_mutex);}
\DoxyCodeLine{00236   d-\/>m\_fun    = fun;}
\DoxyCodeLine{00237   d-\/>m\_args   = arguments;}
\DoxyCodeLine{00238   d-\/>m\_result = QScriptValue();}
\DoxyCodeLine{00239   emit mainThreadEvaluationPosted();}
\DoxyCodeLine{00240   d-\/>m\_cond.wait(\&d-\/>m\_mutex);}
\DoxyCodeLine{00241   \textcolor{keywordflow}{return} d-\/>m\_result;}
\DoxyCodeLine{00242 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_script_engine_a3bf6152beec997353d99f783c6d2e353}\label{class_script_engine_a3bf6152beec997353d99f783c6d2e353}} 
\index{ScriptEngine@{ScriptEngine}!getQScriptEngine@{getQScriptEngine}}
\index{getQScriptEngine@{getQScriptEngine}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{getQScriptEngine()}{getQScriptEngine()}}
{\footnotesize\ttfamily QScript\+Engine $\ast$ Script\+Engine\+::get\+QScript\+Engine (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00068 \{ \textcolor{keywordflow}{return} m\_engine; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_script_engine_a94196019c8652a5822051c05ea16cb62}\label{class_script_engine_a94196019c8652a5822051c05ea16cb62}} 
\index{ScriptEngine@{ScriptEngine}!interrupt@{interrupt}}
\index{interrupt@{interrupt}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{interrupt()}{interrupt()}}
{\footnotesize\ttfamily void Script\+Engine\+::interrupt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00265 \{ m\_engine-\/>abortEvaluation(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_script_engine_a07987e4d990091b6400acfc59466d48e}\label{class_script_engine_a07987e4d990091b6400acfc59466d48e}} 
\index{ScriptEngine@{ScriptEngine}!isEvaluating@{isEvaluating}}
\index{isEvaluating@{isEvaluating}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{isEvaluating()}{isEvaluating()}}
{\footnotesize\ttfamily bool Script\+Engine\+::is\+Evaluating (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00263 \{ \textcolor{keywordflow}{return} m\_engine-\/>isEvaluating(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_script_engine_a1d8e72ba59c14e1e4796195c721b3c91}\label{class_script_engine_a1d8e72ba59c14e1e4796195c721b3c91}} 
\index{ScriptEngine@{ScriptEngine}!onMainThreadEvaluationPosted@{onMainThreadEvaluationPosted}}
\index{onMainThreadEvaluationPosted@{onMainThreadEvaluationPosted}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{onMainThreadEvaluationPosted}{onMainThreadEvaluationPosted}}
{\footnotesize\ttfamily void Script\+Engine\+::on\+Main\+Thread\+Evaluation\+Posted (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00244                                                 \{}
\DoxyCodeLine{00245   Q\_ASSERT(qApp \&\& qApp-\/>thread() == QThread::currentThread());}
\DoxyCodeLine{00246   MainThreadEvaluationData *d = m\_mainThreadEvaluationData;}
\DoxyCodeLine{00247   QMutexLocker locker(\&d-\/>m\_mutex);}
\DoxyCodeLine{00248   d-\/>m\_result = d-\/>m\_fun.call(d-\/>m\_fun, d-\/>m\_args);}
\DoxyCodeLine{00249   d-\/>m\_cond.wakeOne();}
\DoxyCodeLine{00250 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_script_engine_ab5bb5279d7efd48f3f6cc6c40656c9e8}\label{class_script_engine_ab5bb5279d7efd48f3f6cc6c40656c9e8}} 
\index{ScriptEngine@{ScriptEngine}!onTerminated@{onTerminated}}
\index{onTerminated@{onTerminated}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{onTerminated}{onTerminated}}
{\footnotesize\ttfamily void Script\+Engine\+::on\+Terminated (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00267                                 \{}
\DoxyCodeLine{00268   emit evaluationDone();}
\DoxyCodeLine{00269   \textcolor{keyword}{delete} m\_executor;}
\DoxyCodeLine{00270   m\_executor = 0;}
\DoxyCodeLine{00271 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_script_engine_a6a783a8cecd173756c5b402a177e1644}\label{class_script_engine_a6a783a8cecd173756c5b402a177e1644}} 
\index{ScriptEngine@{ScriptEngine}!voidValue@{voidValue}}
\index{voidValue@{voidValue}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{voidValue()}{voidValue()}}
{\footnotesize\ttfamily const QScript\+Value \& Script\+Engine\+::void\+Value (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00069 \{ \textcolor{keywordflow}{return} *m\_voidValue; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_script_engine_a2c4c493a62c21e29bd1c60ddd0d7cbaa}\label{class_script_engine_a2c4c493a62c21e29bd1c60ddd0d7cbaa}} 
\index{ScriptEngine@{ScriptEngine}!wait@{wait}}
\index{wait@{wait}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{wait()}{wait()}}
{\footnotesize\ttfamily bool Script\+Engine\+::wait (\begin{DoxyParamCaption}\item[{unsigned long}]{time = {\ttfamily ULONG\+\_\+MAX} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00259                                           \{}
\DoxyCodeLine{00260   \textcolor{keywordflow}{return} !m\_executor || m\_executor-\/>wait(time);}
\DoxyCodeLine{00261 \}}

\end{DoxyCode}


\doxysubsection{Friends And Related Function Documentation}
\mbox{\Hypertarget{class_script_engine_a763b2f90bc53f92d680a635fe28e858e}\label{class_script_engine_a763b2f90bc53f92d680a635fe28e858e}} 
\index{ScriptEngine@{ScriptEngine}!Executor@{Executor}}
\index{Executor@{Executor}!ScriptEngine@{ScriptEngine}}
\doxysubsubsection{\texorpdfstring{Executor}{Executor}}
{\footnotesize\ttfamily friend class \mbox{\hyperlink{class_script_engine_1_1_executor}{Executor}}\hspace{0.3cm}{\ttfamily [friend]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/toonz/scriptengine.\+h\item 
E\+:/opentoonz/toonz/sources/toonzlib/scriptengine.\+cpp\end{DoxyCompactItemize}
