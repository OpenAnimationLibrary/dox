\hypertarget{class_normal_line_fill_tool}{}\doxysection{Normal\+Line\+Fill\+Tool Class Reference}
\label{class_normal_line_fill_tool}\index{NormalLineFillTool@{NormalLineFillTool}}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_normal_line_fill_tool_ac108526827cdb7a3a1cdc5e19148362f}{Normal\+Line\+Fill\+Tool}} (\mbox{\hyperlink{class_t_tool}{TTool}} $\ast$parent)
\item 
void \mbox{\hyperlink{class_normal_line_fill_tool_adfe6fcb427bd6529b816ef64e891ec4e}{init}} ()
\item 
void \mbox{\hyperlink{class_normal_line_fill_tool_a73819ae1ab778da4e90eabcd85592429}{left\+Button\+Down}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e)
\item 
void \mbox{\hyperlink{class_normal_line_fill_tool_a6d78edd9614254ebde30dac5dfb97e61}{left\+Button\+Drag}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e)
\item 
void \mbox{\hyperlink{class_normal_line_fill_tool_ab4720751c50de1b37b7a8280cb833a8d}{left\+Button\+Up}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e, \mbox{\hyperlink{class_t_image}{TImage}} $\ast$img, \mbox{\hyperlink{class_fill_parameters}{Fill\+Parameters}} \&params)
\item 
void \mbox{\hyperlink{class_normal_line_fill_tool_a2467515de38e7f7a49a32032f5095b7c}{draw}} ()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{class_normal_line_fill_tool}{Normal\+Line\+Fill\+Tool}} マウスドラッグで直線を延ばし、その直線がまたいだ点を\+Fill\+Lineするツール。 Raster -\/ Normal -\/ Line Fillツール（\+Frame\+Rangeなし）のとき使用可能にする 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_normal_line_fill_tool_ac108526827cdb7a3a1cdc5e19148362f}\label{class_normal_line_fill_tool_ac108526827cdb7a3a1cdc5e19148362f}} 
\index{NormalLineFillTool@{NormalLineFillTool}!NormalLineFillTool@{NormalLineFillTool}}
\index{NormalLineFillTool@{NormalLineFillTool}!NormalLineFillTool@{NormalLineFillTool}}
\doxysubsubsection{\texorpdfstring{NormalLineFillTool()}{NormalLineFillTool()}}
{\footnotesize\ttfamily Normal\+Line\+Fill\+Tool\+::\+Normal\+Line\+Fill\+Tool (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tool}{TTool}} $\ast$}]{parent }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01603       : m\_parent(parent), m\_isEditing(\textcolor{keyword}{false}), m\_mousePosition() \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_normal_line_fill_tool_a2467515de38e7f7a49a32032f5095b7c}\label{class_normal_line_fill_tool_a2467515de38e7f7a49a32032f5095b7c}} 
\index{NormalLineFillTool@{NormalLineFillTool}!draw@{draw}}
\index{draw@{draw}!NormalLineFillTool@{NormalLineFillTool}}
\doxysubsubsection{\texorpdfstring{draw()}{draw()}}
{\footnotesize\ttfamily void Normal\+Line\+Fill\+Tool\+::draw (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01702               \{}
\DoxyCodeLine{01703     \textcolor{keywordflow}{if} (m\_isEditing) \{}
\DoxyCodeLine{01704       tglColor(TPixel32::Red);}
\DoxyCodeLine{01705       glBegin(GL\_LINE\_STRIP);}
\DoxyCodeLine{01706       tglVertex(m\_startPosition);}
\DoxyCodeLine{01707       tglVertex(m\_mousePosition);}
\DoxyCodeLine{01708       glEnd();}
\DoxyCodeLine{01709     \}}
\DoxyCodeLine{01710   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_normal_line_fill_tool_adfe6fcb427bd6529b816ef64e891ec4e}\label{class_normal_line_fill_tool_adfe6fcb427bd6529b816ef64e891ec4e}} 
\index{NormalLineFillTool@{NormalLineFillTool}!init@{init}}
\index{init@{init}!NormalLineFillTool@{NormalLineFillTool}}
\doxysubsubsection{\texorpdfstring{init()}{init()}}
{\footnotesize\ttfamily void Normal\+Line\+Fill\+Tool\+::init (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01606               \{}
\DoxyCodeLine{01607     m\_startPosition = \mbox{\hyperlink{class_t_point_t}{TPointD}}();}
\DoxyCodeLine{01608     m\_mousePosition = \mbox{\hyperlink{class_t_point_t}{TPointD}}();}
\DoxyCodeLine{01609     m\_isEditing     = \textcolor{keyword}{false};}
\DoxyCodeLine{01610   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_normal_line_fill_tool_a73819ae1ab778da4e90eabcd85592429}\label{class_normal_line_fill_tool_a73819ae1ab778da4e90eabcd85592429}} 
\index{NormalLineFillTool@{NormalLineFillTool}!leftButtonDown@{leftButtonDown}}
\index{leftButtonDown@{leftButtonDown}!NormalLineFillTool@{NormalLineFillTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDown()}{leftButtonDown()}}
{\footnotesize\ttfamily void Normal\+Line\+Fill\+Tool\+::left\+Button\+Down (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01612                                                                 \{}
\DoxyCodeLine{01613     m\_startPosition = pos; \textcolor{comment}{/*-\/始点-\/*/}}
\DoxyCodeLine{01614     m\_mousePosition = pos; \textcolor{comment}{/*-\/終点-\/*/}}
\DoxyCodeLine{01615 }
\DoxyCodeLine{01616     m\_isEditing = \textcolor{keyword}{true};}
\DoxyCodeLine{01617   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_normal_line_fill_tool_a6d78edd9614254ebde30dac5dfb97e61}\label{class_normal_line_fill_tool_a6d78edd9614254ebde30dac5dfb97e61}} 
\index{NormalLineFillTool@{NormalLineFillTool}!leftButtonDrag@{leftButtonDrag}}
\index{leftButtonDrag@{leftButtonDrag}!NormalLineFillTool@{NormalLineFillTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDrag()}{leftButtonDrag()}}
{\footnotesize\ttfamily void Normal\+Line\+Fill\+Tool\+::left\+Button\+Drag (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01619                                                                 \{}
\DoxyCodeLine{01620     \textcolor{keywordflow}{if} (!m\_isEditing) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01621 }
\DoxyCodeLine{01622     m\_mousePosition = pos;}
\DoxyCodeLine{01623     m\_parent-\/>\mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{01624   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_normal_line_fill_tool_ab4720751c50de1b37b7a8280cb833a8d}\label{class_normal_line_fill_tool_ab4720751c50de1b37b7a8280cb833a8d}} 
\index{NormalLineFillTool@{NormalLineFillTool}!leftButtonUp@{leftButtonUp}}
\index{leftButtonUp@{leftButtonUp}!NormalLineFillTool@{NormalLineFillTool}}
\doxysubsubsection{\texorpdfstring{leftButtonUp()}{leftButtonUp()}}
{\footnotesize\ttfamily void Normal\+Line\+Fill\+Tool\+::left\+Button\+Up (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e,  }\item[{\mbox{\hyperlink{class_t_image}{TImage}} $\ast$}]{img,  }\item[{\mbox{\hyperlink{class_fill_parameters}{Fill\+Parameters}} \&}]{params }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01627                                             \{}
\DoxyCodeLine{01628     \textcolor{keywordflow}{if} (!m\_isEditing) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01629 }
\DoxyCodeLine{01630     m\_mousePosition = pos;}
\DoxyCodeLine{01631 }
\DoxyCodeLine{01632     \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{01633     \textcolor{keywordflow}{if} (!app) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01634 }
\DoxyCodeLine{01635     \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *xl       = app-\/>getCurrentLevel()-\/>getLevel();}
\DoxyCodeLine{01636     \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl = xl ? xl-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}() : 0;}
\DoxyCodeLine{01637 }
\DoxyCodeLine{01638     \mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}} ti = \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}}(m\_parent-\/>\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true}));}
\DoxyCodeLine{01639     \textcolor{keywordflow}{if} (!ti) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01640     \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} ras = ti-\/>getRaster();}
\DoxyCodeLine{01641     \textcolor{keywordflow}{if} (!ras) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01642     \textcolor{keywordtype}{int} styleId = params.m\_styleId;}
\DoxyCodeLine{01643 }
\DoxyCodeLine{01644     \textcolor{comment}{/*-\/-\/-\/ 線分上にある全ての点でdoFillを行う -\/-\/-\/*/}}
\DoxyCodeLine{01645     \textcolor{keywordtype}{double} dx = m\_mousePosition.x -\/ m\_startPosition.x;}
\DoxyCodeLine{01646     \textcolor{keywordtype}{double} dy = m\_mousePosition.y -\/ m\_startPosition.y;}
\DoxyCodeLine{01647     \textcolor{keywordflow}{if} (std::abs(dx) > std::abs(dy)) \textcolor{comment}{/*-\/-\/ 横長の線分の場合 -\/-\/*/}}
\DoxyCodeLine{01648     \{}
\DoxyCodeLine{01649       \textcolor{keywordtype}{double} k = dy / dx; \textcolor{comment}{/*-\/-\/ 直線の傾き -\/-\/*/}}
\DoxyCodeLine{01650       \textcolor{comment}{/*-\/-\/-\/ roundでは負値のときにうまく繋がらない -\/-\/-\/*/}}
\DoxyCodeLine{01651       \textcolor{keywordtype}{int} start      = std::min((\textcolor{keywordtype}{int})floor(m\_startPosition.x + 0.5),}
\DoxyCodeLine{01652                            (\textcolor{keywordtype}{int})floor(m\_mousePosition.x + 0.5));}
\DoxyCodeLine{01653       \textcolor{keywordtype}{int} end        = std::max((\textcolor{keywordtype}{int})floor(m\_startPosition.x + 0.5),}
\DoxyCodeLine{01654                          (\textcolor{keywordtype}{int})floor(m\_mousePosition.x + 0.5));}
\DoxyCodeLine{01655       \textcolor{keywordtype}{double} start\_x = (m\_startPosition.x < m\_mousePosition.x)}
\DoxyCodeLine{01656                            ? m\_startPosition.x}
\DoxyCodeLine{01657                            : m\_mousePosition.x;}
\DoxyCodeLine{01658       \textcolor{keywordtype}{double} start\_y = (m\_startPosition.x < m\_mousePosition.x)}
\DoxyCodeLine{01659                            ? m\_startPosition.y}
\DoxyCodeLine{01660                            : m\_mousePosition.y;}
\DoxyCodeLine{01661       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = start; x <= end; x++) \{}
\DoxyCodeLine{01662         \textcolor{keywordtype}{double} ddx = (double)(x -\/ start);}
\DoxyCodeLine{01663         \mbox{\hyperlink{class_t_point_t}{TPointD}} tmpPos(start\_x + ddx, ddx * k + start\_y);}
\DoxyCodeLine{01664         \mbox{\hyperlink{class_t_point_t}{TPoint}} ipos((\textcolor{keywordtype}{int})(tmpPos.x + ras-\/>getLx() / 2),}
\DoxyCodeLine{01665                     (\textcolor{keywordtype}{int})(tmpPos.y + ras-\/>getLy() / 2));}
\DoxyCodeLine{01666         \textcolor{keywordflow}{if} (!ras-\/>getBounds().contains(ipos)) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01667         \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} pix = ras-\/>pixels(ipos.y)[ipos.x];}
\DoxyCodeLine{01668         \textcolor{keywordflow}{if} (pix.getInk() == styleId || pix.isPurePaint()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01669         doFill(img, tmpPos, params, e.isShiftPressed(), sl,}
\DoxyCodeLine{01670                m\_parent-\/>\mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}(), \textcolor{keyword}{true});}
\DoxyCodeLine{01671       \}}
\DoxyCodeLine{01672     \} \textcolor{keywordflow}{else} \textcolor{comment}{/*-\/-\/ 縦長の線分の場合 -\/-\/*/}}
\DoxyCodeLine{01673     \{}
\DoxyCodeLine{01674       \textcolor{keywordtype}{double} k = dx / dy; \textcolor{comment}{/*-\/-\/ 直線の傾き -\/-\/*/}}
\DoxyCodeLine{01675       \textcolor{comment}{/*-\/-\/-\/ roundでは負値のときにうまく繋がらない -\/-\/-\/*/}}
\DoxyCodeLine{01676       \textcolor{keywordtype}{int} start      = std::min((\textcolor{keywordtype}{int})floor(m\_startPosition.y + 0.5),}
\DoxyCodeLine{01677                            (\textcolor{keywordtype}{int})floor(m\_mousePosition.y + 0.5));}
\DoxyCodeLine{01678       \textcolor{keywordtype}{int} end        = std::max((\textcolor{keywordtype}{int})floor(m\_startPosition.y + 0.5),}
\DoxyCodeLine{01679                          (\textcolor{keywordtype}{int})floor(m\_mousePosition.y + 0.5));}
\DoxyCodeLine{01680       \textcolor{keywordtype}{double} start\_x = (m\_startPosition.y < m\_mousePosition.y)}
\DoxyCodeLine{01681                            ? m\_startPosition.x}
\DoxyCodeLine{01682                            : m\_mousePosition.x;}
\DoxyCodeLine{01683       \textcolor{keywordtype}{double} start\_y = (m\_startPosition.y < m\_mousePosition.y)}
\DoxyCodeLine{01684                            ? m\_startPosition.y}
\DoxyCodeLine{01685                            : m\_mousePosition.y;}
\DoxyCodeLine{01686       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = start; y <= end; y++) \{}
\DoxyCodeLine{01687         \textcolor{keywordtype}{double} ddy = (double)(y -\/ start);}
\DoxyCodeLine{01688         \mbox{\hyperlink{class_t_point_t}{TPointD}} tmpPos(ddy * k + start\_x, ddy + start\_y);}
\DoxyCodeLine{01689         \mbox{\hyperlink{class_t_point_t}{TPoint}} ipos((\textcolor{keywordtype}{int})(tmpPos.x + ras-\/>getLx() / 2),}
\DoxyCodeLine{01690                     (\textcolor{keywordtype}{int})(tmpPos.y + ras-\/>getLy() / 2));}
\DoxyCodeLine{01691         \textcolor{keywordflow}{if} (!ras-\/>getBounds().contains(ipos)) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01692         \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} pix = ras-\/>pixels(ipos.y)[ipos.x];}
\DoxyCodeLine{01693         \textcolor{keywordflow}{if} (pix.getInk() == styleId || pix.isPurePaint()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01694         doFill(img, tmpPos, params, e.isShiftPressed(), sl,}
\DoxyCodeLine{01695                m\_parent-\/>\mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}(), \textcolor{keyword}{true});}
\DoxyCodeLine{01696       \}}
\DoxyCodeLine{01697     \}}
\DoxyCodeLine{01698     m\_isEditing = \textcolor{keyword}{false};}
\DoxyCodeLine{01699     m\_parent-\/>\mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{01700   \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/tnztools/filltool.\+cpp\end{DoxyCompactItemize}
