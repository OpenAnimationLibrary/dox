\hypertarget{class_filmstrip_frame_head_gadget}{}\doxysection{Filmstrip\+Frame\+Head\+Gadget Class Reference}
\label{class_filmstrip_frame_head_gadget}\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
Inheritance diagram for Filmstrip\+Frame\+Head\+Gadget\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_filmstrip_frame_head_gadget}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_filmstrip_frame_head_gadget_ac1d27d0ce3258750b6bdf2482b3cdf20}{Filmstrip\+Frame\+Head\+Gadget}} (\mbox{\hyperlink{class_filmstrip_frames}{Filmstrip\+Frames}} $\ast$filmstrip)
\item 
int \mbox{\hyperlink{class_filmstrip_frame_head_gadget_a593137055ced6e2f5457d617dcdfd30c}{getY}} () const override
\item 
int \mbox{\hyperlink{class_filmstrip_frame_head_gadget_a1e33b91c610b3714d6188a48a5a04ce0}{index2y}} (int index) const override
\item 
int \mbox{\hyperlink{class_filmstrip_frame_head_gadget_ad734d1a4955145dfa1f711f8c1465bf8}{y2index}} (int y) const override
\item 
int \mbox{\hyperlink{class_filmstrip_frame_head_gadget_a2cd69ad4d0bac34598b5535737432f57}{getX}} () const
\item 
int \mbox{\hyperlink{class_filmstrip_frame_head_gadget_a7fab3e051d4e075aba86e35285d4b69c}{index2x}} (int index) const
\item 
int \mbox{\hyperlink{class_filmstrip_frame_head_gadget_a373396e8a1383b41334ef426cf14b5ab}{x2index}} (int y) const
\item 
void \mbox{\hyperlink{class_filmstrip_frame_head_gadget_a59f57878052ada7435a84ae73f7638be}{draw\+Onion\+Skin\+Selection}} (QPainter \&p, const QColor \&light\+Color, const QColor \&dark\+Color) override
\item 
void \mbox{\hyperlink{class_filmstrip_frame_head_gadget_a9d4aaea400b7e73966ae33dd5052b511}{draw\+Shift\+Trace\+Marker}} (QPainter \&p) override
\item 
void \mbox{\hyperlink{class_filmstrip_frame_head_gadget_a4637fce58f30d0b070ea8d761ab9e73f}{set\+Current\+Frame}} (int index) const override
\item 
int \mbox{\hyperlink{class_filmstrip_frame_head_gadget_a1c86be28d87b599cc97a9737dced359c}{get\+Current\+Frame}} () const override
\item 
bool \mbox{\hyperlink{class_filmstrip_frame_head_gadget_ab2aa3d4338c5d3bc8605dc9c6eaeb6ae}{event\+Filter}} (QObject $\ast$obj, QEvent $\ast$event) override
\item 
bool \mbox{\hyperlink{class_filmstrip_frame_head_gadget_ae52133aec5752e5d6713ef8912691029}{shift\+Trace\+Event\+Filter}} (QObject $\ast$obj, QEvent $\ast$event)
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_ac1d27d0ce3258750b6bdf2482b3cdf20}\label{class_filmstrip_frame_head_gadget_ac1d27d0ce3258750b6bdf2482b3cdf20}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{FilmstripFrameHeadGadget()}{FilmstripFrameHeadGadget()}}
{\footnotesize\ttfamily Filmstrip\+Frame\+Head\+Gadget\+::\+Filmstrip\+Frame\+Head\+Gadget (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_filmstrip_frames}{Filmstrip\+Frames}} $\ast$}]{filmstrip }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00297     : m\_filmstrip(filmstrip)}
\DoxyCodeLine{00298     , m\_dy(m\_filmstrip-\/>getIconSize().height() + fs\_frameSpacing +}
\DoxyCodeLine{00299            fs\_iconMarginTop + fs\_iconMarginBottom)}
\DoxyCodeLine{00300     , m\_dx(m\_filmstrip-\/>getIconSize().width() + fs\_frameSpacing +}
\DoxyCodeLine{00301            fs\_leftMargin + fs\_rightMargin + fs\_iconMarginLR)}
\DoxyCodeLine{00302     , m\_highlightedghostFrame(-\/1) \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_a59f57878052ada7435a84ae73f7638be}\label{class_filmstrip_frame_head_gadget_a59f57878052ada7435a84ae73f7638be}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!drawOnionSkinSelection@{drawOnionSkinSelection}}
\index{drawOnionSkinSelection@{drawOnionSkinSelection}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{drawOnionSkinSelection()}{drawOnionSkinSelection()}}
{\footnotesize\ttfamily void Filmstrip\+Frame\+Head\+Gadget\+::draw\+Onion\+Skin\+Selection (\begin{DoxyParamCaption}\item[{QPainter \&}]{p,  }\item[{const QColor \&}]{light\+Color,  }\item[{const QColor \&}]{dark\+Color }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_frame_head_gadget}{Frame\+Head\+Gadget}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00333                                                                                \{}
\DoxyCodeLine{00334   \textcolor{keywordtype}{int} currentRow = getCurrentFrame();}
\DoxyCodeLine{00335 }
\DoxyCodeLine{00336   TPixel frontPixel, backPixel;}
\DoxyCodeLine{00337   \textcolor{keywordtype}{bool} inksOnly;}
\DoxyCodeLine{00338   Preferences::instance()-\/>getOnionData(frontPixel, backPixel, inksOnly);}
\DoxyCodeLine{00339   QColor frontColor((\textcolor{keywordtype}{int})frontPixel.r, (\textcolor{keywordtype}{int})frontPixel.g, (\textcolor{keywordtype}{int})frontPixel.b,}
\DoxyCodeLine{00340                     128);}
\DoxyCodeLine{00341   QColor backColor((\textcolor{keywordtype}{int})backPixel.r, (\textcolor{keywordtype}{int})backPixel.g, (\textcolor{keywordtype}{int})backPixel.b, 128);}
\DoxyCodeLine{00342 }
\DoxyCodeLine{00343   \mbox{\hyperlink{class_onion_skin_mask}{OnionSkinMask}} osMask =}
\DoxyCodeLine{00344       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>getOnionSkinMask();}
\DoxyCodeLine{00345   \textcolor{keywordtype}{int} mosCount = osMask.\mbox{\hyperlink{class_onion_skin_mask_a08b242aaeb38bbb2e1159f56f56242ce}{getMosCount}}();}
\DoxyCodeLine{00346 }
\DoxyCodeLine{00347   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00348   \textcolor{comment}{// OnionSkinの円の左上座標のｙ値}}
\DoxyCodeLine{00349   \textcolor{keywordtype}{int} onionDotYPos = m\_dy / 2 -\/ 5;}
\DoxyCodeLine{00350   \textcolor{keywordtype}{int} onionDotXPos = m\_dx / 2 -\/ 5;}
\DoxyCodeLine{00351 }
\DoxyCodeLine{00352   p.setPen(Qt::red);}
\DoxyCodeLine{00353   \textcolor{comment}{//-\/-\/-\/ OnionSkinが有効なら実線、無効なら点線}}
\DoxyCodeLine{00354   \textcolor{keywordflow}{if} (!osMask.isEnabled()) \{}
\DoxyCodeLine{00355     QPen currentPen = p.pen();}
\DoxyCodeLine{00356     currentPen.setStyle(Qt::DashLine);}
\DoxyCodeLine{00357     currentPen.setColor(QColor(128, 128, 128, 255));}
\DoxyCodeLine{00358     p.setPen(currentPen);}
\DoxyCodeLine{00359   \}}
\DoxyCodeLine{00360   \textcolor{comment}{//カレントフレームにOnionSkinを伸ばすハンドルを描画}}
\DoxyCodeLine{00361   \{}
\DoxyCodeLine{00362     \textcolor{keywordtype}{int} angle180 = 16 * 180;}
\DoxyCodeLine{00363     QRectF handleRect(0, 0, 30, 30);}
\DoxyCodeLine{00364 }
\DoxyCodeLine{00365     \textcolor{comment}{//上向きのハンドル：1フレーム目のときは描画しない}}
\DoxyCodeLine{00366     \textcolor{keywordflow}{if} (currentRow > 0) \{}
\DoxyCodeLine{00367       \textcolor{keywordtype}{int} y0 = index2y(currentRow) -\/ 15;}
\DoxyCodeLine{00368       \textcolor{keywordtype}{int} x0 = index2x(currentRow) -\/ 15;}
\DoxyCodeLine{00369       p.setBrush(QBrush(backColor));}
\DoxyCodeLine{00370       \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00371         p.drawChord(handleRect.translated(0, y0), 0, angle180);}
\DoxyCodeLine{00372       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00373         p.drawChord(handleRect.translated(x0, 0), 16 * 90, angle180);}
\DoxyCodeLine{00374     \}}
\DoxyCodeLine{00375 }
\DoxyCodeLine{00376     \textcolor{comment}{//下向きのハンドル：最終フレームの時は描画しない}}
\DoxyCodeLine{00377     std::vector<TFrameId> fids;}
\DoxyCodeLine{00378     m\_filmstrip-\/>getLevel()-\/>\mbox{\hyperlink{class_t_xsh_simple_level_a567daee4ca12a0e92445bcf98a6541f1}{getFids}}(fids);}
\DoxyCodeLine{00379     \textcolor{keywordtype}{int} frameCount = (int)fids.size();}
\DoxyCodeLine{00380     \textcolor{keywordflow}{if} (currentRow < frameCount -\/ 1) \{}
\DoxyCodeLine{00381       \textcolor{keywordtype}{int} y1 = index2y(currentRow + 1) -\/ 15;}
\DoxyCodeLine{00382       \textcolor{keywordtype}{int} x1 = index2x(currentRow + 1) -\/ 15;}
\DoxyCodeLine{00383       p.setBrush(QBrush(frontColor));}
\DoxyCodeLine{00384 }
\DoxyCodeLine{00385       \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00386         p.drawChord(handleRect.translated(0, y1), angle180, angle180);}
\DoxyCodeLine{00387       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00388         p.drawChord(handleRect.translated(x1, 0), 16 * 90, -\/angle180);}
\DoxyCodeLine{00389     \}}
\DoxyCodeLine{00390 }
\DoxyCodeLine{00391     \textcolor{comment}{//-\/-\/-\/ 動く Onion Skinの描画 その1}}
\DoxyCodeLine{00392     \textcolor{comment}{//先に線を描く}}
\DoxyCodeLine{00393     \textcolor{comment}{//まず OnionSkinの最大／最小値を取得}}
\DoxyCodeLine{00394     \textcolor{keywordtype}{int} minMos = 0;}
\DoxyCodeLine{00395     \textcolor{keywordtype}{int} maxMos = 0;}
\DoxyCodeLine{00396     \textcolor{keywordflow}{for} (i = 0; i < mosCount; i++) \{}
\DoxyCodeLine{00397       \textcolor{keywordtype}{int} mos = osMask.getMos(i);}
\DoxyCodeLine{00398       \textcolor{keywordflow}{if} (minMos > mos) minMos = mos;}
\DoxyCodeLine{00399       \textcolor{keywordflow}{if} (maxMos < mos) maxMos = mos;}
\DoxyCodeLine{00400     \}}
\DoxyCodeLine{00401     p.setBrush(Qt::NoBrush);}
\DoxyCodeLine{00402     \textcolor{comment}{// min/maxが更新されていたら、線を描く}}
\DoxyCodeLine{00403     \textcolor{keywordflow}{if} (minMos < 0)  \textcolor{comment}{//上方向に伸ばす線}}
\DoxyCodeLine{00404     \{}
\DoxyCodeLine{00405       \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical) \{}
\DoxyCodeLine{00406         \textcolor{keywordtype}{int} y0 =}
\DoxyCodeLine{00407             index2y(currentRow + minMos) + onionDotYPos + 10;  \textcolor{comment}{// 10は●の直径}}
\DoxyCodeLine{00408         \textcolor{keywordtype}{int} y1 = index2y(currentRow) -\/ 15;}
\DoxyCodeLine{00409         p.drawLine(15, y0, 15, y1);}
\DoxyCodeLine{00410       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00411         \textcolor{keywordtype}{int} x0 =}
\DoxyCodeLine{00412             index2x(currentRow + minMos) + onionDotXPos + 10;  \textcolor{comment}{// 10は●の直径}}
\DoxyCodeLine{00413         \textcolor{keywordtype}{int} x1 = index2x(currentRow) -\/ 15;}
\DoxyCodeLine{00414         p.drawLine(x0, 15, x1, 15);}
\DoxyCodeLine{00415       \}}
\DoxyCodeLine{00416     \}}
\DoxyCodeLine{00417     \textcolor{keywordflow}{if} (maxMos > 0)  \textcolor{comment}{//下方向に伸ばす線}}
\DoxyCodeLine{00418     \{}
\DoxyCodeLine{00419       \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical) \{}
\DoxyCodeLine{00420         \textcolor{keywordtype}{int} y0 = index2y(currentRow + 1) + 15;}
\DoxyCodeLine{00421         \textcolor{keywordtype}{int} y1 = index2y(currentRow + maxMos) + onionDotYPos;}
\DoxyCodeLine{00422         p.drawLine(15, y0, 15, y1);}
\DoxyCodeLine{00423       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00424         \textcolor{keywordtype}{int} x0 = index2x(currentRow + 1) + 15;}
\DoxyCodeLine{00425         \textcolor{keywordtype}{int} x1 = index2x(currentRow + maxMos) + onionDotXPos;}
\DoxyCodeLine{00426         p.drawLine(x0, 15, x1, 15);}
\DoxyCodeLine{00427       \}}
\DoxyCodeLine{00428     \}}
\DoxyCodeLine{00429   \}}
\DoxyCodeLine{00430 }
\DoxyCodeLine{00431   \textcolor{comment}{//-\/-\/-\/ Fix Onion Skinの描画}}
\DoxyCodeLine{00432   \textcolor{keywordflow}{for} (i = 0; i < osMask.\mbox{\hyperlink{class_onion_skin_mask_a23336c6bb8485bc8105b81347dca27fd}{getFosCount}}(); i++) \{}
\DoxyCodeLine{00433     \textcolor{keywordtype}{int} fos = osMask.getFos(i);}
\DoxyCodeLine{00434     \textcolor{comment}{// if(fos == currentRow) continue;}}
\DoxyCodeLine{00435     \textcolor{keywordtype}{int} y = index2y(fos) + onionDotYPos;}
\DoxyCodeLine{00436     \textcolor{keywordtype}{int} x = index2x(fos) + onionDotXPos;}
\DoxyCodeLine{00437     p.setPen(Qt::red);}
\DoxyCodeLine{00438     \textcolor{comment}{// OnionSkinがDisableなら中空にする}}
\DoxyCodeLine{00439     p.setBrush(osMask.isEnabled() ? QBrush(QColor(0, 255, 255, 128))}
\DoxyCodeLine{00440                                   : Qt::NoBrush);}
\DoxyCodeLine{00441     \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00442       p.drawEllipse(0, y, 10, 10);}
\DoxyCodeLine{00443     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00444       p.drawEllipse(x, 0, 10, 10);}
\DoxyCodeLine{00445   \}}
\DoxyCodeLine{00446   \textcolor{comment}{//-\/-\/-\/}}
\DoxyCodeLine{00447 }
\DoxyCodeLine{00448   \textcolor{comment}{//-\/-\/-\/ 動く Onion Skinの描画 その2}}
\DoxyCodeLine{00449 }
\DoxyCodeLine{00450   \textcolor{comment}{//続いて、各OnionSkinの●を描く}}
\DoxyCodeLine{00451   p.setPen(Qt::red);}
\DoxyCodeLine{00452   \textcolor{keywordflow}{for} (i = 0; i < mosCount; i++) \{}
\DoxyCodeLine{00453     \textcolor{comment}{// mosはOnionSkinの描かれるフレームのオフセット値}}
\DoxyCodeLine{00454     \textcolor{keywordtype}{int} mos = osMask.getMos(i);}
\DoxyCodeLine{00455     \textcolor{comment}{// 100312 iwasawa ハイライトする場合は後で描くのでスキップする}}
\DoxyCodeLine{00456     \textcolor{keywordflow}{if} (currentRow + mos == m\_highlightedMosFrame) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00457 }
\DoxyCodeLine{00458     \textcolor{keywordtype}{int} y = index2y(currentRow + mos) + onionDotYPos;}
\DoxyCodeLine{00459     \textcolor{keywordtype}{int} x = index2x(currentRow + mos) + onionDotXPos;}
\DoxyCodeLine{00460 }
\DoxyCodeLine{00461     p.setBrush(mos < 0 ? backColor : frontColor);}
\DoxyCodeLine{00462 }
\DoxyCodeLine{00463     \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00464       p.drawEllipse(10, y, 10, 10);}
\DoxyCodeLine{00465     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00466       p.drawEllipse(x, 10, 10, 10);}
\DoxyCodeLine{00467   \}}
\DoxyCodeLine{00468 }
\DoxyCodeLine{00469   \textcolor{comment}{// Fix Onion Skin ハイライトの描画}}
\DoxyCodeLine{00470   \textcolor{comment}{// FixOnionSkinがマウスが乗ってハイライトされていて、}}
\DoxyCodeLine{00471   \textcolor{comment}{//かつ 現在のフレームでないときに描画}}
\DoxyCodeLine{00472   \textcolor{keywordflow}{if} (m\_highlightedFosFrame >= 0 \&\& m\_highlightedFosFrame != currentRow) \{}
\DoxyCodeLine{00473     p.setPen(QColor(255, 128, 0));}
\DoxyCodeLine{00474     p.setBrush(QBrush(QColor(255, 255, 0, 200)));}
\DoxyCodeLine{00475     \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00476       p.drawEllipse(0, index2y(m\_highlightedFosFrame) + onionDotYPos, 10, 10);}
\DoxyCodeLine{00477     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00478       p.drawEllipse(index2x(m\_highlightedFosFrame) + onionDotXPos, 0, 10, 10);}
\DoxyCodeLine{00479   \}}
\DoxyCodeLine{00480 }
\DoxyCodeLine{00481   \textcolor{comment}{//通常のOnion Skin ハイライトの描画}}
\DoxyCodeLine{00482   \textcolor{keywordflow}{if} (m\_highlightedMosFrame >= 0 \&\& m\_highlightedMosFrame != currentRow) \{}
\DoxyCodeLine{00483     p.setPen(QColor(255, 128, 0));}
\DoxyCodeLine{00484     p.setBrush(QBrush(QColor(255, 255, 0, 200)));}
\DoxyCodeLine{00485     \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00486       p.drawEllipse(10, index2y(m\_highlightedMosFrame) + onionDotYPos, 10, 10);}
\DoxyCodeLine{00487     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00488       p.drawEllipse(index2x(m\_highlightedMosFrame) + onionDotXPos, 10, 10, 10);}
\DoxyCodeLine{00489   \}}
\DoxyCodeLine{00490 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_a9d4aaea400b7e73966ae33dd5052b511}\label{class_filmstrip_frame_head_gadget_a9d4aaea400b7e73966ae33dd5052b511}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!drawShiftTraceMarker@{drawShiftTraceMarker}}
\index{drawShiftTraceMarker@{drawShiftTraceMarker}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{drawShiftTraceMarker()}{drawShiftTraceMarker()}}
{\footnotesize\ttfamily void Filmstrip\+Frame\+Head\+Gadget\+::draw\+Shift\+Trace\+Marker (\begin{DoxyParamCaption}\item[{QPainter \&}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_frame_head_gadget}{Frame\+Head\+Gadget}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00494                                                                \{}
\DoxyCodeLine{00495   \textcolor{keywordtype}{int} currentRow = getCurrentFrame();}
\DoxyCodeLine{00496 }
\DoxyCodeLine{00497   TPixel frontPixel, backPixel;}
\DoxyCodeLine{00498   \textcolor{keywordtype}{bool} inksOnly;}
\DoxyCodeLine{00499   Preferences::instance()-\/>getOnionData(frontPixel, backPixel, inksOnly);}
\DoxyCodeLine{00500   QColor frontColor((\textcolor{keywordtype}{int})frontPixel.r, (\textcolor{keywordtype}{int})frontPixel.g, (\textcolor{keywordtype}{int})frontPixel.b);}
\DoxyCodeLine{00501   QColor backColor((\textcolor{keywordtype}{int})backPixel.r, (\textcolor{keywordtype}{int})backPixel.g, (\textcolor{keywordtype}{int})backPixel.b);}
\DoxyCodeLine{00502 }
\DoxyCodeLine{00503   \mbox{\hyperlink{class_onion_skin_mask}{OnionSkinMask}} osMask =}
\DoxyCodeLine{00504       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>getOnionSkinMask();}
\DoxyCodeLine{00505 }
\DoxyCodeLine{00506   \textcolor{comment}{// draw lines to ghost frames}}
\DoxyCodeLine{00507   \textcolor{keywordtype}{int} prevOffset    = osMask.getShiftTraceGhostFrameOffset(0);}
\DoxyCodeLine{00508   \textcolor{keywordtype}{int} forwardOffset = osMask.getShiftTraceGhostFrameOffset(1);}
\DoxyCodeLine{00509 }
\DoxyCodeLine{00510   \textcolor{keyword}{const} \textcolor{keywordtype}{int} shiftTraceDotSize    = 12;}
\DoxyCodeLine{00511   \textcolor{keyword}{const} \textcolor{keywordtype}{int} shiftTraceDotXOffset = 3;}
\DoxyCodeLine{00512   \textcolor{keyword}{const} \textcolor{keywordtype}{int} shiftTraceDotYOffset = 3;}
\DoxyCodeLine{00513   \textcolor{keywordtype}{int} dotYPos                    = (m\_dy -\/ shiftTraceDotSize) / 2;}
\DoxyCodeLine{00514   \textcolor{keywordtype}{int} dotXPos                    = (m\_dx -\/ shiftTraceDotSize) / 2;}
\DoxyCodeLine{00515 }
\DoxyCodeLine{00516   \textcolor{keywordflow}{if} (currentRow > 0 \&\& prevOffset < 0)  \textcolor{comment}{// previous ghost}}
\DoxyCodeLine{00517   \{}
\DoxyCodeLine{00518     \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical) \{}
\DoxyCodeLine{00519       p.setPen(backColor);}
\DoxyCodeLine{00520       \textcolor{keywordtype}{int} y0 = index2y(currentRow + prevOffset) + dotYPos + shiftTraceDotSize;}
\DoxyCodeLine{00521       \textcolor{keywordtype}{int} y1 = index2y(currentRow);}
\DoxyCodeLine{00522       p.drawLine(shiftTraceDotXOffset + shiftTraceDotSize / 2, y0,}
\DoxyCodeLine{00523                  shiftTraceDotXOffset + shiftTraceDotSize / 2, y1);}
\DoxyCodeLine{00524     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00525       p.setPen(backColor);}
\DoxyCodeLine{00526       \textcolor{keywordtype}{int} x0 = index2x(currentRow + prevOffset) + dotXPos + shiftTraceDotSize;}
\DoxyCodeLine{00527       \textcolor{keywordtype}{int} x1 = index2x(currentRow);}
\DoxyCodeLine{00528       p.drawLine(x0, shiftTraceDotYOffset + shiftTraceDotSize / 2, x1,}
\DoxyCodeLine{00529                  shiftTraceDotYOffset + shiftTraceDotSize / 2);}
\DoxyCodeLine{00530     \}}
\DoxyCodeLine{00531   \}}
\DoxyCodeLine{00532   \textcolor{keywordflow}{if} (forwardOffset > 0)  \textcolor{comment}{// forward ghost}}
\DoxyCodeLine{00533   \{}
\DoxyCodeLine{00534     \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical) \{}
\DoxyCodeLine{00535       p.setPen(frontColor);}
\DoxyCodeLine{00536       \textcolor{keywordtype}{int} y0 = index2y(currentRow + 1);}
\DoxyCodeLine{00537       \textcolor{keywordtype}{int} y1 =}
\DoxyCodeLine{00538           index2y(currentRow + forwardOffset) + dotYPos + shiftTraceDotSize;}
\DoxyCodeLine{00539       p.drawLine(shiftTraceDotXOffset + shiftTraceDotSize / 2, y0,}
\DoxyCodeLine{00540                  shiftTraceDotXOffset + shiftTraceDotSize / 2, y1);}
\DoxyCodeLine{00541     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00542       p.setPen(frontColor);}
\DoxyCodeLine{00543       \textcolor{keywordtype}{int} x0 = index2x(currentRow + 1);}
\DoxyCodeLine{00544       \textcolor{keywordtype}{int} x1 =}
\DoxyCodeLine{00545           index2x(currentRow + forwardOffset) + dotXPos + shiftTraceDotSize;}
\DoxyCodeLine{00546       p.drawLine(x0, shiftTraceDotYOffset + shiftTraceDotSize / 2, x1,}
\DoxyCodeLine{00547                  shiftTraceDotYOffset + shiftTraceDotSize / 2);}
\DoxyCodeLine{00548     \}}
\DoxyCodeLine{00549   \}}
\DoxyCodeLine{00550   \textcolor{comment}{// draw dots}}
\DoxyCodeLine{00551   std::vector<int> offsVec      = \{prevOffset, 0, forwardOffset\};}
\DoxyCodeLine{00552   std::vector<QColor> colorsVec = \{backColor, QColor(0, 162, 232), frontColor\};}
\DoxyCodeLine{00553   QFont currentFont             = p.font();}
\DoxyCodeLine{00554   QFont tmpFont                 = p.font();}
\DoxyCodeLine{00555   tmpFont.setPointSize(7);}
\DoxyCodeLine{00556   p.setFont(tmpFont);}
\DoxyCodeLine{00557 }
\DoxyCodeLine{00558   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 3; i++) \{}
\DoxyCodeLine{00559     \textcolor{keywordflow}{if} (i != 1 \&\& offsVec[i] == 0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00560     p.setPen(colorsVec[i]);}
\DoxyCodeLine{00561     p.setBrush(Qt::gray);}
\DoxyCodeLine{00562     \textcolor{keywordtype}{int} topPos;}
\DoxyCodeLine{00563     QRect dotRect;}
\DoxyCodeLine{00564     \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical) \{}
\DoxyCodeLine{00565       topPos  = index2y(currentRow + offsVec[i]) + dotYPos;}
\DoxyCodeLine{00566       dotRect = QRect(shiftTraceDotXOffset, topPos, shiftTraceDotSize,}
\DoxyCodeLine{00567                       shiftTraceDotSize);}
\DoxyCodeLine{00568     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00569       topPos  = index2x(currentRow + offsVec[i]) + dotXPos;}
\DoxyCodeLine{00570       dotRect = QRect(topPos, shiftTraceDotYOffset, shiftTraceDotSize,}
\DoxyCodeLine{00571                       shiftTraceDotSize);}
\DoxyCodeLine{00572     \}}
\DoxyCodeLine{00573     p.drawRect(dotRect);}
\DoxyCodeLine{00574 }
\DoxyCodeLine{00575     \textcolor{comment}{// draw shortcut numbers}}
\DoxyCodeLine{00576     p.setPen(Qt::black);}
\DoxyCodeLine{00577     p.drawText(dotRect, Qt::AlignCenter, QString::number(i + 1));}
\DoxyCodeLine{00578   \}}
\DoxyCodeLine{00579   p.setFont(currentFont);}
\DoxyCodeLine{00580 }
\DoxyCodeLine{00581   \textcolor{comment}{// highlight on mouse over}}
\DoxyCodeLine{00582   \textcolor{keywordflow}{if} (m\_highlightedghostFrame >= 0) \{}
\DoxyCodeLine{00583     p.setPen(QColor(255, 255, 0));}
\DoxyCodeLine{00584     p.setBrush(QColor(255, 255, 0, 180));}
\DoxyCodeLine{00585     \textcolor{keywordtype}{int} topPos;}
\DoxyCodeLine{00586     QRect dotRect;}
\DoxyCodeLine{00587     \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical) \{}
\DoxyCodeLine{00588       topPos  = index2y(m\_highlightedghostFrame) + dotYPos;}
\DoxyCodeLine{00589       dotRect = QRect(shiftTraceDotXOffset, topPos, shiftTraceDotSize,}
\DoxyCodeLine{00590                       shiftTraceDotSize);}
\DoxyCodeLine{00591     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00592       topPos  = index2x(m\_highlightedghostFrame) + dotXPos;}
\DoxyCodeLine{00593       dotRect = QRect(topPos, shiftTraceDotYOffset, shiftTraceDotSize,}
\DoxyCodeLine{00594                       shiftTraceDotSize);}
\DoxyCodeLine{00595     \}}
\DoxyCodeLine{00596     p.drawRect(dotRect);}
\DoxyCodeLine{00597   \}}
\DoxyCodeLine{00598 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_ab2aa3d4338c5d3bc8605dc9c6eaeb6ae}\label{class_filmstrip_frame_head_gadget_ab2aa3d4338c5d3bc8605dc9c6eaeb6ae}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!eventFilter@{eventFilter}}
\index{eventFilter@{eventFilter}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{eventFilter()}{eventFilter()}}
{\footnotesize\ttfamily bool Filmstrip\+Frame\+Head\+Gadget\+::event\+Filter (\begin{DoxyParamCaption}\item[{QObject $\ast$}]{obj,  }\item[{QEvent $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00602                                                                   \{}
\DoxyCodeLine{00603   \textcolor{keywordflow}{if} (e-\/>type() != QEvent::MouseButtonPress \&\&}
\DoxyCodeLine{00604       e-\/>type() != QEvent::MouseButtonDblClick \&\&}
\DoxyCodeLine{00605       e-\/>type() != QEvent::MouseMove)}
\DoxyCodeLine{00606     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00607   \textcolor{comment}{// shift \& trace case}}
\DoxyCodeLine{00608   \textcolor{keywordflow}{if} (CommandManager::instance()-\/>getAction(MI\_ShiftTrace)-\/>isChecked())}
\DoxyCodeLine{00609     \textcolor{keywordflow}{return} shiftTraceEventFilter(obj, e);}
\DoxyCodeLine{00610 }
\DoxyCodeLine{00611   \textcolor{keywordflow}{if} (!Preferences::instance()-\/>isOnionSkinEnabled()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00612 }
\DoxyCodeLine{00613   QWidget *viewer = \textcolor{keyword}{dynamic\_cast<}QWidget *\textcolor{keyword}{>}(obj);}
\DoxyCodeLine{00614 }
\DoxyCodeLine{00615   \textcolor{keywordflow}{if} (e-\/>type() == QEvent::MouseButtonPress) \{}
\DoxyCodeLine{00616     \textcolor{comment}{//方針：上下タブをクリック→ドラッグでオニオンスキンの増減}}
\DoxyCodeLine{00617     \textcolor{comment}{//　　　上下タブをダブルクリックでオニオンスキンの表示／非表示}}
\DoxyCodeLine{00618     \textcolor{comment}{//      オニオンスキンの●エリア}}
\DoxyCodeLine{00619     \textcolor{comment}{//をクリックで各フレームのON／OFF切り替え→ドラッグで伸ばせる}}
\DoxyCodeLine{00620     \textcolor{comment}{//      Fixedオニオンスキンの●エリアをクリックで}}
\DoxyCodeLine{00621     \textcolor{comment}{// Fixedオニオンスキンの位置の指定}}
\DoxyCodeLine{00622 }
\DoxyCodeLine{00623     \textcolor{comment}{//-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00624     \textcolor{comment}{//それぞれのパーツの位置Rectの指定。各フレームの右上座標からのオフセットも含む。}}
\DoxyCodeLine{00625     \textcolor{comment}{// OnionSkinの円の左上座標のｙ値}}
\DoxyCodeLine{00626     \textcolor{keywordtype}{int} onionDotYPos = m\_dy / 2 -\/ 5;}
\DoxyCodeLine{00627     \textcolor{keywordtype}{int} onionDotXPos = m\_dx / 2 -\/ 5;}
\DoxyCodeLine{00628     \textcolor{comment}{// OnionSkinの●のRect}}
\DoxyCodeLine{00629     QRect onionDotRect(10, onionDotYPos, 10, 10);}
\DoxyCodeLine{00630     \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00631       onionDotRect = QRect(onionDotXPos, 10, 10, 10);}
\DoxyCodeLine{00632     \textcolor{comment}{// FixedOnionSkinの●のRect}}
\DoxyCodeLine{00633     QRect fixedOnionDotRect(0, onionDotYPos, 10, 10);}
\DoxyCodeLine{00634     \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00635       fixedOnionDotRect = QRect(onionDotXPos, 0, 10, 10);}
\DoxyCodeLine{00636     \textcolor{comment}{//上方向のOnionSkinタブのRect}}
\DoxyCodeLine{00637     QRect backOnionTabRect(0, m\_dy -\/ 15, 30, 15);}
\DoxyCodeLine{00638     \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00639       backOnionTabRect = QRect(m\_dx -\/ 15, 0, 15, 30);}
\DoxyCodeLine{00640     \textcolor{comment}{//下方向のOnionSkinタブのRect}}
\DoxyCodeLine{00641     QRect frontOnionTabRect(0, 0, 30, 15);}
\DoxyCodeLine{00642     \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical) frontOnionTabRect = QRect(0, 0, 15, 30);}
\DoxyCodeLine{00643     \textcolor{comment}{//-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00644 }
\DoxyCodeLine{00645     \textcolor{comment}{//-\/-\/-\/-\/-\/ ハイライト表示、actionのリセット}}
\DoxyCodeLine{00646     m\_action = None;}
\DoxyCodeLine{00647 }
\DoxyCodeLine{00648     \textcolor{comment}{// click}}
\DoxyCodeLine{00649     \textcolor{keywordflow}{if} (m\_highlightedFosFrame >= 0) \{}
\DoxyCodeLine{00650       m\_highlightedFosFrame = -\/1;}
\DoxyCodeLine{00651       viewer-\/>update();}
\DoxyCodeLine{00652     \}}
\DoxyCodeLine{00653     \textcolor{keywordflow}{if} (m\_highlightedMosFrame >= 0) \{}
\DoxyCodeLine{00654       m\_highlightedMosFrame = -\/1;}
\DoxyCodeLine{00655       viewer-\/>update();}
\DoxyCodeLine{00656     \}}
\DoxyCodeLine{00657 }
\DoxyCodeLine{00658     \textcolor{comment}{//-\/-\/-\/-\/-\/ 以下、クリック位置に応じてアクションを変えていく}}
\DoxyCodeLine{00659     \textcolor{comment}{//クリックされたフレームを取得}}
\DoxyCodeLine{00660     QMouseEvent *mouseEvent = \textcolor{keyword}{dynamic\_cast<}QMouseEvent *\textcolor{keyword}{>}(e);}
\DoxyCodeLine{00661     \textcolor{keywordtype}{int} frame               = y2index(mouseEvent-\/>pos().y());}
\DoxyCodeLine{00662     \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical) frame = x2index(mouseEvent-\/>pos().x());}
\DoxyCodeLine{00663     m\_buttonPressCellIndex = frame;}
\DoxyCodeLine{00664     \textcolor{keywordtype}{int} currentFrame       = getCurrentFrame();}
\DoxyCodeLine{00665 }
\DoxyCodeLine{00666     \textcolor{comment}{//各フレーム左上からの位置}}
\DoxyCodeLine{00667     QPoint clickedPos = mouseEvent-\/>pos() + QPoint(0, -\/index2y(frame));}
\DoxyCodeLine{00668     \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00669       clickedPos = mouseEvent-\/>pos() + QPoint(-\/index2x(frame), 0);}
\DoxyCodeLine{00670 }
\DoxyCodeLine{00671     \textcolor{comment}{//カレントフレームの場合、無視}}
\DoxyCodeLine{00672     \textcolor{keywordflow}{if} (frame == currentFrame) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00673     \textcolor{comment}{//カレントフレームの上下でタブをクリックした場合}}
\DoxyCodeLine{00674     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((frame == currentFrame -\/ 1 \&\&}
\DoxyCodeLine{00675               backOnionTabRect.contains(clickedPos)) ||}
\DoxyCodeLine{00676              (frame == currentFrame + 1 \&\&}
\DoxyCodeLine{00677               frontOnionTabRect.contains(clickedPos))) \{}
\DoxyCodeLine{00678       \textcolor{comment}{//ドラッグに備える}}
\DoxyCodeLine{00679       m\_action = ActivateMos;}
\DoxyCodeLine{00680     \}}
\DoxyCodeLine{00681     \textcolor{comment}{//カレントフレーム以外の場合}}
\DoxyCodeLine{00682     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00683       \textcolor{comment}{//通常のOnionSkinの場合}}
\DoxyCodeLine{00684       \textcolor{keywordflow}{if} (onionDotRect.contains(clickedPos)) \{}
\DoxyCodeLine{00685         \textcolor{comment}{// 既にオニオンスキンなら、オフにする}}
\DoxyCodeLine{00686         \textcolor{keywordtype}{bool} on = !isMos(frame);}
\DoxyCodeLine{00687         \textcolor{comment}{//アクションが決まる}}
\DoxyCodeLine{00688         m\_action = on ? ActivateMos : DeactivateMos;}
\DoxyCodeLine{00689         \textcolor{comment}{//カレントフレームでなければ、オニオンスキンを切り替え}}
\DoxyCodeLine{00690         setMos(frame, on);}
\DoxyCodeLine{00691       \}}
\DoxyCodeLine{00692       \textcolor{comment}{// FixedOnionSkinの場合}}
\DoxyCodeLine{00693       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (fixedOnionDotRect.contains(clickedPos)) \{}
\DoxyCodeLine{00694         \textcolor{comment}{// Fos}}
\DoxyCodeLine{00695         \textcolor{keywordtype}{bool} on  = !isFos(frame);}
\DoxyCodeLine{00696         m\_action = on ? ActivateFos : DeactivateFos;}
\DoxyCodeLine{00697         setFos(frame, on);}
\DoxyCodeLine{00698       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00699         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00700     \}}
\DoxyCodeLine{00701     viewer-\/>update();}
\DoxyCodeLine{00702 }
\DoxyCodeLine{00703   \}}
\DoxyCodeLine{00704   \textcolor{comment}{//-\/-\/-\/-\/ 上下タブのダブルクリックで表示/非表示の切り替え}}
\DoxyCodeLine{00705   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (e-\/>type() == QEvent::MouseButtonDblClick) \{}
\DoxyCodeLine{00706     QMouseEvent *mouseEvent = \textcolor{keyword}{dynamic\_cast<}QMouseEvent *\textcolor{keyword}{>}(e);}
\DoxyCodeLine{00707     \textcolor{keywordflow}{if} (mouseEvent-\/>buttons() \& Qt::LeftButton) \{}
\DoxyCodeLine{00708       \textcolor{keywordtype}{int} frame = y2index(mouseEvent-\/>pos().y());}
\DoxyCodeLine{00709       \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical) frame = x2index(mouseEvent-\/>pos().x());}
\DoxyCodeLine{00710       \textcolor{comment}{//各フレーム左上からの位置}}
\DoxyCodeLine{00711       QPoint clickedPos = mouseEvent-\/>pos() + QPoint(0, -\/index2y(frame));}
\DoxyCodeLine{00712       \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00713         clickedPos = mouseEvent-\/>pos() + QPoint(-\/index2x(frame), 0);}
\DoxyCodeLine{00714       \textcolor{comment}{//カレントフレーム}}
\DoxyCodeLine{00715       \textcolor{keywordtype}{int} currentFrame = getCurrentFrame();}
\DoxyCodeLine{00716       \textcolor{comment}{//上方向のOnionSkinタブのRect}}
\DoxyCodeLine{00717       QRect backOnionTabRect(0, m\_dy -\/ 15, 30, 15);}
\DoxyCodeLine{00718       \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00719         backOnionTabRect = QRect(m\_dx -\/ 15, 0, 15, 30);}
\DoxyCodeLine{00720       \textcolor{comment}{//下方向のOnionSkinタブのRect}}
\DoxyCodeLine{00721       QRect frontOnionTabRect(0, 0, 30, 15);}
\DoxyCodeLine{00722       \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical) frontOnionTabRect = QRect(0, 0, 15, 30);}
\DoxyCodeLine{00723       \textcolor{keywordflow}{if} ((currentFrame -\/ 1 == frame \&\&}
\DoxyCodeLine{00724            backOnionTabRect.contains(clickedPos)) ||}
\DoxyCodeLine{00725           (currentFrame + 1 == frame \&\&}
\DoxyCodeLine{00726            frontOnionTabRect.contains(clickedPos))) \{}
\DoxyCodeLine{00727         enableOnionSkin(!isOnionSkinEnabled());}
\DoxyCodeLine{00728         viewer-\/>update();}
\DoxyCodeLine{00729       \}}
\DoxyCodeLine{00730     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00731       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00732   \}}
\DoxyCodeLine{00733   \textcolor{comment}{//-\/-\/-\/-\/}}
\DoxyCodeLine{00734   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (e-\/>type() == QEvent::MouseMove) \{}
\DoxyCodeLine{00735     QMouseEvent *mouseEvent = \textcolor{keyword}{dynamic\_cast<}QMouseEvent *\textcolor{keyword}{>}(e);}
\DoxyCodeLine{00736     \textcolor{keywordtype}{int} frame               = y2index(mouseEvent-\/>pos().y());}
\DoxyCodeLine{00737     \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical) frame = x2index(mouseEvent-\/>pos().x());}
\DoxyCodeLine{00738     \textcolor{comment}{//各フレーム左上からの位置}}
\DoxyCodeLine{00739     QPoint clickedPos = mouseEvent-\/>pos() + QPoint(0, -\/index2y(frame));}
\DoxyCodeLine{00740     \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00741       clickedPos = mouseEvent-\/>pos() + QPoint(-\/index2x(frame), 0);}
\DoxyCodeLine{00742     \textcolor{comment}{//カレントフレーム}}
\DoxyCodeLine{00743     \textcolor{keywordtype}{int} currentFrame = getCurrentFrame();}
\DoxyCodeLine{00744     \textcolor{comment}{//マウスボタンが押されていない場合}}
\DoxyCodeLine{00745     \textcolor{keywordflow}{if} (mouseEvent-\/>buttons() == 0) \{}
\DoxyCodeLine{00746       \textcolor{comment}{//-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00747       \textcolor{comment}{//それぞれのパーツの位置Rectの指定。各フレームの右上座標からのオフセットも含む。}}
\DoxyCodeLine{00748       \textcolor{comment}{// OnionSkinの円の左上座標のｙ値}}
\DoxyCodeLine{00749       \textcolor{keywordtype}{int} onionDotYPos = m\_dy / 2 -\/ 5;}
\DoxyCodeLine{00750       \textcolor{keywordtype}{int} onionDotXPos = m\_dx / 2 -\/ 5;}
\DoxyCodeLine{00751 }
\DoxyCodeLine{00752       QRect onionDotRect(10, onionDotYPos, 10, 10);}
\DoxyCodeLine{00753       \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00754         onionDotRect = QRect(onionDotXPos, 10, 10, 10);}
\DoxyCodeLine{00755       \textcolor{comment}{// FixedOnionSkinの●のRect}}
\DoxyCodeLine{00756       QRect fixedOnionDotRect(0, onionDotYPos, 10, 10);}
\DoxyCodeLine{00757       \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00758         fixedOnionDotRect = QRect(onionDotXPos, 0, 10, 10);}
\DoxyCodeLine{00759       \textcolor{comment}{//上方向のOnionSkinタブのRect}}
\DoxyCodeLine{00760       QRect backOnionTabRect(0, m\_dy -\/ 15, 30, 15);}
\DoxyCodeLine{00761       \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00762         backOnionTabRect = QRect(m\_dx -\/ 15, 0, 15, 30);}
\DoxyCodeLine{00763       \textcolor{comment}{//下方向のOnionSkinタブのRect}}
\DoxyCodeLine{00764       QRect frontOnionTabRect(0, 0, 30, 15);}
\DoxyCodeLine{00765       \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical) frontOnionTabRect = QRect(0, 0, 15, 30);}
\DoxyCodeLine{00766 }
\DoxyCodeLine{00767       \textcolor{comment}{//-\/-\/-\/-\/-\/ Fixed Onion Skin の ハイライト}}
\DoxyCodeLine{00768       \textcolor{keywordtype}{int} highlightedFrame;}
\DoxyCodeLine{00769       \textcolor{keywordflow}{if} (currentFrame != frame \&\& fixedOnionDotRect.contains(clickedPos))}
\DoxyCodeLine{00770         highlightedFrame = frame;}
\DoxyCodeLine{00771       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00772         highlightedFrame = -\/1;}
\DoxyCodeLine{00773       \textcolor{keywordflow}{if} (highlightedFrame != m\_highlightedFosFrame) \{}
\DoxyCodeLine{00774         m\_highlightedFosFrame = highlightedFrame;}
\DoxyCodeLine{00775         viewer-\/>update();}
\DoxyCodeLine{00776       \}}
\DoxyCodeLine{00777       \textcolor{comment}{//-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00778       \textcolor{comment}{//-\/-\/-\/-\/-\/ 通常の Onion Skin の ハイライト}}
\DoxyCodeLine{00779       \textcolor{keywordflow}{if} (currentFrame != frame \&\& onionDotRect.contains(clickedPos))}
\DoxyCodeLine{00780         highlightedFrame = frame;}
\DoxyCodeLine{00781       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00782         highlightedFrame = -\/1;}
\DoxyCodeLine{00783       \textcolor{keywordflow}{if} (highlightedFrame != m\_highlightedMosFrame) \{}
\DoxyCodeLine{00784         m\_highlightedMosFrame = highlightedFrame;}
\DoxyCodeLine{00785         viewer-\/>update();}
\DoxyCodeLine{00786       \}}
\DoxyCodeLine{00787       \textcolor{comment}{//-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00788       \textcolor{comment}{//-\/-\/-\/-\/-\/ ツールチップの表示}}
\DoxyCodeLine{00789       \textcolor{keywordflow}{if} (currentFrame == frame) \{}
\DoxyCodeLine{00790         viewer-\/>setToolTip(tr(\textcolor{stringliteral}{"{}"{}}));}
\DoxyCodeLine{00791         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00792       \}}
\DoxyCodeLine{00793       \textcolor{comment}{// Fixed Onion Skin}}
\DoxyCodeLine{00794       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (fixedOnionDotRect.contains(clickedPos))}
\DoxyCodeLine{00795         viewer-\/>setToolTip(tr(\textcolor{stringliteral}{"{}Click to Toggle Fixed Onion Skin"{}}));}
\DoxyCodeLine{00796       \textcolor{comment}{//通常の Onion Skin}}
\DoxyCodeLine{00797       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (onionDotRect.contains(clickedPos))}
\DoxyCodeLine{00798         viewer-\/>setToolTip(tr(\textcolor{stringliteral}{"{}Click / Drag to Toggle Onion Skin"{}}));}
\DoxyCodeLine{00799       \textcolor{comment}{//カレントフレームの上下タブ}}
\DoxyCodeLine{00800       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((currentFrame -\/ 1 == frame \&\&}
\DoxyCodeLine{00801                 backOnionTabRect.contains(clickedPos)) ||}
\DoxyCodeLine{00802                (currentFrame + 1 == frame \&\&}
\DoxyCodeLine{00803                 frontOnionTabRect.contains(clickedPos)))}
\DoxyCodeLine{00804         viewer-\/>setToolTip(}
\DoxyCodeLine{00805             tr(\textcolor{stringliteral}{"{}Drag to Extend Onion Skin, Double Click to Toggle All"{}}));}
\DoxyCodeLine{00806       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00807         viewer-\/>setToolTip(tr(\textcolor{stringliteral}{"{}"{}}));}
\DoxyCodeLine{00808         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00809       \}}
\DoxyCodeLine{00810     \}}
\DoxyCodeLine{00811 }
\DoxyCodeLine{00812     \textcolor{comment}{//左ボタンドラッグの場合}}
\DoxyCodeLine{00813     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mouseEvent-\/>buttons() \& Qt::LeftButton) \{}
\DoxyCodeLine{00814       \textcolor{comment}{//指定されたアクションに従い、ドラッグされたフレームも同じアクションを行う}}
\DoxyCodeLine{00815       \textcolor{comment}{// drag}}
\DoxyCodeLine{00816       \textcolor{keywordflow}{switch} (m\_action) \{}
\DoxyCodeLine{00817       \textcolor{keywordflow}{case} MoveHead:}
\DoxyCodeLine{00818         setCurrentFrame(frame);}
\DoxyCodeLine{00819         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00820       \textcolor{keywordflow}{case} ActivateMos:}
\DoxyCodeLine{00821         setMos(frame, \textcolor{keyword}{true});}
\DoxyCodeLine{00822         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00823       \textcolor{keywordflow}{case} DeactivateMos:}
\DoxyCodeLine{00824         setMos(frame, \textcolor{keyword}{false});}
\DoxyCodeLine{00825         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00826       \textcolor{keywordflow}{case} ActivateFos:}
\DoxyCodeLine{00827         setFos(frame, \textcolor{keyword}{true});}
\DoxyCodeLine{00828         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00829       \textcolor{keywordflow}{case} DeactivateFos:}
\DoxyCodeLine{00830         setFos(frame, \textcolor{keyword}{false});}
\DoxyCodeLine{00831         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00832       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00833         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00834       \}}
\DoxyCodeLine{00835       viewer-\/>update();}
\DoxyCodeLine{00836     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mouseEvent-\/>buttons() \& Qt::MidButton)}
\DoxyCodeLine{00837       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00838   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00839     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00840   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00841 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_a1c86be28d87b599cc97a9737dced359c}\label{class_filmstrip_frame_head_gadget_a1c86be28d87b599cc97a9737dced359c}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!getCurrentFrame@{getCurrentFrame}}
\index{getCurrentFrame@{getCurrentFrame}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{getCurrentFrame()}{getCurrentFrame()}}
{\footnotesize\ttfamily int Filmstrip\+Frame\+Head\+Gadget\+::get\+Current\+Frame (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_frame_head_gadget}{Frame\+Head\+Gadget}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00323                                                     \{}
\DoxyCodeLine{00324   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *level = m\_filmstrip-\/>getLevel();}
\DoxyCodeLine{00325   \textcolor{keywordflow}{if} (!level) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00326   \textcolor{keywordflow}{return} level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_af30a02239ef0900c095a0af366dea26a}{guessIndex}}(\mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getCurrentFrame()-\/>getFid());}
\DoxyCodeLine{00327 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_a2cd69ad4d0bac34598b5535737432f57}\label{class_filmstrip_frame_head_gadget_a2cd69ad4d0bac34598b5535737432f57}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!getX@{getX}}
\index{getX@{getX}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{getX()}{getX()}}
{\footnotesize\ttfamily int Filmstrip\+Frame\+Head\+Gadget\+::getX (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00310 \{ \textcolor{keywordflow}{return} 50; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_a593137055ced6e2f5457d617dcdfd30c}\label{class_filmstrip_frame_head_gadget_a593137055ced6e2f5457d617dcdfd30c}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!getY@{getY}}
\index{getY@{getY}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{getY()}{getY()}}
{\footnotesize\ttfamily int Filmstrip\+Frame\+Head\+Gadget\+::getY (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_frame_head_gadget}{Frame\+Head\+Gadget}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00304 \{ \textcolor{keywordflow}{return} 50; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_a7fab3e051d4e075aba86e35285d4b69c}\label{class_filmstrip_frame_head_gadget_a7fab3e051d4e075aba86e35285d4b69c}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!index2x@{index2x}}
\index{index2x@{index2x}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{index2x()}{index2x()}}
{\footnotesize\ttfamily int Filmstrip\+Frame\+Head\+Gadget\+::index2x (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00312 \{ \textcolor{keywordflow}{return} index * m\_dx; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_a1e33b91c610b3714d6188a48a5a04ce0}\label{class_filmstrip_frame_head_gadget_a1e33b91c610b3714d6188a48a5a04ce0}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!index2y@{index2y}}
\index{index2y@{index2y}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{index2y()}{index2y()}}
{\footnotesize\ttfamily int Filmstrip\+Frame\+Head\+Gadget\+::index2y (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_frame_head_gadget}{Frame\+Head\+Gadget}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00306 \{ \textcolor{keywordflow}{return} index * m\_dy; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_a4637fce58f30d0b070ea8d761ab9e73f}\label{class_filmstrip_frame_head_gadget_a4637fce58f30d0b070ea8d761ab9e73f}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!setCurrentFrame@{setCurrentFrame}}
\index{setCurrentFrame@{setCurrentFrame}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{setCurrentFrame()}{setCurrentFrame()}}
{\footnotesize\ttfamily void Filmstrip\+Frame\+Head\+Gadget\+::set\+Current\+Frame (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_frame_head_gadget}{Frame\+Head\+Gadget}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00316                                                               \{}
\DoxyCodeLine{00317   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *level = m\_filmstrip-\/>getLevel();}
\DoxyCodeLine{00318   \textcolor{keywordflow}{if} (!level) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00319   \mbox{\hyperlink{class_t_frame_id}{TFrameId}} fid = level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_a07279a40ffad2c6ccc597c0a418f78fb}{index2fid}}(index);}
\DoxyCodeLine{00320   \textcolor{keywordflow}{if} (fid >= \mbox{\hyperlink{class_t_frame_id}{TFrameId}}(1)) \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>setFid(fid);}
\DoxyCodeLine{00321 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_ae52133aec5752e5d6713ef8912691029}\label{class_filmstrip_frame_head_gadget_ae52133aec5752e5d6713ef8912691029}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!shiftTraceEventFilter@{shiftTraceEventFilter}}
\index{shiftTraceEventFilter@{shiftTraceEventFilter}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{shiftTraceEventFilter()}{shiftTraceEventFilter()}}
{\footnotesize\ttfamily bool Filmstrip\+Frame\+Head\+Gadget\+::shift\+Trace\+Event\+Filter (\begin{DoxyParamCaption}\item[{QObject $\ast$}]{obj,  }\item[{QEvent $\ast$}]{event }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00845                                                                             \{}
\DoxyCodeLine{00846   QWidget *viewer = \textcolor{keyword}{dynamic\_cast<}QWidget *\textcolor{keyword}{>}(obj);}
\DoxyCodeLine{00847 }
\DoxyCodeLine{00848   \textcolor{keywordflow}{if} (e-\/>type() != QEvent::MouseButtonPress \&\& e-\/>type() != QEvent::MouseMove)}
\DoxyCodeLine{00849     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00850 }
\DoxyCodeLine{00851   \textcolor{keyword}{const} \textcolor{keywordtype}{int} shiftTraceDotSize    = 12;}
\DoxyCodeLine{00852   \textcolor{keyword}{const} \textcolor{keywordtype}{int} shiftTraceDotXOffset = 3;}
\DoxyCodeLine{00853   \textcolor{keyword}{const} \textcolor{keywordtype}{int} shiftTraceDotYOffset = 3;}
\DoxyCodeLine{00854   \textcolor{keywordtype}{int} dotYPos                    = (m\_dy -\/ shiftTraceDotSize) / 2;}
\DoxyCodeLine{00855   \textcolor{keywordtype}{int} dotXPos                    = (m\_dx -\/ shiftTraceDotSize) / 2;}
\DoxyCodeLine{00856   QRect dotRect(shiftTraceDotXOffset, dotYPos, shiftTraceDotSize,}
\DoxyCodeLine{00857                 shiftTraceDotSize);}
\DoxyCodeLine{00858   \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical) \{}
\DoxyCodeLine{00859     dotRect = QRect(dotXPos, shiftTraceDotYOffset, shiftTraceDotSize,}
\DoxyCodeLine{00860                     shiftTraceDotSize);}
\DoxyCodeLine{00861   \}}
\DoxyCodeLine{00862 }
\DoxyCodeLine{00863   \textcolor{comment}{// reset highlight}}
\DoxyCodeLine{00864   \textcolor{keywordflow}{if} (m\_highlightedghostFrame >= 0) \{}
\DoxyCodeLine{00865     m\_highlightedghostFrame = -\/1;}
\DoxyCodeLine{00866     viewer-\/>update();}
\DoxyCodeLine{00867   \}}
\DoxyCodeLine{00868 }
\DoxyCodeLine{00869   QMouseEvent *mouseEvent = \textcolor{keyword}{dynamic\_cast<}QMouseEvent *\textcolor{keyword}{>}(e);}
\DoxyCodeLine{00870   \textcolor{keywordtype}{int} frame               = y2index(mouseEvent-\/>pos().y());}
\DoxyCodeLine{00871   \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical) frame = x2index(mouseEvent-\/>pos().x());}
\DoxyCodeLine{00872   \textcolor{comment}{// position from top-\/left of the frame}}
\DoxyCodeLine{00873   QPoint mousePos = mouseEvent-\/>pos() + QPoint(0, -\/index2y(frame));}
\DoxyCodeLine{00874   \textcolor{keywordflow}{if} (!m\_filmstrip-\/>m\_isVertical)}
\DoxyCodeLine{00875     mousePos = mouseEvent-\/>pos() + QPoint(-\/index2x(frame), 0);}
\DoxyCodeLine{00876   \textcolor{keywordtype}{int} currentFrame = getCurrentFrame();}
\DoxyCodeLine{00877 }
\DoxyCodeLine{00878   \textcolor{keywordflow}{if} (m\_filmstrip-\/>m\_isVertical) \{}
\DoxyCodeLine{00879     \textcolor{keywordflow}{if} (mousePos.x() < dotRect.left() || mousePos.x() > dotRect.right())}
\DoxyCodeLine{00880       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00881   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00882     \textcolor{keywordflow}{if} (mousePos.y() < dotRect.top() || mousePos.y() > dotRect.bottom())}
\DoxyCodeLine{00883       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00884   \}}
\DoxyCodeLine{00885 }
\DoxyCodeLine{00886   \textcolor{keywordflow}{if} (e-\/>type() == QEvent::MouseButtonPress) \{}
\DoxyCodeLine{00887     \textcolor{keywordflow}{if} (frame == currentFrame) \{}
\DoxyCodeLine{00888       \textcolor{keywordflow}{if} (dotRect.contains(mousePos))}
\DoxyCodeLine{00889         OnioniSkinMaskGUI::resetShiftTraceFrameOffset();}
\DoxyCodeLine{00890       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00891         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00892     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00893       \mbox{\hyperlink{class_onion_skin_mask}{OnionSkinMask}} osMask =}
\DoxyCodeLine{00894           \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>getOnionSkinMask();}
\DoxyCodeLine{00895       \textcolor{keywordtype}{int} prevOffset    = osMask.getShiftTraceGhostFrameOffset(0);}
\DoxyCodeLine{00896       \textcolor{keywordtype}{int} forwardOffset = osMask.getShiftTraceGhostFrameOffset(1);}
\DoxyCodeLine{00897       \textcolor{comment}{// Hide previous ghost}}
\DoxyCodeLine{00898       \textcolor{keywordflow}{if} (frame == currentFrame + prevOffset)}
\DoxyCodeLine{00899         osMask.setShiftTraceGhostFrameOffset(0, 0);}
\DoxyCodeLine{00900       \textcolor{comment}{// Hide forward ghost}}
\DoxyCodeLine{00901       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (frame == currentFrame + forwardOffset)}
\DoxyCodeLine{00902         osMask.setShiftTraceGhostFrameOffset(1, 0);}
\DoxyCodeLine{00903       \textcolor{comment}{// Move previous ghost}}
\DoxyCodeLine{00904       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (frame < currentFrame)}
\DoxyCodeLine{00905         osMask.setShiftTraceGhostFrameOffset(0, frame -\/ currentFrame);}
\DoxyCodeLine{00906       \textcolor{comment}{// Move forward ghost}}
\DoxyCodeLine{00907       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00908         osMask.setShiftTraceGhostFrameOffset(1, frame -\/ currentFrame);}
\DoxyCodeLine{00909       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>setOnionSkinMask(osMask);}
\DoxyCodeLine{00910     \}}
\DoxyCodeLine{00911     \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>notifyOnionSkinMaskChanged();}
\DoxyCodeLine{00912     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00913   \}}
\DoxyCodeLine{00914   \textcolor{comment}{//-\/-\/-\/-\/}}
\DoxyCodeLine{00915   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (e-\/>type() == QEvent::MouseMove) \{}
\DoxyCodeLine{00916     \textcolor{keywordflow}{if} (frame == currentFrame) \{}
\DoxyCodeLine{00917       \textcolor{keywordflow}{if} (dotRect.contains(mousePos)) \{}
\DoxyCodeLine{00918         m\_highlightedghostFrame = frame;}
\DoxyCodeLine{00919         viewer-\/>setToolTip(}
\DoxyCodeLine{00920             tr(\textcolor{stringliteral}{"{}Click to Reset Shift \& Trace Markers to Neighbor Frames\(\backslash\)nHold "{}}}
\DoxyCodeLine{00921                \textcolor{stringliteral}{"{}F2 Key on the Viewer to Show This Frame Only"{}}));}
\DoxyCodeLine{00922       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00923         viewer-\/>setToolTip(tr(\textcolor{stringliteral}{"{}"{}}));}
\DoxyCodeLine{00924         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00925       \}}
\DoxyCodeLine{00926     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00927       m\_highlightedghostFrame = frame;}
\DoxyCodeLine{00928       \mbox{\hyperlink{class_onion_skin_mask}{OnionSkinMask}} osMask =}
\DoxyCodeLine{00929           \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>getOnionSkinMask();}
\DoxyCodeLine{00930       \textcolor{keywordtype}{int} prevOffset    = osMask.getShiftTraceGhostFrameOffset(0);}
\DoxyCodeLine{00931       \textcolor{keywordtype}{int} forwardOffset = osMask.getShiftTraceGhostFrameOffset(1);}
\DoxyCodeLine{00932       \textcolor{comment}{// Hide ghost}}
\DoxyCodeLine{00933       \textcolor{keywordflow}{if} (frame == currentFrame + prevOffset)}
\DoxyCodeLine{00934         viewer-\/>setToolTip(}
\DoxyCodeLine{00935             tr(\textcolor{stringliteral}{"{}Click to Hide This Frame from Shift \& Trace\(\backslash\)nHold F1 Key on "{}}}
\DoxyCodeLine{00936                \textcolor{stringliteral}{"{}the Viewer to Show This Frame Only"{}}));}
\DoxyCodeLine{00937       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (frame == currentFrame + forwardOffset)}
\DoxyCodeLine{00938         viewer-\/>setToolTip(}
\DoxyCodeLine{00939             tr(\textcolor{stringliteral}{"{}Click to Hide This Frame from Shift \& Trace\(\backslash\)nHold F3 Key on "{}}}
\DoxyCodeLine{00940                \textcolor{stringliteral}{"{}the Viewer to Show This Frame Only"{}}));}
\DoxyCodeLine{00941       \textcolor{comment}{// Move ghost}}
\DoxyCodeLine{00942       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00943         viewer-\/>setToolTip(tr(\textcolor{stringliteral}{"{}Click to Move Shift \& Trace Marker"{}}));}
\DoxyCodeLine{00944     \}}
\DoxyCodeLine{00945   \}}
\DoxyCodeLine{00946   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00947 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_a373396e8a1383b41334ef426cf14b5ab}\label{class_filmstrip_frame_head_gadget_a373396e8a1383b41334ef426cf14b5ab}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!x2index@{x2index}}
\index{x2index@{x2index}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{x2index()}{x2index()}}
{\footnotesize\ttfamily int Filmstrip\+Frame\+Head\+Gadget\+::x2index (\begin{DoxyParamCaption}\item[{int}]{y }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00314 \{ \textcolor{keywordflow}{return} x / m\_dx; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filmstrip_frame_head_gadget_ad734d1a4955145dfa1f711f8c1465bf8}\label{class_filmstrip_frame_head_gadget_ad734d1a4955145dfa1f711f8c1465bf8}} 
\index{FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}!y2index@{y2index}}
\index{y2index@{y2index}!FilmstripFrameHeadGadget@{FilmstripFrameHeadGadget}}
\doxysubsubsection{\texorpdfstring{y2index()}{y2index()}}
{\footnotesize\ttfamily int Filmstrip\+Frame\+Head\+Gadget\+::y2index (\begin{DoxyParamCaption}\item[{int}]{y }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_frame_head_gadget}{Frame\+Head\+Gadget}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00308 \{ \textcolor{keywordflow}{return} y / m\_dy; \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonz/frameheadgadget.\+h\item 
E\+:/opentoonz/toonz/sources/toonz/frameheadgadget.\+cpp\end{DoxyCompactItemize}
