\hypertarget{class_magic_wand_fx}{}\doxysection{Magic\+Wand\+Fx Class Reference}
\label{class_magic_wand_fx}\index{MagicWandFx@{MagicWandFx}}
Inheritance diagram for Magic\+Wand\+Fx\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=5.000000cm]{class_magic_wand_fx}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_rect_t}{TRect}} \mbox{\hyperlink{class_magic_wand_fx_aa2223bc330cdf655d423167051e9d9d4}{get\+Invalid\+Rect}} (const \mbox{\hyperlink{class_t_rect_t}{TRect}} \&max)
\item 
void \mbox{\hyperlink{class_magic_wand_fx_a06e69895c51574f3a7758deb5e1215fd}{do\+Compute}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const TRaster\+Fx\+Render\+Info $\ast$ri)
\item 
void \mbox{\hyperlink{class_magic_wand_fx_aba84061a4861f71f160a41713222130d}{do\+Magic\+Wand}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const TRaster\+Fx\+Render\+Info $\ast$ri)
\item 
void \mbox{\hyperlink{class_magic_wand_fx_a2698fa127f7e0f7b00da7bc4cd1700e2}{Enqueue\+Segment}} (int num, int dir, int p\+Lx, int p\+Rx, int Lx, int Rx, int y)
\item 
bool \mbox{\hyperlink{class_magic_wand_fx_afbd8a712be827d95f4e9a23103084d8e}{pixel\+Processor}} (TPixel32 $\ast$test\+Pix, \mbox{\hyperlink{class_t_pixel_g_r8}{TPixel\+GR8}} $\ast$mask\+Pix)
\item 
bool \mbox{\hyperlink{class_magic_wand_fx_a7d2feb7bbc02ba3a6fcbf6f8b315d965}{get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, TPixel32 \&bg\+Color)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+GR8P}} \mbox{\hyperlink{class_magic_wand_fx_a42b48c1c1f6ffd5be6c881145ce5d890}{m\+\_\+mask\+GR8}}
\item 
TPixel32 $\ast$ \mbox{\hyperlink{class_magic_wand_fx_a928a10113fe2fe58fb99e9705857a5fc}{m\+\_\+picked\+Pix}}
\item 
\mbox{\hyperlink{class_t_pixel_g_r8}{TPixel\+GR8}} $\ast$ \mbox{\hyperlink{class_magic_wand_fx_a621930e5538c380c16c23d66bba2576e}{m\+\_\+mask\+Picked\+Pix}}
\item 
int \mbox{\hyperlink{class_magic_wand_fx_a7b1fa845628db6a0562cd8cf85be4074}{m\+\_\+image\+Heigth}}
\item 
int \mbox{\hyperlink{class_magic_wand_fx_ae8a3aa18de8284b4620b67dc31058dbd}{m\+\_\+image\+Width}}
\item 
double \mbox{\hyperlink{class_magic_wand_fx_a2c8334cb3706c41b5c90150004b1e84f}{m\+\_\+tol}}
\item 
int \mbox{\hyperlink{class_magic_wand_fx_aa301d9eab5ad6dda9f57ce0d8616382e}{m\+\_\+cont}}
\item 
bool \mbox{\hyperlink{class_magic_wand_fx_a4000784f5a400d6cfe8074cf94672e90}{m\+\_\+antial}}
\item 
bool \mbox{\hyperlink{class_magic_wand_fx_aeebd682a6ae0b84402ac7d64a12ca2e6}{m\+\_\+euclid}}
\item 
bool \mbox{\hyperlink{class_magic_wand_fx_a1cb8dac876423c5f4fb60aa1e96edd67}{m\+\_\+add}}
\item 
bool \mbox{\hyperlink{class_magic_wand_fx_ae5be830e2a08f1e749fe917599c4edf2}{m\+\_\+sub}}
\item 
int \mbox{\hyperlink{class_magic_wand_fx_a0d2c199f206bdd2cc882723a5db38c0e}{m\+\_\+id\+\_\+invocazione}}
\item 
Shadow\+Segment\+Stack \mbox{\hyperlink{class_magic_wand_fx_a14838d2630a6d75f864001c4ccf68b1f}{m\+\_\+s\+SStack}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_magic_wand_fx_a645207eb1ca25608366a0ea3d50770a2}\label{class_magic_wand_fx_a645207eb1ca25608366a0ea3d50770a2}} 
\index{MagicWandFx@{MagicWandFx}!MagicWandFx@{MagicWandFx}}
\index{MagicWandFx@{MagicWandFx}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{MagicWandFx()}{MagicWandFx()}}
{\footnotesize\ttfamily Magic\+Wand\+Fx\+::\+Magic\+Wand\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00065       : m\_tolerance(15.0)}
\DoxyCodeLine{00066       , m\_blurRadius(0.0)}
\DoxyCodeLine{00067       , m\_point(\mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0))}
\DoxyCodeLine{00068 }
\DoxyCodeLine{00069   \{}
\DoxyCodeLine{00070     m\_contiguous     = TBoolParamP(\textcolor{keyword}{true});}
\DoxyCodeLine{00071     m\_antialiased    = TBoolParamP(\textcolor{keyword}{true});}
\DoxyCodeLine{00072     m\_euclideanD     = TBoolParamP(\textcolor{keyword}{true});}
\DoxyCodeLine{00073     m\_preMolt        = TBoolParamP(\textcolor{keyword}{true});}
\DoxyCodeLine{00074     m\_isShiftPressed = TBoolParamP(\textcolor{keyword}{false});}
\DoxyCodeLine{00075     m\_isAltPressed   = TBoolParamP(\textcolor{keyword}{false});}
\DoxyCodeLine{00076 }
\DoxyCodeLine{00077     addParam(\textcolor{stringliteral}{"{}Tolerance"{}}, m\_tolerance);}
\DoxyCodeLine{00078     addParam(\textcolor{stringliteral}{"{}Feather"{}}, m\_blurRadius);}
\DoxyCodeLine{00079     addParam(\textcolor{stringliteral}{"{}Point"{}}, m\_point);}
\DoxyCodeLine{00080     addParam(\textcolor{stringliteral}{"{}Contiguous"{}}, m\_contiguous);}
\DoxyCodeLine{00081     addParam(\textcolor{stringliteral}{"{}Antialias"{}}, m\_antialiased);}
\DoxyCodeLine{00082     addParam(\textcolor{stringliteral}{"{}EuclideanD"{}}, m\_euclideanD);}
\DoxyCodeLine{00083     addParam(\textcolor{stringliteral}{"{}PreMultiply"{}}, m\_preMolt);}
\DoxyCodeLine{00084     addParam(\textcolor{stringliteral}{"{}isShiftPressed"{}}, m\_isShiftPressed);}
\DoxyCodeLine{00085     addParam(\textcolor{stringliteral}{"{}isAltPressed"{}}, m\_isAltPressed);}
\DoxyCodeLine{00086     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Source"{}}, m\_input);}
\DoxyCodeLine{00087 }
\DoxyCodeLine{00088     m\_tolerance-\/>setValueRange(0, 255);}
\DoxyCodeLine{00089     m\_blurRadius-\/>setValueRange(0, 100);}
\DoxyCodeLine{00090   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_magic_wand_fx_af5bb557f905492be13db65339f00457a}\label{class_magic_wand_fx_af5bb557f905492be13db65339f00457a}} 
\index{MagicWandFx@{MagicWandFx}!````~MagicWandFx@{$\sim$MagicWandFx}}
\index{````~MagicWandFx@{$\sim$MagicWandFx}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{$\sim$MagicWandFx()}{~MagicWandFx()}}
{\footnotesize\ttfamily Magic\+Wand\+Fx\+::$\sim$\+Magic\+Wand\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00092 \{\};}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_magic_wand_fx_a06e69895c51574f3a7758deb5e1215fd}\label{class_magic_wand_fx_a06e69895c51574f3a7758deb5e1215fd}} 
\index{MagicWandFx@{MagicWandFx}!doCompute@{doCompute}}
\index{doCompute@{doCompute}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{doCompute()}{doCompute()}}
{\footnotesize\ttfamily void Magic\+Wand\+Fx\+::do\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const TRaster\+Fx\+Render\+Info $\ast$}]{ri }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00560                                                            \{}
\DoxyCodeLine{00561   \textcolor{keywordflow}{if} (!m\_input.isConnected()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00562 }
\DoxyCodeLine{00563   m\_input-\/>compute(tile, frame, ri);}
\DoxyCodeLine{00564 }
\DoxyCodeLine{00565   doMagicWand(tile, frame, ri);}
\DoxyCodeLine{00566 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_magic_wand_fx_aba84061a4861f71f160a41713222130d}\label{class_magic_wand_fx_aba84061a4861f71f160a41713222130d}} 
\index{MagicWandFx@{MagicWandFx}!doMagicWand@{doMagicWand}}
\index{doMagicWand@{doMagicWand}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{doMagicWand()}{doMagicWand()}}
{\footnotesize\ttfamily void Magic\+Wand\+Fx\+::do\+Magic\+Wand (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const TRaster\+Fx\+Render\+Info $\ast$}]{ri }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00235                                                              \{}
\DoxyCodeLine{00236   clock\_t start\_time = clock();  \textcolor{comment}{// debug}}
\DoxyCodeLine{00237   clock\_t stop\_time;}
\DoxyCodeLine{00238 }
\DoxyCodeLine{00239   invocazioni++;}
\DoxyCodeLine{00240   m\_id\_invocazione = invocazioni;}
\DoxyCodeLine{00241   m\_tol            = m\_tolerance-\/>getValue(frame);}
\DoxyCodeLine{00242   m\_antial         = m\_antialiased-\/>getValue();}
\DoxyCodeLine{00243   m\_euclid         = m\_euclideanD-\/>getValue();  \textcolor{comment}{// temporaneo?}}
\DoxyCodeLine{00244   m\_cont = m\_contiguous-\/>getValue();  \textcolor{comment}{// selezione di aree cromaticamente}}
\DoxyCodeLine{00245                                       \textcolor{comment}{// compatibili ma non contigue: Selezione}}
\DoxyCodeLine{00246                                       \textcolor{comment}{// ByColor}}
\DoxyCodeLine{00247   m\_add = m\_isShiftPressed-\/>getValue();}
\DoxyCodeLine{00248   m\_sub = m\_isAltPressed-\/>getValue();}
\DoxyCodeLine{00249 }
\DoxyCodeLine{00250   tile.getRaster()-\/>lock();}
\DoxyCodeLine{00251   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = tile.getRaster();}
\DoxyCodeLine{00252 }
\DoxyCodeLine{00253   TPixel32 vPixel;}
\DoxyCodeLine{00254   TPixel32 *tmpPix;}
\DoxyCodeLine{00255   TPixel32 *rowStart;}
\DoxyCodeLine{00256   \mbox{\hyperlink{class_t_pixel_g_r8}{TPixelGR8}} *maskRowStart;}
\DoxyCodeLine{00257   \mbox{\hyperlink{class_t_pixel_g_r8}{TPixelGR8}} *maskPix;}
\DoxyCodeLine{00258 }
\DoxyCodeLine{00259   \textcolor{keywordflow}{if} (ras32) \{}
\DoxyCodeLine{00260     pixelProcessed    = 0;}
\DoxyCodeLine{00261     pixelMasked       = 1;}
\DoxyCodeLine{00262     shadowEnqueued    = 2;}
\DoxyCodeLine{00263     pixelReprocessed  = 0;}
\DoxyCodeLine{00264     shadowOutOfBorder = 0;}
\DoxyCodeLine{00265 }
\DoxyCodeLine{00266     m\_imageWidth  = ras32-\/>getLx();}
\DoxyCodeLine{00267     m\_imageHeigth = ras32-\/>getLy();}
\DoxyCodeLine{00268     \textcolor{comment}{// assert(m\_imageWidth == 800);}}
\DoxyCodeLine{00269     assert(m\_imageHeigth <= 600);}
\DoxyCodeLine{00270     \textcolor{keywordtype}{int} lx = m\_imageWidth;}
\DoxyCodeLine{00271     \textcolor{keywordtype}{int} ly = m\_imageHeigth;}
\DoxyCodeLine{00272 }
\DoxyCodeLine{00273     \textcolor{keywordflow}{if} (!m\_maskGR8) \{}
\DoxyCodeLine{00274       \textcolor{comment}{// prima esecuzione creo il raster gr8 x la maschera e azzero gli alpha}}
\DoxyCodeLine{00275       \mbox{\hyperlink{class_t_rect_t}{TRectD}} bBoxD;}
\DoxyCodeLine{00276       TPixel32 bgColor;}
\DoxyCodeLine{00277       \textcolor{keywordtype}{bool} getBBoxOk = getBBox(frame, bBoxD, bgColor);}
\DoxyCodeLine{00278       assert(getBBoxOk);}
\DoxyCodeLine{00279       \mbox{\hyperlink{class_t_rect_t}{TRect}} bBoxI = convert(bBoxD);}
\DoxyCodeLine{00280       m\_maskGR8   = \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}}(bBoxI.getLx(), bBoxI.getLy());}
\DoxyCodeLine{00281       m\_maskGR8-\/>clear();}
\DoxyCodeLine{00282     \}}
\DoxyCodeLine{00283     m\_maskGR8-\/>lock();}
\DoxyCodeLine{00284     \textcolor{comment}{// sono arrivato qui: sto verificando se serve davvero il gr8.}}
\DoxyCodeLine{00285 }
\DoxyCodeLine{00286     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} iy = 0; iy < m\_imageHeigth; iy++) \{  \textcolor{comment}{// y}}
\DoxyCodeLine{00287       tmpPix = ras32-\/>pixels(iy);}
\DoxyCodeLine{00288       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ix = 0; ix < m\_imageWidth; ix++) \{  \textcolor{comment}{// x}}
\DoxyCodeLine{00289         tmpPix-\/>m = EmptyPixel;}
\DoxyCodeLine{00290         tmpPix++;}
\DoxyCodeLine{00291       \}  \textcolor{comment}{// x}}
\DoxyCodeLine{00292     \}    \textcolor{comment}{// y}}
\DoxyCodeLine{00293 }
\DoxyCodeLine{00294     \textcolor{keywordflow}{if} (m\_add) \{  \textcolor{comment}{// ho premuto Shift sto aggiungendo alla selezione}}
\DoxyCodeLine{00295 }
\DoxyCodeLine{00296     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_sub) \{}
\DoxyCodeLine{00297       \textcolor{comment}{// ho premuto Alt sto sottraendo dalla selezione}}
\DoxyCodeLine{00298 }
\DoxyCodeLine{00299     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00300       \textcolor{comment}{// non ho premuto niente nuova selezione}}
\DoxyCodeLine{00301 }
\DoxyCodeLine{00302       \textcolor{comment}{// ripulisco il canale alpha dell'immagine e la maschera}}
\DoxyCodeLine{00303       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} iy = 0; iy < m\_imageHeigth; iy++) \{}
\DoxyCodeLine{00304         tmpPix  = ras32-\/>pixels(iy);}
\DoxyCodeLine{00305         maskPix = m\_maskGR8-\/>pixels(iy);}
\DoxyCodeLine{00306         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ix = 0; ix < m\_imageWidth; ix++) \{}
\DoxyCodeLine{00307           tmpPix-\/>m = 0;}
\DoxyCodeLine{00308 }
\DoxyCodeLine{00309           maskPix-\/>value = EmptyPixel;}
\DoxyCodeLine{00310           tmpPix++;}
\DoxyCodeLine{00311           maskPix++;}
\DoxyCodeLine{00312         \}  \textcolor{comment}{// x}}
\DoxyCodeLine{00313       \}    \textcolor{comment}{// y}}
\DoxyCodeLine{00314     \}}
\DoxyCodeLine{00315 }
\DoxyCodeLine{00316     \textcolor{comment}{// trovo il pixel in X,Y soluzione temporanea in attesa della gestione del}}
\DoxyCodeLine{00317     \textcolor{comment}{// mouse.}}
\DoxyCodeLine{00318     \textcolor{comment}{// converto le coordinate mondo (-\/500;+500) in coordinate raster}}
\DoxyCodeLine{00319     \textcolor{comment}{// (0;m\_imageWidth);}}
\DoxyCodeLine{00320     \mbox{\hyperlink{class_t_point_t}{TPointD}} point = m\_point-\/>getValue(frame);}
\DoxyCodeLine{00321 }
\DoxyCodeLine{00322     \textcolor{comment}{// coordinate dagli sliders}}
\DoxyCodeLine{00323     \textcolor{comment}{//    int x = (int) (500+point.x)*m\_imageWidth/1000; if (x>0) x-\/-\/;}}
\DoxyCodeLine{00324     \textcolor{comment}{//    int y = (int) (500+point.y)*m\_imageHeigth/1000; if (y>0) y-\/-\/;}}
\DoxyCodeLine{00325 }
\DoxyCodeLine{00326     \textcolor{comment}{// coordinate dalla ZViewer:leftButtonClick}}
\DoxyCodeLine{00327 }
\DoxyCodeLine{00328     \textcolor{keywordtype}{int} x = tcrop((\textcolor{keywordtype}{int})(point.x + m\_imageWidth / 2), 0, (m\_imageWidth -\/ 1));}
\DoxyCodeLine{00329     \textcolor{keywordtype}{int} y = tcrop((\textcolor{keywordtype}{int})(point.y + m\_imageHeigth / 2), 0, (m\_imageHeigth -\/ 1));}
\DoxyCodeLine{00330 }
\DoxyCodeLine{00331     TSystem::outputDebug(\textcolor{stringliteral}{"{}\(\backslash\)n[MWfx("{}} + toString(m\_id\_invocazione) +}
\DoxyCodeLine{00332                          \textcolor{stringliteral}{"{})<begin>]\(\backslash\)nSize:"{}} + toString(m\_imageWidth) + \textcolor{stringliteral}{"{}x"{}} +}
\DoxyCodeLine{00333                          toString(m\_imageHeigth) + \textcolor{stringliteral}{"{}\(\backslash\)tx:"{}} + toString(x) +}
\DoxyCodeLine{00334                          \textcolor{stringliteral}{"{}\(\backslash\)ty:"{}} + toString(y) + \textcolor{stringliteral}{"{}\(\backslash\)tToll:"{}} + toString(m\_tol) +}
\DoxyCodeLine{00335                          \textcolor{comment}{/*      "{}\(\backslash\)tRadius:"{} + toString(radius) +*/} (}
\DoxyCodeLine{00336                              (m\_cont) ? \textcolor{stringliteral}{"{}\(\backslash\)tContiguous"{}} : \textcolor{stringliteral}{"{}\(\backslash\)tNon Contiguous"{}}) +}
\DoxyCodeLine{00337                          ((m\_antial) ? \textcolor{stringliteral}{"{}\(\backslash\)tAnti Aliased"{}} : \textcolor{stringliteral}{"{}\(\backslash\)tAliased"{}}) +}
\DoxyCodeLine{00338                          ((m\_euclid) ? \textcolor{stringliteral}{"{}\(\backslash\)tEuclidean\(\backslash\)n"{}} : \textcolor{stringliteral}{"{}\(\backslash\)tNon Euclidean\(\backslash\)n"{}}));}
\DoxyCodeLine{00339 }
\DoxyCodeLine{00340     lx = m\_imageWidth;}
\DoxyCodeLine{00341     ly = m\_imageHeigth;}
\DoxyCodeLine{00342 }
\DoxyCodeLine{00343     m\_pickedPix     = ras32-\/>pixels(y) + x;}
\DoxyCodeLine{00344     m\_maskPickedPix = m\_maskGR8-\/>pixels(y) + x;}
\DoxyCodeLine{00345 }
\DoxyCodeLine{00346     pixelProcessed = 1;}
\DoxyCodeLine{00347 }
\DoxyCodeLine{00348     \textcolor{keywordflow}{if} (m\_cont) \{  \textcolor{comment}{// seleziono esclusivamente i pixel connessi al pixel SEED}}
\DoxyCodeLine{00349 }
\DoxyCodeLine{00350       \textcolor{comment}{//-\/ ALGORITMO FLOOD FILL: GRAPHICS GEM 1 p.280}}
\DoxyCodeLine{00351       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00352       \textcolor{keywordtype}{int} xAux, yAux, lxAux, rxAux, dirAux, pRxAux, pLxAux;}
\DoxyCodeLine{00353       \textcolor{keywordtype}{bool} inSpan = \textcolor{keyword}{true};}
\DoxyCodeLine{00354 }
\DoxyCodeLine{00355       \textcolor{comment}{// trova Rx e Lx dello span contentente il SEED point}}
\DoxyCodeLine{00356       \textcolor{keywordtype}{int} xCont = x;}
\DoxyCodeLine{00357       tmpPix    = m\_pickedPix;      \textcolor{comment}{// puntatore al SEED}}
\DoxyCodeLine{00358       maskPix   = m\_maskPickedPix;  \textcolor{comment}{//******}}
\DoxyCodeLine{00359 }
\DoxyCodeLine{00360       \textcolor{comment}{// cerco Lx}}
\DoxyCodeLine{00361       maskValue  = pixelProcessor(tmpPix, maskPix);}
\DoxyCodeLine{00362       \textcolor{keywordtype}{bool} tmpMv = maskValue;}
\DoxyCodeLine{00363       \textcolor{keywordflow}{while} ((xCont >= 0) \&\& (maskValue)) \{}
\DoxyCodeLine{00364         tmpPix-\/-\/;}
\DoxyCodeLine{00365         maskPix-\/-\/;}
\DoxyCodeLine{00366         xCont-\/-\/;}
\DoxyCodeLine{00367         \textcolor{keywordflow}{if} (xCont >= 0) maskValue = pixelProcessor(tmpPix, maskPix);}
\DoxyCodeLine{00368       \}}
\DoxyCodeLine{00369       \textcolor{keywordflow}{if} (tmpMv)}
\DoxyCodeLine{00370         lxAux = xCont + 1;}
\DoxyCodeLine{00371       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00372         lxAux = xCont;}
\DoxyCodeLine{00373 }
\DoxyCodeLine{00374       \textcolor{comment}{// cerco Rx}}
\DoxyCodeLine{00375       tmpPix  = m\_pickedPix;}
\DoxyCodeLine{00376       maskPix = m\_maskPickedPix;  \textcolor{comment}{//******}}
\DoxyCodeLine{00377 }
\DoxyCodeLine{00378       xCont     = x;}
\DoxyCodeLine{00379       maskValue = tmpMv;}
\DoxyCodeLine{00380       \textcolor{keywordflow}{while} ((xCont < m\_imageWidth) \&\& (maskValue)) \{}
\DoxyCodeLine{00381         tmpPix++;}
\DoxyCodeLine{00382         maskPix++;}
\DoxyCodeLine{00383         xCont++;}
\DoxyCodeLine{00384         \textcolor{keywordflow}{if} (xCont < m\_imageWidth) maskValue = pixelProcessor(tmpPix, maskPix);}
\DoxyCodeLine{00385       \}}
\DoxyCodeLine{00386       \textcolor{keywordflow}{if} (tmpMv)}
\DoxyCodeLine{00387         rxAux = xCont -\/ 1;}
\DoxyCodeLine{00388       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00389         rxAux = xCont;}
\DoxyCodeLine{00390 }
\DoxyCodeLine{00391       assert((lxAux <= rxAux) \&\& (lxAux >= 0));}
\DoxyCodeLine{00392 }
\DoxyCodeLine{00393       \textcolor{comment}{// metto nella pila delle ombre la riga sopra e sotto quella contentente}}
\DoxyCodeLine{00394       \textcolor{comment}{// il seed.}}
\DoxyCodeLine{00395       \textcolor{comment}{//            TSystem::outputDebug("{}[MWfx("{}+toString(m\_id\_invocazione)+"{})]\(\backslash\)tStack}}
\DoxyCodeLine{00396       \textcolor{comment}{//            Size:"{}+toString((int)}}
\DoxyCodeLine{00397       \textcolor{comment}{//            m\_sSStack.size())+"{}\(\backslash\)tLx:"{}+toString(lxAux)+"{}\(\backslash\)tRx:"{}+toString(rxAux)+"{}\(\backslash\)tpLx:"{}+toString(lxAux)+"{}\(\backslash\)tpRx:"{}+toString(rxAux)+"{}\(\backslash\)ty:"{}+toString(y+1)+"{}\(\backslash\)tdir:"{}+toString(1)+"{}\(\backslash\)n"{});}}
\DoxyCodeLine{00398       m\_sSStack.push(\mbox{\hyperlink{class_shadow_segment}{ShadowSegment}}(lxAux, rxAux, lxAux, rxAux, y + 1,}
\DoxyCodeLine{00399                                    +1));  \textcolor{comment}{// cerca in alto}}
\DoxyCodeLine{00400                                           \textcolor{comment}{//            TSystem::outputDebug("{}[MWfx("{}+toString(m\_id\_invocazione)+"{})]\(\backslash\)tStack}}
\DoxyCodeLine{00401                                           \textcolor{comment}{//            Size:"{}+toString((int)}}
\DoxyCodeLine{00402                                           \textcolor{comment}{//            m\_sSStack.size())+"{}\(\backslash\)tLx:"{}+toString(lxAux)+"{}\(\backslash\)tRx:"{}+toString(rxAux)+"{}\(\backslash\)tpLx:"{}+toString(lxAux)+"{}\(\backslash\)tpRx:"{}+toString(rxAux)+"{}\(\backslash\)ty:"{}+toString(y-\/1)+"{}\(\backslash\)tdir:"{}+toString(-\/1)+"{}\(\backslash\)n"{});}}
\DoxyCodeLine{00403       m\_sSStack.push(\mbox{\hyperlink{class_shadow_segment}{ShadowSegment}}(lxAux, rxAux, lxAux, rxAux, y -\/ 1,}
\DoxyCodeLine{00404                                    -\/1));  \textcolor{comment}{// cerca in basso}}
\DoxyCodeLine{00405 }
\DoxyCodeLine{00406       \textcolor{keywordflow}{while} (!m\_sSStack.empty()) \{}
\DoxyCodeLine{00407         \mbox{\hyperlink{class_shadow_segment}{ShadowSegment}} sSegment = m\_sSStack.top();}
\DoxyCodeLine{00408         m\_sSStack.pop();}
\DoxyCodeLine{00409         \textcolor{comment}{//        TSystem::outputDebug("{}[MWfx("{}+toString(m\_id\_invocazione)+"{}:0)<POP}}
\DoxyCodeLine{00410         \textcolor{comment}{//        >]\(\backslash\)tStack Size:"{}+toString((int)}}
\DoxyCodeLine{00411         \textcolor{comment}{//        m\_sSStack.size())+"{}\(\backslash\)tLx:"{}+toString(sSegment.m\_lx)+"{}\(\backslash\)tRx:"{}+toString(sSegment.m\_rx)+"{}\(\backslash\)tpLx:"{}+toString(sSegment.m\_pLx)+"{}\(\backslash\)tpRx:"{}+toString(sSegment.m\_pRx)+"{}\(\backslash\)ty:"{}+toString(sSegment.m\_y)+"{}\(\backslash\)tdir:"{}+toString(sSegment.m\_dir)+"{}\(\backslash\)n"{});}}
\DoxyCodeLine{00412 }
\DoxyCodeLine{00413         dirAux = sSegment.m\_dir;}
\DoxyCodeLine{00414         pRxAux = sSegment.m\_pRx;}
\DoxyCodeLine{00415         pLxAux = sSegment.m\_pLx;}
\DoxyCodeLine{00416         lxAux  = sSegment.m\_lx;}
\DoxyCodeLine{00417         rxAux  = sSegment.m\_rx;}
\DoxyCodeLine{00418         yAux   = sSegment.m\_y;}
\DoxyCodeLine{00419 }
\DoxyCodeLine{00420         \textcolor{keywordflow}{if} ((yAux < 0) || (yAux >= m\_imageHeigth)) \{}
\DoxyCodeLine{00421           shadowOutOfBorder++;}
\DoxyCodeLine{00422           \textcolor{keywordflow}{continue};  \textcolor{comment}{// questo segmento sta fuori dal raster oppure l'ho gia'}}
\DoxyCodeLine{00423                      \textcolor{comment}{// colorato: lo salto}}
\DoxyCodeLine{00424         \}}
\DoxyCodeLine{00425         assert((lxAux <= rxAux) \&\& (pLxAux <= pRxAux));}
\DoxyCodeLine{00426         assert((m\_sSStack.size() <= 1000));}
\DoxyCodeLine{00427 }
\DoxyCodeLine{00428         xAux = lxAux + 1;}
\DoxyCodeLine{00429 }
\DoxyCodeLine{00430         rowStart = ras32-\/>pixels(yAux);}
\DoxyCodeLine{00431 }
\DoxyCodeLine{00432         maskRowStart = m\_maskGR8-\/>pixels(yAux);  \textcolor{comment}{//**}}
\DoxyCodeLine{00433 }
\DoxyCodeLine{00434         tmpPix  = rowStart + lxAux;}
\DoxyCodeLine{00435         maskPix = maskRowStart + lxAux;}
\DoxyCodeLine{00436 }
\DoxyCodeLine{00437         maskValue = pixelProcessor(tmpPix, maskPix);}
\DoxyCodeLine{00438 }
\DoxyCodeLine{00439         inSpan = (maskValue);}
\DoxyCodeLine{00440 }
\DoxyCodeLine{00441         \textcolor{keywordflow}{if} (maskValue) \{  \textcolor{comment}{// il punto e' cromaticompatibile}}
\DoxyCodeLine{00442           lxAux-\/-\/;}
\DoxyCodeLine{00443           \textcolor{keywordflow}{if} (lxAux >= 0) \{}
\DoxyCodeLine{00444             tmpPix-\/-\/;}
\DoxyCodeLine{00445             maskPix-\/-\/;}
\DoxyCodeLine{00446             maskValue = pixelProcessor(tmpPix, maskPix);}
\DoxyCodeLine{00447           \}}
\DoxyCodeLine{00448           \textcolor{keywordflow}{while} ((maskValue) \&\&}
\DoxyCodeLine{00449                  (lxAux >= 0)) \{  \textcolor{comment}{// sto nello span E nell'immagine}}
\DoxyCodeLine{00450             lxAux-\/-\/;}
\DoxyCodeLine{00451             \textcolor{keywordflow}{if} (lxAux >= 0) \{}
\DoxyCodeLine{00452               tmpPix-\/-\/;}
\DoxyCodeLine{00453               maskPix-\/-\/;}
\DoxyCodeLine{00454               maskValue = pixelProcessor(tmpPix, maskPix);}
\DoxyCodeLine{00455             \}}
\DoxyCodeLine{00456           \}  \textcolor{comment}{// sto nello span E nell'immagine}}
\DoxyCodeLine{00457         \}    \textcolor{comment}{// il punto e' cromaticompatibile}}
\DoxyCodeLine{00458         lxAux++;}
\DoxyCodeLine{00459         \textcolor{comment}{//        rowStart = ras32-\/>pixels(yAux);}}
\DoxyCodeLine{00460         \textcolor{keywordflow}{while} (xAux < m\_imageWidth) \{  \textcolor{comment}{// mi sposto a destra lungo la X}}
\DoxyCodeLine{00461           \textcolor{keywordflow}{if} (inSpan) \{}
\DoxyCodeLine{00462             tmpPix    = rowStart + xAux;}
\DoxyCodeLine{00463             maskPix   = maskRowStart + xAux;  \textcolor{comment}{//***}}
\DoxyCodeLine{00464             maskValue = pixelProcessor(tmpPix, maskPix);}
\DoxyCodeLine{00465             \textcolor{keywordflow}{if} (maskValue) \{  \textcolor{comment}{// case 1}}
\DoxyCodeLine{00466                               \textcolor{comment}{// fa tutto nella pixel processor}}
\DoxyCodeLine{00467             \}                 \textcolor{comment}{// case 1}}
\DoxyCodeLine{00468             \textcolor{keywordflow}{else} \{            \textcolor{comment}{// case 2}}
\DoxyCodeLine{00469               EnqueueSegment(1, dirAux, pLxAux, pRxAux, lxAux, (xAux -\/ 1),}
\DoxyCodeLine{00470                              yAux);}
\DoxyCodeLine{00471               inSpan = \textcolor{keyword}{false};}
\DoxyCodeLine{00472             \}     \textcolor{comment}{// case 2}}
\DoxyCodeLine{00473           \}       \textcolor{comment}{// inSpan}}
\DoxyCodeLine{00474           \textcolor{keywordflow}{else} \{  \textcolor{comment}{// non ero nello span}}
\DoxyCodeLine{00475             \textcolor{keywordflow}{if} (xAux > rxAux) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00476             tmpPix    = rowStart + xAux;}
\DoxyCodeLine{00477             maskPix   = maskRowStart + xAux;}
\DoxyCodeLine{00478             maskValue = pixelProcessor(tmpPix, maskPix);}
\DoxyCodeLine{00479             \textcolor{keywordflow}{if} (maskValue) \{  \textcolor{comment}{// case 3}}
\DoxyCodeLine{00480               inSpan = \textcolor{keyword}{true};}
\DoxyCodeLine{00481               lxAux  = xAux;}
\DoxyCodeLine{00482             \}       \textcolor{comment}{// case 3}}
\DoxyCodeLine{00483             \textcolor{keywordflow}{else} \{  \textcolor{comment}{// case 4}}
\DoxyCodeLine{00484             \}}
\DoxyCodeLine{00485           \}  \textcolor{comment}{// non ero nello span}}
\DoxyCodeLine{00486           xAux++;}
\DoxyCodeLine{00487           \textcolor{comment}{//          TSystem::outputDebug("{}[MWfx("{}+toString(m\_id\_invocazione)+"{})]\(\backslash\)tStack}}
\DoxyCodeLine{00488           \textcolor{comment}{//          Size:"{}+toString((int)}}
\DoxyCodeLine{00489           \textcolor{comment}{//          m\_sSStack.size())+"{}\(\backslash\)txAux:"{}+toString(xAux)+"{}\(\backslash\)ty:"{}+toString(yAux)+"{}\(\backslash\)n"{});}}
\DoxyCodeLine{00490         \}  \textcolor{comment}{// mi sposto a destra lungo la X: endloop 1}}
\DoxyCodeLine{00491         \textcolor{keywordflow}{if} (inSpan) \{}
\DoxyCodeLine{00492           EnqueueSegment(2, dirAux, pLxAux, pRxAux, lxAux, (xAux -\/ 1), yAux);}
\DoxyCodeLine{00493         \}}
\DoxyCodeLine{00494       \}     \textcolor{comment}{// finche' la pila non e' vuota: endloop 2}}
\DoxyCodeLine{00495     \}       \textcolor{comment}{// if m\_cont}}
\DoxyCodeLine{00496     \textcolor{keywordflow}{else} \{  \textcolor{comment}{// anche le regioni simili NON contigue: questo rimane anche in caso}}
\DoxyCodeLine{00497             \textcolor{comment}{// di modifica della parte m\_cont}}
\DoxyCodeLine{00498       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} iy = 0; iy < m\_imageHeigth; iy++) \{}
\DoxyCodeLine{00499         tmpPix  = ras32-\/>pixels(iy);}
\DoxyCodeLine{00500         maskPix = m\_maskGR8-\/>pixels(iy);}
\DoxyCodeLine{00501         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ix = 0; ix < m\_imageWidth; ix++) \{}
\DoxyCodeLine{00502           maskValue = pixelProcessor(tmpPix, maskPix);}
\DoxyCodeLine{00503           \textcolor{comment}{//                 if (maskValue) \{ \} // if// il colore e' simile =>}}
\DoxyCodeLine{00504           \textcolor{comment}{//                 va incluso nella selezione // fa tutto nella pixel}}
\DoxyCodeLine{00505           \textcolor{comment}{//                 processor}}
\DoxyCodeLine{00506           tmpPix++;}
\DoxyCodeLine{00507           maskPix++;}
\DoxyCodeLine{00508         \}  \textcolor{comment}{// ix}}
\DoxyCodeLine{00509       \}    \textcolor{comment}{// iy}}
\DoxyCodeLine{00510     \}      \textcolor{comment}{// else m\_cont}}
\DoxyCodeLine{00511 }
\DoxyCodeLine{00512     \textcolor{keywordtype}{int} blurRadius = (int)(m\_blurRadius-\/>getValue(frame));}
\DoxyCodeLine{00513     \textcolor{keywordflow}{if} ((m\_antial) \&\& (blurRadius < 2)) blurRadius = 1;}
\DoxyCodeLine{00514 }
\DoxyCodeLine{00515     \textcolor{keywordflow}{if} (blurRadius > 0)}
\DoxyCodeLine{00516       \mbox{\hyperlink{namespace_t_rop_a9baa771ae6b7beb73d594266761d2cf2}{TRop::blur}}(m\_maskGR8, m\_maskGR8, (blurRadius + 1), 0, 0);}
\DoxyCodeLine{00517 }
\DoxyCodeLine{00518     \textcolor{comment}{// copio la maschera sull'alpha channel dell'immagine}}
\DoxyCodeLine{00519     \textcolor{comment}{// lo faccio a mano chiedere se esiste una funziona apposita}}
\DoxyCodeLine{00520     \textcolor{keywordflow}{for} (iy = 0; iy < m\_imageHeigth; iy++) \{}
\DoxyCodeLine{00521       tmpPix  = ras32-\/>pixels(iy);}
\DoxyCodeLine{00522       maskPix = m\_maskGR8-\/>pixels(iy);}
\DoxyCodeLine{00523       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ix = 0; ix < m\_imageWidth; ix++) \{}
\DoxyCodeLine{00524         tmpPix-\/>m = maskPix-\/>value;}
\DoxyCodeLine{00525         tmpPix++;}
\DoxyCodeLine{00526         maskPix++;}
\DoxyCodeLine{00527       \}  \textcolor{comment}{// ix}}
\DoxyCodeLine{00528     \}    \textcolor{comment}{// iy}}
\DoxyCodeLine{00529 }
\DoxyCodeLine{00530     \textcolor{keywordflow}{if} (m\_preMolt-\/>getValue()) \mbox{\hyperlink{namespace_t_rop_aa8671761db1d55d696b4b8bb71f8b2e4}{TRop::premultiply}}(ras32);}
\DoxyCodeLine{00531     stop\_time     = clock();}
\DoxyCodeLine{00532     \textcolor{keywordtype}{double} durata = (double)(stop\_time -\/ start\_time) / CLOCKS\_PER\_SEC;}
\DoxyCodeLine{00533 }
\DoxyCodeLine{00534     TSystem::outputDebug(}
\DoxyCodeLine{00535         \textcolor{stringliteral}{"{}\(\backslash\)n\#Pixel:\(\backslash\)t"{}} + toString(m\_imageWidth * m\_imageHeigth) + \textcolor{stringliteral}{"{}\(\backslash\)nProc:\(\backslash\)t"{}} +}
\DoxyCodeLine{00536         toString(pixelProcessed) + \textcolor{stringliteral}{"{}\(\backslash\)t["{}} +}
\DoxyCodeLine{00537         toString((pixelProcessed * 100 / (m\_imageWidth * m\_imageHeigth))) +}
\DoxyCodeLine{00538         \textcolor{stringliteral}{"{}\%t]"{}} + \textcolor{stringliteral}{"{}\(\backslash\)nMask:\(\backslash\)t"{}} + toString(pixelMasked) + \textcolor{stringliteral}{"{}\(\backslash\)t["{}} +}
\DoxyCodeLine{00539         toString((pixelMasked * 100 / (m\_imageWidth * m\_imageHeigth))) + \textcolor{stringliteral}{"{}\%t]"{}} +}
\DoxyCodeLine{00540         \textcolor{stringliteral}{"{}\(\backslash\)t["{}} + toString((pixelMasked * 100 / (pixelProcessed))) + \textcolor{stringliteral}{"{}\%p]"{}} +}
\DoxyCodeLine{00541         \textcolor{stringliteral}{"{}\(\backslash\)nEnqu:\(\backslash\)t"{}} + toString(shadowEnqueued) + \textcolor{stringliteral}{"{}\(\backslash\)nRepr:\(\backslash\)t"{}} +}
\DoxyCodeLine{00542         toString(pixelReprocessed) + \textcolor{stringliteral}{"{}\(\backslash\)t["{}} +}
\DoxyCodeLine{00543         toString((pixelReprocessed * 100 / (m\_imageWidth * m\_imageHeigth))) +}
\DoxyCodeLine{00544         \textcolor{stringliteral}{"{}\%t]"{}} + \textcolor{stringliteral}{"{}\(\backslash\)t["{}} + toString((pixelReprocessed * 100 / (pixelProcessed))) +}
\DoxyCodeLine{00545         \textcolor{stringliteral}{"{}\%p]"{}} + \textcolor{stringliteral}{"{}\(\backslash\)nOutB:\(\backslash\)t"{}} + toString(shadowOutOfBorder) + \textcolor{stringliteral}{"{}\(\backslash\)t["{}} +}
\DoxyCodeLine{00546         toString((shadowOutOfBorder * 100 / (shadowEnqueued))) + \textcolor{stringliteral}{"{}\%t]"{}} +}
\DoxyCodeLine{00547         \textcolor{stringliteral}{"{}\(\backslash\)nTime:\(\backslash\)t"{}} + toString(durata, 3) + \textcolor{stringliteral}{"{} sec\(\backslash\)n[MagicWandFX <end>]\(\backslash\)n"{}});}
\DoxyCodeLine{00548 }
\DoxyCodeLine{00549   \}  \textcolor{comment}{// if (ras32)}}
\DoxyCodeLine{00550   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00551     \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} rasGR8 = tile.getRaster();}
\DoxyCodeLine{00552     \textcolor{keywordflow}{if} (rasGR8) \{}
\DoxyCodeLine{00553     \}}
\DoxyCodeLine{00554   \}}
\DoxyCodeLine{00555   tile.getRaster()-\/>unlock();}
\DoxyCodeLine{00556   m\_maskGR8-\/>unlock();}
\DoxyCodeLine{00557 \}  \textcolor{comment}{// doMagicWand}}

\end{DoxyCode}
\mbox{\Hypertarget{class_magic_wand_fx_a2698fa127f7e0f7b00da7bc4cd1700e2}\label{class_magic_wand_fx_a2698fa127f7e0f7b00da7bc4cd1700e2}} 
\index{MagicWandFx@{MagicWandFx}!EnqueueSegment@{EnqueueSegment}}
\index{EnqueueSegment@{EnqueueSegment}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{EnqueueSegment()}{EnqueueSegment()}}
{\footnotesize\ttfamily void Magic\+Wand\+Fx\+::\+Enqueue\+Segment (\begin{DoxyParamCaption}\item[{int}]{num,  }\item[{int}]{dir,  }\item[{int}]{p\+Lx,  }\item[{int}]{p\+Rx,  }\item[{int}]{Lx,  }\item[{int}]{Rx,  }\item[{int}]{y }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00202                                                 \{}
\DoxyCodeLine{00203   \textcolor{keywordtype}{int} pushRx = Rx + 1;}
\DoxyCodeLine{00204   \textcolor{keywordtype}{int} pushLx = Lx + 1;}
\DoxyCodeLine{00205 }
\DoxyCodeLine{00206   \textcolor{comment}{//  TSystem::outputDebug("{}[MWfx("{}+toString(m\_id\_invocazione)+"{}:"{}+toString(num)+"{})<PUSH}}
\DoxyCodeLine{00207   \textcolor{comment}{//  1>]\(\backslash\)tStack Size:"{}+toString((int)}}
\DoxyCodeLine{00208   \textcolor{comment}{//  m\_sSStack.size())+"{}\(\backslash\)tLx:"{}+toString(Lx)+"{}\(\backslash\)tRx:"{}+toString(Rx)+"{}\(\backslash\)tpLx:"{}+toString(pushLx)+"{}\(\backslash\)tpRx:"{}+toString(pushRx)+"{}\(\backslash\)ty:"{}+toString(y)+"{}\(\backslash\)tdir:"{}+toString(dir)+"{}\(\backslash\)n"{});}}
\DoxyCodeLine{00209   assert((Lx <= Rx) \&\& (pushLx <= pushRx) \&\& (Lx >= 0));}
\DoxyCodeLine{00210   m\_sSStack.push(\mbox{\hyperlink{class_shadow_segment}{ShadowSegment}}(Lx, Rx, pushLx, pushRx, (y + dir), dir));}
\DoxyCodeLine{00211   shadowEnqueued++;}
\DoxyCodeLine{00212 }
\DoxyCodeLine{00213   \textcolor{keywordflow}{if} (Rx > pRx) \{  \textcolor{comment}{// U-\/turn a destra}}
\DoxyCodeLine{00214                    \textcolor{comment}{//  TSystem::outputDebug("{}[MWfx("{}+toString(m\_id\_invocazione)+"{}:"{}+toString(num)+"{})<PUSH}}
\DoxyCodeLine{00215                    \textcolor{comment}{//  2>]\(\backslash\)tStack Size:"{}+toString((int)}}
\DoxyCodeLine{00216                    \textcolor{comment}{//  m\_sSStack.size())+"{}\(\backslash\)tLx:"{}+toString(pRx+1)+"{}\(\backslash\)tRx:"{}+toString(Rx)+"{}\(\backslash\)tpLx:"{}+toString(pushLx)+"{}\(\backslash\)tpRx:"{}+toString(pushRx)+"{}\(\backslash\)ty:"{}+toString(y-\/dir)+"{}\(\backslash\)tdir:"{}+toString(dir)+"{}\(\backslash\)n"{});}}
\DoxyCodeLine{00217     assert(((pRx + 1) <= (Rx)) \&\& (pushLx <= pushRx) \&\& ((pRx + 1) >= 0));}
\DoxyCodeLine{00218     m\_sSStack.push(}
\DoxyCodeLine{00219         \mbox{\hyperlink{class_shadow_segment}{ShadowSegment}}((pRx + 1), Rx, pushLx, pushRx, (y -\/ dir), (-\/dir)));}
\DoxyCodeLine{00220     shadowEnqueued++;}
\DoxyCodeLine{00221   \}}
\DoxyCodeLine{00222   \textcolor{keywordflow}{if} (Lx < pLx) \{  \textcolor{comment}{// U-\/turn a sinistra}}
\DoxyCodeLine{00223                    \textcolor{comment}{//    TSystem::outputDebug("{}[MWfx("{}+toString(m\_id\_invocazione)+"{}:"{}+toString(num)+"{})<PUSH}}
\DoxyCodeLine{00224                    \textcolor{comment}{//    3>]\(\backslash\)tStack Size:"{}+toString((int)}}
\DoxyCodeLine{00225                    \textcolor{comment}{//    m\_sSStack.size())+"{}\(\backslash\)tLx:"{}+toString(Lx)+"{}\(\backslash\)tRx:"{}+toString(pLx-\/1)+"{}\(\backslash\)tpLx:"{}+toString(pushLx)+"{}\(\backslash\)tpRx:"{}+toString(pushRx)+"{}\(\backslash\)ty:"{}+toString(y-\/dir)+"{}\(\backslash\)tdir:"{}+toString(dir)+"{}\(\backslash\)n"{});}}
\DoxyCodeLine{00226     assert(((Lx) <= (pLx -\/ 1)) \&\& (pushLx <= pushRx) \&\& (Lx >= 0));}
\DoxyCodeLine{00227     m\_sSStack.push(}
\DoxyCodeLine{00228         \mbox{\hyperlink{class_shadow_segment}{ShadowSegment}}(Lx, (pLx -\/ 1), pushLx, pushRx, (y -\/ dir), (-\/dir)));}
\DoxyCodeLine{00229     shadowEnqueued++;}
\DoxyCodeLine{00230   \}}
\DoxyCodeLine{00231   \textcolor{comment}{// W-\/Turn = 2 U-\/Turn}}
\DoxyCodeLine{00232 \}  \textcolor{comment}{// EnqueueSegment}}

\end{DoxyCode}
\mbox{\Hypertarget{class_magic_wand_fx_a7d2feb7bbc02ba3a6fcbf6f8b315d965}\label{class_magic_wand_fx_a7d2feb7bbc02ba3a6fcbf6f8b315d965}} 
\index{MagicWandFx@{MagicWandFx}!getBBox@{getBBox}}
\index{getBBox@{getBBox}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{getBBox()}{getBBox()}}
{\footnotesize\ttfamily bool Magic\+Wand\+Fx\+::get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{TPixel32 \&}]{bg\+Color }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00101                                                               \{}
\DoxyCodeLine{00102     \textcolor{keywordflow}{return} m\_input-\/>getBBox(frame, rect, bgColor);}
\DoxyCodeLine{00103   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_magic_wand_fx_aa2223bc330cdf655d423167051e9d9d4}\label{class_magic_wand_fx_aa2223bc330cdf655d423167051e9d9d4}} 
\index{MagicWandFx@{MagicWandFx}!getInvalidRect@{getInvalidRect}}
\index{getInvalidRect@{getInvalidRect}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{getInvalidRect()}{getInvalidRect()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_rect_t}{TRect}} Magic\+Wand\+Fx\+::get\+Invalid\+Rect (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRect}} \&}]{max }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00570 \{ \textcolor{keywordflow}{return} max; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_magic_wand_fx_afbd8a712be827d95f4e9a23103084d8e}\label{class_magic_wand_fx_afbd8a712be827d95f4e9a23103084d8e}} 
\index{MagicWandFx@{MagicWandFx}!pixelProcessor@{pixelProcessor}}
\index{pixelProcessor@{pixelProcessor}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{pixelProcessor()}{pixelProcessor()}}
{\footnotesize\ttfamily bool Magic\+Wand\+Fx\+::pixel\+Processor (\begin{DoxyParamCaption}\item[{TPixel32 $\ast$}]{test\+Pix,  }\item[{\mbox{\hyperlink{class_t_pixel_g_r8}{TPixel\+GR8}} $\ast$}]{mask\+Pix }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00138                                                                       \{}
\DoxyCodeLine{00139   pixelProcessed++;}
\DoxyCodeLine{00140   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} maskValue = 0;}
\DoxyCodeLine{00141   \textcolor{keywordtype}{double} diff            = 0;}
\DoxyCodeLine{00142 }
\DoxyCodeLine{00143   \textcolor{comment}{// valuto la distanza tra il testPix ed il SEED e la metto in diff}}
\DoxyCodeLine{00144   \textcolor{keywordflow}{if} (m\_euclid) \{}
\DoxyCodeLine{00145     \textcolor{comment}{// calcolo la Distanza Euclidea tra i punti nello spazio RGB}}
\DoxyCodeLine{00146     diff = sqrt((m\_pickedPix-\/>r -\/ testPix-\/>r) * (m\_pickedPix-\/>r -\/ testPix-\/>r) +}
\DoxyCodeLine{00147                 (m\_pickedPix-\/>g -\/ testPix-\/>g) * (m\_pickedPix-\/>g -\/ testPix-\/>g) +}
\DoxyCodeLine{00148                 (m\_pickedPix-\/>b -\/ testPix-\/>b) * (m\_pickedPix-\/>b -\/ testPix-\/>b));}
\DoxyCodeLine{00149   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00150     \textcolor{comment}{// GIMP-\/like: confronto la tolleranza con il massimo tra gli scarti delle}}
\DoxyCodeLine{00151     \textcolor{comment}{// componenti}}
\DoxyCodeLine{00152     diff                       = abs(m\_pickedPix-\/>r -\/ testPix-\/>r);}
\DoxyCodeLine{00153     \textcolor{keywordtype}{double} diffNext            = abs(m\_pickedPix-\/>g -\/ testPix-\/>g);}
\DoxyCodeLine{00154     \textcolor{keywordflow}{if} (diffNext >= diff) diff = diffNext;}
\DoxyCodeLine{00155     diffNext                   = abs(m\_pickedPix-\/>b -\/ testPix-\/>b);}
\DoxyCodeLine{00156     \textcolor{keywordflow}{if} (diffNext >= diff) diff = diffNext;}
\DoxyCodeLine{00157   \}}
\DoxyCodeLine{00158 }
\DoxyCodeLine{00159   \textcolor{keywordflow}{if} (diff <= m\_tol)}
\DoxyCodeLine{00160     maskValue = FullPixel;}
\DoxyCodeLine{00161   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00162     maskValue = EmptyPixel;}
\DoxyCodeLine{00163 }
\DoxyCodeLine{00164   \textcolor{keywordflow}{if} (maskValue) \{}
\DoxyCodeLine{00165     \textcolor{comment}{// il pixel soddisfa il criterio di compatibilita}}
\DoxyCodeLine{00166 }
\DoxyCodeLine{00167     \textcolor{keywordflow}{if} (m\_add) \{}
\DoxyCodeLine{00168       \textcolor{comment}{// sto aggiungendo selezioni}}
\DoxyCodeLine{00169       \textcolor{keywordflow}{if} (testPix-\/>m != EmptyPixel) \{}
\DoxyCodeLine{00170         pixelReprocessed++;}
\DoxyCodeLine{00171         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00172       \}  \textcolor{comment}{// gia' trattato}}
\DoxyCodeLine{00173 }
\DoxyCodeLine{00174       \textcolor{comment}{//* DECIDERE SE VOGLIO CHE LA SELEZIONE INTERESSI AREE GIA' SELEZIONATE IN}}
\DoxyCodeLine{00175       \textcolor{comment}{// PRECEDENZA}}
\DoxyCodeLine{00176       \textcolor{comment}{//      if (maskPix-\/>value == EmptyPixel) \{ //pixel c-\/compatibile, non}}
\DoxyCodeLine{00177       \textcolor{comment}{//      gia' mascherato}}
\DoxyCodeLine{00178       testPix-\/>m     = maskValue;  \textcolor{comment}{// set(mV)m}}
\DoxyCodeLine{00179       maskPix-\/>value = maskValue;  \textcolor{comment}{// set(mV)a}}
\DoxyCodeLine{00180       pixelMasked++;}
\DoxyCodeLine{00181       \textcolor{comment}{//      \} else \{ // pixel c-\/compatibile gia' mascherato precedentemente}}
\DoxyCodeLine{00182       \textcolor{comment}{//               testPix-\/>m = maskValue;  // set(mV)m}}
\DoxyCodeLine{00183       \textcolor{comment}{//     \}}}
\DoxyCodeLine{00184     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_sub) \{}
\DoxyCodeLine{00185       \textcolor{comment}{// sto togliendo selezioni}}
\DoxyCodeLine{00186       \textcolor{keywordflow}{if} (testPix-\/>m != EmptyPixel) \textcolor{keywordflow}{return} \textcolor{keyword}{false};  \textcolor{comment}{// gia' trattato}}
\DoxyCodeLine{00187       testPix-\/>m     = maskValue;                  \textcolor{comment}{// set(mV)m}}
\DoxyCodeLine{00188       maskPix-\/>value = EmptyPixel;                 \textcolor{comment}{// set(0)a}}
\DoxyCodeLine{00189     \} \textcolor{keywordflow}{else} \{                                       \textcolor{comment}{// prima selezione}}
\DoxyCodeLine{00190       \textcolor{keywordflow}{if} (testPix-\/>m != EmptyPixel) \textcolor{keywordflow}{return} \textcolor{keyword}{false};  \textcolor{comment}{// gia' trattato}}
\DoxyCodeLine{00191       testPix-\/>m     = maskValue;                  \textcolor{comment}{// set(mV)m}}
\DoxyCodeLine{00192       maskPix-\/>value = maskValue;                  \textcolor{comment}{// set(mV)a}}
\DoxyCodeLine{00193       pixelMasked++;}
\DoxyCodeLine{00194     \}}
\DoxyCodeLine{00195     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00196   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00197     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00198 \}  \textcolor{comment}{// pixelProcessor}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_magic_wand_fx_a1cb8dac876423c5f4fb60aa1e96edd67}\label{class_magic_wand_fx_a1cb8dac876423c5f4fb60aa1e96edd67}} 
\index{MagicWandFx@{MagicWandFx}!m\_add@{m\_add}}
\index{m\_add@{m\_add}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_add}{m\_add}}
{\footnotesize\ttfamily bool Magic\+Wand\+Fx\+::m\+\_\+add}

\mbox{\Hypertarget{class_magic_wand_fx_a4000784f5a400d6cfe8074cf94672e90}\label{class_magic_wand_fx_a4000784f5a400d6cfe8074cf94672e90}} 
\index{MagicWandFx@{MagicWandFx}!m\_antial@{m\_antial}}
\index{m\_antial@{m\_antial}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_antial}{m\_antial}}
{\footnotesize\ttfamily bool Magic\+Wand\+Fx\+::m\+\_\+antial}

\mbox{\Hypertarget{class_magic_wand_fx_aa301d9eab5ad6dda9f57ce0d8616382e}\label{class_magic_wand_fx_aa301d9eab5ad6dda9f57ce0d8616382e}} 
\index{MagicWandFx@{MagicWandFx}!m\_cont@{m\_cont}}
\index{m\_cont@{m\_cont}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_cont}{m\_cont}}
{\footnotesize\ttfamily int Magic\+Wand\+Fx\+::m\+\_\+cont}

\mbox{\Hypertarget{class_magic_wand_fx_aeebd682a6ae0b84402ac7d64a12ca2e6}\label{class_magic_wand_fx_aeebd682a6ae0b84402ac7d64a12ca2e6}} 
\index{MagicWandFx@{MagicWandFx}!m\_euclid@{m\_euclid}}
\index{m\_euclid@{m\_euclid}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_euclid}{m\_euclid}}
{\footnotesize\ttfamily bool Magic\+Wand\+Fx\+::m\+\_\+euclid}

\mbox{\Hypertarget{class_magic_wand_fx_a0d2c199f206bdd2cc882723a5db38c0e}\label{class_magic_wand_fx_a0d2c199f206bdd2cc882723a5db38c0e}} 
\index{MagicWandFx@{MagicWandFx}!m\_id\_invocazione@{m\_id\_invocazione}}
\index{m\_id\_invocazione@{m\_id\_invocazione}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_id\_invocazione}{m\_id\_invocazione}}
{\footnotesize\ttfamily int Magic\+Wand\+Fx\+::m\+\_\+id\+\_\+invocazione}

\mbox{\Hypertarget{class_magic_wand_fx_a7b1fa845628db6a0562cd8cf85be4074}\label{class_magic_wand_fx_a7b1fa845628db6a0562cd8cf85be4074}} 
\index{MagicWandFx@{MagicWandFx}!m\_imageHeigth@{m\_imageHeigth}}
\index{m\_imageHeigth@{m\_imageHeigth}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_imageHeigth}{m\_imageHeigth}}
{\footnotesize\ttfamily int Magic\+Wand\+Fx\+::m\+\_\+image\+Heigth}

\mbox{\Hypertarget{class_magic_wand_fx_ae8a3aa18de8284b4620b67dc31058dbd}\label{class_magic_wand_fx_ae8a3aa18de8284b4620b67dc31058dbd}} 
\index{MagicWandFx@{MagicWandFx}!m\_imageWidth@{m\_imageWidth}}
\index{m\_imageWidth@{m\_imageWidth}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_imageWidth}{m\_imageWidth}}
{\footnotesize\ttfamily int Magic\+Wand\+Fx\+::m\+\_\+image\+Width}

\mbox{\Hypertarget{class_magic_wand_fx_a42b48c1c1f6ffd5be6c881145ce5d890}\label{class_magic_wand_fx_a42b48c1c1f6ffd5be6c881145ce5d890}} 
\index{MagicWandFx@{MagicWandFx}!m\_maskGR8@{m\_maskGR8}}
\index{m\_maskGR8@{m\_maskGR8}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_maskGR8}{m\_maskGR8}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+GR8P}} Magic\+Wand\+Fx\+::m\+\_\+mask\+GR8}

\mbox{\Hypertarget{class_magic_wand_fx_a621930e5538c380c16c23d66bba2576e}\label{class_magic_wand_fx_a621930e5538c380c16c23d66bba2576e}} 
\index{MagicWandFx@{MagicWandFx}!m\_maskPickedPix@{m\_maskPickedPix}}
\index{m\_maskPickedPix@{m\_maskPickedPix}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_maskPickedPix}{m\_maskPickedPix}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_pixel_g_r8}{TPixel\+GR8}}$\ast$ Magic\+Wand\+Fx\+::m\+\_\+mask\+Picked\+Pix}

\mbox{\Hypertarget{class_magic_wand_fx_a928a10113fe2fe58fb99e9705857a5fc}\label{class_magic_wand_fx_a928a10113fe2fe58fb99e9705857a5fc}} 
\index{MagicWandFx@{MagicWandFx}!m\_pickedPix@{m\_pickedPix}}
\index{m\_pickedPix@{m\_pickedPix}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_pickedPix}{m\_pickedPix}}
{\footnotesize\ttfamily TPixel32$\ast$ Magic\+Wand\+Fx\+::m\+\_\+picked\+Pix}

\mbox{\Hypertarget{class_magic_wand_fx_a14838d2630a6d75f864001c4ccf68b1f}\label{class_magic_wand_fx_a14838d2630a6d75f864001c4ccf68b1f}} 
\index{MagicWandFx@{MagicWandFx}!m\_sSStack@{m\_sSStack}}
\index{m\_sSStack@{m\_sSStack}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_sSStack}{m\_sSStack}}
{\footnotesize\ttfamily Shadow\+Segment\+Stack Magic\+Wand\+Fx\+::m\+\_\+s\+SStack}

\mbox{\Hypertarget{class_magic_wand_fx_ae5be830e2a08f1e749fe917599c4edf2}\label{class_magic_wand_fx_ae5be830e2a08f1e749fe917599c4edf2}} 
\index{MagicWandFx@{MagicWandFx}!m\_sub@{m\_sub}}
\index{m\_sub@{m\_sub}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_sub}{m\_sub}}
{\footnotesize\ttfamily bool Magic\+Wand\+Fx\+::m\+\_\+sub}

\mbox{\Hypertarget{class_magic_wand_fx_a2c8334cb3706c41b5c90150004b1e84f}\label{class_magic_wand_fx_a2c8334cb3706c41b5c90150004b1e84f}} 
\index{MagicWandFx@{MagicWandFx}!m\_tol@{m\_tol}}
\index{m\_tol@{m\_tol}!MagicWandFx@{MagicWandFx}}
\doxysubsubsection{\texorpdfstring{m\_tol}{m\_tol}}
{\footnotesize\ttfamily double Magic\+Wand\+Fx\+::m\+\_\+tol}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/stdfx/magicwandfx.\+cpp\end{DoxyCompactItemize}
