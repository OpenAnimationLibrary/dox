\hypertarget{class_iwa___spectrum_fx}{}\doxysection{Iwa\+\_\+\+Spectrum\+Fx Class Reference}
\label{class_iwa___spectrum_fx}\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
Inheritance diagram for Iwa\+\_\+\+Spectrum\+Fx\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=6.000000cm]{class_iwa___spectrum_fx}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_iwa___spectrum_fx_a96fbcb9306c350132e632f8cb9c07573}{do\+Compute}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&settings) override
\item 
\mbox{\Hypertarget{class_iwa___spectrum_fx_a51bedce5567aac6da752b964b1792587}\label{class_iwa___spectrum_fx_a51bedce5567aac6da752b964b1792587}} 
void {\bfseries do\+Compute\+\_\+\+CUDA} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&settings)
\item 
bool \mbox{\hyperlink{class_iwa___spectrum_fx_a98f3d198ac1dd8a1696b9584c4128bb3}{do\+Get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&b\+Box, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
bool \mbox{\hyperlink{class_iwa___spectrum_fx_a56aafd98327a2b35cb0f62f2d05272d5}{can\+Handle}} (const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info, double frame) override
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_iwa___spectrum_fx_a5350043ea3c286e56e9697fb36999234}{calc\+Bubble\+Map}} (\mbox{\hyperlink{structfloat3}{float3}} $\ast$bubble\+Color, double frame, bool compute\+Angular\+Axis=false)
\item 
{\footnotesize template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ }\\void \mbox{\hyperlink{class_iwa___spectrum_fx_a03eba7e15e83a4b6f69a79708f62e59e}{convert\+Raster}} (const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} ras, \mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} dim, \mbox{\hyperlink{structfloat3}{float3}} $\ast$bubble\+Color)
\item 
{\footnotesize template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ }\\void \mbox{\hyperlink{class_iwa___spectrum_fx_a40978373a1c672bc0f809a0b84709685}{convert\+Raster\+With\+Light}} (const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} ras, \mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} dim, \mbox{\hyperlink{structfloat3}{float3}} $\ast$bubble\+Color, const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} light\+Ras, float light\+Thres, float light\+Intensity)
\item 
{\footnotesize template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ }\\void \mbox{\hyperlink{class_iwa___spectrum_fx_afbc0a2b5bd18b6d1d5b8808530857470}{set\+Source\+Rasters}} (const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} ras, \mbox{\hyperlink{structfloat4}{float4}} $\ast$in\+\_\+out\+\_\+tile\+\_\+host, const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} light\+\_\+ras, \mbox{\hyperlink{structfloat4}{float4}} $\ast$light\+\_\+host, \mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} dim, bool use\+Light)
\item 
{\footnotesize template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ }\\void \mbox{\hyperlink{class_iwa___spectrum_fx_ad062cd6663b5a9cc0bc92bceb302c7f8}{output\+Rasters}} (const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} out\+Ras, \mbox{\hyperlink{structfloat4}{float4}} $\ast$in\+\_\+out\+\_\+tile\+\_\+host, \mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} dim)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} \mbox{\hyperlink{class_iwa___spectrum_fx_a464a1424691340a35190ef3ef6b32fa5}{m\+\_\+input}}
\item 
\mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} \mbox{\hyperlink{class_iwa___spectrum_fx_acb7af7419557dc16a99b2397238f8353}{m\+\_\+light}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_adecc2afe721a5a208b91e2947fbe73b4}{m\+\_\+intensity}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_a1e39402ed2533da2d9939e4e415196cc}{m\+\_\+refractive\+Index}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_a455df5d599012bed4b5b8e7e34f7df10}{m\+\_\+thick\+Max}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_aae986e585027697290171c82298c9858}{m\+\_\+thick\+Min}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_a60b6032144dcd8e1e1d5fa1caff19b02}{m\+\_\+\+RGamma}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_aac03891a2e3717f8f2bebd8c4a2f12e6}{m\+\_\+\+GGamma}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_ad656fc8a7483700a5b0fa7901e53cc5a}{m\+\_\+\+BGamma}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_aa65b07d1e620857457044e47322952b6}{m\+\_\+loop\+Spectrum\+Fade\+Width}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_a352dbe5c9f5dfc1b671d6095a32b21fb}{m\+\_\+spectrum\+Shift}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_aa2d0a997f1fc196b743a7e01e8ecab6e}{m\+\_\+lens\+Factor}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_a9c33308a2ddde8f93150e342384b5395}{m\+\_\+light\+Thres}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___spectrum_fx_a93ff6a5213abef2c2e13ba3505cf8b4d}{m\+\_\+light\+Intensity}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_iwa___spectrum_fx_a1861d7647df755e5ed83b83e3c4488b1}\label{class_iwa___spectrum_fx_a1861d7647df755e5ed83b83e3c4488b1}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{Iwa\_SpectrumFx()}{Iwa\_SpectrumFx()}}
{\footnotesize\ttfamily Iwa\+\_\+\+Spectrum\+Fx\+::\+Iwa\+\_\+\+Spectrum\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00199     : m\_intensity(1.0)}
\DoxyCodeLine{00200     , m\_refractiveIndex(1.25)}
\DoxyCodeLine{00201     , m\_thickMax(1.0)}
\DoxyCodeLine{00202     , m\_thickMin(0.0)}
\DoxyCodeLine{00203     , m\_RGamma(1.0)}
\DoxyCodeLine{00204     , m\_GGamma(1.0)}
\DoxyCodeLine{00205     , m\_BGamma(1.0)}
\DoxyCodeLine{00206     , m\_lensFactor(1.0)}
\DoxyCodeLine{00207     , m\_lightThres(1.0)}
\DoxyCodeLine{00208     , m\_lightIntensity(1.0)}
\DoxyCodeLine{00209     , m\_loopSpectrumFadeWidth(0.0)}
\DoxyCodeLine{00210     , m\_spectrumShift(0.0) \{}
\DoxyCodeLine{00211   \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Source"{}}, m\_input);}
\DoxyCodeLine{00212   \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Light"{}}, m\_light);}
\DoxyCodeLine{00213   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}intensity"{}}, m\_intensity);}
\DoxyCodeLine{00214   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}refractiveIndex"{}}, m\_refractiveIndex);}
\DoxyCodeLine{00215   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}thickMax"{}}, m\_thickMax);}
\DoxyCodeLine{00216   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}thickMin"{}}, m\_thickMin);}
\DoxyCodeLine{00217   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}RGamma"{}}, m\_RGamma);}
\DoxyCodeLine{00218   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}GGamma"{}}, m\_GGamma);}
\DoxyCodeLine{00219   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}BGamma"{}}, m\_BGamma);}
\DoxyCodeLine{00220   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}lensFactor"{}}, m\_lensFactor);}
\DoxyCodeLine{00221   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}lightThres"{}}, m\_lightThres);}
\DoxyCodeLine{00222   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}lightIntensity"{}}, m\_lightIntensity);}
\DoxyCodeLine{00223   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}loopSpectrumFadeWidth"{}}, m\_loopSpectrumFadeWidth);}
\DoxyCodeLine{00224   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}spectrumShift"{}}, m\_spectrumShift);}
\DoxyCodeLine{00225 }
\DoxyCodeLine{00226   m\_intensity-\/>setValueRange(0.0, 8.0);}
\DoxyCodeLine{00227   m\_refractiveIndex-\/>setValueRange(1.0, 3.0);}
\DoxyCodeLine{00228   m\_thickMax-\/>setValueRange(-\/1.5, 2.0);}
\DoxyCodeLine{00229   m\_thickMin-\/>setValueRange(-\/1.5, 2.0);}
\DoxyCodeLine{00230   m\_RGamma-\/>setValueRange(0.001, 1.0);}
\DoxyCodeLine{00231   m\_GGamma-\/>setValueRange(0.001, 1.0);}
\DoxyCodeLine{00232   m\_BGamma-\/>setValueRange(0.001, 1.0);}
\DoxyCodeLine{00233   m\_lensFactor-\/>setValueRange(0.01, 10.0);}
\DoxyCodeLine{00234   m\_lightThres-\/>setValueRange(-\/5.0, 1.0);}
\DoxyCodeLine{00235   m\_lightIntensity-\/>setValueRange(0.0, 1.0);}
\DoxyCodeLine{00236   m\_loopSpectrumFadeWidth-\/>setValueRange(0.0, 1.0);}
\DoxyCodeLine{00237   m\_spectrumShift-\/>setValueRange(-\/10.0, 10.0);}
\DoxyCodeLine{00238 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_iwa___spectrum_fx_a5350043ea3c286e56e9697fb36999234}\label{class_iwa___spectrum_fx_a5350043ea3c286e56e9697fb36999234}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!calcBubbleMap@{calcBubbleMap}}
\index{calcBubbleMap@{calcBubbleMap}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{calcBubbleMap()}{calcBubbleMap()}}
{\footnotesize\ttfamily void Iwa\+\_\+\+Spectrum\+Fx\+::calc\+Bubble\+Map (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structfloat3}{float3}} $\ast$}]{bubble\+Color,  }\item[{double}]{frame,  }\item[{bool}]{compute\+Angular\+Axis = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00019                                                             \{}
\DoxyCodeLine{00020   \textcolor{keywordtype}{int} i, j, k;  \textcolor{comment}{/* bubbleColor[j][k] = [256][3] */}}
\DoxyCodeLine{00021   \textcolor{keywordtype}{float} d;      \textcolor{comment}{/* Thickness of the film (μm) */}}
\DoxyCodeLine{00022   \textcolor{keywordtype}{int} ram;      \textcolor{comment}{/* rambda iterator */}}
\DoxyCodeLine{00023   \textcolor{keywordtype}{float} rambda; \textcolor{comment}{/* wavelength of light (μm) */}}
\DoxyCodeLine{00024   \textcolor{keyword}{struct }REFLECTIVITY \{}
\DoxyCodeLine{00025     \textcolor{comment}{/* transmission and reflection amplitudes for each boundary */}}
\DoxyCodeLine{00026     \textcolor{keywordtype}{float} r\_ab, t\_ab, r\_ba, t\_ba;}
\DoxyCodeLine{00027     \textcolor{keywordtype}{float} r\_real, r\_img; \textcolor{comment}{/* reflection amplitude of the film */}}
\DoxyCodeLine{00028     \textcolor{keywordtype}{float} R;             \textcolor{comment}{/* energy reflectance */}}
\DoxyCodeLine{00029   \} p, s;}
\DoxyCodeLine{00030   \textcolor{keywordtype}{float} R\_final;                   \textcolor{comment}{/* combined energy reflectance */}}
\DoxyCodeLine{00031   \textcolor{keywordtype}{float} phi;                       \textcolor{comment}{/* phase */}}
\DoxyCodeLine{00032   \textcolor{keywordtype}{float} color\_x, color\_y, color\_z; \textcolor{comment}{/* xyz color channels */}}
\DoxyCodeLine{00033 }
\DoxyCodeLine{00034   \textcolor{comment}{/* obtain parameters */}}
\DoxyCodeLine{00035   \textcolor{keywordtype}{float} intensity       = (float)m\_intensity-\/>getValue(frame);}
\DoxyCodeLine{00036   \textcolor{keywordtype}{float} refractiveIndex = (float)m\_refractiveIndex-\/>getValue(frame);}
\DoxyCodeLine{00037   \textcolor{keywordtype}{float} thickMax        = (float)m\_thickMax-\/>getValue(frame);}
\DoxyCodeLine{00038   \textcolor{keywordtype}{float} thickMin        = (float)m\_thickMin-\/>getValue(frame);}
\DoxyCodeLine{00039   \textcolor{keywordtype}{float} rgbGamma[3]     = \{(float)m\_RGamma-\/>getValue(frame),}
\DoxyCodeLine{00040                        (float)m\_GGamma-\/>getValue(frame),}
\DoxyCodeLine{00041                        (float)m\_BGamma-\/>getValue(frame)\};}
\DoxyCodeLine{00042   \textcolor{keywordtype}{float} lensFactor = (float)m\_lensFactor-\/>getValue(frame);}
\DoxyCodeLine{00043   \textcolor{keywordtype}{float} shift      = (float)m\_spectrumShift-\/>getValue(frame);}
\DoxyCodeLine{00044   \textcolor{keywordtype}{float} fadeWidth  = (float)m\_loopSpectrumFadeWidth-\/>getValue(frame) / 2.0f;}
\DoxyCodeLine{00045 }
\DoxyCodeLine{00046   \textcolor{comment}{/* for Iwa\_SpectrumFx, incident angle is fixed to 0,}}
\DoxyCodeLine{00047 \textcolor{comment}{     for Iwa\_SoapBubbleFx, compute for all discrete incident angles*/}}
\DoxyCodeLine{00048   \textcolor{keywordtype}{int} i\_max        = (computeAngularAxis) ? 256 : 1;}
\DoxyCodeLine{00049   \mbox{\hyperlink{structfloat3}{float3}} *bubble\_p = bubbleColor;}
\DoxyCodeLine{00050 }
\DoxyCodeLine{00051   \textcolor{comment}{/* for each discrete incident angle */}}
\DoxyCodeLine{00052   \textcolor{keywordflow}{for} (i = 0; i < i\_max; i++) \{}
\DoxyCodeLine{00053     \textcolor{comment}{/* incident angle (radian) */}}
\DoxyCodeLine{00054     \textcolor{keywordtype}{float} angle\_in = PI / 2.0f / 255.0f * (float)i;}
\DoxyCodeLine{00055     \textcolor{comment}{/* refraction angle (radian) */}}
\DoxyCodeLine{00056     \textcolor{keywordtype}{float} angle\_re = asinf(sinf(angle\_in) / refractiveIndex);}
\DoxyCodeLine{00057 }
\DoxyCodeLine{00058     \textcolor{comment}{/* transmission and reflection amplitudes for each boundary, for each}}
\DoxyCodeLine{00059 \textcolor{comment}{     * polarization */}}
\DoxyCodeLine{00060     \textcolor{keywordtype}{float} cos\_in = cosf(angle\_in);}
\DoxyCodeLine{00061     \textcolor{keywordtype}{float} cos\_re = cosf(angle\_re);}
\DoxyCodeLine{00062 }
\DoxyCodeLine{00063     \textcolor{comment}{// compute the offset in order to make the seam of looped-\/spectrum curved}}
\DoxyCodeLine{00064     \textcolor{comment}{// along the stripe}}
\DoxyCodeLine{00065     \textcolor{keywordtype}{float} seam\_offset = 0.0f;}
\DoxyCodeLine{00066     \textcolor{keywordflow}{if} (fadeWidth != 0.0f) \{  \textcolor{comment}{// if the fade width is 0, the seam does not curve}}
\DoxyCodeLine{00067       \textcolor{keywordtype}{float} base\_light\_diff =}
\DoxyCodeLine{00068           (thickMax + thickMin) / cosf(asinf(1 / refractiveIndex));}
\DoxyCodeLine{00069       \textcolor{keywordtype}{float} offset\_width = 0.5f * (base\_light\_diff -\/ thickMax -\/ thickMin);}
\DoxyCodeLine{00070       seam\_offset        = 0.5f * (base\_light\_diff *}
\DoxyCodeLine{00071                                 cosf(asinf(cosf(angle\_in) / refractiveIndex)) -\/}
\DoxyCodeLine{00072                             thickMax -\/ thickMin -\/ offset\_width);}
\DoxyCodeLine{00073     \}}
\DoxyCodeLine{00074 }
\DoxyCodeLine{00075     \textcolor{comment}{// P-\/polarized light}}
\DoxyCodeLine{00076     p.r\_ab = (cos\_re -\/ refractiveIndex * cos\_in) /}
\DoxyCodeLine{00077              (cos\_re + refractiveIndex * cos\_re);}
\DoxyCodeLine{00078     p.t\_ab = (1.0f -\/ p.r\_ab) / refractiveIndex;}
\DoxyCodeLine{00079     p.r\_ba = -\/p.r\_ab;}
\DoxyCodeLine{00080     p.t\_ba = (1.0f + p.r\_ab) * refractiveIndex;}
\DoxyCodeLine{00081     \textcolor{comment}{// S-\/polarized light}}
\DoxyCodeLine{00082     s.r\_ab = (cos\_in -\/ refractiveIndex * cos\_re) /}
\DoxyCodeLine{00083              (cos\_in + refractiveIndex * cos\_re);}
\DoxyCodeLine{00084     s.t\_ab = 1.0f + s.r\_ab;}
\DoxyCodeLine{00085     s.r\_ba = -\/s.r\_ab;}
\DoxyCodeLine{00086     s.t\_ba = 1.0f -\/ s.r\_ab;}
\DoxyCodeLine{00087 }
\DoxyCodeLine{00088     \textcolor{comment}{/* for each discrete thickness */}}
\DoxyCodeLine{00089     \textcolor{keywordflow}{for} (j = 0; j < 256; j++) \{}
\DoxyCodeLine{00090       \textcolor{comment}{// normalize within 0-\/1 and shift}}
\DoxyCodeLine{00091       \textcolor{keywordtype}{float} t = (float)j / 255.0f + shift;}
\DoxyCodeLine{00092       \textcolor{comment}{// get fractional part}}
\DoxyCodeLine{00093       t -\/= std::floor(t);}
\DoxyCodeLine{00094       \textcolor{comment}{// apply lens factor}}
\DoxyCodeLine{00095       t = powf(t, lensFactor);}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097       \textcolor{keywordtype}{float} tmp\_rgb[2][3];}
\DoxyCodeLine{00098       \textcolor{keywordtype}{float} tmp\_t[2];}
\DoxyCodeLine{00099       \textcolor{keywordtype}{float} tmp\_ratio[2];}
\DoxyCodeLine{00100 }
\DoxyCodeLine{00101       \textcolor{keywordflow}{if} (t < seam\_offset -\/ fadeWidth) \{}
\DoxyCodeLine{00102         tmp\_t[0]     = t + 1.0f;}
\DoxyCodeLine{00103         tmp\_t[1]     = 0;  \textcolor{comment}{// unused}}
\DoxyCodeLine{00104         tmp\_ratio[0] = 1.0f;}
\DoxyCodeLine{00105         tmp\_ratio[1] = 0.0f;}
\DoxyCodeLine{00106       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (t < seam\_offset + fadeWidth) \{}
\DoxyCodeLine{00107         tmp\_t[0]     = t;}
\DoxyCodeLine{00108         tmp\_t[1]     = t + 1.0f;}
\DoxyCodeLine{00109         tmp\_ratio[0] = 0.5f + 0.5f * (t -\/ seam\_offset) / fadeWidth;}
\DoxyCodeLine{00110         tmp\_ratio[1] = 1.0f -\/ tmp\_ratio[0];}
\DoxyCodeLine{00111       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (t > 1.0f + seam\_offset + fadeWidth) \{}
\DoxyCodeLine{00112         tmp\_t[0]     = t -\/ 1.0f;}
\DoxyCodeLine{00113         tmp\_t[1]     = 0;  \textcolor{comment}{// unused}}
\DoxyCodeLine{00114         tmp\_ratio[0] = 1.0f;}
\DoxyCodeLine{00115         tmp\_ratio[1] = 0.0f;}
\DoxyCodeLine{00116       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (t > 1.0f + seam\_offset -\/ fadeWidth) \{}
\DoxyCodeLine{00117         tmp\_t[0]     = t;}
\DoxyCodeLine{00118         tmp\_t[1]     = t -\/ 1.0f;}
\DoxyCodeLine{00119         tmp\_ratio[0] = 0.5f + 0.5f * (1.0f -\/ t + seam\_offset) / fadeWidth;}
\DoxyCodeLine{00120         tmp\_ratio[1] = 1.0f -\/ tmp\_ratio[0];}
\DoxyCodeLine{00121       \} \textcolor{keywordflow}{else} \{  \textcolor{comment}{// no fade}}
\DoxyCodeLine{00122         tmp\_t[0]     = t;}
\DoxyCodeLine{00123         tmp\_t[1]     = 0;  \textcolor{comment}{// unused}}
\DoxyCodeLine{00124         tmp\_ratio[0] = 1.0f;}
\DoxyCodeLine{00125         tmp\_ratio[1] = 0.0f;}
\DoxyCodeLine{00126       \}}
\DoxyCodeLine{00127 }
\DoxyCodeLine{00128       \textcolor{comment}{/* compute colors for two thickness values and fade them*/}}
\DoxyCodeLine{00129       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} fadeId = 0; fadeId < 2; fadeId++) \{}
\DoxyCodeLine{00130         \textcolor{comment}{// if composite ratio is 0, skip computing}}
\DoxyCodeLine{00131         \textcolor{keywordflow}{if} (tmp\_ratio[fadeId] == 0.0f) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00132 }
\DoxyCodeLine{00133         \textcolor{comment}{/* calculate the thickness of film (μm) */}}
\DoxyCodeLine{00134         d = thickMin + (thickMax -\/ thickMin) * tmp\_t[fadeId];}
\DoxyCodeLine{00135 }
\DoxyCodeLine{00136         \textcolor{comment}{/* there may be a case that the thickness is smaller than 0 */}}
\DoxyCodeLine{00137         \textcolor{keywordflow}{if} (d < 0.0f) d = 0.0f;}
\DoxyCodeLine{00138 }
\DoxyCodeLine{00139         \textcolor{comment}{/* initialize XYZ color channels */}}
\DoxyCodeLine{00140         color\_x = 0.0f;}
\DoxyCodeLine{00141         color\_y = 0.0f;}
\DoxyCodeLine{00142         color\_z = 0.0f;}
\DoxyCodeLine{00143 }
\DoxyCodeLine{00144         \textcolor{comment}{/* for each wavelength (in the range of visible light, 380nm-\/710nm) */}}
\DoxyCodeLine{00145         \textcolor{keywordflow}{for} (ram = 0; ram < 34; ram++) \{}
\DoxyCodeLine{00146           \textcolor{comment}{/* wavelength `λ` (μm) */}}
\DoxyCodeLine{00147           rambda = 0.38f + 0.01f * (float)ram;}
\DoxyCodeLine{00148           \textcolor{comment}{/* phase of light */}}
\DoxyCodeLine{00149           phi = 4.0f * PI * refractiveIndex * d * cos\_re / rambda;}
\DoxyCodeLine{00150           \textcolor{comment}{/* reflection amplitude of the film for each polarization */}}
\DoxyCodeLine{00151           \textcolor{comment}{// P-\/polarized light}}
\DoxyCodeLine{00152           p.r\_real = p.r\_ab + p.t\_ab * p.r\_ba * p.t\_ba * cosf(phi);}
\DoxyCodeLine{00153           p.r\_img  = p.t\_ab * p.r\_ba * p.t\_ba * sinf(phi);}
\DoxyCodeLine{00154           \textcolor{comment}{// S-\/polarized light}}
\DoxyCodeLine{00155           s.r\_real = s.r\_ab + s.t\_ab * s.r\_ba * s.t\_ba * cosf(phi);}
\DoxyCodeLine{00156           s.r\_img  = s.t\_ab * s.r\_ba * s.t\_ba * sinf(phi);}
\DoxyCodeLine{00157 }
\DoxyCodeLine{00158           p.R = p.r\_real * p.r\_real + p.r\_img * p.r\_img;}
\DoxyCodeLine{00159           s.R = s.r\_real * s.r\_real + s.r\_img * s.r\_img;}
\DoxyCodeLine{00160 }
\DoxyCodeLine{00161           \textcolor{comment}{/* combined energy reflectance */}}
\DoxyCodeLine{00162           R\_final = (p.R + s.R) / 2.0f;}
\DoxyCodeLine{00163 }
\DoxyCodeLine{00164           \textcolor{comment}{/* accumulate XYZ channel values */}}
\DoxyCodeLine{00165           color\_x += intensity * cie\_d65[ram] * R\_final * xyz[ram * 3 + 0];}
\DoxyCodeLine{00166           color\_y += intensity * cie\_d65[ram] * R\_final * xyz[ram * 3 + 1];}
\DoxyCodeLine{00167           color\_z += intensity * cie\_d65[ram] * R\_final * xyz[ram * 3 + 2];}
\DoxyCodeLine{00168 }
\DoxyCodeLine{00169         \} \textcolor{comment}{/* next wavelength (ram) */}}
\DoxyCodeLine{00170 }
\DoxyCodeLine{00171         tmp\_rgb[fadeId][0] =}
\DoxyCodeLine{00172             3.240479f * color\_x -\/ 1.537150f * color\_y -\/ 0.498535f * color\_z;}
\DoxyCodeLine{00173         tmp\_rgb[fadeId][1] =}
\DoxyCodeLine{00174             -\/0.969256f * color\_x + 1.875992f * color\_y + 0.041556f * color\_z;}
\DoxyCodeLine{00175         tmp\_rgb[fadeId][2] =}
\DoxyCodeLine{00176             0.055648f * color\_x -\/ 0.204043f * color\_y + 1.057311f * color\_z;}
\DoxyCodeLine{00177 }
\DoxyCodeLine{00178         \textcolor{comment}{/* clamp overflows */}}
\DoxyCodeLine{00179         \textcolor{keywordflow}{for} (k = 0; k < 3; k++) \{}
\DoxyCodeLine{00180           \textcolor{keywordflow}{if} (tmp\_rgb[fadeId][k] < 0.0f) tmp\_rgb[fadeId][k] = 0.0f;}
\DoxyCodeLine{00181 }
\DoxyCodeLine{00182           \textcolor{comment}{/* gamma adjustment */}}
\DoxyCodeLine{00183           tmp\_rgb[fadeId][k] = powf((tmp\_rgb[fadeId][k] / 255.0f), rgbGamma[k]);}
\DoxyCodeLine{00184 }
\DoxyCodeLine{00185           \textcolor{keywordflow}{if} (tmp\_rgb[fadeId][k] >= 1.0f) tmp\_rgb[fadeId][k] = 1.0f;}
\DoxyCodeLine{00186         \}}
\DoxyCodeLine{00187       \}}
\DoxyCodeLine{00188       bubble\_p-\/>x = tmp\_rgb[0][0] * tmp\_ratio[0] + tmp\_rgb[1][0] * tmp\_ratio[1];}
\DoxyCodeLine{00189       bubble\_p-\/>y = tmp\_rgb[0][1] * tmp\_ratio[0] + tmp\_rgb[1][1] * tmp\_ratio[1];}
\DoxyCodeLine{00190       bubble\_p-\/>z = tmp\_rgb[0][2] * tmp\_ratio[0] + tmp\_rgb[1][2] * tmp\_ratio[1];}
\DoxyCodeLine{00191       bubble\_p++;}
\DoxyCodeLine{00192 }
\DoxyCodeLine{00193     \} \textcolor{comment}{/*-\/ next thickness d (j) -\/*/}}
\DoxyCodeLine{00194   \}   \textcolor{comment}{/*-\/ next incident angle (i) -\/*/}}
\DoxyCodeLine{00195 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___spectrum_fx_a56aafd98327a2b35cb0f62f2d05272d5}\label{class_iwa___spectrum_fx_a56aafd98327a2b35cb0f62f2d05272d5}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!canHandle@{canHandle}}
\index{canHandle@{canHandle}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{canHandle()}{canHandle()}}
{\footnotesize\ttfamily bool Iwa\+\_\+\+Spectrum\+Fx\+::can\+Handle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info,  }\item[{double}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00542                                                                         \{}
\DoxyCodeLine{00543   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00544 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___spectrum_fx_a03eba7e15e83a4b6f69a79708f62e59e}\label{class_iwa___spectrum_fx_a03eba7e15e83a4b6f69a79708f62e59e}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!convertRaster@{convertRaster}}
\index{convertRaster@{convertRaster}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{convertRaster()}{convertRaster()}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ \\
void Iwa\+\_\+\+Spectrum\+Fx\+::convert\+Raster (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}}}]{ras,  }\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimensionI}}}]{dim,  }\item[{\mbox{\hyperlink{structfloat3}{float3}} $\ast$}]{bubble\+Color }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00305                                                         \{}
\DoxyCodeLine{00306   \textcolor{keywordtype}{float} rr, gg, bb, aa;}
\DoxyCodeLine{00307   \textcolor{keywordtype}{float} spec\_r, spec\_g, spec\_b;}
\DoxyCodeLine{00308   \textcolor{keywordtype}{float} brightness;}
\DoxyCodeLine{00309   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dim.ly; j++) \{}
\DoxyCodeLine{00310     PIXEL *pix = ras-\/>pixels(j);}
\DoxyCodeLine{00311     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim.lx; i++) \{}
\DoxyCodeLine{00312       aa = (float)pix-\/>m / PIXEL::maxChannelValue;}
\DoxyCodeLine{00313       if (aa == 0.0f) \textcolor{comment}{/*-\/ アルファが０なら変化なし -\/*/}}
\DoxyCodeLine{00314       \{}
\DoxyCodeLine{00315         pix++;}
\DoxyCodeLine{00316         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00317       \}}
\DoxyCodeLine{00318       \textcolor{comment}{/*-\/ depremutiplyはしないでおく -\/*/}}
\DoxyCodeLine{00319       rr         = (float)pix-\/>r / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00320       gg         = (float)pix-\/>g / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00321       bb         = (float)pix-\/>b / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00322       brightness = 0.298912f * rr + 0.586611f * gg + 0.114478f * bb;}
\DoxyCodeLine{00323 }
\DoxyCodeLine{00324       \textcolor{comment}{/*-\/ 反転 -\/*/}}
\DoxyCodeLine{00325       brightness = 1.0f -\/ brightness;}
\DoxyCodeLine{00326       \textcolor{comment}{/*-\/ 輝度MAXの場合 -\/*/}}
\DoxyCodeLine{00327       \textcolor{keywordflow}{if} (brightness >= 1.0f) \{}
\DoxyCodeLine{00328         spec\_r = bubbleColor[255].x * aa;}
\DoxyCodeLine{00329         spec\_g = bubbleColor[255].y * aa;}
\DoxyCodeLine{00330         spec\_b = bubbleColor[255].z * aa;}
\DoxyCodeLine{00331       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00332         \textcolor{comment}{/*-\/ 線形補間する -\/*/}}
\DoxyCodeLine{00333         \textcolor{keywordtype}{int} index   = (int)(brightness * 255.0f);}
\DoxyCodeLine{00334         \textcolor{keywordtype}{float} ratio = brightness * 255.0f -\/ (float)index;}
\DoxyCodeLine{00335 }
\DoxyCodeLine{00336         spec\_r = bubbleColor[index].x * (1.0f -\/ ratio) +}
\DoxyCodeLine{00337                  bubbleColor[index + 1].x * ratio;}
\DoxyCodeLine{00338         spec\_g = bubbleColor[index].y * (1.0f -\/ ratio) +}
\DoxyCodeLine{00339                  bubbleColor[index + 1].y * ratio;}
\DoxyCodeLine{00340         spec\_b = bubbleColor[index].z * (1.0f -\/ ratio) +}
\DoxyCodeLine{00341                  bubbleColor[index + 1].z * ratio;}
\DoxyCodeLine{00342         spec\_r *= aa;}
\DoxyCodeLine{00343         spec\_g *= aa;}
\DoxyCodeLine{00344         spec\_b *= aa;}
\DoxyCodeLine{00345       \}}
\DoxyCodeLine{00346       \textcolor{comment}{/*-\/ 元のピクセルに書き戻す -\/*/}}
\DoxyCodeLine{00347       \textcolor{keywordtype}{float} val;}
\DoxyCodeLine{00348       \textcolor{comment}{/*-\/ チャンネル範囲にクランプ -\/*/}}
\DoxyCodeLine{00349       val    = spec\_r * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00350       pix-\/>r = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00351                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00352                                              : val);}
\DoxyCodeLine{00353       val    = spec\_g * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00354       pix-\/>g = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00355                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00356                                              : val);}
\DoxyCodeLine{00357       val    = spec\_b * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00358       pix-\/>b = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00359                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00360                                              : val);}
\DoxyCodeLine{00361 }
\DoxyCodeLine{00362       pix++;}
\DoxyCodeLine{00363     \}}
\DoxyCodeLine{00364   \}}
\DoxyCodeLine{00365 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___spectrum_fx_a40978373a1c672bc0f809a0b84709685}\label{class_iwa___spectrum_fx_a40978373a1c672bc0f809a0b84709685}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!convertRasterWithLight@{convertRasterWithLight}}
\index{convertRasterWithLight@{convertRasterWithLight}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{convertRasterWithLight()}{convertRasterWithLight()}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ \\
void Iwa\+\_\+\+Spectrum\+Fx\+::convert\+Raster\+With\+Light (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}}}]{ras,  }\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimensionI}}}]{dim,  }\item[{\mbox{\hyperlink{structfloat3}{float3}} $\ast$}]{bubble\+Color,  }\item[{const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}}}]{light\+Ras,  }\item[{float}]{light\+Thres,  }\item[{float}]{light\+Intensity }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00373                                                                   \{}
\DoxyCodeLine{00374   \textcolor{keywordtype}{float} rr, gg, bb, aa;}
\DoxyCodeLine{00375   \textcolor{keywordtype}{float} spec\_r, spec\_g, spec\_b;}
\DoxyCodeLine{00376   \textcolor{keywordtype}{float} brightness;}
\DoxyCodeLine{00377   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dim.ly; j++) \{}
\DoxyCodeLine{00378     PIXEL *light\_pix = lightRas-\/>pixels(j);}
\DoxyCodeLine{00379     PIXEL *pix       = ras-\/>pixels(j);}
\DoxyCodeLine{00380     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim.lx; i++) \{}
\DoxyCodeLine{00381       aa = (float)light\_pix-\/>m / PIXEL::maxChannelValue;}
\DoxyCodeLine{00382       if (aa == 0.0f) \textcolor{comment}{/*-\/ アルファが０なら透明にする -\/*/}}
\DoxyCodeLine{00383       \{}
\DoxyCodeLine{00384         *pix = PIXEL::Transparent;}
\DoxyCodeLine{00385         light\_pix++;}
\DoxyCodeLine{00386         pix++;}
\DoxyCodeLine{00387         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00388       \}}
\DoxyCodeLine{00389       \textcolor{comment}{/*-\/ depremutiplyはしないでおく -\/*/}}
\DoxyCodeLine{00390       rr         = (float)pix-\/>r / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00391       gg         = (float)pix-\/>g / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00392       bb         = (float)pix-\/>b / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00393       brightness = 0.298912f * rr + 0.586611f * gg + 0.114478f * bb;}
\DoxyCodeLine{00394 }
\DoxyCodeLine{00395       \textcolor{comment}{/*-\/ 反転 -\/*/}}
\DoxyCodeLine{00396       brightness = 1.0f -\/ brightness;}
\DoxyCodeLine{00397       \textcolor{comment}{/*-\/ 輝度MAXの場合 -\/*/}}
\DoxyCodeLine{00398       \textcolor{keywordflow}{if} (brightness >= 1.0f) \{}
\DoxyCodeLine{00399         spec\_r = bubbleColor[255].x;}
\DoxyCodeLine{00400         spec\_g = bubbleColor[255].y;}
\DoxyCodeLine{00401         spec\_b = bubbleColor[255].z;}
\DoxyCodeLine{00402       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00403         \textcolor{comment}{/*-\/ 線形補間する -\/*/}}
\DoxyCodeLine{00404         \textcolor{keywordtype}{int} index   = (int)(brightness * 255.0f);}
\DoxyCodeLine{00405         \textcolor{keywordtype}{float} ratio = brightness * 255.0f -\/ (float)index;}
\DoxyCodeLine{00406 }
\DoxyCodeLine{00407         spec\_r = bubbleColor[index].x * (1.0f -\/ ratio) +}
\DoxyCodeLine{00408                  bubbleColor[index + 1].x * ratio;}
\DoxyCodeLine{00409         spec\_g = bubbleColor[index].y * (1.0f -\/ ratio) +}
\DoxyCodeLine{00410                  bubbleColor[index + 1].y * ratio;}
\DoxyCodeLine{00411         spec\_b = bubbleColor[index].z * (1.0f -\/ ratio) +}
\DoxyCodeLine{00412                  bubbleColor[index + 1].z * ratio;}
\DoxyCodeLine{00413       \}}
\DoxyCodeLine{00414 }
\DoxyCodeLine{00415       \textcolor{comment}{/*-\/ ここで、Light画像とのスクリーン合成を行う -\/*/}}
\DoxyCodeLine{00416       \textcolor{keywordtype}{float} HDR\_Factor;}
\DoxyCodeLine{00417       \textcolor{keywordflow}{if} (aa <= lightThres || lightThres == 1.0f)}
\DoxyCodeLine{00418         HDR\_Factor = 0.0;}
\DoxyCodeLine{00419       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00420         HDR\_Factor = lightIntensity * (aa -\/ lightThres) / (1.0 -\/ lightThres);}
\DoxyCodeLine{00421 }
\DoxyCodeLine{00422       \textcolor{keywordtype}{float} light\_r = (float)light\_pix-\/>r / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00423       \textcolor{keywordtype}{float} light\_g = (float)light\_pix-\/>g / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00424       \textcolor{keywordtype}{float} light\_b = (float)light\_pix-\/>b / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00425       \textcolor{comment}{/*-\/ スクリーン合成結果と虹色をHDR\_Factorで混ぜる -\/*/}}
\DoxyCodeLine{00426       spec\_r = (1.0f -\/ HDR\_Factor) * spec\_r +}
\DoxyCodeLine{00427                HDR\_Factor * (spec\_r + light\_r -\/ spec\_r * light\_r);}
\DoxyCodeLine{00428       spec\_g = (1.0f -\/ HDR\_Factor) * spec\_g +}
\DoxyCodeLine{00429                HDR\_Factor * (spec\_g + light\_g -\/ spec\_g * light\_g);}
\DoxyCodeLine{00430       spec\_b = (1.0f -\/ HDR\_Factor) * spec\_b +}
\DoxyCodeLine{00431                HDR\_Factor * (spec\_b + light\_b -\/ spec\_b * light\_b);}
\DoxyCodeLine{00432 }
\DoxyCodeLine{00433       spec\_r *= aa;}
\DoxyCodeLine{00434       spec\_g *= aa;}
\DoxyCodeLine{00435       spec\_b *= aa;}
\DoxyCodeLine{00436 }
\DoxyCodeLine{00437       \textcolor{comment}{/*-\/ 元のピクセルに書き戻す -\/*/}}
\DoxyCodeLine{00438       \textcolor{keywordtype}{float} val;}
\DoxyCodeLine{00439       \textcolor{comment}{/*-\/ チャンネル範囲にクランプ -\/*/}}
\DoxyCodeLine{00440       val    = spec\_r * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00441       pix-\/>r = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00442                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00443                                              : val);}
\DoxyCodeLine{00444       val    = spec\_g * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00445       pix-\/>g = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00446                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00447                                              : val);}
\DoxyCodeLine{00448       val    = spec\_b * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00449       pix-\/>b = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00450                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00451                                              : val);}
\DoxyCodeLine{00452 }
\DoxyCodeLine{00453       pix-\/>m = light\_pix-\/>m;}
\DoxyCodeLine{00454 }
\DoxyCodeLine{00455       pix++;}
\DoxyCodeLine{00456       light\_pix++;}
\DoxyCodeLine{00457     \}}
\DoxyCodeLine{00458   \}}
\DoxyCodeLine{00459 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___spectrum_fx_a96fbcb9306c350132e632f8cb9c07573}\label{class_iwa___spectrum_fx_a96fbcb9306c350132e632f8cb9c07573}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!doCompute@{doCompute}}
\index{doCompute@{doCompute}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{doCompute()}{doCompute()}}
{\footnotesize\ttfamily void Iwa\+\_\+\+Spectrum\+Fx\+::do\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{settings }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00242                                                                 \{}
\DoxyCodeLine{00243   \textcolor{keywordflow}{if} (!m\_input.isConnected()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00244 }
\DoxyCodeLine{00245   \textcolor{comment}{/*-\/ 薄膜干渉色マップ -\/*/}}
\DoxyCodeLine{00246   \mbox{\hyperlink{structfloat3}{float3}} *bubbleColor;}
\DoxyCodeLine{00247 }
\DoxyCodeLine{00248   \mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} dim(tile.getRaster()-\/>getLx(), tile.getRaster()-\/>getLy());}
\DoxyCodeLine{00249 }
\DoxyCodeLine{00250   \textcolor{comment}{/*-\/ 256段階で干渉色を計算 -\/*/}}
\DoxyCodeLine{00251   \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} bubbleColor\_ras(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structfloat3}{float3}}) * 256, 1);}
\DoxyCodeLine{00252   bubbleColor\_ras-\/>lock();}
\DoxyCodeLine{00253   bubbleColor = (\mbox{\hyperlink{structfloat3}{float3}} *)bubbleColor\_ras-\/>getRawData();}
\DoxyCodeLine{00254 }
\DoxyCodeLine{00255   \textcolor{comment}{/*-\/ シャボン色マップの生成 -\/*/}}
\DoxyCodeLine{00256   calcBubbleMap(bubbleColor, frame);}
\DoxyCodeLine{00257 }
\DoxyCodeLine{00258   \textcolor{comment}{/*-\/ いったん素材をTileに収める -\/*/}}
\DoxyCodeLine{00259   m\_input-\/>compute(tile, frame, settings);}
\DoxyCodeLine{00260 }
\DoxyCodeLine{00261   \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00262 \textcolor{comment}{   ここで、Lightが刺さっていた場合は、Lightのアルファを使用＆HDRThresでスクリーン合成}}
\DoxyCodeLine{00263 \textcolor{comment}{  -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{00264   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} lightRas = 0;}
\DoxyCodeLine{00265   \textcolor{keywordflow}{if} (m\_light.isConnected()) \{}
\DoxyCodeLine{00266     \mbox{\hyperlink{class_t_tile}{TTile}} light\_tile;}
\DoxyCodeLine{00267     m\_light-\/>allocateAndCompute(light\_tile, tile.m\_pos, dim, tile.getRaster(),}
\DoxyCodeLine{00268                                 frame, settings);}
\DoxyCodeLine{00269 }
\DoxyCodeLine{00270     lightRas = light\_tile.getRaster();}
\DoxyCodeLine{00271     lightRas-\/>lock();}
\DoxyCodeLine{00272   \}}
\DoxyCodeLine{00273 }
\DoxyCodeLine{00274   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})tile.getRaster();}
\DoxyCodeLine{00275   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} ras64 = (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})tile.getRaster();}
\DoxyCodeLine{00276   \{}
\DoxyCodeLine{00277     \textcolor{keywordflow}{if} (ras32) \{}
\DoxyCodeLine{00278       \textcolor{keywordflow}{if} (lightRas)}
\DoxyCodeLine{00279         convertRasterWithLight<TRaster32P, TPixel32>(}
\DoxyCodeLine{00280             ras32, dim, bubbleColor, (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})lightRas,}
\DoxyCodeLine{00281             (\textcolor{keywordtype}{float})m\_lightThres-\/>getValue(frame),}
\DoxyCodeLine{00282             (\textcolor{keywordtype}{float})m\_lightIntensity-\/>getValue(frame));}
\DoxyCodeLine{00283       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00284         convertRaster<TRaster32P, TPixel32>(ras32, dim, bubbleColor);}
\DoxyCodeLine{00285     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ras64) \{}
\DoxyCodeLine{00286       \textcolor{keywordflow}{if} (lightRas)}
\DoxyCodeLine{00287         convertRasterWithLight<TRaster64P, TPixel64>(}
\DoxyCodeLine{00288             ras64, dim, bubbleColor, (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})lightRas,}
\DoxyCodeLine{00289             (\textcolor{keywordtype}{float})m\_lightThres-\/>getValue(frame),}
\DoxyCodeLine{00290             (\textcolor{keywordtype}{float})m\_lightIntensity-\/>getValue(frame));}
\DoxyCodeLine{00291       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00292         convertRaster<TRaster64P, TPixel64>(ras64, dim, bubbleColor);}
\DoxyCodeLine{00293     \}}
\DoxyCodeLine{00294   \}}
\DoxyCodeLine{00295 }
\DoxyCodeLine{00296   \textcolor{comment}{//メモリ解放}}
\DoxyCodeLine{00297   \textcolor{comment}{// brightness\_ras-\/>unlock();}}
\DoxyCodeLine{00298   bubbleColor\_ras-\/>unlock();}
\DoxyCodeLine{00299   \textcolor{keywordflow}{if} (lightRas) lightRas-\/>unlock();}
\DoxyCodeLine{00300 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___spectrum_fx_a98f3d198ac1dd8a1696b9584c4128bb3}\label{class_iwa___spectrum_fx_a98f3d198ac1dd8a1696b9584c4128bb3}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!doGetBBox@{doGetBBox}}
\index{doGetBBox@{doGetBBox}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{doGetBBox()}{doGetBBox()}}
{\footnotesize\ttfamily bool Iwa\+\_\+\+Spectrum\+Fx\+::do\+Get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{b\+Box,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00532                                                             \{}
\DoxyCodeLine{00533   \textcolor{keywordflow}{if} (!m\_input.isConnected()) \{}
\DoxyCodeLine{00534     bBox = \mbox{\hyperlink{class_t_rect_t}{TRectD}}();}
\DoxyCodeLine{00535     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00536   \}}
\DoxyCodeLine{00537   \textcolor{keywordflow}{return} m\_input-\/>doGetBBox(frame, bBox, info);}
\DoxyCodeLine{00538 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___spectrum_fx_ad062cd6663b5a9cc0bc92bceb302c7f8}\label{class_iwa___spectrum_fx_ad062cd6663b5a9cc0bc92bceb302c7f8}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!outputRasters@{outputRasters}}
\index{outputRasters@{outputRasters}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{outputRasters()}{outputRasters()}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ \\
void Iwa\+\_\+\+Spectrum\+Fx\+::output\+Rasters (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}}}]{out\+Ras,  }\item[{\mbox{\hyperlink{structfloat4}{float4}} $\ast$}]{in\+\_\+out\+\_\+tile\+\_\+host,  }\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimensionI}}}]{dim }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00501                                                                               \{}
\DoxyCodeLine{00502   \mbox{\hyperlink{structfloat4}{float4}} *chann\_p = in\_out\_tile\_host;}
\DoxyCodeLine{00503   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dim.ly; j++) \{}
\DoxyCodeLine{00504     PIXEL *pix = outRas-\/>pixels(j);}
\DoxyCodeLine{00505     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim.lx; i++) \{}
\DoxyCodeLine{00506       \textcolor{keywordtype}{float} val;}
\DoxyCodeLine{00507       val    = (*chann\_p).x * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00508       pix-\/>r = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00509                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00510                                              : val);}
\DoxyCodeLine{00511       val    = (*chann\_p).y * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00512       pix-\/>g = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00513                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00514                                              : val);}
\DoxyCodeLine{00515       val    = (*chann\_p).z * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00516       pix-\/>b = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00517                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00518                                              : val);}
\DoxyCodeLine{00519       val    = (*chann\_p).w * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00520       pix-\/>m = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00521                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00522                                              : val);}
\DoxyCodeLine{00523       pix++;}
\DoxyCodeLine{00524       chann\_p++;}
\DoxyCodeLine{00525     \}}
\DoxyCodeLine{00526   \}}
\DoxyCodeLine{00527 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___spectrum_fx_afbc0a2b5bd18b6d1d5b8808530857470}\label{class_iwa___spectrum_fx_afbc0a2b5bd18b6d1d5b8808530857470}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!setSourceRasters@{setSourceRasters}}
\index{setSourceRasters@{setSourceRasters}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{setSourceRasters()}{setSourceRasters()}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ \\
void Iwa\+\_\+\+Spectrum\+Fx\+::set\+Source\+Rasters (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}}}]{ras,  }\item[{\mbox{\hyperlink{structfloat4}{float4}} $\ast$}]{in\+\_\+out\+\_\+tile\+\_\+host,  }\item[{const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}}}]{light\+\_\+ras,  }\item[{\mbox{\hyperlink{structfloat4}{float4}} $\ast$}]{light\+\_\+host,  }\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimensionI}}}]{dim,  }\item[{bool}]{use\+Light }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00469                                                      \{}
\DoxyCodeLine{00470   \mbox{\hyperlink{structfloat4}{float4}} *chann\_p      = in\_out\_tile\_host;}
\DoxyCodeLine{00471   \mbox{\hyperlink{structfloat4}{float4}} *lightChann\_p = light\_host;}
\DoxyCodeLine{00472 }
\DoxyCodeLine{00473   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dim.ly; j++) \{}
\DoxyCodeLine{00474     PIXEL *pix      = ras-\/>pixels(j);}
\DoxyCodeLine{00475     PIXEL *lightPix = (useLight) ? light\_ras-\/>pixels(j) : 0;}
\DoxyCodeLine{00476     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim.lx; i++) \{}
\DoxyCodeLine{00477       (*chann\_p).x = (float)pix-\/>r / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00478       (*chann\_p).y = (float)pix-\/>g / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00479       (*chann\_p).z = (float)pix-\/>b / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00480       (*chann\_p).w = (float)pix-\/>m / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00481       pix++;}
\DoxyCodeLine{00482       chann\_p++;}
\DoxyCodeLine{00483 }
\DoxyCodeLine{00484       \textcolor{keywordflow}{if} (useLight) \{}
\DoxyCodeLine{00485         (*lightChann\_p).x = (float)lightPix-\/>r / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00486         (*lightChann\_p).y = (float)lightPix-\/>g / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00487         (*lightChann\_p).z = (float)lightPix-\/>b / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00488         (*lightChann\_p).w = (float)lightPix-\/>m / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00489         lightPix++;}
\DoxyCodeLine{00490         lightChann\_p++;}
\DoxyCodeLine{00491       \}}
\DoxyCodeLine{00492     \}}
\DoxyCodeLine{00493   \}}
\DoxyCodeLine{00494 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_iwa___spectrum_fx_ad656fc8a7483700a5b0fa7901e53cc5a}\label{class_iwa___spectrum_fx_ad656fc8a7483700a5b0fa7901e53cc5a}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_BGamma@{m\_BGamma}}
\index{m\_BGamma@{m\_BGamma}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_BGamma}{m\_BGamma}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+\+BGamma\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_aac03891a2e3717f8f2bebd8c4a2f12e6}\label{class_iwa___spectrum_fx_aac03891a2e3717f8f2bebd8c4a2f12e6}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_GGamma@{m\_GGamma}}
\index{m\_GGamma@{m\_GGamma}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_GGamma}{m\_GGamma}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+\+GGamma\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_a464a1424691340a35190ef3ef6b32fa5}\label{class_iwa___spectrum_fx_a464a1424691340a35190ef3ef6b32fa5}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_input@{m\_input}}
\index{m\_input@{m\_input}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_input}{m\_input}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+input\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_adecc2afe721a5a208b91e2947fbe73b4}\label{class_iwa___spectrum_fx_adecc2afe721a5a208b91e2947fbe73b4}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_intensity@{m\_intensity}}
\index{m\_intensity@{m\_intensity}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_intensity}{m\_intensity}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+intensity\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_aa2d0a997f1fc196b743a7e01e8ecab6e}\label{class_iwa___spectrum_fx_aa2d0a997f1fc196b743a7e01e8ecab6e}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_lensFactor@{m\_lensFactor}}
\index{m\_lensFactor@{m\_lensFactor}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_lensFactor}{m\_lensFactor}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+lens\+Factor\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_acb7af7419557dc16a99b2397238f8353}\label{class_iwa___spectrum_fx_acb7af7419557dc16a99b2397238f8353}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_light@{m\_light}}
\index{m\_light@{m\_light}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_light}{m\_light}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+light\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_a93ff6a5213abef2c2e13ba3505cf8b4d}\label{class_iwa___spectrum_fx_a93ff6a5213abef2c2e13ba3505cf8b4d}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_lightIntensity@{m\_lightIntensity}}
\index{m\_lightIntensity@{m\_lightIntensity}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_lightIntensity}{m\_lightIntensity}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+light\+Intensity\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_a9c33308a2ddde8f93150e342384b5395}\label{class_iwa___spectrum_fx_a9c33308a2ddde8f93150e342384b5395}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_lightThres@{m\_lightThres}}
\index{m\_lightThres@{m\_lightThres}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_lightThres}{m\_lightThres}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+light\+Thres\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_aa65b07d1e620857457044e47322952b6}\label{class_iwa___spectrum_fx_aa65b07d1e620857457044e47322952b6}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_loopSpectrumFadeWidth@{m\_loopSpectrumFadeWidth}}
\index{m\_loopSpectrumFadeWidth@{m\_loopSpectrumFadeWidth}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_loopSpectrumFadeWidth}{m\_loopSpectrumFadeWidth}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+loop\+Spectrum\+Fade\+Width\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_a1e39402ed2533da2d9939e4e415196cc}\label{class_iwa___spectrum_fx_a1e39402ed2533da2d9939e4e415196cc}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_refractiveIndex@{m\_refractiveIndex}}
\index{m\_refractiveIndex@{m\_refractiveIndex}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_refractiveIndex}{m\_refractiveIndex}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+refractive\+Index\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_a60b6032144dcd8e1e1d5fa1caff19b02}\label{class_iwa___spectrum_fx_a60b6032144dcd8e1e1d5fa1caff19b02}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_RGamma@{m\_RGamma}}
\index{m\_RGamma@{m\_RGamma}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_RGamma}{m\_RGamma}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+\+RGamma\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_a352dbe5c9f5dfc1b671d6095a32b21fb}\label{class_iwa___spectrum_fx_a352dbe5c9f5dfc1b671d6095a32b21fb}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_spectrumShift@{m\_spectrumShift}}
\index{m\_spectrumShift@{m\_spectrumShift}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_spectrumShift}{m\_spectrumShift}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+spectrum\+Shift\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_a455df5d599012bed4b5b8e7e34f7df10}\label{class_iwa___spectrum_fx_a455df5d599012bed4b5b8e7e34f7df10}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_thickMax@{m\_thickMax}}
\index{m\_thickMax@{m\_thickMax}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_thickMax}{m\_thickMax}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+thick\+Max\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___spectrum_fx_aae986e585027697290171c82298c9858}\label{class_iwa___spectrum_fx_aae986e585027697290171c82298c9858}} 
\index{Iwa\_SpectrumFx@{Iwa\_SpectrumFx}!m\_thickMin@{m\_thickMin}}
\index{m\_thickMin@{m\_thickMin}!Iwa\_SpectrumFx@{Iwa\_SpectrumFx}}
\doxysubsubsection{\texorpdfstring{m\_thickMin}{m\_thickMin}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Spectrum\+Fx\+::m\+\_\+thick\+Min\hspace{0.3cm}{\ttfamily [protected]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/stdfx/iwa\+\_\+spectrumfx.\+h\item 
E\+:/opentoonz/toonz/sources/stdfx/iwa\+\_\+spectrumfx.\+cpp\end{DoxyCompactItemize}
