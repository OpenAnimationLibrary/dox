\hypertarget{class_control_point_editor_tool}{}\doxysection{Control\+Point\+Editor\+Tool Class Reference}
\label{class_control_point_editor_tool}\index{ControlPointEditorTool@{ControlPointEditorTool}}
Inheritance diagram for Control\+Point\+Editor\+Tool\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_control_point_editor_tool}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296c}{Tool\+Type}} \mbox{\hyperlink{class_control_point_editor_tool_a99d944ccfe4e56bc95baba496ef943d4}{get\+Tool\+Type}} () const override
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a77c68b063a0e0dfce4c2696e6009419f}{update\+Translation}} () override
\item 
\mbox{\hyperlink{class_t_property_group}{TProperty\+Group}} $\ast$ \mbox{\hyperlink{class_control_point_editor_tool_a60f203888ccc1051eb74c971a74e7a7f}{get\+Properties}} (int target\+Type) override
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a5ceffa2369e9b2d5f550631eaed7f0c8}{on\+Selection\+Changed}} ()
\item 
bool \mbox{\hyperlink{class_control_point_editor_tool_a2c7e06a5b586156270b5d3b7cea7ca43}{select}} (const \mbox{\hyperlink{class_t_selection}{TSelection}} $\ast$)
\item 
\mbox{\hyperlink{class_control_point_editor_stroke}{Control\+Point\+Editor\+Stroke}} \mbox{\hyperlink{class_control_point_editor_tool_aef52aabb3422b208833ba2c16b4cba05}{get\+Control\+Point\+Editor\+Stroke}} ()
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a8f4368c0af7d326c923e21342a493f33}{init\+Undo}} ()
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a9b68fd3076dc59d72e6bcc49a0126a03}{get\+Nearest\+Stroke\+Column\+Indexes}} (std\+::vector$<$ int $>$ \&indexes, \mbox{\hyperlink{class_t_point_t}{TPointD}} pos)
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a9c893e2f4c42c225209d20bd46a3925e}{draw\+Moving\+Segment}} ()
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a409870ab04f1a8117f37e191f2a332be}{draw\+Control\+Point}} ()
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_ae736cb807171fa9d2e250a10f81f4c6e}{draw}} () override
\begin{DoxyCompactList}\small\item\em Draws the tool on the viewer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a22b85672ae213ce80452b8e1d0e2618a}{mouse\+Move}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_aedcc7252ad04d212e745ff54e0eb19a3}{left\+Button\+Down}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a1229f6b442514c4ebcb64737a6e29bf0}{right\+Button\+Down}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&) override
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a5be15662abdd052345cfebdfaafa4c0f}{move\+Control\+Points}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&delta)
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a6e541f2837c50a370aee68f23b158073}{move\+Speed}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&delta, bool is\+In)
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a16a89324023289f868e33ed1eec4438b}{move\+Segment}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&delta, bool dragging, bool is\+Shift\+Pressed)
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a863e32f78065e5475c502083f9ab0a07}{left\+Button\+Drag}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a345948649ad36284347376cb1df8c680}{left\+Button\+Up}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a5228477da9c23e7485a14e18c1ee481b}{add\+Context\+Menu\+Items}} (QMenu $\ast$menu) override
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a2fb472f52b6894d06aae87ddef1bde53}{link\+Speed\+In\+Out}} (int index)
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_acb3208e11f4f953d58a6599181110b65}{unlink\+Speed\+In\+Out}} (int point\+Index)
\item 
bool \mbox{\hyperlink{class_control_point_editor_tool_aa828673f8b5cec3dfca1c052f680f359}{key\+Down}} (QKey\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a8da6296cd702c773d5c37eeb4c1be262}{on\+Enter}} () override
\begin{DoxyCompactList}\small\item\em Callback for the mouse entering the viewer area. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a2d92b85a916014da278d2deaae90b104}{on\+Leave}} () override
\begin{DoxyCompactList}\small\item\em Callback for the mouse leaving the viewer area. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_control_point_editor_tool_a5de1575c41151e6701025477440c6e5f}{on\+Property\+Changed}} (std\+::string property\+Name) override
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_ac26218b59fe5049b120640639f3ef89c}{on\+Activate}} () override
\begin{DoxyCompactList}\small\item\em Callback invoked whenever the tool activates. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a5f01b22cd99a322b46ad1fe7c171ba85}{on\+Deactivate}} () override
\begin{DoxyCompactList}\small\item\em Callback for tool deactivation, includes tool switch. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a03767a0350c80a7651d2ff25d226b579}{on\+Image\+Changed}} () override
\begin{DoxyCompactList}\small\item\em Notifies changes in the image in use. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_control_point_editor_tool_a69ed52b4c54b1d7e4c3028471b011674}{get\+Cursor\+Id}} () const override
\begin{DoxyCompactList}\small\item\em Returns the type of cursor used by the tool. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_control_point_editor_tool_a0c458733b0b9d25db1cee9912e929a7d}{is\+Event\+Acceptable}} (QEvent $\ast$e) override
\item 
\mbox{\hyperlink{class_t_point_t}{TPointD}} \mbox{\hyperlink{class_control_point_editor_tool_ae83848646b41b4f33a28a56c947e5488}{calculate\+Snap}} (\mbox{\hyperlink{class_t_point_t}{TPointD}} pos)
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a165070eb49321d7663be62ab77f8fb21}{draw\+Snap}} ()
\item 
\mbox{\hyperlink{class_t_point_t}{TPointD}} \mbox{\hyperlink{class_control_point_editor_tool_ac95280cfbcb9d2130b40ec7dc4e54792}{get\+Snap}} (\mbox{\hyperlink{class_t_point_t}{TPointD}} pos)
\item 
void \mbox{\hyperlink{class_control_point_editor_tool_a2065c10a346ed623e14c0a4ef250a34f}{reset\+Snap}} ()
\item 
bool \mbox{\hyperlink{class_control_point_editor_tool_a3d1490868bb77d604590af459da6e12e}{is\+Busy}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_control_point_editor_tool_a20073497af1961112184b31c4a3dce33}\label{class_control_point_editor_tool_a20073497af1961112184b31c4a3dce33}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!ControlPointEditorTool@{ControlPointEditorTool}}
\index{ControlPointEditorTool@{ControlPointEditorTool}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{ControlPointEditorTool()}{ControlPointEditorTool()}}
{\footnotesize\ttfamily Control\+Point\+Editor\+Tool\+::\+Control\+Point\+Editor\+Tool (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00181     : \mbox{\hyperlink{class_t_tool_a9c63ec35f606e755d0d036bf4fed62ab}{TTool}}(\textcolor{stringliteral}{"{}T\_ControlPointEditor"{}})}
\DoxyCodeLine{00182     , m\_draw(\textcolor{keyword}{false})}
\DoxyCodeLine{00183     , m\_lastPointSelected(-\/1)}
\DoxyCodeLine{00184     , m\_isImageChanged(\textcolor{keyword}{false})}
\DoxyCodeLine{00185     , m\_selectingRect(\mbox{\hyperlink{class_t_rect_t}{TRectD}}())}
\DoxyCodeLine{00186     , m\_autoSelectDrawing(\textcolor{stringliteral}{"{}Auto Select Drawing"{}}, \textcolor{keyword}{true})}
\DoxyCodeLine{00187     , m\_snap(\textcolor{stringliteral}{"{}snap"{}}, \textcolor{keyword}{false})}
\DoxyCodeLine{00188     , m\_snapSensitivity(\textcolor{stringliteral}{"{}Sensitivity:"{}})}
\DoxyCodeLine{00189     , m\_selectType(\textcolor{stringliteral}{"{}Type:"{}})}
\DoxyCodeLine{00190     , m\_action(NONE)}
\DoxyCodeLine{00191     , m\_cursorType(NORMAL)}
\DoxyCodeLine{00192     , m\_undo(0)}
\DoxyCodeLine{00193     , m\_isMenuViewed(\textcolor{keyword}{false})}
\DoxyCodeLine{00194     , m\_moveControlPointEditorStroke()}
\DoxyCodeLine{00195     , m\_moveSegmentLimitation() \{}
\DoxyCodeLine{00196   bind(TTool::Vectors);}
\DoxyCodeLine{00197   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_selectType);}
\DoxyCodeLine{00198   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_autoSelectDrawing);}
\DoxyCodeLine{00199   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_snap);}
\DoxyCodeLine{00200   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_snapSensitivity);}
\DoxyCodeLine{00201   m\_selection.setControlPointEditorStroke(\&m\_controlPointEditorStroke);}
\DoxyCodeLine{00202 }
\DoxyCodeLine{00203   m\_selectType.addValue(RECTANGULAR\_WSTR);}
\DoxyCodeLine{00204   m\_selectType.addValue(FREEHAND\_WSTR);}
\DoxyCodeLine{00205   m\_selectType.setId(\textcolor{stringliteral}{"{}Type"{}});}
\DoxyCodeLine{00206 }
\DoxyCodeLine{00207   m\_autoSelectDrawing.setId(\textcolor{stringliteral}{"{}AutoSelectDrawing"{}});}
\DoxyCodeLine{00208   m\_snap.setId(\textcolor{stringliteral}{"{}Snap"{}});}
\DoxyCodeLine{00209   m\_snapSensitivity.addValue(LOW\_WSTR);}
\DoxyCodeLine{00210   m\_snapSensitivity.addValue(MEDIUM\_WSTR);}
\DoxyCodeLine{00211   m\_snapSensitivity.addValue(HIGH\_WSTR);}
\DoxyCodeLine{00212   m\_snapSensitivity.setId(\textcolor{stringliteral}{"{}SnapSensitivity"{}});}
\DoxyCodeLine{00213 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_control_point_editor_tool_a5228477da9c23e7485a14e18c1ee481b}\label{class_control_point_editor_tool_a5228477da9c23e7485a14e18c1ee481b}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!addContextMenuItems@{addContextMenuItems}}
\index{addContextMenuItems@{addContextMenuItems}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{addContextMenuItems()}{addContextMenuItems()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::add\+Context\+Menu\+Items (\begin{DoxyParamCaption}\item[{QMenu $\ast$}]{menu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Add a context menu to the actual tool, as for example pressing right mouse button with the stroke selection tool. 

Reimplemented from \mbox{\hyperlink{class_t_tool_ac8a81b368568245d16f7c3d4a17684a1}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00814                                                             \{}
\DoxyCodeLine{00815   m\_isMenuViewed = \textcolor{keyword}{true};}
\DoxyCodeLine{00816   m\_selection.addMenuItems(menu);}
\DoxyCodeLine{00817 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_ae83848646b41b4f33a28a56c947e5488}\label{class_control_point_editor_tool_ae83848646b41b4f33a28a56c947e5488}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!calculateSnap@{calculateSnap}}
\index{calculateSnap@{calculateSnap}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{calculateSnap()}{calculateSnap()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPointD}} Control\+Point\+Editor\+Tool\+::calculate\+Snap (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_point_t}{TPointD}}}]{pos }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00123                                                          \{}
\DoxyCodeLine{00124   m\_foundSnap = \textcolor{keyword}{false};}
\DoxyCodeLine{00125   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{TTool::getImage}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00126   \mbox{\hyperlink{class_t_point_t}{TPointD}} snapPoint = pos;}
\DoxyCodeLine{00127   \textcolor{keywordflow}{if} (vi \&\& m\_snap.getValue()) \{}
\DoxyCodeLine{00128     \textcolor{keywordtype}{double} minDistance = m\_snapMinDistance;}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130     \textcolor{keywordtype}{int} i, strokeNumber = vi-\/>getStrokeCount();}
\DoxyCodeLine{00131 }
\DoxyCodeLine{00132     \mbox{\hyperlink{class_t_stroke}{TStroke}} *selfStroke = m\_controlPointEditorStroke.getStroke();}
\DoxyCodeLine{00133     \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke;}
\DoxyCodeLine{00134     \textcolor{keywordtype}{double} distance, outW, w;}
\DoxyCodeLine{00135 }
\DoxyCodeLine{00136     \textcolor{keywordflow}{for} (i = 0; i < strokeNumber; i++) \{}
\DoxyCodeLine{00137       stroke = vi-\/>getStroke(i);}
\DoxyCodeLine{00138       \textcolor{keywordflow}{if} (stroke != selfStroke) \{}
\DoxyCodeLine{00139         \textcolor{keywordflow}{if} (stroke-\/>getNearestW(pos, outW, distance) \&\&}
\DoxyCodeLine{00140             distance < minDistance) \{}
\DoxyCodeLine{00141           minDistance = distance;}
\DoxyCodeLine{00142           \textcolor{keywordflow}{if} (areAlmostEqual(outW, 0.0, 1e-\/3))}
\DoxyCodeLine{00143             w = 0.0;}
\DoxyCodeLine{00144           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (areAlmostEqual(outW, 1.0, 1e-\/3))}
\DoxyCodeLine{00145             w = 1.0;}
\DoxyCodeLine{00146           \textcolor{keywordflow}{else}}
\DoxyCodeLine{00147             w = outW;}
\DoxyCodeLine{00148           \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} point = stroke-\/>\mbox{\hyperlink{class_t_stroke_ace861e064b925c5d41a6d7381ae6ada5}{getPoint}}(w);}
\DoxyCodeLine{00149           snapPoint         = \mbox{\hyperlink{class_t_point_t}{TPointD}}(point.x, point.y);}
\DoxyCodeLine{00150           m\_foundSnap       = \textcolor{keyword}{true};}
\DoxyCodeLine{00151           m\_snapPoint       = snapPoint;}
\DoxyCodeLine{00152         \}}
\DoxyCodeLine{00153       \}}
\DoxyCodeLine{00154     \}}
\DoxyCodeLine{00155   \}}
\DoxyCodeLine{00156   \textcolor{keywordflow}{return} snapPoint;}
\DoxyCodeLine{00157 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_ae736cb807171fa9d2e250a10f81f4c6e}\label{class_control_point_editor_tool_ae736cb807171fa9d2e250a10f81f4c6e}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!draw@{draw}}
\index{draw@{draw}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{draw()}{draw()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::draw (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Draws the tool on the viewer. 



Reimplemented from \mbox{\hyperlink{class_t_tool_a058bf656d73bf3cd63b9826cbaaf48e0}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00355                                   \{}
\DoxyCodeLine{00356   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00357   \textcolor{keywordflow}{if} (!m\_draw) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00358 }
\DoxyCodeLine{00359   \textcolor{keywordtype}{int} currentStroke = m\_controlPointEditorStroke.getStrokeIndex();}
\DoxyCodeLine{00360   \textcolor{keywordflow}{if} (!vi || currentStroke == -\/1 ||}
\DoxyCodeLine{00361       m\_controlPointEditorStroke.getControlPointCount() == 0 ||}
\DoxyCodeLine{00362       vi-\/>getStrokeCount() == 0 || (\textcolor{keywordtype}{int})vi-\/>getStrokeCount() <= currentStroke) \{}
\DoxyCodeLine{00363     m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aae2e6944903ac1ca932e0cd79c0e387a}{setStroke}}((\mbox{\hyperlink{class_t_vector_image}{TVectorImage}} *)0, -\/1);}
\DoxyCodeLine{00364     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00365   \}}
\DoxyCodeLine{00366 }
\DoxyCodeLine{00367   TPixel color1, color2;}
\DoxyCodeLine{00368   \textcolor{keywordflow}{if} (m\_action == RECT\_SELECTION)  \textcolor{comment}{// Disegna il rettangolo per la selezione}}
\DoxyCodeLine{00369   \{}
\DoxyCodeLine{00370     color1 = TPixel32::}
\DoxyCodeLine{00371         Black;  \textcolor{comment}{// TransparencyCheck::instance()-\/>isEnabled()?TPixel32::White:TPixel32::Black;}}
\DoxyCodeLine{00372     drawRect(m\_selectingRect, color1, 0x3F33, \textcolor{keyword}{true});}
\DoxyCodeLine{00373   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_action == FREEHAND\_SELECTION \&\& !m\_track.\mbox{\hyperlink{class_stroke_generator_a85461eab47ef4791610974866efb61aa}{isEmpty}}()) \{}
\DoxyCodeLine{00374     TPixel color = ToonzCheck::instance()-\/>getChecks() \& \mbox{\hyperlink{class_toonz_check_add5b28b42f552cf90e3cfcde9e737876ab6d35869ac2f7cfc956d498b2089a1ff}{ToonzCheck::eBlackBg}}}
\DoxyCodeLine{00375                        ? TPixel32::White}
\DoxyCodeLine{00376                        : TPixel32::Black;}
\DoxyCodeLine{00377     tglColor(color);}
\DoxyCodeLine{00378     m\_track.\mbox{\hyperlink{class_stroke_generator_a36ec59cf8b18831d60760706068c9c8f}{drawAllFragments}}();}
\DoxyCodeLine{00379   \}}
\DoxyCodeLine{00380 }
\DoxyCodeLine{00381   \textcolor{keywordflow}{if} (m\_controlPointEditorStroke.getControlPointCount() <= 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00382 }
\DoxyCodeLine{00383   color1          = TPixel(79, 128, 255);}
\DoxyCodeLine{00384   color2          = TPixel::White;}
\DoxyCodeLine{00385   \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke = m\_controlPointEditorStroke.getStroke();}
\DoxyCodeLine{00386   tglColor(color1);}
\DoxyCodeLine{00387   drawStrokeCenterline(*stroke, getPixelSize());}
\DoxyCodeLine{00388 }
\DoxyCodeLine{00389   drawControlPoint();}
\DoxyCodeLine{00390 }
\DoxyCodeLine{00391   drawMovingSegment();}
\DoxyCodeLine{00392 }
\DoxyCodeLine{00393   drawSnap();}
\DoxyCodeLine{00394 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00224}{Stroke\+Generator\+::draw\+All\+Fragments()}}, \mbox{\hyperlink{l00044}{Toonz\+Check\+::e\+Black\+Bg}}, \mbox{\hyperlink{l00276}{TTool\+::get\+Image()}}, \mbox{\hyperlink{l00025}{Stroke\+Generator\+::is\+Empty()}}, and \mbox{\hyperlink{l00459}{Control\+Point\+Editor\+Stroke\+::set\+Stroke()}}.

\mbox{\Hypertarget{class_control_point_editor_tool_a409870ab04f1a8117f37e191f2a332be}\label{class_control_point_editor_tool_a409870ab04f1a8117f37e191f2a332be}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!drawControlPoint@{drawControlPoint}}
\index{drawControlPoint@{drawControlPoint}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{drawControlPoint()}{drawControlPoint()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::draw\+Control\+Point (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00298                                               \{}
\DoxyCodeLine{00299   TPixel color1         = TPixel(79, 128, 255);}
\DoxyCodeLine{00300   TPixel color2         = TPixel::White;}
\DoxyCodeLine{00301   TPixel color\_handle   = TPixel(96, 64, 201);}
\DoxyCodeLine{00302   \textcolor{keywordtype}{int} controlPointCount = m\_controlPointEditorStroke.getControlPointCount();}
\DoxyCodeLine{00303 }
\DoxyCodeLine{00304   \textcolor{keywordtype}{double} pix    = getPixelSize() * 2.0f;}
\DoxyCodeLine{00305   \textcolor{keywordtype}{double} pix1\_5 = 1.5 * pix, pix2 = pix + pix, pix2\_5 = pix1\_5 + pix,}
\DoxyCodeLine{00306          pix3 = pix2 + pix, pix3\_5 = pix2\_5 + pix, pix4 = pix3 + pix;}
\DoxyCodeLine{00307 }
\DoxyCodeLine{00308   \textcolor{keywordtype}{double} maxDist2 = sq(5.0 * pix);}
\DoxyCodeLine{00309   \textcolor{keywordtype}{double} dist2    = 0;}
\DoxyCodeLine{00310   \textcolor{keywordtype}{int} pointIndex;}
\DoxyCodeLine{00311   ControlPointEditorStroke::PointType pointType =}
\DoxyCodeLine{00312       m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a97247ab7eb478a10e3b59a366fc6fa31}{getPointTypeAt}}(m\_pos, maxDist2, pointIndex);}
\DoxyCodeLine{00313   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00314   \textcolor{keywordflow}{for} (i = 0; i < controlPointCount; i++) \{}
\DoxyCodeLine{00315     \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} point = m\_controlPointEditorStroke.getControlPoint(i);}
\DoxyCodeLine{00316     \mbox{\hyperlink{class_t_point_t}{TPointD}} pa        = m\_controlPointEditorStroke.getSpeedInPoint(i);}
\DoxyCodeLine{00317     \mbox{\hyperlink{class_t_point_t}{TPointD}} pb        = m\_controlPointEditorStroke.getSpeedOutPoint(i);}
\DoxyCodeLine{00318     tglColor(color\_handle);}
\DoxyCodeLine{00319     tglDrawSegment(pa, point);}
\DoxyCodeLine{00320     \textcolor{keywordflow}{if} (i == pointIndex \&\& pointType == ControlPointEditorStroke::SPEED\_IN)}
\DoxyCodeLine{00321       tglFillRect(pa.x -\/ pix2\_5, pa.y -\/ pix2\_5, pa.x + pix2\_5, pa.y + pix2\_5);}
\DoxyCodeLine{00322     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00323       tglFillRect(pa.x -\/ pix1\_5, pa.y -\/ pix1\_5, pa.x + pix1\_5, pa.y + pix1\_5);}
\DoxyCodeLine{00324 }
\DoxyCodeLine{00325     tglDrawSegment(pb, point);}
\DoxyCodeLine{00326     \textcolor{keywordflow}{if} (i == pointIndex \&\& pointType == ControlPointEditorStroke::SPEED\_OUT)}
\DoxyCodeLine{00327       tglFillRect(pb.x -\/ pix2\_5, pb.y -\/ pix2\_5, pb.x + pix2\_5, pb.y + pix2\_5);}
\DoxyCodeLine{00328     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00329       tglFillRect(pb.x -\/ pix1\_5, pb.y -\/ pix1\_5, pb.x + pix1\_5, pb.y + pix1\_5);}
\DoxyCodeLine{00330 }
\DoxyCodeLine{00331     tglColor(color1);}
\DoxyCodeLine{00332 }
\DoxyCodeLine{00333     \textcolor{keywordflow}{if} (i == pointIndex \&\&}
\DoxyCodeLine{00334         pointType == ControlPointEditorStroke::CONTROL\_POINT) \{}
\DoxyCodeLine{00335       tglFillRect(point.x -\/ pix3\_5, point.y -\/ pix3\_5, point.x + pix3\_5,}
\DoxyCodeLine{00336                   point.y + pix3\_5);}
\DoxyCodeLine{00337       \textcolor{keywordflow}{if} (!m\_selection.isSelected(i)) \{}
\DoxyCodeLine{00338         tglColor(color2);}
\DoxyCodeLine{00339         tglFillRect(point.x -\/ pix2\_5, point.y -\/ pix2\_5, point.x + pix2\_5,}
\DoxyCodeLine{00340                     point.y + pix2\_5);}
\DoxyCodeLine{00341       \}}
\DoxyCodeLine{00342     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00343       tglFillRect(point.x -\/ pix2, point.y -\/ pix2, point.x + pix2,}
\DoxyCodeLine{00344                   point.y + pix2);}
\DoxyCodeLine{00345       \textcolor{keywordflow}{if} (!m\_selection.isSelected(i)) \{}
\DoxyCodeLine{00346         tglColor(color2);}
\DoxyCodeLine{00347         tglFillRect(point.x -\/ pix, point.y -\/ pix, point.x + pix, point.y + pix);}
\DoxyCodeLine{00348       \}}
\DoxyCodeLine{00349     \}}
\DoxyCodeLine{00350   \}}
\DoxyCodeLine{00351 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a9c893e2f4c42c225209d20bd46a3925e}\label{class_control_point_editor_tool_a9c893e2f4c42c225209d20bd46a3925e}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!drawMovingSegment@{drawMovingSegment}}
\index{drawMovingSegment@{drawMovingSegment}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{drawMovingSegment()}{drawMovingSegment()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::draw\+Moving\+Segment (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00277                                                \{}
\DoxyCodeLine{00278   \textcolor{keywordtype}{int} beforeIndex = m\_moveSegmentLimitation.first;}
\DoxyCodeLine{00279   \textcolor{keywordtype}{int} nextIndex   = m\_moveSegmentLimitation.second;}
\DoxyCodeLine{00280   \textcolor{keywordflow}{if} (m\_action != SEGMENT\_MOVEMENT || beforeIndex == -\/1 || nextIndex == -\/1 ||}
\DoxyCodeLine{00281       !m\_moveControlPointEditorStroke.getStroke())}
\DoxyCodeLine{00282     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00283   tglColor(TPixel::Green);}
\DoxyCodeLine{00284   \textcolor{keywordtype}{double} w0, w1;}
\DoxyCodeLine{00285   \textcolor{keywordtype}{double} q0, q1;}
\DoxyCodeLine{00286   getSegmentParameter(\&m\_moveControlPointEditorStroke, beforeIndex, nextIndex,}
\DoxyCodeLine{00287                       w0, w1, q0, q1);}
\DoxyCodeLine{00288   \textcolor{keywordflow}{if} (w0 != -\/1 \&\& w1 != -\/1)  \textcolor{comment}{// Dovrebbero essere sempre diversi...}}
\DoxyCodeLine{00289     drawStrokeCenterline(*m\_moveControlPointEditorStroke.getStroke(),}
\DoxyCodeLine{00290                          getPixelSize(), w0, w1);}
\DoxyCodeLine{00291   \textcolor{keywordflow}{if} (q0 != -\/1 \&\& q1 != -\/1)}
\DoxyCodeLine{00292     drawStrokeCenterline(*m\_moveControlPointEditorStroke.getStroke(),}
\DoxyCodeLine{00293                          getPixelSize(), q0, q1);}
\DoxyCodeLine{00294 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a165070eb49321d7663be62ab77f8fb21}\label{class_control_point_editor_tool_a165070eb49321d7663be62ab77f8fb21}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!drawSnap@{drawSnap}}
\index{drawSnap@{drawSnap}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{drawSnap()}{drawSnap()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::draw\+Snap (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00159                                       \{}
\DoxyCodeLine{00160   \textcolor{keywordtype}{double} thick = 6.0;}
\DoxyCodeLine{00161   \textcolor{keywordflow}{if} (m\_foundSnap) \{}
\DoxyCodeLine{00162     tglColor(\mbox{\hyperlink{class_t_pixel_d}{TPixelD}}(0.1, 0.9, 0.1));}
\DoxyCodeLine{00163     tglDrawCircle(m\_snapPoint, thick);}
\DoxyCodeLine{00164   \}}
\DoxyCodeLine{00165 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_aef52aabb3422b208833ba2c16b4cba05}\label{class_control_point_editor_tool_aef52aabb3422b208833ba2c16b4cba05}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!getControlPointEditorStroke@{getControlPointEditorStroke}}
\index{getControlPointEditorStroke@{getControlPointEditorStroke}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{getControlPointEditorStroke()}{getControlPointEditorStroke()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_control_point_editor_stroke}{Control\+Point\+Editor\+Stroke}} Control\+Point\+Editor\+Tool\+::get\+Control\+Point\+Editor\+Stroke (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00094                                                          \{}
\DoxyCodeLine{00095     \textcolor{keywordflow}{return} m\_controlPointEditorStroke;}
\DoxyCodeLine{00096   \};}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a69ed52b4c54b1d7e4c3028471b011674}\label{class_control_point_editor_tool_a69ed52b4c54b1d7e4c3028471b011674}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!getCursorId@{getCursorId}}
\index{getCursorId@{getCursorId}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{getCursorId()}{getCursorId()}}
{\footnotesize\ttfamily int Control\+Point\+Editor\+Tool\+::get\+Cursor\+Id (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Returns the type of cursor used by the tool. 

\begin{DoxySeeAlso}{See also}
For a list of cursor ids \mbox{\hyperlink{}{cursor.\+h}} 
\end{DoxySeeAlso}


Reimplemented from \mbox{\hyperlink{class_t_tool_a1768a57b8b6d1480618fd923fad15f1d}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00970                                               \{}
\DoxyCodeLine{00971   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_tool_a66f61f998b655c1c917ee63a595657c6}{m\_viewer}} \&\& \mbox{\hyperlink{class_t_tool_a66f61f998b655c1c917ee63a595657c6}{m\_viewer}}-\/>getGuidedStrokePickerMode())}
\DoxyCodeLine{00972     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_tool_a66f61f998b655c1c917ee63a595657c6}{m\_viewer}}-\/>getGuidedStrokePickerCursor();}
\DoxyCodeLine{00973 }
\DoxyCodeLine{00974   \textcolor{keywordflow}{switch} (m\_cursorType) \{}
\DoxyCodeLine{00975   \textcolor{keywordflow}{case} NORMAL:}
\DoxyCodeLine{00976     \textcolor{keywordflow}{return} ToolCursor::SplineEditorCursor;}
\DoxyCodeLine{00977   \textcolor{keywordflow}{case} ADD:}
\DoxyCodeLine{00978     \textcolor{keywordflow}{return} ToolCursor::SplineEditorCursorAdd;}
\DoxyCodeLine{00979   \textcolor{keywordflow}{case} EDIT\_SPEED:}
\DoxyCodeLine{00980     \textcolor{keywordflow}{return} ToolCursor::SplineEditorCursorSelect;}
\DoxyCodeLine{00981   \textcolor{keywordflow}{case} EDIT\_SEGMENT:}
\DoxyCodeLine{00982     \textcolor{keywordflow}{return} ToolCursor::PinchCursor;}
\DoxyCodeLine{00983   \textcolor{keywordflow}{case} NO\_ACTIVE:}
\DoxyCodeLine{00984     \textcolor{keywordflow}{return} ToolCursor::CURSOR\_NO;}
\DoxyCodeLine{00985   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00986     \textcolor{keywordflow}{return} ToolCursor::SplineEditorCursor;}
\DoxyCodeLine{00987   \}}
\DoxyCodeLine{00988 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00555}{TTool\+::m\+\_\+viewer}}.

\mbox{\Hypertarget{class_control_point_editor_tool_a9b68fd3076dc59d72e6bcc49a0126a03}\label{class_control_point_editor_tool_a9b68fd3076dc59d72e6bcc49a0126a03}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!getNearestStrokeColumnIndexes@{getNearestStrokeColumnIndexes}}
\index{getNearestStrokeColumnIndexes@{getNearestStrokeColumnIndexes}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{getNearestStrokeColumnIndexes()}{getNearestStrokeColumnIndexes()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::get\+Nearest\+Stroke\+Column\+Indexes (\begin{DoxyParamCaption}\item[{std\+::vector$<$ int $>$ \&}]{indexes,  }\item[{\mbox{\hyperlink{class_t_point_t}{TPointD}}}]{pos }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00252                                           \{}
\DoxyCodeLine{00253   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{00254   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh            = app-\/>getCurrentXsheet()-\/>getXsheet();}
\DoxyCodeLine{00255   \textcolor{keywordtype}{int} currentFrame        = app-\/>getCurrentFrame()-\/>getFrameIndex();}
\DoxyCodeLine{00256   std::vector<int> newIndexes;}
\DoxyCodeLine{00257   \mbox{\hyperlink{class_t_affine}{TAffine}} aff = getMatrix();}
\DoxyCodeLine{00258   \textcolor{keywordtype}{int} i       = 0;}
\DoxyCodeLine{00259   \textcolor{keywordflow}{for} (i = 0; i < (int)indexes.size(); i++) \{}
\DoxyCodeLine{00260     \textcolor{keywordflow}{if} (xsh-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(i)-\/>\mbox{\hyperlink{class_t_xsh_column_a04953896aae8860ace46010956a28db9}{isLocked}}()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00261     \textcolor{keywordtype}{int} index        = indexes[i];}
\DoxyCodeLine{00262     \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(currentFrame, index).\mbox{\hyperlink{class_t_xsh_cell_a20b623d308bc09b820ec6b116516f564}{getImage}}(\textcolor{keyword}{false});}
\DoxyCodeLine{00263     \textcolor{keywordflow}{if} (!vi) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00264     \textcolor{keywordtype}{double} dist2, t = 0;}
\DoxyCodeLine{00265     UINT strokeIndex = -\/1;}
\DoxyCodeLine{00266     \mbox{\hyperlink{class_t_point_t}{TPointD}} p        = \mbox{\hyperlink{class_t_tool_a99eb4354e2dba454b7210c986015d577}{getColumnMatrix}}(index).\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * getMatrix() * pos;}
\DoxyCodeLine{00267     \textcolor{keywordflow}{if} (vi-\/>getNearestStroke(p, t, strokeIndex, dist2) \&\&}
\DoxyCodeLine{00268         dist2 < 25 * getPixelSize() * getPixelSize())}
\DoxyCodeLine{00269       newIndexes.push\_back(index);}
\DoxyCodeLine{00270   \}}
\DoxyCodeLine{00271   indexes.clear();}
\DoxyCodeLine{00272   indexes = newIndexes;}
\DoxyCodeLine{00273 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a60f203888ccc1051eb74c971a74e7a7f}\label{class_control_point_editor_tool_a60f203888ccc1051eb74c971a74e7a7f}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!getProperties@{getProperties}}
\index{getProperties@{getProperties}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{getProperties()}{getProperties()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_property_group}{TProperty\+Group}} $\ast$ Control\+Point\+Editor\+Tool\+::get\+Properties (\begin{DoxyParamCaption}\item[{int}]{target\+Type }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00085 \{ \textcolor{keywordflow}{return} \&m\_prop; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_ac95280cfbcb9d2130b40ec7dc4e54792}\label{class_control_point_editor_tool_ac95280cfbcb9d2130b40ec7dc4e54792}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!getSnap@{getSnap}}
\index{getSnap@{getSnap}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{getSnap()}{getSnap()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPointD}} Control\+Point\+Editor\+Tool\+::get\+Snap (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_point_t}{TPointD}}}]{pos }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00167                                                    \{}
\DoxyCodeLine{00168   \textcolor{keywordflow}{if} (m\_foundSnap)}
\DoxyCodeLine{00169     \textcolor{keywordflow}{return} m\_snapPoint;}
\DoxyCodeLine{00170   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00171     \textcolor{keywordflow}{return} pos;}
\DoxyCodeLine{00172 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a99d944ccfe4e56bc95baba496ef943d4}\label{class_control_point_editor_tool_a99d944ccfe4e56bc95baba496ef943d4}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!getToolType@{getToolType}}
\index{getToolType@{getToolType}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{getToolType()}{getToolType()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296c}{Tool\+Type}} Control\+Point\+Editor\+Tool\+::get\+Tool\+Type (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00081 \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296ca01ffd66b00b05a88c02ce8ceb5da3b8b}{TTool::LevelWriteTool}}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a8f4368c0af7d326c923e21342a493f33}\label{class_control_point_editor_tool_a8f4368c0af7d326c923e21342a493f33}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!initUndo@{initUndo}}
\index{initUndo@{initUndo}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{initUndo()}{initUndo()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::init\+Undo (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00232                                       \{}
\DoxyCodeLine{00233   \textcolor{keywordflow}{if} (TTool::getApplication()-\/>getCurrentObject()-\/>isSpline()) \{}
\DoxyCodeLine{00234     m\_undo =}
\DoxyCodeLine{00235         \textcolor{keyword}{new} \mbox{\hyperlink{class_tool_utils_1_1_undo_path}{UndoPath}}(\mbox{\hyperlink{class_t_tool_a8716e1462da359f4902c044a79f2d40d}{getXsheet}}()-\/>getStageObject(\mbox{\hyperlink{class_t_tool_a25b57b82dfac131d9d6405e07fbd98b4}{getObjectId}}())-\/>getSpline());}
\DoxyCodeLine{00236     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00237   \}}
\DoxyCodeLine{00238   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00239   \textcolor{keywordflow}{if} (!vi) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00240   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *level =}
\DoxyCodeLine{00241       TTool::getApplication()-\/>getCurrentLevel()-\/>getSimpleLevel();}
\DoxyCodeLine{00242   \mbox{\hyperlink{class_tool_utils_1_1_undo_control_point_editor}{UndoControlPointEditor}} *undo =}
\DoxyCodeLine{00243       \textcolor{keyword}{new} \mbox{\hyperlink{class_tool_utils_1_1_undo_control_point_editor}{UndoControlPointEditor}}(level, \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}());}
\DoxyCodeLine{00244   \textcolor{keywordtype}{int} index = m\_controlPointEditorStroke.getStrokeIndex();}
\DoxyCodeLine{00245   \textcolor{keywordflow}{if} (index > -\/1) undo-\/>addOldStroke(index, vi-\/>getVIStroke(index));}
\DoxyCodeLine{00246   m\_undo = undo;}
\DoxyCodeLine{00247 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a3d1490868bb77d604590af459da6e12e}\label{class_control_point_editor_tool_a3d1490868bb77d604590af459da6e12e}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!isBusy@{isBusy}}
\index{isBusy@{isBusy}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{isBusy()}{isBusy()}}
{\footnotesize\ttfamily bool Control\+Point\+Editor\+Tool\+::is\+Busy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00138 \{ \textcolor{keywordflow}{return} m\_undo != \textcolor{keyword}{nullptr}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a0c458733b0b9d25db1cee9912e929a7d}\label{class_control_point_editor_tool_a0c458733b0b9d25db1cee9912e929a7d}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!isEventAcceptable@{isEventAcceptable}}
\index{isEventAcceptable@{isEventAcceptable}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{isEventAcceptable()}{isEventAcceptable()}}
{\footnotesize\ttfamily bool Control\+Point\+Editor\+Tool\+::is\+Event\+Acceptable (\begin{DoxyParamCaption}\item[{QEvent $\ast$}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00994                                                         \{}
\DoxyCodeLine{00995   \textcolor{keywordflow}{if} (!isEnabled()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00996   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00997   \textcolor{keywordflow}{if} (!vi || (vi \&\& m\_selection.isEmpty())) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00998   \textcolor{comment}{// arrow keys will be used for moving the selected points}}
\DoxyCodeLine{00999   QKeyEvent *keyEvent = \textcolor{keyword}{static\_cast<}QKeyEvent *\textcolor{keyword}{>}(e);}
\DoxyCodeLine{01000   \textcolor{comment}{// shift + arrow will not be recognized for now}}
\DoxyCodeLine{01001   \textcolor{keywordflow}{if} (keyEvent-\/>modifiers() \& Qt::ShiftModifier) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{01002   \textcolor{keywordtype}{int} key = keyEvent-\/>key();}
\DoxyCodeLine{01003   \textcolor{keywordflow}{return} (key == Qt::Key\_Up || key == Qt::Key\_Down || key == Qt::Key\_Left ||}
\DoxyCodeLine{01004           key == Qt::Key\_Right);}
\DoxyCodeLine{01005 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_aa828673f8b5cec3dfca1c052f680f359}\label{class_control_point_editor_tool_aa828673f8b5cec3dfca1c052f680f359}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!keyDown@{keyDown}}
\index{keyDown@{keyDown}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{keyDown()}{keyDown()}}
{\footnotesize\ttfamily bool Control\+Point\+Editor\+Tool\+::key\+Down (\begin{DoxyParamCaption}\item[{QKey\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00841                                                      \{}
\DoxyCodeLine{00842   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true}));}
\DoxyCodeLine{00843   \textcolor{keywordflow}{if} (!vi || (vi \&\& m\_selection.isEmpty())) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00844 }
\DoxyCodeLine{00845   \mbox{\hyperlink{class_t_point_t}{TPointD}} delta;}
\DoxyCodeLine{00846   \textcolor{keywordflow}{switch} (event-\/>key()) \{}
\DoxyCodeLine{00847   \textcolor{keywordflow}{case} Qt::Key\_Up:}
\DoxyCodeLine{00848     delta.y = 1;}
\DoxyCodeLine{00849     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00850   \textcolor{keywordflow}{case} Qt::Key\_Down:}
\DoxyCodeLine{00851     delta.y = -\/1;}
\DoxyCodeLine{00852     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00853   \textcolor{keywordflow}{case} Qt::Key\_Left:}
\DoxyCodeLine{00854     delta.x = -\/1;}
\DoxyCodeLine{00855     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00856   \textcolor{keywordflow}{case} Qt::Key\_Right:}
\DoxyCodeLine{00857     delta.x = 1;}
\DoxyCodeLine{00858     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00859   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00860     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00861     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00862   \}}
\DoxyCodeLine{00863   \textcolor{comment}{// Inizializzo l'UNDO}}
\DoxyCodeLine{00864   initUndo();}
\DoxyCodeLine{00865 }
\DoxyCodeLine{00866   moveControlPoints(delta);}
\DoxyCodeLine{00867 }
\DoxyCodeLine{00868   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00869   \textcolor{comment}{// Registro l'UNDO}}
\DoxyCodeLine{00870   TUndoManager::manager()-\/>add(m\_undo);}
\DoxyCodeLine{00871 }
\DoxyCodeLine{00872   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00873 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_aedcc7252ad04d212e745ff54e0eb19a3}\label{class_control_point_editor_tool_aedcc7252ad04d212e745ff54e0eb19a3}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!leftButtonDown@{leftButtonDown}}
\index{leftButtonDown@{leftButtonDown}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDown()}{leftButtonDown()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::left\+Button\+Down (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00434                                                                   \{}
\DoxyCodeLine{00435   \textcolor{keywordflow}{if} (getViewer() \&\& getViewer()-\/>getGuidedStrokePickerMode()) \{}
\DoxyCodeLine{00436     getViewer()-\/>doPickGuideStroke(pos);}
\DoxyCodeLine{00437     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00438   \}}
\DoxyCodeLine{00439 }
\DoxyCodeLine{00440   m\_pos           = pos;}
\DoxyCodeLine{00441   \textcolor{keywordtype}{double} pix      = getPixelSize() * 2.0f;}
\DoxyCodeLine{00442   \textcolor{keywordtype}{double} maxDist  = 5 * pix;}
\DoxyCodeLine{00443   \textcolor{keywordtype}{double} maxDist2 = maxDist * maxDist;}
\DoxyCodeLine{00444   \textcolor{keywordtype}{double} dist2    = 0;}
\DoxyCodeLine{00445   \textcolor{keywordtype}{int} pointIndex;}
\DoxyCodeLine{00446   ControlPointEditorStroke::PointType pointType =}
\DoxyCodeLine{00447       m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a97247ab7eb478a10e3b59a366fc6fa31}{getPointTypeAt}}(pos, maxDist2, pointIndex);}
\DoxyCodeLine{00448 }
\DoxyCodeLine{00449   \textcolor{keywordflow}{if} (pointType == ControlPointEditorStroke::NONE) \{}
\DoxyCodeLine{00450     \textcolor{comment}{// ho cliccato lontano dalla curva corrente}}
\DoxyCodeLine{00451     \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{00452     \textcolor{keywordflow}{if} (m\_autoSelectDrawing.getValue()) \{}
\DoxyCodeLine{00453       \textcolor{comment}{// Non sono in nessun gadget}}
\DoxyCodeLine{00454       std::vector<int> columnIndexes;}
\DoxyCodeLine{00455       getViewer()-\/>posToColumnIndexes(e.\mbox{\hyperlink{class_t_mouse_event_a05a3f2378eb2179d121e2e46766916de}{m\_pos}}, columnIndexes, 5.0, \textcolor{keyword}{false});}
\DoxyCodeLine{00456       getNearestStrokeColumnIndexes(columnIndexes, pos);}
\DoxyCodeLine{00457       \textcolor{keywordflow}{if} (!columnIndexes.empty()) \{}
\DoxyCodeLine{00458         \textcolor{keywordtype}{int} currentColumnIndex = app-\/>getCurrentColumn()-\/>getColumnIndex();}
\DoxyCodeLine{00459         \textcolor{keywordtype}{int} columnIndex;}
\DoxyCodeLine{00460         \textcolor{keywordflow}{if} (columnIndexes.size() == 1)}
\DoxyCodeLine{00461           columnIndex = columnIndexes[0];}
\DoxyCodeLine{00462         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00463           \mbox{\hyperlink{class_tool_utils_1_1_colum_chooser_menu}{ToolUtils::ColumChooserMenu}} *menu = \textcolor{keyword}{new} \mbox{\hyperlink{class_tool_utils_1_1_colum_chooser_menu}{ToolUtils::ColumChooserMenu}}(}
\DoxyCodeLine{00464               app-\/>getCurrentXsheet()-\/>getXsheet(), columnIndexes);}
\DoxyCodeLine{00465           m\_isMenuViewed = \textcolor{keyword}{true};}
\DoxyCodeLine{00466           columnIndex    = menu-\/>execute();}
\DoxyCodeLine{00467         \}}
\DoxyCodeLine{00468         \mbox{\hyperlink{class_t_xsh_column}{TXshColumn}} *column =}
\DoxyCodeLine{00469             app-\/>getCurrentXsheet()-\/>getXsheet()-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(columnIndex);}
\DoxyCodeLine{00470         \textcolor{keywordflow}{if} (columnIndex >= 0 \&\& columnIndex != currentColumnIndex \&\& column \&\&}
\DoxyCodeLine{00471             !column-\/>isLocked()) \{}
\DoxyCodeLine{00472           \mbox{\hyperlink{class_t_affine}{TAffine}} aff = getMatrix();}
\DoxyCodeLine{00473           app-\/>getCurrentColumn()-\/>setColumnIndex(columnIndex);}
\DoxyCodeLine{00474           \mbox{\hyperlink{class_t_tool_a1a5f380464a6b36947212e2f8d5b314c}{updateMatrix}}();}
\DoxyCodeLine{00475           currentColumnIndex = columnIndex;}
\DoxyCodeLine{00476           m\_pos              = getMatrix().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * aff * pos;}
\DoxyCodeLine{00477         \}}
\DoxyCodeLine{00478       \}}
\DoxyCodeLine{00479     \}}
\DoxyCodeLine{00480 }
\DoxyCodeLine{00481     \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = \mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{false});}
\DoxyCodeLine{00482     \textcolor{keywordflow}{if} (!vi) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00483     \textcolor{keywordtype}{double} dist2, t = 0;}
\DoxyCodeLine{00484     UINT index = -\/1;}
\DoxyCodeLine{00485     \textcolor{keywordflow}{if} (vi-\/>getNearestStroke(m\_pos, t, index, dist2) \&\&}
\DoxyCodeLine{00486         dist2 < 25 * getPixelSize() * getPixelSize()) \{}
\DoxyCodeLine{00487       \textcolor{comment}{// ho cliccato vicino alla curva index-\/esima}}
\DoxyCodeLine{00488       assert(0 <= index \&\& index < vi-\/>getStrokeCount());}
\DoxyCodeLine{00489       m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aae2e6944903ac1ca932e0cd79c0e387a}{setStroke}}(vi, index);}
\DoxyCodeLine{00490       m\_action = NONE;}
\DoxyCodeLine{00491       m\_selection.makeCurrent();}
\DoxyCodeLine{00492     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00493       \textcolor{keywordflow}{if} (m\_selectType.getValue() == RECTANGULAR\_WSTR) \{}
\DoxyCodeLine{00494         m\_action        = RECT\_SELECTION;}
\DoxyCodeLine{00495         m\_selectingRect = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(m\_pos.x, m\_pos.y, m\_pos.x + 1, m\_pos.y + 1);}
\DoxyCodeLine{00496         \textcolor{keywordflow}{if} (m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} > m\_selectingRect.x1)}
\DoxyCodeLine{00497           std::swap(m\_selectingRect.x1, m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}});}
\DoxyCodeLine{00498         \textcolor{keywordflow}{if} (m\_selectingRect.y0 > m\_selectingRect.y1)}
\DoxyCodeLine{00499           std::swap(m\_selectingRect.y1, m\_selectingRect.y0);}
\DoxyCodeLine{00500 }
\DoxyCodeLine{00501       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_selectType.getValue() == FREEHAND\_WSTR) \{}
\DoxyCodeLine{00502         m\_action = FREEHAND\_SELECTION;}
\DoxyCodeLine{00503         startFreehand(pos);}
\DoxyCodeLine{00504       \}}
\DoxyCodeLine{00505     \}}
\DoxyCodeLine{00506     m\_selection.selectNone();}
\DoxyCodeLine{00507     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00508   \}}
\DoxyCodeLine{00509   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = \mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00510   \textcolor{keywordflow}{if} (!vi) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00511 }
\DoxyCodeLine{00512   \textcolor{keywordflow}{if} (pointType == ControlPointEditorStroke::SPEED\_IN ||}
\DoxyCodeLine{00513       pointType == ControlPointEditorStroke::SPEED\_OUT) \{}
\DoxyCodeLine{00514     \textcolor{keywordtype}{bool} isIn = pointType == ControlPointEditorStroke::SPEED\_IN;}
\DoxyCodeLine{00515     m\_selection.selectNone();}
\DoxyCodeLine{00516     m\_selection.select(pointIndex);}
\DoxyCodeLine{00517     m\_action = isIn ? IN\_SPEED\_MOVEMENT : OUT\_SPEED\_MOVEMENT;}
\DoxyCodeLine{00518     \textcolor{keywordflow}{if} (e.isAltPressed()) \{}
\DoxyCodeLine{00519       initUndo();}
\DoxyCodeLine{00520       \textcolor{keywordflow}{if} (m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aa50af442384b422cd7ac515fd1c92ca3}{isCusp}}(pointIndex))}
\DoxyCodeLine{00521         linkSpeedInOut(pointIndex);}
\DoxyCodeLine{00522       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00523         unlinkSpeedInOut(pointIndex);}
\DoxyCodeLine{00524       TUndoManager::manager()-\/>add(m\_undo);}
\DoxyCodeLine{00525       m\_undo = 0;}
\DoxyCodeLine{00526     \}}
\DoxyCodeLine{00527     m\_selection.makeCurrent();}
\DoxyCodeLine{00528   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (pointType == ControlPointEditorStroke::CONTROL\_POINT) \{}
\DoxyCodeLine{00529     \textcolor{keywordflow}{if} (e.isAltPressed()) \{}
\DoxyCodeLine{00530       m\_action = NONE;}
\DoxyCodeLine{00531       m\_selection.selectNone();}
\DoxyCodeLine{00532       m\_selection.select(pointIndex);}
\DoxyCodeLine{00533       initUndo();}
\DoxyCodeLine{00534       \textcolor{keywordtype}{bool} isSpeedIn  = m\_controlPointEditorStroke.isSpeedInLinear(pointIndex);}
\DoxyCodeLine{00535       \textcolor{keywordtype}{bool} isSpeedOut = m\_controlPointEditorStroke.isSpeedOutLinear(pointIndex);}
\DoxyCodeLine{00536       m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_ae1f6d2d7508048e40e79023140292e21}{setLinear}}(pointIndex,}
\DoxyCodeLine{00537                                            !isSpeedIn \&\& !isSpeedOut);}
\DoxyCodeLine{00538       TUndoManager::manager()-\/>add(m\_undo);}
\DoxyCodeLine{00539       m\_undo = 0;}
\DoxyCodeLine{00540       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00541     \}}
\DoxyCodeLine{00542     \textcolor{keywordflow}{if} (e.isCtrlPressed()) \{}
\DoxyCodeLine{00543       \textcolor{keywordflow}{if} (m\_selection.isSelected(pointIndex))}
\DoxyCodeLine{00544         m\_selection.unselect(pointIndex);}
\DoxyCodeLine{00545       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00546         m\_selection.select(pointIndex);}
\DoxyCodeLine{00547     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_selection.isEmpty() || !m\_selection.isSelected(pointIndex)) \{}
\DoxyCodeLine{00548       m\_selection.selectNone();}
\DoxyCodeLine{00549       m\_selection.select(pointIndex);}
\DoxyCodeLine{00550     \}}
\DoxyCodeLine{00551     m\_lastPointSelected = pointIndex;}
\DoxyCodeLine{00552     m\_action            = CP\_MOVEMENT;}
\DoxyCodeLine{00553     m\_selection.makeCurrent();}
\DoxyCodeLine{00554   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (pointType == ControlPointEditorStroke::SEGMENT \&\&}
\DoxyCodeLine{00555              !e.isAltPressed()) \{}
\DoxyCodeLine{00556     m\_selection.selectNone();}
\DoxyCodeLine{00557     \textcolor{keywordflow}{if} (e.isCtrlPressed()) \{}
\DoxyCodeLine{00558       \textcolor{comment}{// Aggiungo un punto}}
\DoxyCodeLine{00559       initUndo();}
\DoxyCodeLine{00560       pointIndex = m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a80aa56ecbe43ddf813b4c882e5f20d83}{addControlPoint}}(pos);}
\DoxyCodeLine{00561       m\_selection.select(pointIndex);}
\DoxyCodeLine{00562       m\_action = CP\_MOVEMENT;}
\DoxyCodeLine{00563       TUndoManager::manager()-\/>add(m\_undo);}
\DoxyCodeLine{00564       m\_lastPointSelected = -\/1;}
\DoxyCodeLine{00565       \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{00566     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00567       \textcolor{comment}{// Inizio a muovere la curva}}
\DoxyCodeLine{00568       \textcolor{keywordtype}{int} precPointIndex, nextPointIndex;}
\DoxyCodeLine{00569       precPointIndex = pointIndex;}
\DoxyCodeLine{00570       nextPointIndex =}
\DoxyCodeLine{00571           (m\_controlPointEditorStroke.isSelfLoop() \&\&}
\DoxyCodeLine{00572            precPointIndex ==}
\DoxyCodeLine{00573                m\_controlPointEditorStroke.getControlPointCount() -\/ 1)}
\DoxyCodeLine{00574               ? 0}
\DoxyCodeLine{00575               : precPointIndex + 1;}
\DoxyCodeLine{00576       \textcolor{keywordflow}{if} (precPointIndex > -\/1 \&\& nextPointIndex > -\/1) \{}
\DoxyCodeLine{00577         \textcolor{keywordflow}{if} (precPointIndex > nextPointIndex)}
\DoxyCodeLine{00578           std::swap(precPointIndex, nextPointIndex);}
\DoxyCodeLine{00579         m\_moveSegmentLimitation.first  = precPointIndex;}
\DoxyCodeLine{00580         m\_moveSegmentLimitation.second = nextPointIndex;}
\DoxyCodeLine{00581       \}}
\DoxyCodeLine{00582       m\_moveControlPointEditorStroke = *m\_controlPointEditorStroke.clone();}
\DoxyCodeLine{00583       \textcolor{comment}{// Se e' premuto shift setto a cusp i due punti di controllo che}}
\DoxyCodeLine{00584       \textcolor{comment}{// delimitano il segmento.}}
\DoxyCodeLine{00585       \textcolor{keywordflow}{if} (e.isShiftPressed()) \{}
\DoxyCodeLine{00586         \textcolor{keywordflow}{if} (!m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aa50af442384b422cd7ac515fd1c92ca3}{isCusp}}(precPointIndex)) \{}
\DoxyCodeLine{00587           m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a4ecb68e14d8f5c279d998352775ad0f6}{setCusp}}(precPointIndex, \textcolor{keyword}{true}, \textcolor{keyword}{false});}
\DoxyCodeLine{00588           m\_moveControlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a4ecb68e14d8f5c279d998352775ad0f6}{setCusp}}(precPointIndex, \textcolor{keyword}{true}, \textcolor{keyword}{false});}
\DoxyCodeLine{00589         \}}
\DoxyCodeLine{00590         \textcolor{keywordflow}{if} (!m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aa50af442384b422cd7ac515fd1c92ca3}{isCusp}}(nextPointIndex)) \{}
\DoxyCodeLine{00591           m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a4ecb68e14d8f5c279d998352775ad0f6}{setCusp}}(nextPointIndex, \textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{00592           m\_moveControlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a4ecb68e14d8f5c279d998352775ad0f6}{setCusp}}(nextPointIndex, \textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{00593         \}}
\DoxyCodeLine{00594       \}}
\DoxyCodeLine{00595       m\_action = SEGMENT\_MOVEMENT;}
\DoxyCodeLine{00596     \}}
\DoxyCodeLine{00597     m\_selection.makeCurrent();}
\DoxyCodeLine{00598   \}}
\DoxyCodeLine{00599 }
\DoxyCodeLine{00600   \textcolor{keywordtype}{int} currentStroke = m\_controlPointEditorStroke.getStrokeIndex();}
\DoxyCodeLine{00601   \textcolor{keywordflow}{if} (currentStroke != -\/1) initUndo();}
\DoxyCodeLine{00602   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00603   m\_isImageChanged = \textcolor{keyword}{false};}
\DoxyCodeLine{00604 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a863e32f78065e5475c502083f9ab0a07}\label{class_control_point_editor_tool_a863e32f78065e5475c502083f9ab0a07}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!leftButtonDrag@{leftButtonDrag}}
\index{leftButtonDrag@{leftButtonDrag}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDrag()}{leftButtonDrag()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::left\+Button\+Drag (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00674                                                                   \{}
\DoxyCodeLine{00675   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true}));}
\DoxyCodeLine{00676   \textcolor{keywordtype}{int} currentStroke = m\_controlPointEditorStroke.getStrokeIndex();}
\DoxyCodeLine{00677   \textcolor{keywordflow}{if} (!vi || currentStroke == -\/1 || m\_action == NONE) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00678   QMutexLocker lock(vi-\/>getMutex());}
\DoxyCodeLine{00679 }
\DoxyCodeLine{00680   \mbox{\hyperlink{class_t_point_t}{TPointD}} delta = pos -\/ m\_pos;}
\DoxyCodeLine{00681 }
\DoxyCodeLine{00682   \textcolor{keywordflow}{if} (m\_action == CP\_MOVEMENT) \{}
\DoxyCodeLine{00683     \textcolor{keywordflow}{if} (!m\_selection.isSelected(m\_lastPointSelected) \&\& e.isCtrlPressed())}
\DoxyCodeLine{00684       m\_selection.select(m\_lastPointSelected);  \textcolor{comment}{// Controllo che non venga}}
\DoxyCodeLine{00685                                                 \textcolor{comment}{// deselezionata l'ultima}}
\DoxyCodeLine{00686                                                 \textcolor{comment}{// selezione nel movimento}}
\DoxyCodeLine{00687 }
\DoxyCodeLine{00688     \textcolor{keywordflow}{if} (m\_lastPointSelected >= 0) \{}
\DoxyCodeLine{00689       \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} cp;}
\DoxyCodeLine{00690       \mbox{\hyperlink{class_t_point_t}{TPointD}} controlPoint;}
\DoxyCodeLine{00691       \mbox{\hyperlink{class_t_point_t}{TPointD}} newPos;}
\DoxyCodeLine{00692 }
\DoxyCodeLine{00693       cp = m\_controlPointEditorStroke.getControlPoint(m\_lastPointSelected);}
\DoxyCodeLine{00694       controlPoint = \mbox{\hyperlink{class_t_point_t}{TPointD}}(cp.x, cp.y);}
\DoxyCodeLine{00695       newPos       = calculateSnap(pos);}
\DoxyCodeLine{00696       delta        = newPos -\/ m\_pos + (m\_pos -\/ controlPoint);}
\DoxyCodeLine{00697     \}}
\DoxyCodeLine{00698 }
\DoxyCodeLine{00699     m\_pos = pos;}
\DoxyCodeLine{00700 }
\DoxyCodeLine{00701     moveControlPoints(delta);}
\DoxyCodeLine{00702     m\_isImageChanged = \textcolor{keyword}{true};}
\DoxyCodeLine{00703   \}}
\DoxyCodeLine{00704   \textcolor{keywordflow}{if} (m\_action == SEGMENT\_MOVEMENT) \{}
\DoxyCodeLine{00705     m\_moveControlPointEditorStroke = *m\_controlPointEditorStroke.clone();}
\DoxyCodeLine{00706     moveSegment(delta, \textcolor{keyword}{true}, e.isShiftPressed());}
\DoxyCodeLine{00707     m\_isImageChanged = \textcolor{keyword}{true};}
\DoxyCodeLine{00708   \}}
\DoxyCodeLine{00709   \textcolor{keywordflow}{if} (m\_action == OUT\_SPEED\_MOVEMENT || m\_action == IN\_SPEED\_MOVEMENT) \{}
\DoxyCodeLine{00710     m\_pos = pos;}
\DoxyCodeLine{00711     moveSpeed(delta, m\_action == IN\_SPEED\_MOVEMENT);}
\DoxyCodeLine{00712     m\_isImageChanged = \textcolor{keyword}{true};}
\DoxyCodeLine{00713   \}}
\DoxyCodeLine{00714 }
\DoxyCodeLine{00715   \textcolor{keywordflow}{if} (m\_action == RECT\_SELECTION) \{}
\DoxyCodeLine{00716     \textcolor{keywordtype}{int} cpCount        = m\_controlPointEditorStroke.getControlPointCount();}
\DoxyCodeLine{00717     m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} = m\_pos.x;}
\DoxyCodeLine{00718     m\_selectingRect.y0 = m\_pos.y;}
\DoxyCodeLine{00719     m\_selectingRect.x1 = pos.x;}
\DoxyCodeLine{00720     m\_selectingRect.y1 = pos.y;}
\DoxyCodeLine{00721     \textcolor{keywordflow}{if} (m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} > m\_selectingRect.x1)}
\DoxyCodeLine{00722       std::swap(m\_selectingRect.x1, m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}});}
\DoxyCodeLine{00723     \textcolor{keywordflow}{if} (m\_selectingRect.y0 > m\_selectingRect.y1)}
\DoxyCodeLine{00724       std::swap(m\_selectingRect.y1, m\_selectingRect.y0);}
\DoxyCodeLine{00725     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00726     m\_selection.selectNone();}
\DoxyCodeLine{00727     \textcolor{keywordflow}{for} (i = 0; i < cpCount; i++)}
\DoxyCodeLine{00728       \textcolor{keywordflow}{if} (m\_selectingRect.contains(}
\DoxyCodeLine{00729               m\_controlPointEditorStroke.getControlPoint(i)))}
\DoxyCodeLine{00730         m\_selection.select(i);}
\DoxyCodeLine{00731   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_action == FREEHAND\_SELECTION) \{}
\DoxyCodeLine{00732     freehandDrag(pos);}
\DoxyCodeLine{00733   \}}
\DoxyCodeLine{00734 }
\DoxyCodeLine{00735   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00736 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a345948649ad36284347376cb1df8c680}\label{class_control_point_editor_tool_a345948649ad36284347376cb1df8c680}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!leftButtonUp@{leftButtonUp}}
\index{leftButtonUp@{leftButtonUp}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{leftButtonUp()}{leftButtonUp()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::left\+Button\+Up (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00758                                                                 \{}
\DoxyCodeLine{00759   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true}));}
\DoxyCodeLine{00760   \textcolor{keywordtype}{int} currentStroke = m\_controlPointEditorStroke.getStrokeIndex();}
\DoxyCodeLine{00761   \textcolor{keywordflow}{if} (!vi || currentStroke == -\/1) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00762   QMutexLocker lock(vi-\/>getMutex());}
\DoxyCodeLine{00763 }
\DoxyCodeLine{00764   \mbox{\hyperlink{class_t_point_t}{TPointD}} pos;}
\DoxyCodeLine{00765   pos = getSnap(realPos);}
\DoxyCodeLine{00766   resetSnap();}
\DoxyCodeLine{00767 }
\DoxyCodeLine{00768   \textcolor{keywordflow}{if} (m\_action == SEGMENT\_MOVEMENT) \{}
\DoxyCodeLine{00769     m\_moveControlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aae2e6944903ac1ca932e0cd79c0e387a}{setStroke}}((\mbox{\hyperlink{class_t_vector_image}{TVectorImage}} *)0, -\/1);}
\DoxyCodeLine{00770     \mbox{\hyperlink{class_t_point_t}{TPointD}} delta = pos -\/ m\_pos;}
\DoxyCodeLine{00771     moveSegment(delta, \textcolor{keyword}{false}, e.isShiftPressed());}
\DoxyCodeLine{00772   \}}
\DoxyCodeLine{00773 }
\DoxyCodeLine{00774   \textcolor{keywordflow}{if} (m\_action == RECT\_SELECTION || m\_action == FREEHAND\_SELECTION) \{}
\DoxyCodeLine{00775     \textcolor{keywordflow}{if} (m\_action == FREEHAND\_SELECTION) \{}
\DoxyCodeLine{00776       closeFreehand(pos);}
\DoxyCodeLine{00777       selectRegion(m\_stroke);}
\DoxyCodeLine{00778       m\_track.\mbox{\hyperlink{class_stroke_generator_a4a78460714a37e461296d169715ba460}{clear}}();}
\DoxyCodeLine{00779     \}}
\DoxyCodeLine{00780 }
\DoxyCodeLine{00781     \textcolor{keywordflow}{if} (m\_selection.isEmpty()) \{}
\DoxyCodeLine{00782       \textcolor{comment}{// Non ho selezionato nulla}}
\DoxyCodeLine{00783       \textcolor{keywordflow}{if} (!TTool::getApplication()}
\DoxyCodeLine{00784                -\/>getCurrentObject()}
\DoxyCodeLine{00785                -\/>isSpline())  \textcolor{comment}{// se non e' una spline deseleziono}}
\DoxyCodeLine{00786         m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aae2e6944903ac1ca932e0cd79c0e387a}{setStroke}}((\mbox{\hyperlink{class_t_vector_image}{TVectorImage}} *)0, -\/1);}
\DoxyCodeLine{00787       m\_action         = NONE;}
\DoxyCodeLine{00788       m\_isImageChanged = \textcolor{keyword}{false};}
\DoxyCodeLine{00789     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00790       m\_action = CP\_MOVEMENT;}
\DoxyCodeLine{00791       m\_selection.makeCurrent();}
\DoxyCodeLine{00792       m\_isImageChanged = \textcolor{keyword}{false};}
\DoxyCodeLine{00793     \}}
\DoxyCodeLine{00794   \}}
\DoxyCodeLine{00795 }
\DoxyCodeLine{00796   \textcolor{keywordflow}{if} (m\_action == NONE || !m\_isImageChanged) \{}
\DoxyCodeLine{00797     m\_undo = 0;}
\DoxyCodeLine{00798     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00799     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00800   \}}
\DoxyCodeLine{00801 }
\DoxyCodeLine{00802   \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{00803   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00804 }
\DoxyCodeLine{00805   \textcolor{comment}{// Registro l'UNDO}}
\DoxyCodeLine{00806   \textcolor{keywordflow}{if} (m\_undo) \{}
\DoxyCodeLine{00807     TUndoManager::manager()-\/>add(m\_undo);}
\DoxyCodeLine{00808     m\_undo = 0;}
\DoxyCodeLine{00809   \}}
\DoxyCodeLine{00810 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a2fb472f52b6894d06aae87ddef1bde53}\label{class_control_point_editor_tool_a2fb472f52b6894d06aae87ddef1bde53}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!linkSpeedInOut@{linkSpeedInOut}}
\index{linkSpeedInOut@{linkSpeedInOut}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{linkSpeedInOut()}{linkSpeedInOut()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::link\+Speed\+In\+Out (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00821                                                      \{}
\DoxyCodeLine{00822   \textcolor{keywordflow}{if} ((index == 0 ||}
\DoxyCodeLine{00823        index == m\_controlPointEditorStroke.getControlPointCount() -\/ 1) \&\&}
\DoxyCodeLine{00824       !m\_controlPointEditorStroke.isSelfLoop())}
\DoxyCodeLine{00825     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00826   \textcolor{keywordflow}{if} (m\_action == IN\_SPEED\_MOVEMENT || m\_action == CP\_MOVEMENT)}
\DoxyCodeLine{00827     m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a4ecb68e14d8f5c279d998352775ad0f6}{setCusp}}(index, \textcolor{keyword}{false}, \textcolor{keyword}{true});}
\DoxyCodeLine{00828   \textcolor{keywordflow}{if} (m\_action == OUT\_SPEED\_MOVEMENT)}
\DoxyCodeLine{00829     m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a4ecb68e14d8f5c279d998352775ad0f6}{setCusp}}(index, \textcolor{keyword}{false}, \textcolor{keyword}{false});}
\DoxyCodeLine{00830   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00831 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a22b85672ae213ce80452b8e1d0e2618a}\label{class_control_point_editor_tool_a22b85672ae213ce80452b8e1d0e2618a}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!mouseMove@{mouseMove}}
\index{mouseMove@{mouseMove}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{mouseMove()}{mouseMove()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::mouse\+Move (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00399                                                              \{}
\DoxyCodeLine{00400   \textcolor{comment}{// Scelgo il cursore in base alla distanza del mouse dalla curva e dai punti}}
\DoxyCodeLine{00401   \textcolor{comment}{// di controllo}}
\DoxyCodeLine{00402   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00403   \textcolor{keywordflow}{if} (!vi) \{}
\DoxyCodeLine{00404     m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aae2e6944903ac1ca932e0cd79c0e387a}{setStroke}}((\mbox{\hyperlink{class_t_vector_image}{TVectorImage}} *)0, -\/1);}
\DoxyCodeLine{00405     m\_cursorType = NO\_ACTIVE;}
\DoxyCodeLine{00406     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00407   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00408     m\_cursorType = NORMAL;}
\DoxyCodeLine{00409 }
\DoxyCodeLine{00410   m\_pos = pos;}
\DoxyCodeLine{00411 }
\DoxyCodeLine{00412   \textcolor{keywordflow}{if} (!m\_draw || m\_controlPointEditorStroke.getStrokeIndex() == -\/1) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00413   \textcolor{keywordflow}{if} (e.isAltPressed())}
\DoxyCodeLine{00414     m\_cursorType = EDIT\_SPEED;}
\DoxyCodeLine{00415   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00416     \textcolor{keywordtype}{double} maxDist  = 5 * getPixelSize();}
\DoxyCodeLine{00417     \textcolor{keywordtype}{double} maxDist2 = maxDist * maxDist;}
\DoxyCodeLine{00418     \textcolor{keywordtype}{int} pointIndexCP;}
\DoxyCodeLine{00419     ControlPointEditorStroke::PointType pointType =}
\DoxyCodeLine{00420         m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a97247ab7eb478a10e3b59a366fc6fa31}{getPointTypeAt}}(pos, maxDist2, pointIndexCP);}
\DoxyCodeLine{00421     \textcolor{keywordflow}{if} (pointType == ControlPointEditorStroke::SEGMENT \&\& e.isCtrlPressed())}
\DoxyCodeLine{00422       m\_cursorType = ADD;}
\DoxyCodeLine{00423     \textcolor{comment}{// else if(pointType == ControlPointEditorStroke::SEGMENT)}}
\DoxyCodeLine{00424     \textcolor{comment}{// m\_cursorType=EDIT\_SEGMENT;}}
\DoxyCodeLine{00425     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00426       m\_cursorType = NORMAL;}
\DoxyCodeLine{00427   \}}
\DoxyCodeLine{00428   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00429 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a5be15662abdd052345cfebdfaafa4c0f}\label{class_control_point_editor_tool_a5be15662abdd052345cfebdfaafa4c0f}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!moveControlPoints@{moveControlPoints}}
\index{moveControlPoints@{moveControlPoints}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{moveControlPoints()}{moveControlPoints()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::move\+Control\+Points (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{delta }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00624                                                                    \{}
\DoxyCodeLine{00625   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00626   \textcolor{keywordtype}{int} cpCount = m\_controlPointEditorStroke.getControlPointCount();}
\DoxyCodeLine{00627   \textcolor{keywordflow}{for} (i = 0; i < cpCount; i++)}
\DoxyCodeLine{00628     \textcolor{keywordflow}{if} (m\_selection.isSelected(i))}
\DoxyCodeLine{00629       m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a39af5add560886dfbaa044c39b68699d}{moveControlPoint}}(i, delta);}
\DoxyCodeLine{00630 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a16a89324023289f868e33ed1eec4438b}\label{class_control_point_editor_tool_a16a89324023289f868e33ed1eec4438b}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!moveSegment@{moveSegment}}
\index{moveSegment@{moveSegment}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{moveSegment()}{moveSegment()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::move\+Segment (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{delta,  }\item[{bool}]{dragging,  }\item[{bool}]{is\+Shift\+Pressed }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00644                                                               \{}
\DoxyCodeLine{00645   \textcolor{keywordtype}{int} beforeIndex = m\_moveSegmentLimitation.first;}
\DoxyCodeLine{00646   \textcolor{keywordtype}{int} nextIndex   = m\_moveSegmentLimitation.second;}
\DoxyCodeLine{00647   \textcolor{comment}{// Se e' premuto shift setto a cusp i due punti di controllo che delimitano il}}
\DoxyCodeLine{00648   \textcolor{comment}{// segmento.}}
\DoxyCodeLine{00649   \textcolor{keywordflow}{if} (isShiftPressed) \{}
\DoxyCodeLine{00650     \textcolor{keywordflow}{if} (!m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aa50af442384b422cd7ac515fd1c92ca3}{isCusp}}(beforeIndex)) \{}
\DoxyCodeLine{00651       \textcolor{keywordflow}{if} (dragging)}
\DoxyCodeLine{00652         m\_moveControlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a4ecb68e14d8f5c279d998352775ad0f6}{setCusp}}(beforeIndex, \textcolor{keyword}{true}, \textcolor{keyword}{false});}
\DoxyCodeLine{00653       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00654         m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a4ecb68e14d8f5c279d998352775ad0f6}{setCusp}}(beforeIndex, \textcolor{keyword}{true}, \textcolor{keyword}{false});}
\DoxyCodeLine{00655     \}}
\DoxyCodeLine{00656     \textcolor{keywordflow}{if} (!m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aa50af442384b422cd7ac515fd1c92ca3}{isCusp}}(nextIndex)) \{}
\DoxyCodeLine{00657       \textcolor{keywordflow}{if} (dragging)}
\DoxyCodeLine{00658         m\_moveControlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a4ecb68e14d8f5c279d998352775ad0f6}{setCusp}}(nextIndex, \textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{00659       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00660         m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a4ecb68e14d8f5c279d998352775ad0f6}{setCusp}}(nextIndex, \textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{00661     \}}
\DoxyCodeLine{00662   \}}
\DoxyCodeLine{00663   \textcolor{keywordflow}{if} (dragging)}
\DoxyCodeLine{00664     m\_moveControlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aedcb3272370078950df6ced76d0c2703}{moveSegment}}(beforeIndex, nextIndex, delta,}
\DoxyCodeLine{00665                                                m\_pos);}
\DoxyCodeLine{00666   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00667     m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aedcb3272370078950df6ced76d0c2703}{moveSegment}}(beforeIndex, nextIndex, delta,}
\DoxyCodeLine{00668                                            m\_pos);}
\DoxyCodeLine{00669 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a6e541f2837c50a370aee68f23b158073}\label{class_control_point_editor_tool_a6e541f2837c50a370aee68f23b158073}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!moveSpeed@{moveSpeed}}
\index{moveSpeed@{moveSpeed}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{moveSpeed()}{moveSpeed()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::move\+Speed (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{delta,  }\item[{bool}]{is\+In }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00634                                                                       \{}
\DoxyCodeLine{00635   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00636   \textcolor{keywordflow}{for} (i = 0; i < m\_controlPointEditorStroke.getControlPointCount(); i++)}
\DoxyCodeLine{00637     \textcolor{keywordflow}{if} (m\_selection.isSelected(i))}
\DoxyCodeLine{00638       m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_abedad5e542f17b175b711c7393623c39}{moveSpeed}}(i, delta, isIn, 4 * getPixelSize());}
\DoxyCodeLine{00639 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_ac26218b59fe5049b120640639f3ef89c}\label{class_control_point_editor_tool_ac26218b59fe5049b120640639f3ef89c}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!onActivate@{onActivate}}
\index{onActivate@{onActivate}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{onActivate()}{onActivate()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::on\+Activate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback invoked whenever the tool activates. 



Reimplemented from \mbox{\hyperlink{class_t_tool_ac286a2681633b4db6106596b4f54e53b}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00924                                         \{}
\DoxyCodeLine{00925   \textcolor{comment}{// TODO: getApplication()-\/>editImageOrSpline();}}
\DoxyCodeLine{00926   m\_selectType.setValue(::to\_wstring(CPSelectionType.getValue()));}
\DoxyCodeLine{00927   m\_autoSelectDrawing.setValue(AutoSelectDrawing ? 1 : 0);}
\DoxyCodeLine{00928   m\_snap.setValue(Snap ? 1 : 0);}
\DoxyCodeLine{00929   m\_snapSensitivity.setIndex(SnapSensitivity);}
\DoxyCodeLine{00930   \textcolor{keywordflow}{switch} (SnapSensitivity) \{}
\DoxyCodeLine{00931   \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{00932     m\_snapMinDistance = SNAPPING\_LOW;}
\DoxyCodeLine{00933     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00934   \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{00935     m\_snapMinDistance = SNAPPING\_MEDIUM;}
\DoxyCodeLine{00936     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00937   \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{00938     m\_snapMinDistance = SNAPPING\_HIGH;}
\DoxyCodeLine{00939     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00940   \}}
\DoxyCodeLine{00941   m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aae2e6944903ac1ca932e0cd79c0e387a}{setStroke}}((\mbox{\hyperlink{class_t_vector_image}{TVectorImage}} *)0, -\/1);}
\DoxyCodeLine{00942   m\_draw = \textcolor{keyword}{true};}
\DoxyCodeLine{00943   resetSnap();}
\DoxyCodeLine{00944 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00459}{Control\+Point\+Editor\+Stroke\+::set\+Stroke()}}.

\mbox{\Hypertarget{class_control_point_editor_tool_a5f01b22cd99a322b46ad1fe7c171ba85}\label{class_control_point_editor_tool_a5f01b22cd99a322b46ad1fe7c171ba85}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!onDeactivate@{onDeactivate}}
\index{onDeactivate@{onDeactivate}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{onDeactivate()}{onDeactivate()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::on\+Deactivate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback for tool deactivation, includes tool switch. 



Reimplemented from \mbox{\hyperlink{class_t_tool_a00fee58728c1e12fb50846f47d7e9f5e}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00948 \{ m\_draw = \textcolor{keyword}{false}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a8da6296cd702c773d5c37eeb4c1be262}\label{class_control_point_editor_tool_a8da6296cd702c773d5c37eeb4c1be262}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!onEnter@{onEnter}}
\index{onEnter@{onEnter}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{onEnter()}{onEnter()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::on\+Enter (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback for the mouse entering the viewer area. 



Reimplemented from \mbox{\hyperlink{class_t_tool_a3e775cfcd05aa3c35048b11fa40ab3e4}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00877                                      \{}
\DoxyCodeLine{00878   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00879   \textcolor{keywordtype}{int} currentStroke = m\_controlPointEditorStroke.getStrokeIndex();}
\DoxyCodeLine{00880   \textcolor{keywordflow}{if} (m\_isMenuViewed) \{}
\DoxyCodeLine{00881     m\_isMenuViewed = \textcolor{keyword}{false};}
\DoxyCodeLine{00882     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00883   \}}
\DoxyCodeLine{00884   \textcolor{comment}{/*m\_draw=true;}}
\DoxyCodeLine{00885 \textcolor{comment}{  if(currentStroke==-\/1 || !vi)}}
\DoxyCodeLine{00886 \textcolor{comment}{          return;}}
\DoxyCodeLine{00887 \textcolor{comment}{}}
\DoxyCodeLine{00888 \textcolor{comment}{  m\_controlPointEditorStroke.setStroke((TVectorImage*)0, -\/1);}}
\DoxyCodeLine{00889 \textcolor{comment}{}}
\DoxyCodeLine{00890 \textcolor{comment}{if(TTool::getApplication()-\/>getCurrentObject()-\/>isSpline())}}
\DoxyCodeLine{00891 \textcolor{comment}{          m\_controlPointEditorStroke.setStroke(vi, 0);*/}}
\DoxyCodeLine{00892 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00276}{TTool\+::get\+Image()}}.

\mbox{\Hypertarget{class_control_point_editor_tool_a03767a0350c80a7651d2ff25d226b579}\label{class_control_point_editor_tool_a03767a0350c80a7651d2ff25d226b579}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!onImageChanged@{onImageChanged}}
\index{onImageChanged@{onImageChanged}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{onImageChanged()}{onImageChanged()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::on\+Image\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Notifies changes in the image in use. 



Reimplemented from \mbox{\hyperlink{class_t_tool_aaf1e021290e74c1b085e4b095668e1ed}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00952                                             \{}
\DoxyCodeLine{00953   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00954   \textcolor{keywordflow}{if} (!vi) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00955 }
\DoxyCodeLine{00956   \textcolor{keywordtype}{int} currentStroke = m\_controlPointEditorStroke.getStrokeIndex();}
\DoxyCodeLine{00957   \textcolor{keywordflow}{if} (!vi || currentStroke == -\/1 ||}
\DoxyCodeLine{00958       m\_controlPointEditorStroke.getControlPointCount() == 0 ||}
\DoxyCodeLine{00959       vi-\/>getStrokeCount() == 0 || (\textcolor{keywordtype}{int})vi-\/>getStrokeCount() <= currentStroke) \{}
\DoxyCodeLine{00960     m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aae2e6944903ac1ca932e0cd79c0e387a}{setStroke}}((\mbox{\hyperlink{class_t_vector_image}{TVectorImage}} *)0, -\/1);}
\DoxyCodeLine{00961     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00962   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00963     \textcolor{keywordflow}{if} (m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_aae2e6944903ac1ca932e0cd79c0e387a}{setStroke}}(vi, currentStroke))}
\DoxyCodeLine{00964       m\_selection.selectNone();}
\DoxyCodeLine{00965   \}}
\DoxyCodeLine{00966 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00276}{TTool\+::get\+Image()}}, and \mbox{\hyperlink{l00459}{Control\+Point\+Editor\+Stroke\+::set\+Stroke()}}.

\mbox{\Hypertarget{class_control_point_editor_tool_a2d92b85a916014da278d2deaae90b104}\label{class_control_point_editor_tool_a2d92b85a916014da278d2deaae90b104}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!onLeave@{onLeave}}
\index{onLeave@{onLeave}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{onLeave()}{onLeave()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::on\+Leave (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback for the mouse leaving the viewer area. 



Reimplemented from \mbox{\hyperlink{class_t_tool_af7fb05265a94131da081da654e271a22}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00896                                      \{}
\DoxyCodeLine{00897   \textcolor{keywordflow}{if} (m\_isMenuViewed) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00898   \textcolor{comment}{// m\_draw=false;}}
\DoxyCodeLine{00899 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a5de1575c41151e6701025477440c6e5f}\label{class_control_point_editor_tool_a5de1575c41151e6701025477440c6e5f}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!onPropertyChanged@{onPropertyChanged}}
\index{onPropertyChanged@{onPropertyChanged}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{onPropertyChanged()}{onPropertyChanged()}}
{\footnotesize\ttfamily bool Control\+Point\+Editor\+Tool\+::on\+Property\+Changed (\begin{DoxyParamCaption}\item[{std\+::string}]{property\+Name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

\begin{DoxyVerb} Does the tasks associated to changes in \p propertyName and returns \p
\end{DoxyVerb}
 true; Does the tasks associated to changes in {\ttfamily property\+Name} and returns {\ttfamily true}. 

Reimplemented from \mbox{\hyperlink{class_t_tool_a06694e0586f807c34b18e16341aa9ee2}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00903                                                                      \{}
\DoxyCodeLine{00904   CPSelectionType   = ::to\_string(m\_selectType.getValue());}
\DoxyCodeLine{00905   AutoSelectDrawing = (int)(m\_autoSelectDrawing.getValue());}
\DoxyCodeLine{00906   Snap              = (int)(m\_snap.getValue());}
\DoxyCodeLine{00907   SnapSensitivity   = (int)(m\_snapSensitivity.getIndex());}
\DoxyCodeLine{00908   \textcolor{keywordflow}{switch} (SnapSensitivity) \{}
\DoxyCodeLine{00909   \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{00910     m\_snapMinDistance = SNAPPING\_LOW;}
\DoxyCodeLine{00911     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00912   \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{00913     m\_snapMinDistance = SNAPPING\_MEDIUM;}
\DoxyCodeLine{00914     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00915   \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{00916     m\_snapMinDistance = SNAPPING\_HIGH;}
\DoxyCodeLine{00917     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00918   \}}
\DoxyCodeLine{00919   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00920 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a5ceffa2369e9b2d5f550631eaed7f0c8}\label{class_control_point_editor_tool_a5ceffa2369e9b2d5f550631eaed7f0c8}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!onSelectionChanged@{onSelectionChanged}}
\index{onSelectionChanged@{onSelectionChanged}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{onSelectionChanged()}{onSelectionChanged()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::on\+Selection\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00088 \{ \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a2065c10a346ed623e14c0a4ef250a34f}\label{class_control_point_editor_tool_a2065c10a346ed623e14c0a4ef250a34f}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!resetSnap@{resetSnap}}
\index{resetSnap@{resetSnap}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{resetSnap()}{resetSnap()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::reset\+Snap (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00174 \{ m\_foundSnap = \textcolor{keyword}{false}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a1229f6b442514c4ebcb64737a6e29bf0}\label{class_control_point_editor_tool_a1229f6b442514c4ebcb64737a6e29bf0}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!rightButtonDown@{rightButtonDown}}
\index{rightButtonDown@{rightButtonDown}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{rightButtonDown()}{rightButtonDown()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::right\+Button\+Down (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00609                                                                   \{}
\DoxyCodeLine{00610   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = \mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00611   \textcolor{keywordflow}{if} (!vi) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00612   \textcolor{keywordtype}{double} maxDist  = 5 * getPixelSize();}
\DoxyCodeLine{00613   \textcolor{keywordtype}{double} maxDist2 = maxDist * maxDist;}
\DoxyCodeLine{00614   \textcolor{keywordtype}{double} dist2    = 0;}
\DoxyCodeLine{00615   \textcolor{keywordtype}{int} pointIndex;}
\DoxyCodeLine{00616   ControlPointEditorStroke::PointType pointType =}
\DoxyCodeLine{00617       m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a97247ab7eb478a10e3b59a366fc6fa31}{getPointTypeAt}}(pos, maxDist2, pointIndex);}
\DoxyCodeLine{00618   \textcolor{keywordflow}{if} (pointType != ControlPointEditorStroke::CONTROL\_POINT) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00619   m\_selection.select(pointIndex);}
\DoxyCodeLine{00620 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a2c7e06a5b586156270b5d3b7cea7ca43}\label{class_control_point_editor_tool_a2c7e06a5b586156270b5d3b7cea7ca43}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!select@{select}}
\index{select@{select}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{select()}{select()}}
{\footnotesize\ttfamily bool Control\+Point\+Editor\+Tool\+::select (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_selection}{TSelection}} $\ast$}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00093 \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_acb3208e11f4f953d58a6599181110b65}\label{class_control_point_editor_tool_acb3208e11f4f953d58a6599181110b65}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!unlinkSpeedInOut@{unlinkSpeedInOut}}
\index{unlinkSpeedInOut@{unlinkSpeedInOut}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{unlinkSpeedInOut()}{unlinkSpeedInOut()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::unlink\+Speed\+In\+Out (\begin{DoxyParamCaption}\item[{int}]{point\+Index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00835                                                             \{}
\DoxyCodeLine{00836   m\_controlPointEditorStroke.\mbox{\hyperlink{class_control_point_editor_stroke_a4ecb68e14d8f5c279d998352775ad0f6}{setCusp}}(pointIndex, \textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{00837 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_control_point_editor_tool_a77c68b063a0e0dfce4c2696e6009419f}\label{class_control_point_editor_tool_a77c68b063a0e0dfce4c2696e6009419f}} 
\index{ControlPointEditorTool@{ControlPointEditorTool}!updateTranslation@{updateTranslation}}
\index{updateTranslation@{updateTranslation}!ControlPointEditorTool@{ControlPointEditorTool}}
\doxysubsubsection{\texorpdfstring{updateTranslation()}{updateTranslation()}}
{\footnotesize\ttfamily void Control\+Point\+Editor\+Tool\+::update\+Translation (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00217                                                \{}
\DoxyCodeLine{00218   m\_autoSelectDrawing.setQStringName(tr(\textcolor{stringliteral}{"{}Auto Select Drawing"{}}));}
\DoxyCodeLine{00219   m\_snap.setQStringName(tr(\textcolor{stringliteral}{"{}Snap"{}}));}
\DoxyCodeLine{00220   m\_selectType.setQStringName(tr(\textcolor{stringliteral}{"{}Type:"{}}));}
\DoxyCodeLine{00221   m\_selectType.setItemUIName(RECTANGULAR\_WSTR, tr(\textcolor{stringliteral}{"{}Rectangular"{}}));}
\DoxyCodeLine{00222   m\_selectType.setItemUIName(FREEHAND\_WSTR, tr(\textcolor{stringliteral}{"{}Freehand"{}}));}
\DoxyCodeLine{00223 }
\DoxyCodeLine{00224   m\_snapSensitivity.setQStringName(tr(\textcolor{stringliteral}{"{}"{}}));}
\DoxyCodeLine{00225   m\_snapSensitivity.setItemUIName(LOW\_WSTR, tr(\textcolor{stringliteral}{"{}Low"{}}));}
\DoxyCodeLine{00226   m\_snapSensitivity.setItemUIName(MEDIUM\_WSTR, tr(\textcolor{stringliteral}{"{}Med"{}}));}
\DoxyCodeLine{00227   m\_snapSensitivity.setItemUIName(HIGH\_WSTR, tr(\textcolor{stringliteral}{"{}High"{}}));}
\DoxyCodeLine{00228 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/tnztools/controlpointeditortool.\+h\item 
E\+:/opentoonz/toonz/sources/tnztools/controlpointeditortool.\+cpp\end{DoxyCompactItemize}
