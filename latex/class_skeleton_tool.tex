\hypertarget{class_skeleton_tool}{}\doxysection{Skeleton\+Tool Class Reference}
\label{class_skeleton_tool}\index{SkeletonTool@{SkeletonTool}}
Inheritance diagram for Skeleton\+Tool\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_skeleton_tool}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296c}{Tool\+Type}} \mbox{\hyperlink{class_skeleton_tool_a3f2ef20d53e41345341a21cfbac74b00}{get\+Tool\+Type}} () const override
\item 
void \mbox{\hyperlink{class_skeleton_tool_ae5f1c4739c3ce4ac417f85c45ae7f018}{update\+Translation}} () override
\item 
bool \mbox{\hyperlink{class_skeleton_tool_ab9d847195f9cc61a7f633781b7883d80}{does\+Apply}} () const
\item 
void \mbox{\hyperlink{class_skeleton_tool_ae7be52da2d9982a0319e01abf3453877}{on\+Enter}} () override
\begin{DoxyCompactList}\small\item\em Callback for the mouse entering the viewer area. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_skeleton_tool_af51fff8dcf410eec0d931b00284e3d28}{left\+Button\+Down}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&) override
\item 
void \mbox{\hyperlink{class_skeleton_tool_a7ffe694847b477f52312ba737df77157}{left\+Button\+Drag}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&) override
\item 
void \mbox{\hyperlink{class_skeleton_tool_a5187c1857e716e6325383f0ebc682de6}{left\+Button\+Up}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&) override
\item 
void \mbox{\hyperlink{class_skeleton_tool_ad4f6a7ed4da68ae7c89bf8157124e94d}{mouse\+Move}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_skeleton_tool_afc4e4130bd22451d107deb7461d236e4}{on\+Image\+Changed}} () override
\begin{DoxyCompactList}\small\item\em Notifies changes in the image in use. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_skeleton_tool_a2dc86035e69cdf703d844d0e1aa139ac}{reset}} () override
\item 
bool \mbox{\hyperlink{class_skeleton_tool_a60413502350c6db6f81ec5359aa039d0}{on\+Property\+Changed}} (std\+::string property\+Name) override
\item 
void \mbox{\hyperlink{class_skeleton_tool_ae4202699f76a9ea8164799fbf8596655}{draw}} () override
\begin{DoxyCompactList}\small\item\em Draws the tool on the viewer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_skeleton_tool_a4530367fec46f2cff9f8775c5e7c8829}{draw\+Skeleton}} (const \mbox{\hyperlink{class_skeleton}{Skeleton}} \&skeleton, int row)
\item 
void \mbox{\hyperlink{class_skeleton_tool_aad06ecaad6e3287fb942807518bbbf41}{draw\+Level\+Bounding\+Box}} (int frame, int column\+Index)
\item 
void \mbox{\hyperlink{class_skeleton_tool_a45ce69f6ab62cecfd6f45c1fb92c360d}{get\+Image\+Bounding\+Box}} (\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&bbox, \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff, int frame, int column\+Index)
\item 
void \mbox{\hyperlink{class_skeleton_tool_a31ec844a4b41d90101fe4d5c352497ea}{draw\+IKJoint}} (const \mbox{\hyperlink{class_skeleton_1_1_bone}{Skeleton\+::\+Bone}} $\ast$bone)
\item 
void \mbox{\hyperlink{class_skeleton_tool_aaa750eeb0eefdaa13d377f5c3f6f44f5}{draw\+Joint}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p, bool current)
\item 
void \mbox{\hyperlink{class_skeleton_tool_a73ea52600e1c342cf79be9c6b4883a64}{draw\+Bone}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&a, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&b, bool selected)
\item 
void \mbox{\hyperlink{class_skeleton_tool_aef68f443b338c0a66ee7bde36394028d}{draw\+IKBone}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&a, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&b)
\item 
void \mbox{\hyperlink{class_skeleton_tool_abd1bb6d73883e97162ab6622c6d6e4b4}{draw\+Main\+Gadget}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&center)
\item 
void \mbox{\hyperlink{class_skeleton_tool_a4d33ccbaa8fa277036bd10e4d781d1c8}{draw\+Drawing\+Browser}} (const \mbox{\hyperlink{class_t_xsh_cell}{TXsh\+Cell}} \&cell, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&center)
\item 
void \mbox{\hyperlink{class_skeleton_tool_a2d5842f00dc795800c0ea28674b4ea5e}{set\+Parent\+Probe}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&parent\+Probe)
\item 
void \mbox{\hyperlink{class_skeleton_tool_ac25d2969f29f9ca304a86922dc3a8b90}{reset\+Parent\+Probe}} ()
\item 
void \mbox{\hyperlink{class_skeleton_tool_aea2b23a79e15eaf7225a1672bc1299ac}{draw\+Hooks}} ()
\item 
void \mbox{\hyperlink{class_skeleton_tool_ae41f305ccdb1d30ee041e9e83266dd70}{compute\+Magic\+Links}} ()
\item 
bool \mbox{\hyperlink{class_skeleton_tool_ae0b5eebb96a0ffdb40b85285f0f0dfde}{key\+Down}} (QKey\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_skeleton_tool_afdfb35d4fde1381212144ee85a60d45b}{on\+Activate}} () override
\begin{DoxyCompactList}\small\item\em Callback invoked whenever the tool activates. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_skeleton_tool_ab4e6e3c2284c76e90a849bc41f3fc869}{on\+Deactivate}} () override
\begin{DoxyCompactList}\small\item\em Callback for tool deactivation, includes tool switch. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_skeleton_tool_a027633da979b4e2df0037f2cab4c277b}{get\+Magic\+Link\+Count}} () const
\item 
\mbox{\hyperlink{class_skeleton_subtools_1_1_magic_link}{Skeleton\+Subtools\+::\+Magic\+Link}} \mbox{\hyperlink{class_skeleton_tool_aa7045a45a9c8a9c5366f5619468dda88}{get\+Magic\+Link}} (int index) const
\item 
void \mbox{\hyperlink{class_skeleton_tool_a97f375f52d91d03e75d7d00fe8337ccf}{magic\+Link}} (int index)
\item 
int \mbox{\hyperlink{class_skeleton_tool_ab9934ce9e2dfcf8632262c8db7e4ab87}{get\+Cursor\+Id}} () const override
\begin{DoxyCompactList}\small\item\em Returns the type of cursor used by the tool. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_t_property_group}{TProperty\+Group}} $\ast$ \mbox{\hyperlink{class_skeleton_tool_ae748a32b50b42ebf09e4731cee197813}{get\+Properties}} (int target\+Type) override
\item 
void \mbox{\hyperlink{class_skeleton_tool_ae13ff691474b99b7720df4fee38d893c}{update\+Matrix}} () override
\item 
void \mbox{\hyperlink{class_skeleton_tool_a385e7326886eccc593e35e1a6d264dfd}{add\+Context\+Menu\+Items}} (QMenu $\ast$menu) override
\item 
bool \mbox{\hyperlink{class_skeleton_tool_aab51b11cc27702102ebcf98f2404fccc}{select}} (const \mbox{\hyperlink{class_t_selection}{TSelection}} $\ast$)
\item 
void \mbox{\hyperlink{class_skeleton_tool_ad1a6af3985887a117fc613ee419f2eb0}{toggle\+Pinned\+Status}} (int column\+Index, int frame, bool shift\+Pressed)
\item 
void \mbox{\hyperlink{class_skeleton_tool_a79099098bad386ff8c14519f21954cfe}{build\+Skeleton}} (\mbox{\hyperlink{class_skeleton}{Skeleton}} \&skeleton, int column\+Index)
\item 
void \mbox{\hyperlink{class_skeleton_tool_a6753b1be6f5d223037097dab1dd74040}{set\+Temporary\+Pinned\+Columns}} (const std\+::set$<$ int $>$ \&tmp)
\item 
bool \mbox{\hyperlink{class_skeleton_tool_a9fc89373829d12beee9deb30a857fc20}{is\+Global\+Keyframes\+Enabled}} () const
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_skeleton_tool_a75ad59208158cbd3d1b701dc770fd3e9}\label{class_skeleton_tool_a75ad59208158cbd3d1b701dc770fd3e9}} 
\index{SkeletonTool@{SkeletonTool}!SkeletonTool@{SkeletonTool}}
\index{SkeletonTool@{SkeletonTool}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{SkeletonTool()}{SkeletonTool()}}
{\footnotesize\ttfamily Skeleton\+Tool\+::\+Skeleton\+Tool (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00236     : \mbox{\hyperlink{class_t_tool_a9c63ec35f606e755d0d036bf4fed62ab}{TTool}}(\textcolor{stringliteral}{"{}T\_Skeleton"{}})}
\DoxyCodeLine{00237     , m\_active(\textcolor{keyword}{false})}
\DoxyCodeLine{00238     , m\_device(TD\_None)}
\DoxyCodeLine{00239     , m\_mode(\textcolor{stringliteral}{"{}Mode:"{}})}
\DoxyCodeLine{00240     , m\_showOnlyActiveSkeleton(\textcolor{stringliteral}{"{}Show Only Active Skeleton"{}}, \textcolor{keyword}{false})}
\DoxyCodeLine{00241     , m\_globalKeyframes(\textcolor{stringliteral}{"{}Global Key"{}}, \textcolor{keyword}{false})}
\DoxyCodeLine{00242     , m\_dragTool(0)}
\DoxyCodeLine{00243     , m\_firstTime(\textcolor{keyword}{true})}
\DoxyCodeLine{00244     , m\_currentFrame(-\/1)}
\DoxyCodeLine{00245     , m\_parentProbe()}
\DoxyCodeLine{00246     , m\_parentProbeEnabled(\textcolor{keyword}{false})}
\DoxyCodeLine{00247     , m\_otherColumn(-\/1)}
\DoxyCodeLine{00248     , m\_otherColumnBBoxAff()}
\DoxyCodeLine{00249     , m\_otherColumnBBox()}
\DoxyCodeLine{00250     , m\_labelPos(0, 0)}
\DoxyCodeLine{00251     , m\_label(\textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{00252   bind(TTool::CommonLevels);}
\DoxyCodeLine{00253   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_mode);}
\DoxyCodeLine{00254   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_globalKeyframes);}
\DoxyCodeLine{00255   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_showOnlyActiveSkeleton);}
\DoxyCodeLine{00256   m\_mode.setId(\textcolor{stringliteral}{"{}SkeletonMode"{}});}
\DoxyCodeLine{00257   m\_globalKeyframes.setId(\textcolor{stringliteral}{"{}GlobalKey"{}});}
\DoxyCodeLine{00258   m\_showOnlyActiveSkeleton.setId(\textcolor{stringliteral}{"{}ShowOnlyActiveSkeleton"{}});}
\DoxyCodeLine{00259 }
\DoxyCodeLine{00260   m\_mode.addValue(BUILD\_SKELETON);}
\DoxyCodeLine{00261   m\_mode.addValue(ANIMATE);}
\DoxyCodeLine{00262   m\_mode.addValue(INVERSE\_KINEMATICS);}
\DoxyCodeLine{00263 }
\DoxyCodeLine{00264   m\_commandHandler = \textcolor{keyword}{new} \mbox{\hyperlink{class_skeleton_subtools_1_1_command_handler}{CommandHandler}}();}
\DoxyCodeLine{00265   m\_commandHandler-\/>setTempPinnedSet(\&m\_temporaryPinnedColumns);}
\DoxyCodeLine{00266 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a9bada78ddc2b27d00447d7198b57e77d}\label{class_skeleton_tool_a9bada78ddc2b27d00447d7198b57e77d}} 
\index{SkeletonTool@{SkeletonTool}!````~SkeletonTool@{$\sim$SkeletonTool}}
\index{````~SkeletonTool@{$\sim$SkeletonTool}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{$\sim$SkeletonTool()}{~SkeletonTool()}}
{\footnotesize\ttfamily Skeleton\+Tool\+::$\sim$\+Skeleton\+Tool (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00270 \{ \textcolor{keyword}{delete} m\_dragTool; \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_skeleton_tool_a385e7326886eccc593e35e1a6d264dfd}\label{class_skeleton_tool_a385e7326886eccc593e35e1a6d264dfd}} 
\index{SkeletonTool@{SkeletonTool}!addContextMenuItems@{addContextMenuItems}}
\index{addContextMenuItems@{addContextMenuItems}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{addContextMenuItems()}{addContextMenuItems()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::add\+Context\+Menu\+Items (\begin{DoxyParamCaption}\item[{QMenu $\ast$}]{menu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Add a context menu to the actual tool, as for example pressing right mouse button with the stroke selection tool. 

Reimplemented from \mbox{\hyperlink{class_t_tool_ac8a81b368568245d16f7c3d4a17684a1}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01598                                                   \{}
\DoxyCodeLine{01599   \textcolor{keywordtype}{bool} ikEnabled = m\_mode.getValue() == INVERSE\_KINEMATICS;}
\DoxyCodeLine{01600 }
\DoxyCodeLine{01601   \textcolor{keywordflow}{if} (ikEnabled) \{}
\DoxyCodeLine{01602     \mbox{\hyperlink{class_skeleton}{Skeleton}} *skeleton = \textcolor{keyword}{new} \mbox{\hyperlink{class_skeleton}{Skeleton}}();}
\DoxyCodeLine{01603     buildSkeleton(}
\DoxyCodeLine{01604         *skeleton,}
\DoxyCodeLine{01605         TTool::getApplication()-\/>getCurrentColumn()-\/>\mbox{\hyperlink{class_t_tool_a7214525a3ae0cdcb0a0393e4dc4d3bf5}{getColumnIndex}}());}
\DoxyCodeLine{01606     \textcolor{keywordflow}{if} (skeleton-\/>hasPinnedRanges() || skeleton-\/>isIKEnabled()) \{}
\DoxyCodeLine{01607       m\_commandHandler-\/>setSkeleton(skeleton);}
\DoxyCodeLine{01608       QAction *rp = menu-\/>addAction(tr(\textcolor{stringliteral}{"{}Reset Pinned Center"{}}));}
\DoxyCodeLine{01609       menu-\/>addSeparator();}
\DoxyCodeLine{01610       \textcolor{keywordtype}{bool} ret = QObject::connect(rp, SIGNAL(triggered()), m\_commandHandler,}
\DoxyCodeLine{01611                                   SLOT(clearPinnedRanges()));}
\DoxyCodeLine{01612       assert(ret);}
\DoxyCodeLine{01613     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01614       \textcolor{keyword}{delete} skeleton;}
\DoxyCodeLine{01615   \}}
\DoxyCodeLine{01616 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00583}{TTool\+::get\+Column\+Index()}}.

\mbox{\Hypertarget{class_skeleton_tool_a79099098bad386ff8c14519f21954cfe}\label{class_skeleton_tool_a79099098bad386ff8c14519f21954cfe}} 
\index{SkeletonTool@{SkeletonTool}!buildSkeleton@{buildSkeleton}}
\index{buildSkeleton@{buildSkeleton}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{buildSkeleton()}{buildSkeleton()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::build\+Skeleton (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_skeleton}{Skeleton}} \&}]{skeleton,  }\item[{int}]{column\+Index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01620                                                                     \{}
\DoxyCodeLine{01621   \textcolor{keywordtype}{int} frame = TTool::getApplication()-\/>getCurrentFrame()-\/>getFrame();}
\DoxyCodeLine{01622   skeleton.build(\mbox{\hyperlink{class_t_tool_a8716e1462da359f4902c044a79f2d40d}{getXsheet}}(), frame, columnIndex, m\_temporaryPinnedColumns);}
\DoxyCodeLine{01623 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ae41f305ccdb1d30ee041e9e83266dd70}\label{class_skeleton_tool_ae41f305ccdb1d30ee041e9e83266dd70}} 
\index{SkeletonTool@{SkeletonTool}!computeMagicLinks@{computeMagicLinks}}
\index{computeMagicLinks@{computeMagicLinks}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{computeMagicLinks()}{computeMagicLinks()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::compute\+Magic\+Links (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00999                                      \{}
\DoxyCodeLine{01000   \textcolor{comment}{// TODO: move the calculation of the magic links here}}
\DoxyCodeLine{01001 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ab9d847195f9cc61a7f633781b7883d80}\label{class_skeleton_tool_ab9d847195f9cc61a7f633781b7883d80}} 
\index{SkeletonTool@{SkeletonTool}!doesApply@{doesApply}}
\index{doesApply@{doesApply}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{doesApply()}{doesApply()}}
{\footnotesize\ttfamily bool Skeleton\+Tool\+::does\+Apply (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00301                                    \{}
\DoxyCodeLine{00302   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{00303   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh            = app-\/>getCurrentXsheet()-\/>getXsheet();}
\DoxyCodeLine{00304   assert(xsh);}
\DoxyCodeLine{00305   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} objId = app-\/>getCurrentObject()-\/>getObjectId();}
\DoxyCodeLine{00306   \textcolor{keywordflow}{if} (objId.\mbox{\hyperlink{class_t_stage_object_id_af6d13fcf31e7e10eef28f085855f469c}{isColumn}}()) \{}
\DoxyCodeLine{00307     \mbox{\hyperlink{class_t_xsh_column}{TXshColumn}} *column = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(objId.getIndex());}
\DoxyCodeLine{00308     \textcolor{keywordflow}{if} (column \&\& column-\/>getSoundColumn()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00309   \}}
\DoxyCodeLine{00310   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00311 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ae4202699f76a9ea8164799fbf8596655}\label{class_skeleton_tool_ae4202699f76a9ea8164799fbf8596655}} 
\index{SkeletonTool@{SkeletonTool}!draw@{draw}}
\index{draw@{draw}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{draw()}{draw()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::draw (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Draws the tool on the viewer. 



Reimplemented from \mbox{\hyperlink{class_t_tool_a058bf656d73bf3cd63b9826cbaaf48e0}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01428                         \{}
\DoxyCodeLine{01429   \textcolor{comment}{// parent object reference system}}
\DoxyCodeLine{01430   \textcolor{comment}{// glColor3d(1,0,0);}}
\DoxyCodeLine{01431   \textcolor{comment}{// tglDrawRect(0,0,100,100);}}
\DoxyCodeLine{01432 }
\DoxyCodeLine{01433   \textcolor{keywordflow}{if} (m\_label != \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{01434     ToolUtils::drawBalloon(m\_labelPos, m\_label, TPixel32::Red, \mbox{\hyperlink{class_t_point_t}{TPoint}}(20, -\/20),}
\DoxyCodeLine{01435                            getPixelSize(), \textcolor{keyword}{false});}
\DoxyCodeLine{01436 }
\DoxyCodeLine{01437   \textcolor{keywordtype}{bool} ikEnabled = m\_mode.getValue() == INVERSE\_KINEMATICS;}
\DoxyCodeLine{01438   assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{01439 }
\DoxyCodeLine{01440   \textcolor{comment}{// l'xsheet, oggetto (e relativo placement), frame corrente}}
\DoxyCodeLine{01441   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{01442   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh            = \mbox{\hyperlink{class_t_tool_a8716e1462da359f4902c044a79f2d40d}{getXsheet}}();}
\DoxyCodeLine{01443   assert(xsh);}
\DoxyCodeLine{01444   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} objId = app-\/>getCurrentObject()-\/>getObjectId();}
\DoxyCodeLine{01445   \textcolor{comment}{// se l'oggetto corrente non e' una colonna non disegno nulla}}
\DoxyCodeLine{01446   \textcolor{keywordflow}{if} (!objId.\mbox{\hyperlink{class_t_stage_object_id_af6d13fcf31e7e10eef28f085855f469c}{isColumn}}()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01447 }
\DoxyCodeLine{01448   \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *pegbar = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(objId);}
\DoxyCodeLine{01449   \textcolor{keywordtype}{int} col              = objId.getIndex();}
\DoxyCodeLine{01450 }
\DoxyCodeLine{01451   \textcolor{keywordtype}{int} frame = app-\/>getCurrentFrame()-\/>getFrame();}
\DoxyCodeLine{01452   \textcolor{keywordflow}{if} (m\_currentFrame != frame) m\_temporaryPinnedColumns.clear();}
\DoxyCodeLine{01453 }
\DoxyCodeLine{01454   \mbox{\hyperlink{class_t_affine}{TAffine}} aff = getMatrix();}
\DoxyCodeLine{01455   \textcolor{comment}{// puo' suggere che il placement degeneri (es.: c'e' uno h-\/scale = 0\%)}}
\DoxyCodeLine{01456   \textcolor{keywordflow}{if} (fabs(aff.det()) < 0.00001) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01457 }
\DoxyCodeLine{01458   \textcolor{comment}{// m\_unit = getPixelSize() * sqrt(fabs(aff.det()));}}
\DoxyCodeLine{01459 }
\DoxyCodeLine{01460   \textcolor{keywordflow}{if} (!ikEnabled) drawLevelBoundingBox(frame, col);}
\DoxyCodeLine{01461 }
\DoxyCodeLine{01462   glPushMatrix();}
\DoxyCodeLine{01463   tglMultMatrix(aff.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}());}
\DoxyCodeLine{01464 }
\DoxyCodeLine{01465   \textcolor{comment}{// camera stand reference system}}
\DoxyCodeLine{01466   \textcolor{comment}{// glColor3d(0,1,0);}}
\DoxyCodeLine{01467   \textcolor{comment}{// tglDrawRect(0,0,100,100);}}
\DoxyCodeLine{01468 }
\DoxyCodeLine{01469   \textcolor{keywordtype}{bool} changingParent = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_skeleton_subtools_1_1_parent_change_tool}{ParentChangeTool}} *\textcolor{keyword}{>}(m\_dragTool) != 0;}
\DoxyCodeLine{01470 }
\DoxyCodeLine{01471   \textcolor{comment}{// !changingParent \&\&}}
\DoxyCodeLine{01472   \textcolor{keywordflow}{if} (m\_mode.getValue() == BUILD\_SKELETON \&\&}
\DoxyCodeLine{01473       !xsh-\/>\mbox{\hyperlink{class_t_xsheet_a0a27744ce52cae25ec261a853a554cd1}{getStageObjectParent}}(objId).\mbox{\hyperlink{class_t_stage_object_id_af6d13fcf31e7e10eef28f085855f469c}{isColumn}}()) \{}
\DoxyCodeLine{01474     \textcolor{keywordflow}{if} (!changingParent) drawHooks();}
\DoxyCodeLine{01475   \}}
\DoxyCodeLine{01476 }
\DoxyCodeLine{01477   \mbox{\hyperlink{class_skeleton}{Skeleton}} skeleton;}
\DoxyCodeLine{01478   buildSkeleton(skeleton, col);}
\DoxyCodeLine{01479 }
\DoxyCodeLine{01480   glEnable(GL\_BLEND);}
\DoxyCodeLine{01481   glBlendFunc(GL\_SRC\_ALPHA, GL\_ONE\_MINUS\_SRC\_ALPHA);}
\DoxyCodeLine{01482   drawSkeleton(skeleton, frame);}
\DoxyCodeLine{01483   glDisable(GL\_BLEND);}
\DoxyCodeLine{01484 }
\DoxyCodeLine{01485   \mbox{\hyperlink{class_t_xsh_cell}{TXshCell}} cell            = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(frame, objId.getIndex());}
\DoxyCodeLine{01486   \mbox{\hyperlink{class_skeleton_1_1_bone}{Skeleton::Bone}} *rootBone = skeleton.getRootBone();}
\DoxyCodeLine{01487   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < skeleton.getBoneCount(); i++) \{}
\DoxyCodeLine{01488     \mbox{\hyperlink{class_skeleton_1_1_bone}{Skeleton::Bone}} *bone     = skeleton.getBone(i);}
\DoxyCodeLine{01489     \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} currentId = bone-\/>getStageObject()-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}();}
\DoxyCodeLine{01490     \textcolor{keywordtype}{bool} isCurrent           = (currentId == objId);}
\DoxyCodeLine{01491     \mbox{\hyperlink{class_t_point_t}{TPointD}} pos              = bone-\/>getCenter();}
\DoxyCodeLine{01492     \textcolor{keywordflow}{if} (isCurrent \&\& m\_mode.getValue() != BUILD\_SKELETON) \{}
\DoxyCodeLine{01493       drawDrawingBrowser(cell, pos);}
\DoxyCodeLine{01494     \}}
\DoxyCodeLine{01495 }
\DoxyCodeLine{01496     \textcolor{keywordtype}{bool} isActiveChain = bone-\/>isSelected();}
\DoxyCodeLine{01497 }
\DoxyCodeLine{01498     glColor3d(0, 1, 0);}
\DoxyCodeLine{01499     \textcolor{keywordflow}{if} (ikEnabled) \{}
\DoxyCodeLine{01500       drawIKJoint(bone);}
\DoxyCodeLine{01501     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01502       \mbox{\hyperlink{class_t_point_t}{TPointD}} pos = bone-\/>getCenter();}
\DoxyCodeLine{01503       \textcolor{keywordflow}{if} (isCurrent \&\& m\_mode.getValue() == ANIMATE) \{}
\DoxyCodeLine{01504         drawMainGadget(pos);}
\DoxyCodeLine{01505       \}}
\DoxyCodeLine{01506     \}}
\DoxyCodeLine{01507   \}}
\DoxyCodeLine{01508   m\_currentFrame = frame;}
\DoxyCodeLine{01509 }
\DoxyCodeLine{01510   \textcolor{keywordflow}{if} (m\_dragTool) m\_dragTool-\/>draw();}
\DoxyCodeLine{01511   glPopMatrix();}
\DoxyCodeLine{01512 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00233}{TXsheet\+::get\+Cell()}}, \mbox{\hyperlink{l00520}{TStage\+Object\+::get\+Id()}}, \mbox{\hyperlink{l00542}{TXsheet\+::get\+Stage\+Object()}}, \mbox{\hyperlink{l00598}{TXsheet\+::get\+Stage\+Object\+Parent()}}, \mbox{\hyperlink{l00569}{TTool\+::get\+Xsheet()}}, \mbox{\hyperlink{l00055}{TAffine\+::inv()}}, and \mbox{\hyperlink{l00180}{TStage\+Object\+Id\+::is\+Column()}}.

\mbox{\Hypertarget{class_skeleton_tool_a73ea52600e1c342cf79be9c6b4883a64}\label{class_skeleton_tool_a73ea52600e1c342cf79be9c6b4883a64}} 
\index{SkeletonTool@{SkeletonTool}!drawBone@{drawBone}}
\index{drawBone@{drawBone}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{drawBone()}{drawBone()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::draw\+Bone (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{a,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{b,  }\item[{bool}]{selected }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00951                                                                              \{}
\DoxyCodeLine{00952   \textcolor{keyword}{const} \textcolor{keywordtype}{double} alpha = 0.8;}
\DoxyCodeLine{00953   \textcolor{comment}{// se sono troppo vicini niente da fare}}
\DoxyCodeLine{00954   \mbox{\hyperlink{class_t_point_t}{TPointD}} delta = b -\/ a;}
\DoxyCodeLine{00955   \textcolor{keywordflow}{if} (norm2(delta) < 0.001) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00956   \mbox{\hyperlink{class_t_point_t}{TPointD}} u = getPixelSize() * 2.5 * normalize(rotate90(delta));}
\DoxyCodeLine{00957   \textcolor{keywordflow}{if} (selected)}
\DoxyCodeLine{00958     glColor4d(0.9 * alpha, 0.9 * alpha, 0.9 * alpha, alpha);}
\DoxyCodeLine{00959   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00960     glColor4d(0.58 * alpha, 0.58 * alpha, 0.58 * alpha, alpha);}
\DoxyCodeLine{00961   glBegin(GL\_POLYGON);}
\DoxyCodeLine{00962   tglVertex(a + u);}
\DoxyCodeLine{00963   tglVertex(b);}
\DoxyCodeLine{00964   tglVertex(a -\/ u);}
\DoxyCodeLine{00965   glEnd();}
\DoxyCodeLine{00966   glColor3d(0.2, 0.3, 0.35);}
\DoxyCodeLine{00967   glBegin(GL\_LINE\_STRIP);}
\DoxyCodeLine{00968   tglVertex(a + u);}
\DoxyCodeLine{00969   tglVertex(b);}
\DoxyCodeLine{00970   tglVertex(a -\/ u);}
\DoxyCodeLine{00971   glEnd();}
\DoxyCodeLine{00972 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a4d33ccbaa8fa277036bd10e4d781d1c8}\label{class_skeleton_tool_a4d33ccbaa8fa277036bd10e4d781d1c8}} 
\index{SkeletonTool@{SkeletonTool}!drawDrawingBrowser@{drawDrawingBrowser}}
\index{drawDrawingBrowser@{drawDrawingBrowser}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{drawDrawingBrowser()}{drawDrawingBrowser()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::draw\+Drawing\+Browser (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_xsh_cell}{TXsh\+Cell}} \&}]{cell,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{center }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01255                                                              \{}
\DoxyCodeLine{01256   \textcolor{keywordflow}{if} (!cell.m\_level || cell.m\_level-\/>getFrameCount() <= 1) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01257   \textcolor{keywordtype}{double} pixelSize = getPixelSize();}
\DoxyCodeLine{01258 }
\DoxyCodeLine{01259   std::string name = ::to\_string(cell.m\_level-\/>\mbox{\hyperlink{class_t_xsh_level_a3a59fb1bd3261baee4e889a9edbf0ae8}{getName}}()) + \textcolor{stringliteral}{"{}."{}} +}
\DoxyCodeLine{01260                      std::to\_string(cell.m\_frameId.getNumber());}
\DoxyCodeLine{01261 }
\DoxyCodeLine{01262   QString qText = QString::fromStdString(name);}
\DoxyCodeLine{01263   QFont font(\textcolor{stringliteral}{"{}Arial"{}}, 10);  \textcolor{comment}{// ,QFont::Bold);}}
\DoxyCodeLine{01264   QFontMetrics fm(font);}
\DoxyCodeLine{01265   QSize textSize   = fm.boundingRect(qText).size();}
\DoxyCodeLine{01266   \textcolor{keywordtype}{int} arrowHeight  = 10;}
\DoxyCodeLine{01267   \textcolor{keywordtype}{int} minTextWidth = 2 * arrowHeight + 5;}
\DoxyCodeLine{01268   \textcolor{keywordflow}{if} (textSize.width() < minTextWidth) textSize.setWidth(minTextWidth);}
\DoxyCodeLine{01269   QSize totalSize(textSize.width(), textSize.height() + 2 * arrowHeight);}
\DoxyCodeLine{01270   \mbox{\hyperlink{class_t_point_t}{TPointD}} p = center + \mbox{\hyperlink{class_t_point_t}{TPointD}}(30, -\/arrowHeight) * pixelSize;}
\DoxyCodeLine{01271   QRect textRect(0, arrowHeight, textSize.width(), textSize.height());}
\DoxyCodeLine{01272 }
\DoxyCodeLine{01273   assert(glGetError() == 0);}
\DoxyCodeLine{01274 }
\DoxyCodeLine{01275   \textcolor{keywordflow}{if} (isPicking()) \{}
\DoxyCodeLine{01276     \textcolor{keywordtype}{double} x0 = p.x, x1 = p.x + totalSize.width() * pixelSize;}
\DoxyCodeLine{01277     \textcolor{keywordtype}{double} y0 = p.y, y3 = p.y + totalSize.height() * pixelSize;}
\DoxyCodeLine{01278     \textcolor{keywordtype}{double} y1 = y0 + arrowHeight * pixelSize;}
\DoxyCodeLine{01279     \textcolor{keywordtype}{double} y2 = y3 -\/ arrowHeight * pixelSize;}
\DoxyCodeLine{01280     \textcolor{keywordtype}{double} x  = (x0 + x1) * 0.5;}
\DoxyCodeLine{01281     \textcolor{keywordtype}{double} d  = arrowHeight * pixelSize;}
\DoxyCodeLine{01282 }
\DoxyCodeLine{01283     glColor3d(0, 1, 0);}
\DoxyCodeLine{01284     glPushName(TD\_ChangeDrawing);}
\DoxyCodeLine{01285     glRectd(x0, y1, x1, y2);}
\DoxyCodeLine{01286     glPopName();}
\DoxyCodeLine{01287     glPushName(TD\_IncrementDrawing);}
\DoxyCodeLine{01288     glBegin(GL\_POLYGON);}
\DoxyCodeLine{01289     glVertex2d(x, y0);}
\DoxyCodeLine{01290     glVertex2d(x + d, y0 + d);}
\DoxyCodeLine{01291     glVertex2d(x -\/ d, y0 + d);}
\DoxyCodeLine{01292     glEnd();}
\DoxyCodeLine{01293     glPopName();}
\DoxyCodeLine{01294     glPushName(TD\_DecrementDrawing);}
\DoxyCodeLine{01295     glBegin(GL\_POLYGON);}
\DoxyCodeLine{01296     glVertex2d(x, y3);}
\DoxyCodeLine{01297     glVertex2d(x + d, y3 -\/ d);}
\DoxyCodeLine{01298     glVertex2d(x -\/ d, y3 -\/ d);}
\DoxyCodeLine{01299     glEnd();}
\DoxyCodeLine{01300     glPopName();}
\DoxyCodeLine{01301     \textcolor{keywordflow}{return};}
\DoxyCodeLine{01302   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01303     assert(glGetError() == 0);}
\DoxyCodeLine{01304     \textcolor{keywordtype}{bool} active = m\_device == TD\_ChangeDrawing ||}
\DoxyCodeLine{01305                   m\_device == TD\_IncrementDrawing ||}
\DoxyCodeLine{01306                   m\_device == TD\_DecrementDrawing;}
\DoxyCodeLine{01307     QImage img(totalSize.width(), totalSize.height(), QImage::Format\_ARGB32);}
\DoxyCodeLine{01308     img.fill(Qt::transparent);}
\DoxyCodeLine{01309     QPainter imgPainter(\&img);}
\DoxyCodeLine{01310     imgPainter.setRenderHints(QPainter::Antialiasing |}
\DoxyCodeLine{01311                               QPainter::TextAntialiasing);}
\DoxyCodeLine{01312 }
\DoxyCodeLine{01313     \textcolor{comment}{// imgPainter.setPen(Qt::black);}}
\DoxyCodeLine{01314     \textcolor{comment}{// imgPainter.drawRect(0,0,totalSize.width(),totalSize.height());}}
\DoxyCodeLine{01315 }
\DoxyCodeLine{01316     imgPainter.setPen(Qt::NoPen);}
\DoxyCodeLine{01317     imgPainter.setBrush(QColor(200, 200, 200, 200));}
\DoxyCodeLine{01318     imgPainter.drawRect(textRect);}
\DoxyCodeLine{01319     imgPainter.setPen(active ? Qt::red : Qt::black);}
\DoxyCodeLine{01320     imgPainter.setBrush(Qt::NoBrush);}
\DoxyCodeLine{01321     imgPainter.setFont(font);}
\DoxyCodeLine{01322     imgPainter.drawText(textRect, Qt::AlignCenter, qText);}
\DoxyCodeLine{01323 }
\DoxyCodeLine{01324     \textcolor{keywordflow}{if} (active) \{}
\DoxyCodeLine{01325       \textcolor{keywordtype}{int} x = textRect.center().x();}
\DoxyCodeLine{01326       \textcolor{keywordtype}{int} d = arrowHeight -\/ 4;}
\DoxyCodeLine{01327       \textcolor{keywordtype}{int} y = 0;}
\DoxyCodeLine{01328       QPainterPath upArrow;}
\DoxyCodeLine{01329       upArrow.moveTo(x, y);}
\DoxyCodeLine{01330       upArrow.lineTo(x + d, y + d);}
\DoxyCodeLine{01331       upArrow.lineTo(x -\/ d, y + d);}
\DoxyCodeLine{01332       upArrow.lineTo(x, y);}
\DoxyCodeLine{01333       y = totalSize.height() -\/ 1;}
\DoxyCodeLine{01334       QPainterPath dnArrow;}
\DoxyCodeLine{01335       dnArrow.moveTo(x, y);}
\DoxyCodeLine{01336       dnArrow.lineTo(x + d, y -\/ d);}
\DoxyCodeLine{01337       dnArrow.lineTo(x -\/ d, y -\/ d);}
\DoxyCodeLine{01338       dnArrow.lineTo(x, y);}
\DoxyCodeLine{01339 }
\DoxyCodeLine{01340       imgPainter.setPen(Qt::NoPen);}
\DoxyCodeLine{01341       imgPainter.setBrush(m\_device == TD\_DecrementDrawing}
\DoxyCodeLine{01342                               ? QColor(255, 0, 0)}
\DoxyCodeLine{01343                               : QColor(200, 100, 100));}
\DoxyCodeLine{01344       imgPainter.drawPath(upArrow);}
\DoxyCodeLine{01345       imgPainter.setBrush(m\_device == TD\_IncrementDrawing}
\DoxyCodeLine{01346                               ? QColor(255, 0, 0)}
\DoxyCodeLine{01347                               : QColor(200, 100, 100));}
\DoxyCodeLine{01348       imgPainter.drawPath(dnArrow);}
\DoxyCodeLine{01349     \}}
\DoxyCodeLine{01350 }
\DoxyCodeLine{01351     QImage texture = QGLWidget::convertToGLFormat(img);}
\DoxyCodeLine{01352 }
\DoxyCodeLine{01353     glRasterPos2f(p.x, p.y);}
\DoxyCodeLine{01354     \textcolor{comment}{// glBitmap(0,0,0,0,  0,-\/size.height()+(y+delta.y),  NULL); //}}
\DoxyCodeLine{01355     glEnable(GL\_BLEND);}
\DoxyCodeLine{01356     glBlendFunc(GL\_SRC\_ALPHA, GL\_ONE\_MINUS\_SRC\_ALPHA);}
\DoxyCodeLine{01357     glDrawPixels(texture.width(), texture.height(), GL\_RGBA, GL\_UNSIGNED\_BYTE,}
\DoxyCodeLine{01358                  texture.bits());}
\DoxyCodeLine{01359     glDisable(GL\_BLEND);}
\DoxyCodeLine{01360     glColor3d(0, 0, 0);}
\DoxyCodeLine{01361 }
\DoxyCodeLine{01362     assert(glGetError() == 0);}
\DoxyCodeLine{01363   \}}
\DoxyCodeLine{01364 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_aea2b23a79e15eaf7225a1672bc1299ac}\label{class_skeleton_tool_aea2b23a79e15eaf7225a1672bc1299ac}} 
\index{SkeletonTool@{SkeletonTool}!drawHooks@{drawHooks}}
\index{drawHooks@{drawHooks}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{drawHooks()}{drawHooks()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::draw\+Hooks (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01005                              \{}
\DoxyCodeLine{01006   \textcolor{comment}{// camera stand reference system}}
\DoxyCodeLine{01007   \textcolor{comment}{// glColor3d(0,0,1);}}
\DoxyCodeLine{01008   \textcolor{comment}{// tglDrawRect(3,3,97,97);}}
\DoxyCodeLine{01009 }
\DoxyCodeLine{01010   \textcolor{comment}{// glColor3d(0,1,1);}}
\DoxyCodeLine{01011   \textcolor{comment}{// tglDrawRect(0,100,Stage::inch,110);}}
\DoxyCodeLine{01012 }
\DoxyCodeLine{01013   QTime time;}
\DoxyCodeLine{01014   time.start();}
\DoxyCodeLine{01015 }
\DoxyCodeLine{01016   m\_magicLinks.clear();}
\DoxyCodeLine{01017   computeMagicLinks();}
\DoxyCodeLine{01018 }
\DoxyCodeLine{01019   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{01020   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh            = app-\/>getCurrentXsheet()-\/>getXsheet();}
\DoxyCodeLine{01021   \textcolor{keywordtype}{int} row                 = app-\/>getCurrentFrame()-\/>getFrame();}
\DoxyCodeLine{01022   \textcolor{keywordtype}{int} col                 = app-\/>getCurrentColumn()-\/>getColumnIndex();}
\DoxyCodeLine{01023   \mbox{\hyperlink{class_t_point_t}{TPointD}} dpiScale        = getViewer()-\/>getDpiScale();}
\DoxyCodeLine{01024 }
\DoxyCodeLine{01025   \textcolor{comment}{// glColor3d(1,0,1);}}
\DoxyCodeLine{01026   \textcolor{comment}{// tglDrawRect(-\/100*dpiScale.x, -\/100*dpiScale.y, 0,0);}}
\DoxyCodeLine{01027 }
\DoxyCodeLine{01028   \textcolor{comment}{// I should not show hooks of columns already connected with the current one}}
\DoxyCodeLine{01029   \textcolor{comment}{// ("{}linking"{} to those hooks would create evil loops in the hierarchy)}}
\DoxyCodeLine{01030   std::set<int> connectedColumns;}
\DoxyCodeLine{01031   getConnectedColumns(connectedColumns, xsh, col);}
\DoxyCodeLine{01032 }
\DoxyCodeLine{01033   std::vector<HookData> currentColumnHooks;}
\DoxyCodeLine{01034   std::vector<HookData> otherColumnsHooks;}
\DoxyCodeLine{01035 }
\DoxyCodeLine{01036   \textcolor{comment}{// fill currentColumnHooks}}
\DoxyCodeLine{01037   \textcolor{comment}{// detect otherColumn (i.e. the active column during a click\&drag operator}}
\DoxyCodeLine{01038   \textcolor{keywordtype}{int} otherColumn = -\/1;}
\DoxyCodeLine{01039   \textcolor{keywordflow}{if} (m\_parentProbeEnabled) \{}
\DoxyCodeLine{01040     \textcolor{comment}{// qDebug("{}  parent probe enabled"{});}}
\DoxyCodeLine{01041     \textcolor{comment}{// currentColumnHooks <-\/ current column \& current handle}}
\DoxyCodeLine{01042     \textcolor{keywordtype}{int} hookId = 0;}
\DoxyCodeLine{01043     std::string handle =}
\DoxyCodeLine{01044         xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(TStageObjectId::ColumnId(col))-\/>\mbox{\hyperlink{class_t_stage_object_aebee1ac99c0341fe053f272b93586ef2}{getHandle}}();}
\DoxyCodeLine{01045     \textcolor{keywordflow}{if} (handle.find(\textcolor{stringliteral}{"{}H"{}}) == 0) \{}
\DoxyCodeLine{01046       \textcolor{keywordtype}{int} j = 1;}
\DoxyCodeLine{01047       \textcolor{keywordflow}{while} (j < (\textcolor{keywordtype}{int})handle.size() \&\& \textcolor{charliteral}{'0'} <= handle[j] \&\& handle[j] <= \textcolor{charliteral}{'9'}) \{}
\DoxyCodeLine{01048         hookId = hookId * 10 + (int)handle[j] -\/ \textcolor{charliteral}{'0'};}
\DoxyCodeLine{01049         j++;}
\DoxyCodeLine{01050       \}}
\DoxyCodeLine{01051     \}}
\DoxyCodeLine{01052 }
\DoxyCodeLine{01053     currentColumnHooks.push\_back(\mbox{\hyperlink{class_skeleton_subtools_1_1_hook_data}{HookData}}(xsh, col, hookId, m\_parentProbe));}
\DoxyCodeLine{01054 }
\DoxyCodeLine{01055     \textcolor{comment}{// otherColumn = "{}picked"{} column not connected}}
\DoxyCodeLine{01056     \mbox{\hyperlink{class_t_point_t}{TPointD}} parentProbePos = getViewer()-\/>\mbox{\hyperlink{class_t_tool_1_1_viewer_a00ad8f88b4832e92cfd91b3f5ba8efd6}{worldToPos}}(m\_parentProbe);}
\DoxyCodeLine{01057     std::vector<int> indexes;}
\DoxyCodeLine{01058     getViewer()-\/>posToColumnIndexes(parentProbePos, indexes, 10.0, \textcolor{keyword}{false});}
\DoxyCodeLine{01059     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = (\textcolor{keywordtype}{int})indexes.size() -\/ 1; i >= 0; i-\/-\/) \{}
\DoxyCodeLine{01060       \textcolor{keywordflow}{if} (connectedColumns.count(indexes[i]) == 0) \{}
\DoxyCodeLine{01061         otherColumn = indexes[i];}
\DoxyCodeLine{01062         \textcolor{keywordflow}{break};}
\DoxyCodeLine{01063       \}}
\DoxyCodeLine{01064     \}}
\DoxyCodeLine{01065     \textcolor{comment}{// if the mouse is not on a stroke, I'm using the "{}old"{} m\_otherColumn, if}}
\DoxyCodeLine{01066     \textcolor{comment}{// any.}}
\DoxyCodeLine{01067     \textcolor{comment}{// (this is needed because of the hooks put inside of unfilled regions)}}
\DoxyCodeLine{01068     \textcolor{keywordflow}{if} (otherColumn < 0 \&\& m\_otherColumn >= 0) \{}
\DoxyCodeLine{01069       \textcolor{keywordflow}{if} (m\_otherColumnBBox.contains(m\_otherColumnBBoxAff.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() *}
\DoxyCodeLine{01070                                      m\_parentProbe))}
\DoxyCodeLine{01071         otherColumn = m\_otherColumn;}
\DoxyCodeLine{01072       \textcolor{keywordflow}{else}}
\DoxyCodeLine{01073         m\_otherColumn = -\/1;}
\DoxyCodeLine{01074     \}}
\DoxyCodeLine{01075   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01076     \textcolor{comment}{// parent probe not enabled: get all hooks of current column. other column =}}
\DoxyCodeLine{01077     \textcolor{comment}{// -\/1}}
\DoxyCodeLine{01078     getHooks(currentColumnHooks, xsh, row, col, \mbox{\hyperlink{class_t_point_t}{TPointD}}(1, 1));  \textcolor{comment}{// dpiScale);}}
\DoxyCodeLine{01079   \}}
\DoxyCodeLine{01080 }
\DoxyCodeLine{01081   \textcolor{comment}{// other columns hooks <-\/ all hooks of all unlinked columns}}
\DoxyCodeLine{01082   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < xsh-\/>\mbox{\hyperlink{class_t_xsheet_a17464dc5617cf87a46f03e1a52d36cc1}{getColumnCount}}(); i++)}
\DoxyCodeLine{01083     \textcolor{keywordflow}{if} (xsh-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(i)-\/>\mbox{\hyperlink{class_t_xsh_column_ae8f2989de835d8ed4ca4c246f70127f1}{isCamstandVisible}}())}
\DoxyCodeLine{01084       \textcolor{keywordflow}{if} (connectedColumns.count(i) == 0)}
\DoxyCodeLine{01085         getHooks(otherColumnsHooks, xsh, row, i, \mbox{\hyperlink{class_t_point_t}{TPointD}}(1, 1));  \textcolor{comment}{// dpiScale);}}
\DoxyCodeLine{01086 }
\DoxyCodeLine{01087   \textcolor{comment}{/*}}
\DoxyCodeLine{01088 \textcolor{comment}{qDebug("{}  time=\%dms"{}, time.elapsed());}}
\DoxyCodeLine{01089 \textcolor{comment}{qDebug("{}  \%d hooks (current column)"{}, currentColumnHooks.size());}}
\DoxyCodeLine{01090 \textcolor{comment}{for(int i=0;i<(int)currentColumnHooks.size();i++)}}
\DoxyCodeLine{01091 \textcolor{comment}{qDebug("{}}}
\DoxyCodeLine{01092 \textcolor{comment}{\%d,\%d"{},currentColumnHooks[i].m\_columnIndex,currentColumnHooks[i].m\_hookId);}}
\DoxyCodeLine{01093 \textcolor{comment}{qDebug("{}  \%d hooks (other columns)"{}, otherColumnsHooks.size());}}
\DoxyCodeLine{01094 \textcolor{comment}{for(int i=0;i<(int)otherColumnsHooks.size();i++)}}
\DoxyCodeLine{01095 \textcolor{comment}{qDebug("{}}}
\DoxyCodeLine{01096 \textcolor{comment}{\%d,\%d"{},otherColumnsHooks[i].m\_columnIndex,otherColumnsHooks[i].m\_hookId);}}
\DoxyCodeLine{01097 \textcolor{comment}{*/}}
\DoxyCodeLine{01098 }
\DoxyCodeLine{01099   std::vector<TRectD> balloons;}
\DoxyCodeLine{01100 }
\DoxyCodeLine{01101   \textcolor{comment}{// draw current column hooks}}
\DoxyCodeLine{01102   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (int)currentColumnHooks.size(); i++) \{}
\DoxyCodeLine{01103     \textcolor{keyword}{const} \mbox{\hyperlink{class_skeleton_subtools_1_1_hook_data}{HookData}} \&hook = currentColumnHooks[i];}
\DoxyCodeLine{01104     \textcolor{keywordflow}{if} (hook.m\_name == \textcolor{stringliteral}{"{}"{}}) \textcolor{keywordflow}{continue};  \textcolor{comment}{// should not happen}}
\DoxyCodeLine{01105     \textcolor{keywordtype}{int} code    = TD\_Hook + hook.m\_hookId;}
\DoxyCodeLine{01106     \mbox{\hyperlink{class_t_point_t}{TPointD}} pos = hook.m\_pos;}
\DoxyCodeLine{01107     ToolUtils::drawHook(pos, ToolUtils::OtherLevelHook);}
\DoxyCodeLine{01108     glPushName(code);}
\DoxyCodeLine{01109     TPixel32 color(200, 220, 205, 200);}
\DoxyCodeLine{01110     \textcolor{keywordflow}{if} (hook.m\_isPivot)}
\DoxyCodeLine{01111       color = TPixel32(200, 200, 10, 200);}
\DoxyCodeLine{01112     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == m\_device)}
\DoxyCodeLine{01113       color = TPixel32(185, 255, 255);}
\DoxyCodeLine{01114     ToolUtils::drawBalloon(pos, hook.m\_name, color, \mbox{\hyperlink{class_t_point_t}{TPoint}}(20, 20),}
\DoxyCodeLine{01115                            getPixelSize(), isPicking(), \&balloons);}
\DoxyCodeLine{01116     glPopName();}
\DoxyCodeLine{01117   \}}
\DoxyCodeLine{01118 }
\DoxyCodeLine{01119   \textcolor{keywordflow}{if} (m\_parentProbeEnabled) \{}
\DoxyCodeLine{01120     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (int)otherColumnsHooks.size(); i++)}
\DoxyCodeLine{01121       ToolUtils::drawHook(otherColumnsHooks[i].m\_pos,}
\DoxyCodeLine{01122                           ToolUtils::OtherLevelHook);}
\DoxyCodeLine{01123   \}}
\DoxyCodeLine{01124 }
\DoxyCodeLine{01125   \textcolor{comment}{// search for magic links}}
\DoxyCodeLine{01126   \textcolor{keywordtype}{double} minDist2       = 0;}
\DoxyCodeLine{01127   \textcolor{keywordtype}{double} snapRadius2    = 100 * getPixelSize() * getPixelSize();}
\DoxyCodeLine{01128   \textcolor{keywordtype}{double} snapRadius2bis = 100;}
\DoxyCodeLine{01129 }
\DoxyCodeLine{01130   \textcolor{keywordflow}{if} (!m\_parentProbeEnabled) \{}
\DoxyCodeLine{01131     \textcolor{comment}{// "{}static"{} magic links: no parent probe}}
\DoxyCodeLine{01132     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (int)currentColumnHooks.size(); i++) \{}
\DoxyCodeLine{01133       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < (int)otherColumnsHooks.size(); j++) \{}
\DoxyCodeLine{01134         \textcolor{keywordtype}{double} dist2 =}
\DoxyCodeLine{01135             norm2(currentColumnHooks[i].m\_pos -\/ otherColumnsHooks[j].m\_pos);}
\DoxyCodeLine{01136         \textcolor{keywordflow}{if} (currentColumnHooks[i].m\_hookId == 0 ||}
\DoxyCodeLine{01137             otherColumnsHooks[j].m\_hookId == 0)}
\DoxyCodeLine{01138           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01139         \textcolor{keywordflow}{if} (dist2 < snapRadius2bis) \{}
\DoxyCodeLine{01140           m\_magicLinks.push\_back(}
\DoxyCodeLine{01141               \mbox{\hyperlink{class_skeleton_subtools_1_1_magic_link}{MagicLink}}(currentColumnHooks[i], otherColumnsHooks[j], dist2));}
\DoxyCodeLine{01142 }
\DoxyCodeLine{01143           qDebug(\textcolor{stringliteral}{"{}  magic link\_a \%d (\%d,\%d) \%d (\%d,\%d); dist=\%f"{}}, i,}
\DoxyCodeLine{01144                  currentColumnHooks[i].m\_columnIndex,}
\DoxyCodeLine{01145                  currentColumnHooks[i].m\_hookId, j,}
\DoxyCodeLine{01146                  otherColumnsHooks[j].m\_columnIndex,}
\DoxyCodeLine{01147                  otherColumnsHooks[j].m\_hookId, dist2);}
\DoxyCodeLine{01148         \}}
\DoxyCodeLine{01149       \}}
\DoxyCodeLine{01150     \}}
\DoxyCodeLine{01151   \}}
\DoxyCodeLine{01152 }
\DoxyCodeLine{01153   \textcolor{keywordflow}{if} (m\_parentProbeEnabled) \{}
\DoxyCodeLine{01154     \textcolor{comment}{// search for the closest hook of the picked column}}
\DoxyCodeLine{01155     \textcolor{keywordtype}{int} i = -\/1, j = -\/1;}
\DoxyCodeLine{01156     \textcolor{keywordtype}{double} minDist2 = snapRadius2;}
\DoxyCodeLine{01157     \textcolor{keywordflow}{for} (i = 0; i < (int)otherColumnsHooks.size(); i++) \{}
\DoxyCodeLine{01158       \textcolor{keywordtype}{double} dist2 = tdistance2(otherColumnsHooks[i].m\_pos, m\_parentProbe);}
\DoxyCodeLine{01159       \textcolor{keywordflow}{if} (dist2 < minDist2) \{}
\DoxyCodeLine{01160         j           = i;}
\DoxyCodeLine{01161         minDist2    = dist2;}
\DoxyCodeLine{01162         otherColumn = otherColumnsHooks[i].m\_columnIndex;}
\DoxyCodeLine{01163       \}}
\DoxyCodeLine{01164     \}}
\DoxyCodeLine{01165   \}}
\DoxyCodeLine{01166 }
\DoxyCodeLine{01167   \textcolor{keywordflow}{if} (m\_parentProbeEnabled \&\& otherColumn >= 0)  \textcolor{comment}{//  \&\& m\_magicLinks.empty()}}
\DoxyCodeLine{01168   \{}
\DoxyCodeLine{01169     \textcolor{comment}{// "{}dynamic"{} magic links: probing and picking a column}}
\DoxyCodeLine{01170 }
\DoxyCodeLine{01171     \textcolor{comment}{// show image bounding box}}
\DoxyCodeLine{01172     m\_otherColumn = otherColumn;}
\DoxyCodeLine{01173     getImageBoundingBox(m\_otherColumnBBox, m\_otherColumnBBoxAff, row,}
\DoxyCodeLine{01174                         otherColumn);}
\DoxyCodeLine{01175     \textcolor{keywordflow}{if} (!m\_otherColumnBBox.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \{}
\DoxyCodeLine{01176       glPushMatrix();}
\DoxyCodeLine{01177       tglMultMatrix(m\_otherColumnBBoxAff);}
\DoxyCodeLine{01178       ToolUtils::drawRect(m\_otherColumnBBox, TPixel32(188, 202, 191), 0xF0F0);}
\DoxyCodeLine{01179       \textcolor{comment}{// tglDrawRect(img-\/>getBBox());}}
\DoxyCodeLine{01180       glPopMatrix();}
\DoxyCodeLine{01181     \}}
\DoxyCodeLine{01182 }
\DoxyCodeLine{01183     \textcolor{comment}{/*}}
\DoxyCodeLine{01184 \textcolor{comment}{TXshCell cell = xsh-\/>getCell(row, otherColumn);}}
\DoxyCodeLine{01185 \textcolor{comment}{//TAffine aff = xsh-\/>getPlacement(TStageObjectId::ColumnId(otherColumn),row);}}
\DoxyCodeLine{01186 \textcolor{comment}{//m\_otherColumnAff = aff;}}
\DoxyCodeLine{01187 \textcolor{comment}{TImageP img = cell.getImage(false);}}
\DoxyCodeLine{01188 \textcolor{comment}{if(img)}}
\DoxyCodeLine{01189 \textcolor{comment}{\{}}
\DoxyCodeLine{01190 \textcolor{comment}{getImageBoundingBox(m\_otherColumnBBox, m\_otherColumnBBoxAff, row, otherColumn);}}
\DoxyCodeLine{01191 \textcolor{comment}{//glColor3d(188.0/255.0, 202.0/255.0, 191.0/255.0);}}
\DoxyCodeLine{01192 \textcolor{comment}{glPushMatrix();}}
\DoxyCodeLine{01193 \textcolor{comment}{tglMultMatrix(aff * imageDpiAff);}}
\DoxyCodeLine{01194 \textcolor{comment}{ToolUtils::drawRect(img-\/>getBBox(), TPixel32(188,202,191), 0xF0F0);}}
\DoxyCodeLine{01195 \textcolor{comment}{//tglDrawRect(img-\/>getBBox());}}
\DoxyCodeLine{01196 \textcolor{comment}{glPopMatrix();}}
\DoxyCodeLine{01197 \textcolor{comment}{\}}}
\DoxyCodeLine{01198 \textcolor{comment}{*/}}
\DoxyCodeLine{01199     \textcolor{comment}{// search for the closest hook of the picked column}}
\DoxyCodeLine{01200     \textcolor{keywordtype}{int} i = -\/1, j = -\/1;}
\DoxyCodeLine{01201     \textcolor{keywordtype}{double} minDist2 = snapRadius2;}
\DoxyCodeLine{01202     \textcolor{keywordflow}{for} (i = 0; i < (int)otherColumnsHooks.size(); i++)}
\DoxyCodeLine{01203       \textcolor{keywordflow}{if} (otherColumnsHooks[i].m\_columnIndex == otherColumn) \{}
\DoxyCodeLine{01204         \textcolor{keywordtype}{double} dist2 = tdistance2(otherColumnsHooks[i].m\_pos, m\_parentProbe);}
\DoxyCodeLine{01205         \textcolor{keywordflow}{if} (j < 0)}
\DoxyCodeLine{01206           j = i;}
\DoxyCodeLine{01207         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dist2 < minDist2 || otherColumnsHooks[i].m\_hookId == 0) \{}
\DoxyCodeLine{01208           j        = i;}
\DoxyCodeLine{01209           minDist2 = dist2;}
\DoxyCodeLine{01210         \}}
\DoxyCodeLine{01211       \}}
\DoxyCodeLine{01212     \textcolor{comment}{// visualize a balloon for the closest hook}}
\DoxyCodeLine{01213     \textcolor{keywordflow}{if} (0 <= j \&\& j < (\textcolor{keywordtype}{int})otherColumnsHooks.size()) \{}
\DoxyCodeLine{01214       \textcolor{comment}{// I want to get a specific color when overlaying the label on white}}
\DoxyCodeLine{01215       \textcolor{keywordtype}{int} alfa = 100, ialfa = 255 -\/ alfa;}
\DoxyCodeLine{01216       TPixel32 color(255 * (188 -\/ ialfa) / alfa, 255 * (202 -\/ ialfa) / alfa,}
\DoxyCodeLine{01217                      255 * (191 -\/ ialfa) / alfa, alfa);}
\DoxyCodeLine{01218       ToolUtils::drawBalloon(otherColumnsHooks[j].m\_pos,}
\DoxyCodeLine{01219                              otherColumnsHooks[j].\mbox{\hyperlink{class_t_tool_ac92abce57c7c53b5b29847144c571fb1}{m\_name}},  \textcolor{comment}{// getHandle(),}}
\DoxyCodeLine{01220                              color, \mbox{\hyperlink{class_t_point_t}{TPoint}}(20, 20), getPixelSize(), \textcolor{keyword}{false},}
\DoxyCodeLine{01221                              \&balloons);}
\DoxyCodeLine{01222 }
\DoxyCodeLine{01223       \mbox{\hyperlink{class_skeleton_subtools_1_1_hook_data}{HookData}} baseHook = currentColumnHooks[0];}
\DoxyCodeLine{01224       baseHook.m\_pos    = otherColumnsHooks[j].m\_pos;}
\DoxyCodeLine{01225 }
\DoxyCodeLine{01226       \textcolor{comment}{// this is also a magic link}}
\DoxyCodeLine{01227       m\_magicLinks.push\_back(\mbox{\hyperlink{class_skeleton_subtools_1_1_magic_link}{MagicLink}}(baseHook, otherColumnsHooks[j], 10000));}
\DoxyCodeLine{01228     \}}
\DoxyCodeLine{01229   \}}
\DoxyCodeLine{01230 }
\DoxyCodeLine{01231   \textcolor{comment}{// visualize all the magic links}}
\DoxyCodeLine{01232 }
\DoxyCodeLine{01233   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (int)m\_magicLinks.size(); i++) \{}
\DoxyCodeLine{01234     \textcolor{keyword}{const} \mbox{\hyperlink{class_skeleton_subtools_1_1_magic_link}{MagicLink}} \&magicLink = m\_magicLinks[i];}
\DoxyCodeLine{01235     \textcolor{keyword}{const} \mbox{\hyperlink{class_skeleton_subtools_1_1_hook_data}{HookData}} \&h1         = magicLink.m\_h1;}
\DoxyCodeLine{01236     std::string name;}
\DoxyCodeLine{01237     name = (m\_parentProbeEnabled ? \textcolor{stringliteral}{"{}Linking "{}} : \textcolor{stringliteral}{"{}Link "{}}) +}
\DoxyCodeLine{01238            removeTrailingH(magicLink.m\_h0.getHandle()) + \textcolor{stringliteral}{"{} to Col "{}} +}
\DoxyCodeLine{01239            std::to\_string(h1.m\_columnIndex + 1) + \textcolor{stringliteral}{"{}/"{}} +}
\DoxyCodeLine{01240            removeTrailingH(h1.getHandle());}
\DoxyCodeLine{01241 }
\DoxyCodeLine{01242     \textcolor{keywordtype}{int} code = TD\_MagicLink + i;}
\DoxyCodeLine{01243     glPushName(code);}
\DoxyCodeLine{01244     TPixel32 color(100, 255, 100, 100);}
\DoxyCodeLine{01245     \textcolor{keywordflow}{if} (code == m\_device) color = TPixel32(185, 255, 255);}
\DoxyCodeLine{01246     ToolUtils::drawBalloon(magicLink.m\_h0.m\_pos, name, color, \mbox{\hyperlink{class_t_point_t}{TPoint}}(20, -\/20),}
\DoxyCodeLine{01247                            getPixelSize(), isPicking(), \&balloons);}
\DoxyCodeLine{01248     glPopName();}
\DoxyCodeLine{01249   \}}
\DoxyCodeLine{01250 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_aef68f443b338c0a66ee7bde36394028d}\label{class_skeleton_tool_aef68f443b338c0a66ee7bde36394028d}} 
\index{SkeletonTool@{SkeletonTool}!drawIKBone@{drawIKBone}}
\index{drawIKBone@{drawIKBone}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{drawIKBone()}{drawIKBone()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::draw\+IKBone (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{a,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{b }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00976                                                                 \{}
\DoxyCodeLine{00977   \textcolor{comment}{// se sono troppo vicini niente da fare}}
\DoxyCodeLine{00978   \mbox{\hyperlink{class_t_point_t}{TPointD}} delta = b -\/ a;}
\DoxyCodeLine{00979   \textcolor{keywordflow}{if} (norm2(delta) < 0.001) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00980   \mbox{\hyperlink{class_t_point_t}{TPointD}} u = getPixelSize() * 2.5 * normalize(rotate90(delta));}
\DoxyCodeLine{00981   glColor3d(0.58, 0.58, 0.58);}
\DoxyCodeLine{00982   glBegin(GL\_POLYGON);}
\DoxyCodeLine{00983   tglVertex(a + u);}
\DoxyCodeLine{00984   tglVertex(b + u);}
\DoxyCodeLine{00985   tglVertex(b -\/ u);}
\DoxyCodeLine{00986   tglVertex(a -\/ u);}
\DoxyCodeLine{00987   glEnd();}
\DoxyCodeLine{00988   glColor3d(0.2, 0.3, 0.35);}
\DoxyCodeLine{00989   glBegin(GL\_LINES);}
\DoxyCodeLine{00990   tglVertex(a + u);}
\DoxyCodeLine{00991   tglVertex(b + u);}
\DoxyCodeLine{00992   tglVertex(a -\/ u);}
\DoxyCodeLine{00993   tglVertex(b -\/ u);}
\DoxyCodeLine{00994   glEnd();}
\DoxyCodeLine{00995 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a31ec844a4b41d90101fe4d5c352497ea}\label{class_skeleton_tool_a31ec844a4b41d90101fe4d5c352497ea}} 
\index{SkeletonTool@{SkeletonTool}!drawIKJoint@{drawIKJoint}}
\index{drawIKJoint@{drawIKJoint}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{drawIKJoint()}{drawIKJoint()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::draw\+IKJoint (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_skeleton_1_1_bone}{Skeleton\+::\+Bone}} $\ast$}]{bone }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00873                                                        \{}
\DoxyCodeLine{00874   \mbox{\hyperlink{class_t_point_t}{TPointD}} pos     = bone-\/>getCenter();}
\DoxyCodeLine{00875   \textcolor{keyword}{const} \textcolor{keywordtype}{double} r0 = 6 * getPixelSize(), r1 = r0 / 3;}
\DoxyCodeLine{00876   \textcolor{keywordtype}{int} code = TD\_LockStageObject + bone-\/>getColumnIndex();}
\DoxyCodeLine{00877   glPushName(code);}
\DoxyCodeLine{00878   glColor3d(0.8, 0.5, 0.05);}
\DoxyCodeLine{00879   \textcolor{keywordflow}{if} (bone-\/>getPinnedStatus() != Skeleton::Bone::FREE) \{}
\DoxyCodeLine{00880     \textcolor{keywordflow}{if} (bone-\/>getPinnedStatus() == Skeleton::Bone::TEMP\_PINNED) \{}
\DoxyCodeLine{00881       \textcolor{keywordtype}{double} r1 = r0 * 0.60;}
\DoxyCodeLine{00882       glColor3d(60.0 / 255.0, 250.0 / 255.0, 1.0);}
\DoxyCodeLine{00883       glRectd(pos.x -\/ r0, pos.y -\/ r0, pos.x + r0, pos.y + r0);}
\DoxyCodeLine{00884 }
\DoxyCodeLine{00885       glColor3d(0.78, 0.62, 0);}
\DoxyCodeLine{00886       glRectd(pos.x -\/ r1, pos.y -\/ r1, pos.x + r1, pos.y + r1);}
\DoxyCodeLine{00887 }
\DoxyCodeLine{00888       glColor3d(0.2, 0.1, 0.05);}
\DoxyCodeLine{00889       tglDrawRect(pos.x -\/ r0, pos.y -\/ r0, pos.x + r0, pos.y + r0);}
\DoxyCodeLine{00890       tglDrawRect(pos.x -\/ r1, pos.y -\/ r1, pos.x + r1, pos.y + r1);}
\DoxyCodeLine{00891     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00892       glColor3d(0, 175.0 / 255.0, 1.0);}
\DoxyCodeLine{00893       glRectd(pos.x -\/ r0, pos.y -\/ r0, pos.x + r0, pos.y + r0);}
\DoxyCodeLine{00894       glColor3d(0.2, 0.1, 0.05);}
\DoxyCodeLine{00895       tglDrawRect(pos.x -\/ r0, pos.y -\/ r0, pos.x + r0, pos.y + r0);}
\DoxyCodeLine{00896     \}}
\DoxyCodeLine{00897   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00898     \textcolor{keywordflow}{if} (bone-\/>isSelected())}
\DoxyCodeLine{00899       glColor3d(1, 0.78, 0.19);}
\DoxyCodeLine{00900     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00901       glColor3d(0.78, 0.62, 0);}
\DoxyCodeLine{00902     tglDrawDisk(pos, r0);}
\DoxyCodeLine{00903     glColor3d(0.2, 0.1, 0.05);}
\DoxyCodeLine{00904     tglDrawCircle(pos, r0);}
\DoxyCodeLine{00905   \}}
\DoxyCodeLine{00906 }
\DoxyCodeLine{00907   \textcolor{keywordflow}{if} (m\_device == code) \{}
\DoxyCodeLine{00908     glColor3d(0.9, 0.1, 0.1);}
\DoxyCodeLine{00909     tglFillRect(pos.x -\/ r1, pos.y -\/ r1, pos.x + r1, pos.y + r1);}
\DoxyCodeLine{00910   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00911     glColor3d(0.2, 0.1, 0.05);}
\DoxyCodeLine{00912     \textcolor{keyword}{const} \textcolor{keywordtype}{double} r3 = 2 * getPixelSize();}
\DoxyCodeLine{00913     tglDrawCircle(pos, r3);}
\DoxyCodeLine{00914   \}}
\DoxyCodeLine{00915   glPopName();}
\DoxyCodeLine{00916 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_aaa750eeb0eefdaa13d377f5c3f6f44f5}\label{class_skeleton_tool_aaa750eeb0eefdaa13d377f5c3f6f44f5}} 
\index{SkeletonTool@{SkeletonTool}!drawJoint@{drawJoint}}
\index{drawJoint@{drawJoint}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{drawJoint()}{drawJoint()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::draw\+Joint (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p,  }\item[{bool}]{current }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00920                                                              \{}
\DoxyCodeLine{00921   \textcolor{keyword}{const} \textcolor{keywordtype}{double} alpha = 0.8, ialpha = 1 -\/ alpha;}
\DoxyCodeLine{00922   \textcolor{keywordtype}{double} r0 = 4 * getPixelSize();}
\DoxyCodeLine{00923   \textcolor{keywordflow}{if} (current) \{}
\DoxyCodeLine{00924     glPushName(TD\_Center);}
\DoxyCodeLine{00925     \textcolor{keywordflow}{if} (m\_device == TD\_Center) \{}
\DoxyCodeLine{00926       glColor4d(0.9 * alpha, 0.8 * alpha, 0.2 * alpha, alpha);}
\DoxyCodeLine{00927       r0 *= 1.5;}
\DoxyCodeLine{00928     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00929       glColor4d(((255.0 / 255.0) -\/ ialpha) / alpha,}
\DoxyCodeLine{00930                 ((200.0 / 255.0) -\/ ialpha) / alpha,}
\DoxyCodeLine{00931                 ((48.0 / 255.0) -\/ ialpha) / alpha, alpha);}
\DoxyCodeLine{00932     \}}
\DoxyCodeLine{00933     tglDrawDisk(pos, r0);}
\DoxyCodeLine{00934     glColor3d(0.2, 0.1, 0.05);}
\DoxyCodeLine{00935     tglDrawCircle(pos, r0);}
\DoxyCodeLine{00936     glPopName();}
\DoxyCodeLine{00937   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00938     \textcolor{comment}{// in build skeleton center is clickable, but only the current one}}
\DoxyCodeLine{00939     \textcolor{keywordflow}{if} (m\_mode.getValue() == BUILD\_SKELETON)}
\DoxyCodeLine{00940       glColor4d(0.60 * alpha, 0.60 * alpha, 0.60 * alpha, alpha);}
\DoxyCodeLine{00941     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00942       glColor4d(0.78 * alpha, 0.62 * alpha, 0 * alpha, alpha);}
\DoxyCodeLine{00943     tglDrawDisk(pos, r0);}
\DoxyCodeLine{00944     glColor3d(0.2, 0.1, 0.05);}
\DoxyCodeLine{00945     tglDrawCircle(pos, r0);}
\DoxyCodeLine{00946   \}}
\DoxyCodeLine{00947 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_aad06ecaad6e3287fb942807518bbbf41}\label{class_skeleton_tool_aad06ecaad6e3287fb942807518bbbf41}} 
\index{SkeletonTool@{SkeletonTool}!drawLevelBoundingBox@{drawLevelBoundingBox}}
\index{drawLevelBoundingBox@{drawLevelBoundingBox}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{drawLevelBoundingBox()}{drawLevelBoundingBox()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::draw\+Level\+Bounding\+Box (\begin{DoxyParamCaption}\item[{int}]{frame,  }\item[{int}]{column\+Index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00848                                                                   \{}
\DoxyCodeLine{00849   \mbox{\hyperlink{class_t_affine}{TAffine}} affine   = \mbox{\hyperlink{class_t_tool_a73c1b7f13eaea33e1d305636f44c4a64}{getCurrentColumnMatrix}}();}
\DoxyCodeLine{00850   \mbox{\hyperlink{class_t_xsh_cell}{TXshCell}} cell    = \mbox{\hyperlink{class_t_tool_a8716e1462da359f4902c044a79f2d40d}{getXsheet}}()-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(frame, columnIndex);}
\DoxyCodeLine{00851   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} image    = cell.\mbox{\hyperlink{class_t_xsh_cell_a20b623d308bc09b820ec6b116516f564}{getImage}}(\textcolor{keyword}{false});}
\DoxyCodeLine{00852   \mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}} ti  = image;}
\DoxyCodeLine{00853   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = image;}
\DoxyCodeLine{00854   glPushMatrix();}
\DoxyCodeLine{00855   \textcolor{keywordflow}{if} (affine != getMatrix()) tglMultMatrix(getMatrix().inv() * affine);}
\DoxyCodeLine{00856   \textcolor{keywordflow}{if} (ti) \{}
\DoxyCodeLine{00857     \mbox{\hyperlink{class_t_point_t}{TPointD}} dpiScale = getViewer()-\/>getDpiScale();}
\DoxyCodeLine{00858     glScaled(dpiScale.x, dpiScale.y, 1);}
\DoxyCodeLine{00859     \mbox{\hyperlink{class_t_rect_t}{TRectD}} bbox =}
\DoxyCodeLine{00860         ToonzImageUtils::convertRasterToWorld(convert(ti-\/>getBBox()), ti);}
\DoxyCodeLine{00861     ToolUtils::drawRect(bbox * ti-\/>getSubsampling(), TPixel32(200, 200, 200),}
\DoxyCodeLine{00862                         0x5555);}
\DoxyCodeLine{00863   \}}
\DoxyCodeLine{00864   \textcolor{keywordflow}{if} (vi) \{}
\DoxyCodeLine{00865     \mbox{\hyperlink{class_t_rect_t}{TRectD}} bbox = vi-\/>getBBox();}
\DoxyCodeLine{00866     ToolUtils::drawRect(bbox, TPixel32(200, 200, 200), 0x5555);}
\DoxyCodeLine{00867   \}}
\DoxyCodeLine{00868   glPopMatrix();}
\DoxyCodeLine{00869 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_abd1bb6d73883e97162ab6622c6d6e4b4}\label{class_skeleton_tool_abd1bb6d73883e97162ab6622c6d6e4b4}} 
\index{SkeletonTool@{SkeletonTool}!drawMainGadget@{drawMainGadget}}
\index{drawMainGadget@{drawMainGadget}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{drawMainGadget()}{drawMainGadget()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::draw\+Main\+Gadget (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{center }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01368                                                        \{}
\DoxyCodeLine{01369   assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{01370 }
\DoxyCodeLine{01371   \textcolor{keywordtype}{double} r  = 10 * getPixelSize();}
\DoxyCodeLine{01372   \textcolor{keywordtype}{double} cx = center.x + r * 1.1;}
\DoxyCodeLine{01373   \textcolor{keywordtype}{double} cy = center.y -\/ r * 1.1;}
\DoxyCodeLine{01374 }
\DoxyCodeLine{01375   glColor3d(1, 0, 0);}
\DoxyCodeLine{01376 }
\DoxyCodeLine{01377   \textcolor{keywordflow}{if} (isPicking()) \{}
\DoxyCodeLine{01378     glPushName(TD\_Translation);}
\DoxyCodeLine{01379     tglDrawDisk(\mbox{\hyperlink{class_t_point_t}{TPointD}}(cx, cy), getPixelSize() * 9);}
\DoxyCodeLine{01380     glPopName();}
\DoxyCodeLine{01381     \textcolor{keywordflow}{return};}
\DoxyCodeLine{01382   \}}
\DoxyCodeLine{01383 }
\DoxyCodeLine{01384   QImage img(19, 19, QImage::Format\_ARGB32);}
\DoxyCodeLine{01385   img.fill(Qt::transparent);}
\DoxyCodeLine{01386   QPainter p(\&img);}
\DoxyCodeLine{01387   \textcolor{comment}{// p.setRenderHints(QPainter::Antialiasing|QPainter::TextAntialiasing);}}
\DoxyCodeLine{01388 }
\DoxyCodeLine{01389   QPainterPath pp;}
\DoxyCodeLine{01390   \textcolor{keywordtype}{int} dx = 1, dy = 0;}
\DoxyCodeLine{01391   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 4; i++) \{}
\DoxyCodeLine{01392     \textcolor{keywordtype}{int} x = 9 + dx * 8;}
\DoxyCodeLine{01393     \textcolor{keywordtype}{int} y = 9 + dy * 8;}
\DoxyCodeLine{01394     pp.moveTo(9, 9);}
\DoxyCodeLine{01395     pp.lineTo(x, y);}
\DoxyCodeLine{01396     pp.lineTo(x -\/ 2 * dx -\/ 2 * dy, y -\/ 2 * dy + 2 * dx);}
\DoxyCodeLine{01397     pp.moveTo(x, y);}
\DoxyCodeLine{01398     pp.lineTo(x -\/ 2 * dx + 2 * dy, y -\/ 2 * dy -\/ 2 * dx);}
\DoxyCodeLine{01399     \textcolor{keywordtype}{int} d = dx;}
\DoxyCodeLine{01400     dx    = -\/dy;}
\DoxyCodeLine{01401     dy    = d;}
\DoxyCodeLine{01402   \}}
\DoxyCodeLine{01403 }
\DoxyCodeLine{01404   p.setPen(QPen(Qt::white, 3));}
\DoxyCodeLine{01405   p.drawPath(pp);}
\DoxyCodeLine{01406   p.setPen(Qt::black);}
\DoxyCodeLine{01407   p.drawPath(pp);}
\DoxyCodeLine{01408 }
\DoxyCodeLine{01409   p.setBrush(QColor(54, 213, 54));}
\DoxyCodeLine{01410   p.drawRect(6, 6, 6, 6);}
\DoxyCodeLine{01411   QImage texture = QGLWidget::convertToGLFormat(img);}
\DoxyCodeLine{01412   \textcolor{comment}{// texture.save("{}c:\(\backslash\)\(\backslash\)urka.png"{});}}
\DoxyCodeLine{01413 }
\DoxyCodeLine{01414   glRasterPos2f(center.x + r * 1.1, center.y -\/ r * 1.1);}
\DoxyCodeLine{01415   glBitmap(0, 0, 0, 0, -\/9, -\/9, NULL);}
\DoxyCodeLine{01416   glEnable(GL\_BLEND);}
\DoxyCodeLine{01417   glBlendFunc(GL\_SRC\_ALPHA, GL\_ONE\_MINUS\_SRC\_ALPHA);}
\DoxyCodeLine{01418   glDrawPixels(texture.width(), texture.height(), GL\_RGBA, GL\_UNSIGNED\_BYTE,}
\DoxyCodeLine{01419                texture.bits());}
\DoxyCodeLine{01420   glDisable(GL\_BLEND);}
\DoxyCodeLine{01421   glColor3d(0, 0, 0);}
\DoxyCodeLine{01422 }
\DoxyCodeLine{01423   assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{01424 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a4530367fec46f2cff9f8775c5e7c8829}\label{class_skeleton_tool_a4530367fec46f2cff9f8775c5e7c8829}} 
\index{SkeletonTool@{SkeletonTool}!drawSkeleton@{drawSkeleton}}
\index{drawSkeleton@{drawSkeleton}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{drawSkeleton()}{drawSkeleton()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::draw\+Skeleton (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_skeleton}{Skeleton}} \&}]{skeleton,  }\item[{int}]{row }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00733                                                                  \{}
\DoxyCodeLine{00734   \textcolor{keywordtype}{bool} buildingSkeleton = m\_mode.getValue() == BUILD\_SKELETON;}
\DoxyCodeLine{00735   \textcolor{keywordtype}{bool} ikEnabled        = m\_mode.getValue() == INVERSE\_KINEMATICS;}
\DoxyCodeLine{00736 }
\DoxyCodeLine{00737   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh = \mbox{\hyperlink{class_t_tool_a8716e1462da359f4902c044a79f2d40d}{getXsheet}}();}
\DoxyCodeLine{00738   std::vector<int> showBoneIndex;}
\DoxyCodeLine{00739   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00740   \textcolor{keywordflow}{for} (i = 0; i < skeleton.getBoneCount(); i++) \{}
\DoxyCodeLine{00741     \mbox{\hyperlink{class_skeleton_1_1_bone}{Skeleton::Bone}} *bone = skeleton.getBone(i);}
\DoxyCodeLine{00742     \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} \textcolor{keywordtype}{id}    = bone-\/>getStageObject()-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}();}
\DoxyCodeLine{00743     \textcolor{keywordtype}{bool} canShow         = canShowBone(bone, xsh, row);}
\DoxyCodeLine{00744     \textcolor{keywordflow}{if} (!canShow) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00745     showBoneIndex.push\_back(i);}
\DoxyCodeLine{00746   \}}
\DoxyCodeLine{00747 }
\DoxyCodeLine{00748   \textcolor{keywordtype}{bool} changingParent = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_skeleton_subtools_1_1_parent_change_tool}{ParentChangeTool}} *\textcolor{keyword}{>}(m\_dragTool) != 0;}
\DoxyCodeLine{00749   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} currentObjectId =}
\DoxyCodeLine{00750       TTool::getApplication()-\/>getCurrentObject()-\/>getObjectId();}
\DoxyCodeLine{00751   std::string currentHandle = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(currentObjectId)-\/>\mbox{\hyperlink{class_t_stage_object_aebee1ac99c0341fe053f272b93586ef2}{getHandle}}();}
\DoxyCodeLine{00752 }
\DoxyCodeLine{00753   \textcolor{keywordflow}{for} (i = 0; i < (int)showBoneIndex.size(); i++) \{}
\DoxyCodeLine{00754     \mbox{\hyperlink{class_skeleton_1_1_bone}{Skeleton::Bone}} *bone = skeleton.getBone(showBoneIndex[i]);}
\DoxyCodeLine{00755     \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} \textcolor{keywordtype}{id}    = bone-\/>getStageObject()-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}();}
\DoxyCodeLine{00756     \textcolor{keywordtype}{bool} isCurrent       = \textcolor{keywordtype}{id} == currentObjectId;}
\DoxyCodeLine{00757     \textcolor{keywordflow}{if} (isCurrent \&\& buildingSkeleton \&\& m\_parentProbeEnabled) \{}
\DoxyCodeLine{00758       \textcolor{keywordflow}{if} (!m\_magicLinks.empty()) \{}
\DoxyCodeLine{00759         drawBone(bone-\/>getCenter(), m\_magicLinks[0].m\_h1.m\_pos, \textcolor{keyword}{false});}
\DoxyCodeLine{00760       \}}
\DoxyCodeLine{00761       drawBone(bone-\/>getCenter(), m\_parentProbe, \textcolor{keyword}{true});}
\DoxyCodeLine{00762     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ikEnabled) \{}
\DoxyCodeLine{00763       \textcolor{keywordflow}{if} (bone-\/>getParent())}
\DoxyCodeLine{00764         drawIKBone(bone-\/>getCenter(), bone-\/>getParent()-\/>getCenter());}
\DoxyCodeLine{00765     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bone-\/>getParent() || isCurrent) \{}
\DoxyCodeLine{00766       \textcolor{keywordtype}{double} pixelSize = getPixelSize();}
\DoxyCodeLine{00767       \mbox{\hyperlink{class_t_point_t}{TPointD}} a        = bone-\/>getCenter();}
\DoxyCodeLine{00768       \mbox{\hyperlink{class_t_point_t}{TPointD}} b, pm;}
\DoxyCodeLine{00769       \textcolor{keywordflow}{if} (bone-\/>getParent()) \{}
\DoxyCodeLine{00770         b  = bone-\/>getParent()-\/>getCenter();}
\DoxyCodeLine{00771         pm = (a + b) * 0.5;}
\DoxyCodeLine{00772       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00773         pm = b = a + \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 60) * pixelSize;}
\DoxyCodeLine{00774       \}}
\DoxyCodeLine{00775       \textcolor{keywordtype}{bool} boneIsVisible = \textcolor{keyword}{false};}
\DoxyCodeLine{00776       \textcolor{keywordflow}{if} (buildingSkeleton) \{}
\DoxyCodeLine{00777         boneIsVisible = \textcolor{keyword}{true};}
\DoxyCodeLine{00778         \textcolor{keywordflow}{if} (bone-\/>isSelected())}
\DoxyCodeLine{00779           drawBone(a, b, \textcolor{keyword}{true});}
\DoxyCodeLine{00780         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!m\_showOnlyActiveSkeleton.getValue())}
\DoxyCodeLine{00781           drawBone(a, b, \textcolor{keyword}{false});}
\DoxyCodeLine{00782         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00783           boneIsVisible = \textcolor{keyword}{false};}
\DoxyCodeLine{00784       \}}
\DoxyCodeLine{00785       \textcolor{keywordflow}{if} (boneIsVisible \&\& isCurrent) \{}
\DoxyCodeLine{00786         \textcolor{comment}{// draw change parent gadget}}
\DoxyCodeLine{00787         \textcolor{keywordtype}{double} r = pixelSize * 5;}
\DoxyCodeLine{00788         \textcolor{keywordflow}{if} (isPicking()) \{}
\DoxyCodeLine{00789           \textcolor{comment}{// int code = TD\_ResetParent +}}
\DoxyCodeLine{00790           \textcolor{comment}{// bone-\/>getStageObject()-\/>getId().getIndex();}}
\DoxyCodeLine{00791           glPushName(TD\_ChangeParent);}
\DoxyCodeLine{00792           tglDrawDisk(pm, r);}
\DoxyCodeLine{00793           glPopName();}
\DoxyCodeLine{00794         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00795           \textcolor{keywordflow}{if} (m\_device == TD\_ChangeParent) \{}
\DoxyCodeLine{00796             glColor4d(0.47 * alpha, 0.6 * alpha, 0.65 * alpha, alpha);}
\DoxyCodeLine{00797             r *= 1.5;}
\DoxyCodeLine{00798           \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00799             glColor4d(0.37 * alpha, 0.5 * alpha, 0.55 * alpha, alpha);}
\DoxyCodeLine{00800           glRectd(pm.x -\/ r, pm.y -\/ r, pm.x + r, pm.y + r);}
\DoxyCodeLine{00801           glColor3d(0, 0, 0);}
\DoxyCodeLine{00802           tglDrawRect(pm.x -\/ r, pm.y -\/ r, pm.x + r, pm.y + r);}
\DoxyCodeLine{00803         \}}
\DoxyCodeLine{00804       \}}
\DoxyCodeLine{00805     \}}
\DoxyCodeLine{00806   \}}
\DoxyCodeLine{00807   \textcolor{keywordflow}{for} (i = 0; i < (int)showBoneIndex.size(); i++) \{}
\DoxyCodeLine{00808     \mbox{\hyperlink{class_skeleton_1_1_bone}{Skeleton::Bone}} *bone = skeleton.getBone(showBoneIndex[i]);}
\DoxyCodeLine{00809     \textcolor{keywordflow}{if} (!m\_showOnlyActiveSkeleton.getValue() || bone-\/>isSelected())}
\DoxyCodeLine{00810       drawJoint(bone-\/>getCenter(),}
\DoxyCodeLine{00811                 currentObjectId == bone-\/>getStageObject()-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}() \&\&}
\DoxyCodeLine{00812                     currentHandle.find(\textcolor{stringliteral}{"{}H"{}}) != 0);}
\DoxyCodeLine{00813   \}}
\DoxyCodeLine{00814 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ab9934ce9e2dfcf8632262c8db7e4ab87}\label{class_skeleton_tool_ab9934ce9e2dfcf8632262c8db7e4ab87}} 
\index{SkeletonTool@{SkeletonTool}!getCursorId@{getCursorId}}
\index{getCursorId@{getCursorId}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{getCursorId()}{getCursorId()}}
{\footnotesize\ttfamily int Skeleton\+Tool\+::get\+Cursor\+Id (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Returns the type of cursor used by the tool. 

\begin{DoxySeeAlso}{See also}
For a list of cursor ids \mbox{\hyperlink{}{cursor.\+h}} 
\end{DoxySeeAlso}


Reimplemented from \mbox{\hyperlink{class_t_tool_a1768a57b8b6d1480618fd923fad15f1d}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01579                                     \{}
\DoxyCodeLine{01580   \textcolor{keywordflow}{switch} (m\_device) \{}
\DoxyCodeLine{01581   \textcolor{keywordflow}{case} TD\_None:}
\DoxyCodeLine{01582     \textcolor{keywordflow}{if} (m\_mode.getValue() == BUILD\_SKELETON)}
\DoxyCodeLine{01583       \textcolor{keywordflow}{break};}
\DoxyCodeLine{01584     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01585       \textcolor{keywordflow}{return} ToolCursor::RotCursor;}
\DoxyCodeLine{01586   \textcolor{keywordflow}{case} TD\_Translation:}
\DoxyCodeLine{01587     \textcolor{keywordflow}{return} ToolCursor::MoveCursor;}
\DoxyCodeLine{01588   \textcolor{keywordflow}{case} TD\_Rotation:}
\DoxyCodeLine{01589     \textcolor{keywordflow}{return} ToolCursor::RotCursor;}
\DoxyCodeLine{01590   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01591     \textcolor{keywordflow}{return} ToolCursor::StrokeSelectCursor;}
\DoxyCodeLine{01592   \}}
\DoxyCodeLine{01593   \textcolor{keywordflow}{return} ToolCursor::StrokeSelectCursor;}
\DoxyCodeLine{01594 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a45ce69f6ab62cecfd6f45c1fb92c360d}\label{class_skeleton_tool_a45ce69f6ab62cecfd6f45c1fb92c360d}} 
\index{SkeletonTool@{SkeletonTool}!getImageBoundingBox@{getImageBoundingBox}}
\index{getImageBoundingBox@{getImageBoundingBox}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{getImageBoundingBox()}{getImageBoundingBox()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::get\+Image\+Bounding\+Box (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{bbox,  }\item[{\mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff,  }\item[{int}]{frame,  }\item[{int}]{column\+Index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00819                                                         \{}
\DoxyCodeLine{00820   \mbox{\hyperlink{class_t_affine}{TAffine}} columnAff =}
\DoxyCodeLine{00821       \mbox{\hyperlink{class_t_tool_a8716e1462da359f4902c044a79f2d40d}{getXsheet}}()-\/>\mbox{\hyperlink{class_t_xsheet_abd766f516cac9898a2a952463618a9fe}{getPlacement}}(TStageObjectId::ColumnId(columnIndex), frame);}
\DoxyCodeLine{00822   \textcolor{comment}{// TAffine affine = getColumnMatrix(columnIndex);}}
\DoxyCodeLine{00823   \mbox{\hyperlink{class_t_xsh_cell}{TXshCell}} cell    = \mbox{\hyperlink{class_t_tool_a8716e1462da359f4902c044a79f2d40d}{getXsheet}}()-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(frame, columnIndex);}
\DoxyCodeLine{00824   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} image    = cell.\mbox{\hyperlink{class_t_xsh_cell_a20b623d308bc09b820ec6b116516f564}{getImage}}(\textcolor{keyword}{false});}
\DoxyCodeLine{00825   \mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}} ti  = image;}
\DoxyCodeLine{00826   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = image;}
\DoxyCodeLine{00827   \textcolor{keywordflow}{if} (ti) \{}
\DoxyCodeLine{00828     \mbox{\hyperlink{class_t_affine}{TAffine}} imageDpiAff;}
\DoxyCodeLine{00829     \textcolor{keywordflow}{if} (cell.m\_level-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}())}
\DoxyCodeLine{00830       imageDpiAff =}
\DoxyCodeLine{00831           getDpiAffine(cell.m\_level-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}(), cell.m\_frameId, \textcolor{keyword}{true});}
\DoxyCodeLine{00832     aff  = columnAff * imageDpiAff;}
\DoxyCodeLine{00833     bbox = ToonzImageUtils::convertRasterToWorld(convert(ti-\/>getBBox()), ti) *}
\DoxyCodeLine{00834            ti-\/>getSubsampling();}
\DoxyCodeLine{00835     ToolUtils::drawRect(bbox * ti-\/>getSubsampling(), TPixel32(200, 200, 200),}
\DoxyCodeLine{00836                         0x5555);}
\DoxyCodeLine{00837   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (vi) \{}
\DoxyCodeLine{00838     bbox = vi-\/>getBBox();}
\DoxyCodeLine{00839     aff  = columnAff;}
\DoxyCodeLine{00840   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00841     bbox = \mbox{\hyperlink{class_t_rect_t}{TRectD}}();}
\DoxyCodeLine{00842     aff  = \mbox{\hyperlink{class_t_affine}{TAffine}}();}
\DoxyCodeLine{00843   \}}
\DoxyCodeLine{00844 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_aa7045a45a9c8a9c5366f5619468dda88}\label{class_skeleton_tool_aa7045a45a9c8a9c5366f5619468dda88}} 
\index{SkeletonTool@{SkeletonTool}!getMagicLink@{getMagicLink}}
\index{getMagicLink@{getMagicLink}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{getMagicLink()}{getMagicLink()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_skeleton_subtools_1_1_magic_link}{Skeleton\+Subtools\+::\+Magic\+Link}} Skeleton\+Tool\+::get\+Magic\+Link (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{01541                                                                     \{}
\DoxyCodeLine{01542   assert(0 <= index \&\& index < (\textcolor{keywordtype}{int})m\_magicLinks.size());}
\DoxyCodeLine{01543   \textcolor{keywordflow}{return} m\_magicLinks[index];}
\DoxyCodeLine{01544 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a027633da979b4e2df0037f2cab4c277b}\label{class_skeleton_tool_a027633da979b4e2df0037f2cab4c277b}} 
\index{SkeletonTool@{SkeletonTool}!getMagicLinkCount@{getMagicLinkCount}}
\index{getMagicLinkCount@{getMagicLinkCount}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{getMagicLinkCount()}{getMagicLinkCount()}}
{\footnotesize\ttfamily int Skeleton\+Tool\+::get\+Magic\+Link\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00128 \{ \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})m\_magicLinks.size(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ae748a32b50b42ebf09e4731cee197813}\label{class_skeleton_tool_ae748a32b50b42ebf09e4731cee197813}} 
\index{SkeletonTool@{SkeletonTool}!getProperties@{getProperties}}
\index{getProperties@{getProperties}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{getProperties()}{getProperties()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_property_group}{TProperty\+Group}} $\ast$ Skeleton\+Tool\+::get\+Properties (\begin{DoxyParamCaption}\item[{int}]{target\+Type }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00136 \{ \textcolor{keywordflow}{return} \&m\_prop; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a3f2ef20d53e41345341a21cfbac74b00}\label{class_skeleton_tool_a3f2ef20d53e41345341a21cfbac74b00}} 
\index{SkeletonTool@{SkeletonTool}!getToolType@{getToolType}}
\index{getToolType@{getToolType}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{getToolType()}{getToolType()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296c}{Tool\+Type}} Skeleton\+Tool\+::get\+Tool\+Type (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00082 \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296cab1cf4660322ca2d4e5a4848bdbc049a9}{TTool::ColumnTool}}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a9fc89373829d12beee9deb30a857fc20}\label{class_skeleton_tool_a9fc89373829d12beee9deb30a857fc20}} 
\index{SkeletonTool@{SkeletonTool}!isGlobalKeyframesEnabled@{isGlobalKeyframesEnabled}}
\index{isGlobalKeyframesEnabled@{isGlobalKeyframesEnabled}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{isGlobalKeyframesEnabled()}{isGlobalKeyframesEnabled()}}
{\footnotesize\ttfamily bool Skeleton\+Tool\+::is\+Global\+Keyframes\+Enabled (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00283                                                   \{}
\DoxyCodeLine{00284   \textcolor{keywordflow}{return} m\_globalKeyframes.getValue();}
\DoxyCodeLine{00285 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ae0b5eebb96a0ffdb40b85285f0f0dfde}\label{class_skeleton_tool_ae0b5eebb96a0ffdb40b85285f0f0dfde}} 
\index{SkeletonTool@{SkeletonTool}!keyDown@{keyDown}}
\index{keyDown@{keyDown}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{keyDown()}{keyDown()}}
{\footnotesize\ttfamily bool Skeleton\+Tool\+::key\+Down (\begin{DoxyParamCaption}\item[{QKey\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00495                                            \{}
\DoxyCodeLine{00496   \mbox{\hyperlink{class_skeleton_subtools_1_1_change_drawing_tool}{ChangeDrawingTool}} tool(\textcolor{keyword}{this}, 0);}
\DoxyCodeLine{00497   \textcolor{keywordflow}{switch} (event-\/>key()) \{}
\DoxyCodeLine{00498   \textcolor{keywordflow}{case} Qt::Key\_Up:}
\DoxyCodeLine{00499     tool.changeDrawing(1);}
\DoxyCodeLine{00500     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00501   \textcolor{keywordflow}{case} Qt::Key\_Down:}
\DoxyCodeLine{00502     tool.changeDrawing(-\/1);}
\DoxyCodeLine{00503     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00504   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00505     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00506     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00507   \}}
\DoxyCodeLine{00508   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00509   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00510 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_af51fff8dcf410eec0d931b00284e3d28}\label{class_skeleton_tool_af51fff8dcf410eec0d931b00284e3d28}} 
\index{SkeletonTool@{SkeletonTool}!leftButtonDown@{leftButtonDown}}
\index{leftButtonDown@{leftButtonDown}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDown()}{leftButtonDown()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::left\+Button\+Down (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00325                                                                            \{}
\DoxyCodeLine{00326   m\_otherColumn        = -\/1;}
\DoxyCodeLine{00327   m\_otherColumnBBox    = \mbox{\hyperlink{class_t_rect_t}{TRectD}}();}
\DoxyCodeLine{00328   m\_otherColumnBBoxAff = \mbox{\hyperlink{class_t_affine}{TAffine}}();}
\DoxyCodeLine{00329   m\_labelPos           = \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0);}
\DoxyCodeLine{00330   m\_label              = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00331   \textcolor{comment}{// This undo block ends in leftButtonUp}}
\DoxyCodeLine{00332   TUndoManager::manager()-\/>beginBlock();}
\DoxyCodeLine{00333   \textcolor{keywordflow}{if} (!doesApply()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00334 }
\DoxyCodeLine{00335   assert(m\_dragTool == 0);}
\DoxyCodeLine{00336   m\_dragTool = 0;}
\DoxyCodeLine{00337 }
\DoxyCodeLine{00338   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{00339   \textcolor{keywordtype}{int} currentColumnIndex  = app-\/>getCurrentColumn()-\/>getColumnIndex();}
\DoxyCodeLine{00340   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh            = app-\/>getCurrentScene()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_ae3c828e3223fd809fd59189233d0576a}{getXsheet}}();}
\DoxyCodeLine{00341   \mbox{\hyperlink{class_t_point_t}{TPointD}} pos             = ppos;}
\DoxyCodeLine{00342 }
\DoxyCodeLine{00343   \textcolor{keywordtype}{int} selectedDevice = \mbox{\hyperlink{class_t_tool_ab04ed46786cf65fe4564d26ffa5d49c8}{pick}}(e.\mbox{\hyperlink{class_t_mouse_event_a05a3f2378eb2179d121e2e46766916de}{m\_pos}});}
\DoxyCodeLine{00344 }
\DoxyCodeLine{00345   \textcolor{comment}{// change drawing}}
\DoxyCodeLine{00346   \textcolor{keywordflow}{if} (selectedDevice == TD\_ChangeDrawing ||}
\DoxyCodeLine{00347       selectedDevice == TD\_IncrementDrawing ||}
\DoxyCodeLine{00348       selectedDevice == TD\_DecrementDrawing) \{}
\DoxyCodeLine{00349     \textcolor{keywordtype}{int} d = 0;}
\DoxyCodeLine{00350     \textcolor{keywordflow}{if} (selectedDevice == TD\_IncrementDrawing)}
\DoxyCodeLine{00351       d = 1;}
\DoxyCodeLine{00352     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (selectedDevice == TD\_DecrementDrawing)}
\DoxyCodeLine{00353       d = -\/1;}
\DoxyCodeLine{00354     m\_dragTool = \textcolor{keyword}{new} \mbox{\hyperlink{class_skeleton_subtools_1_1_change_drawing_tool}{ChangeDrawingTool}}(\textcolor{keyword}{this}, d);}
\DoxyCodeLine{00355     m\_dragTool-\/>leftButtonDown(ppos, e);}
\DoxyCodeLine{00356     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00357   \}}
\DoxyCodeLine{00358 }
\DoxyCodeLine{00359   \textcolor{comment}{// click on a hook: attach the current column via that hook}}
\DoxyCodeLine{00360   \textcolor{keywordflow}{if} (TD\_Hook <= selectedDevice \&\& selectedDevice < TD\_Hook + 50) \{}
\DoxyCodeLine{00361     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh         = app-\/>getCurrentXsheet()-\/>getXsheet();}
\DoxyCodeLine{00362     \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} objId = TStageObjectId::ColumnId(currentColumnIndex);}
\DoxyCodeLine{00363     \mbox{\hyperlink{class_t_point_t}{TPointD}} p0           = \mbox{\hyperlink{class_t_tool_a73c1b7f13eaea33e1d305636f44c4a64}{getCurrentColumnMatrix}}() * \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0);}
\DoxyCodeLine{00364     \mbox{\hyperlink{class_skeleton_subtools_1_1_hook_data}{HookData}} hook(xsh, currentColumnIndex, selectedDevice -\/ TD\_Hook, p0);}
\DoxyCodeLine{00365     TStageObjectCmd::setHandle(objId, hook.getHandle(),}
\DoxyCodeLine{00366                                app-\/>getCurrentXsheet());}
\DoxyCodeLine{00367     app-\/>getCurrentXsheet()-\/>notifyXsheetChanged();}
\DoxyCodeLine{00368     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00369     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00370   \}}
\DoxyCodeLine{00371 }
\DoxyCodeLine{00372   \textcolor{comment}{// magic link}}
\DoxyCodeLine{00373   \textcolor{keywordflow}{if} (TD\_MagicLink <= selectedDevice \&\&}
\DoxyCodeLine{00374       selectedDevice < TD\_MagicLink + (\textcolor{keywordtype}{int})m\_magicLinks.size()) \{}
\DoxyCodeLine{00375     magicLink(selectedDevice -\/ TD\_MagicLink);}
\DoxyCodeLine{00376     app-\/>getCurrentXsheet()-\/>notifyXsheetChanged();}
\DoxyCodeLine{00377     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00378   \}}
\DoxyCodeLine{00379 }
\DoxyCodeLine{00380   m\_device          = selectedDevice;}
\DoxyCodeLine{00381   \textcolor{keywordtype}{bool} justSelected = \textcolor{keyword}{false};}
\DoxyCodeLine{00382 }
\DoxyCodeLine{00383   \textcolor{keywordflow}{if} (m\_device < 0) \{}
\DoxyCodeLine{00384     \textcolor{comment}{// No gadget clicked.  Select the column}}
\DoxyCodeLine{00385     std::vector<int> columnIndexes;}
\DoxyCodeLine{00386     getViewer()-\/>posToColumnIndexes(e.\mbox{\hyperlink{class_t_mouse_event_a05a3f2378eb2179d121e2e46766916de}{m\_pos}}, columnIndexes, 5.0, \textcolor{keyword}{false});}
\DoxyCodeLine{00387     \textcolor{keywordflow}{if} (!columnIndexes.empty()) \{}
\DoxyCodeLine{00388       \textcolor{keywordtype}{int} columnIndex;}
\DoxyCodeLine{00389       columnIndex = columnIndexes.back();}
\DoxyCodeLine{00390 }
\DoxyCodeLine{00391       \textcolor{keywordflow}{if} (columnIndex >= 0 \&\& columnIndex != currentColumnIndex) \{}
\DoxyCodeLine{00392         \textcolor{keywordflow}{if} (!isColumnLocked(columnIndex)) \{}
\DoxyCodeLine{00393           pos = getMatrix() * pos;}
\DoxyCodeLine{00394           app-\/>getCurrentColumn()-\/>setColumnIndex(columnIndex);}
\DoxyCodeLine{00395           \mbox{\hyperlink{class_skeleton_tool_ae13ff691474b99b7720df4fee38d893c}{updateMatrix}}();}
\DoxyCodeLine{00396           currentColumnIndex = columnIndex;}
\DoxyCodeLine{00397           justSelected       = \textcolor{keyword}{true};}
\DoxyCodeLine{00398           pos                = getMatrix().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * pos;}
\DoxyCodeLine{00399         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00400           m\_label    = \textcolor{stringliteral}{"{}Column is locked"{}};}
\DoxyCodeLine{00401           m\_labelPos = pos;}
\DoxyCodeLine{00402         \}}
\DoxyCodeLine{00403       \}}
\DoxyCodeLine{00404     \}}
\DoxyCodeLine{00405   \}}
\DoxyCodeLine{00406 }
\DoxyCodeLine{00407   \textcolor{keywordflow}{if} (m\_device < 0) \{}
\DoxyCodeLine{00408     \textcolor{keywordflow}{if} (m\_mode.getValue() == INVERSE\_KINEMATICS)}
\DoxyCodeLine{00409       m\_device = TD\_InverseKinematics;}
\DoxyCodeLine{00410     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_mode.getValue() == ANIMATE)}
\DoxyCodeLine{00411       m\_device = TD\_Rotation;}
\DoxyCodeLine{00412   \}}
\DoxyCodeLine{00413 }
\DoxyCodeLine{00414   \textcolor{comment}{// lock/unlock: modalita IK}}
\DoxyCodeLine{00415   \textcolor{keywordflow}{if} (TD\_LockStageObject <= m\_device \&\& m\_device < TD\_LockStageObject + 1000) \{}
\DoxyCodeLine{00416     \mbox{\hyperlink{class_skeleton}{Skeleton}} *skeleton = \textcolor{keyword}{new} \mbox{\hyperlink{class_skeleton}{Skeleton}}();}
\DoxyCodeLine{00417     buildSkeleton(*skeleton, currentColumnIndex);}
\DoxyCodeLine{00418     \textcolor{keywordtype}{int} columnIndex = m\_device -\/ TD\_LockStageObject;}
\DoxyCodeLine{00419     \textcolor{keywordtype}{int} frame       = app-\/>getCurrentFrame()-\/>getFrame();}
\DoxyCodeLine{00420     \textcolor{keywordflow}{if} (skeleton-\/>getBoneByColumnIndex(columnIndex) ==}
\DoxyCodeLine{00421         skeleton-\/>getRootBone()) \{}
\DoxyCodeLine{00422       app-\/>getCurrentColumn()-\/>setColumnIndex(columnIndex);}
\DoxyCodeLine{00423       m\_device = TD\_Translation;}
\DoxyCodeLine{00424     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (e.isShiftPressed()) \{}
\DoxyCodeLine{00425       togglePinnedStatus(columnIndex, frame, e.isShiftPressed());}
\DoxyCodeLine{00426       \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00427       m\_dragTool = 0;}
\DoxyCodeLine{00428       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00429     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00430       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00431   \}}
\DoxyCodeLine{00432 }
\DoxyCodeLine{00433   \textcolor{keywordflow}{switch} (m\_device) \{}
\DoxyCodeLine{00434   \textcolor{keywordflow}{case} TD\_Center:}
\DoxyCodeLine{00435     m\_dragTool = \textcolor{keyword}{new} \mbox{\hyperlink{class_skeleton_subtools_1_1_drag_center_tool}{DragCenterTool}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00436     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00437   \textcolor{keywordflow}{case} TD\_Translation:}
\DoxyCodeLine{00438     m\_dragTool = \textcolor{keyword}{new} \mbox{\hyperlink{class_skeleton_subtools_1_1_drag_position_tool}{DragPositionTool}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00439     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00440   \textcolor{keywordflow}{case} TD\_Rotation:}
\DoxyCodeLine{00441     m\_dragTool = \textcolor{keyword}{new} \mbox{\hyperlink{class_skeleton_subtools_1_1_drag_rotation_tool}{DragRotationTool}}(\textcolor{keyword}{this}, justSelected);}
\DoxyCodeLine{00442     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00443   \textcolor{keywordflow}{case} TD\_ChangeParent:}
\DoxyCodeLine{00444     m\_dragTool = \textcolor{keyword}{new} \mbox{\hyperlink{class_skeleton_subtools_1_1_parent_change_tool}{ParentChangeTool}}(\textcolor{keyword}{this}, getViewer());}
\DoxyCodeLine{00445     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00446   \textcolor{keywordflow}{case} TD\_InverseKinematics: \{}
\DoxyCodeLine{00447     \mbox{\hyperlink{class_skeleton}{Skeleton}} *skeleton = \textcolor{keyword}{new} \mbox{\hyperlink{class_skeleton}{Skeleton}}();}
\DoxyCodeLine{00448     buildSkeleton(*skeleton, currentColumnIndex);}
\DoxyCodeLine{00449     m\_dragTool = \textcolor{keyword}{new} \mbox{\hyperlink{class_skeleton_subtools_1_1_i_k_tool}{IKTool}}(\textcolor{keyword}{this}, getViewer(), skeleton, currentColumnIndex);}
\DoxyCodeLine{00450     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00451   \}}
\DoxyCodeLine{00452   \}}
\DoxyCodeLine{00453 }
\DoxyCodeLine{00454   \textcolor{keywordflow}{if} (m\_dragTool) \{}
\DoxyCodeLine{00455     m\_dragTool-\/>leftButtonDown(pos, e);}
\DoxyCodeLine{00456     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00457   \}}
\DoxyCodeLine{00458 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a7ffe694847b477f52312ba737df77157}\label{class_skeleton_tool_a7ffe694847b477f52312ba737df77157}} 
\index{SkeletonTool@{SkeletonTool}!leftButtonDrag@{leftButtonDrag}}
\index{leftButtonDrag@{leftButtonDrag}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDrag()}{leftButtonDrag()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::left\+Button\+Drag (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00462                                                                           \{}
\DoxyCodeLine{00463   \textcolor{keywordflow}{if} (m\_dragTool) \{}
\DoxyCodeLine{00464     m\_dragTool-\/>leftButtonDrag(pos, e);}
\DoxyCodeLine{00465     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00466   \}}
\DoxyCodeLine{00467 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a5187c1857e716e6325383f0ebc682de6}\label{class_skeleton_tool_a5187c1857e716e6325383f0ebc682de6}} 
\index{SkeletonTool@{SkeletonTool}!leftButtonUp@{leftButtonUp}}
\index{leftButtonUp@{leftButtonUp}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{leftButtonUp()}{leftButtonUp()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::left\+Button\+Up (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00471                                                                         \{}
\DoxyCodeLine{00472   m\_label    = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00473   m\_labelPos = \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0);}
\DoxyCodeLine{00474 }
\DoxyCodeLine{00475   \textcolor{keywordflow}{if} (m\_dragTool) \{}
\DoxyCodeLine{00476     m\_dragTool-\/>leftButtonUp(pos, e);}
\DoxyCodeLine{00477     \textcolor{keyword}{delete} m\_dragTool;}
\DoxyCodeLine{00478     m\_dragTool = 0;}
\DoxyCodeLine{00479 }
\DoxyCodeLine{00480     TTool::getApplication()-\/>getCurrentXsheet()-\/>notifyXsheetChanged();}
\DoxyCodeLine{00481     TTool::getApplication()-\/>getCurrentObject()-\/>notifyObjectIdChanged(}
\DoxyCodeLine{00482         \textcolor{keyword}{false});  \textcolor{comment}{// Keyframes navigator reads this}}
\DoxyCodeLine{00483   \}}
\DoxyCodeLine{00484   \textcolor{keywordflow}{if} (m\_device == TD\_IncrementDrawing || m\_device == TD\_DecrementDrawing ||}
\DoxyCodeLine{00485       m\_device == TD\_ChangeDrawing)}
\DoxyCodeLine{00486     m\_device = \mbox{\hyperlink{class_t_tool_ab04ed46786cf65fe4564d26ffa5d49c8}{pick}}(e.\mbox{\hyperlink{class_t_mouse_event_a05a3f2378eb2179d121e2e46766916de}{m\_pos}});}
\DoxyCodeLine{00487   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00488     m\_device = -\/1;}
\DoxyCodeLine{00489   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00490   TUndoManager::manager()-\/>endBlock();}
\DoxyCodeLine{00491 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a97f375f52d91d03e75d7d00fe8337ccf}\label{class_skeleton_tool_a97f375f52d91d03e75d7d00fe8337ccf}} 
\index{SkeletonTool@{SkeletonTool}!magicLink@{magicLink}}
\index{magicLink@{magicLink}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{magicLink()}{magicLink()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::magic\+Link (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01548                                       \{}
\DoxyCodeLine{01549   \textcolor{keywordflow}{if} (index < 0 || index >= (\textcolor{keywordtype}{int})m\_magicLinks.size()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01550   \mbox{\hyperlink{class_skeleton_subtools_1_1_hook_data}{HookData}} h0             = m\_magicLinks[index].m\_h0;}
\DoxyCodeLine{01551   \mbox{\hyperlink{class_skeleton_subtools_1_1_hook_data}{HookData}} h1             = m\_magicLinks[index].m\_h1;}
\DoxyCodeLine{01552   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{01553   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh            = app-\/>getCurrentXsheet()-\/>getXsheet();}
\DoxyCodeLine{01554   \textcolor{keywordtype}{int} columnIndex         = app-\/>getCurrentColumn()-\/>getColumnIndex();}
\DoxyCodeLine{01555   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} \textcolor{keywordtype}{id}       = TStageObjectId::ColumnId(columnIndex);}
\DoxyCodeLine{01556   \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *obj       = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(\textcolor{keywordtype}{id});}
\DoxyCodeLine{01557 }
\DoxyCodeLine{01558   \textcolor{keywordtype}{int} parentColumnIndex    = h1.m\_columnIndex;}
\DoxyCodeLine{01559   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} parentId  = TStageObjectId::ColumnId(parentColumnIndex);}
\DoxyCodeLine{01560   std::string parentHandle = h1.getHandle();}
\DoxyCodeLine{01561 }
\DoxyCodeLine{01562   std::string handle = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01563   \textcolor{keywordflow}{if} (h0.m\_columnIndex < 0) \{}
\DoxyCodeLine{01564     handle = obj-\/>\mbox{\hyperlink{class_t_stage_object_aebee1ac99c0341fe053f272b93586ef2}{getHandle}}();}
\DoxyCodeLine{01565   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01566     handle = h0.getHandle();}
\DoxyCodeLine{01567   \}}
\DoxyCodeLine{01568 }
\DoxyCodeLine{01569   \textcolor{comment}{// TUndoManager *undoManager = TUndoManager::manager();}}
\DoxyCodeLine{01570   \textcolor{comment}{// undoManager-\/>beginBlock();}}
\DoxyCodeLine{01571   TStageObjectCmd::setHandle(\textcolor{keywordtype}{id}, handle, app-\/>getCurrentXsheet());}
\DoxyCodeLine{01572   TStageObjectCmd::setParent(\textcolor{keywordtype}{id}, parentId, parentHandle,}
\DoxyCodeLine{01573                              app-\/>getCurrentXsheet());}
\DoxyCodeLine{01574   \textcolor{comment}{// undoManager-\/>endBlock();}}
\DoxyCodeLine{01575 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ad4f6a7ed4da68ae7c89bf8157124e94d}\label{class_skeleton_tool_ad4f6a7ed4da68ae7c89bf8157124e94d}} 
\index{SkeletonTool@{SkeletonTool}!mouseMove@{mouseMove}}
\index{mouseMove@{mouseMove}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{mouseMove()}{mouseMove()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::mouse\+Move (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00315                                                                   \{}
\DoxyCodeLine{00316   \textcolor{keywordtype}{int} selectedDevice = \mbox{\hyperlink{class_t_tool_ab04ed46786cf65fe4564d26ffa5d49c8}{pick}}(e.\mbox{\hyperlink{class_t_mouse_event_a05a3f2378eb2179d121e2e46766916de}{m\_pos}});}
\DoxyCodeLine{00317   \textcolor{keywordflow}{if} (selectedDevice != m\_device) \{}
\DoxyCodeLine{00318     m\_device = selectedDevice;}
\DoxyCodeLine{00319     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00320   \}}
\DoxyCodeLine{00321 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_afdfb35d4fde1381212144ee85a60d45b}\label{class_skeleton_tool_afdfb35d4fde1381212144ee85a60d45b}} 
\index{SkeletonTool@{SkeletonTool}!onActivate@{onActivate}}
\index{onActivate@{onActivate}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{onActivate()}{onActivate()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::on\+Activate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback invoked whenever the tool activates. 



Reimplemented from \mbox{\hyperlink{class_t_tool_ac286a2681633b4db6106596b4f54e53b}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01516                               \{}
\DoxyCodeLine{01517   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{01518   \textcolor{keywordflow}{if} (m\_firstTime) \{}
\DoxyCodeLine{01519     m\_globalKeyframes.setValue(SkeletonGlobalKeyFrame ? 1 : 0);}
\DoxyCodeLine{01520     m\_mode.setValue(BUILD\_SKELETON);}
\DoxyCodeLine{01521     \textcolor{comment}{// m\_ikEnabled.setValue(SkeletonInverseKinematics ? 1 : 0);}}
\DoxyCodeLine{01522     m\_firstTime = \textcolor{keyword}{false};}
\DoxyCodeLine{01523   \}}
\DoxyCodeLine{01524   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} objId = app-\/>getCurrentObject()-\/>getObjectId();}
\DoxyCodeLine{01525   \textcolor{keywordflow}{if} (objId == TStageObjectId::NoneId) \{}
\DoxyCodeLine{01526     \textcolor{keywordtype}{int} index = app-\/>getCurrentColumn()-\/>getColumnIndex();}
\DoxyCodeLine{01527     objId     = TStageObjectId::ColumnId(index);}
\DoxyCodeLine{01528   \}}
\DoxyCodeLine{01529   \textcolor{comment}{//  app-\/>editStageObject(objId);}}
\DoxyCodeLine{01530 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ab4e6e3c2284c76e90a849bc41f3fc869}\label{class_skeleton_tool_ab4e6e3c2284c76e90a849bc41f3fc869}} 
\index{SkeletonTool@{SkeletonTool}!onDeactivate@{onDeactivate}}
\index{onDeactivate@{onDeactivate}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{onDeactivate()}{onDeactivate()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::on\+Deactivate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback for tool deactivation, includes tool switch. 



Reimplemented from \mbox{\hyperlink{class_t_tool_a00fee58728c1e12fb50846f47d7e9f5e}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01534                                 \{}
\DoxyCodeLine{01535   \textcolor{comment}{// m\_selection.selectNone();}}
\DoxyCodeLine{01536   \textcolor{comment}{// TSelection::setCurrent(0);}}
\DoxyCodeLine{01537 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ae7be52da2d9982a0319e01abf3453877}\label{class_skeleton_tool_ae7be52da2d9982a0319e01abf3453877}} 
\index{SkeletonTool@{SkeletonTool}!onEnter@{onEnter}}
\index{onEnter@{onEnter}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{onEnter()}{onEnter()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::on\+Enter (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Callback for the mouse entering the viewer area. 



Reimplemented from \mbox{\hyperlink{class_t_tool_a3e775cfcd05aa3c35048b11fa40ab3e4}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00088 \{\}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_afc4e4130bd22451d107deb7461d236e4}\label{class_skeleton_tool_afc4e4130bd22451d107deb7461d236e4}} 
\index{SkeletonTool@{SkeletonTool}!onImageChanged@{onImageChanged}}
\index{onImageChanged@{onImageChanged}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{onImageChanged()}{onImageChanged()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::on\+Image\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Notifies changes in the image in use. 



Reimplemented from \mbox{\hyperlink{class_t_tool_aaf1e021290e74c1b085e4b095668e1ed}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00094 \{ \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(); \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00540}{TTool\+::invalidate()}}.

\mbox{\Hypertarget{class_skeleton_tool_a60413502350c6db6f81ec5359aa039d0}\label{class_skeleton_tool_a60413502350c6db6f81ec5359aa039d0}} 
\index{SkeletonTool@{SkeletonTool}!onPropertyChanged@{onPropertyChanged}}
\index{onPropertyChanged@{onPropertyChanged}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{onPropertyChanged()}{onPropertyChanged()}}
{\footnotesize\ttfamily bool Skeleton\+Tool\+::on\+Property\+Changed (\begin{DoxyParamCaption}\item[{std\+::string}]{property\+Name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

\begin{DoxyVerb} Does the tasks associated to changes in \p propertyName and returns \p
\end{DoxyVerb}
 true; Does the tasks associated to changes in {\ttfamily property\+Name} and returns {\ttfamily true}. 

Reimplemented from \mbox{\hyperlink{class_t_tool_a06694e0586f807c34b18e16341aa9ee2}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00274                                                            \{}
\DoxyCodeLine{00275   SkeletonGlobalKeyFrame = (int)(m\_globalKeyframes.getValue());}
\DoxyCodeLine{00276   \textcolor{comment}{// SkeletonInverseKinematics=(int)(m\_ikEnabled.getValue());}}
\DoxyCodeLine{00277   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00278   \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00279 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00540}{TTool\+::invalidate()}}.

\mbox{\Hypertarget{class_skeleton_tool_a2dc86035e69cdf703d844d0e1aa139ac}\label{class_skeleton_tool_a2dc86035e69cdf703d844d0e1aa139ac}} 
\index{SkeletonTool@{SkeletonTool}!reset@{reset}}
\index{reset@{reset}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::reset (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00096 \{ m\_temporaryPinnedColumns.clear(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ac25d2969f29f9ca304a86922dc3a8b90}\label{class_skeleton_tool_ac25d2969f29f9ca304a86922dc3a8b90}} 
\index{SkeletonTool@{SkeletonTool}!resetParentProbe@{resetParentProbe}}
\index{resetParentProbe@{resetParentProbe}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{resetParentProbe()}{resetParentProbe()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::reset\+Parent\+Probe (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00117 \{ m\_parentProbeEnabled = \textcolor{keyword}{false}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_aab51b11cc27702102ebcf98f2404fccc}\label{class_skeleton_tool_aab51b11cc27702102ebcf98f2404fccc}} 
\index{SkeletonTool@{SkeletonTool}!select@{select}}
\index{select@{select}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{select()}{select()}}
{\footnotesize\ttfamily bool Skeleton\+Tool\+::select (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_selection}{TSelection}} $\ast$}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00140 \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a2d5842f00dc795800c0ea28674b4ea5e}\label{class_skeleton_tool_a2d5842f00dc795800c0ea28674b4ea5e}} 
\index{SkeletonTool@{SkeletonTool}!setParentProbe@{setParentProbe}}
\index{setParentProbe@{setParentProbe}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{setParentProbe()}{setParentProbe()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::set\+Parent\+Probe (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{parent\+Probe }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00113                                                   \{}
\DoxyCodeLine{00114     m\_parentProbe        = parentProbe;}
\DoxyCodeLine{00115     m\_parentProbeEnabled = \textcolor{keyword}{true};}
\DoxyCodeLine{00116   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_a6753b1be6f5d223037097dab1dd74040}\label{class_skeleton_tool_a6753b1be6f5d223037097dab1dd74040}} 
\index{SkeletonTool@{SkeletonTool}!setTemporaryPinnedColumns@{setTemporaryPinnedColumns}}
\index{setTemporaryPinnedColumns@{setTemporaryPinnedColumns}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{setTemporaryPinnedColumns()}{setTemporaryPinnedColumns()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::set\+Temporary\+Pinned\+Columns (\begin{DoxyParamCaption}\item[{const std\+::set$<$ int $>$ \&}]{tmp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00146                                                          \{}
\DoxyCodeLine{00147     m\_temporaryPinnedColumns = tmp;}
\DoxyCodeLine{00148   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ad1a6af3985887a117fc613ee419f2eb0}\label{class_skeleton_tool_ad1a6af3985887a117fc613ee419f2eb0}} 
\index{SkeletonTool@{SkeletonTool}!togglePinnedStatus@{togglePinnedStatus}}
\index{togglePinnedStatus@{togglePinnedStatus}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{togglePinnedStatus()}{togglePinnedStatus()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::toggle\+Pinned\+Status (\begin{DoxyParamCaption}\item[{int}]{column\+Index,  }\item[{int}]{frame,  }\item[{bool}]{shift\+Pressed }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00637                                                          \{}
\DoxyCodeLine{00638   \mbox{\hyperlink{class_skeleton}{Skeleton}} skeleton;}
\DoxyCodeLine{00639   buildSkeleton(skeleton, columnIndex);}
\DoxyCodeLine{00640   \textcolor{keywordflow}{if} (!skeleton.getRootBone() || !skeleton.getRootBone()-\/>getStageObject())}
\DoxyCodeLine{00641     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00642   \mbox{\hyperlink{class_skeleton_1_1_bone}{Skeleton::Bone}} *bone = skeleton.getBoneByColumnIndex(columnIndex);}
\DoxyCodeLine{00643   assert(bone);}
\DoxyCodeLine{00644   \textcolor{keywordflow}{if} (!bone) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00645 }
\DoxyCodeLine{00646   \mbox{\hyperlink{class_toggle_pinned_status_undo}{TogglePinnedStatusUndo}} *undo = \textcolor{keyword}{new} \mbox{\hyperlink{class_toggle_pinned_status_undo}{TogglePinnedStatusUndo}}(\textcolor{keyword}{this}, frame);}
\DoxyCodeLine{00647   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < skeleton.getBoneCount(); i++) \{}
\DoxyCodeLine{00648     \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *obj = skeleton.getBone(i)-\/>getStageObject();}
\DoxyCodeLine{00649     \textcolor{keywordflow}{if} (obj) \{}
\DoxyCodeLine{00650       undo-\/>addBoneId(obj-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}());}
\DoxyCodeLine{00651       obj-\/>setKeyframeWithoutUndo(frame);}
\DoxyCodeLine{00652     \}}
\DoxyCodeLine{00653   \}}
\DoxyCodeLine{00654 }
\DoxyCodeLine{00655   getApplication()-\/>getCurrentXsheet()-\/>notifyXsheetChanged();}
\DoxyCodeLine{00656   getApplication()-\/>getCurrentObject()-\/>notifyObjectIdChanged(\textcolor{keyword}{false});}
\DoxyCodeLine{00657 }
\DoxyCodeLine{00658   undo-\/>setOldTemp(m\_temporaryPinnedColumns);}
\DoxyCodeLine{00659   \textcolor{keywordtype}{bool} isTemporaryPinned = m\_temporaryPinnedColumns.count(columnIndex) > 0;}
\DoxyCodeLine{00660   \textcolor{keywordflow}{if} (shiftPressed || isTemporaryPinned) \{}
\DoxyCodeLine{00661     \textcolor{keywordflow}{if} (isTemporaryPinned)}
\DoxyCodeLine{00662       m\_temporaryPinnedColumns.erase(columnIndex);}
\DoxyCodeLine{00663     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00664       m\_temporaryPinnedColumns.insert(columnIndex);}
\DoxyCodeLine{00665   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00666     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh = TTool::getApplication()-\/>getCurrentXsheet()-\/>getXsheet();}
\DoxyCodeLine{00667     \mbox{\hyperlink{class_t_affine}{TAffine}} placement =}
\DoxyCodeLine{00668         xsh-\/>\mbox{\hyperlink{class_t_xsheet_abd766f516cac9898a2a952463618a9fe}{getPlacement}}(bone-\/>getStageObject()-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}(), frame);}
\DoxyCodeLine{00669 }
\DoxyCodeLine{00670     \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} rootId = skeleton.getRootBone()-\/>getStageObject()-\/>getId();}
\DoxyCodeLine{00671     \mbox{\hyperlink{class_t_affine}{TAffine}} rootPlacement = xsh-\/>\mbox{\hyperlink{class_t_xsheet_abd766f516cac9898a2a952463618a9fe}{getPlacement}}(rootId, frame);}
\DoxyCodeLine{00672 }
\DoxyCodeLine{00673     \textcolor{keywordtype}{int} pinnedStatus = bone-\/>getPinnedStatus();}
\DoxyCodeLine{00674     \textcolor{keywordflow}{if} (pinnedStatus != Skeleton::Bone::PINNED) \{}
\DoxyCodeLine{00675       \textcolor{keywordtype}{int} oldPinned = -\/1;}
\DoxyCodeLine{00676       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < skeleton.getBoneCount(); i++) \{}
\DoxyCodeLine{00677         \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *obj = skeleton.getBone(i)-\/>getStageObject();}
\DoxyCodeLine{00678         \textcolor{keywordflow}{if} (obj-\/>getPinnedRangeSet()-\/>isPinned(frame)) \{}
\DoxyCodeLine{00679           oldPinned = i;}
\DoxyCodeLine{00680           \textcolor{keywordflow}{break};}
\DoxyCodeLine{00681         \}}
\DoxyCodeLine{00682       \}}
\DoxyCodeLine{00683 }
\DoxyCodeLine{00684       \textcolor{keywordtype}{int} lastFrame = 1000000;}
\DoxyCodeLine{00685       \textcolor{keywordflow}{if} (oldPinned >= 0) \{}
\DoxyCodeLine{00686         assert(skeleton.getBone(oldPinned) != bone);}
\DoxyCodeLine{00687         \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *obj = skeleton.getBone(oldPinned)-\/>getStageObject();}
\DoxyCodeLine{00688         \textcolor{keyword}{const} \mbox{\hyperlink{struct_t_pinned_range_set_1_1_range}{TPinnedRangeSet::Range}} *range =}
\DoxyCodeLine{00689             obj-\/>getPinnedRangeSet()-\/>getRange(frame);}
\DoxyCodeLine{00690         assert(range \&\& range-\/>first <= frame \&\& frame <= range-\/>second);}
\DoxyCodeLine{00691         lastFrame                 = range-\/>second;}
\DoxyCodeLine{00692         \mbox{\hyperlink{class_t_pinned_range_set}{TPinnedRangeSet}} *rangeSet = obj-\/>getPinnedRangeSet();}
\DoxyCodeLine{00693         rangeSet-\/>removeRange(frame, range-\/>second);}
\DoxyCodeLine{00694         obj-\/>\mbox{\hyperlink{class_t_stage_object_add34b90eaaa8ff75b9ed098c4d9bec27}{invalidate}}();}
\DoxyCodeLine{00695         undo-\/>setOldRange(oldPinned, frame, range-\/>second,}
\DoxyCodeLine{00696                           rangeSet-\/>getPlacement());}
\DoxyCodeLine{00697       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00698         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < skeleton.getBoneCount(); i++) \{}
\DoxyCodeLine{00699           \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *obj = skeleton.getBone(i)-\/>getStageObject();}
\DoxyCodeLine{00700           \textcolor{keyword}{const} \mbox{\hyperlink{struct_t_pinned_range_set_1_1_range}{TPinnedRangeSet::Range}} *range =}
\DoxyCodeLine{00701               obj-\/>getPinnedRangeSet()-\/>getNextRange(frame);}
\DoxyCodeLine{00702           \textcolor{keywordflow}{if} (range) \{}
\DoxyCodeLine{00703             assert(range-\/>first > frame);}
\DoxyCodeLine{00704             \textcolor{keywordflow}{if} (range-\/>first -\/ 1 < lastFrame) lastFrame = range-\/>first -\/ 1;}
\DoxyCodeLine{00705           \}}
\DoxyCodeLine{00706         \}}
\DoxyCodeLine{00707       \}}
\DoxyCodeLine{00708 }
\DoxyCodeLine{00709       \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *obj         = bone-\/>getStageObject();}
\DoxyCodeLine{00710       \mbox{\hyperlink{class_t_pinned_range_set}{TPinnedRangeSet}} *rangeSet = obj-\/>getPinnedRangeSet();}
\DoxyCodeLine{00711       rangeSet-\/>setRange(frame, lastFrame);}
\DoxyCodeLine{00712       \textcolor{keywordflow}{if} (frame == 0) \{}
\DoxyCodeLine{00713         \textcolor{comment}{// this code should be moved elsewhere, possibly in the stageobject}}
\DoxyCodeLine{00714         \textcolor{comment}{// implementation}}
\DoxyCodeLine{00715         \textcolor{comment}{// the idea is to remove the normal}}
\DoxyCodeLine{00716         \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *rootObj = skeleton.getRootBone()-\/>getStageObject();}
\DoxyCodeLine{00717         rootObj-\/>\mbox{\hyperlink{class_t_stage_object_a47bbc7e7d5b5334d6b0c5b6b265570c9}{setStatus}}(\mbox{\hyperlink{class_t_stage_object_a4c228002778d80aa07ed34abde5dec84ac9c6e1fed425869b235ea7ef9c820024}{TStageObject::XY}});}
\DoxyCodeLine{00718         placement = rootObj-\/>getPlacement(0).\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * placement;}
\DoxyCodeLine{00719         rootObj-\/>\mbox{\hyperlink{class_t_stage_object_a47bbc7e7d5b5334d6b0c5b6b265570c9}{setStatus}}(\mbox{\hyperlink{class_t_stage_object_a4c228002778d80aa07ed34abde5dec84a7e9784777840246d5ed3b4aba27c7d26}{TStageObject::IK}});}
\DoxyCodeLine{00720         rangeSet-\/>setPlacement(placement);}
\DoxyCodeLine{00721         rootObj-\/>\mbox{\hyperlink{class_t_stage_object_add34b90eaaa8ff75b9ed098c4d9bec27}{invalidate}}();}
\DoxyCodeLine{00722       \}}
\DoxyCodeLine{00723       undo-\/>setNewRange(bone-\/>getColumnIndex(), frame, lastFrame,}
\DoxyCodeLine{00724                         rangeSet-\/>getPlacement());}
\DoxyCodeLine{00725     \}}
\DoxyCodeLine{00726   \}}
\DoxyCodeLine{00727   undo-\/>setNewTemp(m\_temporaryPinnedColumns);}
\DoxyCodeLine{00728   TUndoManager::manager()-\/>add(undo);}
\DoxyCodeLine{00729 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ae13ff691474b99b7720df4fee38d893c}\label{class_skeleton_tool_ae13ff691474b99b7720df4fee38d893c}} 
\index{SkeletonTool@{SkeletonTool}!updateMatrix@{updateMatrix}}
\index{updateMatrix@{updateMatrix}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{updateMatrix()}{updateMatrix()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::update\+Matrix (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Updates the current matrix transformation with the actual column matrix transformation. \begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_t_tool_a73c1b7f13eaea33e1d305636f44c4a64}{get\+Current\+Column\+Matrix()}}. 
\end{DoxySeeAlso}


Reimplemented from \mbox{\hyperlink{class_t_tool_a1a5f380464a6b36947212e2f8d5b314c}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00138 \{ setMatrix(getCurrentObjectParentMatrix()); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_skeleton_tool_ae5f1c4739c3ce4ac417f85c45ae7f018}\label{class_skeleton_tool_ae5f1c4739c3ce4ac417f85c45ae7f018}} 
\index{SkeletonTool@{SkeletonTool}!updateTranslation@{updateTranslation}}
\index{updateTranslation@{updateTranslation}!SkeletonTool@{SkeletonTool}}
\doxysubsubsection{\texorpdfstring{updateTranslation()}{updateTranslation()}}
{\footnotesize\ttfamily void Skeleton\+Tool\+::update\+Translation (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00289                                      \{}
\DoxyCodeLine{00290   \textcolor{comment}{// m\_ikEnabled.setQStringName(tr("{}Inverse Kinematics"{}));}}
\DoxyCodeLine{00291   m\_showOnlyActiveSkeleton.setQStringName(tr(\textcolor{stringliteral}{"{}Show Only Active Skeleton"{}}));}
\DoxyCodeLine{00292   m\_globalKeyframes.setQStringName(tr(\textcolor{stringliteral}{"{}Global Key"{}}));}
\DoxyCodeLine{00293   m\_mode.setQStringName(tr(\textcolor{stringliteral}{"{}Mode:"{}}));}
\DoxyCodeLine{00294   m\_mode.setItemUIName(BUILD\_SKELETON, tr(\textcolor{stringliteral}{"{}Build Skeleton"{}}));}
\DoxyCodeLine{00295   m\_mode.setItemUIName(ANIMATE, tr(\textcolor{stringliteral}{"{}Animate"{}}));}
\DoxyCodeLine{00296   m\_mode.setItemUIName(INVERSE\_KINEMATICS, tr(\textcolor{stringliteral}{"{}Inverse Kinematics"{}}));}
\DoxyCodeLine{00297 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/tnztools/skeletontool.\+h\item 
E\+:/opentoonz/toonz/sources/tnztools/skeletontool.\+cpp\end{DoxyCompactItemize}
