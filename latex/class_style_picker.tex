\hypertarget{class_style_picker}{}\doxysection{Style\+Picker Class Reference}
\label{class_style_picker}\index{StylePicker@{StylePicker}}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_style_picker_a15b689f3720dc87a4b0b54361693891d}{Style\+Picker}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \&image)
\item 
\mbox{\hyperlink{class_style_picker_a61089ee56c8a38223c2ce06aad78fdc7}{Style\+Picker}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \&image, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&palette)
\item 
int \mbox{\hyperlink{class_style_picker_a76b2ce70572e5b42d9dbd1e4d0e4a4d8}{pick\+Style\+Id}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&point, double radius, double scale2, int mode=2) const
\item 
int \mbox{\hyperlink{class_style_picker_ab1ec31ad774c6b8f1cb938565f3f512f}{pick\+Tone}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos) const
\item 
TPixel32 \mbox{\hyperlink{class_style_picker_aaa49e810f916b5d5b482e55fec355ad4}{pick\+Color}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&point, double radius, double scale2) const
\item 
TPixel64 \mbox{\hyperlink{class_style_picker_a5d8de04d633ed3b69c0977f6cddc8657}{pick\+Color16}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&point, double radius, double scale2) const
\item 
TPixel32 \mbox{\hyperlink{class_style_picker_ae1ae4b04adbddf2e1b2b8459fc40a11c}{pick\+Average\+Color}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect) const
\item 
TPixel64 \mbox{\hyperlink{class_style_picker_a168754ae4179130b1fdaa6a72614ca0a}{pick\+Average\+Color16}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect) const
\item 
TPixel32 \mbox{\hyperlink{class_style_picker_a6daaa8088f811c51c261765fbcab52aa}{pick\+Color}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&area) const
\item 
TPixel32 \mbox{\hyperlink{class_style_picker_a4c4c4d46469ec6c61326c42ae6b43b4c}{pick\+Color}} (\mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$stroke) const
\item 
\mbox{\hyperlink{class_t_point_t}{TPoint}} \mbox{\hyperlink{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}{get\+Raster\+Point}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p) const
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_style_picker_ac5953d32f2d7aa59c8d299974ec18d70}\label{class_style_picker_ac5953d32f2d7aa59c8d299974ec18d70}} 
\index{StylePicker@{StylePicker}!StylePicker@{StylePicker}}
\index{StylePicker@{StylePicker}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{StylePicker()}{StylePicker()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily Style\+Picker\+::\+Style\+Picker (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00027 \{\}}

\end{DoxyCode}
\mbox{\Hypertarget{class_style_picker_a15b689f3720dc87a4b0b54361693891d}\label{class_style_picker_a15b689f3720dc87a4b0b54361693891d}} 
\index{StylePicker@{StylePicker}!StylePicker@{StylePicker}}
\index{StylePicker@{StylePicker}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{StylePicker()}{StylePicker()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily Style\+Picker\+::\+Style\+Picker (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \&}]{image }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00021     : m\_image(image), m\_palette(image-\/>getPalette()) \{\}}

\end{DoxyCode}
\mbox{\Hypertarget{class_style_picker_a61089ee56c8a38223c2ce06aad78fdc7}\label{class_style_picker_a61089ee56c8a38223c2ce06aad78fdc7}} 
\index{StylePicker@{StylePicker}!StylePicker@{StylePicker}}
\index{StylePicker@{StylePicker}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{StylePicker()}{StylePicker()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily Style\+Picker\+::\+Style\+Picker (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \&}]{image,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{palette }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00026     : m\_image(image), m\_palette(palette) \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}\label{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}} 
\index{StylePicker@{StylePicker}!getRasterPoint@{getRasterPoint}}
\index{getRasterPoint@{getRasterPoint}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{getRasterPoint()}{getRasterPoint()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPoint}} Style\+Picker\+::get\+Raster\+Point (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p }\end{DoxyParamCaption}) const}

dpi\+Scale.\+get\+Sx()),

dpi\+Scale.\+get\+Sy()));
\begin{DoxyCode}{0}
\DoxyCodeLine{00030                                                          \{}
\DoxyCodeLine{00031   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}} ti = m\_image) \{}
\DoxyCodeLine{00032     \textcolor{comment}{// DpiScale dpiScale(ti);}}
\DoxyCodeLine{00033     \mbox{\hyperlink{class_t_dimension_t}{TDimension}} size = ti-\/>getSize();}
\DoxyCodeLine{00034     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_point_t}{TPoint}}(tround(0.5 * size.lx + p.x),   }
\DoxyCodeLine{00035                   tround(0.5 * size.ly + p.y));  }
\DoxyCodeLine{00036   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri = m\_image) \{}
\DoxyCodeLine{00037     \textcolor{comment}{// DpiScale dpiScale(ri);}}
\DoxyCodeLine{00038     \mbox{\hyperlink{class_t_dimension_t}{TDimension}} size = ri-\/>getRaster()-\/>getSize();}
\DoxyCodeLine{00039     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_point_t}{TPoint}}(tround(0.5 * size.lx + p.x),   \textcolor{comment}{// /dpiScale.getSx()),}}
\DoxyCodeLine{00040                   tround(0.5 * size.ly + p.y));  \textcolor{comment}{// /dpiScale.getSy()));}}
\DoxyCodeLine{00041   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00042     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_point_t}{TPoint}}(tround(p.x), tround(p.y));}
\DoxyCodeLine{00043 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00287}{Color\+Model\+Viewer\+::pick()}}, and \mbox{\hyperlink{l00048}{pick\+Style\+Id()}}.

\mbox{\Hypertarget{class_style_picker_ae1ae4b04adbddf2e1b2b8459fc40a11c}\label{class_style_picker_ae1ae4b04adbddf2e1b2b8459fc40a11c}} 
\index{StylePicker@{StylePicker}!pickAverageColor@{pickAverageColor}}
\index{pickAverageColor@{pickAverageColor}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{pickAverageColor()}{pickAverageColor()}}
{\footnotesize\ttfamily TPixel32 Style\+Picker\+::pick\+Average\+Color (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00196                                                                \{}
\DoxyCodeLine{00197   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri = m\_image;}
\DoxyCodeLine{00198   assert(ri);}
\DoxyCodeLine{00199   \textcolor{keywordflow}{if} (!!ri) \{}
\DoxyCodeLine{00200     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} raster;}
\DoxyCodeLine{00201     raster = ri-\/>getRaster();}
\DoxyCodeLine{00202 }
\DoxyCodeLine{00203     \mbox{\hyperlink{class_t_point_t}{TPoint}} topLeft     = \mbox{\hyperlink{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}{getRasterPoint}}(rect.getP00());}
\DoxyCodeLine{00204     \mbox{\hyperlink{class_t_point_t}{TPoint}} bottomRight = \mbox{\hyperlink{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}{getRasterPoint}}(rect.getP11());}
\DoxyCodeLine{00205 }
\DoxyCodeLine{00206     \textcolor{keywordflow}{if} (!raster-\/>getBounds().overlaps(\mbox{\hyperlink{class_t_rect_t}{TRect}}(topLeft, bottomRight)))}
\DoxyCodeLine{00207       \textcolor{keywordflow}{return} TPixel32::Transparent;}
\DoxyCodeLine{00208 }
\DoxyCodeLine{00209     topLeft.x     = std::max(0, topLeft.x);}
\DoxyCodeLine{00210     topLeft.y     = std::max(0, topLeft.y);}
\DoxyCodeLine{00211     bottomRight.x = std::min(raster-\/>getLx(), bottomRight.x);}
\DoxyCodeLine{00212     bottomRight.y = std::min(raster-\/>getLy(), bottomRight.y);}
\DoxyCodeLine{00213 }
\DoxyCodeLine{00214     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} raster32 = raster;}
\DoxyCodeLine{00215     assert(raster32);}
\DoxyCodeLine{00216     \textcolor{keywordflow}{if} (raster32) \{}
\DoxyCodeLine{00217       UINT r = 0, g = 0, b = 0, m = 0, size = 0;}
\DoxyCodeLine{00218       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = topLeft.y; y < bottomRight.y; y++) \{}
\DoxyCodeLine{00219         TPixel32 *p = \&raster32-\/>pixels(y)[topLeft.x];}
\DoxyCodeLine{00220         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = topLeft.x; x < bottomRight.x; x++, p++) \{}
\DoxyCodeLine{00221           r += p-\/>r;}
\DoxyCodeLine{00222           g += p-\/>g;}
\DoxyCodeLine{00223           b += p-\/>b;}
\DoxyCodeLine{00224           m += p-\/>m;}
\DoxyCodeLine{00225           size++;}
\DoxyCodeLine{00226         \}}
\DoxyCodeLine{00227       \}}
\DoxyCodeLine{00228 }
\DoxyCodeLine{00229       \textcolor{keywordflow}{if} (size)}
\DoxyCodeLine{00230         \textcolor{keywordflow}{return} TPixel32(r / size, g / size, b / size, m / size);}
\DoxyCodeLine{00231       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00232         \textcolor{keywordflow}{return} TPixel32::Transparent;}
\DoxyCodeLine{00233     \}}
\DoxyCodeLine{00234   \}}
\DoxyCodeLine{00235   \textcolor{keywordflow}{return} TPixel32::Transparent;}
\DoxyCodeLine{00236 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_style_picker_a168754ae4179130b1fdaa6a72614ca0a}\label{class_style_picker_a168754ae4179130b1fdaa6a72614ca0a}} 
\index{StylePicker@{StylePicker}!pickAverageColor16@{pickAverageColor16}}
\index{pickAverageColor16@{pickAverageColor16}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{pickAverageColor16()}{pickAverageColor16()}}
{\footnotesize\ttfamily TPixel64 Style\+Picker\+::pick\+Average\+Color16 (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00240                                                                  \{}
\DoxyCodeLine{00241   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri = m\_image;}
\DoxyCodeLine{00242   assert(ri);}
\DoxyCodeLine{00243   \textcolor{keywordflow}{if} (!ri) \textcolor{keywordflow}{return} TPixel64::Transparent;}
\DoxyCodeLine{00244   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} raster;}
\DoxyCodeLine{00245   raster = ri-\/>getRaster();}
\DoxyCodeLine{00246   \textcolor{keywordflow}{if} (raster-\/>getPixelSize() != 8) \textcolor{keywordflow}{return} TPixel64::Transparent;}
\DoxyCodeLine{00247 }
\DoxyCodeLine{00248   \mbox{\hyperlink{class_t_point_t}{TPoint}} topLeft     = \mbox{\hyperlink{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}{getRasterPoint}}(rect.getP00());}
\DoxyCodeLine{00249   \mbox{\hyperlink{class_t_point_t}{TPoint}} bottomRight = \mbox{\hyperlink{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}{getRasterPoint}}(rect.getP11());}
\DoxyCodeLine{00250 }
\DoxyCodeLine{00251   \textcolor{keywordflow}{if} (!raster-\/>getBounds().overlaps(\mbox{\hyperlink{class_t_rect_t}{TRect}}(topLeft, bottomRight)))}
\DoxyCodeLine{00252     \textcolor{keywordflow}{return} TPixel64::Transparent;}
\DoxyCodeLine{00253 }
\DoxyCodeLine{00254   topLeft.x     = std::max(0, topLeft.x);}
\DoxyCodeLine{00255   topLeft.y     = std::max(0, topLeft.y);}
\DoxyCodeLine{00256   bottomRight.x = std::min(raster-\/>getLx(), bottomRight.x);}
\DoxyCodeLine{00257   bottomRight.y = std::min(raster-\/>getLy(), bottomRight.y);}
\DoxyCodeLine{00258 }
\DoxyCodeLine{00259   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} raster64 = raster;}
\DoxyCodeLine{00260   assert(raster64);}
\DoxyCodeLine{00261   \textcolor{keywordflow}{if} (!raster64) \textcolor{keywordflow}{return} TPixel64::Transparent;}
\DoxyCodeLine{00262 }
\DoxyCodeLine{00263   UINT r = 0, g = 0, b = 0, m = 0, size = 0;}
\DoxyCodeLine{00264   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = topLeft.y; y < bottomRight.y; y++) \{}
\DoxyCodeLine{00265     TPixel64 *p = \&raster64-\/>pixels(y)[topLeft.x];}
\DoxyCodeLine{00266     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = topLeft.x; x < bottomRight.x; x++, p++) \{}
\DoxyCodeLine{00267       r += p-\/>r;}
\DoxyCodeLine{00268       g += p-\/>g;}
\DoxyCodeLine{00269       b += p-\/>b;}
\DoxyCodeLine{00270       m += p-\/>m;}
\DoxyCodeLine{00271       size++;}
\DoxyCodeLine{00272     \}}
\DoxyCodeLine{00273   \}}
\DoxyCodeLine{00274 }
\DoxyCodeLine{00275   \textcolor{keywordflow}{if} (size)}
\DoxyCodeLine{00276     \textcolor{keywordflow}{return} TPixel64(r / size, g / size, b / size, m / size);}
\DoxyCodeLine{00277   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00278     \textcolor{keywordflow}{return} TPixel64::Transparent;}
\DoxyCodeLine{00279 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_style_picker_aaa49e810f916b5d5b482e55fec355ad4}\label{class_style_picker_aaa49e810f916b5d5b482e55fec355ad4}} 
\index{StylePicker@{StylePicker}!pickColor@{pickColor}}
\index{pickColor@{pickColor}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{pickColor()}{pickColor()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily TPixel32 Style\+Picker\+::pick\+Color (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{point,  }\item[{double}]{radius,  }\item[{double}]{scale2 }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00125                                                      \{}
\DoxyCodeLine{00126   \mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}} ti  = m\_image;}
\DoxyCodeLine{00127   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri = m\_image;}
\DoxyCodeLine{00128   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = m\_image;}
\DoxyCodeLine{00129   \textcolor{keywordflow}{if} (!!ri)  \textcolor{comment}{// !!ti || !!ri)}}
\DoxyCodeLine{00130   \{}
\DoxyCodeLine{00131     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} raster;}
\DoxyCodeLine{00132     \textcolor{comment}{// if(ti)}}
\DoxyCodeLine{00133     \textcolor{comment}{//  raster = ti-\/>getRGBM(true);}}
\DoxyCodeLine{00134     \textcolor{comment}{// else}}
\DoxyCodeLine{00135     raster = ri-\/>getRaster();}
\DoxyCodeLine{00136 }
\DoxyCodeLine{00137     \mbox{\hyperlink{class_t_point_t}{TPoint}} point = \mbox{\hyperlink{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}{getRasterPoint}}(pos);}
\DoxyCodeLine{00138     \textcolor{keywordflow}{if} (!raster-\/>getBounds().contains(point)) \textcolor{keywordflow}{return} TPixel32::Transparent;}
\DoxyCodeLine{00139 }
\DoxyCodeLine{00140     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} raster32 = raster;}
\DoxyCodeLine{00141     \textcolor{keywordflow}{if} (raster32) \textcolor{keywordflow}{return} raster32-\/>pixels(point.y)[point.x];}
\DoxyCodeLine{00142 }
\DoxyCodeLine{00143     \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} rasterGR8 = raster;}
\DoxyCodeLine{00144     \textcolor{keywordflow}{if} (rasterGR8) \textcolor{keywordflow}{return} toPixel32(rasterGR8-\/>pixels(point.y)[point.x]);}
\DoxyCodeLine{00145   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (vi) \{}
\DoxyCodeLine{00146     \textcolor{keyword}{const} \mbox{\hyperlink{class_t_palette}{TPalette}} *palette = m\_palette.getPointer();}
\DoxyCodeLine{00147     \textcolor{keywordflow}{if} (!palette) \textcolor{keywordflow}{return} TPixel32::Transparent;}
\DoxyCodeLine{00148     \textcolor{keywordtype}{int} styleId = \mbox{\hyperlink{class_style_picker_a76b2ce70572e5b42d9dbd1e4d0e4a4d8}{pickStyleId}}(pos, radius, scale2);}
\DoxyCodeLine{00149     \textcolor{keywordflow}{if} (0 <= styleId \&\& styleId < palette-\/>getStyleCount())}
\DoxyCodeLine{00150       \textcolor{keywordflow}{return} palette-\/>getStyle(styleId)-\/>getAverageColor();}
\DoxyCodeLine{00151   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ti) \{}
\DoxyCodeLine{00152     \textcolor{keyword}{const} \mbox{\hyperlink{class_t_palette}{TPalette}} *palette = m\_palette.getPointer();}
\DoxyCodeLine{00153     \textcolor{keywordflow}{if} (!palette) \textcolor{keywordflow}{return} TPixel32::Transparent;}
\DoxyCodeLine{00154     \textcolor{keywordtype}{int} paintId = \mbox{\hyperlink{class_style_picker_a76b2ce70572e5b42d9dbd1e4d0e4a4d8}{pickStyleId}}(pos, radius, scale2, 0);}
\DoxyCodeLine{00155     \textcolor{keywordtype}{int} inkId   = \mbox{\hyperlink{class_style_picker_a76b2ce70572e5b42d9dbd1e4d0e4a4d8}{pickStyleId}}(pos, radius, scale2, 1);}
\DoxyCodeLine{00156     \textcolor{keywordtype}{int} tone    = pickTone(pos);}
\DoxyCodeLine{00157     TPixel32 ink, paint;}
\DoxyCodeLine{00158     \textcolor{keywordflow}{if} (0 <= inkId \&\& inkId < palette-\/>getStyleCount())}
\DoxyCodeLine{00159       ink = palette-\/>getStyle(inkId)-\/>getAverageColor();}
\DoxyCodeLine{00160     \textcolor{keywordflow}{if} (0 <= paintId \&\& paintId < palette-\/>getStyleCount())}
\DoxyCodeLine{00161       paint = palette-\/>getStyle(paintId)-\/>getAverageColor();}
\DoxyCodeLine{00162 }
\DoxyCodeLine{00163     \textcolor{keywordflow}{if} (tone == 0)}
\DoxyCodeLine{00164       \textcolor{keywordflow}{return} ink;}
\DoxyCodeLine{00165     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tone == 255)}
\DoxyCodeLine{00166       \textcolor{keywordflow}{return} paint;}
\DoxyCodeLine{00167     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00168       \textcolor{keywordflow}{return} blend(ink, paint, tone, TPixelCM32::getMaxTone());}
\DoxyCodeLine{00169   \}}
\DoxyCodeLine{00170   \textcolor{keywordflow}{return} TPixel32::Transparent;}
\DoxyCodeLine{00171 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_style_picker_a6daaa8088f811c51c261765fbcab52aa}\label{class_style_picker_a6daaa8088f811c51c261765fbcab52aa}} 
\index{StylePicker@{StylePicker}!pickColor@{pickColor}}
\index{pickColor@{pickColor}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{pickColor()}{pickColor()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily TPixel32 Style\+Picker\+::pick\+Color (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{area }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00375                                                         \{}
\DoxyCodeLine{00376   \textcolor{comment}{// TRectD rect=area.enlarge(-\/1,-\/1);}}
\DoxyCodeLine{00377   \textcolor{keywordflow}{return} getAverageColor(convert(area));}
\DoxyCodeLine{00378 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_style_picker_a4c4c4d46469ec6c61326c42ae6b43b4c}\label{class_style_picker_a4c4c4d46469ec6c61326c42ae6b43b4c}} 
\index{StylePicker@{StylePicker}!pickColor@{pickColor}}
\index{pickColor@{pickColor}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{pickColor()}{pickColor()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily TPixel32 Style\+Picker\+::pick\+Color (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$}]{stroke }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00382                                                      \{}
\DoxyCodeLine{00383   \textcolor{keywordflow}{return} getAverageColor(stroke);}
\DoxyCodeLine{00384 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_style_picker_a5d8de04d633ed3b69c0977f6cddc8657}\label{class_style_picker_a5d8de04d633ed3b69c0977f6cddc8657}} 
\index{StylePicker@{StylePicker}!pickColor16@{pickColor16}}
\index{pickColor16@{pickColor16}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{pickColor16()}{pickColor16()}}
{\footnotesize\ttfamily TPixel64 Style\+Picker\+::pick\+Color16 (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{point,  }\item[{double}]{radius,  }\item[{double}]{scale2 }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00176                                                        \{}
\DoxyCodeLine{00177   \mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}} ti  = m\_image;}
\DoxyCodeLine{00178   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri = m\_image;}
\DoxyCodeLine{00179   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = m\_image;}
\DoxyCodeLine{00180   assert(ri \&\& !ti \&\& !vi);}
\DoxyCodeLine{00181   \textcolor{keywordflow}{if} (!ri || ti || vi) \textcolor{keywordflow}{return} TPixel64::Transparent;}
\DoxyCodeLine{00182 }
\DoxyCodeLine{00183   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} raster = ri-\/>getRaster();}
\DoxyCodeLine{00184   \textcolor{keywordflow}{if} (raster-\/>getPixelSize() != 8) \textcolor{keywordflow}{return} TPixel64::Transparent;}
\DoxyCodeLine{00185 }
\DoxyCodeLine{00186   \mbox{\hyperlink{class_t_point_t}{TPoint}} point = \mbox{\hyperlink{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}{getRasterPoint}}(pos);}
\DoxyCodeLine{00187   \textcolor{keywordflow}{if} (!raster-\/>getBounds().contains(point)) \textcolor{keywordflow}{return} TPixel64::Transparent;}
\DoxyCodeLine{00188 }
\DoxyCodeLine{00189   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} raster64 = raster;}
\DoxyCodeLine{00190   \textcolor{keywordflow}{if} (!raster64) \textcolor{keywordflow}{return} TPixel64::Transparent;}
\DoxyCodeLine{00191 }
\DoxyCodeLine{00192   \textcolor{keywordflow}{return} raster64-\/>pixels(point.y)[point.x];}
\DoxyCodeLine{00193 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_style_picker_a76b2ce70572e5b42d9dbd1e4d0e4a4d8}\label{class_style_picker_a76b2ce70572e5b42d9dbd1e4d0e4a4d8}} 
\index{StylePicker@{StylePicker}!pickStyleId@{pickStyleId}}
\index{pickStyleId@{pickStyleId}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{pickStyleId()}{pickStyleId()}}
{\footnotesize\ttfamily int Style\+Picker\+::pick\+Style\+Id (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{point,  }\item[{double}]{radius,  }\item[{double}]{scale2,  }\item[{int}]{mode = {\ttfamily 2} }\end{DoxyParamCaption}) const}

funzionerebbe ancora meglio con un get\+Nearest\+Stroke che considera
\begin{DoxyCode}{0}
\DoxyCodeLine{00049                                              \{}
\DoxyCodeLine{00050   \textcolor{keywordtype}{int} styleId = 0;}
\DoxyCodeLine{00051   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}} ti = m\_image) \{}
\DoxyCodeLine{00052     \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} ras = ti-\/>getRaster();}
\DoxyCodeLine{00053     \mbox{\hyperlink{class_t_point_t}{TPoint}} point     = \mbox{\hyperlink{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}{getRasterPoint}}(pos);}
\DoxyCodeLine{00054     \textcolor{keywordflow}{if} (!ras-\/>getBounds().contains(point)) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00055     \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} col = ras-\/>pixels(point.y)[point.x];}
\DoxyCodeLine{00056 }
\DoxyCodeLine{00057     \textcolor{keywordflow}{switch} (mode) \{}
\DoxyCodeLine{00058     \textcolor{keywordflow}{case} 0:  \textcolor{comment}{// AREAS}}
\DoxyCodeLine{00059       styleId = col.getPaint();}
\DoxyCodeLine{00060       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00061     \textcolor{keywordflow}{case} 1:  \textcolor{comment}{// LINES}}
\DoxyCodeLine{00062       styleId = col.getInk();}
\DoxyCodeLine{00063       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00064     \textcolor{keywordflow}{case} 2:  \textcolor{comment}{// ALL (Line \& Area)}}
\DoxyCodeLine{00065     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00066       styleId = col.isPurePaint() ? col.getPaint() : col.getInk();}
\DoxyCodeLine{00067       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00068     \}}
\DoxyCodeLine{00069   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri = m\_image) \{}
\DoxyCodeLine{00070     \textcolor{keyword}{const} \mbox{\hyperlink{class_t_palette}{TPalette}} *palette = m\_palette.getPointer();}
\DoxyCodeLine{00071     \textcolor{keywordflow}{if} (!palette) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00072     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras = ri-\/>getRaster();}
\DoxyCodeLine{00073     \textcolor{keywordflow}{if} (!ras) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00074     \mbox{\hyperlink{class_t_point_t}{TPoint}} point = \mbox{\hyperlink{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}{getRasterPoint}}(pos);}
\DoxyCodeLine{00075     \textcolor{keywordflow}{if} (!ras-\/>getBounds().contains(point)) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00076     TPixel32 col = ras-\/>pixels(point.y)[point.x];}
\DoxyCodeLine{00077     styleId      = palette-\/>getClosestStyle(col);}
\DoxyCodeLine{00078   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = m\_image) \{}
\DoxyCodeLine{00079     \textcolor{comment}{// prima cerca lo stile della regione piu' vicina}}
\DoxyCodeLine{00080     \mbox{\hyperlink{class_t_region}{TRegion}} *r = vi-\/>\mbox{\hyperlink{class_t_region_a70157768964375ee7cc7d27cbf7f0979}{getRegion}}(pos);}
\DoxyCodeLine{00081     \textcolor{keywordflow}{if} (r) styleId = r-\/>getStyle();}
\DoxyCodeLine{00082     \textcolor{keywordtype}{bool} strokeFound;}
\DoxyCodeLine{00083     \textcolor{keywordtype}{double} dist2, w, thick;}
\DoxyCodeLine{00084     UINT index;}
\DoxyCodeLine{00086     \textcolor{comment}{// la thickness, cioe' la min distance dalla outline e non dalla centerLine}}
\DoxyCodeLine{00087     strokeFound = vi-\/>getNearestStroke(pos, w, index, dist2);}
\DoxyCodeLine{00088     \textcolor{keywordflow}{if} (strokeFound) \{}
\DoxyCodeLine{00089       \textcolor{keywordtype}{int} devPixRatio = getDevPixRatio();}
\DoxyCodeLine{00090       dist2 *= scale2;}
\DoxyCodeLine{00091       \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke = vi-\/>getStroke(index);}
\DoxyCodeLine{00092       thick           = stroke-\/>\mbox{\hyperlink{class_t_stroke_ada4f6fc3fea4a7c0b949cd1d9dc6e640}{getThickPoint}}(w).thick;}
\DoxyCodeLine{00093       \textcolor{keywordtype}{double} len2     = thick * thick * scale2;}
\DoxyCodeLine{00094       \textcolor{keyword}{const} \textcolor{keywordtype}{double} minDist2 =}
\DoxyCodeLine{00095           (styleId == 0) ? radius * radius * (\textcolor{keywordtype}{double})(devPixRatio * devPixRatio)}
\DoxyCodeLine{00096                          : 0;}
\DoxyCodeLine{00097       \textcolor{keywordtype}{double} checkDist = std::max(minDist2, len2);}
\DoxyCodeLine{00098       \textcolor{keywordflow}{if} (dist2 < checkDist) \{}
\DoxyCodeLine{00099         assert(stroke);}
\DoxyCodeLine{00100         styleId = stroke-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}();}
\DoxyCodeLine{00101       \}}
\DoxyCodeLine{00102     \}}
\DoxyCodeLine{00103   \}}
\DoxyCodeLine{00104   \textcolor{keywordflow}{return} styleId;}
\DoxyCodeLine{00105 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00030}{get\+Raster\+Point()}}, \mbox{\hyperlink{l01133}{TRegion\+::get\+Region()}}, \mbox{\hyperlink{l02366}{TStroke\+::get\+Style()}}, and \mbox{\hyperlink{l01960}{TStroke\+::get\+Thick\+Point()}}.



Referenced by \mbox{\hyperlink{l00287}{Color\+Model\+Viewer\+::pick()}}.

\mbox{\Hypertarget{class_style_picker_ab1ec31ad774c6b8f1cb938565f3f512f}\label{class_style_picker_ab1ec31ad774c6b8f1cb938565f3f512f}} 
\index{StylePicker@{StylePicker}!pickTone@{pickTone}}
\index{pickTone@{pickTone}!StylePicker@{StylePicker}}
\doxysubsubsection{\texorpdfstring{pickTone()}{pickTone()}}
{\footnotesize\ttfamily int Style\+Picker\+::pick\+Tone (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00109                                                   \{}
\DoxyCodeLine{00110   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}} ti = m\_image) \{}
\DoxyCodeLine{00111     \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} ras = ti-\/>getRaster();}
\DoxyCodeLine{00112     \textcolor{keywordflow}{if} (!ras) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00113     \mbox{\hyperlink{class_t_point_t}{TPoint}} point = \mbox{\hyperlink{class_style_picker_ae36100dcc6b6242006d0cd310b420cac}{getRasterPoint}}(pos);}
\DoxyCodeLine{00114     \textcolor{keywordflow}{if} (!ras-\/>getBounds().contains(point)) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00115     \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} col = ras-\/>pixels(point.y)[point.x];}
\DoxyCodeLine{00116 }
\DoxyCodeLine{00117     \textcolor{keywordflow}{return} col.getTone();}
\DoxyCodeLine{00118   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00119     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00120 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/tools/stylepicker.\+h\item 
E\+:/opentoonz/toonz/sources/tnztools/stylepicker.\+cpp\end{DoxyCompactItemize}
