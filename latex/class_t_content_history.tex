\hypertarget{class_t_content_history}{}\doxysection{TContent\+History Class Reference}
\label{class_t_content_history}\index{TContentHistory@{TContentHistory}}


{\ttfamily \#include $<$tcontenthistory.\+h$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_content_history_a48855029502543c6a41c511d005c6c40}{TContent\+History}} (bool is\+Level)
\begin{DoxyCompactList}\small\item\em set is\+Level=true if you want to keep track of single-\/frames modifications \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_t_content_history}{TContent\+History}} $\ast$ \mbox{\hyperlink{class_t_content_history_a408a5865182e72459f41538ccc2ec308}{clone}} () const
\item 
void \mbox{\hyperlink{class_t_content_history_afda3bf173b9a7ae3191b93158ad49fbb}{deserialize}} (const QString \&history)
\item 
const QString \mbox{\hyperlink{class_t_content_history_aac53dd08c6fc7fa07ba1c8c5beb51131}{serialize}} () const
\begin{DoxyCompactList}\small\item\em the returned string is only for visualitation and serialization \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_content_history_ac69085bd50921d9ef44f0bcf4b24f326}{fix\+Current\+History}} ()
\item 
void \mbox{\hyperlink{class_t_content_history_a473d4a6c40eac7847c57933ac437a11d}{frame\+Modified\+Now}} (const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&id)
\begin{DoxyCompactList}\small\item\em do not call this 2 methods if is\+Level==false! (assertion fails) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_content_history_af4fc57ead785ba05105209377af9150d}{frame\+Range\+Modified\+Now}} (const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&from\+Id, const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&to\+Id)
\item 
void \mbox{\hyperlink{class_t_content_history_a2f68765ab2651c30dfbbae3f98f73403}{modified\+Now}} ()
\begin{DoxyCompactList}\small\item\em do not call this method if is\+Level==true! (assertion fails) \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
this class keeps tracks of modification times on contents, as well as user and machine info; typically used for levels and scene files (or whatever you like...) 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_t_content_history_a48855029502543c6a41c511d005c6c40}\label{class_t_content_history_a48855029502543c6a41c511d005c6c40}} 
\index{TContentHistory@{TContentHistory}!TContentHistory@{TContentHistory}}
\index{TContentHistory@{TContentHistory}!TContentHistory@{TContentHistory}}
\doxysubsubsection{\texorpdfstring{TContentHistory()}{TContentHistory()}}
{\footnotesize\ttfamily TContent\+History\+::\+TContent\+History (\begin{DoxyParamCaption}\item[{bool}]{is\+Level }\end{DoxyParamCaption})}



set is\+Level=true if you want to keep track of single-\/frames modifications 


\begin{DoxyCode}{0}
\DoxyCodeLine{00030     : m\_isLevel(isLevel), m\_frozenHistory() \{\}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_content_history_ab0f5f99e222113646395fbb8c641485d}\label{class_t_content_history_ab0f5f99e222113646395fbb8c641485d}} 
\index{TContentHistory@{TContentHistory}!````~TContentHistory@{$\sim$TContentHistory}}
\index{````~TContentHistory@{$\sim$TContentHistory}!TContentHistory@{TContentHistory}}
\doxysubsubsection{\texorpdfstring{$\sim$TContentHistory()}{~TContentHistory()}}
{\footnotesize\ttfamily TContent\+History\+::$\sim$\+TContent\+History (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00034 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_t_content_history_a408a5865182e72459f41538ccc2ec308}\label{class_t_content_history_a408a5865182e72459f41538ccc2ec308}} 
\index{TContentHistory@{TContentHistory}!clone@{clone}}
\index{clone@{clone}!TContentHistory@{TContentHistory}}
\doxysubsubsection{\texorpdfstring{clone()}{clone()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_content_history}{TContent\+History}} $\ast$ TContent\+History\+::clone (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00038                                               \{}
\DoxyCodeLine{00039   \mbox{\hyperlink{class_t_content_history}{TContentHistory}} *history = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_content_history_a48855029502543c6a41c511d005c6c40}{TContentHistory}}(m\_isLevel);}
\DoxyCodeLine{00040   history-\/>deserialize(\mbox{\hyperlink{class_t_content_history_aac53dd08c6fc7fa07ba1c8c5beb51131}{serialize}}());}
\DoxyCodeLine{00041   \textcolor{keywordflow}{return} history;}
\DoxyCodeLine{00042 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_content_history_afda3bf173b9a7ae3191b93158ad49fbb}\label{class_t_content_history_afda3bf173b9a7ae3191b93158ad49fbb}} 
\index{TContentHistory@{TContentHistory}!deserialize@{deserialize}}
\index{deserialize@{deserialize}!TContentHistory@{TContentHistory}}
\doxysubsubsection{\texorpdfstring{deserialize()}{deserialize()}}
{\footnotesize\ttfamily void TContent\+History\+::deserialize (\begin{DoxyParamCaption}\item[{const QString \&}]{history }\end{DoxyParamCaption})}

history can come only from a deserialization WARNING! any preexistent history will be erased by calling this method 
\begin{DoxyCode}{0}
\DoxyCodeLine{00046                                                                \{}
\DoxyCodeLine{00047   m\_frozenHistory = currentHistory;}
\DoxyCodeLine{00048 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_content_history_ac69085bd50921d9ef44f0bcf4b24f326}\label{class_t_content_history_ac69085bd50921d9ef44f0bcf4b24f326}} 
\index{TContentHistory@{TContentHistory}!fixCurrentHistory@{fixCurrentHistory}}
\index{fixCurrentHistory@{fixCurrentHistory}!TContentHistory@{TContentHistory}}
\doxysubsubsection{\texorpdfstring{fixCurrentHistory()}{fixCurrentHistory()}}
{\footnotesize\ttfamily void TContent\+History\+::fix\+Current\+History (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

after calling this method, following history info added will not \char`\"{}merge\char`\"{} with the history until now 
\begin{DoxyCode}{0}
\DoxyCodeLine{00199                                         \{}
\DoxyCodeLine{00200   m\_frozenHistory = \mbox{\hyperlink{class_t_content_history_aac53dd08c6fc7fa07ba1c8c5beb51131}{serialize}}();}
\DoxyCodeLine{00201   m\_records.clear();}
\DoxyCodeLine{00202 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00180}{serialize()}}.

\mbox{\Hypertarget{class_t_content_history_a473d4a6c40eac7847c57933ac437a11d}\label{class_t_content_history_a473d4a6c40eac7847c57933ac437a11d}} 
\index{TContentHistory@{TContentHistory}!frameModifiedNow@{frameModifiedNow}}
\index{frameModifiedNow@{frameModifiedNow}!TContentHistory@{TContentHistory}}
\doxysubsubsection{\texorpdfstring{frameModifiedNow()}{frameModifiedNow()}}
{\footnotesize\ttfamily void TContent\+History\+::frame\+Modified\+Now (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



do not call this 2 methods if is\+Level==false! (assertion fails) 


\begin{DoxyCode}{0}
\DoxyCodeLine{00055 \{ frameRangeModifiedNow(\textcolor{keywordtype}{id}, \textcolor{keywordtype}{id}); \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00330}{TXsh\+Simple\+Level\+::touch\+Frame()}}.

\mbox{\Hypertarget{class_t_content_history_af4fc57ead785ba05105209377af9150d}\label{class_t_content_history_af4fc57ead785ba05105209377af9150d}} 
\index{TContentHistory@{TContentHistory}!frameRangeModifiedNow@{frameRangeModifiedNow}}
\index{frameRangeModifiedNow@{frameRangeModifiedNow}!TContentHistory@{TContentHistory}}
\doxysubsubsection{\texorpdfstring{frameRangeModifiedNow()}{frameRangeModifiedNow()}}
{\footnotesize\ttfamily void TContent\+History\+::frame\+Range\+Modified\+Now (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{from\+Id,  }\item[{const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{to\+Id }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00207                                                                   \{}
\DoxyCodeLine{00208   assert(m\_isLevel);}
\DoxyCodeLine{00209   QDateTime date = QDateTime::currentDateTime();}
\DoxyCodeLine{00210   QDateTime dateNoSecs(date.date(), date.time().addSecs(-\/date.time().second()));}
\DoxyCodeLine{00211   assert(dateNoSecs.secsTo(date) == date.time().second());}
\DoxyCodeLine{00212 }
\DoxyCodeLine{00213   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00214   m\_records[fromId] = dateNoSecs;}
\DoxyCodeLine{00215 }
\DoxyCodeLine{00216   \textcolor{keywordflow}{if} (fromId == toId) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00217 }
\DoxyCodeLine{00218   \textcolor{keywordflow}{for} (i = fromId.getNumber() + 1; i <= toId.getNumber() -\/ 1; i++)}
\DoxyCodeLine{00219     m\_records[\mbox{\hyperlink{class_t_frame_id}{TFrameId}}(i)] = dateNoSecs;}
\DoxyCodeLine{00220 }
\DoxyCodeLine{00221   m\_records[toId] = dateNoSecs;}
\DoxyCodeLine{00222 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_content_history_a2f68765ab2651c30dfbbae3f98f73403}\label{class_t_content_history_a2f68765ab2651c30dfbbae3f98f73403}} 
\index{TContentHistory@{TContentHistory}!modifiedNow@{modifiedNow}}
\index{modifiedNow@{modifiedNow}!TContentHistory@{TContentHistory}}
\doxysubsubsection{\texorpdfstring{modifiedNow()}{modifiedNow()}}
{\footnotesize\ttfamily void TContent\+History\+::modified\+Now (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



do not call this method if is\+Level==true! (assertion fails) 


\begin{DoxyCode}{0}
\DoxyCodeLine{00226                                   \{}
\DoxyCodeLine{00227   assert(!m\_isLevel);}
\DoxyCodeLine{00228   QDateTime date = QDateTime::currentDateTime();}
\DoxyCodeLine{00229   QDateTime dateNoSecs(date.date(), date.time().addSecs(-\/date.time().second()));}
\DoxyCodeLine{00230   assert(dateNoSecs.secsTo(date) == date.time().second());}
\DoxyCodeLine{00231 }
\DoxyCodeLine{00232   m\_records[0] = dateNoSecs;}
\DoxyCodeLine{00233 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_content_history_aac53dd08c6fc7fa07ba1c8c5beb51131}\label{class_t_content_history_aac53dd08c6fc7fa07ba1c8c5beb51131}} 
\index{TContentHistory@{TContentHistory}!serialize@{serialize}}
\index{serialize@{serialize}!TContentHistory@{TContentHistory}}
\doxysubsubsection{\texorpdfstring{serialize()}{serialize()}}
{\footnotesize\ttfamily const QString TContent\+History\+::serialize (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



the returned string is only for visualitation and serialization 


\begin{DoxyCode}{0}
\DoxyCodeLine{00180                                                \{}
\DoxyCodeLine{00181   \textcolor{keyword}{const} QString currentHistory = currentToString();}
\DoxyCodeLine{00182 }
\DoxyCodeLine{00183   \textcolor{keywordflow}{if} (m\_frozenHistory != \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00184     \textcolor{keywordflow}{return} m\_frozenHistory + currentHistory;}
\DoxyCodeLine{00185   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (currentHistory != \textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{00186     \textcolor{keywordflow}{if} (m\_isLevel)}
\DoxyCodeLine{00187       \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}| \#    DATE:       Time:   MACHINE:    USER:          FRAMES "{}}}
\DoxyCodeLine{00188              \textcolor{stringliteral}{"{}MODIFIED:     |"{}} +}
\DoxyCodeLine{00189              currentHistory;}
\DoxyCodeLine{00190     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00191       \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}| \#    DATE:       Time:   MACHINE:    USER:           |"{}} +}
\DoxyCodeLine{00192              currentHistory;}
\DoxyCodeLine{00193   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00194     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00195 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00199}{fix\+Current\+History()}}, and \mbox{\hyperlink{l00590}{Toonz\+Scene\+::save()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/tcontenthistory.\+h\item 
E\+:/opentoonz/toonz/sources/common/tcontenthistory.\+cpp\end{DoxyCompactItemize}
