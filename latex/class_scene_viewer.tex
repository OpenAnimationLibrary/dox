\hypertarget{class_scene_viewer}{}\doxysection{Scene\+Viewer Class Reference}
\label{class_scene_viewer}\index{SceneViewer@{SceneViewer}}
Inheritance diagram for Scene\+Viewer\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_scene_viewer}
\end{center}
\end{figure}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum {\bfseries Reference\+Mode} \{ {\bfseries NORMAL\+\_\+\+REFERENCE} = 1
, {\bfseries CAMERA3\+D\+\_\+\+REFERENCE} = 2
, {\bfseries CAMERA\+\_\+\+REFERENCE} = 3
, {\bfseries LEVEL\+\_\+\+MODE} = 128
 \}
\item 
enum {\bfseries View\+Mode} \{ {\bfseries SCENE\+\_\+\+VIEWMODE} = 0
, {\bfseries LEVEL\+\_\+\+VIEWMODE} = 1
 \}
\item 
enum {\bfseries Preview\+Mode} \{ {\bfseries NO\+\_\+\+PREVIEW} = 0
, {\bfseries FULL\+\_\+\+PREVIEW} = 1
, {\bfseries SUBCAMERA\+\_\+\+PREVIEW} = 2
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Public Slots}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_scene_viewer_a486ab2b8322a8922ccda934272da2bc1}{reset\+Scene\+Viewer}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a19a9898446b10c6a9367171b5c43ca1a}{reset\+Zoom}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a1b5067774331d9aae76bce92a2088614}{reset\+Rotation}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_ae8e0eddc3c301fbbcead3dc55188e8c4}{reset\+Position}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a8ca6c2ca955f598e104d76cfccf108f0}{set\+Actual\+Pixel\+Size}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a7aa63e40d31ff8087f5d4cceb5fd1fc0}{flipX}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a8d72cb1162232646e8bc69b72c55dc5b}{flipY}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a2d4cced2ccad45e662e734ec7be5a856}{zoom\+In}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a3bbf29560bedb29d0004a13159e56d29}{zoom\+Out}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_aead4b11fab3fec8993abc0679820b948}{on\+Xsheet\+Changed}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a4e8e688d6369e5fb243a853e9d91ce53}{on\+Object\+Switched}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a950ace4dc4b0afb962fb4884a107d00a}{on\+Tool\+Changed}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a4dbd9c2f6053b706f1ee02c8d3d3ed4d}{on\+Tool\+Switched}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a5d328a1e864429727d539adb0549ce94}{on\+Scene\+Changed}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a0454f71591bde07203a2e6ac030e9b5d}{on\+Level\+Changed}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a4c5ebcc7632efbf13fd8640531e95766}{on\+Level\+Switched}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a76cd7a43b0be7f97a5493ed93bd768d4}{on\+Frame\+Switched}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a034053ccfdd1dc475139a0c119e2f07a}{on\+Onion\+Skin\+Mask\+Changed}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a356c3d5f2a1694bf7e598c29b9fe03e5}{set\+Reference\+Mode}} (int reference\+Mode)
\item 
void \mbox{\hyperlink{class_scene_viewer_a4964c1394b70da1420b770d872659dca}{enable\+Preview}} (int preview\+Mode)
\item 
void \mbox{\hyperlink{class_scene_viewer_afee23545d546ce0e24be09d45a079831}{freeze}} (bool on)
\item 
void \mbox{\hyperlink{class_scene_viewer_a53550576897c429393bef675c5d13fbe}{on\+Button\+Pressed}} (Flip\+Console\+::\+EGadget button)
\item 
void \mbox{\hyperlink{class_scene_viewer_a28b51b06c0d341adf5e3479e610eff47}{fit\+To\+Camera}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_abacde6b68591e1ad86c3146516dda792}{fit\+To\+Camera\+Outline}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a706c39b5ae56033e32d2394142198301}{swap\+Compared}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a6cb8080e8128fb721c2517ae938994b0}{regenerate\+Preview\+Frame}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a240af6e63f2de67f32661dead9763b0b}{regenerate\+Preview}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_adea94782b23124e656a813ccc6155210}{do\+Delete\+Sub\+Camera}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_ad14f2cc4168a38882b4c23bbb8e7ed61}{reset\+Tablet\+Status}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_ad4ab9fcfdf2823447ed005ec1cc95fc8}{release\+Busy\+On\+Tablet\+Move}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_afa78eb4bdab0b03f3e4ac1fc4af67e05}{on\+Context\+About\+To\+Be\+Destroyed}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a747bce47ff0499a9dd5a6043ca83fb1a}{on\+Preference\+Changed}} (const QString \&pref\+Name)
\end{DoxyCompactItemize}
\doxysubsection*{Signals}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_scene_viewer_ac2f62085d7ede300d5467a99969ca243}\label{class_scene_viewer_ac2f62085d7ede300d5467a99969ca243}} 
void {\bfseries on\+Zoom\+Changed} ()
\item 
\mbox{\Hypertarget{class_scene_viewer_ab35976a15d15eaf3d0148c3f6dc8146e}\label{class_scene_viewer_ab35976a15d15eaf3d0148c3f6dc8146e}} 
void {\bfseries on\+Flip\+HChanged} (bool)
\item 
\mbox{\Hypertarget{class_scene_viewer_ab54c65f54a93768512380aca7129c63a}\label{class_scene_viewer_ab54c65f54a93768512380aca7129c63a}} 
void {\bfseries on\+Flip\+VChanged} (bool)
\item 
\mbox{\Hypertarget{class_scene_viewer_a8f82cc3fec87d1534a900ddd4b520215}\label{class_scene_viewer_a8f82cc3fec87d1534a900ddd4b520215}} 
void {\bfseries freeze\+State\+Changed} (bool)
\item 
\mbox{\Hypertarget{class_scene_viewer_adcab8a2cb5677b53adf1e1001cd20967}\label{class_scene_viewer_adcab8a2cb5677b53adf1e1001cd20967}} 
void {\bfseries preview\+Status\+Changed} ()
\item 
\mbox{\Hypertarget{class_scene_viewer_a3ebfe16a4020aafc782158422e08bbd1}\label{class_scene_viewer_a3ebfe16a4020aafc782158422e08bbd1}} 
void {\bfseries refresh\+Navi} ()
\item 
\mbox{\Hypertarget{class_scene_viewer_a5d0267e74bc538a9f117856062fba503}\label{class_scene_viewer_a5d0267e74bc538a9f117856062fba503}} 
void {\bfseries preview\+Toggled} ()
\item 
\mbox{\Hypertarget{class_scene_viewer_a7647e4aa2b9e25ff900b511a9228a3ce}\label{class_scene_viewer_a7647e4aa2b9e25ff900b511a9228a3ce}} 
void {\bfseries about\+To\+Be\+Destroyed} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_scene_viewer_adb67280796f09a6800e531a389eb7dae}{Scene\+Viewer}} (\mbox{\hyperlink{class_image_utils_1_1_full_screen_widget}{Image\+Utils\+::\+Full\+Screen\+Widget}} $\ast$parent)
\item 
double \mbox{\hyperlink{class_scene_viewer_a3c7c61456c1f6403bfd86c0729f52207}{get\+Pixel\+Size}} () const override
\item 
\mbox{\hyperlink{class_t_rect_t}{TRectD}} \mbox{\hyperlink{class_scene_viewer_a3d6ff236dc014acbe3fa2d3650dbb0ea}{get\+Preview\+Rect}} () const override
\item 
void \mbox{\hyperlink{class_scene_viewer_a779d8af0ab00573fb2a3dd925cc2d546}{on\+Render\+Started}} (int frame) override
\item 
void \mbox{\hyperlink{class_scene_viewer_abd3362a77941869edd9ada55709279ad}{on\+Render\+Completed}} (int frame) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a9cea138440514d78c2580d09f0ebe518}{on\+Preview\+Update}} () override
\item 
bool \mbox{\hyperlink{class_scene_viewer_a951018a0f767f1b40094e839332d896a}{is\+Preview\+Enabled}} () const
\item 
int \mbox{\hyperlink{class_scene_viewer_acb52de98a6c2cd11dfd482437ebddf66}{get\+Preview\+Mode}} () const
\item 
void \mbox{\hyperlink{class_scene_viewer_a99f8875eb64f5e9e7f3001fb6556bafd}{set\+Visual}} (const \mbox{\hyperlink{class_image_painter_1_1_visual_settings}{Image\+Painter\+::\+Visual\+Settings}} \&settings)
\item 
\mbox{\hyperlink{class_t_rect_t}{TRect}} \mbox{\hyperlink{class_scene_viewer_a46de6de255d707906df8cfcfdf3a1ead}{get\+Actual\+Clip\+Rect}} (const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff)
\item 
\mbox{\hyperlink{class_t_affine}{TAffine}} \mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{get\+View\+Matrix}} () const override
\item 
\mbox{\hyperlink{class_t_affine}{TAffine}} \mbox{\hyperlink{class_scene_viewer_a71c3b2c826bd5efa2762dc38b695edfb}{get\+Scene\+Matrix}} () const
\item 
void \mbox{\hyperlink{class_scene_viewer_a81053fcd8115b5854c5b7dff0af0cf5a}{set\+View\+Matrix}} (const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff, int view\+Mode)
\item 
int \mbox{\hyperlink{class_scene_viewer_ac03615cda02f9ecf6a96c6839918fc79}{get\+FPS}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a6d36b46e11aebf1a2a0fb8f618c4f627}{set\+Rulers}} (\mbox{\hyperlink{class_ruler}{Ruler}} $\ast$v, \mbox{\hyperlink{class_ruler}{Ruler}} $\ast$h)
\item 
bool \mbox{\hyperlink{class_scene_viewer_a32224c92271386a53b52fdfa99cbce82}{is3\+DView}} () const override
\item 
\mbox{\hyperlink{class_t_dimension_t}{TDimension}} \mbox{\hyperlink{class_scene_viewer_a17c5430ffb3cea34704430a7f623dba1}{get\+Viewport\+Size}} () const
\item 
void \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidate\+All}} () override
\item 
void \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidate\+All}} () override
\item 
void \mbox{\hyperlink{class_scene_viewer_ae5973b384a0f6d4a76fa06ae6343c43f}{GLInvalidate\+Rect}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a51e41da45c96d39493ac2753b89d5407}{invalidate\+Tool\+Status}} () override
\item 
\mbox{\hyperlink{class_t_point_t}{TPointD}} \mbox{\hyperlink{class_scene_viewer_aa4f030a7fcd3eb03e217442ddfb1ee82}{get\+Pan3D}} () const
\item 
double \mbox{\hyperlink{class_scene_viewer_a504e74706e339c8b92df181000b143a1}{get\+Zoom\+Scale3D}} () const
\item 
double \mbox{\hyperlink{class_scene_viewer_a1baf121661d1bbabbb869411e4687a4d}{project\+ToZ}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&delta) override
\item 
\mbox{\hyperlink{class_t_point_t}{TPointD}} \mbox{\hyperlink{class_scene_viewer_a2a7faf3b67ff28e82ad7294924b6cb74}{get\+Dpi\+Scale}} () const override
\item 
void \mbox{\hyperlink{class_scene_viewer_aee4ed44d7e7e472a7fc22cf7c9db1360}{zoom\+Qt}} (bool forward, bool reset)
\item 
\mbox{\hyperlink{class_t_affine}{TAffine}} \mbox{\hyperlink{class_scene_viewer_a14d04fa24b2fb8f29cec3d17a2237ad7}{get\+Normal\+Zoom\+Scale}} ()
\item 
bool \mbox{\hyperlink{class_scene_viewer_a07090c8e03ffdbaa5e79726cecbe7106}{can\+Swap\+Compared}} () const
\item 
bool \mbox{\hyperlink{class_scene_viewer_a3b6c96570548ac253cacccd977820c5c}{is\+Edit\+Preview\+Subcamera}} () const
\item 
bool \mbox{\hyperlink{class_scene_viewer_a867728dd5a6af616e3bb10472441553a}{get\+Is\+FlippedX}} () const override
\item 
bool \mbox{\hyperlink{class_scene_viewer_a0ee26ba62d6500895dc7b18a3d9c0451}{get\+Is\+FlippedY}} () const override
\item 
void \mbox{\hyperlink{class_scene_viewer_a62353c28294f128e596558065ba41e8f}{set\+Edit\+Preview\+Subcamera}} (bool enabled)
\item 
void \mbox{\hyperlink{class_scene_viewer_a7417b1376a06cff118bba954c3f67a05}{navigator\+Pan}} (const QPoint \&delta)
\item 
double \mbox{\hyperlink{class_scene_viewer_a7fd1e40caee87c57edd5d890dc41b8c8}{get\+Dpi\+Factor}} ()
\item 
double \mbox{\hyperlink{class_scene_viewer_abc2a1a75cd067ec5588dfdbd583d483b}{get\+Zoom\+Scale\+Fitting\+With\+Screen}} ()
\item 
\mbox{\hyperlink{class_t_rect_t}{TRectD}} \mbox{\hyperlink{class_scene_viewer_a7894cec2d508ff6e264616df00b26479}{get\+Geometry}} () const override
\item 
void \mbox{\hyperlink{class_scene_viewer_a90c77460ec4fc143817b3e9479a50f1a}{set\+Focus}} (Qt\+::\+Focus\+Reason reason)
\item 
void \mbox{\hyperlink{class_scene_viewer_a4e743c887ede3ea67132600c6661d823}{set\+Is\+Locator}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a1aa0bac14417aeeb458439dfed626dae}{set\+Is\+Style\+Shortcut\+Switchable}} ()
\item 
int \mbox{\hyperlink{class_scene_viewer_a841545e56b0e1d20f2475b2b214b5f09}{get\+VGuide\+Count}} () override
\item 
int \mbox{\hyperlink{class_scene_viewer_ab0f2d483de9e3552346138f343c585c7}{get\+HGuide\+Count}} () override
\item 
double \mbox{\hyperlink{class_scene_viewer_acd65e1634747cdfd37a49c7c57778973}{get\+VGuide}} (int index) override
\item 
double \mbox{\hyperlink{class_scene_viewer_a6d249c7f77f675cecbc6ad0afdf8cc69}{get\+HGuide}} (int index) override
\item 
void \mbox{\hyperlink{class_scene_viewer_ab4227c932f0d4a15dd88bd17492c318c}{bind\+FBO}} () override
\item 
void \mbox{\hyperlink{class_scene_viewer_ae331d555c43f941e0d5576fefc5f8774}{release\+FBO}} () override
\item 
void \mbox{\hyperlink{class_scene_viewer_ae85206a6a0c35c8ea2374f1442575f39}{set\+Timer\+And\+Target\+Instant}} (QElapsed\+Timer $\ast$timer, qint64 target)
\item 
\mbox{\hyperlink{class_t_point_t}{TPointD}} \mbox{\hyperlink{class_scene_viewer_ac1a70ad1c9fc56002d67b8a6f6609e55}{win\+To\+World}} (const QPointF \&pos) const
\item 
\mbox{\hyperlink{class_t_point_t}{TPointD}} \mbox{\hyperlink{class_scene_viewer_a66e2243fc4447eddb73d6fc09d1a112b}{win\+To\+World}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&win\+Pos) const override
\item 
\mbox{\hyperlink{class_t_point_t}{TPointD}} \mbox{\hyperlink{class_scene_viewer_aeb3a1d375ff7172f35364adc9cc0500e}{world\+To\+Pos}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&world\+Pos) const override
\begin{DoxyCompactList}\small\item\em return pos in pixel, bottom-\/left origin \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_scene_viewer_a82bd279f9e7a5cd329511874367ff6ac}{draw\+Build\+Vars}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a682781eebe470f3d40740d46180a1b6c}{draw\+Enable\+Scissor}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a841bc094686713386e52af05c0e1be10}{draw\+Disable\+Scissor}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_afe39eb304a79ac869b11b663e9f109c8}{draw\+Background}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_aa7c81725cc6d3628d8f3ffa69a9e351f}{draw\+Camera\+Stand}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a68ece13279180dee8c61f1dcdc1944e4}{draw\+Preview}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a7f65aa9285528e26a555615fd8693128}{draw\+Overlay}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_ac126cf528301b58b48221eb2e546b1c2}{draw\+Scene}} ()
\item 
\mbox{\Hypertarget{class_scene_viewer_a59d806d19ba61c8edb09edcd2964dc5c}\label{class_scene_viewer_a59d806d19ba61c8edb09edcd2964dc5c}} 
void {\bfseries draw\+Tool\+Gadgets} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a1f9f1e732b1f8df97c86b88d0a3d563f}{mult3\+DMatrix}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a877c189291e741328d2162a37550bde6}{initialize\+GL}} () override
\item 
void \mbox{\hyperlink{class_scene_viewer_a2e7b35a10fc6a43dc5fd50c572de22a8}{resize\+GL}} (int width, int height) override
\item 
void \mbox{\hyperlink{class_scene_viewer_aa02c109040f40886e29f8e8c89725d91}{paint\+GL}} () override
\item 
void \mbox{\hyperlink{class_scene_viewer_aac3340c7d8289f8c4eb7eb1789f72751}{show\+Event}} (QShow\+Event $\ast$) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a713eb48131c80efb39184a049c28e16d}{hide\+Event}} (QHide\+Event $\ast$) override
\item 
void \mbox{\hyperlink{class_scene_viewer_ab5b1db8cc53709170924278943aad036}{gesture\+Event}} (QGesture\+Event $\ast$e)
\item 
void \mbox{\hyperlink{class_scene_viewer_ab24ab9bd8c81be905d366154463b81df}{touch\+Event}} (QTouch\+Event $\ast$e, int type)
\item 
void \mbox{\hyperlink{class_scene_viewer_a70971e0b0f88badc18059b6c0474e0fd}{tablet\+Event}} (QTablet\+Event $\ast$) override
\item 
void \mbox{\hyperlink{class_scene_viewer_ab8133ba061ff2aceb093eb09e925a2c4}{leave\+Event}} (QEvent $\ast$) override
\item 
void \mbox{\hyperlink{class_scene_viewer_aba4c135ce293af822b5cfcebaf7d9d87}{enter\+Event}} (QEvent $\ast$) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a65b09e0b6928385784425398c9c4b978}{mouse\+Move\+Event}} (QMouse\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_scene_viewer_ae4fb14b4bbe05a40d312fb386cad6018}{mouse\+Press\+Event}} (QMouse\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a20d80b32173efe5203eacf2544bb3800}{mouse\+Release\+Event}} (QMouse\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_scene_viewer_ac8583e80119b74761b7f2e08378cc05a}{mouse\+Double\+Click\+Event}} (QMouse\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a815593940281a159efb32f5db1a10276}{on\+Press}} (const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&event)
\item 
void \mbox{\hyperlink{class_scene_viewer_a147e36c46189dce4600beccc005e50d2}{on\+Move}} (const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&event)
\item 
void \mbox{\hyperlink{class_scene_viewer_a51cdfd5bdc5782706c1c319888b42d4f}{on\+Release}} (const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&event)
\item 
void \mbox{\hyperlink{class_scene_viewer_a8ebf805abb82191cbde483dc14fa8896}{on\+Context\+Menu}} (const QPoint \&pos, const QPoint \&global\+Pos)
\item 
void \mbox{\hyperlink{class_scene_viewer_a0f3074198bf23399e5701d53fec54a78}{on\+Enter}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_ac8ac929204cd5dbe735e893d16302970}{on\+Leave}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a91ae075d7414f6b91b6e8336c05d6936}{wheel\+Event}} (QWheel\+Event $\ast$) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a0075f82c0dcd4bdcad064d7ec937f7bf}{key\+Press\+Event}} (QKey\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a0c718a9876f69f618e6b20bdc9c48c75}{key\+Release\+Event}} (QKey\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a469f52509581e555b01fa0c80f90003f}{context\+Menu\+Event}} (QContext\+Menu\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a39991122d25bf859b7eefd06ed1b4aae}{input\+Method\+Event}} (QInput\+Method\+Event $\ast$) override
\item 
\mbox{\Hypertarget{class_scene_viewer_a89fea0dae8ff2f1d79c289a3b03e1617}\label{class_scene_viewer_a89fea0dae8ff2f1d79c289a3b03e1617}} 
void {\bfseries draw\+Compared} ()
\item 
bool \mbox{\hyperlink{class_scene_viewer_ab7198c31eb441b64ad016abdb4bdb255}{event}} (QEvent $\ast$event) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a1b750121ec0e522ef3c43decb62ec86d}{pan\+Qt}} (const QPointF \&delta)
\item 
void \mbox{\hyperlink{class_scene_viewer_a474e47442ee803ddb71c6d5484806b28}{zoom\+Qt}} (const QPoint \&center, double scale\+Factor)
\item 
void \mbox{\hyperlink{class_scene_viewer_afa2e6bab02b6f9719b262b3f38d8f86f}{pan}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&delta) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a1144b3007e23076105bd42b02a127e9d}{zoom}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&center, double factor) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a0dfe29f7fe83caa0ccde4ea0f35ee3ed}{rotate}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&center, double angle) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a98b5fbea26ca3b3cc40521d73984dc96}{rotate3D}} (double d\+Phi, double d\+Theta) override
\item 
\mbox{\Hypertarget{class_scene_viewer_acf27145f1257de7de0b1d90c6ed1191a}\label{class_scene_viewer_acf27145f1257de7de0b1d90c6ed1191a}} 
\mbox{\hyperlink{class_t_affine}{TAffine}} {\bfseries get\+Tool\+Matrix} () const
\item 
int \mbox{\hyperlink{class_scene_viewer_a1163bd98365b4eb35ce09634ea16aff6}{pick}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&point) override
\item 
int \mbox{\hyperlink{class_scene_viewer_af778bc35f05229be9939d407b964ad9d}{pos\+To\+Column\+Index}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p, double distance, bool include\+Invisible=true) const override
\item 
void \mbox{\hyperlink{class_scene_viewer_adc621b10faeca523c68f80bc50a9939e}{pos\+To\+Column\+Indexes}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p, std\+::vector$<$ int $>$ \&indexes, double distance, bool include\+Invisible=true) const override
\item 
int \mbox{\hyperlink{class_scene_viewer_aa2973e9567ddbbfd62d853f96ba26c7a}{pos\+To\+Row}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p, double distance, bool include\+Invisible=true, bool current\+Column\+Only=false) const override
\item 
void \mbox{\hyperlink{class_scene_viewer_a1909248612d4efaec74072bd9856b121}{drag\+Enter\+Event}} (QDrag\+Enter\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a4247b4210012d911d749cdfc0262a194}{drop\+Event}} (QDrop\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_scene_viewer_a8f6aba7f3c756ab3f44b6d3c706098df}{reset\+Input\+Method}} () override
\item 
void \mbox{\hyperlink{class_scene_viewer_a815ed36c49a2b65f33464544a229056b}{set3\+DLeft\+Side\+View}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_ac6ce34accfa0ad79675753a48cdec07c}{set3\+DRight\+Side\+View}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_adbd7edc9abfe7a258f50fcdfe3ac32a7}{set3\+DTop\+View}} ()
\item 
void \mbox{\hyperlink{class_scene_viewer_a80e2fb17aa36a8a882331be5b2025726}{set\+Focus}} () override
\item 
void \mbox{\hyperlink{class_scene_viewer_aa48b27ed062e2d8a0e98566adcad6084}{register\+Context}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_affine}{TAffine}} \mbox{\hyperlink{class_scene_viewer_a72a668b675b54e9c1518c473d9a34193}{m\+\_\+draw\+Camera\+Aff}}
\item 
\mbox{\hyperlink{class_t_affine}{TAffine}} \mbox{\hyperlink{class_scene_viewer_aaf3c82f7af6c36fc5950e84c8e400ffb}{m\+\_\+draw\+Table\+Aff}}
\item 
bool \mbox{\hyperlink{class_scene_viewer_ad23acf9952775fe08a93239d56b7c241}{m\+\_\+draw3\+DMode}}
\item 
bool \mbox{\hyperlink{class_scene_viewer_a458f78b423b3f1447987aa9c1190de47}{m\+\_\+draw\+Camera\+Test}}
\item 
bool \mbox{\hyperlink{class_scene_viewer_aab69590762709fa8e8a3ae1c1a459145}{m\+\_\+draw\+Is\+Table\+Visible}}
\item 
bool \mbox{\hyperlink{class_scene_viewer_a080fbba06260c062057ceca5e9bb164e}{m\+\_\+draw\+Editing\+Level}}
\item 
\mbox{\hyperlink{class_t_rect_t}{TRect}} \mbox{\hyperlink{class_scene_viewer_a121d535ed9bd89cfa48c5542ca468828}{m\+\_\+actual\+Clip\+Rect}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Member Enumeration Documentation}
\mbox{\Hypertarget{class_scene_viewer_ab7cb6feddf6a1dbda62aeeb52d01a8ea}\label{class_scene_viewer_ab7cb6feddf6a1dbda62aeeb52d01a8ea}} 
\index{SceneViewer@{SceneViewer}!PreviewMode@{PreviewMode}}
\index{PreviewMode@{PreviewMode}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{PreviewMode}{PreviewMode}}
{\footnotesize\ttfamily enum Scene\+Viewer\+::\+Preview\+Mode}


\begin{DoxyCode}{0}
\DoxyCodeLine{00208 \{ NO\_PREVIEW = 0, FULL\_PREVIEW = 1, SUBCAMERA\_PREVIEW = 2 \};}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_aabb37d26967c0e0f76f24a8b0be68bd9}\label{class_scene_viewer_aabb37d26967c0e0f76f24a8b0be68bd9}} 
\index{SceneViewer@{SceneViewer}!ReferenceMode@{ReferenceMode}}
\index{ReferenceMode@{ReferenceMode}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{ReferenceMode}{ReferenceMode}}
{\footnotesize\ttfamily enum Scene\+Viewer\+::\+Reference\+Mode}


\begin{DoxyCode}{0}
\DoxyCodeLine{00198                      \{}
\DoxyCodeLine{00199     NORMAL\_REFERENCE   = 1,}
\DoxyCodeLine{00200     CAMERA3D\_REFERENCE = 2,}
\DoxyCodeLine{00201     CAMERA\_REFERENCE   = 3,}
\DoxyCodeLine{00202     LEVEL\_MODE         = 128,}
\DoxyCodeLine{00203   \};}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a3a29da05639b81af39e9598f7f681812}\label{class_scene_viewer_a3a29da05639b81af39e9598f7f681812}} 
\index{SceneViewer@{SceneViewer}!ViewMode@{ViewMode}}
\index{ViewMode@{ViewMode}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{ViewMode}{ViewMode}}
{\footnotesize\ttfamily enum Scene\+Viewer\+::\+View\+Mode}


\begin{DoxyCode}{0}
\DoxyCodeLine{00206 \{ SCENE\_VIEWMODE = 0, LEVEL\_VIEWMODE = 1 \};}

\end{DoxyCode}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_scene_viewer_adb67280796f09a6800e531a389eb7dae}\label{class_scene_viewer_adb67280796f09a6800e531a389eb7dae}} 
\index{SceneViewer@{SceneViewer}!SceneViewer@{SceneViewer}}
\index{SceneViewer@{SceneViewer}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{SceneViewer()}{SceneViewer()}}
{\footnotesize\ttfamily Scene\+Viewer\+::\+Scene\+Viewer (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_image_utils_1_1_full_screen_widget}{Image\+Utils\+::\+Full\+Screen\+Widget}} $\ast$}]{parent }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00743     : \mbox{\hyperlink{class_g_l_widget_for_high_dpi}{GLWidgetForHighDpi}}(parent)}
\DoxyCodeLine{00744     , m\_pressure(0)}
\DoxyCodeLine{00745     , m\_lastMousePos(0, 0)}
\DoxyCodeLine{00746     , m\_mouseButton(Qt::NoButton)}
\DoxyCodeLine{00747     , m\_foregroundDrawing(\textcolor{keyword}{false})}
\DoxyCodeLine{00748     , m\_tabletEvent(\textcolor{keyword}{false})}
\DoxyCodeLine{00749     , m\_tabletMove(\textcolor{keyword}{false})}
\DoxyCodeLine{00750     , m\_buttonClicked(\textcolor{keyword}{false})}
\DoxyCodeLine{00751     , m\_referenceMode(NORMAL\_REFERENCE)}
\DoxyCodeLine{00752     , m\_previewMode(NO\_PREVIEW)}
\DoxyCodeLine{00753     , m\_isMouseEntered(\textcolor{keyword}{false})}
\DoxyCodeLine{00754     , m\_forceGlFlush(\textcolor{keyword}{true})}
\DoxyCodeLine{00755     , m\_freezedStatus(NO\_FREEZED)}
\DoxyCodeLine{00756     , m\_viewGrabImage(0)}
\DoxyCodeLine{00757     , m\_FPS(0)}
\DoxyCodeLine{00758     , m\_hRuler(0)}
\DoxyCodeLine{00759     , m\_vRuler(0)}
\DoxyCodeLine{00760     , m\_viewMode(SCENE\_VIEWMODE)}
\DoxyCodeLine{00761     , m\_pos(0, 0)}
\DoxyCodeLine{00762     , m\_pan3D(\mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0))}
\DoxyCodeLine{00763     , m\_zoomScale3D(0.1)}
\DoxyCodeLine{00764     , m\_theta3D(20)}
\DoxyCodeLine{00765     , m\_phi3D(30)}
\DoxyCodeLine{00766     , m\_dpiScale(\mbox{\hyperlink{class_t_point_t}{TPointD}}(1, 1))}
\DoxyCodeLine{00767     , m\_compareSettings()}
\DoxyCodeLine{00768     , m\_minZ(0)}
\DoxyCodeLine{00769     , m\_tableDLId(-\/1)}
\DoxyCodeLine{00770     , m\_groupIndexToBeEntered(-\/1)}
\DoxyCodeLine{00771     , m\_pixelSize(1)}
\DoxyCodeLine{00772     , m\_eraserPointerOn(\textcolor{keyword}{false})}
\DoxyCodeLine{00773     , m\_backupTool(\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00774     , m\_clipRect()}
\DoxyCodeLine{00775     , m\_isPicking(\textcolor{keyword}{false})}
\DoxyCodeLine{00776     , m\_current3DDevice(NONE)}
\DoxyCodeLine{00777     , m\_sideRasterPos()}
\DoxyCodeLine{00778     , m\_topRasterPos()}
\DoxyCodeLine{00779     , m\_toolDisableReason(\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00780     , m\_editPreviewSubCamera(\textcolor{keyword}{false})}
\DoxyCodeLine{00781     , m\_locator(NULL)}
\DoxyCodeLine{00782     , m\_isLocator(\textcolor{keyword}{false})}
\DoxyCodeLine{00783     , m\_isBusyOnTabletMove(\textcolor{keyword}{false})}
\DoxyCodeLine{00784     , m\_timer(\textcolor{keyword}{nullptr}) \{}
\DoxyCodeLine{00785   \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_ab6461a28653bae19432d998149564b43}{m\_sceneProperties}} =}
\DoxyCodeLine{00786       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}();}
\DoxyCodeLine{00787 \textcolor{preprocessor}{\#if defined(x64)}}
\DoxyCodeLine{00788   m\_stopMotion = StopMotion::instance();}
\DoxyCodeLine{00789 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00790   \textcolor{comment}{// Enables multiple key input.}}
\DoxyCodeLine{00791   setAttribute(Qt::WA\_KeyCompression);}
\DoxyCodeLine{00792   \textcolor{comment}{// Enables input methods for Asian languages.}}
\DoxyCodeLine{00793   setAttribute(Qt::WA\_InputMethodEnabled);}
\DoxyCodeLine{00794   setFocusPolicy(Qt::StrongFocus);}
\DoxyCodeLine{00795   setAcceptDrops(\textcolor{keyword}{true});}
\DoxyCodeLine{00796   this-\/>setMouseTracking(\textcolor{keyword}{true});}
\DoxyCodeLine{00797 \textcolor{comment}{// introduced from Qt 5.9}}
\DoxyCodeLine{00798 \textcolor{preprocessor}{\#if QT\_VERSION >= 0x050900}}
\DoxyCodeLine{00799   this-\/>setTabletTracking(\textcolor{keyword}{true});}
\DoxyCodeLine{00800 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00801 }
\DoxyCodeLine{00802   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < m\_viewAff.size(); ++i) \{}
\DoxyCodeLine{00803     setViewMatrix(getNormalZoomScale(), i);}
\DoxyCodeLine{00804     m\_rotationAngle[i] = 0.0;}
\DoxyCodeLine{00805   \}}
\DoxyCodeLine{00806 }
\DoxyCodeLine{00807   m\_3DSideR = rasterFromQPixmap(svgToPixmap(\textcolor{stringliteral}{"{}:Resources/3Dside\_r.svg"{}}));}
\DoxyCodeLine{00808   m\_3DSideL = rasterFromQPixmap(svgToPixmap(\textcolor{stringliteral}{"{}:Resources/3Dside\_l.svg"{}}));}
\DoxyCodeLine{00809   m\_3DTop   = rasterFromQPixmap(svgToPixmap(\textcolor{stringliteral}{"{}:Resources/3Dtop.svg"{}}));}
\DoxyCodeLine{00810 }
\DoxyCodeLine{00811   setAttribute(Qt::WA\_AcceptTouchEvents);}
\DoxyCodeLine{00812   grabGesture(Qt::SwipeGesture);}
\DoxyCodeLine{00813   grabGesture(Qt::PanGesture);}
\DoxyCodeLine{00814   grabGesture(Qt::PinchGesture);}
\DoxyCodeLine{00815 }
\DoxyCodeLine{00816   setUpdateBehavior(QOpenGLWidget::PartialUpdate);}
\DoxyCodeLine{00817 }
\DoxyCodeLine{00818   \textcolor{keywordflow}{if} (Preferences::instance()-\/>isColorCalibrationEnabled())}
\DoxyCodeLine{00819     m\_lutCalibrator = \textcolor{keyword}{new} \mbox{\hyperlink{class_lut_calibrator}{LutCalibrator}}();}
\DoxyCodeLine{00820   \textcolor{keywordflow}{if} (Preferences::instance()-\/>is30bitDisplayEnabled())}
\DoxyCodeLine{00821     setTextureFormat(TGL\_TexFmt10);}
\DoxyCodeLine{00822 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ad371d5a2deaf8b4459670ca8748ba663}\label{class_scene_viewer_ad371d5a2deaf8b4459670ca8748ba663}} 
\index{SceneViewer@{SceneViewer}!````~SceneViewer@{$\sim$SceneViewer}}
\index{````~SceneViewer@{$\sim$SceneViewer}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{$\sim$SceneViewer()}{~SceneViewer()}}
{\footnotesize\ttfamily Scene\+Viewer\+::$\sim$\+Scene\+Viewer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00838                           \{}
\DoxyCodeLine{00839   \textcolor{comment}{// notify FilmStripFrames and safely disconnect with this}}
\DoxyCodeLine{00840   emit aboutToBeDestroyed();}
\DoxyCodeLine{00841 }
\DoxyCodeLine{00842   \textcolor{keywordflow}{if} (m\_fbo) \textcolor{keyword}{delete} m\_fbo;}
\DoxyCodeLine{00843 }
\DoxyCodeLine{00844   \textcolor{comment}{// release all the registered context (once when exit the software)}}
\DoxyCodeLine{00845   std::set<TGlContext>::iterator ct, cEnd(l\_contexts.end());}
\DoxyCodeLine{00846   \textcolor{keywordflow}{for} (ct = l\_contexts.begin(); ct != cEnd; ++ct)}
\DoxyCodeLine{00847     TGLDisplayListsManager::instance()-\/>\mbox{\hyperlink{class_t_g_l_display_lists_manager_a9b723e490c97425b39b238a2d7ad5877}{releaseContext}}(*ct);}
\DoxyCodeLine{00848   l\_contexts.clear();}
\DoxyCodeLine{00849 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_scene_viewer_ab4227c932f0d4a15dd88bd17492c318c}\label{class_scene_viewer_ab4227c932f0d4a15dd88bd17492c318c}} 
\index{SceneViewer@{SceneViewer}!bindFBO@{bindFBO}}
\index{bindFBO@{bindFBO}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{bindFBO()}{bindFBO()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::bind\+FBO (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03282                           \{}
\DoxyCodeLine{03283   \textcolor{keywordflow}{if} (m\_fbo) m\_fbo-\/>bind();}
\DoxyCodeLine{03284 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a07090c8e03ffdbaa5e79726cecbe7106}\label{class_scene_viewer_a07090c8e03ffdbaa5e79726cecbe7106}} 
\index{SceneViewer@{SceneViewer}!canSwapCompared@{canSwapCompared}}
\index{canSwapCompared@{canSwapCompared}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{canSwapCompared()}{canSwapCompared()}}
{\footnotesize\ttfamily bool Scene\+Viewer\+::can\+Swap\+Compared (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{03222                                         \{}
\DoxyCodeLine{03223   \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_af46b586bd61bf70e606713bee68c3aad}{m\_doCompare}} \&\& m\_previewMode != NO\_PREVIEW;}
\DoxyCodeLine{03224 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a469f52509581e555b01fa0c80f90003f}\label{class_scene_viewer_a469f52509581e555b01fa0c80f90003f}} 
\index{SceneViewer@{SceneViewer}!contextMenuEvent@{contextMenuEvent}}
\index{contextMenuEvent@{contextMenuEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{contextMenuEvent()}{contextMenuEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::context\+Menu\+Event (\begin{DoxyParamCaption}\item[{QContext\+Menu\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01635                                                        \{}
\DoxyCodeLine{01636   \textcolor{keywordflow}{if} (m\_tabletEvent) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01637 \textcolor{preprocessor}{\#ifndef \_WIN32}}
\DoxyCodeLine{01638   \textcolor{comment}{/* On windows the widget receive the release event before the menu}}
\DoxyCodeLine{01639 \textcolor{comment}{     is shown, on linux and osx the release event is lost, never}}
\DoxyCodeLine{01640 \textcolor{comment}{     received by the widget */}}
\DoxyCodeLine{01641   QMouseEvent fakeRelease(QEvent::MouseButtonRelease, e-\/>pos(), Qt::RightButton,}
\DoxyCodeLine{01642                           Qt::NoButton, Qt::NoModifier);}
\DoxyCodeLine{01643 }
\DoxyCodeLine{01644   QApplication::instance()-\/>sendEvent(\textcolor{keyword}{this}, \&fakeRelease);}
\DoxyCodeLine{01645 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01646 }
\DoxyCodeLine{01647   onContextMenu(e-\/>pos(), e-\/>globalPos());}
\DoxyCodeLine{01648 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_adea94782b23124e656a813ccc6155210}\label{class_scene_viewer_adea94782b23124e656a813ccc6155210}} 
\index{SceneViewer@{SceneViewer}!doDeleteSubCamera@{doDeleteSubCamera}}
\index{doDeleteSubCamera@{doDeleteSubCamera}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{doDeleteSubCamera}{doDeleteSubCamera}}
{\footnotesize\ttfamily void Scene\+Viewer\+::do\+Delete\+Sub\+Camera (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}

delete preview -\/ subcamera executed from context menu 
\begin{DoxyCode}{0}
\DoxyCodeLine{03276                                     \{}
\DoxyCodeLine{03277   PreviewSubCameraManager::instance()-\/>\mbox{\hyperlink{class_preview_sub_camera_manager_a31de45a99c892ac1a693462722a1e489}{deleteSubCamera}}(\textcolor{keyword}{this});}
\DoxyCodeLine{03278 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00338}{Preview\+Sub\+Camera\+Manager\+::delete\+Sub\+Camera()}}.

\mbox{\Hypertarget{class_scene_viewer_a1909248612d4efaec74072bd9856b121}\label{class_scene_viewer_a1909248612d4efaec74072bd9856b121}} 
\index{SceneViewer@{SceneViewer}!dragEnterEvent@{dragEnterEvent}}
\index{dragEnterEvent@{dragEnterEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{dragEnterEvent()}{dragEnterEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::drag\+Enter\+Event (\begin{DoxyParamCaption}\item[{QDrag\+Enter\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01707                                                        \{}
\DoxyCodeLine{01708   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01709 }
\DoxyCodeLine{01710   \textcolor{keyword}{const} QMimeData *mimeData = \textcolor{keyword}{event}-\/>mimeData();}
\DoxyCodeLine{01711 }
\DoxyCodeLine{01712   \textcolor{keywordflow}{if} (acceptResourceOrFolderDrop(mimeData-\/>urls())) \{}
\DoxyCodeLine{01713     \textcolor{comment}{// Force CopyAction}}
\DoxyCodeLine{01714     \textcolor{keyword}{event}-\/>setDropAction(Qt::CopyAction);}
\DoxyCodeLine{01715     \textcolor{keyword}{event}-\/>accept();}
\DoxyCodeLine{01716   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01717     \textcolor{keyword}{event}-\/>ignore();}
\DoxyCodeLine{01718   \}}
\DoxyCodeLine{01719 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_afe39eb304a79ac869b11b663e9f109c8}\label{class_scene_viewer_afe39eb304a79ac869b11b663e9f109c8}} 
\index{SceneViewer@{SceneViewer}!drawBackground@{drawBackground}}
\index{drawBackground@{drawBackground}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{drawBackground()}{drawBackground()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::draw\+Background (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01367                                  \{}
\DoxyCodeLine{01368   \mbox{\hyperlink{class_t_app}{TApp}} *app         = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{01369   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene = app-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{01370 }
\DoxyCodeLine{01371   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_a84bb519ec0ab16029cba33ff0f3f794f}{m\_colorMask}} == 0) \{}
\DoxyCodeLine{01372     TPixel32 bgColor;}
\DoxyCodeLine{01373 }
\DoxyCodeLine{01374     \textcolor{keywordflow}{if} (isPreviewEnabled())}
\DoxyCodeLine{01375       bgColor = Preferences::instance()-\/>getPreviewBgColor();}
\DoxyCodeLine{01376     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01377       bgColor = Preferences::instance()-\/>getViewerBgColor();}
\DoxyCodeLine{01378     glClearColor(bgColor.r / 255.0f, bgColor.g / 255.0f, bgColor.b / 255.0f,}
\DoxyCodeLine{01379                  1.0);}
\DoxyCodeLine{01380   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01381     glClearColor(0, 0, 0, 1.0);}
\DoxyCodeLine{01382 }
\DoxyCodeLine{01383   glClear(GL\_COLOR\_BUFFER\_BIT);}
\DoxyCodeLine{01384   \textcolor{keywordflow}{if} (glGetError() == GL\_INVALID\_FRAMEBUFFER\_OPERATION) \{}
\DoxyCodeLine{01385     \textcolor{comment}{/* 起動時一回目になぜか GL\_FRAMEBUFFER\_COMPLETE なのに invalid operation}}
\DoxyCodeLine{01386 \textcolor{comment}{     * が出る  */}}
\DoxyCodeLine{01387     GLenum status = 0;}
\DoxyCodeLine{01388 \textcolor{preprocessor}{\#ifdef \_WIN32}}
\DoxyCodeLine{01389     PROC proc = wglGetProcAddress(\textcolor{stringliteral}{"{}glCheckFramebufferStatusEXT"{}});}
\DoxyCodeLine{01390     \textcolor{keywordflow}{if} (proc != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{01391       status = \textcolor{keyword}{reinterpret\_cast<}PFNGLCHECKFRAMEBUFFERSTATUSEXTPROC\textcolor{keyword}{>}(proc)(}
\DoxyCodeLine{01392           GL\_FRAMEBUFFER);}
\DoxyCodeLine{01393 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01394     status = glCheckFramebufferStatus(GL\_FRAMEBUFFER);}
\DoxyCodeLine{01395 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01396     printf(\textcolor{stringliteral}{"{}GL\_INVALID\_FRAMEBUFFER\_OPERATION: framebuffer:\%d\(\backslash\)n"{}}, status);}
\DoxyCodeLine{01397   \}}
\DoxyCodeLine{01398 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a82bd279f9e7a5cd329511874367ff6ac}\label{class_scene_viewer_a82bd279f9e7a5cd329511874367ff6ac}} 
\index{SceneViewer@{SceneViewer}!drawBuildVars@{drawBuildVars}}
\index{drawBuildVars@{drawBuildVars}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{drawBuildVars()}{drawBuildVars()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::draw\+Build\+Vars (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01297                                 \{}
\DoxyCodeLine{01298   \mbox{\hyperlink{class_t_app}{TApp}} *app = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{01299 }
\DoxyCodeLine{01300   \textcolor{keywordtype}{int} frame    = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{01301   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh = app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet();}
\DoxyCodeLine{01302 }
\DoxyCodeLine{01303   \textcolor{comment}{// Camera affine}}
\DoxyCodeLine{01304   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} cameraId = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a5dc925584e35e1678f5678b79c470959}{getStageObjectTree}}()-\/>\mbox{\hyperlink{class_t_stage_object_tree_a7d63ae5d60c3a3aacf5da58c108ac167}{getCurrentCameraId}}();}
\DoxyCodeLine{01305   \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *camera    = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(cameraId);}
\DoxyCodeLine{01306   \mbox{\hyperlink{class_t_affine}{TAffine}} cameraPlacement = camera-\/>getPlacement(frame);}
\DoxyCodeLine{01307   \textcolor{keywordtype}{double} cameraZ          = camera-\/>\mbox{\hyperlink{class_t_stage_object_a52b1a3ec50ed35fbc07c9a3b64ecc21c}{getZ}}(frame);}
\DoxyCodeLine{01308 }
\DoxyCodeLine{01309   m\_drawCameraAff =}
\DoxyCodeLine{01310       \mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}() * cameraPlacement * \mbox{\hyperlink{class_t_scale}{TScale}}((1000 + cameraZ) / 1000);}
\DoxyCodeLine{01311 }
\DoxyCodeLine{01312   \textcolor{comment}{// Table affine}}
\DoxyCodeLine{01313   \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *table    = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(TStageObjectId::TableId);}
\DoxyCodeLine{01314   \mbox{\hyperlink{class_t_affine}{TAffine}} tablePlacement = table-\/>getPlacement(frame);}
\DoxyCodeLine{01315   \textcolor{keywordtype}{double} tableZ          = table-\/>\mbox{\hyperlink{class_t_stage_object_a52b1a3ec50ed35fbc07c9a3b64ecc21c}{getZ}}(frame);}
\DoxyCodeLine{01316   \mbox{\hyperlink{class_t_affine}{TAffine}} placement;}
\DoxyCodeLine{01317 }
\DoxyCodeLine{01318   m\_drawIsTableVisible = \mbox{\hyperlink{class_t_stage_object_a0f219cbc4e42269c0fbd073a62253218}{TStageObject::perspective}}(}
\DoxyCodeLine{01319       placement, cameraPlacement, cameraZ, tablePlacement, tableZ, 0);}
\DoxyCodeLine{01320   m\_drawTableAff = \mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}() * tablePlacement;}
\DoxyCodeLine{01321 }
\DoxyCodeLine{01322   \textcolor{comment}{// Camera test check}}
\DoxyCodeLine{01323   m\_drawCameraTest = \mbox{\hyperlink{class_camera_test_check_adc1033b93dea95f49db36d8fb668e16d}{CameraTestCheck::instance}}()-\/>isEnabled();}
\DoxyCodeLine{01324 }
\DoxyCodeLine{01325   \textcolor{keywordflow}{if} (m\_previewMode == NO\_PREVIEW) \{}
\DoxyCodeLine{01326     m\_drawEditingLevel = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isEditingLevel();}
\DoxyCodeLine{01327     m\_viewMode         = m\_drawEditingLevel ? LEVEL\_VIEWMODE : SCENE\_VIEWMODE;}
\DoxyCodeLine{01328     m\_draw3DMode       = is3DView() \&\& (m\_previewMode != SUBCAMERA\_PREVIEW);}
\DoxyCodeLine{01329   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01330     m\_drawEditingLevel = \textcolor{keyword}{false};}
\DoxyCodeLine{01331     m\_viewMode         = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isEditingLevel();}
\DoxyCodeLine{01332     m\_draw3DMode       = \textcolor{keyword}{false};}
\DoxyCodeLine{01333   \}}
\DoxyCodeLine{01334 }
\DoxyCodeLine{01335   \textcolor{comment}{// Clip rect}}
\DoxyCodeLine{01336   \textcolor{keywordflow}{if} (!m\_clipRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}() \&\& !m\_draw3DMode) \{}
\DoxyCodeLine{01337     m\_actualClipRect = getActualClipRect(\mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}());}
\DoxyCodeLine{01338     m\_actualClipRect += \mbox{\hyperlink{class_t_point_t}{TPoint}}(width() * 0.5, height() * 0.5);}
\DoxyCodeLine{01339   \}}
\DoxyCodeLine{01340 }
\DoxyCodeLine{01341   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = app-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{01342   \textcolor{keywordflow}{if} (tool \&\& !m\_isLocator) tool-\/>setViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{01343 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_aa7c81725cc6d3628d8f3ffa69a9e351f}\label{class_scene_viewer_aa7c81725cc6d3628d8f3ffa69a9e351f}} 
\index{SceneViewer@{SceneViewer}!drawCameraStand@{drawCameraStand}}
\index{drawCameraStand@{drawCameraStand}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{drawCameraStand()}{drawCameraStand()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::draw\+Camera\+Stand (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01434                                   \{}
\DoxyCodeLine{01435   GLint e = glGetError();}
\DoxyCodeLine{01436   check\_framebuffer\_status();}
\DoxyCodeLine{01437   assert(e == GL\_NO\_ERROR);}
\DoxyCodeLine{01438 }
\DoxyCodeLine{01439   TXshSimpleLevel::m\_rasterizePli = rasterizePliToggle.getStatus();}
\DoxyCodeLine{01440 }
\DoxyCodeLine{01441   \textcolor{comment}{// clear}}
\DoxyCodeLine{01442   \textcolor{keywordflow}{if} (m\_draw3DMode) \{}
\DoxyCodeLine{01443     glEnable(GL\_DEPTH\_TEST);}
\DoxyCodeLine{01444     glDepthFunc(GL\_ALWAYS);}
\DoxyCodeLine{01445     glClear(GL\_DEPTH\_BUFFER\_BIT);}
\DoxyCodeLine{01446     glPushMatrix();}
\DoxyCodeLine{01447     mult3DMatrix();}
\DoxyCodeLine{01448   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01449     glDisable(GL\_DEPTH\_TEST);}
\DoxyCodeLine{01450 }
\DoxyCodeLine{01451   assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{01452 }
\DoxyCodeLine{01453   \textcolor{comment}{// draw table}}
\DoxyCodeLine{01454   \textcolor{keywordflow}{if} (!m\_draw3DMode \&\& viewTableToggle.getStatus() \&\& m\_drawIsTableVisible \&\&}
\DoxyCodeLine{01455       \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_a84bb519ec0ab16029cba33ff0f3f794f}{m\_colorMask}} == 0 \&\& m\_drawEditingLevel == \textcolor{keyword}{false} \&\&}
\DoxyCodeLine{01456       !m\_drawCameraTest) \{}
\DoxyCodeLine{01457     glPushMatrix();}
\DoxyCodeLine{01458     tglMultMatrix(m\_drawTableAff);}
\DoxyCodeLine{01459     ViewerDraw::drawDisk(m\_tableDLId);}
\DoxyCodeLine{01460     glPopMatrix();}
\DoxyCodeLine{01461   \}}
\DoxyCodeLine{01462 }
\DoxyCodeLine{01463   \textcolor{comment}{// draw colorcard (with camera BG color)}}
\DoxyCodeLine{01464   \textcolor{comment}{// Hide camera BG when level editing mode.}}
\DoxyCodeLine{01465   \textcolor{keywordflow}{if} (m\_drawEditingLevel == \textcolor{keyword}{false} \&\& viewClcToggle.getStatus() \&\&}
\DoxyCodeLine{01466       !m\_drawCameraTest) \{}
\DoxyCodeLine{01467     glPushMatrix();}
\DoxyCodeLine{01468     tglMultMatrix(m\_drawCameraAff);}
\DoxyCodeLine{01469     glEnable(GL\_BLEND);}
\DoxyCodeLine{01470     glBlendFunc(GL\_SRC\_ALPHA, GL\_ONE\_MINUS\_SRC\_ALPHA);}
\DoxyCodeLine{01471     ViewerDraw::drawColorcard(\mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_a84bb519ec0ab16029cba33ff0f3f794f}{m\_colorMask}});}
\DoxyCodeLine{01472     glDisable(GL\_BLEND);}
\DoxyCodeLine{01473     glPopMatrix();}
\DoxyCodeLine{01474   \}}
\DoxyCodeLine{01475 }
\DoxyCodeLine{01476   \textcolor{comment}{// Show white background when level editing mode.}}
\DoxyCodeLine{01477   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{01478   \textcolor{keywordflow}{if} (m\_drawEditingLevel \&\& tool \&\& tool-\/>isEnabled()) \{}
\DoxyCodeLine{01479     \textcolor{keywordflow}{if} (!m\_isLocator) tool-\/>setViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{01480     glPushMatrix();}
\DoxyCodeLine{01481     \textcolor{keywordflow}{if} (m\_referenceMode == CAMERA3D\_REFERENCE) \{}
\DoxyCodeLine{01482       mult3DMatrix();}
\DoxyCodeLine{01483       tglMultMatrix(tool-\/>getMatrix());}
\DoxyCodeLine{01484     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01485       tglMultMatrix(\mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}() * tool-\/>getMatrix());}
\DoxyCodeLine{01486     \}}
\DoxyCodeLine{01487     glScaled(m\_dpiScale.x, m\_dpiScale.y, 1);}
\DoxyCodeLine{01488 }
\DoxyCodeLine{01489     \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} image = tool-\/>\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{false});}
\DoxyCodeLine{01490 }
\DoxyCodeLine{01491     \mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}} ti  = image;}
\DoxyCodeLine{01492     \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri = image;}
\DoxyCodeLine{01493     \textcolor{keywordflow}{if} (ti) \{}
\DoxyCodeLine{01494       \mbox{\hyperlink{class_t_rect_t}{TRect}} imgRect(0, 0, ti-\/>getSize().lx -\/ 1, ti-\/>getSize().ly -\/ 1);}
\DoxyCodeLine{01495       \mbox{\hyperlink{class_t_rect_t}{TRectD}} bbox = ToonzImageUtils::convertRasterToWorld(imgRect, ti);}
\DoxyCodeLine{01496 }
\DoxyCodeLine{01497       TPixel32 imgRectColor;}
\DoxyCodeLine{01498       \textcolor{comment}{// draw black rectangle instead, if the BlackBG check is ON}}
\DoxyCodeLine{01499       \textcolor{keywordflow}{if} (ToonzCheck::instance()-\/>getChecks() \& \mbox{\hyperlink{class_toonz_check_add5b28b42f552cf90e3cfcde9e737876ab6d35869ac2f7cfc956d498b2089a1ff}{ToonzCheck::eBlackBg}})}
\DoxyCodeLine{01500         imgRectColor = TPixel::Black;}
\DoxyCodeLine{01501       \textcolor{keywordflow}{else}}
\DoxyCodeLine{01502         imgRectColor = Preferences::instance()-\/>getLevelEditorBoxColor();}
\DoxyCodeLine{01503       ToolUtils::fillRect(bbox * ti-\/>getSubsampling(), imgRectColor);}
\DoxyCodeLine{01504     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ri) \{}
\DoxyCodeLine{01505       \mbox{\hyperlink{class_t_rect_t}{TRectD}} bbox = ri-\/>getBBox();}
\DoxyCodeLine{01506       bbox.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} -\/= ri-\/>getBBox().getLx() * 0.5;}
\DoxyCodeLine{01507       bbox.x1 -\/= ri-\/>getBBox().getLx() * 0.5;}
\DoxyCodeLine{01508       bbox.y0 -\/= ri-\/>getBBox().getLy() * 0.5;}
\DoxyCodeLine{01509       bbox.y1 -\/= ri-\/>getBBox().getLy() * 0.5;}
\DoxyCodeLine{01510 }
\DoxyCodeLine{01511       TPixel32 imgRectColor;}
\DoxyCodeLine{01512       \textcolor{comment}{// draw black rectangle instead, if the BlackBG check is ON}}
\DoxyCodeLine{01513       \textcolor{keywordflow}{if} (ToonzCheck::instance()-\/>getChecks() \& \mbox{\hyperlink{class_toonz_check_add5b28b42f552cf90e3cfcde9e737876ab6d35869ac2f7cfc956d498b2089a1ff}{ToonzCheck::eBlackBg}})}
\DoxyCodeLine{01514         imgRectColor = TPixel::Black;}
\DoxyCodeLine{01515       \textcolor{keywordflow}{else}}
\DoxyCodeLine{01516         imgRectColor = Preferences::instance()-\/>getLevelEditorBoxColor();}
\DoxyCodeLine{01517       ToolUtils::fillRect(bbox * ri-\/>getSubsampling(), imgRectColor);}
\DoxyCodeLine{01518     \}}
\DoxyCodeLine{01519     glPopMatrix();}
\DoxyCodeLine{01520   \}}
\DoxyCodeLine{01521 }
\DoxyCodeLine{01522   \textcolor{comment}{// draw 3dframe}}
\DoxyCodeLine{01523   \textcolor{keywordflow}{if} (m\_draw3DMode) \{}
\DoxyCodeLine{01524     glDepthFunc(GL\_LEQUAL);}
\DoxyCodeLine{01525     ViewerDraw::draw3DFrame(m\_minZ, m\_phi3D);}
\DoxyCodeLine{01526     glDepthFunc(GL\_ALWAYS);}
\DoxyCodeLine{01527   \}}
\DoxyCodeLine{01528 }
\DoxyCodeLine{01529   \textcolor{comment}{// draw scene}}
\DoxyCodeLine{01530   assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{01531   drawScene();}
\DoxyCodeLine{01532   assert((glGetError()) == GL\_NO\_ERROR);}
\DoxyCodeLine{01533 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a841bc094686713386e52af05c0e1be10}\label{class_scene_viewer_a841bc094686713386e52af05c0e1be10}} 
\index{SceneViewer@{SceneViewer}!drawDisableScissor@{drawDisableScissor}}
\index{drawDisableScissor@{drawDisableScissor}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{drawDisableScissor()}{drawDisableScissor()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::draw\+Disable\+Scissor (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01357                                      \{}
\DoxyCodeLine{01358   \textcolor{keywordflow}{if} (!m\_clipRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}() \&\& !m\_draw3DMode) \{}
\DoxyCodeLine{01359     glDisable(GL\_SCISSOR\_TEST);}
\DoxyCodeLine{01360   \}}
\DoxyCodeLine{01361   \textcolor{comment}{// clear the clipping rect}}
\DoxyCodeLine{01362   m\_clipRect.empty();}
\DoxyCodeLine{01363 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a682781eebe470f3d40740d46180a1b6c}\label{class_scene_viewer_a682781eebe470f3d40740d46180a1b6c}} 
\index{SceneViewer@{SceneViewer}!drawEnableScissor@{drawEnableScissor}}
\index{drawEnableScissor@{drawEnableScissor}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{drawEnableScissor()}{drawEnableScissor()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::draw\+Enable\+Scissor (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01347                                     \{}
\DoxyCodeLine{01348   \textcolor{keywordflow}{if} (!m\_clipRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}() \&\& !m\_draw3DMode) \{}
\DoxyCodeLine{01349     glEnable(GL\_SCISSOR\_TEST);}
\DoxyCodeLine{01350     glScissor(m\_actualClipRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, m\_actualClipRect.y0,}
\DoxyCodeLine{01351               m\_actualClipRect.getLx(), m\_actualClipRect.getLy());}
\DoxyCodeLine{01352   \}}
\DoxyCodeLine{01353 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a7f65aa9285528e26a555615fd8693128}\label{class_scene_viewer_a7f65aa9285528e26a555615fd8693128}} 
\index{SceneViewer@{SceneViewer}!drawOverlay@{drawOverlay}}
\index{drawOverlay@{drawOverlay}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{drawOverlay()}{drawOverlay()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::draw\+Overlay (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

camera\+Test
\begin{DoxyCode}{0}
\DoxyCodeLine{01598                               \{}
\DoxyCodeLine{01599   \mbox{\hyperlink{class_t_app}{TApp}} *app = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{01600 }
\DoxyCodeLine{01601   \textcolor{comment}{// draw camera mask}}
\DoxyCodeLine{01602   \textcolor{keywordflow}{if} (m\_referenceMode == CAMERA\_REFERENCE \&\& !m\_drawCameraTest) \{}
\DoxyCodeLine{01603     glPushMatrix();}
\DoxyCodeLine{01604     tglMultMatrix(m\_drawCameraAff);}
\DoxyCodeLine{01605     ViewerDraw::drawCameraMask(\textcolor{keyword}{this});}
\DoxyCodeLine{01606     glPopMatrix();}
\DoxyCodeLine{01607   \}}
\DoxyCodeLine{01608 }
\DoxyCodeLine{01609   \textcolor{comment}{// draw FieldGuide}}
\DoxyCodeLine{01610   \textcolor{keywordflow}{if} (fieldGuideToggle.getStatus()) \{}
\DoxyCodeLine{01611     glPushMatrix();}
\DoxyCodeLine{01612     tglMultMatrix(m\_drawTableAff);}
\DoxyCodeLine{01613     ViewerDraw::drawFieldGuide();}
\DoxyCodeLine{01614     glPopMatrix();}
\DoxyCodeLine{01615   \}}
\DoxyCodeLine{01616 }
\DoxyCodeLine{01617   \textcolor{keywordflow}{if} (!m\_drawCameraTest) \{}
\DoxyCodeLine{01618     \textcolor{comment}{// draw grid \& guides}}
\DoxyCodeLine{01619     \textcolor{keywordflow}{if} (viewGuideToggle.getStatus() \&\&}
\DoxyCodeLine{01620         ((m\_vRuler \&\& m\_vRuler-\/>getGuideCount()) ||}
\DoxyCodeLine{01621          (m\_hRuler \&\& m\_hRuler-\/>getGuideCount()))) \{}
\DoxyCodeLine{01622       glPushMatrix();}
\DoxyCodeLine{01623       tglMultMatrix(\mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}());}
\DoxyCodeLine{01624       ViewerDraw::drawGridAndGuides(}
\DoxyCodeLine{01625           \textcolor{keyword}{this}, (m\_draw3DMode) ? m\_zoomScale3D : m\_viewAff[m\_viewMode].det(),}
\DoxyCodeLine{01626           m\_vRuler, m\_hRuler, \textcolor{keyword}{false});}
\DoxyCodeLine{01627       glPopMatrix();}
\DoxyCodeLine{01628     \}}
\DoxyCodeLine{01629 }
\DoxyCodeLine{01630     \textcolor{comment}{// draw camera}}
\DoxyCodeLine{01631     \textcolor{keywordflow}{if} (viewCameraToggle.getStatus() \&\& m\_drawEditingLevel == \textcolor{keyword}{false}) \{}
\DoxyCodeLine{01632       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} f = 0;}
\DoxyCodeLine{01633       \textcolor{keywordflow}{if} (m\_referenceMode == CAMERA\_REFERENCE)}
\DoxyCodeLine{01634         f |= ViewerDraw::CAMERA\_REFERENCE;}
\DoxyCodeLine{01635       \textcolor{keywordflow}{if} (m\_draw3DMode) f |= ViewerDraw::CAMERA\_3D;}
\DoxyCodeLine{01636       \textcolor{keywordflow}{if} (m\_previewMode == SUBCAMERA\_PREVIEW || m\_editPreviewSubCamera)}
\DoxyCodeLine{01637         f |= ViewerDraw::SUBCAMERA;}
\DoxyCodeLine{01638       \textcolor{keywordflow}{if} (m\_draw3DMode)}
\DoxyCodeLine{01639         ViewerDraw::draw3DCamera(f, m\_minZ, m\_phi3D);}
\DoxyCodeLine{01640       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01641         glPushMatrix();}
\DoxyCodeLine{01642         tglMultMatrix(m\_drawCameraAff);}
\DoxyCodeLine{01643         m\_pixelSize = sqrt(tglGetPixelSize2()) * getDevPixRatio();}
\DoxyCodeLine{01644         ViewerDraw::drawCamera(f, m\_pixelSize);}
\DoxyCodeLine{01645         glPopMatrix();}
\DoxyCodeLine{01646       \}}
\DoxyCodeLine{01647     \}}
\DoxyCodeLine{01648 }
\DoxyCodeLine{01649 \textcolor{preprocessor}{\#ifdef WITH\_CANON}}
\DoxyCodeLine{01650     \textcolor{keywordflow}{if} (m\_stopMotion-\/>m\_liveViewStatus == StopMotion::LiveViewOpen \&\&}
\DoxyCodeLine{01651         app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame() ==}
\DoxyCodeLine{01652             m\_stopMotion-\/>getXSheetFrameNumber() -\/ 1) \{}
\DoxyCodeLine{01653       \textcolor{keywordtype}{int} x0, x1, y0, y1;}
\DoxyCodeLine{01654       rect().getCoords(\&x0, \&y0, \&x1, \&y1);}
\DoxyCodeLine{01655       x0 = (-\/(x1 / 2)) + 15;}
\DoxyCodeLine{01656       y0 = ((y1 / 2)) -\/ 15;}
\DoxyCodeLine{01657       tglDrawDisk(\mbox{\hyperlink{class_t_point_t}{TPointD}}(x0, y0), 10);}
\DoxyCodeLine{01658     \}}
\DoxyCodeLine{01659 }
\DoxyCodeLine{01660     \textcolor{comment}{// draw Stop Motion Zoom Box}}
\DoxyCodeLine{01661     \textcolor{keywordflow}{if} (m\_stopMotion-\/>m\_liveViewStatus == 2 \&\&}
\DoxyCodeLine{01662         m\_stopMotion-\/>m\_canon-\/>m\_pickLiveViewZoom) \{}
\DoxyCodeLine{01663       glPushMatrix();}
\DoxyCodeLine{01664       tglMultMatrix(m\_drawCameraAff);}
\DoxyCodeLine{01665       m\_pixelSize = sqrt(tglGetPixelSize2()) * getDevPixRatio();}
\DoxyCodeLine{01666       \mbox{\hyperlink{class_t_rect_t}{TRect}} rect  = m\_stopMotion-\/>m\_canon-\/>m\_zoomRect;}
\DoxyCodeLine{01667 }
\DoxyCodeLine{01668       glColor3d(1.0, 0.0, 0.0);}
\DoxyCodeLine{01669 }
\DoxyCodeLine{01670       \textcolor{comment}{// border}}
\DoxyCodeLine{01671       glBegin(GL\_LINE\_STRIP);}
\DoxyCodeLine{01672       glVertex2d(rect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, rect.y0);}
\DoxyCodeLine{01673       glVertex2d(rect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, rect.y1 -\/ m\_pixelSize);}
\DoxyCodeLine{01674       glVertex2d(rect.x1 -\/ m\_pixelSize, rect.y1 -\/ m\_pixelSize);}
\DoxyCodeLine{01675       glVertex2d(rect.x1 -\/ m\_pixelSize, rect.y0);}
\DoxyCodeLine{01676       glVertex2d(rect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, rect.y0);}
\DoxyCodeLine{01677       glEnd();}
\DoxyCodeLine{01678 }
\DoxyCodeLine{01679       glPopMatrix();}
\DoxyCodeLine{01680     \}}
\DoxyCodeLine{01681 }
\DoxyCodeLine{01682 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01683 }
\DoxyCodeLine{01684     \textcolor{comment}{// safe area}}
\DoxyCodeLine{01685     \textcolor{keywordflow}{if} (safeAreaToggle.getStatus() \&\& m\_drawEditingLevel == \textcolor{keyword}{false} \&\&}
\DoxyCodeLine{01686         !is3DView()) \{}
\DoxyCodeLine{01687       glPushMatrix();}
\DoxyCodeLine{01688       tglMultMatrix(m\_drawCameraAff);}
\DoxyCodeLine{01689       ViewerDraw::drawSafeArea();}
\DoxyCodeLine{01690       glPopMatrix();}
\DoxyCodeLine{01691     \}}
\DoxyCodeLine{01692 }
\DoxyCodeLine{01693     \textcolor{comment}{// record fps (frame per second)}}
\DoxyCodeLine{01694     \textcolor{keywordflow}{if} (app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isPlaying())}
\DoxyCodeLine{01695       m\_FPS = getActualFrameRate();}
\DoxyCodeLine{01696     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01697       m\_FPS = 0;}
\DoxyCodeLine{01698 }
\DoxyCodeLine{01699     \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \{}
\DoxyCodeLine{01700       tglColor(TPixel32::Red);}
\DoxyCodeLine{01701       tglDrawText(\mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0), \textcolor{stringliteral}{"{}FROZEN"{}});}
\DoxyCodeLine{01702     \}}
\DoxyCodeLine{01703     assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{01704 }
\DoxyCodeLine{01705   \}  }
\DoxyCodeLine{01706 }
\DoxyCodeLine{01707   \textcolor{comment}{// draw 3d Top/Side Buttons}}
\DoxyCodeLine{01708   \textcolor{keywordflow}{if} (m\_draw3DMode \&\& !m\_isPicking) \{}
\DoxyCodeLine{01709     tglColor(TPixel32::Black);}
\DoxyCodeLine{01710 }
\DoxyCodeLine{01711     GLdouble modelView3D[16];}
\DoxyCodeLine{01712     GLdouble projection3D[16];}
\DoxyCodeLine{01713     GLint viewport3D[4];}
\DoxyCodeLine{01714 }
\DoxyCodeLine{01715     glGetDoublev(GL\_MODELVIEW\_MATRIX, modelView3D);}
\DoxyCodeLine{01716     glGetDoublev(GL\_PROJECTION\_MATRIX, projection3D);}
\DoxyCodeLine{01717     glGetIntegerv(GL\_VIEWPORT, viewport3D);}
\DoxyCodeLine{01718 }
\DoxyCodeLine{01719     \textcolor{keywordflow}{if} (m\_phi3D > 0) \{}
\DoxyCodeLine{01720       \mbox{\hyperlink{class_t3_d_point_t}{T3DPointD}} topRasterPos3D = computeNew3DPosition(}
\DoxyCodeLine{01721           \mbox{\hyperlink{class_t3_d_point_t}{T3DPointD}}(500, 500, 1000), \mbox{\hyperlink{class_t_point_t}{TPointD}}(-\/10, -\/10), m\_topRasterPos,}
\DoxyCodeLine{01722           modelView3D, projection3D, viewport3D, getDevPixRatio());}
\DoxyCodeLine{01723       glRasterPos3f(topRasterPos3D.x, topRasterPos3D.y, topRasterPos3D.z);}
\DoxyCodeLine{01724       glPixelStorei(GL\_UNPACK\_ROW\_LENGTH, 0);}
\DoxyCodeLine{01725       glDrawPixels(m\_3DTop-\/>getWrap(), m\_3DTop-\/>getLy(), TGL\_FMT, TGL\_TYPE,}
\DoxyCodeLine{01726                    m\_3DTop-\/>getRawData());}
\DoxyCodeLine{01727 }
\DoxyCodeLine{01728       \mbox{\hyperlink{class_t3_d_point_t}{T3DPointD}} sideRasterPos3D = computeNew3DPosition(}
\DoxyCodeLine{01729           \mbox{\hyperlink{class_t3_d_point_t}{T3DPointD}}(-\/500, -\/500, 1000), \mbox{\hyperlink{class_t_point_t}{TPointD}}(-\/10, -\/10), m\_sideRasterPos,}
\DoxyCodeLine{01730           modelView3D, projection3D, viewport3D, getDevPixRatio());}
\DoxyCodeLine{01731       glRasterPos3f(sideRasterPos3D.x, sideRasterPos3D.y, sideRasterPos3D.z);}
\DoxyCodeLine{01732       glPixelStorei(GL\_UNPACK\_ROW\_LENGTH, 0);}
\DoxyCodeLine{01733       glDrawPixels(m\_3DSideR-\/>getWrap(), m\_3DSideR-\/>getLy(), TGL\_FMT, TGL\_TYPE,}
\DoxyCodeLine{01734                    m\_3DSideR-\/>getRawData());}
\DoxyCodeLine{01735     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01736       \mbox{\hyperlink{class_t3_d_point_t}{T3DPointD}} topRasterPos3D = computeNew3DPosition(}
\DoxyCodeLine{01737           \mbox{\hyperlink{class_t3_d_point_t}{T3DPointD}}(-\/500, 500, 1000), \mbox{\hyperlink{class_t_point_t}{TPointD}}(-\/10, -\/10), m\_topRasterPos,}
\DoxyCodeLine{01738           modelView3D, projection3D, viewport3D, getDevPixRatio());}
\DoxyCodeLine{01739       glRasterPos3f(topRasterPos3D.x, topRasterPos3D.y, topRasterPos3D.z);}
\DoxyCodeLine{01740       glPixelStorei(GL\_UNPACK\_ROW\_LENGTH, 0);}
\DoxyCodeLine{01741       glDrawPixels(m\_3DTop-\/>getWrap(), m\_3DTop-\/>getLy(), TGL\_FMT, TGL\_TYPE,}
\DoxyCodeLine{01742                    m\_3DTop-\/>getRawData());}
\DoxyCodeLine{01743 }
\DoxyCodeLine{01744       \mbox{\hyperlink{class_t3_d_point_t}{T3DPointD}} sideRasterPos3D = computeNew3DPosition(}
\DoxyCodeLine{01745           \mbox{\hyperlink{class_t3_d_point_t}{T3DPointD}}(500, -\/500, 1000), \mbox{\hyperlink{class_t_point_t}{TPointD}}(-\/10, -\/10), m\_sideRasterPos,}
\DoxyCodeLine{01746           modelView3D, projection3D, viewport3D, getDevPixRatio());}
\DoxyCodeLine{01747       glRasterPos3f(sideRasterPos3D.x, sideRasterPos3D.y, sideRasterPos3D.z);}
\DoxyCodeLine{01748       glPixelStorei(GL\_UNPACK\_ROW\_LENGTH, 0);}
\DoxyCodeLine{01749       glDrawPixels(m\_3DSideL-\/>getWrap(), m\_3DSideL-\/>getLy(), TGL\_FMT, TGL\_TYPE,}
\DoxyCodeLine{01750                    m\_3DSideL-\/>getRawData());}
\DoxyCodeLine{01751     \}}
\DoxyCodeLine{01752   \}}
\DoxyCodeLine{01753 }
\DoxyCodeLine{01754   \textcolor{keywordflow}{if} (m\_draw3DMode) \{}
\DoxyCodeLine{01755     glDisable(GL\_DEPTH\_TEST);}
\DoxyCodeLine{01756     glPopMatrix();}
\DoxyCodeLine{01757     assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{01758   \}}
\DoxyCodeLine{01759 }
\DoxyCodeLine{01760   \textcolor{comment}{// draw tool gadgets}}
\DoxyCodeLine{01761   \mbox{\hyperlink{class_t_tool}{TTool}} *tool         = app-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{01762   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl = app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getSimpleLevel();}
\DoxyCodeLine{01763   \textcolor{comment}{// Call tool-\/>draw() even if the level is read only (i.e. to show hooks)}}
\DoxyCodeLine{01764   \textcolor{keywordflow}{if} (tool \&\& (tool-\/>isEnabled() || (sl \&\& sl-\/>isReadOnly()))) \{}
\DoxyCodeLine{01765     \textcolor{comment}{// tool-\/>setViewer(this);                            // Moved at}}
\DoxyCodeLine{01766     \textcolor{comment}{// drawBuildVars(), before drawing anything}}
\DoxyCodeLine{01767     glPushMatrix();}
\DoxyCodeLine{01768     \textcolor{keywordflow}{if} (m\_draw3DMode) \{}
\DoxyCodeLine{01769       mult3DMatrix();}
\DoxyCodeLine{01770       tglMultMatrix(tool-\/>getMatrix());}
\DoxyCodeLine{01771     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01772       tglMultMatrix(\mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}() * tool-\/>getMatrix());}
\DoxyCodeLine{01773     \textcolor{keywordflow}{if} (tool-\/>getToolType() \& TTool::LevelTool \&\&}
\DoxyCodeLine{01774         !app-\/>\mbox{\hyperlink{class_t_app_a0d91c122eec2b756b7c4780014e49f9e}{getCurrentObject}}()-\/>isSpline())}
\DoxyCodeLine{01775       glScaled(m\_dpiScale.x, m\_dpiScale.y, 1);}
\DoxyCodeLine{01776     m\_pixelSize = sqrt(tglGetPixelSize2()) * getDevPixRatio();}
\DoxyCodeLine{01777     tool-\/>\mbox{\hyperlink{class_t_tool_a058bf656d73bf3cd63b9826cbaaf48e0}{draw}}();}
\DoxyCodeLine{01778     glPopMatrix();}
\DoxyCodeLine{01779     \textcolor{comment}{// Used (only in the T\_RGBPicker tool) to notify and set the currentColor}}
\DoxyCodeLine{01780     \textcolor{comment}{// outside the draw() methods:}}
\DoxyCodeLine{01781     \textcolor{comment}{// using special style there was a conflict between the draw() methods of}}
\DoxyCodeLine{01782     \textcolor{comment}{// the tool}}
\DoxyCodeLine{01783     \textcolor{comment}{// and the generation of the icon inside the style editor (makeIcon()) which}}
\DoxyCodeLine{01784     \textcolor{comment}{// use}}
\DoxyCodeLine{01785     \textcolor{comment}{// another glContext}}
\DoxyCodeLine{01786     \textcolor{keywordflow}{if} (tool-\/>getName() == \textcolor{stringliteral}{"{}T\_RGBPicker"{}}) tool-\/>\mbox{\hyperlink{class_t_tool_aaf1e021290e74c1b085e4b095668e1ed}{onImageChanged}}();}
\DoxyCodeLine{01787 }
\DoxyCodeLine{01788     \textcolor{comment}{// draw cross at the center of the locator window}}
\DoxyCodeLine{01789     \textcolor{keywordflow}{if} (m\_isLocator) \{}
\DoxyCodeLine{01790       glColor3d(1.0, 0.0, 0.0);}
\DoxyCodeLine{01791       tglDrawSegment(\mbox{\hyperlink{class_t_point_t}{TPointD}}(-\/4, 0), \mbox{\hyperlink{class_t_point_t}{TPointD}}(5, 0));}
\DoxyCodeLine{01792       tglDrawSegment(\mbox{\hyperlink{class_t_point_t}{TPointD}}(0, -\/4), \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 5));}
\DoxyCodeLine{01793     \}}
\DoxyCodeLine{01794   \}}
\DoxyCodeLine{01795 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00416}{TTool\+::draw()}}, \mbox{\hyperlink{l00114}{TApp\+::get\+Current\+Frame()}}, \mbox{\hyperlink{l00122}{TApp\+::get\+Current\+Level()}}, \mbox{\hyperlink{l00130}{TApp\+::get\+Current\+Object()}}, \mbox{\hyperlink{l00126}{TApp\+::get\+Current\+Tool()}}, \mbox{\hyperlink{l02211}{get\+View\+Matrix()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, \mbox{\hyperlink{l00403}{TTool\+::on\+Image\+Changed()}}, and \mbox{\hyperlink{l00557}{TRect\+T$<$ T $>$\+::x0}}.

\mbox{\Hypertarget{class_scene_viewer_a68ece13279180dee8c61f1dcdc1944e4}\label{class_scene_viewer_a68ece13279180dee8c61f1dcdc1944e4}} 
\index{SceneViewer@{SceneViewer}!drawPreview@{drawPreview}}
\index{drawPreview@{drawPreview}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{drawPreview()}{drawPreview()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::draw\+Preview (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01537                               \{}
\DoxyCodeLine{01538   \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{inch}}   = \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}};}
\DoxyCodeLine{01539   \mbox{\hyperlink{class_t_app}{TApp}} *app           = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{01540   \textcolor{keywordtype}{int} row             = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{01541   \mbox{\hyperlink{class_t_camera}{TCamera}} *currCamera = app-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_a750b5ab623ccec744013b0c83bf20abc}{getCurrentCamera}}();}
\DoxyCodeLine{01542   \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}} cameraSize = currCamera-\/>\mbox{\hyperlink{class_t_camera_a6f561eca912177c2150b3e57816f02f6}{getSize}}();}
\DoxyCodeLine{01543 }
\DoxyCodeLine{01544   \mbox{\hyperlink{class_previewer}{Previewer}} *previewer =}
\DoxyCodeLine{01545       \mbox{\hyperlink{class_previewer_a5eb765b66490a3d99d432f90864bfacd}{Previewer::instance}}(m\_previewMode == SUBCAMERA\_PREVIEW);}
\DoxyCodeLine{01546 }
\DoxyCodeLine{01547   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} ras =}
\DoxyCodeLine{01548       previewer-\/>\mbox{\hyperlink{class_previewer_afb0f0a5c7ca1fb9366996407ea58d4cc}{getRaster}}(row, \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.m\_recomputeIfNeeded);}
\DoxyCodeLine{01549   \textcolor{keywordflow}{if} (ras) \{}
\DoxyCodeLine{01550     \mbox{\hyperlink{class_t_rect_t}{TRectD}} previewStageRectD, cameraStageRectD = currCamera-\/>\mbox{\hyperlink{class_t_camera_afbdcee0cf26df414d787c11beb675140}{getStageRect}}();}
\DoxyCodeLine{01551 }
\DoxyCodeLine{01552     \mbox{\hyperlink{class_t_rect_t}{TRect}} subCameraRect(currCamera-\/>\mbox{\hyperlink{class_t_camera_ad95e2b9f128939f1ce9777623643c69c}{getInterestRect}}());}
\DoxyCodeLine{01553     \textcolor{keywordflow}{if} (m\_previewMode == SUBCAMERA\_PREVIEW \&\& subCameraRect.getLx() > 0 \&\&}
\DoxyCodeLine{01554         subCameraRect.getLy() > 0)}
\DoxyCodeLine{01555       previewStageRectD = currCamera-\/>\mbox{\hyperlink{class_t_camera_a4008034b1ffbe06c1aac816c3bfa5144}{getInterestStageRect}}();}
\DoxyCodeLine{01556     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01557       previewStageRectD = cameraStageRectD;}
\DoxyCodeLine{01558 }
\DoxyCodeLine{01559     \mbox{\hyperlink{class_t_affine}{TAffine}} rasterToStageRef(}
\DoxyCodeLine{01560         previewStageRectD.getLx() / ras-\/>getLx(), 0.0,}
\DoxyCodeLine{01561         previewStageRectD.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} + 0.5 * previewStageRectD.getLx(), 0.0,}
\DoxyCodeLine{01562         previewStageRectD.getLy() / ras-\/>getLy(),}
\DoxyCodeLine{01563         previewStageRectD.y0 + 0.5 * previewStageRectD.getLy());}
\DoxyCodeLine{01564 }
\DoxyCodeLine{01565     \mbox{\hyperlink{class_t_dimension_t}{TDimension}} dim(width(), height());}
\DoxyCodeLine{01566     \mbox{\hyperlink{class_t_affine}{TAffine}} finalAff              = m\_drawCameraAff * rasterToStageRef;}
\DoxyCodeLine{01567     \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_a60f22526b35976230076ec07cff4a701}{m\_useTexture}} = !Preferences::instance()-\/>useDrawPixel();}
\DoxyCodeLine{01568     ImagePainter::paintImage(\mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}}(ras), ras-\/>getSize(), dim, finalAff,}
\DoxyCodeLine{01569                              \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}, m\_compareSettings, \mbox{\hyperlink{class_t_rect_t}{TRect}}());}
\DoxyCodeLine{01570   \}}
\DoxyCodeLine{01571 }
\DoxyCodeLine{01572   glPushMatrix();}
\DoxyCodeLine{01573   tglMultMatrix(m\_drawCameraAff);}
\DoxyCodeLine{01574 }
\DoxyCodeLine{01575   \mbox{\hyperlink{class_t_rect_t}{TRectD}} frameRect(cameraSize);}
\DoxyCodeLine{01576   frameRect.x1 *= \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{inch}};}
\DoxyCodeLine{01577   frameRect.y1 *= \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{inch}};}
\DoxyCodeLine{01578   frameRect -\/= 0.5 * (frameRect.getP00() + frameRect.getP11());}
\DoxyCodeLine{01579 }
\DoxyCodeLine{01580   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_af07ee76dc91b927f4dc22d44fcc13495}{m\_blankColor}} != TPixel::Transparent) \{}
\DoxyCodeLine{01581     tglColor(\mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_af07ee76dc91b927f4dc22d44fcc13495}{m\_blankColor}});}
\DoxyCodeLine{01582     tglFillRect(frameRect);}
\DoxyCodeLine{01583   \}}
\DoxyCodeLine{01584 }
\DoxyCodeLine{01585   \textcolor{keywordflow}{if} (!previewer-\/>\mbox{\hyperlink{class_previewer_a43b83e2f98aa1ee5fc316fe9eeeaea15}{isFrameReady}}(row) ||}
\DoxyCodeLine{01586       (app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isPlaying() \&\& previewer-\/>isBusy())) \{}
\DoxyCodeLine{01587     glColor3d(1, 0, 0);}
\DoxyCodeLine{01588 }
\DoxyCodeLine{01589     tglDrawRect(frameRect);}
\DoxyCodeLine{01590     tglDrawRect(frameRect.enlarge(5));}
\DoxyCodeLine{01591   \}}
\DoxyCodeLine{01592 }
\DoxyCodeLine{01593   glPopMatrix();}
\DoxyCodeLine{01594 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ac126cf528301b58b48221eb2e546b1c2}\label{class_scene_viewer_ac126cf528301b58b48221eb2e546b1c2}} 
\index{SceneViewer@{SceneViewer}!drawScene@{drawScene}}
\index{drawScene@{drawScene}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{drawScene()}{drawScene()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::draw\+Scene (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01952                             \{}
\DoxyCodeLine{01953   \mbox{\hyperlink{class_t_app}{TApp}} *app         = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{01954   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene = app-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{01955   \textcolor{keywordtype}{int} frame         = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{01956   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh      = app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet();}
\DoxyCodeLine{01957   \mbox{\hyperlink{class_t_rect_t}{TRect}} clipRect    = getActualClipRect(\mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}());}
\DoxyCodeLine{01958   clipRect += \mbox{\hyperlink{class_t_point_t}{TPoint}}(width() * 0.5, height() * 0.5);}
\DoxyCodeLine{01959 }
\DoxyCodeLine{01960   \mbox{\hyperlink{class_child_stack}{ChildStack}} *childStack = scene-\/>\mbox{\hyperlink{class_toonz_scene_ae2cbc582144c92adc5076cd5f556c95a}{getChildStack}}();}
\DoxyCodeLine{01961   \textcolor{keywordtype}{bool} editInPlace       = editInPlaceToggle.getStatus() \&\&}
\DoxyCodeLine{01962                      !app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isEditingLevel();}
\DoxyCodeLine{01963 }
\DoxyCodeLine{01964   \textcolor{keywordtype}{bool} fillFullColorRaster = TXshSimpleLevel::m\_fillFullColorRaster;}
\DoxyCodeLine{01965   TXshSimpleLevel::m\_fillFullColorRaster = \textcolor{keyword}{false};}
\DoxyCodeLine{01966 }
\DoxyCodeLine{01967   \textcolor{comment}{// Guided Drawing Check}}
\DoxyCodeLine{01968   \textcolor{keywordtype}{int} useGuidedDrawing  = Preferences::instance()-\/>getGuidedDrawingType();}
\DoxyCodeLine{01969   \mbox{\hyperlink{class_t_tool}{TTool}} *tool           = app-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{01970   \textcolor{keywordtype}{int} guidedFrontStroke = tool ? tool-\/>getViewer()-\/>getGuidedFrontStroke() : -\/1;}
\DoxyCodeLine{01971   \textcolor{keywordtype}{int} guidedBackStroke  = tool ? tool-\/>getViewer()-\/>getGuidedBackStroke() : -\/1;}
\DoxyCodeLine{01972 }
\DoxyCodeLine{01973   m\_minZ = 0;}
\DoxyCodeLine{01974   \textcolor{keywordflow}{if} (is3DView()) \{}
\DoxyCodeLine{01975     \mbox{\hyperlink{class_stage_1_1_open_gl_painter}{Stage::OpenGlPainter}} painter(\mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}(), clipRect, \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}},}
\DoxyCodeLine{01976                                  \textcolor{keyword}{true}, \textcolor{keyword}{false});}
\DoxyCodeLine{01977     painter.enableCamera3D(\textcolor{keyword}{true});}
\DoxyCodeLine{01978     painter.setPhi(m\_phi3D);}
\DoxyCodeLine{01979     \textcolor{keywordtype}{int} xsheetLevel = 0;}
\DoxyCodeLine{01980     std::pair<TXsheet *, int> xr;}
\DoxyCodeLine{01981     \textcolor{keywordflow}{if} (editInPlace) \{}
\DoxyCodeLine{01982       xr          = childStack-\/>\mbox{\hyperlink{class_child_stack_a6cddfa0ca994527a3b90a3456eb8656f}{getAncestor}}(frame);}
\DoxyCodeLine{01983       xsheetLevel = childStack-\/>\mbox{\hyperlink{class_child_stack_adf32015ee9da2ea3255ba9bd2597f899}{getAncestorCount}}();}
\DoxyCodeLine{01984     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01985       xr = std::make\_pair(xsh, frame);}
\DoxyCodeLine{01986 }
\DoxyCodeLine{01987     \mbox{\hyperlink{struct_stage_1_1_visit_args}{Stage::VisitArgs}} args;}
\DoxyCodeLine{01988     args.m\_scene       = scene;}
\DoxyCodeLine{01989     args.m\_xsh         = xr.first;}
\DoxyCodeLine{01990     args.m\_row         = xr.second;}
\DoxyCodeLine{01991     args.m\_col         = app-\/>\mbox{\hyperlink{class_t_app_a1e294e7cff300851d12a8c3d196943f6}{getCurrentColumn}}()-\/>getColumnIndex();}
\DoxyCodeLine{01992     \mbox{\hyperlink{class_onion_skin_mask}{OnionSkinMask}} osm  = app-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>getOnionSkinMask();}
\DoxyCodeLine{01993     args.m\_osm         = \&osm;}
\DoxyCodeLine{01994     args.m\_camera3d    = \textcolor{keyword}{true};}
\DoxyCodeLine{01995     args.m\_xsheetLevel = xsheetLevel;}
\DoxyCodeLine{01996     args.m\_currentFrameId =}
\DoxyCodeLine{01997         app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()}
\DoxyCodeLine{01998             -\/>getXsheet()}
\DoxyCodeLine{01999             -\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame(), args.m\_col)}
\DoxyCodeLine{02000             .\mbox{\hyperlink{class_t_xsh_cell_a5a1965b96c2c698d6f0fb42a80c03406}{getFrameId}}();}
\DoxyCodeLine{02001     args.m\_isGuidedDrawingEnabled = useGuidedDrawing;}
\DoxyCodeLine{02002     args.m\_guidedFrontStroke      = guidedFrontStroke;}
\DoxyCodeLine{02003     args.m\_guidedBackStroke       = guidedBackStroke;}
\DoxyCodeLine{02004 }
\DoxyCodeLine{02005     \textcolor{comment}{// args.m\_currentFrameId = app-\/>getCurrentFrame()-\/>getFid();}}
\DoxyCodeLine{02006     \mbox{\hyperlink{namespace_stage_a28ab15860508cccd59a31483a9b8afa1}{Stage::visit}}(painter, args);}
\DoxyCodeLine{02007 }
\DoxyCodeLine{02008     m\_minZ = painter.getMinZ();}
\DoxyCodeLine{02009   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02010     \textcolor{comment}{// camera 2D (normale)}}
\DoxyCodeLine{02011     \mbox{\hyperlink{class_t_dimension_t}{TDimension}} viewerSize(width(), height());}
\DoxyCodeLine{02012 }
\DoxyCodeLine{02013     \mbox{\hyperlink{class_t_affine}{TAffine}} viewAff = \mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}();}
\DoxyCodeLine{02014 }
\DoxyCodeLine{02015     \textcolor{keywordflow}{if} (editInPlace) \{}
\DoxyCodeLine{02016       \mbox{\hyperlink{class_t_affine}{TAffine}} aff;}
\DoxyCodeLine{02017       \textcolor{keywordflow}{if} (scene-\/>\mbox{\hyperlink{class_toonz_scene_ae2cbc582144c92adc5076cd5f556c95a}{getChildStack}}()-\/>\mbox{\hyperlink{class_child_stack_a8f1fa04ddb083c41ceb3c958e6423744}{getAncestorAffine}}(aff, frame))}
\DoxyCodeLine{02018         viewAff = viewAff * aff.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}();}
\DoxyCodeLine{02019     \}}
\DoxyCodeLine{02020 }
\DoxyCodeLine{02021     \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_a354c3bf432a933b627c3f3c5ea0ab9bf}{m\_showBBox}} = viewBBoxToggle.getStatus();}
\DoxyCodeLine{02022 }
\DoxyCodeLine{02023     \mbox{\hyperlink{class_stage_1_1_raster_painter}{Stage::RasterPainter}} painter(viewerSize, viewAff, clipRect,}
\DoxyCodeLine{02024                                  \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}, \textcolor{keyword}{true});}
\DoxyCodeLine{02025 }
\DoxyCodeLine{02026     \textcolor{comment}{// darken blended view mode for viewing the non-\/cleanuped and stacked}}
\DoxyCodeLine{02027     \textcolor{comment}{// drawings}}
\DoxyCodeLine{02028     painter.setRasterDarkenBlendedView(}
\DoxyCodeLine{02029         Preferences::instance()}
\DoxyCodeLine{02030             -\/>isShowRasterImagesDarkenBlendedInViewerEnabled());}
\DoxyCodeLine{02031 }
\DoxyCodeLine{02032     \mbox{\hyperlink{class_t_frame_handle}{TFrameHandle}} *frameHandle = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}();}
\DoxyCodeLine{02033     \textcolor{keywordflow}{if} (app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isEditingLevel()) \{}
\DoxyCodeLine{02034       \mbox{\hyperlink{namespace_stage_a28ab15860508cccd59a31483a9b8afa1}{Stage::visit}}(painter, app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel(),}
\DoxyCodeLine{02035                    app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFid(),}
\DoxyCodeLine{02036                    app-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>getOnionSkinMask(),}
\DoxyCodeLine{02037                    frameHandle-\/>isPlaying(), useGuidedDrawing, guidedBackStroke,}
\DoxyCodeLine{02038                    guidedFrontStroke);}
\DoxyCodeLine{02039     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02040       std::pair<TXsheet *, int> xr;}
\DoxyCodeLine{02041       \textcolor{keywordtype}{int} xsheetLevel = 0;}
\DoxyCodeLine{02042       \textcolor{keywordflow}{if} (editInPlace) \{}
\DoxyCodeLine{02043         xr          = scene-\/>\mbox{\hyperlink{class_toonz_scene_ae2cbc582144c92adc5076cd5f556c95a}{getChildStack}}()-\/>\mbox{\hyperlink{class_child_stack_a6cddfa0ca994527a3b90a3456eb8656f}{getAncestor}}(frame);}
\DoxyCodeLine{02044         xsheetLevel = scene-\/>\mbox{\hyperlink{class_toonz_scene_ae2cbc582144c92adc5076cd5f556c95a}{getChildStack}}()-\/>\mbox{\hyperlink{class_child_stack_adf32015ee9da2ea3255ba9bd2597f899}{getAncestorCount}}();}
\DoxyCodeLine{02045       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{02046         xr = std::make\_pair(xsh, frame);}
\DoxyCodeLine{02047 }
\DoxyCodeLine{02048       \mbox{\hyperlink{struct_stage_1_1_visit_args}{Stage::VisitArgs}} args;}
\DoxyCodeLine{02049       args.m\_scene       = scene;}
\DoxyCodeLine{02050       args.m\_xsh         = xr.first;}
\DoxyCodeLine{02051       args.m\_row         = xr.second;}
\DoxyCodeLine{02052       args.m\_col         = app-\/>\mbox{\hyperlink{class_t_app_a1e294e7cff300851d12a8c3d196943f6}{getCurrentColumn}}()-\/>getColumnIndex();}
\DoxyCodeLine{02053       \mbox{\hyperlink{class_onion_skin_mask}{OnionSkinMask}} osm  = app-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>getOnionSkinMask();}
\DoxyCodeLine{02054       args.m\_osm         = \&osm;}
\DoxyCodeLine{02055       args.m\_xsheetLevel = xsheetLevel;}
\DoxyCodeLine{02056       args.m\_isPlaying   = frameHandle-\/>isPlaying();}
\DoxyCodeLine{02057       \textcolor{keywordflow}{if} (app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}() \&\& app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel() \&\&}
\DoxyCodeLine{02058           !app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel()-\/>\mbox{\hyperlink{class_t_xsh_level_aa26f1638f7685304949b33befc0bfcc9}{getSoundLevel}}())}
\DoxyCodeLine{02059         args.m\_currentFrameId =}
\DoxyCodeLine{02060             app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()}
\DoxyCodeLine{02061                 -\/>getXsheet()}
\DoxyCodeLine{02062                 -\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame(), args.m\_col)}
\DoxyCodeLine{02063                 .\mbox{\hyperlink{class_t_xsh_cell_a5a1965b96c2c698d6f0fb42a80c03406}{getFrameId}}();}
\DoxyCodeLine{02064       args.m\_isGuidedDrawingEnabled = useGuidedDrawing;}
\DoxyCodeLine{02065       args.m\_guidedFrontStroke      = guidedFrontStroke;}
\DoxyCodeLine{02066       args.m\_guidedBackStroke       = guidedBackStroke;}
\DoxyCodeLine{02067 }
\DoxyCodeLine{02068 \textcolor{preprocessor}{\#if defined(x64)}}
\DoxyCodeLine{02069       \textcolor{keywordflow}{if} (m\_stopMotion-\/>m\_alwaysUseLiveViewImages \&\&}
\DoxyCodeLine{02070           m\_stopMotion-\/>m\_liveViewStatus > 0 \&\&}
\DoxyCodeLine{02071           frame != m\_stopMotion-\/>getXSheetFrameNumber() -\/ 1 \&\&}
\DoxyCodeLine{02072           m\_hasStopMotionImage \&\& !m\_stopMotion-\/>m\_reviewTimer-\/>isActive()) \{}
\DoxyCodeLine{02073         \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} image;}
\DoxyCodeLine{02074         \textcolor{keywordtype}{bool} hasImage = m\_stopMotion-\/>loadLiveViewImage(frame, image);}
\DoxyCodeLine{02075         \textcolor{keywordflow}{if} (hasImage) \{}
\DoxyCodeLine{02076           \mbox{\hyperlink{class_stage_1_1_player}{Stage::Player}} smPlayer;}
\DoxyCodeLine{02077           \textcolor{keywordtype}{double} dpiX, dpiY;}
\DoxyCodeLine{02078           m\_stopMotionImage-\/>getDpi(dpiX, dpiY);}
\DoxyCodeLine{02079           smPlayer.\mbox{\hyperlink{class_stage_1_1_player_a0495491ce47344daba1cd55e1b64905a}{m\_dpiAff}}    = \mbox{\hyperlink{class_t_scale}{TScale}}(\mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / dpiX, \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / dpiY);}
\DoxyCodeLine{02080           smPlayer.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}}   = 255;}
\DoxyCodeLine{02081           smPlayer.\mbox{\hyperlink{class_stage_1_1_player_a6230d77933caf93b9699bd5e2de0d2b0}{m\_sl}}        = m\_stopMotion-\/>m\_sl;}
\DoxyCodeLine{02082           args.m\_liveViewImage = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}}\textcolor{keyword}{>}(image);}
\DoxyCodeLine{02083           args.m\_liveViewPlayer = smPlayer;}
\DoxyCodeLine{02084           \textcolor{comment}{// painter.onRasterImage(static\_cast<TRasterImageP>(image).getPointer(),}}
\DoxyCodeLine{02085           \textcolor{comment}{//                      smPlayer);}}
\DoxyCodeLine{02086         \}}
\DoxyCodeLine{02087       \}}
\DoxyCodeLine{02088       \textcolor{keywordflow}{if} (  }
\DoxyCodeLine{02089           m\_stopMotion-\/>m\_liveViewStatus == 2 \&\&}
\DoxyCodeLine{02090           (  }
\DoxyCodeLine{02091               frame == m\_stopMotion-\/>getXSheetFrameNumber() -\/ 1)) \{}
\DoxyCodeLine{02092         \textcolor{keywordflow}{if} (m\_hasStopMotionLineUpImage \&\& m\_stopMotion-\/>m\_showLineUpImage) \{}
\DoxyCodeLine{02093           \mbox{\hyperlink{class_stage_1_1_player}{Stage::Player}} smPlayer;}
\DoxyCodeLine{02094           \textcolor{keywordtype}{double} dpiX, dpiY;}
\DoxyCodeLine{02095           m\_stopMotionLineUpImage-\/>getDpi(dpiX, dpiY);}
\DoxyCodeLine{02096           smPlayer.\mbox{\hyperlink{class_stage_1_1_player_a0495491ce47344daba1cd55e1b64905a}{m\_dpiAff}}   = \mbox{\hyperlink{class_t_scale}{TScale}}(\mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / dpiX, \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / dpiY);}
\DoxyCodeLine{02097           smPlayer.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}}  = 255;}
\DoxyCodeLine{02098           smPlayer.\mbox{\hyperlink{class_stage_1_1_player_a6230d77933caf93b9699bd5e2de0d2b0}{m\_sl}}       = m\_stopMotion-\/>m\_sl;}
\DoxyCodeLine{02099           args.m\_lineupImage  = m\_stopMotionLineUpImage;}
\DoxyCodeLine{02100           args.m\_lineupPlayer = smPlayer;}
\DoxyCodeLine{02101           \textcolor{comment}{// painter.onRasterImage(m\_stopMotionLineUpImage.getPointer(),}}
\DoxyCodeLine{02102           \textcolor{comment}{// smPlayer);}}
\DoxyCodeLine{02103         \}}
\DoxyCodeLine{02104         \textcolor{keywordflow}{if} (m\_hasStopMotionImage) \{}
\DoxyCodeLine{02105           \mbox{\hyperlink{class_stage_1_1_player}{Stage::Player}} smPlayer;}
\DoxyCodeLine{02106           \textcolor{keywordtype}{double} dpiX, dpiY;}
\DoxyCodeLine{02107           m\_stopMotionImage-\/>getDpi(dpiX, dpiY);}
\DoxyCodeLine{02108           smPlayer.\mbox{\hyperlink{class_stage_1_1_player_a0495491ce47344daba1cd55e1b64905a}{m\_dpiAff}} = \mbox{\hyperlink{class_t_scale}{TScale}}(\mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / dpiX, \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / dpiY);}
\DoxyCodeLine{02109           \textcolor{keywordtype}{bool} hide\_opacity = \textcolor{keyword}{false};}
\DoxyCodeLine{02110 \textcolor{preprocessor}{\#ifdef WITH\_CANON}}
\DoxyCodeLine{02111           hide\_opacity = m\_stopMotion-\/>m\_canon-\/>m\_zooming ||}
\DoxyCodeLine{02112                          m\_stopMotion-\/>m\_canon-\/>m\_pickLiveViewZoom ||}
\DoxyCodeLine{02113                          !m\_hasStopMotionLineUpImage;}
\DoxyCodeLine{02114 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02115           smPlayer.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}} =}
\DoxyCodeLine{02116               hide\_opacity ? 255.0 : m\_stopMotion-\/>getOpacity();}
\DoxyCodeLine{02117           smPlayer.\mbox{\hyperlink{class_stage_1_1_player_a6230d77933caf93b9699bd5e2de0d2b0}{m\_sl}}         = m\_stopMotion-\/>m\_sl;}
\DoxyCodeLine{02118           args.m\_liveViewImage  = m\_stopMotionImage;}
\DoxyCodeLine{02119           args.m\_liveViewPlayer = smPlayer;}
\DoxyCodeLine{02120           \textcolor{comment}{// painter.onRasterImage(m\_stopMotionImage.getPointer(), smPlayer);}}
\DoxyCodeLine{02121         \}}
\DoxyCodeLine{02122       \}}
\DoxyCodeLine{02123 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// x64}}
\DoxyCodeLine{02124       \mbox{\hyperlink{namespace_stage_a28ab15860508cccd59a31483a9b8afa1}{Stage::visit}}(painter, args);}
\DoxyCodeLine{02125     \}}
\DoxyCodeLine{02126 }
\DoxyCodeLine{02127     assert(glGetError() == 0);}
\DoxyCodeLine{02128     painter.flushRasterImages();}
\DoxyCodeLine{02129 }
\DoxyCodeLine{02130     TXshSimpleLevel::m\_fillFullColorRaster = fillFullColorRaster;}
\DoxyCodeLine{02131 }
\DoxyCodeLine{02132     assert(glGetError() == 0);}
\DoxyCodeLine{02133     \textcolor{keywordflow}{if} (m\_viewMode != LEVEL\_VIEWMODE)}
\DoxyCodeLine{02134       drawSpline(\mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}(), clipRect,}
\DoxyCodeLine{02135                  m\_referenceMode == CAMERA3D\_REFERENCE, m\_pixelSize);}
\DoxyCodeLine{02136     assert(glGetError() == 0);}
\DoxyCodeLine{02137 }
\DoxyCodeLine{02138     \textcolor{comment}{// gather animated guide strokes' bounding boxes}}
\DoxyCodeLine{02139     \textcolor{comment}{// it is used for updating viewer next time}}
\DoxyCodeLine{02140     std::vector<TStroke *> guidedStrokes = painter.getGuidedStrokes();}
\DoxyCodeLine{02141     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} itr = guidedStrokes.begin(); itr != guidedStrokes.end(); ++itr) \{}
\DoxyCodeLine{02142       m\_guidedDrawingBBox += (*itr)-\/>getBBox();}
\DoxyCodeLine{02143     \}}
\DoxyCodeLine{02144   \}}
\DoxyCodeLine{02145 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a4247b4210012d911d749cdfc0262a194}\label{class_scene_viewer_a4247b4210012d911d749cdfc0262a194}} 
\index{SceneViewer@{SceneViewer}!dropEvent@{dropEvent}}
\index{dropEvent@{dropEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{dropEvent()}{dropEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::drop\+Event (\begin{DoxyParamCaption}\item[{QDrop\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01723                                          \{}
\DoxyCodeLine{01724   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01725 }
\DoxyCodeLine{01726   \textcolor{keyword}{const} QMimeData *mimeData = e-\/>mimeData();}
\DoxyCodeLine{01727   \textcolor{keywordflow}{if} (mimeData-\/>hasUrls()) \{}
\DoxyCodeLine{01728     \mbox{\hyperlink{struct_io_cmd_1_1_load_resource_arguments}{IoCmd::LoadResourceArguments}} args;}
\DoxyCodeLine{01729 }
\DoxyCodeLine{01730     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} QUrl \&url : mimeData-\/>urls()) \{}
\DoxyCodeLine{01731       \mbox{\hyperlink{class_t_file_path}{TFilePath}} fp(url.toLocalFile().toStdWString());}
\DoxyCodeLine{01732       args.\mbox{\hyperlink{struct_io_cmd_1_1_load_resource_arguments_a5175016c278fd5a031f149abf4f77cb1}{resourceDatas}}.push\_back(fp);}
\DoxyCodeLine{01733     \}}
\DoxyCodeLine{01734 }
\DoxyCodeLine{01735     \mbox{\hyperlink{namespace_io_cmd_a107f6d3100b922e0c09e9b4aa1a8602a}{IoCmd::loadResources}}(args);}
\DoxyCodeLine{01736 }
\DoxyCodeLine{01737     \textcolor{keywordflow}{if} (acceptResourceOrFolderDrop(mimeData-\/>urls())) \{}
\DoxyCodeLine{01738       \textcolor{comment}{// Force Copy Action}}
\DoxyCodeLine{01739       e-\/>setDropAction(Qt::CopyAction);}
\DoxyCodeLine{01740       \textcolor{comment}{// For files, don't accept original proposed action in case it's a move}}
\DoxyCodeLine{01741       e-\/>accept();}
\DoxyCodeLine{01742       \textcolor{keywordflow}{return};}
\DoxyCodeLine{01743     \}}
\DoxyCodeLine{01744   \}}
\DoxyCodeLine{01745   e-\/>acceptProposedAction();}
\DoxyCodeLine{01746 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a4964c1394b70da1420b770d872659dca}\label{class_scene_viewer_a4964c1394b70da1420b770d872659dca}} 
\index{SceneViewer@{SceneViewer}!enablePreview@{enablePreview}}
\index{enablePreview@{enablePreview}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{enablePreview}{enablePreview}}
{\footnotesize\ttfamily void Scene\+Viewer\+::enable\+Preview (\begin{DoxyParamCaption}\item[{int}]{preview\+Mode }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00927                                                \{}
\DoxyCodeLine{00928   \textcolor{keywordflow}{if} (m\_previewMode == previewMode) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00929 }
\DoxyCodeLine{00930   \mbox{\hyperlink{class_t_app}{TApp}} *app = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{00931   \textcolor{keywordflow}{if} (app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isEditingLevel() \&\& previewMode != NO\_PREVIEW)}
\DoxyCodeLine{00932     app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>setFrame(app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame());}
\DoxyCodeLine{00933 }
\DoxyCodeLine{00934   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \{}
\DoxyCodeLine{00935     freeze(\textcolor{keyword}{false});}
\DoxyCodeLine{00936     emit freezeStateChanged(\textcolor{keyword}{false});}
\DoxyCodeLine{00937   \}}
\DoxyCodeLine{00938 }
\DoxyCodeLine{00939   \textcolor{keywordflow}{if} (m\_previewMode != NO\_PREVIEW)}
\DoxyCodeLine{00940     \mbox{\hyperlink{class_previewer_a5eb765b66490a3d99d432f90864bfacd}{Previewer::instance}}(m\_previewMode == SUBCAMERA\_PREVIEW)}
\DoxyCodeLine{00941         -\/>removeListener(\textcolor{keyword}{this});}
\DoxyCodeLine{00942 }
\DoxyCodeLine{00943   \textcolor{comment}{// Schedule as a listener to Previewer.}}
\DoxyCodeLine{00944   \textcolor{keywordflow}{if} (previewMode != NO\_PREVIEW) \{}
\DoxyCodeLine{00945     \mbox{\hyperlink{class_previewer}{Previewer}} *previewer =}
\DoxyCodeLine{00946         \mbox{\hyperlink{class_previewer_a5eb765b66490a3d99d432f90864bfacd}{Previewer::instance}}(previewMode == SUBCAMERA\_PREVIEW);}
\DoxyCodeLine{00947     previewer-\/>addListener(\textcolor{keyword}{this});}
\DoxyCodeLine{00948     previewer-\/>\mbox{\hyperlink{class_previewer_a4f2238933e3e040b9c568525d487dbde}{update}}();}
\DoxyCodeLine{00949   \}}
\DoxyCodeLine{00950 }
\DoxyCodeLine{00951   m\_previewMode = previewMode;}
\DoxyCodeLine{00952 }
\DoxyCodeLine{00953   \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidateAll}}();}
\DoxyCodeLine{00954 }
\DoxyCodeLine{00955   \textcolor{comment}{// for updating the title bar}}
\DoxyCodeLine{00956   emit previewToggled();}
\DoxyCodeLine{00957 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_aba4c135ce293af822b5cfcebaf7d9d87}\label{class_scene_viewer_aba4c135ce293af822b5cfcebaf7d9d87}} 
\index{SceneViewer@{SceneViewer}!enterEvent@{enterEvent}}
\index{enterEvent@{enterEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{enterEvent()}{enterEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::enter\+Event (\begin{DoxyParamCaption}\item[{QEvent $\ast$}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00438 \{ onEnter(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ab7198c31eb441b64ad016abdb4bdb255}\label{class_scene_viewer_ab7198c31eb441b64ad016abdb4bdb255}} 
\index{SceneViewer@{SceneViewer}!event@{event}}
\index{event@{event}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{event()}{event()}}
{\footnotesize\ttfamily bool Scene\+Viewer\+::event (\begin{DoxyParamCaption}\item[{QEvent $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01144                                  \{}
\DoxyCodeLine{01145   \textcolor{comment}{/*}}
\DoxyCodeLine{01146 \textcolor{comment}{  switch (e-\/>type()) \{}}
\DoxyCodeLine{01147 \textcolor{comment}{  //    case QEvent::Enter:}}
\DoxyCodeLine{01148 \textcolor{comment}{  //    qDebug() << "{}[enter] ************************** Enter"{};}}
\DoxyCodeLine{01149 \textcolor{comment}{  //    break;}}
\DoxyCodeLine{01150 \textcolor{comment}{  //    case QEvent::Leave:}}
\DoxyCodeLine{01151 \textcolor{comment}{  //    qDebug() << "{}[enter] ************************** Leave"{};}}
\DoxyCodeLine{01152 \textcolor{comment}{  //    break;}}
\DoxyCodeLine{01153 \textcolor{comment}{}}
\DoxyCodeLine{01154 \textcolor{comment}{  case QEvent::TabletPress: \{}}
\DoxyCodeLine{01155 \textcolor{comment}{    QTabletEvent *te = static\_cast<QTabletEvent *>(e);}}
\DoxyCodeLine{01156 \textcolor{comment}{    qDebug() << "{}[enter] ************************** TabletPress mouseState("{}}}
\DoxyCodeLine{01157 \textcolor{comment}{             << m\_mouseState << "{}) tabletState("{} << m\_tabletState}}
\DoxyCodeLine{01158 \textcolor{comment}{             << "{}) pressure("{} << m\_pressure << "{}) pointerType("{}}}
\DoxyCodeLine{01159 \textcolor{comment}{             << te-\/>pointerType() << "{}) device("{} << te-\/>device() << "{})"{};}}
\DoxyCodeLine{01160 \textcolor{comment}{  \} break;}}
\DoxyCodeLine{01161 \textcolor{comment}{  //    case QEvent::TabletMove:}}
\DoxyCodeLine{01162 \textcolor{comment}{  //    qDebug() << "{}[enter] ************************** TabletMove}}
\DoxyCodeLine{01163 \textcolor{comment}{  //mouseState("{}<<m\_mouseState<<"{}) tabletState("{}<<m\_tabletState<<"{}) pressure("{}}}
\DoxyCodeLine{01164 \textcolor{comment}{  //<< m\_pressure << "{})"{};}}
\DoxyCodeLine{01165 \textcolor{comment}{  //    break;}}
\DoxyCodeLine{01166 \textcolor{comment}{  case QEvent::TabletRelease:}}
\DoxyCodeLine{01167 \textcolor{comment}{    qDebug() << "{}[enter] ************************** TabletRelease mouseState("{}}}
\DoxyCodeLine{01168 \textcolor{comment}{             << m\_mouseState << "{}) tabletState("{} << m\_tabletState << "{})"{};}}
\DoxyCodeLine{01169 \textcolor{comment}{    break;}}
\DoxyCodeLine{01170 \textcolor{comment}{}}
\DoxyCodeLine{01171 \textcolor{comment}{  case QEvent::TouchBegin:}}
\DoxyCodeLine{01172 \textcolor{comment}{    qDebug() << "{}[enter] ************************** TouchBegin"{};}}
\DoxyCodeLine{01173 \textcolor{comment}{    break;}}
\DoxyCodeLine{01174 \textcolor{comment}{  case QEvent::TouchEnd:}}
\DoxyCodeLine{01175 \textcolor{comment}{    qDebug() << "{}[enter] ************************** TouchEnd"{};}}
\DoxyCodeLine{01176 \textcolor{comment}{    break;}}
\DoxyCodeLine{01177 \textcolor{comment}{  case QEvent::TouchCancel:}}
\DoxyCodeLine{01178 \textcolor{comment}{    qDebug() << "{}[enter] ************************** TouchCancel"{};}}
\DoxyCodeLine{01179 \textcolor{comment}{    break;}}
\DoxyCodeLine{01180 \textcolor{comment}{}}
\DoxyCodeLine{01181 \textcolor{comment}{  case QEvent::Gesture:}}
\DoxyCodeLine{01182 \textcolor{comment}{    qDebug() << "{}[enter] ************************** Gesture"{};}}
\DoxyCodeLine{01183 \textcolor{comment}{    break;}}
\DoxyCodeLine{01184 \textcolor{comment}{}}
\DoxyCodeLine{01185 \textcolor{comment}{  case QEvent::MouseButtonPress:}}
\DoxyCodeLine{01186 \textcolor{comment}{    qDebug()}}
\DoxyCodeLine{01187 \textcolor{comment}{        << "{}[enter] ************************** MouseButtonPress mouseState("{}}}
\DoxyCodeLine{01188 \textcolor{comment}{        << m\_mouseState << "{}) tabletState("{} << m\_tabletState << "{}) pressure("{}}}
\DoxyCodeLine{01189 \textcolor{comment}{        << m\_pressure << "{}) tabletEvent("{} << m\_tabletEvent << "{})"{};}}
\DoxyCodeLine{01190 \textcolor{comment}{    break;}}
\DoxyCodeLine{01191 \textcolor{comment}{  //    case QEvent::MouseMove:}}
\DoxyCodeLine{01192 \textcolor{comment}{  //    qDebug() << "{}[enter] ************************** MouseMove mouseState("{}}}
\DoxyCodeLine{01193 \textcolor{comment}{  //<< m\_mouseState << "{}) tabletState("{}<<m\_tabletState<<"{}) pressure("{} <<}}
\DoxyCodeLine{01194 \textcolor{comment}{  //m\_pressure << "{})"{};}}
\DoxyCodeLine{01195 \textcolor{comment}{  //    break;}}
\DoxyCodeLine{01196 \textcolor{comment}{  case QEvent::MouseButtonRelease:}}
\DoxyCodeLine{01197 \textcolor{comment}{    qDebug()}}
\DoxyCodeLine{01198 \textcolor{comment}{        << "{}[enter] ************************** MouseButtonRelease mouseState("{}}}
\DoxyCodeLine{01199 \textcolor{comment}{        << m\_mouseState << "{}) tabletState("{} << m\_tabletState << "{})"{};}}
\DoxyCodeLine{01200 \textcolor{comment}{    break;}}
\DoxyCodeLine{01201 \textcolor{comment}{}}
\DoxyCodeLine{01202 \textcolor{comment}{  case QEvent::MouseButtonDblClick:}}
\DoxyCodeLine{01203 \textcolor{comment}{    qDebug() << "{}[enter] ============================== MouseButtonDblClick"{};}}
\DoxyCodeLine{01204 \textcolor{comment}{    break;}}
\DoxyCodeLine{01205 \textcolor{comment}{  \}}}
\DoxyCodeLine{01206 \textcolor{comment}{  */}}
\DoxyCodeLine{01207   \textcolor{keywordflow}{if} (e-\/>type() == QEvent::Gesture \&\& CommandManager::instance()}
\DoxyCodeLine{01208                                           -\/>getAction(MI\_TouchGestureControl)}
\DoxyCodeLine{01209                                           -\/>isChecked()) \{}
\DoxyCodeLine{01210     gestureEvent(\textcolor{keyword}{static\_cast<}QGestureEvent *\textcolor{keyword}{>}(e));}
\DoxyCodeLine{01211     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01212   \}}
\DoxyCodeLine{01213   \textcolor{keywordflow}{if} ((e-\/>type() == QEvent::TouchBegin || e-\/>type() == QEvent::TouchEnd ||}
\DoxyCodeLine{01214        e-\/>type() == QEvent::TouchCancel || e-\/>type() == QEvent::TouchUpdate) \&\&}
\DoxyCodeLine{01215       CommandManager::instance()}
\DoxyCodeLine{01216           -\/>getAction(MI\_TouchGestureControl)}
\DoxyCodeLine{01217           -\/>isChecked()) \{}
\DoxyCodeLine{01218     touchEvent(\textcolor{keyword}{static\_cast<}QTouchEvent *\textcolor{keyword}{>}(e), e-\/>type());}
\DoxyCodeLine{01219     m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{01220     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01221   \}}
\DoxyCodeLine{01222   \textcolor{keywordflow}{if} (e-\/>type() == QEvent::ShortcutOverride || e-\/>type() == QEvent::KeyPress) \{}
\DoxyCodeLine{01223     \textcolor{keywordflow}{if} (!((QKeyEvent *)e)-\/>isAutoRepeat()) \{}
\DoxyCodeLine{01224       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>storeTool();}
\DoxyCodeLine{01225     \}}
\DoxyCodeLine{01226   \}}
\DoxyCodeLine{01227   \textcolor{keywordflow}{if} (e-\/>type() == QEvent::ShortcutOverride) \{}
\DoxyCodeLine{01228     \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{01229     \textcolor{keywordflow}{if} (tool \&\& tool-\/>isEnabled() \&\& tool-\/>getName() == T\_Type \&\&}
\DoxyCodeLine{01230         tool-\/>\mbox{\hyperlink{class_t_tool_a6225a72c8bc7ad1ad6eff6b81ac6b0a6}{isActive}}())}
\DoxyCodeLine{01231       e-\/>accept();}
\DoxyCodeLine{01232     \textcolor{comment}{// for other tools, check if the pressed keys should be catched instead of}}
\DoxyCodeLine{01233     \textcolor{comment}{// triggering the shortcut command actions}}
\DoxyCodeLine{01234     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tool \&\& tool-\/>isEventAcceptable(e)) \{}
\DoxyCodeLine{01235       e-\/>accept();}
\DoxyCodeLine{01236     \}}
\DoxyCodeLine{01237     \textcolor{comment}{// if the Shift \& Trace mode is active, then override F1, F2 and F3 key}}
\DoxyCodeLine{01238     \textcolor{comment}{// actions by flipping feature}}
\DoxyCodeLine{01239     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (CommandManager::instance()}
\DoxyCodeLine{01240                  -\/>getAction(MI\_ShiftTrace)}
\DoxyCodeLine{01241                  -\/>isChecked() \&\&}
\DoxyCodeLine{01242              TTool::getTool(\textcolor{stringliteral}{"{}T\_ShiftTrace"{}}, \mbox{\hyperlink{class_t_tool_adf0ea3a7f9d003f761fe57638dd6eff4a68b7e2c2f25d134cb0debc4548d23ce1}{TTool::ToonzImage}})}
\DoxyCodeLine{01243                  -\/>isEventAcceptable(e)) \{}
\DoxyCodeLine{01244       e-\/>accept();}
\DoxyCodeLine{01245     \}}
\DoxyCodeLine{01246 }
\DoxyCodeLine{01247     \textcolor{comment}{// Disable keyboard shortcuts while the tool is busy with a mouse drag}}
\DoxyCodeLine{01248     \textcolor{comment}{// operation.}}
\DoxyCodeLine{01249     \textcolor{keywordflow}{if} (tool-\/>isDragging()) \{}
\DoxyCodeLine{01250       e-\/>accept();}
\DoxyCodeLine{01251     \}}
\DoxyCodeLine{01252 }
\DoxyCodeLine{01253     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01254   \}}
\DoxyCodeLine{01255   \textcolor{keywordflow}{if} (e-\/>type() == QEvent::KeyRelease) \{}
\DoxyCodeLine{01256     \textcolor{keywordflow}{if} (!((QKeyEvent *)e)-\/>isAutoRepeat()) \{}
\DoxyCodeLine{01257       QWidget *focusWidget = QApplication::focusWidget();}
\DoxyCodeLine{01258       \textcolor{keywordflow}{if} (focusWidget == 0 ||}
\DoxyCodeLine{01259           QString(focusWidget-\/>metaObject()-\/>className()) == \textcolor{stringliteral}{"{}SceneViewer"{}})}
\DoxyCodeLine{01260         \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>restoreTool();}
\DoxyCodeLine{01261     \}}
\DoxyCodeLine{01262   \}}
\DoxyCodeLine{01263 }
\DoxyCodeLine{01264   \textcolor{comment}{// discard too frequent move events}}
\DoxyCodeLine{01265   \textcolor{keyword}{static} QTime clock;}
\DoxyCodeLine{01266   \textcolor{keywordflow}{if} (e-\/>type() == QEvent::MouseButtonPress)}
\DoxyCodeLine{01267     clock.start();}
\DoxyCodeLine{01268   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (e-\/>type() == QEvent::MouseMove) \{}
\DoxyCodeLine{01269     \textcolor{keywordflow}{if} (clock.isValid() \&\& clock.elapsed() < 10) \{}
\DoxyCodeLine{01270       e-\/>accept();}
\DoxyCodeLine{01271       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01272     \}}
\DoxyCodeLine{01273     clock.start();}
\DoxyCodeLine{01274   \}}
\DoxyCodeLine{01275 }
\DoxyCodeLine{01276   \textcolor{keywordflow}{return} QOpenGLWidget::event(e);}
\DoxyCodeLine{01277 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a28b51b06c0d341adf5e3479e610eff47}\label{class_scene_viewer_a28b51b06c0d341adf5e3479e610eff47}} 
\index{SceneViewer@{SceneViewer}!fitToCamera@{fitToCamera}}
\index{fitToCamera@{fitToCamera}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{fitToCamera}{fitToCamera}}
{\footnotesize\ttfamily void Scene\+Viewer\+::fit\+To\+Camera (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02637                               \{}
\DoxyCodeLine{02638   \textcolor{comment}{// Reset the view scale to 1:1.}}
\DoxyCodeLine{02639   \textcolor{keywordtype}{bool} tempIsFlippedX = m\_isFlippedX;}
\DoxyCodeLine{02640   \textcolor{keywordtype}{bool} tempIsFlippedY = m\_isFlippedY;}
\DoxyCodeLine{02641   resetSceneViewer();}
\DoxyCodeLine{02642 }
\DoxyCodeLine{02643   m\_isFlippedX = tempIsFlippedX;}
\DoxyCodeLine{02644   m\_isFlippedY = tempIsFlippedY;}
\DoxyCodeLine{02645 }
\DoxyCodeLine{02646   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh            = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet();}
\DoxyCodeLine{02647   \textcolor{keywordtype}{int} frame               = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{02648   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} cameraId = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a5dc925584e35e1678f5678b79c470959}{getStageObjectTree}}()-\/>\mbox{\hyperlink{class_t_stage_object_tree_a7d63ae5d60c3a3aacf5da58c108ac167}{getCurrentCameraId}}();}
\DoxyCodeLine{02649   \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *camera    = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(cameraId);}
\DoxyCodeLine{02650   \mbox{\hyperlink{class_t_affine}{TAffine}} cameraPlacement = camera-\/>getPlacement(frame);}
\DoxyCodeLine{02651   \textcolor{keywordtype}{double} cameraZ          = camera-\/>\mbox{\hyperlink{class_t_stage_object_a52b1a3ec50ed35fbc07c9a3b64ecc21c}{getZ}}(frame);}
\DoxyCodeLine{02652   \mbox{\hyperlink{class_t_affine}{TAffine}} cameraAff =}
\DoxyCodeLine{02653       \mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}() * cameraPlacement * \mbox{\hyperlink{class_t_scale}{TScale}}((1000 + cameraZ) / 1000);}
\DoxyCodeLine{02654 }
\DoxyCodeLine{02655   QRect viewRect    = rect();}
\DoxyCodeLine{02656   \mbox{\hyperlink{class_t_rect_t}{TRectD}} cameraRect = ViewerDraw::getCameraRect();}
\DoxyCodeLine{02657   \mbox{\hyperlink{class_t_point_t}{TPointD}} P00       = cameraAff * cameraRect.getP00();}
\DoxyCodeLine{02658   \mbox{\hyperlink{class_t_point_t}{TPointD}} P10       = cameraAff * cameraRect.getP10();}
\DoxyCodeLine{02659   \mbox{\hyperlink{class_t_point_t}{TPointD}} P01       = cameraAff * cameraRect.getP01();}
\DoxyCodeLine{02660   \mbox{\hyperlink{class_t_point_t}{TPointD}} P11       = cameraAff * cameraRect.getP11();}
\DoxyCodeLine{02661   \mbox{\hyperlink{class_t_point_t}{TPointD}} p0        = \mbox{\hyperlink{class_t_point_t}{TPointD}}(std::min(\{P00.x, P01.x, P10.x, P11.x\}),}
\DoxyCodeLine{02662                        std::min(\{P00.y, P01.y, P10.y, P11.y\}));}
\DoxyCodeLine{02663   \mbox{\hyperlink{class_t_point_t}{TPointD}} p1        = \mbox{\hyperlink{class_t_point_t}{TPointD}}(std::max(\{P00.x, P01.x, P10.x, P11.x\}),}
\DoxyCodeLine{02664                        std::max(\{P00.y, P01.y, P10.y, P11.y\}));}
\DoxyCodeLine{02665   cameraRect        = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(p0.x, p0.y, p1.x, p1.y);}
\DoxyCodeLine{02666 }
\DoxyCodeLine{02667   \textcolor{comment}{// Pan}}
\DoxyCodeLine{02668   \textcolor{keywordflow}{if} (!is3DView()) \{}
\DoxyCodeLine{02669     \mbox{\hyperlink{class_t_point_t}{TPointD}} cameraCenter = (cameraRect.getP00() + cameraRect.getP11()) * 0.5;}
\DoxyCodeLine{02670     panQt(QPoint(-\/cameraCenter.x, cameraCenter.y));}
\DoxyCodeLine{02671   \}}
\DoxyCodeLine{02672 }
\DoxyCodeLine{02673   \textcolor{keywordtype}{double} xratio = (double)viewRect.width() / cameraRect.getLx();}
\DoxyCodeLine{02674   \textcolor{keywordtype}{double} yratio = (double)viewRect.height() / cameraRect.getLy();}
\DoxyCodeLine{02675   \textcolor{keywordtype}{double} ratio  = std::min(xratio, yratio);}
\DoxyCodeLine{02676   \textcolor{keywordflow}{if} (ratio == 0.0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{02677   \textcolor{keywordflow}{if} (tempIsFlippedX)}
\DoxyCodeLine{02678     setViewMatrix(\mbox{\hyperlink{class_t_scale}{TScale}}(-\/1, 1) * m\_viewAff[m\_viewMode], m\_viewMode);}
\DoxyCodeLine{02679   \textcolor{keywordflow}{if} (tempIsFlippedY)}
\DoxyCodeLine{02680     setViewMatrix(\mbox{\hyperlink{class_t_scale}{TScale}}(1, -\/1) * m\_viewAff[m\_viewMode], m\_viewMode);}
\DoxyCodeLine{02681   \textcolor{comment}{// Scale and center on the center of \(\backslash\)a rect.}}
\DoxyCodeLine{02682   QPoint c = viewRect.center();}
\DoxyCodeLine{02683   zoom(\mbox{\hyperlink{class_t_point_t}{TPointD}}(c.x(), c.y()), ratio);}
\DoxyCodeLine{02684   emit onFlipHChanged(m\_isFlippedX);}
\DoxyCodeLine{02685   emit onFlipVChanged(m\_isFlippedY);}
\DoxyCodeLine{02686 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_abacde6b68591e1ad86c3146516dda792}\label{class_scene_viewer_abacde6b68591e1ad86c3146516dda792}} 
\index{SceneViewer@{SceneViewer}!fitToCameraOutline@{fitToCameraOutline}}
\index{fitToCameraOutline@{fitToCameraOutline}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{fitToCameraOutline}{fitToCameraOutline}}
{\footnotesize\ttfamily void Scene\+Viewer\+::fit\+To\+Camera\+Outline (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02690                                      \{}
\DoxyCodeLine{02691   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh            = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet();}
\DoxyCodeLine{02692   \textcolor{keywordtype}{int} frame               = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{02693   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} cameraId = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a5dc925584e35e1678f5678b79c470959}{getStageObjectTree}}()-\/>\mbox{\hyperlink{class_t_stage_object_tree_a7d63ae5d60c3a3aacf5da58c108ac167}{getCurrentCameraId}}();}
\DoxyCodeLine{02694   \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *camera    = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(cameraId);}
\DoxyCodeLine{02695   \mbox{\hyperlink{class_t_affine}{TAffine}} cameraPlacement = camera-\/>getPlacement(frame);}
\DoxyCodeLine{02696   \textcolor{keywordtype}{double} cameraZ          = camera-\/>\mbox{\hyperlink{class_t_stage_object_a52b1a3ec50ed35fbc07c9a3b64ecc21c}{getZ}}(frame);}
\DoxyCodeLine{02697   \mbox{\hyperlink{class_t_affine}{TAffine}} cameraAff =}
\DoxyCodeLine{02698       \mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}() * cameraPlacement * \mbox{\hyperlink{class_t_scale}{TScale}}((1000 + cameraZ) / 1000);}
\DoxyCodeLine{02699 }
\DoxyCodeLine{02700   QRect viewRect    = rect();}
\DoxyCodeLine{02701   \mbox{\hyperlink{class_t_rect_t}{TRectD}} cameraRect = ViewerDraw::getCameraRect();}
\DoxyCodeLine{02702   \mbox{\hyperlink{class_t_point_t}{TPointD}} P00       = cameraAff * cameraRect.getP00();}
\DoxyCodeLine{02703   \mbox{\hyperlink{class_t_point_t}{TPointD}} P10       = cameraAff * cameraRect.getP10();}
\DoxyCodeLine{02704   \mbox{\hyperlink{class_t_point_t}{TPointD}} P01       = cameraAff * cameraRect.getP01();}
\DoxyCodeLine{02705   \mbox{\hyperlink{class_t_point_t}{TPointD}} P11       = cameraAff * cameraRect.getP11();}
\DoxyCodeLine{02706   \mbox{\hyperlink{class_t_point_t}{TPointD}} p0        = \mbox{\hyperlink{class_t_point_t}{TPointD}}(std::min(\{P00.x, P01.x, P10.x, P11.x\}),}
\DoxyCodeLine{02707                        std::min(\{P00.y, P01.y, P10.y, P11.y\}));}
\DoxyCodeLine{02708   \mbox{\hyperlink{class_t_point_t}{TPointD}} p1        = \mbox{\hyperlink{class_t_point_t}{TPointD}}(std::max(\{P00.x, P01.x, P10.x, P11.x\}),}
\DoxyCodeLine{02709                        std::max(\{P00.y, P01.y, P10.y, P11.y\}));}
\DoxyCodeLine{02710   cameraRect        = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(p0.x, p0.y, p1.x, p1.y);}
\DoxyCodeLine{02711 }
\DoxyCodeLine{02712   \textcolor{comment}{// Pan}}
\DoxyCodeLine{02713   \textcolor{keywordflow}{if} (!is3DView()) \{}
\DoxyCodeLine{02714     \mbox{\hyperlink{class_t_point_t}{TPointD}} cameraCenter = (cameraRect.getP00() + cameraRect.getP11()) * 0.5;}
\DoxyCodeLine{02715     panQt(QPoint(-\/cameraCenter.x, cameraCenter.y));}
\DoxyCodeLine{02716   \}}
\DoxyCodeLine{02717 }
\DoxyCodeLine{02718   \textcolor{keywordtype}{double} xratio = (double)viewRect.width() / cameraRect.getLx();}
\DoxyCodeLine{02719   \textcolor{keywordtype}{double} yratio = (double)viewRect.height() / cameraRect.getLy();}
\DoxyCodeLine{02720   \textcolor{keywordtype}{double} ratio  = std::min(xratio, yratio);}
\DoxyCodeLine{02721   \textcolor{keywordflow}{if} (ratio == 0.0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{02722 }
\DoxyCodeLine{02723   \textcolor{comment}{// Scale and center on the center of \(\backslash\)a rect.}}
\DoxyCodeLine{02724   QPoint c = viewRect.center();}
\DoxyCodeLine{02725   zoom(\mbox{\hyperlink{class_t_point_t}{TPointD}}(c.x(), c.y()), ratio);}
\DoxyCodeLine{02726   zoom(\mbox{\hyperlink{class_t_point_t}{TPointD}}(c.x(), c.y()), 0.95);}
\DoxyCodeLine{02727 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a7aa63e40d31ff8087f5d4cceb5fd1fc0}\label{class_scene_viewer_a7aa63e40d31ff8087f5d4cceb5fd1fc0}} 
\index{SceneViewer@{SceneViewer}!flipX@{flipX}}
\index{flipX@{flipX}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{flipX}{flipX}}
{\footnotesize\ttfamily void Scene\+Viewer\+::flipX (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02537                         \{}
\DoxyCodeLine{02538   \textcolor{keywordtype}{double} flipAngle0 = (m\_rotationAngle[0] * -\/1) * 2;}
\DoxyCodeLine{02539   \textcolor{keywordtype}{double} flipAngle1 = (m\_rotationAngle[1] * -\/1) * 2;}
\DoxyCodeLine{02540   m\_rotationAngle[0] += flipAngle0;}
\DoxyCodeLine{02541   m\_rotationAngle[1] += flipAngle1;}
\DoxyCodeLine{02542   \textcolor{keywordflow}{if} (m\_isFlippedX != m\_isFlippedY) \{}
\DoxyCodeLine{02543     flipAngle0 = -\/flipAngle0;}
\DoxyCodeLine{02544     flipAngle1 = -\/flipAngle1;}
\DoxyCodeLine{02545   \}}
\DoxyCodeLine{02546   m\_viewAff[0] = m\_viewAff[0] * \mbox{\hyperlink{class_t_rotation}{TRotation}}(flipAngle0) * \mbox{\hyperlink{class_t_scale}{TScale}}(-\/1, 1);}
\DoxyCodeLine{02547   m\_viewAff[1] = m\_viewAff[1] * \mbox{\hyperlink{class_t_rotation}{TRotation}}(flipAngle1) * \mbox{\hyperlink{class_t_scale}{TScale}}(-\/1, 1);}
\DoxyCodeLine{02548   m\_viewAff[0].a13 *= -\/1;}
\DoxyCodeLine{02549   m\_viewAff[1].a13 *= -\/1;}
\DoxyCodeLine{02550   m\_isFlippedX = !m\_isFlippedX;}
\DoxyCodeLine{02551   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{02552   emit onZoomChanged();}
\DoxyCodeLine{02553   emit onFlipHChanged(m\_isFlippedX);}
\DoxyCodeLine{02554 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a8d72cb1162232646e8bc69b72c55dc5b}\label{class_scene_viewer_a8d72cb1162232646e8bc69b72c55dc5b}} 
\index{SceneViewer@{SceneViewer}!flipY@{flipY}}
\index{flipY@{flipY}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{flipY}{flipY}}
{\footnotesize\ttfamily void Scene\+Viewer\+::flipY (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02558                         \{}
\DoxyCodeLine{02559   \textcolor{keywordtype}{double} flipAngle0 = (m\_rotationAngle[0] * -\/1) * 2;}
\DoxyCodeLine{02560   \textcolor{keywordtype}{double} flipAngle1 = (m\_rotationAngle[1] * -\/1) * 2;}
\DoxyCodeLine{02561   m\_rotationAngle[0] += flipAngle0;}
\DoxyCodeLine{02562   m\_rotationAngle[1] += flipAngle1;}
\DoxyCodeLine{02563   \textcolor{keywordflow}{if} (m\_isFlippedX != m\_isFlippedY) \{}
\DoxyCodeLine{02564     flipAngle0 = -\/flipAngle0;}
\DoxyCodeLine{02565     flipAngle1 = -\/flipAngle1;}
\DoxyCodeLine{02566   \}}
\DoxyCodeLine{02567   m\_viewAff[0] = m\_viewAff[0] * \mbox{\hyperlink{class_t_rotation}{TRotation}}(flipAngle0) * \mbox{\hyperlink{class_t_scale}{TScale}}(1, -\/1);}
\DoxyCodeLine{02568   m\_viewAff[1] = m\_viewAff[1] * \mbox{\hyperlink{class_t_rotation}{TRotation}}(flipAngle1) * \mbox{\hyperlink{class_t_scale}{TScale}}(1, -\/1);}
\DoxyCodeLine{02569   m\_viewAff[0].a23 *= -\/1;}
\DoxyCodeLine{02570   m\_viewAff[1].a23 *= -\/1;}
\DoxyCodeLine{02571   m\_isFlippedY = !m\_isFlippedY;}
\DoxyCodeLine{02572   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{02573   emit onZoomChanged();}
\DoxyCodeLine{02574   emit onFlipVChanged(m\_isFlippedY);}
\DoxyCodeLine{02575 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_afee23545d546ce0e24be09d45a079831}\label{class_scene_viewer_afee23545d546ce0e24be09d45a079831}} 
\index{SceneViewer@{SceneViewer}!freeze@{freeze}}
\index{freeze@{freeze}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{freeze}{freeze}}
{\footnotesize\ttfamily void Scene\+Viewer\+::freeze (\begin{DoxyParamCaption}\item[{bool}]{on }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00914                                 \{}
\DoxyCodeLine{00915   \textcolor{keywordflow}{if} (!on) \{}
\DoxyCodeLine{00916     m\_viewGrabImage = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}();}
\DoxyCodeLine{00917     m\_freezedStatus = NO\_FREEZED;}
\DoxyCodeLine{00918   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00919     setCursor(Qt::ForbiddenCursor);}
\DoxyCodeLine{00920     m\_freezedStatus = UPDATE\_FREEZED;}
\DoxyCodeLine{00921   \}}
\DoxyCodeLine{00922   \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidateAll}}();}
\DoxyCodeLine{00923 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ab5b1db8cc53709170924278943aad036}\label{class_scene_viewer_ab5b1db8cc53709170924278943aad036}} 
\index{SceneViewer@{SceneViewer}!gestureEvent@{gestureEvent}}
\index{gestureEvent@{gestureEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{gestureEvent()}{gestureEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::gesture\+Event (\begin{DoxyParamCaption}\item[{QGesture\+Event $\ast$}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01012                                                \{}
\DoxyCodeLine{01013   m\_gestureActive = \textcolor{keyword}{false};}
\DoxyCodeLine{01014   \textcolor{keywordflow}{if} (QGesture *swipe = e-\/>gesture(Qt::SwipeGesture)) \{}
\DoxyCodeLine{01015     m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{01016   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (QGesture *pan = e-\/>gesture(Qt::PanGesture)) \{}
\DoxyCodeLine{01017     m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{01018   \}}
\DoxyCodeLine{01019   \textcolor{keywordflow}{if} (QGesture *pinch = e-\/>gesture(Qt::PinchGesture)) \{}
\DoxyCodeLine{01020     QPinchGesture *gesture = \textcolor{keyword}{static\_cast<}QPinchGesture *\textcolor{keyword}{>}(pinch);}
\DoxyCodeLine{01021     QPinchGesture::ChangeFlags changeFlags = gesture-\/>changeFlags();}
\DoxyCodeLine{01022     QPoint firstCenter                     = gesture-\/>centerPoint().toPoint();}
\DoxyCodeLine{01023     \textcolor{keywordflow}{if} (m\_touchDevice == QTouchDevice::TouchScreen)}
\DoxyCodeLine{01024       firstCenter = mapFromGlobal(firstCenter);}
\DoxyCodeLine{01025 }
\DoxyCodeLine{01026     \textcolor{keywordflow}{if} (gesture-\/>state() == Qt::GestureStarted) \{}
\DoxyCodeLine{01027       m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{01028     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (gesture-\/>state() == Qt::GestureFinished) \{}
\DoxyCodeLine{01029       m\_gestureActive = \textcolor{keyword}{false};}
\DoxyCodeLine{01030       m\_rotating      = \textcolor{keyword}{false};}
\DoxyCodeLine{01031       m\_zooming       = \textcolor{keyword}{false};}
\DoxyCodeLine{01032       m\_scaleFactor   = 0.0;}
\DoxyCodeLine{01033       m\_rotationDelta = 0.0;}
\DoxyCodeLine{01034     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01035       \textcolor{keywordflow}{if} (changeFlags \& QPinchGesture::ScaleFactorChanged) \{}
\DoxyCodeLine{01036         \textcolor{keywordtype}{double} scaleFactor = gesture-\/>scaleFactor();}
\DoxyCodeLine{01037         \textcolor{comment}{// the scale factor makes for too sensitive scaling}}
\DoxyCodeLine{01038         \textcolor{comment}{// divide the change in half}}
\DoxyCodeLine{01039         \textcolor{keywordflow}{if} (scaleFactor > 1) \{}
\DoxyCodeLine{01040           \textcolor{keywordtype}{double} decimalValue = scaleFactor -\/ 1;}
\DoxyCodeLine{01041           decimalValue /= 1.5;}
\DoxyCodeLine{01042           scaleFactor = 1 + decimalValue;}
\DoxyCodeLine{01043         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (scaleFactor < 1) \{}
\DoxyCodeLine{01044           \textcolor{keywordtype}{double} decimalValue = 1 -\/ scaleFactor;}
\DoxyCodeLine{01045           decimalValue /= 1.5;}
\DoxyCodeLine{01046           scaleFactor = 1 -\/ decimalValue;}
\DoxyCodeLine{01047         \}}
\DoxyCodeLine{01048         \textcolor{keywordflow}{if} (!m\_rotating \&\& !m\_zooming) \{}
\DoxyCodeLine{01049           \textcolor{keywordtype}{double} delta = scaleFactor -\/ 1;}
\DoxyCodeLine{01050           m\_scaleFactor += delta;}
\DoxyCodeLine{01051           \textcolor{keywordflow}{if} (m\_scaleFactor > .2 || m\_scaleFactor < -\/.2) \{}
\DoxyCodeLine{01052             m\_zooming = \textcolor{keyword}{true};}
\DoxyCodeLine{01053           \}}
\DoxyCodeLine{01054         \}}
\DoxyCodeLine{01055         \textcolor{keywordflow}{if} (m\_zooming) \{}
\DoxyCodeLine{01056           zoomQt(firstCenter * getDevPixRatio(), scaleFactor);}
\DoxyCodeLine{01057           m\_panning = \textcolor{keyword}{false};}
\DoxyCodeLine{01058         \}}
\DoxyCodeLine{01059         m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{01060       \}}
\DoxyCodeLine{01061       \textcolor{keywordflow}{if} (changeFlags \& QPinchGesture::RotationAngleChanged) \{}
\DoxyCodeLine{01062         qreal rotationDelta =}
\DoxyCodeLine{01063             gesture-\/>rotationAngle() -\/ gesture-\/>lastRotationAngle();}
\DoxyCodeLine{01064         \textcolor{keywordflow}{if} (m\_isFlippedX != m\_isFlippedY) rotationDelta = -\/rotationDelta;}
\DoxyCodeLine{01065         \mbox{\hyperlink{class_t_affine}{TAffine}} aff    = \mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}();}
\DoxyCodeLine{01066         \mbox{\hyperlink{class_t_point_t}{TPointD}} center = aff * \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0);}
\DoxyCodeLine{01067         \textcolor{keywordflow}{if} (!m\_rotating \&\& !m\_zooming) \{}
\DoxyCodeLine{01068           m\_rotationDelta += rotationDelta;}
\DoxyCodeLine{01069           \textcolor{keywordtype}{double} absDelta = std::abs(m\_rotationDelta);}
\DoxyCodeLine{01070           \textcolor{keywordflow}{if} (absDelta >= 10) \{}
\DoxyCodeLine{01071             m\_rotating = \textcolor{keyword}{true};}
\DoxyCodeLine{01072           \}}
\DoxyCodeLine{01073         \}}
\DoxyCodeLine{01074         \textcolor{keywordflow}{if} (m\_rotating) \{}
\DoxyCodeLine{01075           rotate(center, -\/rotationDelta);}
\DoxyCodeLine{01076         \}}
\DoxyCodeLine{01077       \}}
\DoxyCodeLine{01078 }
\DoxyCodeLine{01079       \textcolor{keywordflow}{if} (changeFlags \& QPinchGesture::CenterPointChanged) \{}
\DoxyCodeLine{01080         QPointF centerDelta = (gesture-\/>centerPoint() * getDevPixRatio()) -\/}
\DoxyCodeLine{01081                               (gesture-\/>lastCenterPoint() * getDevPixRatio());}
\DoxyCodeLine{01082         \textcolor{keywordflow}{if} (centerDelta.manhattanLength() > 1) \{}
\DoxyCodeLine{01083           \textcolor{comment}{// panQt(centerDelta.toPoint());}}
\DoxyCodeLine{01084         \}}
\DoxyCodeLine{01085         m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{01086       \}}
\DoxyCodeLine{01087     \}}
\DoxyCodeLine{01088   \}}
\DoxyCodeLine{01089   e-\/>accept();}
\DoxyCodeLine{01090 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a46de6de255d707906df8cfcfdf3a1ead}\label{class_scene_viewer_a46de6de255d707906df8cfcfdf3a1ead}} 
\index{SceneViewer@{SceneViewer}!getActualClipRect@{getActualClipRect}}
\index{getActualClipRect@{getActualClipRect}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getActualClipRect()}{getActualClipRect()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_rect_t}{TRect}} Scene\+Viewer\+::get\+Actual\+Clip\+Rect (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02184                                                        \{}
\DoxyCodeLine{02185   \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}} viewerSize(width(), height());}
\DoxyCodeLine{02186   \mbox{\hyperlink{class_t_rect_t}{TRectD}} clipRect(viewerSize);}
\DoxyCodeLine{02187 }
\DoxyCodeLine{02188   \textcolor{keywordflow}{if} (is3DView()) \{}
\DoxyCodeLine{02189     \mbox{\hyperlink{class_t_point_t}{TPointD}} p00 = winToWorld(clipRect.getP00());}
\DoxyCodeLine{02190     \mbox{\hyperlink{class_t_point_t}{TPointD}} p01 = winToWorld(clipRect.getP01());}
\DoxyCodeLine{02191     \mbox{\hyperlink{class_t_point_t}{TPointD}} p10 = winToWorld(clipRect.getP10());}
\DoxyCodeLine{02192     \mbox{\hyperlink{class_t_point_t}{TPointD}} p11 = winToWorld(clipRect.getP11());}
\DoxyCodeLine{02193     clipRect = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(\mbox{\hyperlink{class_t_point_t}{TPointD}}(std::min(p00.x, p01.x), std::min(p00.y, p10.y)),}
\DoxyCodeLine{02194                       \mbox{\hyperlink{class_t_point_t}{TPointD}}(std::max(p11.x, p10.x), std::max(p11.y, p01.y)));}
\DoxyCodeLine{02195   \}}
\DoxyCodeLine{02196   \textcolor{comment}{// this condition will catch both cases of m\_clipRect == empty and}}
\DoxyCodeLine{02197   \textcolor{comment}{// m\_clipRect == InvalidateAllRect}}
\DoxyCodeLine{02198   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_clipRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}())}
\DoxyCodeLine{02199     clipRect -\/= \mbox{\hyperlink{class_t_point_t}{TPointD}}(viewerSize.lx / 2, viewerSize.ly / 2);}
\DoxyCodeLine{02200   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02201     \mbox{\hyperlink{class_t_rect_t}{TRectD}} app = aff * (m\_clipRect.enlarge(3));}
\DoxyCodeLine{02202     clipRect =}
\DoxyCodeLine{02203         \mbox{\hyperlink{class_t_rect_t}{TRectD}}(tceil(app.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}), tceil(app.y0), tfloor(app.x1), tfloor(app.y1));}
\DoxyCodeLine{02204   \}}
\DoxyCodeLine{02205 }
\DoxyCodeLine{02206   \textcolor{keywordflow}{return} convert(clipRect);}
\DoxyCodeLine{02207 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a7fd1e40caee87c57edd5d890dc41b8c8}\label{class_scene_viewer_a7fd1e40caee87c57edd5d890dc41b8c8}} 
\index{SceneViewer@{SceneViewer}!getDpiFactor@{getDpiFactor}}
\index{getDpiFactor@{getDpiFactor}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getDpiFactor()}{getDpiFactor()}}
{\footnotesize\ttfamily double Scene\+Viewer\+::get\+Dpi\+Factor (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

a factor for getting pixel-\/based zoom ratio 
\begin{DoxyCode}{0}
\DoxyCodeLine{02386                                  \{}
\DoxyCodeLine{02387   \textcolor{comment}{// When the current unit is "{}pixels"{}, always use a standard dpi}}
\DoxyCodeLine{02388   \textcolor{keywordtype}{double} cameraDpi = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()}
\DoxyCodeLine{02389                          -\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()}
\DoxyCodeLine{02390                          -\/>getScene()}
\DoxyCodeLine{02391                          -\/>\mbox{\hyperlink{class_toonz_scene_a750b5ab623ccec744013b0c83bf20abc}{getCurrentCamera}}()}
\DoxyCodeLine{02392                          -\/>\mbox{\hyperlink{class_t_camera_adf45510b5dc53f6481308ef489fbd5a9}{getDpi}}()}
\DoxyCodeLine{02393                          .x;}
\DoxyCodeLine{02394   \textcolor{keywordflow}{if} (Preferences::instance()-\/>getPixelsOnly()) \{}
\DoxyCodeLine{02395     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / Stage::standardDpi;}
\DoxyCodeLine{02396   \}}
\DoxyCodeLine{02397 }
\DoxyCodeLine{02398   \textcolor{comment}{// When preview mode, use a camera DPI}}
\DoxyCodeLine{02399   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (isPreviewEnabled()) \{}
\DoxyCodeLine{02400     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / cameraDpi;}
\DoxyCodeLine{02401   \}}
\DoxyCodeLine{02402   \textcolor{comment}{// When level editing mode, use an image DPI}}
\DoxyCodeLine{02403   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getCurrentFrame()-\/>isEditingLevel()) \{}
\DoxyCodeLine{02404     \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl;}
\DoxyCodeLine{02405     sl = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getSimpleLevel();}
\DoxyCodeLine{02406     \textcolor{keywordflow}{if} (!sl) \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / cameraDpi;}
\DoxyCodeLine{02407     \textcolor{keywordflow}{if} (sl-\/>\mbox{\hyperlink{class_t_xsh_level_a1a147f1e970a62120c0bbaf0020a8932}{getType}}() == PLI\_XSHLEVEL) \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / cameraDpi;}
\DoxyCodeLine{02408     \textcolor{keywordflow}{if} (sl-\/>getImageDpi() != \mbox{\hyperlink{class_t_point_t}{TPointD}}())}
\DoxyCodeLine{02409       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / sl-\/>getImageDpi().x;}
\DoxyCodeLine{02410     \textcolor{keywordflow}{if} (sl-\/>getDpi() != \mbox{\hyperlink{class_t_point_t}{TPointD}}()) \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / sl-\/>getDpi().x;}
\DoxyCodeLine{02411     \textcolor{comment}{// no valid dpi, use camera dpi}}
\DoxyCodeLine{02412     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / cameraDpi;}
\DoxyCodeLine{02413   \}}
\DoxyCodeLine{02414   \textcolor{comment}{// When the special case in the scene editing mode:}}
\DoxyCodeLine{02415   \textcolor{comment}{// If the option "{}ActualPixelViewOnSceneEditingMode"{} is ON,}}
\DoxyCodeLine{02416   \textcolor{comment}{// use  current level's DPI set in the level settings.}}
\DoxyCodeLine{02417   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Preferences::instance()}
\DoxyCodeLine{02418                -\/>isActualPixelViewOnSceneEditingModeEnabled()) \{}
\DoxyCodeLine{02419     \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_cleanup_preview_check_a231efbbe4e3356757b725452d5efb62d}{CleanupPreviewCheck::instance}}()-\/>isEnabled() ||}
\DoxyCodeLine{02420         \mbox{\hyperlink{class_camera_test_check_adc1033b93dea95f49db36d8fb668e16d}{CameraTestCheck::instance}}()-\/>isEnabled()) \{}
\DoxyCodeLine{02421       \textcolor{keywordtype}{double} cleanupCameraDpi = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()}
\DoxyCodeLine{02422                                     -\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()}
\DoxyCodeLine{02423                                     -\/>getScene()}
\DoxyCodeLine{02424                                     -\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}()}
\DoxyCodeLine{02425                                     -\/>\mbox{\hyperlink{class_t_scene_properties_a84e6735bb0b0ea5054b9592c9612aff9}{getCleanupParameters}}()}
\DoxyCodeLine{02426                                     -\/>m\_camera.\mbox{\hyperlink{class_t_camera_adf45510b5dc53f6481308ef489fbd5a9}{getDpi}}()}
\DoxyCodeLine{02427                                     .x;}
\DoxyCodeLine{02428       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / cleanupCameraDpi;}
\DoxyCodeLine{02429     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02430       \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl;}
\DoxyCodeLine{02431       sl = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getSimpleLevel();}
\DoxyCodeLine{02432       \textcolor{keywordflow}{if} (!sl) \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / cameraDpi;}
\DoxyCodeLine{02433       \textcolor{keywordflow}{if} (sl-\/>\mbox{\hyperlink{class_t_xsh_level_a1a147f1e970a62120c0bbaf0020a8932}{getType}}() == PLI\_XSHLEVEL) \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / cameraDpi;}
\DoxyCodeLine{02434       \textcolor{keywordflow}{if} (sl-\/>getDpi() == \mbox{\hyperlink{class_t_point_t}{TPointD}}()) \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / cameraDpi;}
\DoxyCodeLine{02435       \textcolor{comment}{// use default value for the argument of getDpi() (=TFrameId::NO\_FRAME）}}
\DoxyCodeLine{02436       \textcolor{comment}{// so that the dpi of the first frame in the level will be returned.}}
\DoxyCodeLine{02437       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / sl-\/>getDpi().x;}
\DoxyCodeLine{02438     \}}
\DoxyCodeLine{02439   \}}
\DoxyCodeLine{02440   \textcolor{comment}{// When the scene editing mode without any option, use the camera dpi}}
\DoxyCodeLine{02441   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02442     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} / cameraDpi;}
\DoxyCodeLine{02443   \}}
\DoxyCodeLine{02444 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00159}{TScene\+Properties\+::get\+Cleanup\+Parameters()}}, \mbox{\hyperlink{l01472}{Toonz\+Scene\+::get\+Current\+Camera()}}, \mbox{\hyperlink{l00122}{TApp\+::get\+Current\+Level()}}, \mbox{\hyperlink{l00106}{TApp\+::get\+Current\+Scene()}}, \mbox{\hyperlink{l00062}{TCamera\+::get\+Dpi()}}, \mbox{\hyperlink{l00087}{Toonz\+Scene\+::get\+Properties()}}, \mbox{\hyperlink{l00081}{TXsh\+Level\+::get\+Type()}}, \mbox{\hyperlink{l00037}{Stage\+::inch}}, \mbox{\hyperlink{l00052}{Camera\+Test\+Check\+::instance()}}, \mbox{\hyperlink{l00093}{Cleanup\+Preview\+Check\+::instance()}}, and \mbox{\hyperlink{l00215}{TApp\+::instance()}}.

\mbox{\Hypertarget{class_scene_viewer_a2a7faf3b67ff28e82ad7294924b6cb74}\label{class_scene_viewer_a2a7faf3b67ff28e82ad7294924b6cb74}} 
\index{SceneViewer@{SceneViewer}!getDpiScale@{getDpiScale}}
\index{getDpiScale@{getDpiScale}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getDpiScale()}{getDpiScale()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPointD}} Scene\+Viewer\+::get\+Dpi\+Scale (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00261 \{ \textcolor{keywordflow}{return} m\_dpiScale; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ac03615cda02f9ecf6a96c6839918fc79}\label{class_scene_viewer_ac03615cda02f9ecf6a96c6839918fc79}} 
\index{SceneViewer@{SceneViewer}!getFPS@{getFPS}}
\index{getFPS@{getFPS}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getFPS()}{getFPS()}}
{\footnotesize\ttfamily int Scene\+Viewer\+::get\+FPS (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00241 \{ \textcolor{keywordflow}{return} m\_FPS; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a7894cec2d508ff6e264616df00b26479}\label{class_scene_viewer_a7894cec2d508ff6e264616df00b26479}} 
\index{SceneViewer@{SceneViewer}!getGeometry@{getGeometry}}
\index{getGeometry@{getGeometry}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getGeometry()}{getGeometry()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_rect_t}{TRectD}} Scene\+Viewer\+::get\+Geometry (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

return the viewer geometry in order to avoid picking the style outside of the viewer when using the stylepicker and the finger tools 

Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03254                                       \{}
\DoxyCodeLine{03255   \textcolor{keywordtype}{int} devPixRatio = getDevPixRatio();}
\DoxyCodeLine{03256   \mbox{\hyperlink{class_t_tool}{TTool}} *tool     = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{03257   \mbox{\hyperlink{class_t_point_t}{TPointD}} topLeft =}
\DoxyCodeLine{03258       tool-\/>getMatrix().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * winToWorld(geometry().topLeft() * devPixRatio);}
\DoxyCodeLine{03259   \mbox{\hyperlink{class_t_point_t}{TPointD}} bottomRight = tool-\/>getMatrix().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() *}
\DoxyCodeLine{03260                         winToWorld(geometry().bottomRight() * devPixRatio);}
\DoxyCodeLine{03261 }
\DoxyCodeLine{03262   \mbox{\hyperlink{class_t_object_handle}{TObjectHandle}} *objHandle = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a0d91c122eec2b756b7c4780014e49f9e}{getCurrentObject}}();}
\DoxyCodeLine{03263   \textcolor{keywordflow}{if} (tool-\/>getToolType() \& TTool::LevelTool \&\& !objHandle-\/>isSpline()) \{}
\DoxyCodeLine{03264     topLeft.x /= m\_dpiScale.x;}
\DoxyCodeLine{03265     topLeft.y /= m\_dpiScale.y;}
\DoxyCodeLine{03266     bottomRight.x /= m\_dpiScale.x;}
\DoxyCodeLine{03267     bottomRight.y /= m\_dpiScale.y;}
\DoxyCodeLine{03268   \}}
\DoxyCodeLine{03269 }
\DoxyCodeLine{03270   \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_rect_t}{TRectD}}(topLeft, bottomRight);}
\DoxyCodeLine{03271 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00130}{TApp\+::get\+Current\+Object()}}, \mbox{\hyperlink{l00126}{TApp\+::get\+Current\+Tool()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, and \mbox{\hyperlink{l00055}{TAffine\+::inv()}}.

\mbox{\Hypertarget{class_scene_viewer_a6d249c7f77f675cecbc6ad0afdf8cc69}\label{class_scene_viewer_a6d249c7f77f675cecbc6ad0afdf8cc69}} 
\index{SceneViewer@{SceneViewer}!getHGuide@{getHGuide}}
\index{getHGuide@{getHGuide}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getHGuide()}{getHGuide()}}
{\footnotesize\ttfamily double Scene\+Viewer\+::get\+HGuide (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01166 \{ \textcolor{keywordflow}{return} m\_hRuler-\/>getGuide(index); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ab0f2d483de9e3552346138f343c585c7}\label{class_scene_viewer_ab0f2d483de9e3552346138f343c585c7}} 
\index{SceneViewer@{SceneViewer}!getHGuideCount@{getHGuideCount}}
\index{getHGuideCount@{getHGuideCount}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getHGuideCount()}{getHGuideCount()}}
{\footnotesize\ttfamily int Scene\+Viewer\+::get\+HGuide\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01158                                 \{}
\DoxyCodeLine{01159   \textcolor{keywordflow}{if} (viewGuideToggle.getStatus())}
\DoxyCodeLine{01160     \textcolor{keywordflow}{return} m\_hRuler-\/>getGuideCount();}
\DoxyCodeLine{01161   \textcolor{keywordflow}{else}}
\DoxyCodeLine{01162     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{01163 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a867728dd5a6af616e3bb10472441553a}\label{class_scene_viewer_a867728dd5a6af616e3bb10472441553a}} 
\index{SceneViewer@{SceneViewer}!getIsFlippedX@{getIsFlippedX}}
\index{getIsFlippedX@{getIsFlippedX}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getIsFlippedX()}{getIsFlippedX()}}
{\footnotesize\ttfamily bool Scene\+Viewer\+::get\+Is\+FlippedX (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00268 \{ \textcolor{keywordflow}{return} m\_isFlippedX; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a0ee26ba62d6500895dc7b18a3d9c0451}\label{class_scene_viewer_a0ee26ba62d6500895dc7b18a3d9c0451}} 
\index{SceneViewer@{SceneViewer}!getIsFlippedY@{getIsFlippedY}}
\index{getIsFlippedY@{getIsFlippedY}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getIsFlippedY()}{getIsFlippedY()}}
{\footnotesize\ttfamily bool Scene\+Viewer\+::get\+Is\+FlippedY (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00269 \{ \textcolor{keywordflow}{return} m\_isFlippedY; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a14d04fa24b2fb8f29cec3d17a2237ad7}\label{class_scene_viewer_a14d04fa24b2fb8f29cec3d17a2237ad7}} 
\index{SceneViewer@{SceneViewer}!getNormalZoomScale@{getNormalZoomScale}}
\index{getNormalZoomScale@{getNormalZoomScale}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getNormalZoomScale()}{getNormalZoomScale()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_affine}{TAffine}} Scene\+Viewer\+::get\+Normal\+Zoom\+Scale (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{03228                                         \{}
\DoxyCodeLine{03229   \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_scale}{TScale}}(\mbox{\hyperlink{class_scene_viewer_a7fd1e40caee87c57edd5d890dc41b8c8}{getDpiFactor}}()).\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}();}
\DoxyCodeLine{03230 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_aa4f030a7fcd3eb03e217442ddfb1ee82}\label{class_scene_viewer_aa4f030a7fcd3eb03e217442ddfb1ee82}} 
\index{SceneViewer@{SceneViewer}!getPan3D@{getPan3D}}
\index{getPan3D@{getPan3D}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getPan3D()}{getPan3D()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPointD}} Scene\+Viewer\+::get\+Pan3D (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00256 \{ \textcolor{keywordflow}{return} m\_pan3D; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a3c7c61456c1f6403bfd86c0729f52207}\label{class_scene_viewer_a3c7c61456c1f6403bfd86c0729f52207}} 
\index{SceneViewer@{SceneViewer}!getPixelSize@{getPixelSize}}
\index{getPixelSize@{getPixelSize}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getPixelSize()}{getPixelSize()}}
{\footnotesize\ttfamily double Scene\+Viewer\+::get\+Pixel\+Size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Returns the length of a pixel in current Open\+GL coordinates 

Implements \mbox{\hyperlink{class_t_tool_1_1_viewer_a0e87a68354646cc8c05128437b7df35d}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00213 \{ \textcolor{keywordflow}{return} m\_pixelSize; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_acb52de98a6c2cd11dfd482437ebddf66}\label{class_scene_viewer_acb52de98a6c2cd11dfd482437ebddf66}} 
\index{SceneViewer@{SceneViewer}!getPreviewMode@{getPreviewMode}}
\index{getPreviewMode@{getPreviewMode}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getPreviewMode()}{getPreviewMode()}}
{\footnotesize\ttfamily int Scene\+Viewer\+::get\+Preview\+Mode (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00222 \{ \textcolor{keywordflow}{return} m\_previewMode; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a3d6ff236dc014acbe3fa2d3650dbb0ea}\label{class_scene_viewer_a3d6ff236dc014acbe3fa2d3650dbb0ea}} 
\index{SceneViewer@{SceneViewer}!getPreviewRect@{getPreviewRect}}
\index{getPreviewRect@{getPreviewRect}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getPreviewRect()}{getPreviewRect()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_rect_t}{TRectD}} Scene\+Viewer\+::get\+Preview\+Rect (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_previewer_1_1_listener}{Previewer\+::\+Listener}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00854                                          \{}
\DoxyCodeLine{00855   \mbox{\hyperlink{class_t_app}{TApp}} *app               = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{00856   \textcolor{keywordtype}{int} row                 = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{00857   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh            = app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet();}
\DoxyCodeLine{00858   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} cameraId = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a5dc925584e35e1678f5678b79c470959}{getStageObjectTree}}()-\/>\mbox{\hyperlink{class_t_stage_object_tree_a7d63ae5d60c3a3aacf5da58c108ac167}{getCurrentCameraId}}();}
\DoxyCodeLine{00859   \textcolor{keywordtype}{double} cameraZ          = xsh-\/>\mbox{\hyperlink{class_t_xsheet_ac3cff0937663af24b324430b134ed8b2}{getZ}}(cameraId, row);}
\DoxyCodeLine{00860   \mbox{\hyperlink{class_t_affine}{TAffine}} cameraAff =}
\DoxyCodeLine{00861       xsh-\/>\mbox{\hyperlink{class_t_xsheet_abd766f516cac9898a2a952463618a9fe}{getPlacement}}(cameraId, row) * \mbox{\hyperlink{class_t_scale}{TScale}}((1000 + cameraZ) / 1000);}
\DoxyCodeLine{00862 }
\DoxyCodeLine{00863   \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}} cameraSize =}
\DoxyCodeLine{00864       app-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_a750b5ab623ccec744013b0c83bf20abc}{getCurrentCamera}}()-\/>\mbox{\hyperlink{class_t_camera_a6f561eca912177c2150b3e57816f02f6}{getSize}}();}
\DoxyCodeLine{00865   \mbox{\hyperlink{class_t_dimension_t}{TDimension}} cameraRes =}
\DoxyCodeLine{00866       app-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_a750b5ab623ccec744013b0c83bf20abc}{getCurrentCamera}}()-\/>\mbox{\hyperlink{class_t_camera_a9a7c573e7a2c397ffae4b747809ea2a5}{getRes}}();}
\DoxyCodeLine{00867   \mbox{\hyperlink{class_t_scale}{TScale}} cameraScale(\mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} * cameraSize.lx / cameraRes.lx,}
\DoxyCodeLine{00868                      \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}} * cameraSize.ly / cameraRes.ly);}
\DoxyCodeLine{00869 }
\DoxyCodeLine{00870   \mbox{\hyperlink{class_t_rect_t}{TRectD}} viewRect(-\/width() * 0.5, -\/height() * 0.5, width() * 0.5,}
\DoxyCodeLine{00871                   height() * 0.5);}
\DoxyCodeLine{00872 }
\DoxyCodeLine{00873   \textcolor{keywordflow}{return} (\mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}() * cameraAff * cameraScale).inv() * viewRect;}
\DoxyCodeLine{00874 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a71c3b2c826bd5efa2762dc38b695edfb}\label{class_scene_viewer_a71c3b2c826bd5efa2762dc38b695edfb}} 
\index{SceneViewer@{SceneViewer}!getSceneMatrix@{getSceneMatrix}}
\index{getSceneMatrix@{getSceneMatrix}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getSceneMatrix()}{getSceneMatrix()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_affine}{TAffine}} Scene\+Viewer\+::get\+Scene\+Matrix (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Return the view matrix. The view matrix is a matrix contained in {\bfseries{m\+\_\+view\+Aff}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{02227                                           \{}
\DoxyCodeLine{02228   \textcolor{keywordtype}{int} viewMode = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isEditingLevel()}
\DoxyCodeLine{02229                      ? LEVEL\_VIEWMODE}
\DoxyCodeLine{02230                      : SCENE\_VIEWMODE;}
\DoxyCodeLine{02231   \textcolor{keywordflow}{if} (is3DView()) \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_affine}{TAffine}}();}
\DoxyCodeLine{02232   \textcolor{keywordflow}{return} m\_viewAff[viewMode];}
\DoxyCodeLine{02233 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00114}{TApp\+::get\+Current\+Frame()}}, and \mbox{\hyperlink{l00215}{TApp\+::instance()}}.

\mbox{\Hypertarget{class_scene_viewer_acd65e1634747cdfd37a49c7c57778973}\label{class_scene_viewer_acd65e1634747cdfd37a49c7c57778973}} 
\index{SceneViewer@{SceneViewer}!getVGuide@{getVGuide}}
\index{getVGuide@{getVGuide}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getVGuide()}{getVGuide()}}
{\footnotesize\ttfamily double Scene\+Viewer\+::get\+VGuide (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01165 \{ \textcolor{keywordflow}{return} m\_vRuler-\/>getGuide(index); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a841545e56b0e1d20f2475b2b214b5f09}\label{class_scene_viewer_a841545e56b0e1d20f2475b2b214b5f09}} 
\index{SceneViewer@{SceneViewer}!getVGuideCount@{getVGuideCount}}
\index{getVGuideCount@{getVGuideCount}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getVGuideCount()}{getVGuideCount()}}
{\footnotesize\ttfamily int Scene\+Viewer\+::get\+VGuide\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01152                                 \{}
\DoxyCodeLine{01153   \textcolor{keywordflow}{if} (viewGuideToggle.getStatus())}
\DoxyCodeLine{01154     \textcolor{keywordflow}{return} m\_vRuler-\/>getGuideCount();}
\DoxyCodeLine{01155   \textcolor{keywordflow}{else}}
\DoxyCodeLine{01156     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{01157 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}\label{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}} 
\index{SceneViewer@{SceneViewer}!getViewMatrix@{getViewMatrix}}
\index{getViewMatrix@{getViewMatrix}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getViewMatrix()}{getViewMatrix()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_affine}{TAffine}} Scene\+Viewer\+::get\+View\+Matrix (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Return the view matrix. The view matrix is a matrix contained in {\bfseries{m\+\_\+view\+Aff}}; if the \mbox{\hyperlink{class_scene_viewer}{Scene\+Viewer}} in showing images in Camera view Mode (m\+\_\+reference\+Mode = CAMERA\+\_\+\+REFERENCE) the returned affine is composed with camera transformation. 

Reimplemented from \mbox{\hyperlink{class_t_tool_1_1_viewer_a97b71c149134c5a3d0ba0d5333b0b3c2}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02211                                          \{}
\DoxyCodeLine{02212   \textcolor{keywordtype}{int} viewMode = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isEditingLevel()}
\DoxyCodeLine{02213                      ? LEVEL\_VIEWMODE}
\DoxyCodeLine{02214                      : SCENE\_VIEWMODE;}
\DoxyCodeLine{02215   \textcolor{keywordflow}{if} (is3DView()) \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_affine}{TAffine}}();}
\DoxyCodeLine{02216   \textcolor{keywordflow}{if} (m\_referenceMode == CAMERA\_REFERENCE) \{}
\DoxyCodeLine{02217     \textcolor{keywordtype}{int} frame    = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{02218     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet();}
\DoxyCodeLine{02219     \mbox{\hyperlink{class_t_affine}{TAffine}} aff  = xsh-\/>\mbox{\hyperlink{class_t_xsheet_ac08197d98e00154a4a974d5b6a5e04d7}{getCameraAff}}(frame);}
\DoxyCodeLine{02220     \textcolor{keywordflow}{return} m\_viewAff[viewMode] * aff.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}();}
\DoxyCodeLine{02221   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{02222     \textcolor{keywordflow}{return} m\_viewAff[viewMode];}
\DoxyCodeLine{02223 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00620}{TXsheet\+::get\+Camera\+Aff()}}, \mbox{\hyperlink{l00114}{TApp\+::get\+Current\+Frame()}}, \mbox{\hyperlink{l00110}{TApp\+::get\+Current\+Xsheet()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, and \mbox{\hyperlink{l00055}{TAffine\+::inv()}}.



Referenced by \mbox{\hyperlink{l01598}{draw\+Overlay()}}, \mbox{\hyperlink{l03064}{pos\+To\+Row()}}, and \mbox{\hyperlink{l01007}{world\+To\+Pos()}}.

\mbox{\Hypertarget{class_scene_viewer_a17c5430ffb3cea34704430a7f623dba1}\label{class_scene_viewer_a17c5430ffb3cea34704430a7f623dba1}} 
\index{SceneViewer@{SceneViewer}!getViewportSize@{getViewportSize}}
\index{getViewportSize@{getViewportSize}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getViewportSize()}{getViewportSize()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_dimension_t}{TDimension}} Scene\+Viewer\+::get\+Viewport\+Size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00249 \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_dimension_t}{TDimension}}(width(), height()); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a504e74706e339c8b92df181000b143a1}\label{class_scene_viewer_a504e74706e339c8b92df181000b143a1}} 
\index{SceneViewer@{SceneViewer}!getZoomScale3D@{getZoomScale3D}}
\index{getZoomScale3D@{getZoomScale3D}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getZoomScale3D()}{getZoomScale3D()}}
{\footnotesize\ttfamily double Scene\+Viewer\+::get\+Zoom\+Scale3D (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00257 \{ \textcolor{keywordflow}{return} m\_zoomScale3D; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_abc2a1a75cd067ec5588dfdbd583d483b}\label{class_scene_viewer_abc2a1a75cd067ec5588dfdbd583d483b}} 
\index{SceneViewer@{SceneViewer}!getZoomScaleFittingWithScreen@{getZoomScaleFittingWithScreen}}
\index{getZoomScaleFittingWithScreen@{getZoomScaleFittingWithScreen}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{getZoomScaleFittingWithScreen()}{getZoomScaleFittingWithScreen()}}
{\footnotesize\ttfamily double Scene\+Viewer\+::get\+Zoom\+Scale\+Fitting\+With\+Screen (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

when showing the viewer with full-\/screen mode, add a zoom factor which can show image fitting with the screen size 
\begin{DoxyCode}{0}
\DoxyCodeLine{02451                                                   \{}
\DoxyCodeLine{02452   \mbox{\hyperlink{class_t_dimension_t}{TDimension}} imgSize;}
\DoxyCodeLine{02453 }
\DoxyCodeLine{02454   \textcolor{comment}{// get the image size to be rendered}}
\DoxyCodeLine{02455 }
\DoxyCodeLine{02456   \textcolor{keywordflow}{if} (isPreviewEnabled())}
\DoxyCodeLine{02457     imgSize = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()}
\DoxyCodeLine{02458                   -\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()}
\DoxyCodeLine{02459                   -\/>getScene()}
\DoxyCodeLine{02460                   -\/>\mbox{\hyperlink{class_toonz_scene_a750b5ab623ccec744013b0c83bf20abc}{getCurrentCamera}}()}
\DoxyCodeLine{02461                   -\/>\mbox{\hyperlink{class_t_camera_a9a7c573e7a2c397ffae4b747809ea2a5}{getRes}}();}
\DoxyCodeLine{02462   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getCurrentFrame()-\/>isEditingLevel()) \{}
\DoxyCodeLine{02463     \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getSimpleLevel();}
\DoxyCodeLine{02464     \textcolor{keywordflow}{if} (!sl || sl-\/>\mbox{\hyperlink{class_t_xsh_level_a1a147f1e970a62120c0bbaf0020a8932}{getType}}() == PLI\_XSHLEVEL || sl-\/>getImageDpi() == \mbox{\hyperlink{class_t_point_t}{TPointD}}())}
\DoxyCodeLine{02465       \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{02466 }
\DoxyCodeLine{02467     imgSize = sl-\/>getResolution();}
\DoxyCodeLine{02468   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Preferences::instance()}
\DoxyCodeLine{02469                  -\/>isActualPixelViewOnSceneEditingModeEnabled() \&\&}
\DoxyCodeLine{02470              !\mbox{\hyperlink{class_cleanup_preview_check_a231efbbe4e3356757b725452d5efb62d}{CleanupPreviewCheck::instance}}()-\/>isEnabled() \&\&}
\DoxyCodeLine{02471              !\mbox{\hyperlink{class_camera_test_check_adc1033b93dea95f49db36d8fb668e16d}{CameraTestCheck::instance}}()-\/>isEnabled()) \{}
\DoxyCodeLine{02472     \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getSimpleLevel();}
\DoxyCodeLine{02473     \textcolor{keywordflow}{if} (!sl || sl-\/>\mbox{\hyperlink{class_t_xsh_level_a1a147f1e970a62120c0bbaf0020a8932}{getType}}() == PLI\_XSHLEVEL || sl-\/>getDpi() == \mbox{\hyperlink{class_t_point_t}{TPointD}}())}
\DoxyCodeLine{02474       \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{02475     imgSize = sl-\/>getResolution();}
\DoxyCodeLine{02476 }
\DoxyCodeLine{02477   \} \textcolor{keywordflow}{else}  \textcolor{comment}{// SCENE\_VIEWMODE}}
\DoxyCodeLine{02478     \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{02479 }
\DoxyCodeLine{02480   \textcolor{comment}{// add small margin on the edge of the image}}
\DoxyCodeLine{02481   \textcolor{keywordtype}{int} margin = 20;}
\DoxyCodeLine{02482   \textcolor{comment}{// get the desktop resolution}}
\DoxyCodeLine{02483   QRect rec = QApplication::desktop()-\/>screenGeometry();}
\DoxyCodeLine{02484 }
\DoxyCodeLine{02485   \textcolor{comment}{// fit to either direction}}
\DoxyCodeLine{02486   \textcolor{keywordtype}{int} moni\_x = rec.width() -\/ (margin * 2);}
\DoxyCodeLine{02487   \textcolor{keywordtype}{int} moni\_y = rec.height() -\/ (margin * 2);}
\DoxyCodeLine{02488   \textcolor{keywordflow}{return} std::min((\textcolor{keywordtype}{double})moni\_x / (\textcolor{keywordtype}{double})imgSize.lx,}
\DoxyCodeLine{02489                   (\textcolor{keywordtype}{double})moni\_y / (\textcolor{keywordtype}{double})imgSize.ly);}
\DoxyCodeLine{02490 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l01472}{Toonz\+Scene\+::get\+Current\+Camera()}}, \mbox{\hyperlink{l00122}{TApp\+::get\+Current\+Level()}}, \mbox{\hyperlink{l00106}{TApp\+::get\+Current\+Scene()}}, \mbox{\hyperlink{l00072}{TCamera\+::get\+Res()}}, \mbox{\hyperlink{l00081}{TXsh\+Level\+::get\+Type()}}, \mbox{\hyperlink{l00052}{Camera\+Test\+Check\+::instance()}}, \mbox{\hyperlink{l00093}{Cleanup\+Preview\+Check\+::instance()}}, and \mbox{\hyperlink{l00215}{TApp\+::instance()}}.

\mbox{\Hypertarget{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}\label{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}} 
\index{SceneViewer@{SceneViewer}!GLInvalidateAll@{GLInvalidateAll}}
\index{GLInvalidateAll@{GLInvalidateAll}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{GLInvalidateAll()}{GLInvalidateAll()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::\+GLInvalidate\+All (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Redraws the entire viewer, bypassing Qt\textquotesingle{}s event system 

Implements \mbox{\hyperlink{class_t_tool_1_1_viewer_a4e256660e14db34f8b1d3d74b62e8851}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02269                                   \{}
\DoxyCodeLine{02270   m\_clipRect = InvalidateAllRect;}
\DoxyCodeLine{02271   update();}
\DoxyCodeLine{02272   \textcolor{keywordflow}{if} (m\_vRuler) m\_vRuler-\/>update();}
\DoxyCodeLine{02273   \textcolor{keywordflow}{if} (m\_hRuler) m\_hRuler-\/>update();}
\DoxyCodeLine{02274 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l02914}{on\+Tool\+Changed()}}.

\mbox{\Hypertarget{class_scene_viewer_ae5973b384a0f6d4a76fa06ae6343c43f}\label{class_scene_viewer_ae5973b384a0f6d4a76fa06ae6343c43f}} 
\index{SceneViewer@{SceneViewer}!GLInvalidateRect@{GLInvalidateRect}}
\index{GLInvalidateRect@{GLInvalidateRect}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{GLInvalidateRect()}{GLInvalidateRect()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::\+GLInvalidate\+Rect (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Same as \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidate\+All()}}, 

Implements \mbox{\hyperlink{class_t_tool_1_1_viewer_a3ca66eeb722bff291bc1d0d5463a706b}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02278                                                      \{}
\DoxyCodeLine{02279   \textcolor{comment}{// in case that GLInvalidateAll is called just before coming here,}}
\DoxyCodeLine{02280   \textcolor{comment}{// ignore the clip rect and refresh entire viewer}}
\DoxyCodeLine{02281   \textcolor{keywordflow}{if} (m\_clipRect == InvalidateAllRect)}
\DoxyCodeLine{02282     \textcolor{keywordflow}{return};}
\DoxyCodeLine{02283   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}())}
\DoxyCodeLine{02284     m\_clipRect = InvalidateAllRect;}
\DoxyCodeLine{02285   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02286     m\_clipRect += rect;}
\DoxyCodeLine{02287     \textcolor{keywordflow}{if} (!m\_guidedDrawingBBox.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \{}
\DoxyCodeLine{02288       \mbox{\hyperlink{class_t_tool}{TTool}} *tool         = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{02289       \mbox{\hyperlink{class_t_point_t}{TPointD}} topLeft     = tool-\/>getMatrix() * m\_guidedDrawingBBox.getP00();}
\DoxyCodeLine{02290       \mbox{\hyperlink{class_t_point_t}{TPointD}} bottomRight = tool-\/>getMatrix() * m\_guidedDrawingBBox.getP11();}
\DoxyCodeLine{02291       m\_clipRect += \mbox{\hyperlink{class_t_rect_t}{TRectD}}(topLeft, bottomRight);}
\DoxyCodeLine{02292     \}}
\DoxyCodeLine{02293   \}}
\DoxyCodeLine{02294   update();}
\DoxyCodeLine{02295   \textcolor{keywordflow}{if} (m\_vRuler) m\_vRuler-\/>update();}
\DoxyCodeLine{02296   \textcolor{keywordflow}{if} (m\_hRuler) m\_hRuler-\/>update();}
\DoxyCodeLine{02297   m\_guidedDrawingBBox.empty();}
\DoxyCodeLine{02298 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00126}{TApp\+::get\+Current\+Tool()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, and \mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{TRect\+T$<$ T $>$\+::is\+Empty()}}.

\mbox{\Hypertarget{class_scene_viewer_a713eb48131c80efb39184a049c28e16d}\label{class_scene_viewer_a713eb48131c80efb39184a049c28e16d}} 
\index{SceneViewer@{SceneViewer}!hideEvent@{hideEvent}}
\index{hideEvent@{hideEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{hideEvent()}{hideEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::hide\+Event (\begin{DoxyParamCaption}\item[{QHide\+Event $\ast$}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01104                                         \{}
\DoxyCodeLine{01105   \textcolor{comment}{// Se il viewer e' hide e il preview e' attivo rimuovo il listner dal preview}}
\DoxyCodeLine{01106   \textcolor{keywordflow}{if} (m\_previewMode != NO\_PREVIEW)}
\DoxyCodeLine{01107     \mbox{\hyperlink{class_previewer_a5eb765b66490a3d99d432f90864bfacd}{Previewer::instance}}(m\_previewMode == SUBCAMERA\_PREVIEW)}
\DoxyCodeLine{01108         -\/>removeListener(\textcolor{keyword}{this});}
\DoxyCodeLine{01109 }
\DoxyCodeLine{01110   \mbox{\hyperlink{class_t_app}{TApp}} *app = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{01111 }
\DoxyCodeLine{01112   \mbox{\hyperlink{class_t_scene_handle}{TSceneHandle}} *sceneHandle = app-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}();}
\DoxyCodeLine{01113   \textcolor{keywordflow}{if} (sceneHandle) sceneHandle-\/>disconnect(\textcolor{keyword}{this});}
\DoxyCodeLine{01114 }
\DoxyCodeLine{01115   \mbox{\hyperlink{class_t_frame_handle}{TFrameHandle}} *frameHandle = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}();}
\DoxyCodeLine{01116   \textcolor{keywordflow}{if} (frameHandle) frameHandle-\/>disconnect(\textcolor{keyword}{this});}
\DoxyCodeLine{01117 }
\DoxyCodeLine{01118   \mbox{\hyperlink{class_t_palette_handle}{TPaletteHandle}} *paletteHandle =}
\DoxyCodeLine{01119       app-\/>getPaletteController()-\/>getCurrentLevelPalette();}
\DoxyCodeLine{01120   \textcolor{keywordflow}{if} (paletteHandle) paletteHandle-\/>disconnect(\textcolor{keyword}{this});}
\DoxyCodeLine{01121 }
\DoxyCodeLine{01122   \mbox{\hyperlink{class_t_object_handle}{TObjectHandle}} *objectHandle = app-\/>\mbox{\hyperlink{class_t_app_a0d91c122eec2b756b7c4780014e49f9e}{getCurrentObject}}();}
\DoxyCodeLine{01123   \textcolor{keywordflow}{if} (objectHandle) objectHandle-\/>disconnect(\textcolor{keyword}{this});}
\DoxyCodeLine{01124 }
\DoxyCodeLine{01125   \mbox{\hyperlink{class_t_onion_skin_mask_handle}{TOnionSkinMaskHandle}} *onionHandle = app-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}();}
\DoxyCodeLine{01126   \textcolor{keywordflow}{if} (onionHandle) onionHandle-\/>disconnect(\textcolor{keyword}{this});}
\DoxyCodeLine{01127 }
\DoxyCodeLine{01128   \mbox{\hyperlink{class_t_xsh_level_handle}{TXshLevelHandle}} *levelHandle = app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}();}
\DoxyCodeLine{01129   \textcolor{keywordflow}{if} (levelHandle) levelHandle-\/>disconnect(\textcolor{keyword}{this});}
\DoxyCodeLine{01130 }
\DoxyCodeLine{01131   \mbox{\hyperlink{class_t_xsheet_handle}{TXsheetHandle}} *xsheetHandle = app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}();}
\DoxyCodeLine{01132   \textcolor{keywordflow}{if} (xsheetHandle) xsheetHandle-\/>disconnect(\textcolor{keyword}{this});}
\DoxyCodeLine{01133 }
\DoxyCodeLine{01134   \mbox{\hyperlink{class_tool_handle}{ToolHandle}} *toolHandle = app-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}();}
\DoxyCodeLine{01135   \textcolor{keywordflow}{if} (toolHandle) toolHandle-\/>disconnect(\textcolor{keyword}{this});}
\DoxyCodeLine{01136 }
\DoxyCodeLine{01137   disconnect(app, SIGNAL(tabletLeft()), \textcolor{keyword}{this}, SLOT(resetTabletStatus()));}
\DoxyCodeLine{01138 }
\DoxyCodeLine{01139 \textcolor{preprocessor}{\#if defined(x64)}}
\DoxyCodeLine{01140   \textcolor{keywordflow}{if} (m\_stopMotion) \{}
\DoxyCodeLine{01141     disconnect(m\_stopMotion, SIGNAL(newImageReady()), \textcolor{keyword}{this},}
\DoxyCodeLine{01142                SLOT(onNewStopMotionImageReady()));}
\DoxyCodeLine{01143     disconnect(m\_stopMotion, SIGNAL(liveViewStopped()), \textcolor{keyword}{this},}
\DoxyCodeLine{01144                SLOT(onStopMotionLiveViewStopped()));}
\DoxyCodeLine{01145   \}}
\DoxyCodeLine{01146 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01147 }
\DoxyCodeLine{01148   \textcolor{comment}{// hide locator}}
\DoxyCodeLine{01149   \textcolor{keywordflow}{if} (m\_locator \&\& m\_locator-\/>isVisible()) m\_locator-\/>hide();}
\DoxyCodeLine{01150 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a877c189291e741328d2162a37550bde6}\label{class_scene_viewer_a877c189291e741328d2162a37550bde6}} 
\index{SceneViewer@{SceneViewer}!initializeGL@{initializeGL}}
\index{initializeGL@{initializeGL}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{initializeGL()}{initializeGL()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::initialize\+GL (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01233                                \{}
\DoxyCodeLine{01234   initializeOpenGLFunctions();}
\DoxyCodeLine{01235 }
\DoxyCodeLine{01236   registerContext();}
\DoxyCodeLine{01237 }
\DoxyCodeLine{01238   \textcolor{comment}{// to be computed once through the software}}
\DoxyCodeLine{01239   \textcolor{keywordflow}{if} (m\_lutCalibrator \&\& !m\_lutCalibrator-\/>isInitialized()) \{}
\DoxyCodeLine{01240     m\_lutCalibrator-\/>initialize();}
\DoxyCodeLine{01241     connect(context(), SIGNAL(aboutToBeDestroyed()), \textcolor{keyword}{this},}
\DoxyCodeLine{01242             SLOT(onContextAboutToBeDestroyed()));}
\DoxyCodeLine{01243   \}}
\DoxyCodeLine{01244 }
\DoxyCodeLine{01245   \textcolor{comment}{// glClearColor(1.0,1.0,1.0,1);}}
\DoxyCodeLine{01246   glClear(GL\_COLOR\_BUFFER\_BIT);}
\DoxyCodeLine{01247 }
\DoxyCodeLine{01248   \textcolor{keywordflow}{if} (m\_firstInitialized)}
\DoxyCodeLine{01249     m\_firstInitialized = \textcolor{keyword}{false};}
\DoxyCodeLine{01250   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01251     resizeGL(width(), height());}
\DoxyCodeLine{01252     update();}
\DoxyCodeLine{01253   \}}
\DoxyCodeLine{01254   \textcolor{comment}{// re-\/computing the display list for the table}}
\DoxyCodeLine{01255   m\_tableDLId = -\/1;}
\DoxyCodeLine{01256 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a39991122d25bf859b7eefd06ed1b4aae}\label{class_scene_viewer_a39991122d25bf859b7eefd06ed1b4aae}} 
\index{SceneViewer@{SceneViewer}!inputMethodEvent@{inputMethodEvent}}
\index{inputMethodEvent@{inputMethodEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{inputMethodEvent()}{inputMethodEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::input\+Method\+Event (\begin{DoxyParamCaption}\item[{QInput\+Method\+Event $\ast$}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01697                                                        \{}
\DoxyCodeLine{01698   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{01699   \textcolor{keywordflow}{if} (tool \&\& tool-\/>isEnabled()) \{}
\DoxyCodeLine{01700     tool-\/>onInputText(e-\/>preeditString().toStdWString(),}
\DoxyCodeLine{01701                       e-\/>commitString().toStdWString(), e-\/>replacementStart(),}
\DoxyCodeLine{01702                       e-\/>replacementLength());}
\DoxyCodeLine{01703   \}}
\DoxyCodeLine{01704 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}\label{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}} 
\index{SceneViewer@{SceneViewer}!invalidateAll@{invalidateAll}}
\index{invalidateAll@{invalidateAll}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{invalidateAll()}{invalidateAll()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::invalidate\+All (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Redraws the entire viewer, passing through Qt\textquotesingle{}s event system 

Implements \mbox{\hyperlink{class_t_tool_1_1_viewer_a3c78921157249891a6ec73eb94501d2a}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02252                                 \{}
\DoxyCodeLine{02253   m\_clipRect = InvalidateAllRect;}
\DoxyCodeLine{02254   update();}
\DoxyCodeLine{02255   \textcolor{keywordflow}{if} (m\_vRuler) m\_vRuler-\/>update();}
\DoxyCodeLine{02256   \textcolor{keywordflow}{if} (m\_hRuler) m\_hRuler-\/>update();}
\DoxyCodeLine{02257 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a51e41da45c96d39493ac2753b89d5407}\label{class_scene_viewer_a51e41da45c96d39493ac2753b89d5407}} 
\index{SceneViewer@{SceneViewer}!invalidateToolStatus@{invalidateToolStatus}}
\index{invalidateToolStatus@{invalidateToolStatus}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{invalidateToolStatus()}{invalidateToolStatus()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::invalidate\+Tool\+Status (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

for a specific clipping rect Forces the viewer to update the perceived status of tools 

Implements \mbox{\hyperlink{class_t_tool_1_1_viewer_ac9783019e219f37d1c4bc038302e3485}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03234                                        \{}
\DoxyCodeLine{03235   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{03236   \textcolor{keywordflow}{if} (tool) \{}
\DoxyCodeLine{03237     m\_toolDisableReason = tool-\/>\mbox{\hyperlink{class_t_tool_a3638517d39dffe6abec0a4e1bcf990d3}{updateEnabled}}();}
\DoxyCodeLine{03238     \textcolor{keywordflow}{if} (tool-\/>isEnabled()) \{}
\DoxyCodeLine{03239       setToolCursor(\textcolor{keyword}{this}, tool-\/>\mbox{\hyperlink{class_t_tool_a1768a57b8b6d1480618fd923fad15f1d}{getCursorId}}());}
\DoxyCodeLine{03240       tool-\/>setViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{03241       tool-\/>\mbox{\hyperlink{class_t_tool_a1a5f380464a6b36947212e2f8d5b314c}{updateMatrix}}();}
\DoxyCodeLine{03242     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{03243       setCursor(Qt::ForbiddenCursor);}
\DoxyCodeLine{03244   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{03245     setCursor(Qt::ForbiddenCursor);}
\DoxyCodeLine{03246 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00126}{TApp\+::get\+Current\+Tool()}}, \mbox{\hyperlink{l00438}{TTool\+::get\+Cursor\+Id()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, \mbox{\hyperlink{l00828}{TTool\+::update\+Enabled()}}, and \mbox{\hyperlink{l00801}{TTool\+::update\+Matrix()}}.



Referenced by \mbox{\hyperlink{l02858}{on\+Level\+Switched()}}.

\mbox{\Hypertarget{class_scene_viewer_a32224c92271386a53b52fdfa99cbce82}\label{class_scene_viewer_a32224c92271386a53b52fdfa99cbce82}} 
\index{SceneViewer@{SceneViewer}!is3DView@{is3DView}}
\index{is3DView@{is3DView}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{is3DView()}{is3DView()}}
{\footnotesize\ttfamily bool Scene\+Viewer\+::is3\+DView (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02245                                  \{}
\DoxyCodeLine{02246   \textcolor{keywordtype}{bool} isCameraTest = \mbox{\hyperlink{class_camera_test_check_adc1033b93dea95f49db36d8fb668e16d}{CameraTestCheck::instance}}()-\/>isEnabled();}
\DoxyCodeLine{02247   \textcolor{keywordflow}{return} (m\_referenceMode == CAMERA3D\_REFERENCE \&\& !isCameraTest);}
\DoxyCodeLine{02248 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a3b6c96570548ac253cacccd977820c5c}\label{class_scene_viewer_a3b6c96570548ac253cacccd977820c5c}} 
\index{SceneViewer@{SceneViewer}!isEditPreviewSubcamera@{isEditPreviewSubcamera}}
\index{isEditPreviewSubcamera@{isEditPreviewSubcamera}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{isEditPreviewSubcamera()}{isEditPreviewSubcamera()}}
{\footnotesize\ttfamily bool Scene\+Viewer\+::is\+Edit\+Preview\+Subcamera (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00267 \{ \textcolor{keywordflow}{return} m\_editPreviewSubCamera; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a951018a0f767f1b40094e839332d896a}\label{class_scene_viewer_a951018a0f767f1b40094e839332d896a}} 
\index{SceneViewer@{SceneViewer}!isPreviewEnabled@{isPreviewEnabled}}
\index{isPreviewEnabled@{isPreviewEnabled}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{isPreviewEnabled()}{isPreviewEnabled()}}
{\footnotesize\ttfamily bool Scene\+Viewer\+::is\+Preview\+Enabled (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00221 \{ \textcolor{keywordflow}{return} m\_previewMode != NO\_PREVIEW; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a0075f82c0dcd4bdcad064d7ec937f7bf}\label{class_scene_viewer_a0075f82c0dcd4bdcad064d7ec937f7bf}} 
\index{SceneViewer@{SceneViewer}!keyPressEvent@{keyPressEvent}}
\index{keyPressEvent@{keyPressEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{keyPressEvent()}{keyPressEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::key\+Press\+Event (\begin{DoxyParamCaption}\item[{QKey\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01376                                                 \{}
\DoxyCodeLine{01377   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01378   \textcolor{keywordtype}{int} key = \textcolor{keyword}{event}-\/>key();}
\DoxyCodeLine{01379 }
\DoxyCodeLine{01380 \textcolor{preprocessor}{\#ifdef WITH\_CANON}}
\DoxyCodeLine{01381   \textcolor{keywordflow}{if} ((m\_stopMotion-\/>m\_canon-\/>m\_pickLiveViewZoom ||}
\DoxyCodeLine{01382        m\_stopMotion-\/>m\_canon-\/>m\_zooming) \&\&}
\DoxyCodeLine{01383       (key == Qt::Key\_Left || key == Qt::Key\_Right || key == Qt::Key\_Up ||}
\DoxyCodeLine{01384        key == Qt::Key\_Down || key == Qt::Key\_2 || key == Qt::Key\_4 ||}
\DoxyCodeLine{01385        key == Qt::Key\_6 || key == Qt::Key\_8)) \{}
\DoxyCodeLine{01386     \textcolor{keywordflow}{if} (m\_stopMotion-\/>m\_canon-\/>m\_liveViewZoomReadyToPick == \textcolor{keyword}{true}) \{}
\DoxyCodeLine{01387       \textcolor{keywordflow}{if} (key == Qt::Key\_Left || key == Qt::Key\_4) \{}
\DoxyCodeLine{01388         m\_stopMotion-\/>m\_canon-\/>m\_liveViewZoomPickPoint.x -\/= 10;}
\DoxyCodeLine{01389       \}}
\DoxyCodeLine{01390       \textcolor{keywordflow}{if} (key == Qt::Key\_Right || key == Qt::Key\_6) \{}
\DoxyCodeLine{01391         m\_stopMotion-\/>m\_canon-\/>m\_liveViewZoomPickPoint.x += 10;}
\DoxyCodeLine{01392       \}}
\DoxyCodeLine{01393       \textcolor{keywordflow}{if} (key == Qt::Key\_Up || key == Qt::Key\_8) \{}
\DoxyCodeLine{01394         m\_stopMotion-\/>m\_canon-\/>m\_liveViewZoomPickPoint.y += 10;}
\DoxyCodeLine{01395       \}}
\DoxyCodeLine{01396       \textcolor{keywordflow}{if} (key == Qt::Key\_Down || key == Qt::Key\_2) \{}
\DoxyCodeLine{01397         m\_stopMotion-\/>m\_canon-\/>m\_liveViewZoomPickPoint.y -\/= 10;}
\DoxyCodeLine{01398       \}}
\DoxyCodeLine{01399       \textcolor{keywordflow}{if} (m\_stopMotion-\/>m\_canon-\/>m\_zooming) \{}
\DoxyCodeLine{01400         m\_stopMotion-\/>m\_canon-\/>setZoomPoint();}
\DoxyCodeLine{01401       \}}
\DoxyCodeLine{01402     \}}
\DoxyCodeLine{01403     m\_stopMotion-\/>m\_canon-\/>calculateZoomPoint();}
\DoxyCodeLine{01404     \textcolor{keyword}{event}-\/>accept();}
\DoxyCodeLine{01405     \textcolor{keywordflow}{return};}
\DoxyCodeLine{01406   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_stopMotion-\/>m\_canon-\/>m\_pickLiveViewZoom \&\&}
\DoxyCodeLine{01407              (key == Qt::Key\_Escape || key == Qt::Key\_Enter ||}
\DoxyCodeLine{01408               key == Qt::Key\_Return)) \{}
\DoxyCodeLine{01409     m\_stopMotion-\/>m\_canon-\/>toggleZoomPicking();}
\DoxyCodeLine{01410     \textcolor{keyword}{event}-\/>accept();}
\DoxyCodeLine{01411     \textcolor{keywordflow}{return};}
\DoxyCodeLine{01412   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01413 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01414 \textcolor{preprocessor}{\#if defined(x64)}}
\DoxyCodeLine{01415       \textcolor{keywordflow}{if} (m\_stopMotion-\/>m\_liveViewStatus == 2 \&\&}
\DoxyCodeLine{01416           (key == Qt::Key\_Enter || key == Qt::Key\_Return)) \{}
\DoxyCodeLine{01417     m\_stopMotion-\/>captureImage();}
\DoxyCodeLine{01418     \textcolor{keyword}{event}-\/>accept();}
\DoxyCodeLine{01419     \textcolor{keywordflow}{return};}
\DoxyCodeLine{01420   \}}
\DoxyCodeLine{01421 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01422 }
\DoxyCodeLine{01423   \textcolor{comment}{// resolving priority and tool-\/specific key events in this lambda}}
\DoxyCodeLine{01424   \textcolor{keyword}{auto} ret = [\&]() -\/> \textcolor{keywordtype}{bool} \{}
\DoxyCodeLine{01425     \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{01426     \textcolor{keywordflow}{if} (!tool) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{01427 }
\DoxyCodeLine{01428     \textcolor{keywordtype}{bool} isTextToolActive = tool-\/>getName() == T\_Type \&\& tool-\/>\mbox{\hyperlink{class_t_tool_a6225a72c8bc7ad1ad6eff6b81ac6b0a6}{isActive}}();}
\DoxyCodeLine{01429 }
\DoxyCodeLine{01430     \textcolor{keywordflow}{if} (!isTextToolActive) \{}
\DoxyCodeLine{01431       \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_viewer_zoomer}{ViewerZoomer}}(\textcolor{keyword}{this}).exec(event)) \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01432       \textcolor{keywordflow}{if} (SceneViewerShortcutReceiver(\textcolor{keyword}{this}).exec(event)) \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01433       \textcolor{comment}{// If this object is child of Viewer or ComboViewer}}
\DoxyCodeLine{01434       \textcolor{comment}{// (m\_isStyleShortcutSelective = true),}}
\DoxyCodeLine{01435       \textcolor{comment}{// then consider about shortcut for the current style selection.}}
\DoxyCodeLine{01436       \textcolor{keywordflow}{if} (m\_isStyleShortcutSwitchable \&\&}
\DoxyCodeLine{01437           Preferences::instance()-\/>isUseNumpadForSwitchingStylesEnabled() \&\&}
\DoxyCodeLine{01438           (event-\/>modifiers() == Qt::NoModifier ||}
\DoxyCodeLine{01439            event-\/>modifiers() == Qt::ShiftModifier ||}
\DoxyCodeLine{01440            event-\/>modifiers() == Qt::KeypadModifier) \&\&}
\DoxyCodeLine{01441           ((Qt::Key\_0 <= key \&\& key <= Qt::Key\_9) || key == Qt::Key\_Tab ||}
\DoxyCodeLine{01442            key == Qt::Key\_Backtab)) \{}
\DoxyCodeLine{01443         \textcolor{comment}{// When the viewer is in full screen mode, directly call the style}}
\DoxyCodeLine{01444         \textcolor{comment}{// shortcut function since the viewer is retrieved from the parent}}
\DoxyCodeLine{01445         \textcolor{comment}{// panel.}}
\DoxyCodeLine{01446         \textcolor{keywordflow}{if} (parentWidget() \&\&}
\DoxyCodeLine{01447             parentWidget()-\/>windowState() \& Qt::WindowFullScreen) \{}
\DoxyCodeLine{01448           StyleShortcutSwitchablePanel::onKeyPress(event);}
\DoxyCodeLine{01449           \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01450         \}}
\DoxyCodeLine{01451 }
\DoxyCodeLine{01452         \textcolor{keyword}{event}-\/>ignore();}
\DoxyCodeLine{01453         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01454       \}}
\DoxyCodeLine{01455       \textcolor{comment}{// pressing F1, F2 or F3 key will flip between corresponding ghost}}
\DoxyCodeLine{01456       \textcolor{keywordflow}{if} (CommandManager::instance()-\/>getAction(MI\_ShiftTrace)-\/>isChecked() \&\&}
\DoxyCodeLine{01457           (Qt::Key\_F1 <= key \&\& key <= Qt::Key\_F3)) \{}
\DoxyCodeLine{01458         \mbox{\hyperlink{class_onion_skin_mask}{OnionSkinMask}} osm =}
\DoxyCodeLine{01459             \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>getOnionSkinMask();}
\DoxyCodeLine{01460         \textcolor{keywordflow}{if} (osm.getGhostFlipKey() != key) \{}
\DoxyCodeLine{01461           osm.appendGhostFlipKey(key);}
\DoxyCodeLine{01462           \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>setOnionSkinMask(osm);}
\DoxyCodeLine{01463           \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>notifyOnionSkinMaskChanged();}
\DoxyCodeLine{01464         \}}
\DoxyCodeLine{01465         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01466       \}}
\DoxyCodeLine{01467     \}}
\DoxyCodeLine{01468 }
\DoxyCodeLine{01469     \textcolor{keywordflow}{if} (!tool-\/>isEnabled()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{01470 }
\DoxyCodeLine{01471     tool-\/>setViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{01472 }
\DoxyCodeLine{01473     \textcolor{keywordflow}{if} (key == Qt::Key\_Shift || key == Qt::Key\_Control || key == Qt::Key\_Alt ||}
\DoxyCodeLine{01474         key == Qt::Key\_AltGr) \{}
\DoxyCodeLine{01475       \textcolor{comment}{// quando l'utente preme shift/ctrl ecc. alcuni tool (es. pinch) devono}}
\DoxyCodeLine{01476       \textcolor{comment}{// cambiare subito la forma del cursore, senza aspettare il prossimo move}}
\DoxyCodeLine{01477       \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} toonzEvent;}
\DoxyCodeLine{01478       initToonzEvent(toonzEvent, event);}
\DoxyCodeLine{01479       toonzEvent.\mbox{\hyperlink{class_t_mouse_event_a05a3f2378eb2179d121e2e46766916de}{m\_pos}} = \mbox{\hyperlink{class_t_point_t}{TPointD}}(m\_lastMousePos.x(),}
\DoxyCodeLine{01480                                  (\textcolor{keywordtype}{double})(height() -\/ 1) -\/ m\_lastMousePos.y());}
\DoxyCodeLine{01481 }
\DoxyCodeLine{01482       \mbox{\hyperlink{class_t_point_t}{TPointD}} pos = tool-\/>getMatrix().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * winToWorld(m\_lastMousePos);}
\DoxyCodeLine{01483 }
\DoxyCodeLine{01484       \mbox{\hyperlink{class_t_object_handle}{TObjectHandle}} *objHandle = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a0d91c122eec2b756b7c4780014e49f9e}{getCurrentObject}}();}
\DoxyCodeLine{01485       \textcolor{keywordflow}{if} (tool-\/>getToolType() \& TTool::LevelTool \&\& !objHandle-\/>isSpline()) \{}
\DoxyCodeLine{01486         pos.x /= m\_dpiScale.x;}
\DoxyCodeLine{01487         pos.y /= m\_dpiScale.y;}
\DoxyCodeLine{01488       \}}
\DoxyCodeLine{01489 }
\DoxyCodeLine{01490       tool-\/>mouseMove(pos, toonzEvent);}
\DoxyCodeLine{01491       setToolCursor(\textcolor{keyword}{this}, tool-\/>\mbox{\hyperlink{class_t_tool_a1768a57b8b6d1480618fd923fad15f1d}{getCursorId}}());}
\DoxyCodeLine{01492     \}}
\DoxyCodeLine{01493 }
\DoxyCodeLine{01494     \textcolor{keywordflow}{if} (key == Qt::Key\_Menu || key == Qt::Key\_Meta) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{01495 }
\DoxyCodeLine{01496     \textcolor{keywordflow}{return} tool-\/>keyDown(event);}
\DoxyCodeLine{01497   \}();}
\DoxyCodeLine{01498 }
\DoxyCodeLine{01499   \textcolor{keywordflow}{if} (!ret) \{}
\DoxyCodeLine{01500     \textcolor{keywordflow}{if} (changeFrameSkippingHolds(event)) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01501 }
\DoxyCodeLine{01502     \mbox{\hyperlink{class_t_frame_handle}{TFrameHandle}} *fh = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}();}
\DoxyCodeLine{01503     \textcolor{keywordtype}{int} origFrame    = fh-\/>getFrame();}
\DoxyCodeLine{01504 }
\DoxyCodeLine{01505     \textcolor{keywordflow}{if} (key == Qt::Key\_Up || key == Qt::Key\_Left)}
\DoxyCodeLine{01506       fh-\/>prevFrame();}
\DoxyCodeLine{01507     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (key == Qt::Key\_Down || key == Qt::Key\_Right) \{}
\DoxyCodeLine{01508       \textcolor{comment}{// If on a level frame pass the frame id after the last frame to allow}}
\DoxyCodeLine{01509       \textcolor{comment}{// creating a new frame with the down arrow key}}
\DoxyCodeLine{01510       \mbox{\hyperlink{class_t_frame_id}{TFrameId}} newId = 0;}
\DoxyCodeLine{01511       \textcolor{keywordflow}{if} (Preferences::instance()-\/>getDownArrowLevelStripNewFrame() \&\&}
\DoxyCodeLine{01512           fh-\/>getFrameType() == TFrameHandle::LevelFrame) \{}
\DoxyCodeLine{01513         \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *level =}
\DoxyCodeLine{01514             \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel()-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{01515         \textcolor{keywordflow}{if} (level) \{}
\DoxyCodeLine{01516           std::vector<TFrameId> fids;}
\DoxyCodeLine{01517           level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_a567daee4ca12a0e92445bcf98a6541f1}{getFids}}(fids);}
\DoxyCodeLine{01518           \textcolor{keywordflow}{if} (!fids.empty()) \{}
\DoxyCodeLine{01519             \textcolor{keywordtype}{int} frameCount = (int)fids.size();}
\DoxyCodeLine{01520             newId          = level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_a07279a40ffad2c6ccc597c0a418f78fb}{index2fid}}(frameCount);}
\DoxyCodeLine{01521           \}}
\DoxyCodeLine{01522         \}}
\DoxyCodeLine{01523       \}}
\DoxyCodeLine{01524       fh-\/>nextFrame(newId);}
\DoxyCodeLine{01525     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (key == Qt::Key\_Home)}
\DoxyCodeLine{01526       fh-\/>firstFrame();}
\DoxyCodeLine{01527     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (key == Qt::Key\_End)}
\DoxyCodeLine{01528       fh-\/>lastFrame();}
\DoxyCodeLine{01529 }
\DoxyCodeLine{01530     \textcolor{comment}{// Use arrow keys to shift the cell selection.}}
\DoxyCodeLine{01531     \textcolor{keywordflow}{if} (Preferences::instance()-\/>isUseArrowKeyToShiftCellSelectionEnabled() \&\&}
\DoxyCodeLine{01532         fh-\/>getFrameType() != TFrameHandle::LevelFrame) \{}
\DoxyCodeLine{01533       \mbox{\hyperlink{class_t_cell_selection}{TCellSelection}} *cellSel =}
\DoxyCodeLine{01534           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_t_cell_selection}{TCellSelection}} *\textcolor{keyword}{>}(TSelection::getCurrent());}
\DoxyCodeLine{01535       \textcolor{keywordflow}{if} (cellSel \&\& !cellSel-\/>isEmpty()) \{}
\DoxyCodeLine{01536         \textcolor{keywordtype}{int} r0, c0, r1, c1;}
\DoxyCodeLine{01537         cellSel-\/>getSelectedCells(r0, c0, r1, c1);}
\DoxyCodeLine{01538         \textcolor{keywordtype}{int} shiftFrame = fh-\/>getFrame() -\/ origFrame;}
\DoxyCodeLine{01539 }
\DoxyCodeLine{01540         cellSel-\/>\mbox{\hyperlink{class_t_cell_selection_ac081c8305a9b9269fbf82eb0c9e06bc3}{selectCells}}(r0 + shiftFrame, c0, r1 + shiftFrame, c1);}
\DoxyCodeLine{01541         \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a6e0ee1978807a89009571ed5ce44323b}{getCurrentSelection}}()-\/>notifySelectionChanged();}
\DoxyCodeLine{01542       \}}
\DoxyCodeLine{01543     \}}
\DoxyCodeLine{01544   \}}
\DoxyCodeLine{01545   update();}
\DoxyCodeLine{01546   \textcolor{comment}{// TODO: devo accettare l'evento?}}
\DoxyCodeLine{01547 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a0c718a9876f69f618e6b20bdc9c48c75}\label{class_scene_viewer_a0c718a9876f69f618e6b20bdc9c48c75}} 
\index{SceneViewer@{SceneViewer}!keyReleaseEvent@{keyReleaseEvent}}
\index{keyReleaseEvent@{keyReleaseEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{keyReleaseEvent()}{keyReleaseEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::key\+Release\+Event (\begin{DoxyParamCaption}\item[{QKey\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01551                                                   \{}
\DoxyCodeLine{01552   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01553 }
\DoxyCodeLine{01554   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{01555   \textcolor{keywordflow}{if} (!tool || !tool-\/>isEnabled()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01556   tool-\/>setViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{01557 }
\DoxyCodeLine{01558   \textcolor{keywordtype}{int} key = \textcolor{keyword}{event}-\/>key();}
\DoxyCodeLine{01559 }
\DoxyCodeLine{01560   \textcolor{keywordflow}{if} (key == Qt::Key\_Shift || key == Qt::Key\_Control || key == Qt::Key\_Alt ||}
\DoxyCodeLine{01561       key == Qt::Key\_AltGr) \{}
\DoxyCodeLine{01562     \textcolor{comment}{// quando l'utente preme shift/ctrl ecc. alcuni tool (es. pinch) devono}}
\DoxyCodeLine{01563     \textcolor{comment}{// cambiare subito la forma del cursore, senza aspettare il prossimo move}}
\DoxyCodeLine{01564     \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} toonzEvent;}
\DoxyCodeLine{01565     initToonzEvent(toonzEvent, event);}
\DoxyCodeLine{01566     toonzEvent.\mbox{\hyperlink{class_t_mouse_event_a05a3f2378eb2179d121e2e46766916de}{m\_pos}} = \mbox{\hyperlink{class_t_point_t}{TPointD}}(m\_lastMousePos.x(),}
\DoxyCodeLine{01567                                (\textcolor{keywordtype}{double})(height() -\/ 1) -\/ m\_lastMousePos.y());}
\DoxyCodeLine{01568 }
\DoxyCodeLine{01569     \mbox{\hyperlink{class_t_point_t}{TPointD}} pos = tool-\/>getMatrix().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * winToWorld(m\_lastMousePos);}
\DoxyCodeLine{01570 }
\DoxyCodeLine{01571     \mbox{\hyperlink{class_t_object_handle}{TObjectHandle}} *objHandle = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a0d91c122eec2b756b7c4780014e49f9e}{getCurrentObject}}();}
\DoxyCodeLine{01572     \textcolor{keywordflow}{if} (tool-\/>getToolType() \& TTool::LevelTool \&\& !objHandle-\/>isSpline()) \{}
\DoxyCodeLine{01573       pos.x /= m\_dpiScale.x;}
\DoxyCodeLine{01574       pos.y /= m\_dpiScale.y;}
\DoxyCodeLine{01575     \}}
\DoxyCodeLine{01576 }
\DoxyCodeLine{01577     tool-\/>mouseMove(pos, toonzEvent);}
\DoxyCodeLine{01578     setToolCursor(\textcolor{keyword}{this}, tool-\/>\mbox{\hyperlink{class_t_tool_a1768a57b8b6d1480618fd923fad15f1d}{getCursorId}}());}
\DoxyCodeLine{01579   \}}
\DoxyCodeLine{01580 }
\DoxyCodeLine{01581   \textcolor{keywordflow}{if} (CommandManager::instance()-\/>getAction(MI\_ShiftTrace)-\/>isChecked() \&\&}
\DoxyCodeLine{01582       (Qt::Key\_F1 <= key \&\& key <= Qt::Key\_F3)) \{}
\DoxyCodeLine{01583     \mbox{\hyperlink{class_onion_skin_mask}{OnionSkinMask}} osm =}
\DoxyCodeLine{01584         \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>getOnionSkinMask();}
\DoxyCodeLine{01585     osm.removeGhostFlipKey(key);}
\DoxyCodeLine{01586     \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>setOnionSkinMask(osm);}
\DoxyCodeLine{01587     \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>notifyOnionSkinMaskChanged();}
\DoxyCodeLine{01588   \}}
\DoxyCodeLine{01589 }
\DoxyCodeLine{01590   \textcolor{keywordflow}{if} (tool-\/>getName() == T\_Type)}
\DoxyCodeLine{01591     \textcolor{keyword}{event}-\/>accept();}
\DoxyCodeLine{01592   \textcolor{keywordflow}{else}}
\DoxyCodeLine{01593     \textcolor{keyword}{event}-\/>ignore();}
\DoxyCodeLine{01594 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ab8133ba061ff2aceb093eb09e925a2c4}\label{class_scene_viewer_ab8133ba061ff2aceb093eb09e925a2c4}} 
\index{SceneViewer@{SceneViewer}!leaveEvent@{leaveEvent}}
\index{leaveEvent@{leaveEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{leaveEvent()}{leaveEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::leave\+Event (\begin{DoxyParamCaption}\item[{QEvent $\ast$}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00416 \{ onLeave(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ac8583e80119b74761b7f2e08378cc05a}\label{class_scene_viewer_ac8583e80119b74761b7f2e08378cc05a}} 
\index{SceneViewer@{SceneViewer}!mouseDoubleClickEvent@{mouseDoubleClickEvent}}
\index{mouseDoubleClickEvent@{mouseDoubleClickEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{mouseDoubleClickEvent()}{mouseDoubleClickEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::mouse\+Double\+Click\+Event (\begin{DoxyParamCaption}\item[{QMouse\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01598                                                           \{}
\DoxyCodeLine{01599   \textcolor{keywordflow}{if} (m\_gestureActive) \{}
\DoxyCodeLine{01600     fitToCamera();}
\DoxyCodeLine{01601     m\_gestureActive = \textcolor{keyword}{false};}
\DoxyCodeLine{01602     \textcolor{keywordflow}{return};}
\DoxyCodeLine{01603   \}}
\DoxyCodeLine{01604   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01605 }
\DoxyCodeLine{01606   \textcolor{keywordtype}{int} frame = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{01607   \textcolor{keywordflow}{if} (frame == -\/1) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01608 }
\DoxyCodeLine{01609   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{01610   \textcolor{keywordflow}{if} (!tool || !tool-\/>isEnabled()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01611   \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} toonzEvent;}
\DoxyCodeLine{01612   initToonzEvent(toonzEvent, event, height(), 1.0, getDevPixRatio());}
\DoxyCodeLine{01613   \mbox{\hyperlink{class_t_point_t}{TPointD}} pos =}
\DoxyCodeLine{01614       tool-\/>getMatrix().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * winToWorld(event-\/>pos() * getDevPixRatio());}
\DoxyCodeLine{01615   \mbox{\hyperlink{class_t_object_handle}{TObjectHandle}} *objHandle = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a0d91c122eec2b756b7c4780014e49f9e}{getCurrentObject}}();}
\DoxyCodeLine{01616   \textcolor{keywordflow}{if} (tool-\/>getToolType() \& TTool::LevelTool \&\& !objHandle-\/>isSpline()) \{}
\DoxyCodeLine{01617     pos.x /= m\_dpiScale.x;}
\DoxyCodeLine{01618     pos.y /= m\_dpiScale.y;}
\DoxyCodeLine{01619   \}}
\DoxyCodeLine{01620 }
\DoxyCodeLine{01621   \textcolor{keywordflow}{if} (event-\/>button() == Qt::LeftButton)}
\DoxyCodeLine{01622     tool-\/>leftButtonDoubleClick(pos, toonzEvent);}
\DoxyCodeLine{01623 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a65b09e0b6928385784425398c9c4b978}\label{class_scene_viewer_a65b09e0b6928385784425398c9c4b978}} 
\index{SceneViewer@{SceneViewer}!mouseMoveEvent@{mouseMoveEvent}}
\index{mouseMoveEvent@{mouseMoveEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{mouseMoveEvent()}{mouseMoveEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::mouse\+Move\+Event (\begin{DoxyParamCaption}\item[{QMouse\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00486                                                    \{}
\DoxyCodeLine{00487   \textcolor{comment}{// if this is called just after tabletEvent, skip the execution}}
\DoxyCodeLine{00488   \textcolor{keywordflow}{if} (m\_tabletEvent) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00489   \textcolor{comment}{// and touchscreens but not touchpads...}}
\DoxyCodeLine{00490   \textcolor{keywordflow}{if} (m\_gestureActive \&\& m\_touchDevice == QTouchDevice::TouchScreen) \{}
\DoxyCodeLine{00491     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00492   \}}
\DoxyCodeLine{00493   \textcolor{comment}{// there are three cases to come here :}}
\DoxyCodeLine{00494   \textcolor{comment}{// 1. on mouse is moved (no tablet is used)}}
\DoxyCodeLine{00495   \textcolor{comment}{// 2. on tablet is moved, with middle or right button is pressed}}
\DoxyCodeLine{00496   \textcolor{comment}{// 3. on tablet is moved, BUT tabletEvent was not called}}
\DoxyCodeLine{00497   \textcolor{comment}{// 4. on tablet is moved without pen touching (i.e. floating move)}}
\DoxyCodeLine{00498   \textcolor{comment}{// the case 3 sometimes occurs on OSX. (reporteed in QTBUG-\/26532 for Qt4, but}}
\DoxyCodeLine{00499   \textcolor{comment}{// not confirmed in Qt5)}}
\DoxyCodeLine{00500   \textcolor{comment}{// the case 4 can be removed once start using Qt5.9 and call}}
\DoxyCodeLine{00501   \textcolor{comment}{// setTabletTracking(true).}}
\DoxyCodeLine{00502 }
\DoxyCodeLine{00503   \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} mouseEvent;}
\DoxyCodeLine{00504   initToonzEvent(mouseEvent, event, height(), 1.0, getDevPixRatio());}
\DoxyCodeLine{00505   onMove(mouseEvent);}
\DoxyCodeLine{00506 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ae4fb14b4bbe05a40d312fb386cad6018}\label{class_scene_viewer_ae4fb14b4bbe05a40d312fb386cad6018}} 
\index{SceneViewer@{SceneViewer}!mousePressEvent@{mousePressEvent}}
\index{mousePressEvent@{mousePressEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{mousePressEvent()}{mousePressEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::mouse\+Press\+Event (\begin{DoxyParamCaption}\item[{QMouse\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00671                                                     \{}
\DoxyCodeLine{00672   \textcolor{comment}{// source can be useful for detecting touch vs mouse,}}
\DoxyCodeLine{00673   \textcolor{comment}{// but has reports of being unreliable on mac}}
\DoxyCodeLine{00674   \textcolor{comment}{// so m\_gestureActive is the marker for rejecting touch events}}
\DoxyCodeLine{00675   \textcolor{keywordtype}{int} source = \textcolor{keyword}{event}-\/>source();}
\DoxyCodeLine{00676   \textcolor{comment}{// if this is called just after tabletEvent, skip the execution}}
\DoxyCodeLine{00677   \textcolor{keywordflow}{if} (m\_tabletEvent) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00678   \textcolor{comment}{// and touchscreens but not touchpads...}}
\DoxyCodeLine{00679   \textcolor{keywordflow}{if} (m\_gestureActive \&\& m\_touchDevice == QTouchDevice::TouchScreen) \{}
\DoxyCodeLine{00680     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00681   \}}
\DoxyCodeLine{00682   \textcolor{comment}{// For now OSX has a critical problem that mousePressEvent is called just}}
\DoxyCodeLine{00683   \textcolor{comment}{// after releasing the stylus, which causes the irregular stroke while}}
\DoxyCodeLine{00684   \textcolor{comment}{// float-\/moving.}}
\DoxyCodeLine{00685   \textcolor{comment}{// In such case resetTabletStatus() will be called on}}
\DoxyCodeLine{00686   \textcolor{comment}{// QEvent::TabletLeaveProximity}}
\DoxyCodeLine{00687   \textcolor{comment}{// and will cancel the onPress operation called here.}}
\DoxyCodeLine{00688 }
\DoxyCodeLine{00689   \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} mouseEvent;}
\DoxyCodeLine{00690   m\_mouseState = Touched;}
\DoxyCodeLine{00691   initToonzEvent(mouseEvent, event, height(), 1.0, getDevPixRatio());}
\DoxyCodeLine{00692   onPress(mouseEvent);}
\DoxyCodeLine{00693 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a20d80b32173efe5203eacf2544bb3800}\label{class_scene_viewer_a20d80b32173efe5203eacf2544bb3800}} 
\index{SceneViewer@{SceneViewer}!mouseReleaseEvent@{mouseReleaseEvent}}
\index{mouseReleaseEvent@{mouseReleaseEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{mouseReleaseEvent()}{mouseReleaseEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::mouse\+Release\+Event (\begin{DoxyParamCaption}\item[{QMouse\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00812                                                       \{}
\DoxyCodeLine{00813   \textcolor{comment}{// if this is called just after tabletEvent, skip the execution}}
\DoxyCodeLine{00814   \textcolor{keywordflow}{if} (m\_tabletEvent) \{}
\DoxyCodeLine{00815     \textcolor{comment}{// mouseRelease should not clear flag if we are starting or in middle of}}
\DoxyCodeLine{00816     \textcolor{comment}{// stroke}}
\DoxyCodeLine{00817     \textcolor{comment}{// initiated by tableEvent. All other cases, it's ok to clear flag}}
\DoxyCodeLine{00818     \textcolor{keywordflow}{if} (m\_tabletState == Released || m\_tabletState == None)}
\DoxyCodeLine{00819       m\_tabletEvent = \textcolor{keyword}{false};}
\DoxyCodeLine{00820     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00821   \}}
\DoxyCodeLine{00822   \textcolor{comment}{// for touchscreens but not touchpads...}}
\DoxyCodeLine{00823   \textcolor{keywordflow}{if} (m\_gestureActive \&\& m\_touchDevice == QTouchDevice::TouchScreen) \{}
\DoxyCodeLine{00824     m\_gestureActive = \textcolor{keyword}{false};}
\DoxyCodeLine{00825     m\_rotating      = \textcolor{keyword}{false};}
\DoxyCodeLine{00826     m\_zooming       = \textcolor{keyword}{false};}
\DoxyCodeLine{00827     m\_panning       = \textcolor{keyword}{false};}
\DoxyCodeLine{00828     m\_scaleFactor   = 0.0;}
\DoxyCodeLine{00829     m\_rotationDelta = 0.0;}
\DoxyCodeLine{00830     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00831   \}}
\DoxyCodeLine{00832 }
\DoxyCodeLine{00833   \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} mouseEvent;}
\DoxyCodeLine{00834   \textcolor{keywordflow}{if} (m\_mouseState != None) m\_mouseState = Released;}
\DoxyCodeLine{00835   initToonzEvent(mouseEvent, event, height(), 1.0, getDevPixRatio());}
\DoxyCodeLine{00836   onRelease(mouseEvent);}
\DoxyCodeLine{00837 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a1f9f1e732b1f8df97c86b88d0a3d563f}\label{class_scene_viewer_a1f9f1e732b1f8df97c86b88d0a3d563f}} 
\index{SceneViewer@{SceneViewer}!mult3DMatrix@{mult3DMatrix}}
\index{mult3DMatrix@{mult3DMatrix}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{mult3DMatrix()}{mult3DMatrix()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::mult3\+DMatrix (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02149                                \{}
\DoxyCodeLine{02150   glTranslated(m\_pan3D.x, m\_pan3D.y, 0);}
\DoxyCodeLine{02151   glScaled(m\_zoomScale3D, m\_zoomScale3D, 1);}
\DoxyCodeLine{02152   glRotated(m\_theta3D, 1, 0, 0);}
\DoxyCodeLine{02153   glRotated(m\_phi3D, 0, 1, 0);}
\DoxyCodeLine{02154 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a7417b1376a06cff118bba954c3f67a05}\label{class_scene_viewer_a7417b1376a06cff118bba954c3f67a05}} 
\index{SceneViewer@{SceneViewer}!navigatorPan@{navigatorPan}}
\index{navigatorPan@{navigatorPan}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{navigatorPan()}{navigatorPan()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::navigator\+Pan (\begin{DoxyParamCaption}\item[{const QPoint \&}]{delta }\end{DoxyParamCaption})}

Pan the viewer by using \char`\"{}navigator\char`\"{} (red rectangle) in level strip 
\begin{DoxyCode}{0}
\DoxyCodeLine{02262                                                   \{}
\DoxyCodeLine{02263   panQt(delta);}
\DoxyCodeLine{02264   m\_pos += delta;}
\DoxyCodeLine{02265 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a53550576897c429393bef675c5d13fbe}\label{class_scene_viewer_a53550576897c429393bef675c5d13fbe}} 
\index{SceneViewer@{SceneViewer}!onButtonPressed@{onButtonPressed}}
\index{onButtonPressed@{onButtonPressed}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onButtonPressed}{onButtonPressed}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Button\+Pressed (\begin{DoxyParamCaption}\item[{Flip\+Console\+::\+EGadget}]{button }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00174                                                            \{}
\DoxyCodeLine{00175   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00176   \textcolor{keywordflow}{switch} (button) \{}
\DoxyCodeLine{00177   \textcolor{keywordflow}{case} FlipConsole::eSaveImg: \{}
\DoxyCodeLine{00178     \textcolor{keywordflow}{if} (m\_previewMode == NO\_PREVIEW) \{}
\DoxyCodeLine{00179       DVGui::warning(QObject::tr(}
\DoxyCodeLine{00180           \textcolor{stringliteral}{"{}It is not possible to save images in camera stand view."{}}));}
\DoxyCodeLine{00181       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00182     \}}
\DoxyCodeLine{00183     \mbox{\hyperlink{class_t_app}{TApp}} *app = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{00184     \textcolor{keywordtype}{int} row   = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{00185 }
\DoxyCodeLine{00186     \mbox{\hyperlink{class_previewer}{Previewer}} *previewer =}
\DoxyCodeLine{00187         \mbox{\hyperlink{class_previewer_a5eb765b66490a3d99d432f90864bfacd}{Previewer::instance}}(m\_previewMode == SUBCAMERA\_PREVIEW);}
\DoxyCodeLine{00188     \textcolor{keywordflow}{if} (!previewer-\/>\mbox{\hyperlink{class_previewer_a43b83e2f98aa1ee5fc316fe9eeeaea15}{isFrameReady}}(row)) \{}
\DoxyCodeLine{00189       DVGui::warning(QObject::tr(\textcolor{stringliteral}{"{}The preview images are not ready yet."{}}));}
\DoxyCodeLine{00190       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00191     \}}
\DoxyCodeLine{00192 }
\DoxyCodeLine{00193     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} ras =}
\DoxyCodeLine{00194         previewer-\/>\mbox{\hyperlink{class_previewer_afb0f0a5c7ca1fb9366996407ea58d4cc}{getRaster}}(row, \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.m\_recomputeIfNeeded);}
\DoxyCodeLine{00195 }
\DoxyCodeLine{00196     TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a124eae4cf370288f42c22b3477cb5163}{add}}(QString(\textcolor{stringliteral}{"{}TnzCompareImg"{}}),}
\DoxyCodeLine{00197                                  \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}}(ras-\/>clone()));}
\DoxyCodeLine{00198 }
\DoxyCodeLine{00199     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00200   \}}
\DoxyCodeLine{00201 }
\DoxyCodeLine{00202   \textcolor{keywordflow}{case} FlipConsole::eSave:}
\DoxyCodeLine{00203     \mbox{\hyperlink{class_previewer_a5eb765b66490a3d99d432f90864bfacd}{Previewer::instance}}(m\_previewMode == SUBCAMERA\_PREVIEW)}
\DoxyCodeLine{00204         -\/>saveRenderedFrames();}
\DoxyCodeLine{00205     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00206 }
\DoxyCodeLine{00207   \textcolor{keywordflow}{case} FlipConsole::eHisto: \{}
\DoxyCodeLine{00208     QAction *action = CommandManager::instance()-\/>getAction(MI\_Histogram);}
\DoxyCodeLine{00209     action-\/>trigger();}
\DoxyCodeLine{00210     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00211   \}}
\DoxyCodeLine{00212 }
\DoxyCodeLine{00213   \textcolor{keywordflow}{case} FlipConsole::eDefineSubCamera:}
\DoxyCodeLine{00214     m\_editPreviewSubCamera = !m\_editPreviewSubCamera;}
\DoxyCodeLine{00215     update();}
\DoxyCodeLine{00216     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00217 }
\DoxyCodeLine{00218   \textcolor{comment}{// open locator. Create one for the first time}}
\DoxyCodeLine{00219   \textcolor{keywordflow}{case} FlipConsole::eLocator:}
\DoxyCodeLine{00220     \textcolor{keywordflow}{if} (!m\_locator) m\_locator = \textcolor{keyword}{new} \mbox{\hyperlink{class_locator_popup}{LocatorPopup}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00221     m\_locator-\/>show();}
\DoxyCodeLine{00222     m\_locator-\/>raise();}
\DoxyCodeLine{00223     m\_locator-\/>activateWindow();}
\DoxyCodeLine{00224     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00225 }
\DoxyCodeLine{00226   \textcolor{keywordflow}{case} FlipConsole::eZoomIn:}
\DoxyCodeLine{00227     zoomIn();}
\DoxyCodeLine{00228     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00229   \textcolor{keywordflow}{case} FlipConsole::eZoomOut:}
\DoxyCodeLine{00230     zoomOut();}
\DoxyCodeLine{00231     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00232   \textcolor{keywordflow}{case} FlipConsole::eFlipHorizontal:}
\DoxyCodeLine{00233     flipX();}
\DoxyCodeLine{00234     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00235   \textcolor{keywordflow}{case} FlipConsole::eFlipVertical:}
\DoxyCodeLine{00236     flipY();}
\DoxyCodeLine{00237     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00238   \textcolor{keywordflow}{case} FlipConsole::eResetView:}
\DoxyCodeLine{00239     resetSceneViewer();}
\DoxyCodeLine{00240     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00241   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00242     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00243   \}}
\DoxyCodeLine{00244 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_afa78eb4bdab0b03f3e4ac1fc4af67e05}\label{class_scene_viewer_afa78eb4bdab0b03f3e4ac1fc4af67e05}} 
\index{SceneViewer@{SceneViewer}!onContextAboutToBeDestroyed@{onContextAboutToBeDestroyed}}
\index{onContextAboutToBeDestroyed@{onContextAboutToBeDestroyed}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onContextAboutToBeDestroyed}{onContextAboutToBeDestroyed}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Context\+About\+To\+Be\+Destroyed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{03294                                               \{}
\DoxyCodeLine{03295   \textcolor{keywordflow}{if} (!m\_lutCalibrator) \textcolor{keywordflow}{return};}
\DoxyCodeLine{03296   makeCurrent();}
\DoxyCodeLine{03297   m\_lutCalibrator-\/>cleanup();}
\DoxyCodeLine{03298   doneCurrent();}
\DoxyCodeLine{03299   disconnect(context(), SIGNAL(aboutToBeDestroyed()), \textcolor{keyword}{this},}
\DoxyCodeLine{03300              SLOT(onContextAboutToBeDestroyed()));}
\DoxyCodeLine{03301 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a8ebf805abb82191cbde483dc14fa8896}\label{class_scene_viewer_a8ebf805abb82191cbde483dc14fa8896}} 
\index{SceneViewer@{SceneViewer}!onContextMenu@{onContextMenu}}
\index{onContextMenu@{onContextMenu}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onContextMenu()}{onContextMenu()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Context\+Menu (\begin{DoxyParamCaption}\item[{const QPoint \&}]{pos,  }\item[{const QPoint \&}]{global\+Pos }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01652                                                                           \{}
\DoxyCodeLine{01653   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01654   \textcolor{keywordflow}{if} (m\_isLocator) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01655   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} menuVisible = \textcolor{keyword}{false};}
\DoxyCodeLine{01656   \textcolor{keywordflow}{if} (menuVisible) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01657   menuVisible     = \textcolor{keyword}{true};}
\DoxyCodeLine{01658   \textcolor{keywordtype}{int} devPixRatio = getDevPixRatio();}
\DoxyCodeLine{01659   \mbox{\hyperlink{class_t_point_t}{TPoint}} winPos(pos.x() * devPixRatio, height() -\/ pos.y() * devPixRatio);}
\DoxyCodeLine{01660   std::vector<int> columnIndices;}
\DoxyCodeLine{01661   \textcolor{comment}{// enable to select all the columns regardless of the click position}}
\DoxyCodeLine{01662   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{01663        i < \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet()-\/>\mbox{\hyperlink{class_t_xsheet_a17464dc5617cf87a46f03e1a52d36cc1}{getColumnCount}}();}
\DoxyCodeLine{01664        i++)}
\DoxyCodeLine{01665     columnIndices.push\_back(i);}
\DoxyCodeLine{01666 }
\DoxyCodeLine{01667   \mbox{\hyperlink{class_scene_viewer_context_menu}{SceneViewerContextMenu}} *menu = \textcolor{keyword}{new} \mbox{\hyperlink{class_scene_viewer_context_menu}{SceneViewerContextMenu}}(\textcolor{keyword}{this});}
\DoxyCodeLine{01668 }
\DoxyCodeLine{01669   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{01670   \mbox{\hyperlink{class_t_point_t}{TPointD}} p   = ((tool) ? tool-\/>getMatrix().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() : \mbox{\hyperlink{class_t_affine}{TAffine}}()) *}
\DoxyCodeLine{01671               winToWorld(pos * devPixRatio);}
\DoxyCodeLine{01672   menu-\/>addEnterGroupCommands(p);}
\DoxyCodeLine{01673 }
\DoxyCodeLine{01674   menu-\/>addLevelCommands(columnIndices);}
\DoxyCodeLine{01675 }
\DoxyCodeLine{01676   \mbox{\hyperlink{class_combo_viewer_panel}{ComboViewerPanel}} *cvp =}
\DoxyCodeLine{01677       qobject\_cast<ComboViewerPanel *>(parentWidget()-\/>parentWidget());}
\DoxyCodeLine{01678   \textcolor{keywordflow}{if} (cvp) \{}
\DoxyCodeLine{01679     menu-\/>addSeparator();}
\DoxyCodeLine{01680     cvp-\/>addShowHideContextMenu(menu);}
\DoxyCodeLine{01681   \}}
\DoxyCodeLine{01682 }
\DoxyCodeLine{01683   \mbox{\hyperlink{class_scene_viewer_panel}{SceneViewerPanel}} *svp = qobject\_cast<SceneViewerPanel *>(}
\DoxyCodeLine{01684       parentWidget()-\/>parentWidget()-\/>parentWidget());}
\DoxyCodeLine{01685   \textcolor{keywordflow}{if} (svp) \{}
\DoxyCodeLine{01686     menu-\/>addSeparator();}
\DoxyCodeLine{01687     svp-\/>addShowHideContextMenu(menu);}
\DoxyCodeLine{01688   \}}
\DoxyCodeLine{01689 }
\DoxyCodeLine{01690   menu-\/>exec(globalPos);}
\DoxyCodeLine{01691   \textcolor{keyword}{delete} menu;}
\DoxyCodeLine{01692   menuVisible = \textcolor{keyword}{false};}
\DoxyCodeLine{01693 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a0f3074198bf23399e5701d53fec54a78}\label{class_scene_viewer_a0f3074198bf23399e5701d53fec54a78}} 
\index{SceneViewer@{SceneViewer}!onEnter@{onEnter}}
\index{onEnter@{onEnter}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onEnter()}{onEnter()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Enter (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00442                           \{}
\DoxyCodeLine{00443   \textcolor{keywordflow}{if} (m\_isMouseEntered) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00444 }
\DoxyCodeLine{00445   m\_isMouseEntered = \textcolor{keyword}{true};}
\DoxyCodeLine{00446 }
\DoxyCodeLine{00447   \mbox{\hyperlink{class_t_app}{TApp}} *app = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{00448   app-\/>setActiveViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{00449   \mbox{\hyperlink{class_t_tool}{TTool}} *tool      = app-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{00450   \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *level = app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel();}
\DoxyCodeLine{00451   \textcolor{keywordflow}{if} (level \&\& level-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}())}
\DoxyCodeLine{00452     m\_dpiScale =}
\DoxyCodeLine{00453         getCurrentDpiScale(level-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}(), tool-\/>\mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}());}
\DoxyCodeLine{00454   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00455     m\_dpiScale = \mbox{\hyperlink{class_t_point_t}{TPointD}}(1, 1);}
\DoxyCodeLine{00456 }
\DoxyCodeLine{00457   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00458 }
\DoxyCodeLine{00459   \mbox{\hyperlink{class_scene_viewer_a51e41da45c96d39493ac2753b89d5407}{invalidateToolStatus}}();}
\DoxyCodeLine{00460   \textcolor{keywordflow}{if} (tool \&\& tool-\/>isEnabled()) \{}
\DoxyCodeLine{00461     tool-\/>setViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{00462     tool-\/>\mbox{\hyperlink{class_t_tool_a1a5f380464a6b36947212e2f8d5b314c}{updateMatrix}}();}
\DoxyCodeLine{00463     tool-\/>\mbox{\hyperlink{class_t_tool_a3e775cfcd05aa3c35048b11fa40ab3e4}{onEnter}}();}
\DoxyCodeLine{00464   \}}
\DoxyCodeLine{00465 }
\DoxyCodeLine{00466   \textcolor{comment}{// grab the focus, unless a line-\/edit is focused currently}}
\DoxyCodeLine{00467   \textcolor{keywordtype}{bool} shouldSetFocus = \textcolor{keyword}{true};}
\DoxyCodeLine{00468 }
\DoxyCodeLine{00469   QWidget *focusWidget = qApp-\/>focusWidget();}
\DoxyCodeLine{00470   \textcolor{keywordflow}{if} (focusWidget) \{}
\DoxyCodeLine{00471     QLineEdit *lineEdit = \textcolor{keyword}{dynamic\_cast<}QLineEdit *\textcolor{keyword}{>}(focusWidget);}
\DoxyCodeLine{00472     \textcolor{keywordflow}{if} (lineEdit) \{}
\DoxyCodeLine{00473       shouldSetFocus = \textcolor{keyword}{false};}
\DoxyCodeLine{00474     \}}
\DoxyCodeLine{00475   \}}
\DoxyCodeLine{00476 }
\DoxyCodeLine{00477   \textcolor{keywordflow}{if} (shouldSetFocus) \{}
\DoxyCodeLine{00478     setFocus();}
\DoxyCodeLine{00479   \}}
\DoxyCodeLine{00480 }
\DoxyCodeLine{00481   update();}
\DoxyCodeLine{00482 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a76cd7a43b0be7f97a5493ed93bd768d4}\label{class_scene_viewer_a76cd7a43b0be7f97a5493ed93bd768d4}} 
\index{SceneViewer@{SceneViewer}!onFrameSwitched@{onFrameSwitched}}
\index{onFrameSwitched@{onFrameSwitched}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onFrameSwitched}{onFrameSwitched}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Frame\+Switched (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02898                                   \{}
\DoxyCodeLine{02899   \mbox{\hyperlink{class_scene_viewer_a51e41da45c96d39493ac2753b89d5407}{invalidateToolStatus}}();}
\DoxyCodeLine{02900 }
\DoxyCodeLine{02901   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{02902   \textcolor{keywordflow}{if} (tool \&\& tool-\/>isEnabled()) \{}
\DoxyCodeLine{02903     tool-\/>setViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{02904     tool-\/>\mbox{\hyperlink{class_t_tool_a1a5f380464a6b36947212e2f8d5b314c}{updateMatrix}}();}
\DoxyCodeLine{02905     tool-\/>\mbox{\hyperlink{class_t_tool_a3e775cfcd05aa3c35048b11fa40ab3e4}{onEnter}}();}
\DoxyCodeLine{02906   \}}
\DoxyCodeLine{02907 }
\DoxyCodeLine{02908   \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidateAll}}();}
\DoxyCodeLine{02909 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ac8ac929204cd5dbe735e893d16302970}\label{class_scene_viewer_ac8ac929204cd5dbe735e893d16302970}} 
\index{SceneViewer@{SceneViewer}!onLeave@{onLeave}}
\index{onLeave@{onLeave}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onLeave()}{onLeave()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Leave (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00420                           \{}
\DoxyCodeLine{00421   \textcolor{keywordflow}{if} (!m\_isMouseEntered) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00422 }
\DoxyCodeLine{00423   m\_isMouseEntered = \textcolor{keyword}{false};}
\DoxyCodeLine{00424 }
\DoxyCodeLine{00425   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00426   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{00427   \textcolor{keywordflow}{if} (tool \&\& tool-\/>isEnabled()) tool-\/>\mbox{\hyperlink{class_t_tool_af7fb05265a94131da081da654e271a22}{onLeave}}();}
\DoxyCodeLine{00428 }
\DoxyCodeLine{00429   \textcolor{comment}{// force reset the flipping of shift \& trace}}
\DoxyCodeLine{00430   \textcolor{keywordflow}{if} (CommandManager::instance()-\/>getAction(MI\_ShiftTrace)-\/>isChecked())}
\DoxyCodeLine{00431     TTool::getTool(\textcolor{stringliteral}{"{}T\_ShiftTrace"{}}, \mbox{\hyperlink{class_t_tool_adf0ea3a7f9d003f761fe57638dd6eff4a68b7e2c2f25d134cb0debc4548d23ce1}{TTool::ToonzImage}})-\/>\mbox{\hyperlink{class_t_tool_af7fb05265a94131da081da654e271a22}{onLeave}}();}
\DoxyCodeLine{00432 }
\DoxyCodeLine{00433   update();}
\DoxyCodeLine{00434 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a0454f71591bde07203a2e6ac030e9b5d}\label{class_scene_viewer_a0454f71591bde07203a2e6ac030e9b5d}} 
\index{SceneViewer@{SceneViewer}!onLevelChanged@{onLevelChanged}}
\index{onLevelChanged@{onLevelChanged}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onLevelChanged}{onLevelChanged}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Level\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02843                                  \{}
\DoxyCodeLine{02844   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{02845   \textcolor{keywordflow}{if} (tool) \{}
\DoxyCodeLine{02846     \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *level = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel();}
\DoxyCodeLine{02847     \textcolor{keywordflow}{if} (level \&\& level-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}())}
\DoxyCodeLine{02848       m\_dpiScale =}
\DoxyCodeLine{02849           getCurrentDpiScale(level-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}(), tool-\/>\mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}());}
\DoxyCodeLine{02850     \textcolor{keywordflow}{else}}
\DoxyCodeLine{02851       m\_dpiScale = \mbox{\hyperlink{class_t_point_t}{TPointD}}(1, 1);}
\DoxyCodeLine{02852   \}}
\DoxyCodeLine{02853 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a4c5ebcc7632efbf13fd8640531e95766}\label{class_scene_viewer_a4c5ebcc7632efbf13fd8640531e95766}} 
\index{SceneViewer@{SceneViewer}!onLevelSwitched@{onLevelSwitched}}
\index{onLevelSwitched@{onLevelSwitched}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onLevelSwitched}{onLevelSwitched}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Level\+Switched (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}

when level is switched, update m\+\_\+dpi\+Scale in order to show white background for Ink\&Paint work properly 
\begin{DoxyCode}{0}
\DoxyCodeLine{02858                                   \{}
\DoxyCodeLine{02859   \mbox{\hyperlink{class_scene_viewer_a51e41da45c96d39493ac2753b89d5407}{invalidateToolStatus}}();}
\DoxyCodeLine{02860   \mbox{\hyperlink{class_t_app}{TApp}} *app        = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{02861   \mbox{\hyperlink{class_t_tool}{TTool}} *tool      = app-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{02862   \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *level = app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel();}
\DoxyCodeLine{02863   \textcolor{keywordflow}{if} (level \&\& level-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}())}
\DoxyCodeLine{02864     m\_dpiScale =}
\DoxyCodeLine{02865         getCurrentDpiScale(level-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}(), tool-\/>\mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}());}
\DoxyCodeLine{02866   \textcolor{keywordflow}{else}}
\DoxyCodeLine{02867     m\_dpiScale = \mbox{\hyperlink{class_t_point_t}{TPointD}}(1, 1);}
\DoxyCodeLine{02868 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00688}{TTool\+::get\+Current\+Fid()}}, \mbox{\hyperlink{l00122}{TApp\+::get\+Current\+Level()}}, \mbox{\hyperlink{l00126}{TApp\+::get\+Current\+Tool()}}, \mbox{\hyperlink{l00095}{TXsh\+Level\+::get\+Simple\+Level()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, and \mbox{\hyperlink{l03234}{invalidate\+Tool\+Status()}}.

\mbox{\Hypertarget{class_scene_viewer_a147e36c46189dce4600beccc005e50d2}\label{class_scene_viewer_a147e36c46189dce4600beccc005e50d2}} 
\index{SceneViewer@{SceneViewer}!onMove@{onMove}}
\index{onMove@{onMove}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onMove()}{onMove()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Move (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00509                                                  \{}
\DoxyCodeLine{00510   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00511 }
\DoxyCodeLine{00512   \textcolor{keywordtype}{int} devPixRatio = getDevPixRatio();}
\DoxyCodeLine{00513   QPointF curPos  = \textcolor{keyword}{event}.mousePos() * devPixRatio;}
\DoxyCodeLine{00514   \textcolor{keywordtype}{bool} cursorSet  = \textcolor{keyword}{false};}
\DoxyCodeLine{00515   m\_lastMousePos  = curPos;}
\DoxyCodeLine{00516 }
\DoxyCodeLine{00517   \textcolor{keywordflow}{if} (m\_editPreviewSubCamera) \{}
\DoxyCodeLine{00518     \textcolor{keywordflow}{if} (!PreviewSubCameraManager::instance()-\/>mouseMoveEvent(\textcolor{keyword}{this}, event))}
\DoxyCodeLine{00519       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00520   \}}
\DoxyCodeLine{00521 }
\DoxyCodeLine{00522   \textcolor{comment}{// if the "{}compare with snapshot"{} mode is activated, change the mouse cursor}}
\DoxyCodeLine{00523   \textcolor{comment}{// on the border handle}}
\DoxyCodeLine{00524   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_af46b586bd61bf70e606713bee68c3aad}{m\_doCompare}} \&\& isPreviewEnabled()) \{}
\DoxyCodeLine{00525     \textcolor{keywordflow}{if} (std::abs(curPos.x() -\/ width() * m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_ac544bac665ef86ee2ef3cfc214e89430}{m\_compareX}}) < 20) \{}
\DoxyCodeLine{00526       cursorSet = \textcolor{keyword}{true};}
\DoxyCodeLine{00527       setToolCursor(\textcolor{keyword}{this}, ToolCursor::ScaleHCursor);}
\DoxyCodeLine{00528     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::abs((height() -\/ curPos.y()) -\/}
\DoxyCodeLine{00529                         height() * m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_aef7ad2a36c8fe81f397f225df3fc1095}{m\_compareY}}) < 20) \{}
\DoxyCodeLine{00530       cursorSet = \textcolor{keyword}{true};}
\DoxyCodeLine{00531       setToolCursor(\textcolor{keyword}{this}, ToolCursor::ScaleVCursor);}
\DoxyCodeLine{00532     \}}
\DoxyCodeLine{00533 }
\DoxyCodeLine{00534     \textcolor{comment}{// control of the border handle when the "{}compare with snapshot"{} mode is}}
\DoxyCodeLine{00535     \textcolor{comment}{// activated}}
\DoxyCodeLine{00536     \textcolor{keywordflow}{if} (m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a5c7c87c21fafb25dc1ba31ac6574397f}{m\_dragCompareX}} || m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a3458a525867577308cefaf2d33f6639b}{m\_dragCompareY}}) \{}
\DoxyCodeLine{00537       \textcolor{keywordflow}{if} (m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a5c7c87c21fafb25dc1ba31ac6574397f}{m\_dragCompareX}})}
\DoxyCodeLine{00538         m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_ac544bac665ef86ee2ef3cfc214e89430}{m\_compareX}} +=}
\DoxyCodeLine{00539             ((double)(curPos.x() -\/ m\_pos.x())) / width();}
\DoxyCodeLine{00540       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a3458a525867577308cefaf2d33f6639b}{m\_dragCompareY}})}
\DoxyCodeLine{00541         m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_aef7ad2a36c8fe81f397f225df3fc1095}{m\_compareY}} -\/=}
\DoxyCodeLine{00542             ((double)(curPos.y() -\/ m\_pos.y())) / height();}
\DoxyCodeLine{00543       m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_ac544bac665ef86ee2ef3cfc214e89430}{m\_compareX}} =}
\DoxyCodeLine{00544           tcrop(m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_ac544bac665ef86ee2ef3cfc214e89430}{m\_compareX}}, 0.0, 1.0);}
\DoxyCodeLine{00545       m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_aef7ad2a36c8fe81f397f225df3fc1095}{m\_compareY}} =}
\DoxyCodeLine{00546           tcrop(m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_aef7ad2a36c8fe81f397f225df3fc1095}{m\_compareY}}, 0.0, 1.0);}
\DoxyCodeLine{00547 }
\DoxyCodeLine{00548       update();}
\DoxyCodeLine{00549 }
\DoxyCodeLine{00550       m\_pos = curPos;}
\DoxyCodeLine{00551     \}}
\DoxyCodeLine{00552   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_mouseButton == Qt::NoButton || m\_mouseButton == Qt::LeftButton) \{}
\DoxyCodeLine{00553     \textcolor{keywordflow}{if} (is3DView()) \{}
\DoxyCodeLine{00554       \textcolor{keywordflow}{if} (m\_current3DDevice != NONE \&\& m\_mouseButton == Qt::LeftButton)}
\DoxyCodeLine{00555         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00556       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_mouseButton == Qt::NoButton) \{}
\DoxyCodeLine{00557         \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(\mbox{\hyperlink{class_t_point_t}{TPointD}}(m\_topRasterPos.x, m\_topRasterPos.y),}
\DoxyCodeLine{00558                              \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}}(20 * devPixRatio, 20 * devPixRatio));}
\DoxyCodeLine{00559         \textcolor{keywordflow}{if} (rect.contains(\mbox{\hyperlink{class_t_point_t}{TPointD}}(curPos.x(), curPos.y())))}
\DoxyCodeLine{00560           m\_current3DDevice = TOP\_3D;}
\DoxyCodeLine{00561         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00562           rect = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(\mbox{\hyperlink{class_t_point_t}{TPointD}}(m\_sideRasterPos.x, m\_sideRasterPos.y),}
\DoxyCodeLine{00563                         \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}}(20 * devPixRatio, 20 * devPixRatio));}
\DoxyCodeLine{00564           \textcolor{keywordflow}{if} (rect.contains(\mbox{\hyperlink{class_t_point_t}{TPointD}}(curPos.x(), curPos.y()))) \{}
\DoxyCodeLine{00565             \textcolor{keywordflow}{if} (m\_phi3D > 0)}
\DoxyCodeLine{00566               m\_current3DDevice = SIDE\_RIGHT\_3D;}
\DoxyCodeLine{00567             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00568               m\_current3DDevice = SIDE\_LEFT\_3D;}
\DoxyCodeLine{00569           \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00570             m\_current3DDevice = NONE;}
\DoxyCodeLine{00571         \}}
\DoxyCodeLine{00572         \textcolor{keywordflow}{if} (m\_current3DDevice != NONE) \{}
\DoxyCodeLine{00573           cursorSet = \textcolor{keyword}{true};}
\DoxyCodeLine{00574           setToolCursor(\textcolor{keyword}{this}, ToolCursor::CURSOR\_ARROW);}
\DoxyCodeLine{00575         \}}
\DoxyCodeLine{00576       \}}
\DoxyCodeLine{00577     \}}
\DoxyCodeLine{00578 }
\DoxyCodeLine{00579     \textcolor{comment}{// if the middle mouse button is pressed while dragging, then do panning}}
\DoxyCodeLine{00580     \textcolor{keywordflow}{if} (event.buttons() \& Qt::MidButton) \{}
\DoxyCodeLine{00581       \textcolor{comment}{// panning}}
\DoxyCodeLine{00582       QPointF p = curPos -\/ m\_pos;}
\DoxyCodeLine{00583       \textcolor{keywordflow}{if} (m\_pos == QPointF() \&\& p.manhattanLength() > 300) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00584       panQt(curPos -\/ m\_pos);}
\DoxyCodeLine{00585       m\_pos = curPos;}
\DoxyCodeLine{00586       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00587     \}}
\DoxyCodeLine{00588 }
\DoxyCodeLine{00589     \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{00590     \textcolor{keywordflow}{if} (!tool || !tool-\/>isEnabled()) \{}
\DoxyCodeLine{00591       m\_tabletEvent = \textcolor{keyword}{false};}
\DoxyCodeLine{00592       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00593     \}}
\DoxyCodeLine{00594     tool-\/>setViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{00595     \mbox{\hyperlink{class_t_point_t}{TPointD}} worldPos = winToWorld(curPos);}
\DoxyCodeLine{00596     \mbox{\hyperlink{class_t_point_t}{TPointD}} pos      = tool-\/>getMatrix().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * worldPos;}
\DoxyCodeLine{00597 }
\DoxyCodeLine{00598 \textcolor{preprocessor}{\#ifdef WITH\_CANON}}
\DoxyCodeLine{00599     \textcolor{comment}{// grab screen picking for stop motion live view zoom}}
\DoxyCodeLine{00600     \textcolor{keywordflow}{if} ((event.buttons() \& Qt::LeftButton) \&\&}
\DoxyCodeLine{00601         StopMotion::instance()-\/>m\_canon-\/>m\_pickLiveViewZoom) \{}
\DoxyCodeLine{00602       StopMotion::instance()-\/>m\_canon-\/>makeZoomPoint(pos);}
\DoxyCodeLine{00603       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00604     \}}
\DoxyCodeLine{00605 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00606 }
\DoxyCodeLine{00607     \textcolor{keywordflow}{if} (m\_locator) \{}
\DoxyCodeLine{00608       m\_locator-\/>onChangeViewAff(worldPos);}
\DoxyCodeLine{00609     \}}
\DoxyCodeLine{00610 }
\DoxyCodeLine{00611     \mbox{\hyperlink{class_t_object_handle}{TObjectHandle}} *objHandle = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a0d91c122eec2b756b7c4780014e49f9e}{getCurrentObject}}();}
\DoxyCodeLine{00612     \textcolor{keywordflow}{if} (tool-\/>getToolType() \& TTool::LevelTool \&\& !objHandle-\/>isSpline()) \{}
\DoxyCodeLine{00613       pos.x /= m\_dpiScale.x;}
\DoxyCodeLine{00614       pos.y /= m\_dpiScale.y;}
\DoxyCodeLine{00615     \}}
\DoxyCodeLine{00616 }
\DoxyCodeLine{00617     \textcolor{comment}{// qDebug() << "{}mouseMoveEvent. "{}  << (m\_tabletEvent?"{}tablet"{}:"{}mouse"{})}}
\DoxyCodeLine{00618     \textcolor{comment}{//         << "{} pressure="{} << m\_pressure << "{} mouseButton="{} << m\_mouseButton}}
\DoxyCodeLine{00619     \textcolor{comment}{//         << "{} buttonClicked="{} << m\_buttonClicked;}}
\DoxyCodeLine{00620 }
\DoxyCodeLine{00621     \textcolor{comment}{// separate tablet events from mouse events}}
\DoxyCodeLine{00622     \textcolor{keywordflow}{if} (m\_tabletEvent \&\&}
\DoxyCodeLine{00623         (m\_tabletState == OnStroke || m\_tabletState == StartStroke) \&\&}
\DoxyCodeLine{00624         m\_tabletMove) \{}
\DoxyCodeLine{00625       \textcolor{keywordflow}{if} (m\_toolSwitched) tool-\/>leftButtonDown(pos, event);}
\DoxyCodeLine{00626       tool-\/>leftButtonDrag(pos, event);}
\DoxyCodeLine{00627       m\_tabletState = OnStroke;}
\DoxyCodeLine{00628     \}}
\DoxyCodeLine{00629 }
\DoxyCodeLine{00630     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_mouseButton == Qt::LeftButton) \{}
\DoxyCodeLine{00631       \textcolor{comment}{// sometimes the mousePressedEvent is postponed to a wrong  mouse move}}
\DoxyCodeLine{00632       \textcolor{comment}{// event!}}
\DoxyCodeLine{00633       \textcolor{comment}{//      if (m\_buttonClicked \&\& !m\_toolSwitched) tool-\/>leftButtonDrag(pos,}}
\DoxyCodeLine{00634       \textcolor{comment}{//      event);}}
\DoxyCodeLine{00635       \textcolor{keywordflow}{if} (m\_toolSwitched) tool-\/>leftButtonDown(pos, event);}
\DoxyCodeLine{00636       tool-\/>leftButtonDrag(pos, event);}
\DoxyCodeLine{00637       m\_mouseState = OnStroke;}
\DoxyCodeLine{00638     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_pressure == 0.0) \{}
\DoxyCodeLine{00639       tool-\/>mouseMove(pos, event);}
\DoxyCodeLine{00640     \}}
\DoxyCodeLine{00641     \textcolor{keywordflow}{if} (!cursorSet) setToolCursor(\textcolor{keyword}{this}, tool-\/>\mbox{\hyperlink{class_t_tool_a1768a57b8b6d1480618fd923fad15f1d}{getCursorId}}());}
\DoxyCodeLine{00642 }
\DoxyCodeLine{00643 \textcolor{preprocessor}{\#ifdef WITH\_CANON}}
\DoxyCodeLine{00644     \textcolor{keywordflow}{if} (StopMotion::instance()-\/>m\_canon-\/>m\_pickLiveViewZoom)}
\DoxyCodeLine{00645       setToolCursor(\textcolor{keyword}{this}, ToolCursor::ZoomCursor);}
\DoxyCodeLine{00646 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00647     m\_pos          = curPos;}
\DoxyCodeLine{00648     m\_tabletMove   = \textcolor{keyword}{false};}
\DoxyCodeLine{00649     m\_toolSwitched = \textcolor{keyword}{false};}
\DoxyCodeLine{00650   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_mouseButton == Qt::MidButton) \{}
\DoxyCodeLine{00651     \textcolor{keywordflow}{if} ((event.buttons() \& Qt::MidButton) == 0) m\_mouseButton = Qt::NoButton;}
\DoxyCodeLine{00652     \textcolor{comment}{// scrub with shift and middle click}}
\DoxyCodeLine{00653     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (event.isShiftPressed() \&\& event.isCtrlPressed()) \{}
\DoxyCodeLine{00654       \textcolor{keywordflow}{if} (curPos.x() > m\_pos.x()) \{}
\DoxyCodeLine{00655         CommandManager::instance()-\/>execute(\textcolor{stringliteral}{"{}MI\_NextFrame"{}});}
\DoxyCodeLine{00656       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (curPos.x() < m\_pos.x()) \{}
\DoxyCodeLine{00657         CommandManager::instance()-\/>execute(\textcolor{stringliteral}{"{}MI\_PrevFrame"{}});}
\DoxyCodeLine{00658       \}}
\DoxyCodeLine{00659     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00660       \textcolor{comment}{// panning}}
\DoxyCodeLine{00661       panQt(curPos -\/ m\_pos);}
\DoxyCodeLine{00662     \}}
\DoxyCodeLine{00663     m\_pos = curPos;}
\DoxyCodeLine{00664 }
\DoxyCodeLine{00665     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00666   \}}
\DoxyCodeLine{00667 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a4e8e688d6369e5fb243a853e9d91ce53}\label{class_scene_viewer_a4e8e688d6369e5fb243a853e9d91ce53}} 
\index{SceneViewer@{SceneViewer}!onObjectSwitched@{onObjectSwitched}}
\index{onObjectSwitched@{onObjectSwitched}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onObjectSwitched}{onObjectSwitched}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Object\+Switched (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02882                                    \{}
\DoxyCodeLine{02883   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{02884   \textcolor{keywordflow}{if} (tool \&\& tool-\/>isEnabled()) tool-\/>\mbox{\hyperlink{class_t_tool_a1a5f380464a6b36947212e2f8d5b314c}{updateMatrix}}();}
\DoxyCodeLine{02885   onLevelChanged();}
\DoxyCodeLine{02886   \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidateAll}}();}
\DoxyCodeLine{02887 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a034053ccfdd1dc475139a0c119e2f07a}\label{class_scene_viewer_a034053ccfdd1dc475139a0c119e2f07a}} 
\index{SceneViewer@{SceneViewer}!onOnionSkinMaskChanged@{onOnionSkinMaskChanged}}
\index{onOnionSkinMaskChanged@{onOnionSkinMaskChanged}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onOnionSkinMaskChanged}{onOnionSkinMaskChanged}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Onion\+Skin\+Mask\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00437 \{ \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidateAll}}(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a747bce47ff0499a9dd5a6043ca83fb1a}\label{class_scene_viewer_a747bce47ff0499a9dd5a6043ca83fb1a}} 
\index{SceneViewer@{SceneViewer}!onPreferenceChanged@{onPreferenceChanged}}
\index{onPreferenceChanged@{onPreferenceChanged}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onPreferenceChanged}{onPreferenceChanged}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Preference\+Changed (\begin{DoxyParamCaption}\item[{const QString \&}]{pref\+Name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01204                                                              \{}
\DoxyCodeLine{01205   \textcolor{keywordflow}{if} (prefName == \textcolor{stringliteral}{"{}ColorCalibration"{}}) \{}
\DoxyCodeLine{01206     \textcolor{keywordflow}{if} (Preferences::instance()-\/>isColorCalibrationEnabled()) \{}
\DoxyCodeLine{01207       \textcolor{comment}{// if the window is so shriked that the gl widget is empty,}}
\DoxyCodeLine{01208       \textcolor{comment}{// showEvent can be called before creating the context.}}
\DoxyCodeLine{01209       \textcolor{keywordflow}{if} (!context()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01210       makeCurrent();}
\DoxyCodeLine{01211       \textcolor{keywordflow}{if} (!m\_lutCalibrator)}
\DoxyCodeLine{01212         m\_lutCalibrator = \textcolor{keyword}{new} \mbox{\hyperlink{class_lut_calibrator}{LutCalibrator}}();}
\DoxyCodeLine{01213       \textcolor{keywordflow}{else}}
\DoxyCodeLine{01214         m\_lutCalibrator-\/>cleanup();}
\DoxyCodeLine{01215       m\_lutCalibrator-\/>initialize();}
\DoxyCodeLine{01216       connect(context(), SIGNAL(aboutToBeDestroyed()), \textcolor{keyword}{this},}
\DoxyCodeLine{01217               SLOT(onContextAboutToBeDestroyed()));}
\DoxyCodeLine{01218       \textcolor{keywordflow}{if} (m\_lutCalibrator-\/>isValid() \&\& !m\_fbo) \{}
\DoxyCodeLine{01219         \textcolor{keywordflow}{if} (Preferences::instance()-\/>is30bitDisplayEnabled()) \{}
\DoxyCodeLine{01220           QOpenGLFramebufferObjectFormat format;}
\DoxyCodeLine{01221           format.setInternalTextureFormat(TGL\_TexFmt10);}
\DoxyCodeLine{01222           m\_fbo = \textcolor{keyword}{new} QOpenGLFramebufferObject(width(), height(), format);}
\DoxyCodeLine{01223         \} \textcolor{keywordflow}{else}  \textcolor{comment}{// normally, initialize with GL\_RGBA8 format}}
\DoxyCodeLine{01224           m\_fbo = \textcolor{keyword}{new} QOpenGLFramebufferObject(width(), height());}
\DoxyCodeLine{01225       \}}
\DoxyCodeLine{01226       doneCurrent();}
\DoxyCodeLine{01227     \}}
\DoxyCodeLine{01228     update();}
\DoxyCodeLine{01229   \}}
\DoxyCodeLine{01230 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a815593940281a159efb32f5db1a10276}\label{class_scene_viewer_a815593940281a159efb32f5db1a10276}} 
\index{SceneViewer@{SceneViewer}!onPress@{onPress}}
\index{onPress@{onPress}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onPress()}{onPress()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Press (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00697                                                   \{}
\DoxyCodeLine{00698   \textcolor{keywordflow}{if} (m\_mouseButton != Qt::NoButton) \{}
\DoxyCodeLine{00699     \textcolor{keywordflow}{if} (event.m\_isTablet \&\& m\_mouseState != None) \{}
\DoxyCodeLine{00700       \textcolor{comment}{//      qDebug() << "{}[onPress] Switched from MousePress to TabletPress"{};}}
\DoxyCodeLine{00701       \textcolor{comment}{// TabletPress came immediately after MousePress. Let's switch to}}
\DoxyCodeLine{00702       \textcolor{comment}{// tabletPress but not end the prior action or it leaves an extra}}
\DoxyCodeLine{00703       \textcolor{comment}{// stroke}}
\DoxyCodeLine{00704       m\_mouseState    = None;}
\DoxyCodeLine{00705       m\_buttonClicked = \textcolor{keyword}{false};}
\DoxyCodeLine{00706     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00707       \textcolor{comment}{// if some button is pressed while another button being active,}}
\DoxyCodeLine{00708       \textcolor{comment}{// finish the action for the previous button first.}}
\DoxyCodeLine{00709       \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} preEvent = event;}
\DoxyCodeLine{00710       preEvent.m\_button    = m\_mouseButton;}
\DoxyCodeLine{00711       onRelease(preEvent);}
\DoxyCodeLine{00712     \}}
\DoxyCodeLine{00713   \}}
\DoxyCodeLine{00714 }
\DoxyCodeLine{00715   \textcolor{comment}{// evita i press ripetuti}}
\DoxyCodeLine{00716   \textcolor{keywordflow}{if} (m\_buttonClicked) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00717   m\_buttonClicked = \textcolor{keyword}{true};}
\DoxyCodeLine{00718   m\_toolSwitched  = \textcolor{keyword}{false};}
\DoxyCodeLine{00719   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00720 }
\DoxyCodeLine{00721   m\_pos         = \textcolor{keyword}{event}.mousePos() * getDevPixRatio();}
\DoxyCodeLine{00722   m\_mouseButton = \textcolor{keyword}{event}.button();}
\DoxyCodeLine{00723 }
\DoxyCodeLine{00724   \textcolor{comment}{// when using tablet, avoid unexpected drawing behavior occurs when}}
\DoxyCodeLine{00725   \textcolor{comment}{// middle-\/click}}
\DoxyCodeLine{00726   \textcolor{keywordflow}{if} (m\_tabletEvent \&\& m\_mouseButton == Qt::MidButton \&\&}
\DoxyCodeLine{00727       event.isLeftButtonPressed()) \{}
\DoxyCodeLine{00728     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00729   \}}
\DoxyCodeLine{00730 }
\DoxyCodeLine{00731   \textcolor{keywordflow}{if} (is3DView() \&\& m\_current3DDevice != NONE \&\&}
\DoxyCodeLine{00732       m\_mouseButton == Qt::LeftButton)}
\DoxyCodeLine{00733     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00734   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_mouseButton == Qt::LeftButton \&\& m\_editPreviewSubCamera) \{}
\DoxyCodeLine{00735     \textcolor{keywordflow}{if} (!PreviewSubCameraManager::instance()-\/>mousePressEvent(\textcolor{keyword}{this}, event))}
\DoxyCodeLine{00736       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00737   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_mouseButton == Qt::LeftButton \&\& \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_af46b586bd61bf70e606713bee68c3aad}{m\_doCompare}}) \{}
\DoxyCodeLine{00738     \textcolor{keywordflow}{if} (std::abs(m\_pos.x() -\/ width() * m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_ac544bac665ef86ee2ef3cfc214e89430}{m\_compareX}}) < 20) \{}
\DoxyCodeLine{00739       m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a5c7c87c21fafb25dc1ba31ac6574397f}{m\_dragCompareX}} = \textcolor{keyword}{true};}
\DoxyCodeLine{00740       m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a3458a525867577308cefaf2d33f6639b}{m\_dragCompareY}} = \textcolor{keyword}{false};}
\DoxyCodeLine{00741       m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_aef7ad2a36c8fe81f397f225df3fc1095}{m\_compareY}}     = ImagePainter::DefaultCompareValue;}
\DoxyCodeLine{00742       update();}
\DoxyCodeLine{00743       m\_tabletEvent = \textcolor{keyword}{false};}
\DoxyCodeLine{00744       m\_tabletState = None;}
\DoxyCodeLine{00745       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00746     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::abs((height() -\/ m\_pos.y()) -\/}
\DoxyCodeLine{00747                         height() * m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_aef7ad2a36c8fe81f397f225df3fc1095}{m\_compareY}}) < 20) \{}
\DoxyCodeLine{00748       m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a3458a525867577308cefaf2d33f6639b}{m\_dragCompareY}} = \textcolor{keyword}{true};}
\DoxyCodeLine{00749       m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a5c7c87c21fafb25dc1ba31ac6574397f}{m\_dragCompareX}} = \textcolor{keyword}{false};}
\DoxyCodeLine{00750       m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_ac544bac665ef86ee2ef3cfc214e89430}{m\_compareX}}     = ImagePainter::DefaultCompareValue;}
\DoxyCodeLine{00751       update();}
\DoxyCodeLine{00752       m\_tabletEvent = \textcolor{keyword}{false};}
\DoxyCodeLine{00753       m\_tabletState = None;}
\DoxyCodeLine{00754       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00755     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00756       m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a5c7c87c21fafb25dc1ba31ac6574397f}{m\_dragCompareX}} = m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a3458a525867577308cefaf2d33f6639b}{m\_dragCompareY}} =}
\DoxyCodeLine{00757           \textcolor{keyword}{false};}
\DoxyCodeLine{00758   \}}
\DoxyCodeLine{00759 }
\DoxyCodeLine{00760   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00761 }
\DoxyCodeLine{00762   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{00763   \textcolor{keywordflow}{if} (!tool || !tool-\/>isEnabled()) \{}
\DoxyCodeLine{00764     m\_tabletEvent = \textcolor{keyword}{false};}
\DoxyCodeLine{00765     m\_tabletState = None;}
\DoxyCodeLine{00766     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00767   \}}
\DoxyCodeLine{00768   tool-\/>setViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{00769   \textcolor{keywordflow}{if} (m\_mouseButton == Qt::LeftButton \&\& tool-\/>\mbox{\hyperlink{class_t_tool_a11d2c27110689caf7fa6f49519808073}{preLeftButtonDown}}()) \{}
\DoxyCodeLine{00770     tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{00771     \textcolor{keywordflow}{if} (!tool || !tool-\/>isEnabled()) \{}
\DoxyCodeLine{00772       m\_tabletEvent = \textcolor{keyword}{false};}
\DoxyCodeLine{00773       m\_tabletState = None;}
\DoxyCodeLine{00774       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00775     \}}
\DoxyCodeLine{00776     tool-\/>setViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{00777   \}}
\DoxyCodeLine{00778 }
\DoxyCodeLine{00779   \textcolor{comment}{// if(!m\_tabletEvent) qDebug() << "{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/MOUSE PRESS 'PURO'.}}
\DoxyCodeLine{00780   \textcolor{comment}{// POSSIBILE EMBOLO"{};}}
\DoxyCodeLine{00781   \mbox{\hyperlink{class_t_point_t}{TPointD}} pos = tool-\/>getMatrix().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * winToWorld(m\_pos);}
\DoxyCodeLine{00782 }
\DoxyCodeLine{00783   \mbox{\hyperlink{class_t_object_handle}{TObjectHandle}} *objHandle = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a0d91c122eec2b756b7c4780014e49f9e}{getCurrentObject}}();}
\DoxyCodeLine{00784   \textcolor{keywordflow}{if} (tool-\/>getToolType() \& TTool::LevelTool \&\& !objHandle-\/>isSpline()) \{}
\DoxyCodeLine{00785     pos.x /= m\_dpiScale.x;}
\DoxyCodeLine{00786     pos.y /= m\_dpiScale.y;}
\DoxyCodeLine{00787   \}}
\DoxyCodeLine{00788 }
\DoxyCodeLine{00789 \textcolor{preprocessor}{\#ifdef WITH\_CANON}}
\DoxyCodeLine{00790   \textcolor{comment}{// grab screen picking for stop motion live view zoom}}
\DoxyCodeLine{00791   \textcolor{keywordflow}{if} (StopMotion::instance()-\/>m\_canon-\/>m\_pickLiveViewZoom) \{}
\DoxyCodeLine{00792     StopMotion::instance()-\/>m\_canon-\/>makeZoomPoint(pos);}
\DoxyCodeLine{00793     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00794   \}}
\DoxyCodeLine{00795 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00796 }
\DoxyCodeLine{00797   \textcolor{comment}{// separate tablet and mouse events}}
\DoxyCodeLine{00798   \textcolor{keywordflow}{if} (m\_tabletEvent \&\& m\_tabletState == Touched) \{}
\DoxyCodeLine{00799     \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>setToolBusy(\textcolor{keyword}{true});}
\DoxyCodeLine{00800     m\_tabletState = StartStroke;}
\DoxyCodeLine{00801     tool-\/>leftButtonDown(pos, event);}
\DoxyCodeLine{00802   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_mouseButton == Qt::LeftButton) \{}
\DoxyCodeLine{00803     m\_mouseState = StartStroke;}
\DoxyCodeLine{00804     \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>setToolBusy(\textcolor{keyword}{true});}
\DoxyCodeLine{00805     tool-\/>leftButtonDown(pos, event);}
\DoxyCodeLine{00806   \}}
\DoxyCodeLine{00807   \textcolor{keywordflow}{if} (m\_mouseButton == Qt::RightButton) tool-\/>rightButtonDown(pos, event);}
\DoxyCodeLine{00808 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a9cea138440514d78c2580d09f0ebe518}\label{class_scene_viewer_a9cea138440514d78c2580d09f0ebe518}} 
\index{SceneViewer@{SceneViewer}!onPreviewUpdate@{onPreviewUpdate}}
\index{onPreviewUpdate@{onPreviewUpdate}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onPreviewUpdate()}{onPreviewUpdate()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Preview\+Update (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_previewer_1_1_listener}{Previewer\+::\+Listener}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00889                                   \{}
\DoxyCodeLine{00890   update();}
\DoxyCodeLine{00891   emit previewStatusChanged();}
\DoxyCodeLine{00892 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a51cdfd5bdc5782706c1c319888b42d4f}\label{class_scene_viewer_a51cdfd5bdc5782706c1c319888b42d4f}} 
\index{SceneViewer@{SceneViewer}!onRelease@{onRelease}}
\index{onRelease@{onRelease}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onRelease()}{onRelease()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Release (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00840                                                     \{}
\DoxyCodeLine{00841   \textcolor{comment}{// evita i release ripetuti}}
\DoxyCodeLine{00842   \textcolor{keywordflow}{if} (!m\_buttonClicked) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00843   m\_buttonClicked = \textcolor{keyword}{false};}
\DoxyCodeLine{00844 }
\DoxyCodeLine{00845   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{00846   \textcolor{keywordflow}{if} (!tool || !tool-\/>isEnabled()) \{}
\DoxyCodeLine{00847     \textcolor{keywordflow}{if} (!m\_toolDisableReason.isEmpty() \&\& m\_mouseButton == Qt::LeftButton \&\&}
\DoxyCodeLine{00848         !m\_editPreviewSubCamera)}
\DoxyCodeLine{00849       DVGui::warning(m\_toolDisableReason);}
\DoxyCodeLine{00850   \}}
\DoxyCodeLine{00851 }
\DoxyCodeLine{00852   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00853 }
\DoxyCodeLine{00854   \textcolor{keywordflow}{if} (m\_mouseButton != event.button()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00855 }
\DoxyCodeLine{00856   \textcolor{keywordflow}{if} (m\_current3DDevice != NONE) \{}
\DoxyCodeLine{00857     m\_mouseButton = Qt::NoButton;}
\DoxyCodeLine{00858     m\_tabletEvent = \textcolor{keyword}{false};}
\DoxyCodeLine{00859     m\_pressure    = 0;}
\DoxyCodeLine{00860     \textcolor{keywordflow}{if} (m\_current3DDevice == SIDE\_LEFT\_3D)}
\DoxyCodeLine{00861       set3DLeftSideView();}
\DoxyCodeLine{00862     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_current3DDevice == SIDE\_RIGHT\_3D)}
\DoxyCodeLine{00863       set3DRightSideView();}
\DoxyCodeLine{00864     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_current3DDevice == TOP\_3D)}
\DoxyCodeLine{00865       set3DTopView();}
\DoxyCodeLine{00866     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00867   \}}
\DoxyCodeLine{00868 }
\DoxyCodeLine{00869   \textcolor{keywordflow}{if} (m\_mouseButton == Qt::LeftButton \&\& m\_editPreviewSubCamera) \{}
\DoxyCodeLine{00870     \textcolor{keywordflow}{if} (!PreviewSubCameraManager::instance()-\/>mouseReleaseEvent(\textcolor{keyword}{this}))}
\DoxyCodeLine{00871       \textcolor{keywordflow}{goto} quit;}
\DoxyCodeLine{00872   \}}
\DoxyCodeLine{00873 }
\DoxyCodeLine{00874   \textcolor{keywordflow}{if} (m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a5c7c87c21fafb25dc1ba31ac6574397f}{m\_dragCompareX}} || m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a3458a525867577308cefaf2d33f6639b}{m\_dragCompareY}}) \{}
\DoxyCodeLine{00875     m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a5c7c87c21fafb25dc1ba31ac6574397f}{m\_dragCompareX}} = m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_a3458a525867577308cefaf2d33f6639b}{m\_dragCompareY}} = \textcolor{keyword}{false};}
\DoxyCodeLine{00876     \textcolor{keywordflow}{goto} quit;}
\DoxyCodeLine{00877   \}}
\DoxyCodeLine{00878 }
\DoxyCodeLine{00879   m\_pos = QPointF();}
\DoxyCodeLine{00880   \textcolor{keywordflow}{if} (!tool || !tool-\/>isEnabled()) \textcolor{keywordflow}{goto} quit;}
\DoxyCodeLine{00881 }
\DoxyCodeLine{00882   tool-\/>setViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{00883 }
\DoxyCodeLine{00884   \{}
\DoxyCodeLine{00885     \mbox{\hyperlink{class_t_point_t}{TPointD}} pos = tool-\/>getMatrix().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() *}
\DoxyCodeLine{00886                   winToWorld(event.mousePos() * getDevPixRatio());}
\DoxyCodeLine{00887 }
\DoxyCodeLine{00888     \mbox{\hyperlink{class_t_object_handle}{TObjectHandle}} *objHandle = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a0d91c122eec2b756b7c4780014e49f9e}{getCurrentObject}}();}
\DoxyCodeLine{00889     \textcolor{keywordflow}{if} (tool-\/>getToolType() \& TTool::LevelTool \&\& !objHandle-\/>isSpline()) \{}
\DoxyCodeLine{00890       pos.x /= m\_dpiScale.x;}
\DoxyCodeLine{00891       pos.y /= m\_dpiScale.y;}
\DoxyCodeLine{00892     \}}
\DoxyCodeLine{00893 }
\DoxyCodeLine{00894     \textcolor{keywordflow}{if} (m\_mouseButton == Qt::LeftButton || m\_tabletState == Released) \{}
\DoxyCodeLine{00895       \textcolor{keywordflow}{if} (!m\_toolSwitched) tool-\/>leftButtonUp(pos, event);}
\DoxyCodeLine{00896       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>setToolBusy(\textcolor{keyword}{false});}
\DoxyCodeLine{00897     \}}
\DoxyCodeLine{00898   \}}
\DoxyCodeLine{00899 }
\DoxyCodeLine{00900 quit:}
\DoxyCodeLine{00901   m\_mouseButton = Qt::NoButton;}
\DoxyCodeLine{00902   \textcolor{comment}{// Leave m\_tabletEvent as-\/is in order to check whether the onRelease is called}}
\DoxyCodeLine{00903   \textcolor{comment}{// from tabletEvent or not in mouseReleaseEvent.}}
\DoxyCodeLine{00904   \textcolor{keywordflow}{if} (m\_tabletState == Released)  \textcolor{comment}{// only clear if tabletRelease event}}
\DoxyCodeLine{00905     m\_tabletEvent = \textcolor{keyword}{false};}
\DoxyCodeLine{00906   \textcolor{comment}{// If m\_tabletState is "{}Touched"{}, we've been called by tabletPress event.}}
\DoxyCodeLine{00907   \textcolor{comment}{// Don't clear it out table state so the tablePress event will process}}
\DoxyCodeLine{00908   \textcolor{comment}{// correctly.}}
\DoxyCodeLine{00909   \textcolor{keywordflow}{if} (m\_tabletState != Touched) m\_tabletState = None;}
\DoxyCodeLine{00910   m\_mouseState = None;}
\DoxyCodeLine{00911   m\_tabletMove = \textcolor{keyword}{false};}
\DoxyCodeLine{00912   m\_pressure   = 0;}
\DoxyCodeLine{00913 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_abd3362a77941869edd9ada55709279ad}\label{class_scene_viewer_abd3362a77941869edd9ada55709279ad}} 
\index{SceneViewer@{SceneViewer}!onRenderCompleted@{onRenderCompleted}}
\index{onRenderCompleted@{onRenderCompleted}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onRenderCompleted()}{onRenderCompleted()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Render\+Completed (\begin{DoxyParamCaption}\item[{int}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_previewer_1_1_listener}{Previewer\+::\+Listener}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00882                                              \{}
\DoxyCodeLine{00883   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{00884   emit previewStatusChanged();}
\DoxyCodeLine{00885 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a779d8af0ab00573fb2a3dd925cc2d546}\label{class_scene_viewer_a779d8af0ab00573fb2a3dd925cc2d546}} 
\index{SceneViewer@{SceneViewer}!onRenderStarted@{onRenderStarted}}
\index{onRenderStarted@{onRenderStarted}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onRenderStarted()}{onRenderStarted()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Render\+Started (\begin{DoxyParamCaption}\item[{int}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_previewer_1_1_listener}{Previewer\+::\+Listener}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00878 \{ emit previewStatusChanged(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a5d328a1e864429727d539adb0549ce94}\label{class_scene_viewer_a5d328a1e864429727d539adb0549ce94}} 
\index{SceneViewer@{SceneViewer}!onSceneChanged@{onSceneChanged}}
\index{onSceneChanged@{onSceneChanged}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onSceneChanged}{onSceneChanged}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Scene\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02891                                  \{}
\DoxyCodeLine{02892   onLevelChanged();}
\DoxyCodeLine{02893   \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidateAll}}();}
\DoxyCodeLine{02894 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a950ace4dc4b0afb962fb4884a107d00a}\label{class_scene_viewer_a950ace4dc4b0afb962fb4884a107d00a}} 
\index{SceneViewer@{SceneViewer}!onToolChanged@{onToolChanged}}
\index{onToolChanged@{onToolChanged}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onToolChanged}{onToolChanged}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Tool\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}

when tool options are changed, update tooltip immediately 
\begin{DoxyCode}{0}
\DoxyCodeLine{02914                                 \{}
\DoxyCodeLine{02915   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{02916   \textcolor{keywordflow}{if} (tool) setToolCursor(\textcolor{keyword}{this}, tool-\/>\mbox{\hyperlink{class_t_tool_a1768a57b8b6d1480618fd923fad15f1d}{getCursorId}}());}
\DoxyCodeLine{02917   \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidateAll}}();}
\DoxyCodeLine{02918 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00126}{TApp\+::get\+Current\+Tool()}}, \mbox{\hyperlink{l00438}{TTool\+::get\+Cursor\+Id()}}, \mbox{\hyperlink{l02269}{GLInvalidate\+All()}}, and \mbox{\hyperlink{l00215}{TApp\+::instance()}}.

\mbox{\Hypertarget{class_scene_viewer_a4dbd9c2f6053b706f1ee02c8d3d3ed4d}\label{class_scene_viewer_a4dbd9c2f6053b706f1ee02c8d3d3ed4d}} 
\index{SceneViewer@{SceneViewer}!onToolSwitched@{onToolSwitched}}
\index{onToolSwitched@{onToolSwitched}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onToolSwitched}{onToolSwitched}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Tool\+Switched (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01750                                  \{}
\DoxyCodeLine{01751   m\_forceGlFlush = \textcolor{keyword}{true};}
\DoxyCodeLine{01752   m\_toolSwitched = \textcolor{keyword}{true};}
\DoxyCodeLine{01753   \mbox{\hyperlink{class_scene_viewer_a51e41da45c96d39493ac2753b89d5407}{invalidateToolStatus}}();}
\DoxyCodeLine{01754 }
\DoxyCodeLine{01755   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{01756   \textcolor{keywordflow}{if} (tool) \{}
\DoxyCodeLine{01757     tool-\/>\mbox{\hyperlink{class_t_tool_a1a5f380464a6b36947212e2f8d5b314c}{updateMatrix}}();}
\DoxyCodeLine{01758     \textcolor{keywordflow}{if} (tool-\/>getViewer()) tool-\/>getViewer()-\/>setGuidedStrokePickerMode(0);}
\DoxyCodeLine{01759   \}}
\DoxyCodeLine{01760 }
\DoxyCodeLine{01761   onLevelChanged();}
\DoxyCodeLine{01762   update();}
\DoxyCodeLine{01763 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_aead4b11fab3fec8993abc0679820b948}\label{class_scene_viewer_aead4b11fab3fec8993abc0679820b948}} 
\index{SceneViewer@{SceneViewer}!onXsheetChanged@{onXsheetChanged}}
\index{onXsheetChanged@{onXsheetChanged}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{onXsheetChanged}{onXsheetChanged}}
{\footnotesize\ttfamily void Scene\+Viewer\+::on\+Xsheet\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02872                                   \{}
\DoxyCodeLine{02873   m\_forceGlFlush = \textcolor{keyword}{true};}
\DoxyCodeLine{02874   \mbox{\hyperlink{class_t_tool}{TTool}} *tool    = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{02875   \textcolor{keywordflow}{if} (tool \&\& tool-\/>isEnabled()) tool-\/>\mbox{\hyperlink{class_t_tool_a1a5f380464a6b36947212e2f8d5b314c}{updateMatrix}}();}
\DoxyCodeLine{02876   onLevelChanged();}
\DoxyCodeLine{02877   \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidateAll}}();}
\DoxyCodeLine{02878 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_aa02c109040f40886e29f8e8c89725d91}\label{class_scene_viewer_aa02c109040f40886e29f8e8c89725d91}} 
\index{SceneViewer@{SceneViewer}!paintGL@{paintGL}}
\index{paintGL@{paintGL}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{paintGL()}{paintGL()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::paint\+GL (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01842                           \{}
\DoxyCodeLine{01843 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{01844   \textcolor{keywordflow}{if} (!check\_framebuffer\_status()) \{}
\DoxyCodeLine{01845     \textcolor{comment}{/* QGLWidget の widget 生成/削除のタイミングで(platform によって?)}}
\DoxyCodeLine{01846 \textcolor{comment}{     * GL\_FRAMEBUFFER\_UNDEFINED の状態で paintGL() が呼ばれてしまうようだ */}}
\DoxyCodeLine{01847     \textcolor{keywordflow}{return};}
\DoxyCodeLine{01848   \}}
\DoxyCodeLine{01849 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01850 \textcolor{preprocessor}{\#ifdef MACOSX}}
\DoxyCodeLine{01851   \textcolor{comment}{// following lines are necessary to solve a problem on iMac20}}
\DoxyCodeLine{01852   \textcolor{comment}{// It seems that for some errors in the openGl implementation, buffers are not}}
\DoxyCodeLine{01853   \textcolor{comment}{// set correctly.}}
\DoxyCodeLine{01854   \textcolor{keywordflow}{if} (m\_isMouseEntered \&\& m\_forceGlFlush) \{}
\DoxyCodeLine{01855     m\_isMouseEntered = \textcolor{keyword}{false};}
\DoxyCodeLine{01856     m\_forceGlFlush   = \textcolor{keyword}{false};}
\DoxyCodeLine{01857     glDrawBuffer(GL\_FRONT);}
\DoxyCodeLine{01858     glFlush();}
\DoxyCodeLine{01859     glDrawBuffer(GL\_BACK);}
\DoxyCodeLine{01860   \}}
\DoxyCodeLine{01861 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01862 }
\DoxyCodeLine{01863 \textcolor{preprocessor}{\#ifdef FPS\_HISTOGRAM}}
\DoxyCodeLine{01864   QTime time;}
\DoxyCodeLine{01865   time.start();}
\DoxyCodeLine{01866 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01867 }
\DoxyCodeLine{01868   \textcolor{keywordflow}{if} (!m\_isPicking \&\& m\_lutCalibrator \&\& m\_lutCalibrator-\/>isValid())}
\DoxyCodeLine{01869     m\_fbo-\/>bind();}
\DoxyCodeLine{01870 }
\DoxyCodeLine{01871   \textcolor{keywordflow}{if} (m\_hRuler \&\& m\_vRuler) \{}
\DoxyCodeLine{01872     \textcolor{keywordflow}{if} (!viewRulerToggle.getStatus() \&\&}
\DoxyCodeLine{01873         (m\_hRuler-\/>isVisible() || m\_vRuler-\/>isVisible())) \{}
\DoxyCodeLine{01874       m\_hRuler-\/>hide();}
\DoxyCodeLine{01875       m\_vRuler-\/>hide();}
\DoxyCodeLine{01876     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (viewRulerToggle.getStatus() \&\&}
\DoxyCodeLine{01877                (!m\_hRuler-\/>isVisible() || !m\_vRuler-\/>isVisible())) \{}
\DoxyCodeLine{01878       m\_hRuler-\/>show();}
\DoxyCodeLine{01879       m\_vRuler-\/>show();}
\DoxyCodeLine{01880     \}}
\DoxyCodeLine{01881   \}}
\DoxyCodeLine{01882 }
\DoxyCodeLine{01883   \textcolor{comment}{// Il freezed e' attivo ed e' in stato "{}normale"{}: mostro l'immagine grabbata.}}
\DoxyCodeLine{01884   \textcolor{keywordflow}{if} (m\_freezedStatus == NORMAL\_FREEZED) \{}
\DoxyCodeLine{01885     assert(!!m\_viewGrabImage);}
\DoxyCodeLine{01886     m\_viewGrabImage-\/>lock();}
\DoxyCodeLine{01887     glPushMatrix();}
\DoxyCodeLine{01888     glLoadIdentity();}
\DoxyCodeLine{01889 }
\DoxyCodeLine{01890     glRasterPos2d(0, 0);}
\DoxyCodeLine{01891     glPixelStorei(GL\_UNPACK\_ROW\_LENGTH, 0);}
\DoxyCodeLine{01892 }
\DoxyCodeLine{01893     glDrawPixels(m\_viewGrabImage-\/>getLx(), m\_viewGrabImage-\/>getLy(), TGL\_FMT,}
\DoxyCodeLine{01894                  TGL\_TYPE, m\_viewGrabImage-\/>getRawData());}
\DoxyCodeLine{01895 }
\DoxyCodeLine{01896     glPopMatrix();}
\DoxyCodeLine{01897     m\_viewGrabImage-\/>unlock();}
\DoxyCodeLine{01898 }
\DoxyCodeLine{01899     \textcolor{keywordflow}{if} (!m\_isPicking \&\& m\_lutCalibrator \&\& m\_lutCalibrator-\/>isValid())}
\DoxyCodeLine{01900       m\_lutCalibrator-\/>onEndDraw(m\_fbo);}
\DoxyCodeLine{01901 }
\DoxyCodeLine{01902     \textcolor{keywordflow}{return};}
\DoxyCodeLine{01903   \}}
\DoxyCodeLine{01904 }
\DoxyCodeLine{01905   drawBuildVars();}
\DoxyCodeLine{01906 }
\DoxyCodeLine{01907   \textcolor{comment}{// This seems not to be necessary for now.}}
\DoxyCodeLine{01908   \textcolor{comment}{// copyFrontBufferToBackBuffer();}}
\DoxyCodeLine{01909 }
\DoxyCodeLine{01910   drawEnableScissor();}
\DoxyCodeLine{01911   drawBackground();}
\DoxyCodeLine{01912 }
\DoxyCodeLine{01913   \textcolor{keywordflow}{if} (m\_previewMode != FULL\_PREVIEW) \{}
\DoxyCodeLine{01914     drawCameraStand();}
\DoxyCodeLine{01915   \}}
\DoxyCodeLine{01916 }
\DoxyCodeLine{01917   \textcolor{keywordflow}{if} (isPreviewEnabled()) drawPreview();}
\DoxyCodeLine{01918 }
\DoxyCodeLine{01919   \mbox{\hyperlink{class_scene_viewer_a7f65aa9285528e26a555615fd8693128}{drawOverlay}}();}
\DoxyCodeLine{01920 }
\DoxyCodeLine{01921   drawDisableScissor();}
\DoxyCodeLine{01922 }
\DoxyCodeLine{01923   \textcolor{comment}{// Il freezed e' attivo ed e' in stato "{}update"{}: faccio il grab del viewer.}}
\DoxyCodeLine{01924   \textcolor{keywordflow}{if} (m\_freezedStatus == UPDATE\_FREEZED) \{}
\DoxyCodeLine{01925     m\_viewGrabImage = rasterFromQImage(grabFramebuffer());}
\DoxyCodeLine{01926     m\_freezedStatus = NORMAL\_FREEZED;}
\DoxyCodeLine{01927   \}}
\DoxyCodeLine{01928 }
\DoxyCodeLine{01929 \textcolor{preprocessor}{\#ifdef FPS\_HISTOGRAM}}
\DoxyCodeLine{01930   \textcolor{keywordtype}{int} t0 = time.elapsed();}
\DoxyCodeLine{01931   glFlush();}
\DoxyCodeLine{01932   glFinish();}
\DoxyCodeLine{01933   \textcolor{keywordtype}{int} t1 = time.elapsed();}
\DoxyCodeLine{01934   drawFpsGraph(t0, t1);}
\DoxyCodeLine{01935 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01936   \textcolor{comment}{// TOfflineGL::setContextManager(0);}}
\DoxyCodeLine{01937 }
\DoxyCodeLine{01938   \textcolor{keywordflow}{if} (!m\_isPicking \&\& m\_lutCalibrator \&\& m\_lutCalibrator-\/>isValid())}
\DoxyCodeLine{01939     m\_lutCalibrator-\/>onEndDraw(m\_fbo);}
\DoxyCodeLine{01940 }
\DoxyCodeLine{01941   \textcolor{comment}{// wait to achieve precise fps}}
\DoxyCodeLine{01942   \textcolor{keywordflow}{if} (m\_timer \&\& m\_timer-\/>isValid()) \{}
\DoxyCodeLine{01943     qint64 currentInstant = m\_timer-\/>nsecsElapsed();}
\DoxyCodeLine{01944     \textcolor{keywordflow}{while} (currentInstant < m\_targetInstant) \{}
\DoxyCodeLine{01945       currentInstant = m\_timer-\/>nsecsElapsed();}
\DoxyCodeLine{01946     \}}
\DoxyCodeLine{01947   \}}
\DoxyCodeLine{01948 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_afa2e6bab02b6f9719b262b3f38d8f86f}\label{class_scene_viewer_afa2e6bab02b6f9719b262b3f38d8f86f}} 
\index{SceneViewer@{SceneViewer}!pan@{pan}}
\index{pan@{pan}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{pan()}{pan()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::pan (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{delta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00375 \{ panQt(QPointF(delta.x, delta.y)); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a1b750121ec0e522ef3c43decb62ec86d}\label{class_scene_viewer_a1b750121ec0e522ef3c43decb62ec86d}} 
\index{SceneViewer@{SceneViewer}!panQt@{panQt}}
\index{panQt@{panQt}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{panQt()}{panQt()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::pan\+Qt (\begin{DoxyParamCaption}\item[{const QPointF \&}]{delta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02302                                             \{}
\DoxyCodeLine{02303   \textcolor{keywordflow}{if} (delta == QPointF()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{02304   \textcolor{keywordflow}{if} (is3DView())}
\DoxyCodeLine{02305     m\_pan3D += \mbox{\hyperlink{class_t_point_t}{TPointD}}(delta.x(), -\/delta.y());}
\DoxyCodeLine{02306   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02307     \textcolor{comment}{// TAffine \&viewAff = m\_viewAff[m\_viewMode];}}
\DoxyCodeLine{02308     \textcolor{comment}{// viewAff = TTranslation(delta.x(), -\/delta.y()) * viewAff;}}
\DoxyCodeLine{02309     setViewMatrix(\mbox{\hyperlink{class_t_translation}{TTranslation}}(delta.x(), -\/delta.y()) * m\_viewAff[m\_viewMode],}
\DoxyCodeLine{02310                   m\_viewMode);}
\DoxyCodeLine{02311   \}}
\DoxyCodeLine{02312   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{02313   emit refreshNavi();}
\DoxyCodeLine{02314 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a1163bd98365b4eb35ce09634ea16aff6}\label{class_scene_viewer_a1163bd98365b4eb35ce09634ea16aff6}} 
\index{SceneViewer@{SceneViewer}!pick@{pick}}
\index{pick@{pick}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{pick()}{pick()}}
{\footnotesize\ttfamily int Scene\+Viewer\+::pick (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{point }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

return the column index of the drawing intersecting point {\bfseries{p}} (window coordinate, pixels, bottom-\/left origin) 

Implements \mbox{\hyperlink{class_t_tool_1_1_viewer_a25c39c87c36587cf9cb0fdc09c59e6d4}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02922                                           \{}
\DoxyCodeLine{02923   \textcolor{comment}{// pick is typically called in a mouse event handler.}}
\DoxyCodeLine{02924   \textcolor{comment}{// QGLWidget::makeCurrent() is not automatically called in these events.}}
\DoxyCodeLine{02925   \textcolor{comment}{// (to exploit the bug: open the FxEditor preview and then select the edit}}
\DoxyCodeLine{02926   \textcolor{comment}{// tool)}}
\DoxyCodeLine{02927   m\_isPicking = \textcolor{keyword}{true};}
\DoxyCodeLine{02928   makeCurrent();}
\DoxyCodeLine{02929   assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{02930   GLint viewport[4];}
\DoxyCodeLine{02931   glGetIntegerv(GL\_VIEWPORT, viewport);}
\DoxyCodeLine{02932   std::array<GLuint, 512> selectBuffer;}
\DoxyCodeLine{02933   glSelectBuffer(selectBuffer.size(), selectBuffer.data());}
\DoxyCodeLine{02934   glRenderMode(GL\_SELECT);}
\DoxyCodeLine{02935 }
\DoxyCodeLine{02936   \textcolor{comment}{// definisco la matrice di proiezione}}
\DoxyCodeLine{02937   glMatrixMode(GL\_PROJECTION);}
\DoxyCodeLine{02938   GLdouble mat[16];}
\DoxyCodeLine{02939   glGetDoublev(GL\_PROJECTION\_MATRIX, mat);}
\DoxyCodeLine{02940   glPushMatrix();}
\DoxyCodeLine{02941   glLoadIdentity();}
\DoxyCodeLine{02942   gluPickMatrix(point.x, point.y, 5, 5, viewport);}
\DoxyCodeLine{02943   glMultMatrixd(mat);}
\DoxyCodeLine{02944   assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{02945 }
\DoxyCodeLine{02946   \textcolor{comment}{// disegno la scena}}
\DoxyCodeLine{02947   glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{02948   glPushMatrix();}
\DoxyCodeLine{02949   glInitNames();}
\DoxyCodeLine{02950   assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{02951 }
\DoxyCodeLine{02952   \textcolor{comment}{// WARNING: We have to draw the scene in CAMERASTAND mode. Observe that the}}
\DoxyCodeLine{02953   \textcolor{comment}{// preview mode may}}
\DoxyCodeLine{02954   \textcolor{comment}{// invoke event processing -\/ therefore triggering other pick events while in}}
\DoxyCodeLine{02955   \textcolor{comment}{// GL\_SELECT}}
\DoxyCodeLine{02956   \textcolor{comment}{// render mode...}}
\DoxyCodeLine{02957   \textcolor{keywordtype}{int} previewMode = m\_previewMode;}
\DoxyCodeLine{02958   m\_previewMode   = NO\_PREVIEW;}
\DoxyCodeLine{02959 }
\DoxyCodeLine{02960   \textcolor{comment}{//   OPTIMIZATION / QUICK FIX}}
\DoxyCodeLine{02961   \textcolor{comment}{// A 1x1 clipping rect around the picked pos can very well be used instead of}}
\DoxyCodeLine{02962   \textcolor{comment}{// redrawing}}
\DoxyCodeLine{02963   \textcolor{comment}{// the *entire viewer*.}}
\DoxyCodeLine{02964   \textcolor{comment}{// This is needed especially since some graphic cards (all NVidias we have}}
\DoxyCodeLine{02965   \textcolor{comment}{// tested) are}}
\DoxyCodeLine{02966   \textcolor{comment}{// very slow otherwise. This could be due to this particular rendering mode -\/}}
\DoxyCodeLine{02967   \textcolor{comment}{// or because}}
\DoxyCodeLine{02968   \textcolor{comment}{// we could be painting OUTSIDE a paintEvent()...}}
\DoxyCodeLine{02969 }
\DoxyCodeLine{02970   \mbox{\hyperlink{class_t_rect_t}{TRectD}} oldClipRect(m\_clipRect);}
\DoxyCodeLine{02971   m\_clipRect = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(point.x, point.y, point.x + 1, point.y + 1);}
\DoxyCodeLine{02972 }
\DoxyCodeLine{02973   paintGL();  \textcolor{comment}{// draw identifiable objects}}
\DoxyCodeLine{02974 }
\DoxyCodeLine{02975   m\_clipRect = oldClipRect;}
\DoxyCodeLine{02976 }
\DoxyCodeLine{02977   m\_previewMode = previewMode;}
\DoxyCodeLine{02978 }
\DoxyCodeLine{02979   assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{02980   glPopMatrix();}
\DoxyCodeLine{02981 }
\DoxyCodeLine{02982   \textcolor{comment}{// rimetto a posto la matrice di proiezione}}
\DoxyCodeLine{02983   glMatrixMode(GL\_PROJECTION);}
\DoxyCodeLine{02984   glPopMatrix();}
\DoxyCodeLine{02985   glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{02986 }
\DoxyCodeLine{02987   assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{02988 }
\DoxyCodeLine{02989   \textcolor{comment}{// conto gli hits}}
\DoxyCodeLine{02990   \textcolor{keywordtype}{int} ret      = -\/1;}
\DoxyCodeLine{02991   \textcolor{keywordtype}{int} hitCount = glRenderMode(GL\_RENDER);}
\DoxyCodeLine{02992   GLuint *p    = selectBuffer.data();}
\DoxyCodeLine{02993   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < hitCount; ++i) \{}
\DoxyCodeLine{02994     GLuint nameCount = *p++;}
\DoxyCodeLine{02995     GLuint zmin      = *p++;}
\DoxyCodeLine{02996     GLuint zmax      = *p++;}
\DoxyCodeLine{02997     \textcolor{keywordflow}{if} (nameCount > 0) \{}
\DoxyCodeLine{02998       GLuint name = *p;}
\DoxyCodeLine{02999       ret         = name;  \textcolor{comment}{// items.push\_back(PickItem(name, zmin, zmax));}}
\DoxyCodeLine{03000     \}}
\DoxyCodeLine{03001     p += nameCount;}
\DoxyCodeLine{03002   \}}
\DoxyCodeLine{03003   assert(glGetError() == GL\_NO\_ERROR);}
\DoxyCodeLine{03004   m\_isPicking = \textcolor{keyword}{false};}
\DoxyCodeLine{03005   \textcolor{keywordflow}{return} ret;}
\DoxyCodeLine{03006 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_af778bc35f05229be9939d407b964ad9d}\label{class_scene_viewer_af778bc35f05229be9939d407b964ad9d}} 
\index{SceneViewer@{SceneViewer}!posToColumnIndex@{posToColumnIndex}}
\index{posToColumnIndex@{posToColumnIndex}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{posToColumnIndex()}{posToColumnIndex()}}
{\footnotesize\ttfamily int Scene\+Viewer\+::pos\+To\+Column\+Index (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p,  }\item[{double}]{distance,  }\item[{bool}]{include\+Invisible = {\ttfamily true} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

return the column indexes of the drawings intersecting point {\bfseries{p}} (window coordinate, pixels, bottom-\/left origin) 

Implements \mbox{\hyperlink{class_t_tool_1_1_viewer_a39e1e08bc287e5ca5a9ff6e7ac968ca2}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03011                                                                \{}
\DoxyCodeLine{03012   std::vector<int> ret;}
\DoxyCodeLine{03013   posToColumnIndexes(p, ret, distance, includeInvisible);}
\DoxyCodeLine{03014   \textcolor{keywordflow}{return} ret.empty() ? -\/1 : ret.back();}
\DoxyCodeLine{03015 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_adc621b10faeca523c68f80bc50a9939e}\label{class_scene_viewer_adc621b10faeca523c68f80bc50a9939e}} 
\index{SceneViewer@{SceneViewer}!posToColumnIndexes@{posToColumnIndexes}}
\index{posToColumnIndexes@{posToColumnIndexes}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{posToColumnIndexes()}{posToColumnIndexes()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::pos\+To\+Column\+Indexes (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p,  }\item[{std\+::vector$<$ int $>$ \&}]{indexes,  }\item[{double}]{distance,  }\item[{bool}]{include\+Invisible = {\ttfamily true} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03021                                                                   \{}
\DoxyCodeLine{03022   \textcolor{keywordtype}{int} oldRasterizePli    = TXshSimpleLevel::m\_rasterizePli;}
\DoxyCodeLine{03023   \mbox{\hyperlink{class_t_app}{TApp}} *app              = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{03024   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene      = app-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{03025   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh           = app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet();}
\DoxyCodeLine{03026   \textcolor{keywordtype}{int} frame              = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{03027   \textcolor{keywordtype}{int} currentColumnIndex = app-\/>\mbox{\hyperlink{class_t_app_a1e294e7cff300851d12a8c3d196943f6}{getCurrentColumn}}()-\/>getColumnIndex();}
\DoxyCodeLine{03028   \mbox{\hyperlink{class_onion_skin_mask}{OnionSkinMask}} osm      = app-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>getOnionSkinMask();}
\DoxyCodeLine{03029 }
\DoxyCodeLine{03030   \mbox{\hyperlink{class_t_point_t}{TPointD}} pos = \mbox{\hyperlink{class_t_point_t}{TPointD}}(p.x -\/ width() / 2, p.y -\/ height() / 2);}
\DoxyCodeLine{03031   \mbox{\hyperlink{class_stage_1_1_picker}{Stage::Picker}} picker(\mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}(), pos, \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}},}
\DoxyCodeLine{03032                        getDevPixRatio());}
\DoxyCodeLine{03033   picker.setMinimumDistance(distance);}
\DoxyCodeLine{03034 }
\DoxyCodeLine{03035   TXshSimpleLevel::m\_rasterizePli = 0;}
\DoxyCodeLine{03036 }
\DoxyCodeLine{03037   \mbox{\hyperlink{struct_stage_1_1_visit_args}{Stage::VisitArgs}} args;}
\DoxyCodeLine{03038   args.m\_scene       = scene;}
\DoxyCodeLine{03039   args.m\_xsh         = xsh;}
\DoxyCodeLine{03040   args.m\_row         = frame;}
\DoxyCodeLine{03041   args.m\_col         = currentColumnIndex;}
\DoxyCodeLine{03042   args.m\_osm         = \&osm;}
\DoxyCodeLine{03043   args.m\_onlyVisible = includeInvisible;}
\DoxyCodeLine{03044 }
\DoxyCodeLine{03045   \mbox{\hyperlink{namespace_stage_a28ab15860508cccd59a31483a9b8afa1}{Stage::visit}}(picker, args); \textcolor{comment}{/*}}
\DoxyCodeLine{03046 \textcolor{comment}{picker,}}
\DoxyCodeLine{03047 \textcolor{comment}{scene,}}
\DoxyCodeLine{03048 \textcolor{comment}{xsh,}}
\DoxyCodeLine{03049 \textcolor{comment}{frame,}}
\DoxyCodeLine{03050 \textcolor{comment}{currentColumnIndex,}}
\DoxyCodeLine{03051 \textcolor{comment}{osm,}}
\DoxyCodeLine{03052 \textcolor{comment}{false,}}
\DoxyCodeLine{03053 \textcolor{comment}{0,}}
\DoxyCodeLine{03054 \textcolor{comment}{false,}}
\DoxyCodeLine{03055 \textcolor{comment}{includeInvisible);}}
\DoxyCodeLine{03056 \textcolor{comment}{*/}}
\DoxyCodeLine{03057 }
\DoxyCodeLine{03058   TXshSimpleLevel::m\_rasterizePli = oldRasterizePli;}
\DoxyCodeLine{03059   picker.getColumnIndexes(indexes);}
\DoxyCodeLine{03060 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_aa2973e9567ddbbfd62d853f96ba26c7a}\label{class_scene_viewer_aa2973e9567ddbbfd62d853f96ba26c7a}} 
\index{SceneViewer@{SceneViewer}!posToRow@{posToRow}}
\index{posToRow@{posToRow}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{posToRow()}{posToRow()}}
{\footnotesize\ttfamily int Scene\+Viewer\+::pos\+To\+Row (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p,  }\item[{double}]{distance,  }\item[{bool}]{include\+Invisible = {\ttfamily true},  }\item[{bool}]{current\+Column\+Only = {\ttfamily false} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

return the row of the drawings intersecting point {\bfseries{p}} (used with onion skins) (window coordinate, pixels, bottom-\/left origin) 

Implements \mbox{\hyperlink{class_t_tool_1_1_viewer_aa68aee09530696a8996e835801ea59f2}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03065                                                                                \{}
\DoxyCodeLine{03066   \textcolor{keywordtype}{int} oldRasterizePli = TXshSimpleLevel::m\_rasterizePli;}
\DoxyCodeLine{03067   \mbox{\hyperlink{class_t_app}{TApp}} *app           = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{03068   \mbox{\hyperlink{class_onion_skin_mask}{OnionSkinMask}} osm   = app-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}()-\/>getOnionSkinMask();}
\DoxyCodeLine{03069 }
\DoxyCodeLine{03070   \mbox{\hyperlink{class_t_point_t}{TPointD}} pos = \mbox{\hyperlink{class_t_point_t}{TPointD}}(p.x -\/ width() / 2, p.y -\/ height() / 2);}
\DoxyCodeLine{03071   \mbox{\hyperlink{class_stage_1_1_picker}{Stage::Picker}} picker(\mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}(), pos, \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}},}
\DoxyCodeLine{03072                        getDevPixRatio());}
\DoxyCodeLine{03073   picker.setMinimumDistance(distance);}
\DoxyCodeLine{03074 }
\DoxyCodeLine{03075   \textcolor{keywordflow}{if} (app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isEditingLevel()) \{}
\DoxyCodeLine{03076     \mbox{\hyperlink{namespace_stage_a28ab15860508cccd59a31483a9b8afa1}{Stage::visit}}(picker, app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel(),}
\DoxyCodeLine{03077                  app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFid(), osm,}
\DoxyCodeLine{03078                  app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isPlaying(), \textcolor{keyword}{false});}
\DoxyCodeLine{03079   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{03080     \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene      = app-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{03081     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh           = app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet();}
\DoxyCodeLine{03082     \textcolor{keywordtype}{int} frame              = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{03083     \textcolor{keywordtype}{int} currentColumnIndex = app-\/>\mbox{\hyperlink{class_t_app_a1e294e7cff300851d12a8c3d196943f6}{getCurrentColumn}}()-\/>getColumnIndex();}
\DoxyCodeLine{03084 }
\DoxyCodeLine{03085     TXshSimpleLevel::m\_rasterizePli = 0;}
\DoxyCodeLine{03086 }
\DoxyCodeLine{03087     \mbox{\hyperlink{struct_stage_1_1_visit_args}{Stage::VisitArgs}} args;}
\DoxyCodeLine{03088     args.m\_scene       = scene;}
\DoxyCodeLine{03089     args.m\_xsh         = xsh;}
\DoxyCodeLine{03090     args.m\_row         = frame;}
\DoxyCodeLine{03091     args.m\_col         = currentColumnIndex;}
\DoxyCodeLine{03092     args.m\_osm         = \&osm;}
\DoxyCodeLine{03093     args.m\_onlyVisible = includeInvisible;}
\DoxyCodeLine{03094 }
\DoxyCodeLine{03095     \textcolor{keywordflow}{if} (currentColumnOnly) picker.setCurrentColumnIndex(currentColumnIndex);}
\DoxyCodeLine{03096 }
\DoxyCodeLine{03097     \mbox{\hyperlink{namespace_stage_a28ab15860508cccd59a31483a9b8afa1}{Stage::visit}}(picker, args);}
\DoxyCodeLine{03098   \}}
\DoxyCodeLine{03099   TXshSimpleLevel::m\_rasterizePli = oldRasterizePli;}
\DoxyCodeLine{03100   \textcolor{keywordflow}{return} picker.getRow();}
\DoxyCodeLine{03101 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00118}{TApp\+::get\+Current\+Column()}}, \mbox{\hyperlink{l00114}{TApp\+::get\+Current\+Frame()}}, \mbox{\hyperlink{l00122}{TApp\+::get\+Current\+Level()}}, \mbox{\hyperlink{l00140}{TApp\+::get\+Current\+Onion\+Skin()}}, \mbox{\hyperlink{l00106}{TApp\+::get\+Current\+Scene()}}, \mbox{\hyperlink{l00110}{TApp\+::get\+Current\+Xsheet()}}, \mbox{\hyperlink{l02211}{get\+View\+Matrix()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, \mbox{\hyperlink{l00592}{TTool\+::\+Viewer\+::m\+\_\+visual\+Settings}}, and \mbox{\hyperlink{l00911}{Stage\+::visit()}}.

\mbox{\Hypertarget{class_scene_viewer_a1baf121661d1bbabbb869411e4687a4d}\label{class_scene_viewer_a1baf121661d1bbabbb869411e4687a4d}} 
\index{SceneViewer@{SceneViewer}!projectToZ@{projectToZ}}
\index{projectToZ@{projectToZ}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{projectToZ()}{projectToZ()}}
{\footnotesize\ttfamily double Scene\+Viewer\+::project\+ToZ (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{delta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02158                                                    \{}
\DoxyCodeLine{02159   glPushMatrix();}
\DoxyCodeLine{02160   mult3DMatrix();}
\DoxyCodeLine{02161   GLint viewport[4];}
\DoxyCodeLine{02162   \textcolor{keywordtype}{double} modelview[16], \mbox{\hyperlink{namespacetcg_1_1point__ops_a9649a6ac6d347e067adc06325fc07a7f}{projection}}[16];}
\DoxyCodeLine{02163   glGetIntegerv(GL\_VIEWPORT, viewport);}
\DoxyCodeLine{02164   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 16; i++)}
\DoxyCodeLine{02165     projection[i] = (\textcolor{keywordtype}{double})m\_projectionMatrix.constData()[i];}
\DoxyCodeLine{02166   glGetDoublev(GL\_MODELVIEW\_MATRIX, modelview);}
\DoxyCodeLine{02167 }
\DoxyCodeLine{02168   \textcolor{keywordtype}{double} ax, ay, az, bx, by, bz;}
\DoxyCodeLine{02169   gluProject(0, 0, 0, modelview, projection, viewport, \&ax, \&ay, \&az);}
\DoxyCodeLine{02170   gluProject(0, 0, 1, modelview, projection, viewport, \&bx, \&by, \&bz);}
\DoxyCodeLine{02171 }
\DoxyCodeLine{02172   glPopMatrix();}
\DoxyCodeLine{02173   \mbox{\hyperlink{class_t_point_t}{TPointD}} zdir(bx -\/ ax, by -\/ ay);}
\DoxyCodeLine{02174   \textcolor{keywordtype}{double} zdirLength2 = norm2(zdir);}
\DoxyCodeLine{02175   \textcolor{keywordflow}{if} (zdirLength2 > 0.0) \{}
\DoxyCodeLine{02176     \textcolor{keywordtype}{double} dz = (delta * zdir) / zdirLength2;}
\DoxyCodeLine{02177     \textcolor{keywordflow}{return} dz;}
\DoxyCodeLine{02178   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{02179     \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{02180 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a240af6e63f2de67f32661dead9763b0b}\label{class_scene_viewer_a240af6e63f2de67f32661dead9763b0b}} 
\index{SceneViewer@{SceneViewer}!regeneratePreview@{regeneratePreview}}
\index{regeneratePreview@{regeneratePreview}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{regeneratePreview}{regeneratePreview}}
{\footnotesize\ttfamily void Scene\+Viewer\+::regenerate\+Preview (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02614                                     \{}
\DoxyCodeLine{02615   \mbox{\hyperlink{class_previewer_a5eb765b66490a3d99d432f90864bfacd}{Previewer::instance}}(m\_previewMode == SUBCAMERA\_PREVIEW)-\/>clear();}
\DoxyCodeLine{02616   update();}
\DoxyCodeLine{02617 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a6cb8080e8128fb721c2517ae938994b0}\label{class_scene_viewer_a6cb8080e8128fb721c2517ae938994b0}} 
\index{SceneViewer@{SceneViewer}!regeneratePreviewFrame@{regeneratePreviewFrame}}
\index{regeneratePreviewFrame@{regeneratePreviewFrame}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{regeneratePreviewFrame}{regeneratePreviewFrame}}
{\footnotesize\ttfamily void Scene\+Viewer\+::regenerate\+Preview\+Frame (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02621                                          \{}
\DoxyCodeLine{02622   \mbox{\hyperlink{class_previewer_a5eb765b66490a3d99d432f90864bfacd}{Previewer::instance}}(m\_previewMode == SUBCAMERA\_PREVIEW)}
\DoxyCodeLine{02623       -\/>clear(\mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getCurrentFrame()-\/>getFrame());}
\DoxyCodeLine{02624 }
\DoxyCodeLine{02625   update();}
\DoxyCodeLine{02626 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_aa48b27ed062e2d8a0e98566adcad6084}\label{class_scene_viewer_aa48b27ed062e2d8a0e98566adcad6084}} 
\index{SceneViewer@{SceneViewer}!registerContext@{registerContext}}
\index{registerContext@{registerContext}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{registerContext()}{registerContext()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::register\+Context (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{03306                                   \{}
\DoxyCodeLine{03307   \textcolor{comment}{// release the old context, if any}}
\DoxyCodeLine{03308   \textcolor{comment}{// this will be happen when dock / float the viewer panel.}}
\DoxyCodeLine{03309   \textcolor{keywordtype}{bool} hasOldContext;}
\DoxyCodeLine{03310 \textcolor{preprocessor}{\#ifdef \_WIN32}}
\DoxyCodeLine{03311   hasOldContext =}
\DoxyCodeLine{03312       (m\_currentContext.first != \textcolor{keyword}{nullptr} \&\& m\_currentContext.second != \textcolor{keyword}{nullptr});}
\DoxyCodeLine{03313 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03314   hasOldContext = m\_currentContext != \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03315 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03316   \textcolor{keywordflow}{if} (hasOldContext) \{}
\DoxyCodeLine{03317     \textcolor{keywordtype}{int} ret = l\_contexts.erase(m\_currentContext);}
\DoxyCodeLine{03318     \textcolor{keywordflow}{if} (ret)}
\DoxyCodeLine{03319       TGLDisplayListsManager::instance()-\/>\mbox{\hyperlink{class_t_g_l_display_lists_manager_a9b723e490c97425b39b238a2d7ad5877}{releaseContext}}(m\_currentContext);}
\DoxyCodeLine{03320   \}}
\DoxyCodeLine{03321 }
\DoxyCodeLine{03322   \textcolor{comment}{// then, register context and the space Id correspondent to it.}}
\DoxyCodeLine{03323   \textcolor{keywordtype}{int} displayListId;}
\DoxyCodeLine{03324   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getMainWindow() \&\&}
\DoxyCodeLine{03325       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getMainWindow()-\/>isAncestorOf(\textcolor{keyword}{this}) \&\&}
\DoxyCodeLine{03326       QThread::currentThread() == qGuiApp-\/>thread()) \{}
\DoxyCodeLine{03327     \textcolor{comment}{// obtain displaySpaceId for main thread}}
\DoxyCodeLine{03328     \textcolor{keywordflow}{if} (l\_mainDisplayListsSpaceId == -\/1)}
\DoxyCodeLine{03329       l\_mainDisplayListsSpaceId =}
\DoxyCodeLine{03330           TGLDisplayListsManager::instance()-\/>\mbox{\hyperlink{class_t_g_l_display_lists_manager_ae2b9d27f1f22373a4d14d4ce7fc1b484}{storeProxy}}(\textcolor{keyword}{new} DummyProxy);}
\DoxyCodeLine{03331 }
\DoxyCodeLine{03332     displayListId = l\_mainDisplayListsSpaceId;}
\DoxyCodeLine{03333   \}}
\DoxyCodeLine{03334   \textcolor{comment}{// for the other cases (such as for floating viewer), it can't share the}}
\DoxyCodeLine{03335   \textcolor{comment}{// context so}}
\DoxyCodeLine{03336   \textcolor{comment}{// obtain different id}}
\DoxyCodeLine{03337   \textcolor{keywordflow}{else}}
\DoxyCodeLine{03338     displayListId =}
\DoxyCodeLine{03339         TGLDisplayListsManager::instance()-\/>\mbox{\hyperlink{class_t_g_l_display_lists_manager_ae2b9d27f1f22373a4d14d4ce7fc1b484}{storeProxy}}(\textcolor{keyword}{new} DummyProxy);}
\DoxyCodeLine{03340   TGlContext tglContext(tglGetCurrentContext());}
\DoxyCodeLine{03341   TGLDisplayListsManager::instance()-\/>\mbox{\hyperlink{class_t_g_l_display_lists_manager_ab755606608fb45cc60b01e14396fd20b}{attachContext}}(displayListId, tglContext);}
\DoxyCodeLine{03342   l\_contexts.insert(tglContext);}
\DoxyCodeLine{03343 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ad4ab9fcfdf2823447ed005ec1cc95fc8}\label{class_scene_viewer_ad4ab9fcfdf2823447ed005ec1cc95fc8}} 
\index{SceneViewer@{SceneViewer}!releaseBusyOnTabletMove@{releaseBusyOnTabletMove}}
\index{releaseBusyOnTabletMove@{releaseBusyOnTabletMove}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{releaseBusyOnTabletMove}{releaseBusyOnTabletMove}}
{\footnotesize\ttfamily void Scene\+Viewer\+::release\+Busy\+On\+Tablet\+Move (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00455 \{ m\_isBusyOnTabletMove = \textcolor{keyword}{false}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ae331d555c43f941e0d5576fefc5f8774}\label{class_scene_viewer_ae331d555c43f941e0d5576fefc5f8774}} 
\index{SceneViewer@{SceneViewer}!releaseFBO@{releaseFBO}}
\index{releaseFBO@{releaseFBO}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{releaseFBO()}{releaseFBO()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::release\+FBO (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03288                              \{}
\DoxyCodeLine{03289   \textcolor{keywordflow}{if} (m\_fbo) m\_fbo-\/>release();}
\DoxyCodeLine{03290 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a8f6aba7f3c756ab3f44b6d3c706098df}\label{class_scene_viewer_a8f6aba7f3c756ab3f44b6d3c706098df}} 
\index{SceneViewer@{SceneViewer}!resetInputMethod@{resetInputMethod}}
\index{resetInputMethod@{resetInputMethod}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{resetInputMethod()}{resetInputMethod()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::reset\+Input\+Method (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03188                                    \{}
\DoxyCodeLine{03189 \textcolor{preprocessor}{\#if QT\_VERSION >= 0x050000}}
\DoxyCodeLine{03190   QGuiApplication::inputMethod()-\/>reset();}
\DoxyCodeLine{03191 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03192   qApp-\/>inputContext()-\/>reset();}
\DoxyCodeLine{03193 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03194 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ae8e0eddc3c301fbbcead3dc55188e8c4}\label{class_scene_viewer_ae8e0eddc3c301fbbcead3dc55188e8c4}} 
\index{SceneViewer@{SceneViewer}!resetPosition@{resetPosition}}
\index{resetPosition@{resetPosition}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{resetPosition}{resetPosition}}
{\footnotesize\ttfamily void Scene\+Viewer\+::reset\+Position (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02787                                 \{}
\DoxyCodeLine{02788   m\_viewAff[m\_viewMode].a13 = 0.0;}
\DoxyCodeLine{02789   m\_viewAff[m\_viewMode].a23 = 0.0;}
\DoxyCodeLine{02790   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{02791 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a1b5067774331d9aae76bce92a2088614}\label{class_scene_viewer_a1b5067774331d9aae76bce92a2088614}} 
\index{SceneViewer@{SceneViewer}!resetRotation@{resetRotation}}
\index{resetRotation@{resetRotation}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{resetRotation}{resetRotation}}
{\footnotesize\ttfamily void Scene\+Viewer\+::reset\+Rotation (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02771                                 \{}
\DoxyCodeLine{02772   \textcolor{keywordtype}{double} reverseRotatation = m\_rotationAngle[m\_viewMode] * -\/1;}
\DoxyCodeLine{02773   \textcolor{keywordflow}{if} (m\_isFlippedX) reverseRotatation *= -\/1;}
\DoxyCodeLine{02774   \textcolor{keywordflow}{if} (m\_isFlippedY) reverseRotatation *= -\/1;}
\DoxyCodeLine{02775   \mbox{\hyperlink{class_t_tool}{TTool}} *tool    = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{02776   \mbox{\hyperlink{class_t_point_t}{TPointD}} center = m\_viewAff[m\_viewMode].inv() * \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0);}
\DoxyCodeLine{02777   \textcolor{keywordflow}{if} (tool-\/>getName() == \textcolor{stringliteral}{"{}T\_Rotate"{}} \&\&}
\DoxyCodeLine{02778       tool-\/>getProperties(0)}
\DoxyCodeLine{02779               -\/>\mbox{\hyperlink{class_t_property_group_afb08f3145e5f77da6f163cdc9decad2f}{getProperty}}(\textcolor{stringliteral}{"{}Rotate On Camera Center"{}})}
\DoxyCodeLine{02780               -\/>getValueAsString() == \textcolor{stringliteral}{"{}1"{}})}
\DoxyCodeLine{02781     center = \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0);}
\DoxyCodeLine{02782   rotate(center, reverseRotatation);}
\DoxyCodeLine{02783 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a486ab2b8322a8922ccda934272da2bc1}\label{class_scene_viewer_a486ab2b8322a8922ccda934272da2bc1}} 
\index{SceneViewer@{SceneViewer}!resetSceneViewer@{resetSceneViewer}}
\index{resetSceneViewer@{resetSceneViewer}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{resetSceneViewer}{resetSceneViewer}}
{\footnotesize\ttfamily void Scene\+Viewer\+::reset\+Scene\+Viewer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02731                                    \{}
\DoxyCodeLine{02732   \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_ab6461a28653bae19432d998149564b43}{m\_sceneProperties}} =}
\DoxyCodeLine{02733       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}();}
\DoxyCodeLine{02734 }
\DoxyCodeLine{02735   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < m\_viewAff.size(); ++i) \{}
\DoxyCodeLine{02736     setViewMatrix(getNormalZoomScale(), i);}
\DoxyCodeLine{02737     m\_rotationAngle[i] = 0.0;}
\DoxyCodeLine{02738   \}}
\DoxyCodeLine{02739 }
\DoxyCodeLine{02740   m\_pos         = QPoint(0, 0);}
\DoxyCodeLine{02741   m\_pan3D       = \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0);}
\DoxyCodeLine{02742   m\_zoomScale3D = 0.1;}
\DoxyCodeLine{02743   m\_theta3D     = 20;}
\DoxyCodeLine{02744   m\_phi3D       = 30;}
\DoxyCodeLine{02745   m\_isFlippedX  = \textcolor{keyword}{false};}
\DoxyCodeLine{02746   m\_isFlippedY  = \textcolor{keyword}{false};}
\DoxyCodeLine{02747   fitToCameraOutline();}
\DoxyCodeLine{02748   emit onZoomChanged();}
\DoxyCodeLine{02749   emit onFlipHChanged(m\_isFlippedX);}
\DoxyCodeLine{02750   emit onFlipVChanged(m\_isFlippedY);}
\DoxyCodeLine{02751   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{02752 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ad14f2cc4168a38882b4c23bbb8e7ed61}\label{class_scene_viewer_ad14f2cc4168a38882b4c23bbb8e7ed61}} 
\index{SceneViewer@{SceneViewer}!resetTabletStatus@{resetTabletStatus}}
\index{resetTabletStatus@{resetTabletStatus}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{resetTabletStatus}{resetTabletStatus}}
{\footnotesize\ttfamily void Scene\+Viewer\+::reset\+Tablet\+Status (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00923                                     \{}
\DoxyCodeLine{00924   \textcolor{keywordflow}{if} (!m\_buttonClicked) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00925   m\_mouseButton   = Qt::NoButton;}
\DoxyCodeLine{00926   m\_tabletEvent   = \textcolor{keyword}{false};}
\DoxyCodeLine{00927   m\_tabletState   = None;}
\DoxyCodeLine{00928   m\_tabletMove    = \textcolor{keyword}{false};}
\DoxyCodeLine{00929   m\_pressure      = 0;}
\DoxyCodeLine{00930   m\_buttonClicked = \textcolor{keyword}{false};}
\DoxyCodeLine{00931   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getCurrentTool()-\/>isToolBusy())}
\DoxyCodeLine{00932     \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>setToolBusy(\textcolor{keyword}{false});}
\DoxyCodeLine{00933 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a19a9898446b10c6a9367171b5c43ca1a}\label{class_scene_viewer_a19a9898446b10c6a9367171b5c43ca1a}} 
\index{SceneViewer@{SceneViewer}!resetZoom@{resetZoom}}
\index{resetZoom@{resetZoom}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{resetZoom}{resetZoom}}
{\footnotesize\ttfamily void Scene\+Viewer\+::reset\+Zoom (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02756                             \{}
\DoxyCodeLine{02757   \mbox{\hyperlink{class_t_point_t}{TPointD}} realCenter(m\_viewAff[m\_viewMode].a13, m\_viewAff[m\_viewMode].a23);}
\DoxyCodeLine{02758   \mbox{\hyperlink{class_t_affine}{TAffine}} aff =}
\DoxyCodeLine{02759       getNormalZoomScale() * \mbox{\hyperlink{class_t_rotation}{TRotation}}(realCenter, m\_rotationAngle[m\_viewMode]);}
\DoxyCodeLine{02760   aff.a13 = realCenter.x;}
\DoxyCodeLine{02761   aff.a23 = realCenter.y;}
\DoxyCodeLine{02762   \textcolor{keywordflow}{if} (m\_isFlippedX) aff = aff * \mbox{\hyperlink{class_t_scale}{TScale}}(-\/1, 1);}
\DoxyCodeLine{02763   \textcolor{keywordflow}{if} (m\_isFlippedY) aff = aff * \mbox{\hyperlink{class_t_scale}{TScale}}(1, -\/1);}
\DoxyCodeLine{02764   setViewMatrix(aff, m\_viewMode);}
\DoxyCodeLine{02765   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{02766   emit onZoomChanged();}
\DoxyCodeLine{02767 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a2e7b35a10fc6a43dc5fd50c572de22a8}\label{class_scene_viewer_a2e7b35a10fc6a43dc5fd50c572de22a8}} 
\index{SceneViewer@{SceneViewer}!resizeGL@{resizeGL}}
\index{resizeGL@{resizeGL}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{resizeGL()}{resizeGL()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::resize\+GL (\begin{DoxyParamCaption}\item[{int}]{width,  }\item[{int}]{height }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01260                                        \{}
\DoxyCodeLine{01261   w *= getDevPixRatio();}
\DoxyCodeLine{01262   h *= getDevPixRatio();}
\DoxyCodeLine{01263   glViewport(0, 0, w, h);}
\DoxyCodeLine{01264   glMatrixMode(GL\_PROJECTION);}
\DoxyCodeLine{01265   glLoadIdentity();}
\DoxyCodeLine{01266   glOrtho(0, w, 0, h, -\/4000, 4000);}
\DoxyCodeLine{01267   m\_projectionMatrix.setToIdentity();}
\DoxyCodeLine{01268   m\_projectionMatrix.ortho(0, w, 0, h, -\/4000, 4000);}
\DoxyCodeLine{01269 }
\DoxyCodeLine{01270   glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{01271   glLoadIdentity();}
\DoxyCodeLine{01272   glTranslatef(0.375, 0.375, 0.0);}
\DoxyCodeLine{01273   \textcolor{comment}{// make the center of the viewer = origin}}
\DoxyCodeLine{01274   glTranslated(w * 0.5, h * 0.5, 0);}
\DoxyCodeLine{01275 }
\DoxyCodeLine{01276   \textcolor{keywordflow}{if} (m\_freezedStatus == NORMAL\_FREEZED) m\_freezedStatus = UPDATE\_FREEZED;}
\DoxyCodeLine{01277 }
\DoxyCodeLine{01278   \textcolor{keywordflow}{if} (m\_previewMode != NO\_PREVIEW) requestTimedRefresh();}
\DoxyCodeLine{01279 }
\DoxyCodeLine{01280   \textcolor{comment}{// remake fbo with new size}}
\DoxyCodeLine{01281   \textcolor{keywordflow}{if} (m\_lutCalibrator \&\& m\_lutCalibrator-\/>isValid()) \{}
\DoxyCodeLine{01282     \textcolor{keywordflow}{if} (m\_fbo) \textcolor{keyword}{delete} m\_fbo;}
\DoxyCodeLine{01283     \textcolor{keywordflow}{if} (Preferences::instance()-\/>is30bitDisplayEnabled()) \{}
\DoxyCodeLine{01284       QOpenGLFramebufferObjectFormat format;}
\DoxyCodeLine{01285       format.setInternalTextureFormat(TGL\_TexFmt10);}
\DoxyCodeLine{01286       m\_fbo = \textcolor{keyword}{new} QOpenGLFramebufferObject(w, h, format);}
\DoxyCodeLine{01287     \} \textcolor{keywordflow}{else}  \textcolor{comment}{// normally, initialize with GL\_RGBA8 format}}
\DoxyCodeLine{01288       m\_fbo = \textcolor{keyword}{new} QOpenGLFramebufferObject(w, h);}
\DoxyCodeLine{01289   \}}
\DoxyCodeLine{01290 }
\DoxyCodeLine{01291   \textcolor{comment}{// for updating the navigator in levelstrip}}
\DoxyCodeLine{01292   emit refreshNavi();}
\DoxyCodeLine{01293 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a0dfe29f7fe83caa0ccde4ea0f35ee3ed}\label{class_scene_viewer_a0dfe29f7fe83caa0ccde4ea0f35ee3ed}} 
\index{SceneViewer@{SceneViewer}!rotate@{rotate}}
\index{rotate@{rotate}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{rotate()}{rotate()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::rotate (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{center,  }\item[{double}]{angle }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02593                                                             \{}
\DoxyCodeLine{02594   \textcolor{keywordflow}{if} (angle == 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{02595   \textcolor{keywordflow}{if} (m\_isFlippedX != m\_isFlippedY) angle = -\/angle;}
\DoxyCodeLine{02596   m\_rotationAngle[m\_viewMode] += angle;}
\DoxyCodeLine{02597   \mbox{\hyperlink{class_t_point_t}{TPointD}} realCenter = m\_viewAff[m\_viewMode] * center;}
\DoxyCodeLine{02598   setViewMatrix(\mbox{\hyperlink{class_t_rotation}{TRotation}}(realCenter, angle) * m\_viewAff[m\_viewMode],}
\DoxyCodeLine{02599                 m\_viewMode);}
\DoxyCodeLine{02600   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{02601 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a98b5fbea26ca3b3cc40521d73984dc96}\label{class_scene_viewer_a98b5fbea26ca3b3cc40521d73984dc96}} 
\index{SceneViewer@{SceneViewer}!rotate3D@{rotate3D}}
\index{rotate3D@{rotate3D}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{rotate3D()}{rotate3D()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::rotate3D (\begin{DoxyParamCaption}\item[{double}]{d\+Phi,  }\item[{double}]{d\+Theta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02605                                                      \{}
\DoxyCodeLine{02606   \textcolor{keywordflow}{if} (dPhi == 0 \&\& dTheta == 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{02607   m\_phi3D   = (float)tcrop(m\_phi3D + dPhi, -\/90.0, 90.0);}
\DoxyCodeLine{02608   m\_theta3D = (float)tcrop(m\_theta3D + dTheta, 0.0, 90.0);}
\DoxyCodeLine{02609   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{02610 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a815ed36c49a2b65f33464544a229056b}\label{class_scene_viewer_a815ed36c49a2b65f33464544a229056b}} 
\index{SceneViewer@{SceneViewer}!set3DLeftSideView@{set3DLeftSideView}}
\index{set3DLeftSideView@{set3DLeftSideView}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{set3DLeftSideView()}{set3DLeftSideView()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set3\+DLeft\+Side\+View (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{03198                                     \{}
\DoxyCodeLine{03199   m\_phi3D   = -\/90;}
\DoxyCodeLine{03200   m\_theta3D = 0;}
\DoxyCodeLine{03201   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{03202 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ac6ce34accfa0ad79675753a48cdec07c}\label{class_scene_viewer_ac6ce34accfa0ad79675753a48cdec07c}} 
\index{SceneViewer@{SceneViewer}!set3DRightSideView@{set3DRightSideView}}
\index{set3DRightSideView@{set3DRightSideView}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{set3DRightSideView()}{set3DRightSideView()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set3\+DRight\+Side\+View (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{03206                                      \{}
\DoxyCodeLine{03207   m\_phi3D   = 90;}
\DoxyCodeLine{03208   m\_theta3D = 0;}
\DoxyCodeLine{03209   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{03210 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_adbd7edc9abfe7a258f50fcdfe3ac32a7}\label{class_scene_viewer_adbd7edc9abfe7a258f50fcdfe3ac32a7}} 
\index{SceneViewer@{SceneViewer}!set3DTopView@{set3DTopView}}
\index{set3DTopView@{set3DTopView}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{set3DTopView()}{set3DTopView()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set3\+DTop\+View (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{03214                                \{}
\DoxyCodeLine{03215   m\_phi3D   = 0;}
\DoxyCodeLine{03216   m\_theta3D = 90;}
\DoxyCodeLine{03217   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{03218 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a8ca6c2ca955f598e104d76cfccf108f0}\label{class_scene_viewer_a8ca6c2ca955f598e104d76cfccf108f0}} 
\index{SceneViewer@{SceneViewer}!setActualPixelSize@{setActualPixelSize}}
\index{setActualPixelSize@{setActualPixelSize}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{setActualPixelSize}{setActualPixelSize}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set\+Actual\+Pixel\+Size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02795                                      \{}
\DoxyCodeLine{02796   \mbox{\hyperlink{class_t_app}{TApp}} *app           = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{02797   \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *l        = app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel();}
\DoxyCodeLine{02798   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl = l ? l-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}() : 0;}
\DoxyCodeLine{02799   \textcolor{keywordflow}{if} (!sl) \textcolor{keywordflow}{return};}
\DoxyCodeLine{02800 }
\DoxyCodeLine{02801   \mbox{\hyperlink{class_t_frame_id}{TFrameId}} fid(app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFid());}
\DoxyCodeLine{02802 }
\DoxyCodeLine{02803   \mbox{\hyperlink{class_t_point_t}{TPointD}} dpi;}
\DoxyCodeLine{02804   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_cleanup_preview_check_a231efbbe4e3356757b725452d5efb62d}{CleanupPreviewCheck::instance}}()-\/>isEnabled()) \{}
\DoxyCodeLine{02805     \textcolor{comment}{// The previewed cleanup image has no image infos yet -\/ retrieve the dpi}}
\DoxyCodeLine{02806     \textcolor{comment}{// through}}
\DoxyCodeLine{02807     \textcolor{comment}{// the cleanup camera data}}
\DoxyCodeLine{02808     \mbox{\hyperlink{class_cleanup_parameters}{CleanupParameters}} *cleanupParams = app-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()}
\DoxyCodeLine{02809                                            -\/>getScene()}
\DoxyCodeLine{02810                                            -\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}()}
\DoxyCodeLine{02811                                            -\/>\mbox{\hyperlink{class_t_scene_properties_a84e6735bb0b0ea5054b9592c9612aff9}{getCleanupParameters}}();}
\DoxyCodeLine{02812 }
\DoxyCodeLine{02813     \mbox{\hyperlink{class_t_dimension_t}{TDimension}} dim(0, 0);}
\DoxyCodeLine{02814     cleanupParams-\/>getOutputImageInfo(dim, dpi.x, dpi.y);}
\DoxyCodeLine{02815   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{02816     dpi = sl-\/>getDpi(fid);}
\DoxyCodeLine{02817 }
\DoxyCodeLine{02818   \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{inch}} = \mbox{\hyperlink{namespace_stage_ad3e22e31e2bb6fc1d95a572facce2d5b}{Stage::inch}};}
\DoxyCodeLine{02819   \mbox{\hyperlink{class_t_affine}{TAffine}} tempAff   = getNormalZoomScale();}
\DoxyCodeLine{02820   \textcolor{keywordflow}{if} (m\_isFlippedX) tempAff = tempAff * \mbox{\hyperlink{class_t_scale}{TScale}}(-\/1, 1);}
\DoxyCodeLine{02821   \textcolor{keywordflow}{if} (m\_isFlippedY) tempAff = tempAff * \mbox{\hyperlink{class_t_scale}{TScale}}(1, -\/1);}
\DoxyCodeLine{02822   \mbox{\hyperlink{class_t_point_t}{TPointD}} tempScale = dpi;}
\DoxyCodeLine{02823   \textcolor{keywordflow}{if} (m\_isFlippedX) tempScale.x = -\/tempScale.x;}
\DoxyCodeLine{02824   \textcolor{keywordflow}{if} (m\_isFlippedY) tempScale.y = -\/tempScale.y;}
\DoxyCodeLine{02825   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < m\_viewAff.size(); ++i)}
\DoxyCodeLine{02826     setViewMatrix(dpi == \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0)}
\DoxyCodeLine{02827                       ? tempAff}
\DoxyCodeLine{02828                       : \mbox{\hyperlink{class_t_scale}{TScale}}(tempScale.x / inch, tempScale.y / inch),}
\DoxyCodeLine{02829                   i);}
\DoxyCodeLine{02830 }
\DoxyCodeLine{02831   m\_pos         = QPoint(0, 0);}
\DoxyCodeLine{02832   m\_pan3D       = \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0);}
\DoxyCodeLine{02833   m\_zoomScale3D = 0.1;}
\DoxyCodeLine{02834   m\_theta3D     = 20;}
\DoxyCodeLine{02835   m\_phi3D       = 30;}
\DoxyCodeLine{02836   emit onZoomChanged();}
\DoxyCodeLine{02837 }
\DoxyCodeLine{02838   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{02839 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a62353c28294f128e596558065ba41e8f}\label{class_scene_viewer_a62353c28294f128e596558065ba41e8f}} 
\index{SceneViewer@{SceneViewer}!setEditPreviewSubcamera@{setEditPreviewSubcamera}}
\index{setEditPreviewSubcamera@{setEditPreviewSubcamera}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{setEditPreviewSubcamera()}{setEditPreviewSubcamera()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set\+Edit\+Preview\+Subcamera (\begin{DoxyParamCaption}\item[{bool}]{enabled }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00270                                              \{}
\DoxyCodeLine{00271     m\_editPreviewSubCamera = enabled;}
\DoxyCodeLine{00272   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a80e2fb17aa36a8a882331be5b2025726}\label{class_scene_viewer_a80e2fb17aa36a8a882331be5b2025726}} 
\index{SceneViewer@{SceneViewer}!setFocus@{setFocus}}
\index{setFocus@{setFocus}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{setFocus()}{setFocus()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set\+Focus (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00411 \{ QWidget::setFocus(); \};}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a90c77460ec4fc143817b3e9479a50f1a}\label{class_scene_viewer_a90c77460ec4fc143817b3e9479a50f1a}} 
\index{SceneViewer@{SceneViewer}!setFocus@{setFocus}}
\index{setFocus@{setFocus}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{setFocus()}{setFocus()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set\+Focus (\begin{DoxyParamCaption}\item[{Qt\+::\+Focus\+Reason}]{reason }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00286 \{ QWidget::setFocus(reason); \};}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a4e743c887ede3ea67132600c6661d823}\label{class_scene_viewer_a4e743c887ede3ea67132600c6661d823}} 
\index{SceneViewer@{SceneViewer}!setIsLocator@{setIsLocator}}
\index{setIsLocator@{setIsLocator}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{setIsLocator()}{setIsLocator()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set\+Is\+Locator (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00288 \{ m\_isLocator = \textcolor{keyword}{true}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a1aa0bac14417aeeb458439dfed626dae}\label{class_scene_viewer_a1aa0bac14417aeeb458439dfed626dae}} 
\index{SceneViewer@{SceneViewer}!setIsStyleShortcutSwitchable@{setIsStyleShortcutSwitchable}}
\index{setIsStyleShortcutSwitchable@{setIsStyleShortcutSwitchable}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{setIsStyleShortcutSwitchable()}{setIsStyleShortcutSwitchable()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set\+Is\+Style\+Shortcut\+Switchable (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00289 \{ m\_isStyleShortcutSwitchable = \textcolor{keyword}{true}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a356c3d5f2a1694bf7e598c29b9fe03e5}\label{class_scene_viewer_a356c3d5f2a1694bf7e598c29b9fe03e5}} 
\index{SceneViewer@{SceneViewer}!setReferenceMode@{setReferenceMode}}
\index{setReferenceMode@{setReferenceMode}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{setReferenceMode}{setReferenceMode}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set\+Reference\+Mode (\begin{DoxyParamCaption}\item[{int}]{reference\+Mode }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00896                                                     \{}
\DoxyCodeLine{00897   \textcolor{keywordflow}{if} (m\_referenceMode == referenceMode) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00898 }
\DoxyCodeLine{00899   \mbox{\hyperlink{class_t_app}{TApp}} *app = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{00900   \textcolor{keywordflow}{if} (app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isEditingLevel())}
\DoxyCodeLine{00901     app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>setFrame(app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame());}
\DoxyCodeLine{00902   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \{}
\DoxyCodeLine{00903     freeze(\textcolor{keyword}{false});}
\DoxyCodeLine{00904     emit freezeStateChanged(\textcolor{keyword}{false});}
\DoxyCodeLine{00905   \}}
\DoxyCodeLine{00906 }
\DoxyCodeLine{00907   m\_referenceMode = referenceMode;}
\DoxyCodeLine{00908   \mbox{\hyperlink{class_scene_viewer_a9865bf9cec6524de9d751f34702aab0f}{invalidateAll}}();}
\DoxyCodeLine{00909   emit onZoomChanged();}
\DoxyCodeLine{00910 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a6d36b46e11aebf1a2a0fb8f618c4f627}\label{class_scene_viewer_a6d36b46e11aebf1a2a0fb8f618c4f627}} 
\index{SceneViewer@{SceneViewer}!setRulers@{setRulers}}
\index{setRulers@{setRulers}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{setRulers()}{setRulers()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set\+Rulers (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_ruler}{Ruler}} $\ast$}]{v,  }\item[{\mbox{\hyperlink{class_ruler}{Ruler}} $\ast$}]{h }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00243                                      \{}
\DoxyCodeLine{00244     m\_vRuler = v;}
\DoxyCodeLine{00245     m\_hRuler = h;}
\DoxyCodeLine{00246   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ae85206a6a0c35c8ea2374f1442575f39}\label{class_scene_viewer_ae85206a6a0c35c8ea2374f1442575f39}} 
\index{SceneViewer@{SceneViewer}!setTimerAndTargetInstant@{setTimerAndTargetInstant}}
\index{setTimerAndTargetInstant@{setTimerAndTargetInstant}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{setTimerAndTargetInstant()}{setTimerAndTargetInstant()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set\+Timer\+And\+Target\+Instant (\begin{DoxyParamCaption}\item[{QElapsed\+Timer $\ast$}]{timer,  }\item[{qint64}]{target }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00298                                                                      \{}
\DoxyCodeLine{00299     m\_timer         = timer;}
\DoxyCodeLine{00300     m\_targetInstant = target;}
\DoxyCodeLine{00301   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a81053fcd8115b5854c5b7dff0af0cf5a}\label{class_scene_viewer_a81053fcd8115b5854c5b7dff0af0cf5a}} 
\index{SceneViewer@{SceneViewer}!setViewMatrix@{setViewMatrix}}
\index{setViewMatrix@{setViewMatrix}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{setViewMatrix()}{setViewMatrix()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set\+View\+Matrix (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff,  }\item[{int}]{view\+Mode }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02237                                                                 \{}
\DoxyCodeLine{02238   m\_viewAff[viewMode] = aff;}
\DoxyCodeLine{02239   \textcolor{comment}{// In case the previewer is on, request a delayed update}}
\DoxyCodeLine{02240   \textcolor{keywordflow}{if} (m\_previewMode != NO\_PREVIEW) requestTimedRefresh();}
\DoxyCodeLine{02241 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a99f8875eb64f5e9e7f3001fb6556bafd}\label{class_scene_viewer_a99f8875eb64f5e9e7f3001fb6556bafd}} 
\index{SceneViewer@{SceneViewer}!setVisual@{setVisual}}
\index{setVisual@{setVisual}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{setVisual()}{setVisual()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::set\+Visual (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_image_painter_1_1_visual_settings}{Image\+Painter\+::\+Visual\+Settings}} \&}]{settings }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00826                                                                       \{}
\DoxyCodeLine{00827   \textcolor{comment}{// m\_visualSettings.m\_blankColor = settings.m\_blankColor;//for the blank}}
\DoxyCodeLine{00828   \textcolor{comment}{// frames, I don't have to repaint the viewer are using updateGl!}}
\DoxyCodeLine{00829   \textcolor{keywordtype}{bool} repaint     = \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.needRepaint(settings);}
\DoxyCodeLine{00830   \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}} = settings;}
\DoxyCodeLine{00831   \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_ab6461a28653bae19432d998149564b43}{m\_sceneProperties}} =}
\DoxyCodeLine{00832       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}();}
\DoxyCodeLine{00833   \textcolor{keywordflow}{if} (repaint) \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidateAll}}();}
\DoxyCodeLine{00834 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_aac3340c7d8289f8c4eb7eb1789f72751}\label{class_scene_viewer_aac3340c7d8289f8c4eb7eb1789f72751}} 
\index{SceneViewer@{SceneViewer}!showEvent@{showEvent}}
\index{showEvent@{showEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{showEvent()}{showEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::show\+Event (\begin{DoxyParamCaption}\item[{QShow\+Event $\ast$}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01014                                         \{}
\DoxyCodeLine{01015   \mbox{\hyperlink{class_t_tool_1_1_viewer_acf21c5c07a1d6db104fb0518d654e5f3}{m\_visualSettings}}.\mbox{\hyperlink{class_image_painter_1_1_visual_settings_ab6461a28653bae19432d998149564b43}{m\_sceneProperties}} =}
\DoxyCodeLine{01016       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}();}
\DoxyCodeLine{01017 }
\DoxyCodeLine{01018   \textcolor{comment}{// Se il viewer e' show e il preview e' attivo aggiungo il listner al preview}}
\DoxyCodeLine{01019   \textcolor{keywordflow}{if} (m\_previewMode != NO\_PREVIEW)}
\DoxyCodeLine{01020     \mbox{\hyperlink{class_previewer_a5eb765b66490a3d99d432f90864bfacd}{Previewer::instance}}(m\_previewMode == SUBCAMERA\_PREVIEW)-\/>addListener(\textcolor{keyword}{this});}
\DoxyCodeLine{01021 }
\DoxyCodeLine{01022   \mbox{\hyperlink{class_t_app}{TApp}} *app = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{01023 }
\DoxyCodeLine{01024   \mbox{\hyperlink{class_t_scene_handle}{TSceneHandle}} *sceneHandle = app-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}();}
\DoxyCodeLine{01025   \textcolor{keywordtype}{bool} ret = connect(sceneHandle, SIGNAL(sceneSwitched()), \textcolor{keyword}{this},}
\DoxyCodeLine{01026                      SLOT(resetSceneViewer()));}
\DoxyCodeLine{01027   ret      = ret \&\& connect(sceneHandle, SIGNAL(sceneChanged()), \textcolor{keyword}{this},}
\DoxyCodeLine{01028                        SLOT(onSceneChanged()));}
\DoxyCodeLine{01029   ret = ret \&\& connect(sceneHandle, SIGNAL(preferenceChanged(\textcolor{keyword}{const} QString \&)),}
\DoxyCodeLine{01030                        \textcolor{keyword}{this}, SLOT(onPreferenceChanged(\textcolor{keyword}{const} QString \&)));}
\DoxyCodeLine{01031 }
\DoxyCodeLine{01032   \mbox{\hyperlink{class_t_frame_handle}{TFrameHandle}} *frameHandle = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}();}
\DoxyCodeLine{01033   ret = ret \&\& connect(frameHandle, SIGNAL(frameSwitched()), \textcolor{keyword}{this},}
\DoxyCodeLine{01034                        SLOT(onFrameSwitched()));}
\DoxyCodeLine{01035 }
\DoxyCodeLine{01036   \mbox{\hyperlink{class_t_palette_handle}{TPaletteHandle}} *paletteHandle =}
\DoxyCodeLine{01037       app-\/>getPaletteController()-\/>getCurrentLevelPalette();}
\DoxyCodeLine{01038   ret = ret \&\& connect(paletteHandle, SIGNAL(colorStyleChanged(\textcolor{keywordtype}{bool})), \textcolor{keyword}{this},}
\DoxyCodeLine{01039                        SLOT(update()));}
\DoxyCodeLine{01040 }
\DoxyCodeLine{01041   ret = ret \&\& connect(app-\/>\mbox{\hyperlink{class_t_app_a0d91c122eec2b756b7c4780014e49f9e}{getCurrentObject}}(), SIGNAL(objectSwitched()), \textcolor{keyword}{this},}
\DoxyCodeLine{01042                        SLOT(onObjectSwitched()));}
\DoxyCodeLine{01043   ret = ret \&\& connect(app-\/>\mbox{\hyperlink{class_t_app_a0d91c122eec2b756b7c4780014e49f9e}{getCurrentObject}}(), SIGNAL(objectChanged(\textcolor{keywordtype}{bool})),}
\DoxyCodeLine{01044                        \textcolor{keyword}{this}, SLOT(update()));}
\DoxyCodeLine{01045 }
\DoxyCodeLine{01046   ret =}
\DoxyCodeLine{01047       ret \&\& connect(app-\/>\mbox{\hyperlink{class_t_app_afcdd56d9130b7c39a5227de08a0b65e4}{getCurrentOnionSkin}}(), SIGNAL(onionSkinMaskChanged()),}
\DoxyCodeLine{01048                      \textcolor{keyword}{this}, SLOT(onOnionSkinMaskChanged()));}
\DoxyCodeLine{01049 }
\DoxyCodeLine{01050   ret = ret \&\& connect(app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}(), SIGNAL(xshLevelChanged()), \textcolor{keyword}{this},}
\DoxyCodeLine{01051                        SLOT(update()));}
\DoxyCodeLine{01052   ret = ret \&\& connect(app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}(), SIGNAL(xshCanvasSizeChanged()),}
\DoxyCodeLine{01053                        \textcolor{keyword}{this}, SLOT(update()));}
\DoxyCodeLine{01054   \textcolor{comment}{// when level is switched, update m\_dpiScale in order to show white background}}
\DoxyCodeLine{01055   \textcolor{comment}{// for Ink\&Paint work properly}}
\DoxyCodeLine{01056   ret = ret \&\&}
\DoxyCodeLine{01057         connect(app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}(), SIGNAL(xshLevelSwitched(\mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *)),}
\DoxyCodeLine{01058                 \textcolor{keyword}{this}, SLOT(\mbox{\hyperlink{class_scene_viewer_a4c5ebcc7632efbf13fd8640531e95766}{onLevelSwitched}}()));}
\DoxyCodeLine{01059 }
\DoxyCodeLine{01060   ret = ret \&\& connect(app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}(), SIGNAL(xsheetChanged()), \textcolor{keyword}{this},}
\DoxyCodeLine{01061                        SLOT(onXsheetChanged()));}
\DoxyCodeLine{01062   ret = ret \&\& connect(app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}(), SIGNAL(xsheetSwitched()), \textcolor{keyword}{this},}
\DoxyCodeLine{01063                        SLOT(update()));}
\DoxyCodeLine{01064 }
\DoxyCodeLine{01065   \textcolor{comment}{// update tooltip when tool options are changed}}
\DoxyCodeLine{01066   ret = ret \&\& connect(app-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}(), SIGNAL(toolChanged()), \textcolor{keyword}{this},}
\DoxyCodeLine{01067                        SLOT(\mbox{\hyperlink{class_scene_viewer_a950ace4dc4b0afb962fb4884a107d00a}{onToolChanged}}()));}
\DoxyCodeLine{01068   ret = ret \&\& connect(app-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}(), SIGNAL(toolCursorTypeChanged()),}
\DoxyCodeLine{01069                        \textcolor{keyword}{this}, SLOT(\mbox{\hyperlink{class_scene_viewer_a950ace4dc4b0afb962fb4884a107d00a}{onToolChanged}}()));}
\DoxyCodeLine{01070 }
\DoxyCodeLine{01071   ret = ret \&\&}
\DoxyCodeLine{01072         connect(app, SIGNAL(tabletLeft()), \textcolor{keyword}{this}, SLOT(resetTabletStatus()));}
\DoxyCodeLine{01073 \textcolor{preprocessor}{\#if defined(x64)}}
\DoxyCodeLine{01074   \textcolor{keywordflow}{if} (m\_stopMotion) \{}
\DoxyCodeLine{01075     ret = ret \&\& connect(m\_stopMotion, SIGNAL(newLiveViewImageReady()), \textcolor{keyword}{this},}
\DoxyCodeLine{01076                          SLOT(onNewStopMotionImageReady()));}
\DoxyCodeLine{01077     ret = ret \&\& connect(m\_stopMotion, SIGNAL(liveViewStopped()), \textcolor{keyword}{this},}
\DoxyCodeLine{01078                          SLOT(onStopMotionLiveViewStopped()));}
\DoxyCodeLine{01079   \}}
\DoxyCodeLine{01080 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01081   assert(ret);}
\DoxyCodeLine{01082 }
\DoxyCodeLine{01083   \textcolor{keywordflow}{if} (m\_hRuler \&\& m\_vRuler) \{}
\DoxyCodeLine{01084     \textcolor{keywordflow}{if} (!viewRulerToggle.getStatus()) \{}
\DoxyCodeLine{01085       m\_hRuler-\/>hide();}
\DoxyCodeLine{01086       m\_vRuler-\/>hide();}
\DoxyCodeLine{01087     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01088       m\_hRuler-\/>show();}
\DoxyCodeLine{01089       m\_vRuler-\/>show();}
\DoxyCodeLine{01090     \}}
\DoxyCodeLine{01091   \}}
\DoxyCodeLine{01092   \textcolor{keywordflow}{if} (m\_shownOnce == \textcolor{keyword}{false}) \{}
\DoxyCodeLine{01093     fitToCamera();}
\DoxyCodeLine{01094     m\_shownOnce = \textcolor{keyword}{true};}
\DoxyCodeLine{01095   \}}
\DoxyCodeLine{01096   \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>setActiveViewer(\textcolor{keyword}{this});}
\DoxyCodeLine{01097 }
\DoxyCodeLine{01098   onPreferenceChanged(\textcolor{stringliteral}{"{}ColorCalibration"{}});}
\DoxyCodeLine{01099   update();}
\DoxyCodeLine{01100 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a706c39b5ae56033e32d2394142198301}\label{class_scene_viewer_a706c39b5ae56033e32d2394142198301}} 
\index{SceneViewer@{SceneViewer}!swapCompared@{swapCompared}}
\index{swapCompared@{swapCompared}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{swapCompared}{swapCompared}}
{\footnotesize\ttfamily void Scene\+Viewer\+::swap\+Compared (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02630                                \{}
\DoxyCodeLine{02631   m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_afe3ed555ed9a43177446841f0978e58c}{m\_swapCompared}} = !m\_compareSettings.\mbox{\hyperlink{class_image_painter_1_1_compare_settings_afe3ed555ed9a43177446841f0978e58c}{m\_swapCompared}};}
\DoxyCodeLine{02632   update();}
\DoxyCodeLine{02633 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a70971e0b0f88badc18059b6c0474e0fd}\label{class_scene_viewer_a70971e0b0f88badc18059b6c0474e0fd}} 
\index{SceneViewer@{SceneViewer}!tabletEvent@{tabletEvent}}
\index{tabletEvent@{tabletEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{tabletEvent()}{tabletEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::tablet\+Event (\begin{DoxyParamCaption}\item[{QTablet\+Event $\ast$}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00251                                              \{}
\DoxyCodeLine{00252   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00253 }
\DoxyCodeLine{00254   m\_tabletEvent = \textcolor{keyword}{true};}
\DoxyCodeLine{00255   m\_pressure    = e-\/>pressure();}
\DoxyCodeLine{00256   m\_tabletMove  = \textcolor{keyword}{false};}
\DoxyCodeLine{00257   \textcolor{comment}{// Management of the Eraser pointer}}
\DoxyCodeLine{00258   \mbox{\hyperlink{class_tool_handle}{ToolHandle}} *toolHandle = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}();}
\DoxyCodeLine{00259   \textcolor{keywordflow}{if} (e-\/>pointerType() == QTabletEvent::Eraser) \{}
\DoxyCodeLine{00260     \textcolor{keywordflow}{if} (!m\_eraserPointerOn) \{}
\DoxyCodeLine{00261       \textcolor{keywordflow}{if} (toolHandle-\/>getTool()-\/>getName() != T\_Eraser) \{}
\DoxyCodeLine{00262         \textcolor{comment}{// Save the current tool}}
\DoxyCodeLine{00263         m\_backupTool = QString::fromStdString(toolHandle-\/>getTool()-\/>getName());}
\DoxyCodeLine{00264         \textcolor{comment}{// Switch to the Eraser tool}}
\DoxyCodeLine{00265         toolHandle-\/>setTool(T\_Eraser);}
\DoxyCodeLine{00266         m\_eraserPointerOn = \textcolor{keyword}{true};}
\DoxyCodeLine{00267       \}}
\DoxyCodeLine{00268     \}}
\DoxyCodeLine{00269   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00270     \textcolor{keywordflow}{if} (m\_eraserPointerOn) \{}
\DoxyCodeLine{00271       \textcolor{comment}{// Restore the previous tool}}
\DoxyCodeLine{00272       toolHandle-\/>setTool(m\_backupTool);}
\DoxyCodeLine{00273       m\_eraserPointerOn = \textcolor{keyword}{false};}
\DoxyCodeLine{00274     \}}
\DoxyCodeLine{00275   \}}
\DoxyCodeLine{00276   \textcolor{keywordflow}{switch} (e-\/>type()) \{}
\DoxyCodeLine{00277   \textcolor{keywordflow}{case} QEvent::TabletPress: \{}
\DoxyCodeLine{00278 \textcolor{preprocessor}{\#ifdef MACOSX}}
\DoxyCodeLine{00279     \textcolor{comment}{// In OSX tablet action may cause only tabletEvent, not followed by}}
\DoxyCodeLine{00280     \textcolor{comment}{// mousePressEvent.}}
\DoxyCodeLine{00281     \textcolor{comment}{// So call onPress here in order to enable processing.}}
\DoxyCodeLine{00282     \textcolor{keywordflow}{if} (e-\/>button() == Qt::LeftButton) m\_tabletState = Touched;}
\DoxyCodeLine{00283     \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} mouseEvent;}
\DoxyCodeLine{00284     initToonzEvent(mouseEvent, e, height(), m\_pressure, getDevPixRatio());}
\DoxyCodeLine{00285     onPress(mouseEvent);}
\DoxyCodeLine{00286 }
\DoxyCodeLine{00287     \textcolor{comment}{// create context menu on right click here}}
\DoxyCodeLine{00288     \textcolor{keywordflow}{if} (e-\/>button() == Qt::RightButton) \{}
\DoxyCodeLine{00289       m\_mouseButton = Qt::NoButton;}
\DoxyCodeLine{00290       onContextMenu(e-\/>pos(), e-\/>globalPos());}
\DoxyCodeLine{00291     \}}
\DoxyCodeLine{00292 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00293     \textcolor{comment}{// for Windows, use tabletEvent only for the left Button}}
\DoxyCodeLine{00294     \textcolor{comment}{// (regular pen touch), because}}
\DoxyCodeLine{00295     \textcolor{comment}{// the current Qt seems to fail to catch the Wacom's button binding properly}}
\DoxyCodeLine{00296     \textcolor{comment}{// with QTabletEvent-\/>button() when pressing middle or right button.}}
\DoxyCodeLine{00297     \textcolor{comment}{// So, in such case set m\_tabletEvent = FALSE and let the mousePressEvent to}}
\DoxyCodeLine{00298     \textcolor{comment}{// work.}}
\DoxyCodeLine{00299     \textcolor{keywordflow}{if} (e-\/>button() == Qt::LeftButton) \{}
\DoxyCodeLine{00300       \textcolor{comment}{// Process the 1st tabletPress encountered and ignore back-\/to-\/back}}
\DoxyCodeLine{00301       \textcolor{comment}{// tabletPress events. Treat it as if it happened so a following}}
\DoxyCodeLine{00302       \textcolor{comment}{// mousePressEvent gets ignored}}
\DoxyCodeLine{00303       \textcolor{keywordflow}{if} (m\_tabletState == Released || m\_tabletState == None) \{}
\DoxyCodeLine{00304         \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} mouseEvent;}
\DoxyCodeLine{00305         initToonzEvent(mouseEvent, e, height(), m\_pressure, getDevPixRatio());}
\DoxyCodeLine{00306         m\_tabletState = Touched;}
\DoxyCodeLine{00307         onPress(mouseEvent);}
\DoxyCodeLine{00308       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_tabletState == Touched) \{}
\DoxyCodeLine{00309         m\_tabletState = StartStroke;}
\DoxyCodeLine{00310       \}}
\DoxyCodeLine{00311     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00312       m\_tabletEvent = \textcolor{keyword}{false};}
\DoxyCodeLine{00313 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00314 }
\DoxyCodeLine{00315 \textcolor{preprocessor}{\#if defined(LINUX) || defined(FREEBSD)}}
\DoxyCodeLine{00316     \textcolor{comment}{// for Linux, create context menu on right click here.}}
\DoxyCodeLine{00317     \textcolor{comment}{// could possibly merge with OSX code above}}
\DoxyCodeLine{00318     \textcolor{keywordflow}{if} (e-\/>button() == Qt::RightButton) \{}
\DoxyCodeLine{00319       m\_mouseButton = Qt::NoButton;}
\DoxyCodeLine{00320       onContextMenu(e-\/>pos(), e-\/>globalPos());}
\DoxyCodeLine{00321     \}}
\DoxyCodeLine{00322 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00323 }
\DoxyCodeLine{00324   \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{00325   \textcolor{keywordflow}{case} QEvent::TabletRelease: \{}
\DoxyCodeLine{00326 \textcolor{preprocessor}{\#ifdef MACOSX}}
\DoxyCodeLine{00327     \textcolor{keywordflow}{if} (m\_tabletState == StartStroke || m\_tabletState == OnStroke)}
\DoxyCodeLine{00328       m\_tabletState = Released;}
\DoxyCodeLine{00329 }
\DoxyCodeLine{00330     \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} mouseEvent;}
\DoxyCodeLine{00331     initToonzEvent(mouseEvent, e, height(), m\_pressure, getDevPixRatio());}
\DoxyCodeLine{00332     onRelease(mouseEvent);}
\DoxyCodeLine{00333 }
\DoxyCodeLine{00334     \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getCurrentTool()-\/>isToolBusy())}
\DoxyCodeLine{00335       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>setToolBusy(\textcolor{keyword}{false});}
\DoxyCodeLine{00336 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00337     \textcolor{keywordflow}{if} (m\_tabletState == StartStroke || m\_tabletState == OnStroke) \{}
\DoxyCodeLine{00338       m\_tabletState = Released;}
\DoxyCodeLine{00339       \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} mouseEvent;}
\DoxyCodeLine{00340       initToonzEvent(mouseEvent, e, height(), m\_pressure, getDevPixRatio());}
\DoxyCodeLine{00341       onRelease(mouseEvent);}
\DoxyCodeLine{00342     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00343       m\_tabletEvent = \textcolor{keyword}{false};}
\DoxyCodeLine{00344 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00345   \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{00346   \textcolor{keywordflow}{case} QEvent::TabletMove: \{}
\DoxyCodeLine{00347 \textcolor{preprocessor}{\#ifdef MACOSX}}
\DoxyCodeLine{00348     \textcolor{comment}{// for now OSX seems to fail to call enter/leaveEvent properly while}}
\DoxyCodeLine{00349     \textcolor{comment}{// the tablet is floating}}
\DoxyCodeLine{00350     \textcolor{keywordtype}{bool} isHoveringInsideViewer =}
\DoxyCodeLine{00351         !rect().marginsRemoved(QMargins(5, 5, 5, 5)).contains(e-\/>pos());}
\DoxyCodeLine{00352     \textcolor{comment}{// call the fake enter event}}
\DoxyCodeLine{00353     \textcolor{keywordflow}{if} (isHoveringInsideViewer) onEnter();}
\DoxyCodeLine{00354 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00355     \textcolor{comment}{// for Windowsm, use tabletEvent only for the left Button}}
\DoxyCodeLine{00356     \textcolor{keywordflow}{if} (m\_tabletState != StartStroke \&\& m\_tabletState != OnStroke) \{}
\DoxyCodeLine{00357       m\_tabletEvent = \textcolor{keyword}{false};}
\DoxyCodeLine{00358       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00359     \}}
\DoxyCodeLine{00360 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00361     QPointF curPos = e-\/>posF() * getDevPixRatio();}
\DoxyCodeLine{00362 \textcolor{preprocessor}{\#if defined(\_WIN32) \&\& QT\_VERSION >= QT\_VERSION\_CHECK(5, 10, 0)}}
\DoxyCodeLine{00363     \textcolor{comment}{// Use the application attribute Qt::AA\_CompressTabletEvents instead of the}}
\DoxyCodeLine{00364     \textcolor{comment}{// delay timer}}
\DoxyCodeLine{00365     \textcolor{comment}{// 21/4/2021 High frequent tablet event caused slowness when deforming with}}
\DoxyCodeLine{00366     \textcolor{comment}{// Raster Selection Tool. So I re-\/introduced the delay timer to make}}
\DoxyCodeLine{00367     \textcolor{comment}{// necessary interval for it. Deformation will be processed at interval of}}
\DoxyCodeLine{00368     \textcolor{comment}{// 20msec. (See RasterSelectionTool::leftButtonDrag())}}
\DoxyCodeLine{00369     \textcolor{keywordflow}{if} (curPos != m\_lastMousePos) \{}
\DoxyCodeLine{00370       \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} mouseEvent;}
\DoxyCodeLine{00371       initToonzEvent(mouseEvent, e, height(), m\_pressure, getDevPixRatio(),}
\DoxyCodeLine{00372                      m\_isBusyOnTabletMove);}
\DoxyCodeLine{00373       \textcolor{keywordflow}{if} (!m\_isBusyOnTabletMove) \{}
\DoxyCodeLine{00374         m\_isBusyOnTabletMove = \textcolor{keyword}{true};}
\DoxyCodeLine{00375         QTimer::singleShot(20, \textcolor{keyword}{this}, SLOT(releaseBusyOnTabletMove()));}
\DoxyCodeLine{00376       \}}
\DoxyCodeLine{00377 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00378     \textcolor{comment}{// It seems that the tabletEvent is called more often than mouseMoveEvent.}}
\DoxyCodeLine{00379     \textcolor{comment}{// So I fire the interval timer in order to limit the following process}}
\DoxyCodeLine{00380     \textcolor{comment}{// to be called in 50fps in maximum.}}
\DoxyCodeLine{00381     \textcolor{keywordflow}{if} (curPos != m\_lastMousePos \&\& !m\_isBusyOnTabletMove) \{}
\DoxyCodeLine{00382       m\_isBusyOnTabletMove = \textcolor{keyword}{true};}
\DoxyCodeLine{00383       \mbox{\hyperlink{class_t_mouse_event}{TMouseEvent}} mouseEvent;}
\DoxyCodeLine{00384       initToonzEvent(mouseEvent, e, height(), m\_pressure, getDevPixRatio());}
\DoxyCodeLine{00385       QTimer::singleShot(20, \textcolor{keyword}{this}, SLOT(releaseBusyOnTabletMove()));}
\DoxyCodeLine{00386 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00387 }
\DoxyCodeLine{00388       \textcolor{comment}{// cancel stroke to prevent drawing while floating}}
\DoxyCodeLine{00389       \textcolor{comment}{// 23/1/2018 There is a case that the pressure becomes zero at the start}}
\DoxyCodeLine{00390       \textcolor{comment}{// and the end of stroke. For such case, stroke should not be cancelled.}}
\DoxyCodeLine{00391       \textcolor{comment}{// So, added a process to finish stroke here instead of cancelling.}}
\DoxyCodeLine{00392       \textcolor{comment}{// This will be called only if the state is OnStroke so at the start}}
\DoxyCodeLine{00393       \textcolor{comment}{// of the stroke this condition will be passed.}}
\DoxyCodeLine{00394       \textcolor{keywordflow}{if} (m\_tabletState == OnStroke \&\& m\_pressure == 0.0) \{}
\DoxyCodeLine{00395         m\_tabletState       = Released;}
\DoxyCodeLine{00396         mouseEvent.m\_button = Qt::LeftButton;}
\DoxyCodeLine{00397         onRelease(mouseEvent);}
\DoxyCodeLine{00398       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00399         m\_tabletMove = \textcolor{keyword}{true};}
\DoxyCodeLine{00400         onMove(mouseEvent);  \textcolor{comment}{// m\_tabletState is set to OnStrole here}}
\DoxyCodeLine{00401       \}}
\DoxyCodeLine{00402     \}}
\DoxyCodeLine{00403 \textcolor{preprocessor}{\#ifdef MACOSX}}
\DoxyCodeLine{00404     \textcolor{comment}{// call the fake leave event if the pen is hovering the viewer edge}}
\DoxyCodeLine{00405     \textcolor{keywordflow}{if} (!isHoveringInsideViewer) onLeave();}
\DoxyCodeLine{00406 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00407   \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{00408   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00409     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00410   \}}
\DoxyCodeLine{00411   e-\/>accept();}
\DoxyCodeLine{00412 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ab24ab9bd8c81be905d366154463b81df}\label{class_scene_viewer_ab24ab9bd8c81be905d366154463b81df}} 
\index{SceneViewer@{SceneViewer}!touchEvent@{touchEvent}}
\index{touchEvent@{touchEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{touchEvent()}{touchEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::touch\+Event (\begin{DoxyParamCaption}\item[{QTouch\+Event $\ast$}]{e,  }\item[{int}]{type }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01092                                                      \{}
\DoxyCodeLine{01093   \textcolor{keywordflow}{if} (type == QEvent::TouchBegin) \{}
\DoxyCodeLine{01094     \textcolor{keywordflow}{if} (m\_tabletEvent) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01095 }
\DoxyCodeLine{01096     m\_touchActive   = \textcolor{keyword}{true};}
\DoxyCodeLine{01097     m\_firstPanPoint = e-\/>touchPoints().at(0).pos();}
\DoxyCodeLine{01098     m\_undoPoint     = m\_firstPanPoint;}
\DoxyCodeLine{01099     \textcolor{comment}{// obtain device type}}
\DoxyCodeLine{01100     m\_touchDevice = e-\/>device()-\/>type();}
\DoxyCodeLine{01101   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_touchActive) \{}
\DoxyCodeLine{01102     \textcolor{comment}{// touchpads must have 2 finger panning for tools and navigation to be}}
\DoxyCodeLine{01103     \textcolor{comment}{// functional}}
\DoxyCodeLine{01104     \textcolor{comment}{// on other devices, 1 finger panning is preferred}}
\DoxyCodeLine{01105     \textcolor{keywordflow}{if} ((e-\/>touchPoints().count() == 2 \&\&}
\DoxyCodeLine{01106          m\_touchDevice == QTouchDevice::TouchPad) ||}
\DoxyCodeLine{01107         (e-\/>touchPoints().count() == 1 \&\&}
\DoxyCodeLine{01108          m\_touchDevice == QTouchDevice::TouchScreen)) \{}
\DoxyCodeLine{01109       QTouchEvent::TouchPoint panPoint = e-\/>touchPoints().at(0);}
\DoxyCodeLine{01110       \textcolor{keywordflow}{if} (!m\_panning) \{}
\DoxyCodeLine{01111         QPointF deltaPoint = panPoint.pos() -\/ m\_firstPanPoint;}
\DoxyCodeLine{01112         \textcolor{comment}{// minimize accidental and jerky zooming/rotating during 2 finger}}
\DoxyCodeLine{01113         \textcolor{comment}{// panning}}
\DoxyCodeLine{01114         \textcolor{keywordflow}{if} ((deltaPoint.manhattanLength() > 100) \&\& !m\_zooming \&\& !m\_rotating) \{}
\DoxyCodeLine{01115           m\_panning = \textcolor{keyword}{true};}
\DoxyCodeLine{01116         \}}
\DoxyCodeLine{01117       \}}
\DoxyCodeLine{01118       \textcolor{keywordflow}{if} (m\_panning) \{}
\DoxyCodeLine{01119         QPointF centerDelta = (panPoint.pos() * getDevPixRatio()) -\/}
\DoxyCodeLine{01120                               (panPoint.lastPos() * getDevPixRatio());}
\DoxyCodeLine{01121         panQt(centerDelta.toPoint());}
\DoxyCodeLine{01122       \}}
\DoxyCodeLine{01123     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (e-\/>touchPoints().count() == 3) \{}
\DoxyCodeLine{01124       QPointF newPoint = e-\/>touchPoints().at(0).pos();}
\DoxyCodeLine{01125       \textcolor{keywordflow}{if} (m\_undoPoint.x() -\/ newPoint.x() > 100) \{}
\DoxyCodeLine{01126         CommandManager::instance()-\/>execute(\textcolor{stringliteral}{"{}MI\_Undo"{}});}
\DoxyCodeLine{01127         m\_undoPoint = newPoint;}
\DoxyCodeLine{01128       \}}
\DoxyCodeLine{01129       \textcolor{keywordflow}{if} (m\_undoPoint.x() -\/ newPoint.x() < -\/100) \{}
\DoxyCodeLine{01130         CommandManager::instance()-\/>execute(\textcolor{stringliteral}{"{}MI\_Redo"{}});}
\DoxyCodeLine{01131         m\_undoPoint = newPoint;}
\DoxyCodeLine{01132       \}}
\DoxyCodeLine{01133     \}}
\DoxyCodeLine{01134   \}}
\DoxyCodeLine{01135   \textcolor{keywordflow}{if} (type == QEvent::TouchEnd || type == QEvent::TouchCancel) \{}
\DoxyCodeLine{01136     m\_touchActive = \textcolor{keyword}{false};}
\DoxyCodeLine{01137     m\_panning     = \textcolor{keyword}{false};}
\DoxyCodeLine{01138   \}}
\DoxyCodeLine{01139   e-\/>accept();}
\DoxyCodeLine{01140 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a91ae075d7414f6b91b6e8336c05d6936}\label{class_scene_viewer_a91ae075d7414f6b91b6e8336c05d6936}} 
\index{SceneViewer@{SceneViewer}!wheelEvent@{wheelEvent}}
\index{wheelEvent@{wheelEvent}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{wheelEvent()}{wheelEvent()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::wheel\+Event (\begin{DoxyParamCaption}\item[{QWheel\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00937                                                \{}
\DoxyCodeLine{00938   \textcolor{keywordflow}{if} (m\_freezedStatus != NO\_FREEZED) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00939 }
\DoxyCodeLine{00940   \textcolor{keywordtype}{int} delta = 0;}
\DoxyCodeLine{00941   \textcolor{keywordflow}{switch} (event-\/>source()) \{}
\DoxyCodeLine{00942   \textcolor{keywordflow}{case} Qt::MouseEventNotSynthesized: \{}
\DoxyCodeLine{00943     \textcolor{keywordflow}{if} (event-\/>modifiers() \& Qt::AltModifier)}
\DoxyCodeLine{00944       delta = \textcolor{keyword}{event}-\/>angleDelta().x();}
\DoxyCodeLine{00945     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00946       delta = \textcolor{keyword}{event}-\/>angleDelta().y();}
\DoxyCodeLine{00947     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00948   \}}
\DoxyCodeLine{00949 }
\DoxyCodeLine{00950   \textcolor{keywordflow}{case} Qt::MouseEventSynthesizedBySystem: \{}
\DoxyCodeLine{00951     QPoint numPixels  = \textcolor{keyword}{event}-\/>pixelDelta();}
\DoxyCodeLine{00952     QPoint numDegrees = \textcolor{keyword}{event}-\/>angleDelta() / 8;}
\DoxyCodeLine{00953     \textcolor{keywordflow}{if} (!numPixels.isNull()) \{}
\DoxyCodeLine{00954       delta = \textcolor{keyword}{event}-\/>pixelDelta().y();}
\DoxyCodeLine{00955     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!numDegrees.isNull()) \{}
\DoxyCodeLine{00956       QPoint numSteps = numDegrees / 15;}
\DoxyCodeLine{00957       delta           = numSteps.y();}
\DoxyCodeLine{00958     \}}
\DoxyCodeLine{00959     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00960   \}}
\DoxyCodeLine{00961 }
\DoxyCodeLine{00962   \textcolor{keywordflow}{default}:  \textcolor{comment}{// Qt::MouseEventSynthesizedByQt,}}
\DoxyCodeLine{00963             \textcolor{comment}{// Qt::MouseEventSynthesizedByApplication}}
\DoxyCodeLine{00964   \{}
\DoxyCodeLine{00965     std::cout << \textcolor{stringliteral}{"{}not supported event: Qt::MouseEventSynthesizedByQt, "{}}}
\DoxyCodeLine{00966                  \textcolor{stringliteral}{"{}Qt::MouseEventSynthesizedByApplication"{}}}
\DoxyCodeLine{00967               << std::endl;}
\DoxyCodeLine{00968     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00969   \}}
\DoxyCodeLine{00970 }
\DoxyCodeLine{00971   \}  \textcolor{comment}{// end switch}}
\DoxyCodeLine{00972 }
\DoxyCodeLine{00973   \textcolor{keywordflow}{if} (abs(delta) > 0) \{}
\DoxyCodeLine{00974     \textcolor{comment}{// scrub with mouse wheel}}
\DoxyCodeLine{00975     \textcolor{keywordflow}{if} ((event-\/>modifiers() \& Qt::AltModifier) \&\&}
\DoxyCodeLine{00976         (event-\/>modifiers() \& Qt::ShiftModifier) \&\&}
\DoxyCodeLine{00977         (event-\/>modifiers() \& Qt::ControlModifier)) \{}
\DoxyCodeLine{00978       \textcolor{keywordflow}{if} (delta < 0) \{}
\DoxyCodeLine{00979         CommandManager::instance()-\/>execute(\textcolor{stringliteral}{"{}MI\_NextStep"{}});}
\DoxyCodeLine{00980       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (delta > 0) \{}
\DoxyCodeLine{00981         CommandManager::instance()-\/>execute(\textcolor{stringliteral}{"{}MI\_PrevStep"{}});}
\DoxyCodeLine{00982       \}}
\DoxyCodeLine{00983     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((event-\/>modifiers() \& Qt::ControlModifier) \&\&}
\DoxyCodeLine{00984                (event-\/>modifiers() \& Qt::ShiftModifier)) \{}
\DoxyCodeLine{00985       \textcolor{keywordflow}{if} (delta < 0) \{}
\DoxyCodeLine{00986         CommandManager::instance()-\/>execute(\textcolor{stringliteral}{"{}MI\_NextFrame"{}});}
\DoxyCodeLine{00987       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (delta > 0) \{}
\DoxyCodeLine{00988         CommandManager::instance()-\/>execute(\textcolor{stringliteral}{"{}MI\_PrevFrame"{}});}
\DoxyCodeLine{00989       \}}
\DoxyCodeLine{00990     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((event-\/>modifiers() \& Qt::ShiftModifier) \&\&}
\DoxyCodeLine{00991                (event-\/>modifiers() \& Qt::AltModifier)) \{}
\DoxyCodeLine{00992       \textcolor{keywordflow}{if} (delta < 0) \{}
\DoxyCodeLine{00993         CommandManager::instance()-\/>execute(\textcolor{stringliteral}{"{}MI\_NextDrawing"{}});}
\DoxyCodeLine{00994       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (delta > 0) \{}
\DoxyCodeLine{00995         CommandManager::instance()-\/>execute(\textcolor{stringliteral}{"{}MI\_PrevDrawing"{}});}
\DoxyCodeLine{00996       \}}
\DoxyCodeLine{00997     \}}
\DoxyCodeLine{00998     \textcolor{comment}{// Mouse wheel zoom interfered with touchpad panning (touch enabled)}}
\DoxyCodeLine{00999     \textcolor{comment}{// Now if touch is enabled, touchpads ignore the mouse wheel zoom}}
\DoxyCodeLine{01000     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((m\_gestureActive == \textcolor{keyword}{true} \&\&}
\DoxyCodeLine{01001               m\_touchDevice == QTouchDevice::TouchScreen) ||}
\DoxyCodeLine{01002              m\_gestureActive == \textcolor{keyword}{false}) \{}
\DoxyCodeLine{01003       zoomQt(event-\/>pos() * getDevPixRatio(), exp(0.001 * delta));}
\DoxyCodeLine{01004       m\_panning = \textcolor{keyword}{false};}
\DoxyCodeLine{01005     \}}
\DoxyCodeLine{01006   \}}
\DoxyCodeLine{01007   \textcolor{keyword}{event}-\/>accept();}
\DoxyCodeLine{01008 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_ac1a70ad1c9fc56002d67b8a6f6609e55}\label{class_scene_viewer_ac1a70ad1c9fc56002d67b8a6f6609e55}} 
\index{SceneViewer@{SceneViewer}!winToWorld@{winToWorld}}
\index{winToWorld@{winToWorld}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{winToWorld()}{winToWorld()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPointD}} Scene\+Viewer\+::win\+To\+World (\begin{DoxyParamCaption}\item[{const QPointF \&}]{pos }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00961                                                         \{}
\DoxyCodeLine{00962   \textcolor{comment}{// coordinate window (origine in alto a sinistra) -\/> coordinate colonna}}
\DoxyCodeLine{00963   \textcolor{comment}{// (origine al centro dell'immagine)}}
\DoxyCodeLine{00964   \mbox{\hyperlink{class_t_point_t}{TPointD}} pp(pos.x() -\/ (\textcolor{keywordtype}{double})width() / 2.0,}
\DoxyCodeLine{00965              -\/pos.y() + (\textcolor{keywordtype}{double})height() / 2.0);}
\DoxyCodeLine{00966   \textcolor{keywordflow}{if} (is3DView()) \{}
\DoxyCodeLine{00967     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh            = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet();}
\DoxyCodeLine{00968     \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} cameraId = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a5dc925584e35e1678f5678b79c470959}{getStageObjectTree}}()-\/>\mbox{\hyperlink{class_t_stage_object_tree_a7d63ae5d60c3a3aacf5da58c108ac167}{getCurrentCameraId}}();}
\DoxyCodeLine{00969     \textcolor{keywordtype}{double} z                = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(cameraId)-\/>\mbox{\hyperlink{class_t_stage_object_a52b1a3ec50ed35fbc07c9a3b64ecc21c}{getZ}}(}
\DoxyCodeLine{00970         \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getCurrentFrame()-\/>getFrame());}
\DoxyCodeLine{00971 }
\DoxyCodeLine{00972     \mbox{\hyperlink{class_t_point_t}{TPointD}} p(pp.x -\/ m\_pan3D.x, pp.y -\/ m\_pan3D.y);}
\DoxyCodeLine{00973     p               = p * (1 / m\_zoomScale3D);}
\DoxyCodeLine{00974     \textcolor{keywordtype}{double} theta    = m\_theta3D * M\_PI\_180;}
\DoxyCodeLine{00975     \textcolor{keywordtype}{double} phi      = m\_phi3D * M\_PI\_180;}
\DoxyCodeLine{00976     \textcolor{keywordtype}{double} cs\_phi   = cos(phi);}
\DoxyCodeLine{00977     \textcolor{keywordtype}{double} sn\_phi   = sin(phi);}
\DoxyCodeLine{00978     \textcolor{keywordtype}{double} cs\_theta = cos(theta);}
\DoxyCodeLine{00979     \textcolor{keywordtype}{double} sn\_theta = sin(theta);}
\DoxyCodeLine{00980     \mbox{\hyperlink{class_t_point_t}{TPointD}} a(cs\_phi, sn\_theta * sn\_phi);   \textcolor{comment}{// proiezione di (1,0,0)}}
\DoxyCodeLine{00981     \mbox{\hyperlink{class_t_point_t}{TPointD}} b(0, cs\_theta);                 \textcolor{comment}{// proiezione di (0,1,0)}}
\DoxyCodeLine{00982     \mbox{\hyperlink{class_t_point_t}{TPointD}} c(sn\_phi, -\/sn\_theta * cs\_phi);  \textcolor{comment}{// proiezione di (0,0,1)}}
\DoxyCodeLine{00983     \mbox{\hyperlink{class_t_point_t}{TPointD}} aa = rotate90(a);}
\DoxyCodeLine{00984     \mbox{\hyperlink{class_t_point_t}{TPointD}} bb = rotate90(b);}
\DoxyCodeLine{00985 }
\DoxyCodeLine{00986     \textcolor{keywordtype}{double} abb = a * bb;}
\DoxyCodeLine{00987     \textcolor{keywordtype}{double} baa = b * aa;}
\DoxyCodeLine{00988     \textcolor{keywordflow}{if} (fabs(abb) > 0.001 \&\& fabs(baa) > 0.001) \{}
\DoxyCodeLine{00989       p -\/= c * z;}
\DoxyCodeLine{00990       \mbox{\hyperlink{class_t_point_t}{TPointD}} g((p * bb) / (a * bb), (p * aa) / (b * aa));}
\DoxyCodeLine{00991       \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_affine}{TAffine}}() * g;}
\DoxyCodeLine{00992     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00993       \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_affine}{TAffine}}() * \mbox{\hyperlink{class_t_point_t}{TPointD}}(0, 0);}
\DoxyCodeLine{00994   \}}
\DoxyCodeLine{00995 }
\DoxyCodeLine{00996   \textcolor{keywordflow}{return} \mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * pp;}
\DoxyCodeLine{00997 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a66e2243fc4447eddb73d6fc09d1a112b}\label{class_scene_viewer_a66e2243fc4447eddb73d6fc09d1a112b}} 
\index{SceneViewer@{SceneViewer}!winToWorld@{winToWorld}}
\index{winToWorld@{winToWorld}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{winToWorld()}{winToWorld()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPointD}} Scene\+Viewer\+::win\+To\+World (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{win\+Pos }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01001                                                            \{}
\DoxyCodeLine{01002   \textcolor{keywordflow}{return} winToWorld(QPointF(winPos.x, height() -\/ winPos.y));}
\DoxyCodeLine{01003 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_aeb3a1d375ff7172f35364adc9cc0500e}\label{class_scene_viewer_aeb3a1d375ff7172f35364adc9cc0500e}} 
\index{SceneViewer@{SceneViewer}!worldToPos@{worldToPos}}
\index{worldToPos@{worldToPos}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{worldToPos()}{worldToPos()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPointD}} Scene\+Viewer\+::world\+To\+Pos (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{world\+Pos }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



return pos in pixel, bottom-\/left origin 



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer_a00ad8f88b4832e92cfd91b3f5ba8efd6}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01007                                                              \{}
\DoxyCodeLine{01008   \mbox{\hyperlink{class_t_point_t}{TPointD}} p = \mbox{\hyperlink{class_scene_viewer_a3f746b9c53dc17030711cac65d96f625}{getViewMatrix}}() * worldPos;}
\DoxyCodeLine{01009   \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_point_t}{TPointD}}(width() / 2 + p.x, height() / 2 + p.y);}
\DoxyCodeLine{01010 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l02211}{get\+View\+Matrix()}}.

\mbox{\Hypertarget{class_scene_viewer_a1144b3007e23076105bd42b02a127e9d}\label{class_scene_viewer_a1144b3007e23076105bd42b02a127e9d}} 
\index{SceneViewer@{SceneViewer}!zoom@{zoom}}
\index{zoom@{zoom}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{zoom()}{zoom()}}
{\footnotesize\ttfamily void Scene\+Viewer\+::zoom (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{center,  }\item[{double}]{factor }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool_1_1_viewer}{TTool\+::\+Viewer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02531                                                            \{}
\DoxyCodeLine{02532   zoomQt(QPoint(center.x, height() -\/ center.y), factor);}
\DoxyCodeLine{02533 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a2d4cced2ccad45e662e734ec7be5a856}\label{class_scene_viewer_a2d4cced2ccad45e662e734ec7be5a856}} 
\index{SceneViewer@{SceneViewer}!zoomIn@{zoomIn}}
\index{zoomIn@{zoomIn}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{zoomIn}{zoomIn}}
{\footnotesize\ttfamily void Scene\+Viewer\+::zoom\+In (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02579                          \{}
\DoxyCodeLine{02580   m\_lastMousePos = rect().center();}
\DoxyCodeLine{02581   zoomQt(\textcolor{keyword}{true}, \textcolor{keyword}{false});}
\DoxyCodeLine{02582 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a3bbf29560bedb29d0004a13159e56d29}\label{class_scene_viewer_a3bbf29560bedb29d0004a13159e56d29}} 
\index{SceneViewer@{SceneViewer}!zoomOut@{zoomOut}}
\index{zoomOut@{zoomOut}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{zoomOut}{zoomOut}}
{\footnotesize\ttfamily void Scene\+Viewer\+::zoom\+Out (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02586                           \{}
\DoxyCodeLine{02587   m\_lastMousePos = rect().center();}
\DoxyCodeLine{02588   zoomQt(\textcolor{keyword}{false}, \textcolor{keyword}{false});}
\DoxyCodeLine{02589 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_aee4ed44d7e7e472a7fc22cf7c9db1360}\label{class_scene_viewer_aee4ed44d7e7e472a7fc22cf7c9db1360}} 
\index{SceneViewer@{SceneViewer}!zoomQt@{zoomQt}}
\index{zoomQt@{zoomQt}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{zoomQt()}{zoomQt()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Scene\+Viewer\+::zoom\+Qt (\begin{DoxyParamCaption}\item[{bool}]{forward,  }\item[{bool}]{reset }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02318                                                  \{}
\DoxyCodeLine{02319   \mbox{\hyperlink{class_t_point_t}{TPointD}} delta(m\_lastMousePos.x() -\/ width() / 2,}
\DoxyCodeLine{02320                 -\/m\_lastMousePos.y() + height() / 2);}
\DoxyCodeLine{02321 }
\DoxyCodeLine{02322   \textcolor{keywordflow}{if} (is3DView()) \{}
\DoxyCodeLine{02323     \textcolor{keywordflow}{if} (reset || ((m\_zoomScale3D < 500 || !forward) \&\&}
\DoxyCodeLine{02324                   (m\_zoomScale3D > 0.01 || forward))) \{}
\DoxyCodeLine{02325       \textcolor{keywordtype}{double} oldZoomScale = m\_zoomScale3D;}
\DoxyCodeLine{02326       m\_zoomScale3D =}
\DoxyCodeLine{02327           reset ? 1}
\DoxyCodeLine{02328                 : ImageUtils::getQuantizedZoomFactor(m\_zoomScale3D, forward);}
\DoxyCodeLine{02329 }
\DoxyCodeLine{02330       m\_pan3D = -\/(m\_zoomScale3D / oldZoomScale) * -\/m\_pan3D;}
\DoxyCodeLine{02331     \}}
\DoxyCodeLine{02332   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02333     \textcolor{comment}{// a factor for getting pixel-\/based zoom ratio}}
\DoxyCodeLine{02334     \textcolor{keywordtype}{double} dpiFactor = \mbox{\hyperlink{class_scene_viewer_a7fd1e40caee87c57edd5d890dc41b8c8}{getDpiFactor}}();}
\DoxyCodeLine{02335     \textcolor{comment}{// when showing the viewer with full-\/screen mode,}}
\DoxyCodeLine{02336     \textcolor{comment}{// add a zoom factor which can show image fitting with the screen size}}
\DoxyCodeLine{02337     \textcolor{keywordtype}{double} zoomScaleFittingWithScreen = 0.0f;}
\DoxyCodeLine{02338     \textcolor{keywordflow}{if} (dpiFactor != 1.0) \{}
\DoxyCodeLine{02339       \textcolor{comment}{// check if the viewer is in full screen mode}}
\DoxyCodeLine{02340       \mbox{\hyperlink{class_image_utils_1_1_full_screen_widget}{ImageUtils::FullScreenWidget}} *fsWidget =}
\DoxyCodeLine{02341           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_image_utils_1_1_full_screen_widget}{ImageUtils::FullScreenWidget}} *\textcolor{keyword}{>}(parentWidget());}
\DoxyCodeLine{02342       \textcolor{keywordflow}{if} (fsWidget \&\& (fsWidget-\/>windowState() \& Qt::WindowFullScreen) != 0)}
\DoxyCodeLine{02343         zoomScaleFittingWithScreen = \mbox{\hyperlink{class_scene_viewer_abc2a1a75cd067ec5588dfdbd583d483b}{getZoomScaleFittingWithScreen}}();}
\DoxyCodeLine{02344     \}}
\DoxyCodeLine{02345 }
\DoxyCodeLine{02346     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{02347 }
\DoxyCodeLine{02348     \textcolor{keywordflow}{for} (i = 0; i < 2; i++) \{}
\DoxyCodeLine{02349       \mbox{\hyperlink{class_t_affine}{TAffine}} \&viewAff = m\_viewAff[i];}
\DoxyCodeLine{02350       \textcolor{keywordflow}{if} (m\_isFlippedX) viewAff = viewAff * \mbox{\hyperlink{class_t_scale}{TScale}}(-\/1, 1);}
\DoxyCodeLine{02351       \textcolor{keywordflow}{if} (m\_isFlippedX) viewAff = viewAff * \mbox{\hyperlink{class_t_scale}{TScale}}(1, -\/1);}
\DoxyCodeLine{02352       \textcolor{keywordtype}{double} scale2 = std::abs(viewAff.det());}
\DoxyCodeLine{02353       \textcolor{keywordflow}{if} (m\_isFlippedX) viewAff = viewAff * \mbox{\hyperlink{class_t_scale}{TScale}}(-\/1, 1);}
\DoxyCodeLine{02354       \textcolor{keywordflow}{if} (m\_isFlippedX) viewAff = viewAff * \mbox{\hyperlink{class_t_scale}{TScale}}(1, -\/1);}
\DoxyCodeLine{02355       \textcolor{keywordflow}{if} (reset || ((scale2 < 100000 || !forward) \&\&}
\DoxyCodeLine{02356                     (scale2 > 0.001 * 0.05 || forward))) \{}
\DoxyCodeLine{02357         \textcolor{keywordtype}{double} oldZoomScale = sqrt(scale2) * dpiFactor;}
\DoxyCodeLine{02358         \textcolor{keywordtype}{double} zoomScale =}
\DoxyCodeLine{02359             reset ? 1}
\DoxyCodeLine{02360                   : ImageUtils::getQuantizedZoomFactor(oldZoomScale, forward);}
\DoxyCodeLine{02361 }
\DoxyCodeLine{02362         \textcolor{comment}{// threshold value -\/0.001 is intended to absorb the error of calculation}}
\DoxyCodeLine{02363         \textcolor{keywordflow}{if} ((oldZoomScale -\/ zoomScaleFittingWithScreen) *}
\DoxyCodeLine{02364                 (zoomScale -\/ zoomScaleFittingWithScreen) <}
\DoxyCodeLine{02365             -\/0.001)}
\DoxyCodeLine{02366           zoomScale = zoomScaleFittingWithScreen;}
\DoxyCodeLine{02367         \textcolor{comment}{// zoom center = viewer center}}
\DoxyCodeLine{02368         \textcolor{keywordflow}{if} (Preferences::instance()-\/>getViewerZoomCenter())}
\DoxyCodeLine{02369           setViewMatrix(\mbox{\hyperlink{class_t_scale}{TScale}}(zoomScale / oldZoomScale) * viewAff, i);}
\DoxyCodeLine{02370         \textcolor{comment}{// zoom center = mouse pos}}
\DoxyCodeLine{02371         \textcolor{keywordflow}{else}}
\DoxyCodeLine{02372           setViewMatrix(\mbox{\hyperlink{class_t_translation}{TTranslation}}(delta) * \mbox{\hyperlink{class_t_scale}{TScale}}(zoomScale / oldZoomScale) *}
\DoxyCodeLine{02373                             \mbox{\hyperlink{class_t_translation}{TTranslation}}(-\/delta) * viewAff,}
\DoxyCodeLine{02374                         i);}
\DoxyCodeLine{02375       \}}
\DoxyCodeLine{02376     \}}
\DoxyCodeLine{02377   \}}
\DoxyCodeLine{02378 }
\DoxyCodeLine{02379   \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidateAll}}();}
\DoxyCodeLine{02380   emit onZoomChanged();}
\DoxyCodeLine{02381 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_scene_viewer_a474e47442ee803ddb71c6d5484806b28}\label{class_scene_viewer_a474e47442ee803ddb71c6d5484806b28}} 
\index{SceneViewer@{SceneViewer}!zoomQt@{zoomQt}}
\index{zoomQt@{zoomQt}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{zoomQt()}{zoomQt()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Scene\+Viewer\+::zoom\+Qt (\begin{DoxyParamCaption}\item[{const QPoint \&}]{center,  }\item[{double}]{scale\+Factor }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{02495                                                             \{}
\DoxyCodeLine{02496   \textcolor{keywordflow}{if} (factor == 1.0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{02497   \mbox{\hyperlink{class_t_point_t}{TPointD}} delta(center.x() -\/ width() / 2, -\/center.y() + height() / 2);}
\DoxyCodeLine{02498   \textcolor{keywordtype}{double} oldZoomScale = m\_zoomScale3D;}
\DoxyCodeLine{02499 }
\DoxyCodeLine{02500   \textcolor{keywordflow}{if} (is3DView()) \{}
\DoxyCodeLine{02501     \textcolor{keywordflow}{if} ((m\_zoomScale3D < 500 || factor < 1) \&\&}
\DoxyCodeLine{02502         (m\_zoomScale3D > 0.01 || factor > 1)) \{}
\DoxyCodeLine{02503       m\_zoomScale3D *= factor;}
\DoxyCodeLine{02504       m\_pan3D = -\/(m\_zoomScale3D / oldZoomScale) * (delta -\/ m\_pan3D) + delta;}
\DoxyCodeLine{02505     \}}
\DoxyCodeLine{02506   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02507     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{02508     \textcolor{keywordflow}{for} (i = 0; i < 2; i++) \{}
\DoxyCodeLine{02509       \mbox{\hyperlink{class_t_affine}{TAffine}} \&viewAff = m\_viewAff[i];}
\DoxyCodeLine{02510       \textcolor{keywordtype}{double} scale2    = fabs(viewAff.det());}
\DoxyCodeLine{02511       \textcolor{keywordflow}{if} ((scale2 < 100000 || factor < 1) \&\&}
\DoxyCodeLine{02512           (scale2 > 0.001 * 0.05 || factor > 1)) \{}
\DoxyCodeLine{02513         \textcolor{keywordflow}{if} (i == m\_viewMode) \{}
\DoxyCodeLine{02514           \textcolor{comment}{// viewAff = TTranslation(delta) * TScale(factor) *}}
\DoxyCodeLine{02515           \textcolor{comment}{// TTranslation(-\/delta) * viewAff;}}
\DoxyCodeLine{02516           setViewMatrix(\mbox{\hyperlink{class_t_translation}{TTranslation}}(delta) * \mbox{\hyperlink{class_t_scale}{TScale}}(factor) *}
\DoxyCodeLine{02517                             \mbox{\hyperlink{class_t_translation}{TTranslation}}(-\/delta) * viewAff,}
\DoxyCodeLine{02518                         i);}
\DoxyCodeLine{02519         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02520           \textcolor{comment}{// viewAff = TScale(factor) * viewAff;}}
\DoxyCodeLine{02521           setViewMatrix(\mbox{\hyperlink{class_t_scale}{TScale}}(factor) * viewAff, i);}
\DoxyCodeLine{02522         \}}
\DoxyCodeLine{02523       \}}
\DoxyCodeLine{02524     \}}
\DoxyCodeLine{02525   \}}
\DoxyCodeLine{02526 }
\DoxyCodeLine{02527   \mbox{\hyperlink{class_scene_viewer_ab96170500b3df72aa36a3deb5f69cc11}{GLInvalidateAll}}();}
\DoxyCodeLine{02528   emit onZoomChanged();}
\DoxyCodeLine{02529 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_scene_viewer_a121d535ed9bd89cfa48c5542ca468828}\label{class_scene_viewer_a121d535ed9bd89cfa48c5542ca468828}} 
\index{SceneViewer@{SceneViewer}!m\_actualClipRect@{m\_actualClipRect}}
\index{m\_actualClipRect@{m\_actualClipRect}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{m\_actualClipRect}{m\_actualClipRect}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_rect_t}{TRect}} Scene\+Viewer\+::m\+\_\+actual\+Clip\+Rect\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_scene_viewer_ad23acf9952775fe08a93239d56b7c241}\label{class_scene_viewer_ad23acf9952775fe08a93239d56b7c241}} 
\index{SceneViewer@{SceneViewer}!m\_draw3DMode@{m\_draw3DMode}}
\index{m\_draw3DMode@{m\_draw3DMode}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{m\_draw3DMode}{m\_draw3DMode}}
{\footnotesize\ttfamily bool Scene\+Viewer\+::m\+\_\+draw3\+DMode\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_scene_viewer_a72a668b675b54e9c1518c473d9a34193}\label{class_scene_viewer_a72a668b675b54e9c1518c473d9a34193}} 
\index{SceneViewer@{SceneViewer}!m\_drawCameraAff@{m\_drawCameraAff}}
\index{m\_drawCameraAff@{m\_drawCameraAff}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{m\_drawCameraAff}{m\_drawCameraAff}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_affine}{TAffine}} Scene\+Viewer\+::m\+\_\+draw\+Camera\+Aff\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_scene_viewer_a458f78b423b3f1447987aa9c1190de47}\label{class_scene_viewer_a458f78b423b3f1447987aa9c1190de47}} 
\index{SceneViewer@{SceneViewer}!m\_drawCameraTest@{m\_drawCameraTest}}
\index{m\_drawCameraTest@{m\_drawCameraTest}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{m\_drawCameraTest}{m\_drawCameraTest}}
{\footnotesize\ttfamily bool Scene\+Viewer\+::m\+\_\+draw\+Camera\+Test\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_scene_viewer_a080fbba06260c062057ceca5e9bb164e}\label{class_scene_viewer_a080fbba06260c062057ceca5e9bb164e}} 
\index{SceneViewer@{SceneViewer}!m\_drawEditingLevel@{m\_drawEditingLevel}}
\index{m\_drawEditingLevel@{m\_drawEditingLevel}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{m\_drawEditingLevel}{m\_drawEditingLevel}}
{\footnotesize\ttfamily bool Scene\+Viewer\+::m\+\_\+draw\+Editing\+Level\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_scene_viewer_aab69590762709fa8e8a3ae1c1a459145}\label{class_scene_viewer_aab69590762709fa8e8a3ae1c1a459145}} 
\index{SceneViewer@{SceneViewer}!m\_drawIsTableVisible@{m\_drawIsTableVisible}}
\index{m\_drawIsTableVisible@{m\_drawIsTableVisible}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{m\_drawIsTableVisible}{m\_drawIsTableVisible}}
{\footnotesize\ttfamily bool Scene\+Viewer\+::m\+\_\+draw\+Is\+Table\+Visible\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_scene_viewer_aaf3c82f7af6c36fc5950e84c8e400ffb}\label{class_scene_viewer_aaf3c82f7af6c36fc5950e84c8e400ffb}} 
\index{SceneViewer@{SceneViewer}!m\_drawTableAff@{m\_drawTableAff}}
\index{m\_drawTableAff@{m\_drawTableAff}!SceneViewer@{SceneViewer}}
\doxysubsubsection{\texorpdfstring{m\_drawTableAff}{m\_drawTableAff}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_affine}{TAffine}} Scene\+Viewer\+::m\+\_\+draw\+Table\+Aff\hspace{0.3cm}{\ttfamily [protected]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonz/sceneviewer.\+h\item 
E\+:/opentoonz/toonz/sources/toonz/sceneviewer.\+cpp\item 
E\+:/opentoonz/toonz/sources/toonz/sceneviewerevents.\+cpp\end{DoxyCompactItemize}
