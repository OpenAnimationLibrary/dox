\hypertarget{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}{}\doxysection{tcg\+::polyline\+\_\+ops\+::\+\_\+\+Quadratics\+Edge\+Evaluator\texorpdfstring{$<$}{<} Point \texorpdfstring{$>$}{>} Class Template Reference}
\label{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}\index{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a2a65d05cc02570c553c13af15cf2560b}{point\+\_\+type}}
\item 
typedef \mbox{\hyperlink{structtcg_1_1point__traits}{tcg\+::point\+\_\+traits}}$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{point\+\_\+type}} $>$\+::value\+\_\+type \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_ae2ad8d4da88a83510c05afe5317fb9ee}{value\+\_\+type}}
\item 
typedef std\+::vector$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$\+::iterator \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a682cdf7a312c571ad1d53035c1a83090}{cp\+\_\+iterator}}
\item 
typedef \mbox{\hyperlink{classtcg_1_1step__iterator}{tcg\+::step\+\_\+iterator}}$<$ cp\+\_\+iterator $>$ \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_ad9f9300620ca9a7a89ed1218e3a10273}{quad\+\_\+iterator}}
\item 
typedef double \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a214b573d021e98b4727a5f6356e73a50}{penalty\+\_\+type}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_ac639631778bb562ccfc547b93585123f}{\+\_\+\+Quadratics\+Edge\+Evaluator}} (const \mbox{\hyperlink{classtcg_1_1step__iterator}{quad\+\_\+iterator}} \&begin, const \mbox{\hyperlink{classtcg_1_1step__iterator}{quad\+\_\+iterator}} \&end, penalty\+\_\+type tol)
\item 
\mbox{\hyperlink{classtcg_1_1step__iterator}{quad\+\_\+iterator}} \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a6ece29fd775675074a6538fe606e70c4}{furthest\+From}} (const \mbox{\hyperlink{classtcg_1_1step__iterator}{quad\+\_\+iterator}} \&a)
\item 
penalty\+\_\+type \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a2f5ba1475bc2b5d503384238fdde369d}{penalty}} (const \mbox{\hyperlink{classtcg_1_1step__iterator}{quad\+\_\+iterator}} \&a, const \mbox{\hyperlink{classtcg_1_1step__iterator}{quad\+\_\+iterator}} \&b)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename \mbox{\hyperlink{structtcg_1_1_point_t}{Point}}$>$\newline
class tcg\+::polyline\+\_\+ops\+::\+\_\+\+Quadratics\+Edge\+Evaluator$<$ Point $>$}


\doxysubsection{Member Typedef Documentation}
\mbox{\Hypertarget{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a682cdf7a312c571ad1d53035c1a83090}\label{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a682cdf7a312c571ad1d53035c1a83090}} 
\index{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}!cp\_iterator@{cp\_iterator}}
\index{cp\_iterator@{cp\_iterator}!tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}}
\doxysubsubsection{\texorpdfstring{cp\_iterator}{cp\_iterator}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$ \\
typedef std\+::vector$<$\mbox{\hyperlink{structtcg_1_1_point_t}{Point}}$>$\+::iterator \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}{tcg\+::polyline\+\_\+ops\+::\+\_\+\+Quadratics\+Edge\+Evaluator}}$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$\+::cp\+\_\+iterator}

\mbox{\Hypertarget{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a214b573d021e98b4727a5f6356e73a50}\label{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a214b573d021e98b4727a5f6356e73a50}} 
\index{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}!penalty\_type@{penalty\_type}}
\index{penalty\_type@{penalty\_type}!tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}}
\doxysubsubsection{\texorpdfstring{penalty\_type}{penalty\_type}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$ \\
typedef double \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}{tcg\+::polyline\+\_\+ops\+::\+\_\+\+Quadratics\+Edge\+Evaluator}}$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$\+::penalty\+\_\+type}

\mbox{\Hypertarget{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a2a65d05cc02570c553c13af15cf2560b}\label{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a2a65d05cc02570c553c13af15cf2560b}} 
\index{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}!point\_type@{point\_type}}
\index{point\_type@{point\_type}!tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}}
\doxysubsubsection{\texorpdfstring{point\_type}{point\_type}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$ \\
typedef \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}{tcg\+::polyline\+\_\+ops\+::\+\_\+\+Quadratics\+Edge\+Evaluator}}$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$\+::point\+\_\+type}

\mbox{\Hypertarget{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_ad9f9300620ca9a7a89ed1218e3a10273}\label{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_ad9f9300620ca9a7a89ed1218e3a10273}} 
\index{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}!quad\_iterator@{quad\_iterator}}
\index{quad\_iterator@{quad\_iterator}!tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}}
\doxysubsubsection{\texorpdfstring{quad\_iterator}{quad\_iterator}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$ \\
typedef \mbox{\hyperlink{classtcg_1_1step__iterator}{tcg\+::step\+\_\+iterator}}$<$cp\+\_\+iterator$>$ \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}{tcg\+::polyline\+\_\+ops\+::\+\_\+\+Quadratics\+Edge\+Evaluator}}$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$\+::quad\+\_\+iterator}

\mbox{\Hypertarget{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_ae2ad8d4da88a83510c05afe5317fb9ee}\label{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_ae2ad8d4da88a83510c05afe5317fb9ee}} 
\index{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}!value\_type@{value\_type}}
\index{value\_type@{value\_type}!tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}}
\doxysubsubsection{\texorpdfstring{value\_type}{value\_type}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$ \\
typedef \mbox{\hyperlink{structtcg_1_1point__traits}{tcg\+::point\+\_\+traits}}$<$\mbox{\hyperlink{structtcg_1_1_point_t}{point\+\_\+type}}$>$\+::value\+\_\+type \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}{tcg\+::polyline\+\_\+ops\+::\+\_\+\+Quadratics\+Edge\+Evaluator}}$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$\+::value\+\_\+type}



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_ac639631778bb562ccfc547b93585123f}\label{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_ac639631778bb562ccfc547b93585123f}} 
\index{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}!\_QuadraticsEdgeEvaluator@{\_QuadraticsEdgeEvaluator}}
\index{\_QuadraticsEdgeEvaluator@{\_QuadraticsEdgeEvaluator}!tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}}
\doxysubsubsection{\texorpdfstring{\_QuadraticsEdgeEvaluator()}{\_QuadraticsEdgeEvaluator()}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$ \\
\mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}{tcg\+::polyline\+\_\+ops\+::\+\_\+\+Quadratics\+Edge\+Evaluator}}$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$\+::\+\_\+\+Quadratics\+Edge\+Evaluator (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classtcg_1_1step__iterator}{quad\+\_\+iterator}} \&}]{begin,  }\item[{const \mbox{\hyperlink{classtcg_1_1step__iterator}{quad\+\_\+iterator}} \&}]{end,  }\item[{penalty\+\_\+type}]{tol }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00126     : m\_begin(begin), m\_end(end), m\_tol(tol) \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a6ece29fd775675074a6538fe606e70c4}\label{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a6ece29fd775675074a6538fe606e70c4}} 
\index{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}!furthestFrom@{furthestFrom}}
\index{furthestFrom@{furthestFrom}!tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}}
\doxysubsubsection{\texorpdfstring{furthestFrom()}{furthestFrom()}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$ \\
\mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}{\+\_\+\+Quadratics\+Edge\+Evaluator}}$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$\+::quad\+\_\+iterator \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}{tcg\+::polyline\+\_\+ops\+::\+\_\+\+Quadratics\+Edge\+Evaluator}}$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$\+::furthest\+From (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classtcg_1_1step__iterator}{quad\+\_\+iterator}} \&}]{a }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00132                                                                      \{}
\DoxyCodeLine{00133   \textcolor{keyword}{const} point\_type \&A  = *at;}
\DoxyCodeLine{00134   \textcolor{keyword}{const} point\_type \&A1 = *(at.it() + 1);}
\DoxyCodeLine{00135 }
\DoxyCodeLine{00136   \textcolor{comment}{// Build at (opposite) side}}
\DoxyCodeLine{00137   \textcolor{keywordtype}{int} atSide\_        = -\/\mbox{\hyperlink{namespacetcg_1_1numeric__ops_abd17f65a269ec069dc06d0f97e41fb77}{tcg::numeric\_ops::sign}}(cross(A -\/ A1, *(at + 1) -\/ A1));}
\DoxyCodeLine{00138   \textcolor{keywordtype}{bool} atSideNotZero = (atSide\_ != 0);}
\DoxyCodeLine{00139 }
\DoxyCodeLine{00140   quad\_iterator bt,}
\DoxyCodeLine{00141       last = this-\/>m\_end -\/ 1;          \textcolor{comment}{// Don't do the last (it's a dummy quad)}}
\DoxyCodeLine{00142   \textcolor{keywordflow}{for} (bt = at + 1; bt != last; ++bt)  \textcolor{comment}{// Always allow 1 step}}
\DoxyCodeLine{00143   \{}
\DoxyCodeLine{00144     \textcolor{comment}{// Trying to reach (bt + 1) from at}}
\DoxyCodeLine{00145     \textcolor{keyword}{const} point\_type \&C  = *(bt + 1);}
\DoxyCodeLine{00146     \textcolor{keyword}{const} point\_type \&C1 = *(bt.it() + 1);}
\DoxyCodeLine{00147 }
\DoxyCodeLine{00148     \textcolor{comment}{// Ensure that bt is not a corner}}
\DoxyCodeLine{00149     \textcolor{keywordflow}{if} (std::abs(tcg::point\_ops::cross(*(bt.it() -\/ 1) -\/ *bt, *(bt.it() + 1) -\/ *bt)) >}
\DoxyCodeLine{00150         1e-\/3)}
\DoxyCodeLine{00151       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00152 }
\DoxyCodeLine{00153     \textcolor{comment}{// Ensure there is no sign inversion}}
\DoxyCodeLine{00154     \textcolor{keywordtype}{int} btSide =}
\DoxyCodeLine{00155         \mbox{\hyperlink{namespacetcg_1_1numeric__ops_abd17f65a269ec069dc06d0f97e41fb77}{tcg::numeric\_ops::sign}}(tcg::point\_ops::cross(*bt -\/ C1, C -\/ C1));}
\DoxyCodeLine{00156     \textcolor{keywordflow}{if} (atSideNotZero \&\& btSide != 0 \&\& btSide == atSide\_) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00157 }
\DoxyCodeLine{00158     \textcolor{comment}{// Build the approximating new quad if any}}
\DoxyCodeLine{00159     value\_type s, t;}
\DoxyCodeLine{00160     \mbox{\hyperlink{namespacetcg_1_1point__ops_a2e7da2284b4335ef269917d51a30a6c8}{tcg::point\_ops::intersectionSegCoords}}(A, A1, C, C1, s, t, 1e-\/4);}
\DoxyCodeLine{00161     \textcolor{keywordflow}{if} (s == tcg::numeric\_ops::NaN<value\_type>()) \{}
\DoxyCodeLine{00162       \textcolor{comment}{// A-\/A1 and C1-\/C are parallel. There are 2 cases:}}
\DoxyCodeLine{00163       \textcolor{keywordflow}{if} ((A1 -\/ A) * (C -\/ C1) >= 0)}
\DoxyCodeLine{00164         \textcolor{comment}{// Either we're still on a straight line}}
\DoxyCodeLine{00165         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00166       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00167         \textcolor{comment}{// Or, we just can't build the new quad}}
\DoxyCodeLine{00168         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00169     \}}
\DoxyCodeLine{00170 }
\DoxyCodeLine{00171     point\_type B(A + s * (A1 -\/ A));}
\DoxyCodeLine{00172 }
\DoxyCodeLine{00173     point\_type A\_B(A -\/ B);}
\DoxyCodeLine{00174     point\_type AC\_2B(A\_B + C -\/ B);}
\DoxyCodeLine{00175 }
\DoxyCodeLine{00176     \textcolor{comment}{// Now, for each quadratic between at and bt, build the 'distance' from our}}
\DoxyCodeLine{00177     \textcolor{comment}{// new}}
\DoxyCodeLine{00178     \textcolor{comment}{// approximating quad (ABC)}}
\DoxyCodeLine{00179 }
\DoxyCodeLine{00180     quad\_iterator qt, end = bt + 1;}
\DoxyCodeLine{00181     \textcolor{keywordflow}{for} (qt = at; qt != end; ++qt) \{}
\DoxyCodeLine{00182       \textcolor{keyword}{const} point\_type \&Q\_A(*qt);}
\DoxyCodeLine{00183       \textcolor{keyword}{const} point\_type \&Q\_B(*(qt.it() + 1));}
\DoxyCodeLine{00184       \textcolor{keyword}{const} point\_type \&Q\_C(*(qt + 1));}
\DoxyCodeLine{00185 }
\DoxyCodeLine{00186       \textcolor{comment}{// Check the distance of Q\_B from the ABC tangent whose direction}}
\DoxyCodeLine{00187       \textcolor{comment}{// is the same as Q'\_B -\/ ie, Q\_A -\/> Q\_C.}}
\DoxyCodeLine{00188 }
\DoxyCodeLine{00189       point\_type dir(Q\_C -\/ Q\_A);}
\DoxyCodeLine{00190       value\_type dirNorm = tcg::point\_ops::norm(dir);}
\DoxyCodeLine{00191       \textcolor{keywordflow}{if} (dirNorm < 1e-\/4) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00192 }
\DoxyCodeLine{00193       dir = dir / dirNorm;}
\DoxyCodeLine{00194 }
\DoxyCodeLine{00195       value\_type den = tcg::point\_ops::cross(AC\_2B, dir);}
\DoxyCodeLine{00196       \textcolor{keywordflow}{if} (den < 1e-\/4 \&\& den > -\/1e-\/4) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00197 }
\DoxyCodeLine{00198       value\_type t = tcg::point\_ops::cross(A\_B, dir) / den;}
\DoxyCodeLine{00199       \textcolor{keywordflow}{if} (t < 0.0 || t > 1.0) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00200 }
\DoxyCodeLine{00201       value\_type t1 = 1.0 -\/ t;}
\DoxyCodeLine{00202       point\_type P(sq(t1) * A + 2.0 * t * t1 * B + sq(t) * C);}
\DoxyCodeLine{00203       point\_type Q(0.25 * Q\_A + 0.5 * Q\_B + 0.25 * Q\_C);}
\DoxyCodeLine{00204 }
\DoxyCodeLine{00205       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacetcg_1_1point__ops_a023f5394fd3b4e9d8dd57066b4e96253}{tcg::point\_ops::lineDist}}(Q, P, dir) > m\_tol) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00206 }
\DoxyCodeLine{00207       value\_type pos = ((P -\/ Q\_A) * dir);}
\DoxyCodeLine{00208       \textcolor{keywordflow}{if} (pos < 0.0 || pos > dirNorm) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00209       \textcolor{comment}{/*if(pos < -\/m\_tol || pos > dirNorm + m\_tol)     //Should this be relaxed}}
\DoxyCodeLine{00210 \textcolor{comment}{too?}}
\DoxyCodeLine{00211 \textcolor{comment}{break;*/}}
\DoxyCodeLine{00212 }
\DoxyCodeLine{00213       \textcolor{keywordflow}{if} (qt == bt) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00214 }
\DoxyCodeLine{00215       \textcolor{comment}{// Check the distance of Q\_C from the ABC tangent whose direction}}
\DoxyCodeLine{00216       \textcolor{comment}{// is the same as Q'\_C.}}
\DoxyCodeLine{00217 }
\DoxyCodeLine{00218       dir = tcg::point\_ops::direction(Q\_B, Q\_C);}
\DoxyCodeLine{00219 }
\DoxyCodeLine{00220       den = tcg::point\_ops::cross(AC\_2B, dir);}
\DoxyCodeLine{00221       \textcolor{keywordflow}{if} (den < 1e-\/4 \&\& den > -\/1e-\/4) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00222 }
\DoxyCodeLine{00223       t = tcg::point\_ops::cross(A\_B, dir) / den;}
\DoxyCodeLine{00224       \textcolor{keywordflow}{if} (t < 0.0 || t > 1.0) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00225 }
\DoxyCodeLine{00226       t1 = 1.0 -\/ t;}
\DoxyCodeLine{00227       P  = sq(t1) * A + 2.0 * t * t1 * B + sq(t) * C;}
\DoxyCodeLine{00228 }
\DoxyCodeLine{00229       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacetcg_1_1point__ops_a023f5394fd3b4e9d8dd57066b4e96253}{tcg::point\_ops::lineDist}}(Q\_C, P, dir) > m\_tol) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00230     \}}
\DoxyCodeLine{00231 }
\DoxyCodeLine{00232     \textcolor{keywordflow}{if} (qt != end) \textcolor{keywordflow}{break};  \textcolor{comment}{// Constraints were violated}}
\DoxyCodeLine{00233   \}}
\DoxyCodeLine{00234 }
\DoxyCodeLine{00235   \textcolor{keywordflow}{return} std::min(bt, this-\/>m\_end -\/ 1);}
\DoxyCodeLine{00236 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a2f5ba1475bc2b5d503384238fdde369d}\label{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator_a2f5ba1475bc2b5d503384238fdde369d}} 
\index{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}!penalty@{penalty}}
\index{penalty@{penalty}!tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$@{tcg::polyline\_ops::\_QuadraticsEdgeEvaluator$<$ Point $>$}}
\doxysubsubsection{\texorpdfstring{penalty()}{penalty()}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$ \\
\mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}{\+\_\+\+Quadratics\+Edge\+Evaluator}}$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$\+::penalty\+\_\+type \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1___quadratics_edge_evaluator}{tcg\+::polyline\+\_\+ops\+::\+\_\+\+Quadratics\+Edge\+Evaluator}}$<$ \mbox{\hyperlink{structtcg_1_1_point_t}{Point}} $>$\+::penalty (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classtcg_1_1step__iterator}{quad\+\_\+iterator}} \&}]{a,  }\item[{const \mbox{\hyperlink{classtcg_1_1step__iterator}{quad\+\_\+iterator}} \&}]{b }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00243                                                                   \{}
\DoxyCodeLine{00244   \textcolor{keywordflow}{if} (bt == at + 1) \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{00245 }
\DoxyCodeLine{00246   penalty\_type penalty = 0.0;}
\DoxyCodeLine{00247 }
\DoxyCodeLine{00248   \textcolor{keyword}{const} point\_type \&A(*at);}
\DoxyCodeLine{00249   \textcolor{keyword}{const} point\_type \&A1(*(at.it() + 1));}
\DoxyCodeLine{00250   \textcolor{keyword}{const} point\_type \&C(*bt);}
\DoxyCodeLine{00251   \textcolor{keyword}{const} point\_type \&C1(*(bt.it() -\/ 1));}
\DoxyCodeLine{00252 }
\DoxyCodeLine{00253   \textcolor{comment}{// Build B}}
\DoxyCodeLine{00254   value\_type s, t;}
\DoxyCodeLine{00255   \mbox{\hyperlink{namespacetcg_1_1point__ops_a2e7da2284b4335ef269917d51a30a6c8}{tcg::point\_ops::intersectionSegCoords}}(A, A1, C, C1, s, t, 1e-\/4);}
\DoxyCodeLine{00256   \textcolor{keywordflow}{if} (s == tcg::numeric\_ops::NaN<value\_type>()) \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{00257 }
\DoxyCodeLine{00258   point\_type B(A + s * (A1 -\/ A));}
\DoxyCodeLine{00259 }
\DoxyCodeLine{00260   \textcolor{comment}{// Iterate and build penalties}}
\DoxyCodeLine{00261   point\_type A\_B(A -\/ B);}
\DoxyCodeLine{00262   point\_type AC\_2B(A\_B + C -\/ B);}
\DoxyCodeLine{00263 }
\DoxyCodeLine{00264   quad\_iterator qt, bt\_1 = bt -\/ 1;}
\DoxyCodeLine{00265   \textcolor{keywordflow}{for} (qt = at; qt != bt; ++qt) \{}
\DoxyCodeLine{00266     \textcolor{keyword}{const} point\_type \&Q\_A(*qt);}
\DoxyCodeLine{00267     \textcolor{keyword}{const} point\_type \&Q\_B(*(qt.it() + 1));}
\DoxyCodeLine{00268     \textcolor{keyword}{const} point\_type \&Q\_C(*(qt + 1));}
\DoxyCodeLine{00269 }
\DoxyCodeLine{00270     \textcolor{comment}{// point\_type dir(tcg::point\_ops::direction(Q\_A, Q\_C));}}
\DoxyCodeLine{00271     point\_type dir(Q\_C -\/ Q\_A);}
\DoxyCodeLine{00272     dir = dir / tcg::point\_ops::norm(dir);}
\DoxyCodeLine{00273 }
\DoxyCodeLine{00274     value\_type t =}
\DoxyCodeLine{00275         tcg::point\_ops::cross(A\_B, dir) / tcg::point\_ops::cross(AC\_2B, dir);}
\DoxyCodeLine{00276     assert(t >= 0.0 \&\& t <= 1.0);}
\DoxyCodeLine{00277 }
\DoxyCodeLine{00278     value\_type t1 = 1.0 -\/ t;}
\DoxyCodeLine{00279     point\_type P(sq(t1) * A + 2.0 * t * t1 * B + sq(t) * C);}
\DoxyCodeLine{00280     point\_type Q(0.25 * Q\_A + 0.5 * Q\_B + 0.25 * Q\_C);}
\DoxyCodeLine{00281 }
\DoxyCodeLine{00282     penalty += \mbox{\hyperlink{namespacetcg_1_1point__ops_a023f5394fd3b4e9d8dd57066b4e96253}{tcg::point\_ops::lineDist}}(Q, P, dir);}
\DoxyCodeLine{00283 }
\DoxyCodeLine{00284     \textcolor{keywordflow}{if} (qt == bt\_1) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00285 }
\DoxyCodeLine{00286     dir = tcg::point\_ops::direction(Q\_B, Q\_C);}
\DoxyCodeLine{00287 }
\DoxyCodeLine{00288     t = tcg::point\_ops::cross(A\_B, dir) / tcg::point\_ops::cross(AC\_2B, dir);}
\DoxyCodeLine{00289     assert(t >= 0.0 \&\& t <= 1.0);}
\DoxyCodeLine{00290 }
\DoxyCodeLine{00291     t1 = 1.0 -\/ t;}
\DoxyCodeLine{00292     P  = sq(t1) * A + 2.0 * t * t1 * B + sq(t) * C;}
\DoxyCodeLine{00293 }
\DoxyCodeLine{00294     penalty += \mbox{\hyperlink{namespacetcg_1_1point__ops_a023f5394fd3b4e9d8dd57066b4e96253}{tcg::point\_ops::lineDist}}(Q\_C, P, dir);}
\DoxyCodeLine{00295   \}}
\DoxyCodeLine{00296 }
\DoxyCodeLine{00297   \textcolor{keywordflow}{return} penalty;}
\DoxyCodeLine{00298 \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/tcg/hpp/polyline\+\_\+ops.\+hpp\end{DoxyCompactItemize}
