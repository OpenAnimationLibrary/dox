\hypertarget{class_random_wave_fx}{}\doxysection{Random\+Wave\+Fx Class Reference}
\label{class_random_wave_fx}\index{RandomWaveFx@{RandomWaveFx}}
Inheritance diagram for Random\+Wave\+Fx\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=5.000000cm]{class_random_wave_fx}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_random_wave_fx_a32bf8fe9feb0e6e4d3cea9fc882d3312}{get\+Param\+UIs}} (\mbox{\hyperlink{class_t_param_u_i_concept}{TParam\+UIConcept}} $\ast$\&concepts, int \&length) override
\item 
bool \mbox{\hyperlink{class_random_wave_fx_aa2aaa332766b55785f1ae4b4cdf53779}{can\+Handle}} (const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info, double frame) override
\item 
bool \mbox{\hyperlink{class_random_wave_fx_a057a1077d2ab52f26bbcbe2ef561862f}{do\+Get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&b\+Box, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
void \mbox{\hyperlink{class_random_wave_fx_aae67a9abbc50a8175fe2f189422e96c0}{do\+Dry\+Compute}} (\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
void \mbox{\hyperlink{class_random_wave_fx_a576cce2087113f72980fc7e5cfff319d}{do\+Compute}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
int \mbox{\hyperlink{class_random_wave_fx_ae1c9de1e3d1c47342732c6f56e4e2ecf}{get\+Memory\+Requirement}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} \mbox{\hyperlink{class_random_wave_fx_adc537657677ec153fb68efce0a24d323}{m\+\_\+warped}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_random_wave_fx_a7cf80a76a8291e63862a5ee8274a6463}{m\+\_\+intensity}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_random_wave_fx_acb2c7bff719f86502caf68a56c5e3610}{m\+\_\+grid\+Step}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_random_wave_fx_afd5081f865c06ba5eb1e96063cd8e6c8}{m\+\_\+evol}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_random_wave_fx_a76e45facad95aa43f46cdcadeb97c4a8}{m\+\_\+posx}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_random_wave_fx_ad6819f7a0c3a094deb2a39a9d36801b5}{m\+\_\+posy}}
\item 
TBool\+ParamP \mbox{\hyperlink{class_random_wave_fx_ac0d3c25608043c30ec1100a700f7af92}{m\+\_\+sharpen}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_random_wave_fx_a8ad86303d9c7200e9bab6469db440b27}\label{class_random_wave_fx_a8ad86303d9c7200e9bab6469db440b27}} 
\index{RandomWaveFx@{RandomWaveFx}!RandomWaveFx@{RandomWaveFx}}
\index{RandomWaveFx@{RandomWaveFx}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{RandomWaveFx()}{RandomWaveFx()}}
{\footnotesize\ttfamily Random\+Wave\+Fx\+::\+Random\+Wave\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00029       : m\_intensity(20)}
\DoxyCodeLine{00030       , m\_gridStep(2)}
\DoxyCodeLine{00031       , m\_evol(0.0)}
\DoxyCodeLine{00032       , m\_posx(0.0)}
\DoxyCodeLine{00033       , m\_posy(0.0)}
\DoxyCodeLine{00034       , m\_sharpen(\textcolor{keyword}{false}) \{}
\DoxyCodeLine{00035     m\_posx-\/>setMeasureName(\textcolor{stringliteral}{"{}fxLength"{}});}
\DoxyCodeLine{00036     m\_posy-\/>setMeasureName(\textcolor{stringliteral}{"{}fxLength"{}});}
\DoxyCodeLine{00037 }
\DoxyCodeLine{00038     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Source"{}}, m\_warped);}
\DoxyCodeLine{00039     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}intensity"{}}, m\_intensity);}
\DoxyCodeLine{00040     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}sensitivity"{}}, m\_gridStep);}
\DoxyCodeLine{00041     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}evolution"{}}, m\_evol);}
\DoxyCodeLine{00042     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}positionx"{}}, m\_posx);}
\DoxyCodeLine{00043     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}positiony"{}}, m\_posy);}
\DoxyCodeLine{00044     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}sharpen"{}}, m\_sharpen);}
\DoxyCodeLine{00045     m\_intensity-\/>setValueRange(-\/1000, 1000);}
\DoxyCodeLine{00046     m\_gridStep-\/>setValueRange(2, 20);}
\DoxyCodeLine{00047   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_random_wave_fx_a0088e85eed0ac6c7f7001d22e0ae24f1}\label{class_random_wave_fx_a0088e85eed0ac6c7f7001d22e0ae24f1}} 
\index{RandomWaveFx@{RandomWaveFx}!````~RandomWaveFx@{$\sim$RandomWaveFx}}
\index{````~RandomWaveFx@{$\sim$RandomWaveFx}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{$\sim$RandomWaveFx()}{~RandomWaveFx()}}
{\footnotesize\ttfamily virtual Random\+Wave\+Fx\+::$\sim$\+Random\+Wave\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00051 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_random_wave_fx_aa2aaa332766b55785f1ae4b4cdf53779}\label{class_random_wave_fx_aa2aaa332766b55785f1ae4b4cdf53779}} 
\index{RandomWaveFx@{RandomWaveFx}!canHandle@{canHandle}}
\index{canHandle@{canHandle}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{canHandle()}{canHandle()}}
{\footnotesize\ttfamily bool Random\+Wave\+Fx\+::can\+Handle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info,  }\item[{double}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00066                                                                      \{}
\DoxyCodeLine{00067     \textcolor{keywordflow}{return} isAlmostIsotropic(info.m\_affine);}
\DoxyCodeLine{00068   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_random_wave_fx_a576cce2087113f72980fc7e5cfff319d}\label{class_random_wave_fx_a576cce2087113f72980fc7e5cfff319d}} 
\index{RandomWaveFx@{RandomWaveFx}!doCompute@{doCompute}}
\index{doCompute@{doCompute}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{doCompute()}{doCompute()}}
{\footnotesize\ttfamily void Random\+Wave\+Fx\+::do\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00127                                                        \{}
\DoxyCodeLine{00128     \textcolor{keywordtype}{bool} isWarped = m\_warped.isConnected();}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130     \textcolor{keywordflow}{if} (!isWarped) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00131 }
\DoxyCodeLine{00132     \textcolor{keywordflow}{if} (fabs(m\_intensity-\/>getValue(frame)) < 0.01) \{}
\DoxyCodeLine{00133       m\_warped-\/>compute(tile, frame, info);}
\DoxyCodeLine{00134       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00135     \}}
\DoxyCodeLine{00136 }
\DoxyCodeLine{00137     \textcolor{keywordtype}{int} shrink      = (info.m\_shrinkX + info.m\_shrinkY) / 2;}
\DoxyCodeLine{00138     \textcolor{keywordtype}{double} scale    = sqrt(fabs(info.m\_affine.det()));}
\DoxyCodeLine{00139     \textcolor{keywordtype}{double} gridStep = 1.5 * m\_gridStep-\/>getValue(frame);}
\DoxyCodeLine{00140 }
\DoxyCodeLine{00141     \mbox{\hyperlink{struct_warp_params}{WarpParams}} params;}
\DoxyCodeLine{00142     params.m\_intensity   = m\_intensity-\/>getValue(frame) / gridStep;}
\DoxyCodeLine{00143     params.m\_warperScale = scale * gridStep;}
\DoxyCodeLine{00144     params.m\_sharpen     = m\_sharpen-\/>getValue();}
\DoxyCodeLine{00145     params.m\_shrink      = shrink;}
\DoxyCodeLine{00146     \textcolor{keywordtype}{double} evolution     = m\_evol-\/>getValue(frame);}
\DoxyCodeLine{00147     \textcolor{keywordtype}{double} size          = 100.0 / info.m\_shrinkX;}
\DoxyCodeLine{00148     \mbox{\hyperlink{class_t_point_t}{TPointD}} pos(m\_posx-\/>getValue(frame), m\_posy-\/>getValue(frame));}
\DoxyCodeLine{00149 }
\DoxyCodeLine{00150     \textcolor{comment}{// The warper is calculated on a standard reference, with fixed dpi. This}}
\DoxyCodeLine{00151     \textcolor{comment}{// makes sure}}
\DoxyCodeLine{00152     \textcolor{comment}{// that the lattice created for the warp does not depend on camera}}
\DoxyCodeLine{00153     \textcolor{comment}{// transforms and resolution.}}
\DoxyCodeLine{00154     \mbox{\hyperlink{class_t_render_settings}{TRenderSettings}} warperInfo(info);}
\DoxyCodeLine{00155     \textcolor{keywordtype}{double} warperScaleFactor = 1.0 / params.m\_warperScale;}
\DoxyCodeLine{00156     warperInfo.m\_affine      = \mbox{\hyperlink{class_t_scale}{TScale}}(warperScaleFactor) * info.m\_affine;}
\DoxyCodeLine{00157 }
\DoxyCodeLine{00158     \textcolor{comment}{// Retrieve tile's geometry}}
\DoxyCodeLine{00159     \mbox{\hyperlink{class_t_rect_t}{TRectD}} tileRect;}
\DoxyCodeLine{00160     \{}
\DoxyCodeLine{00161       \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} tileRas = tile.getRaster();}
\DoxyCodeLine{00162       tileRect =}
\DoxyCodeLine{00163           \mbox{\hyperlink{class_t_rect_t}{TRectD}}(tile.m\_pos, \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}}(tileRas-\/>getLx(), tileRas-\/>getLy()));}
\DoxyCodeLine{00164     \}}
\DoxyCodeLine{00165 }
\DoxyCodeLine{00166     \textcolor{comment}{// Build the compute rect}}
\DoxyCodeLine{00167     \mbox{\hyperlink{class_t_rect_t}{TRectD}} warpedBox, warpedComputeRect, tileComputeRect;}
\DoxyCodeLine{00168     m\_warped-\/>getBBox(frame, warpedBox, info);}
\DoxyCodeLine{00169 }
\DoxyCodeLine{00170     getWarpComputeRects(tileComputeRect, warpedComputeRect, warpedBox, tileRect,}
\DoxyCodeLine{00171                         params);}
\DoxyCodeLine{00172 }
\DoxyCodeLine{00173     \textcolor{keywordflow}{if} (tileComputeRect.getLx() <= 0 || tileComputeRect.getLy() <= 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00174     \textcolor{keywordflow}{if} (warpedComputeRect.getLx() <= 0 || warpedComputeRect.getLy() <= 0)}
\DoxyCodeLine{00175       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00176 }
\DoxyCodeLine{00177     \mbox{\hyperlink{class_t_rect_t}{TRectD}} warperComputeRect(\mbox{\hyperlink{class_t_scale}{TScale}}(warperScaleFactor) * tileComputeRect);}
\DoxyCodeLine{00178     \textcolor{keywordtype}{double} warperEnlargement = getWarperEnlargement(params);}
\DoxyCodeLine{00179     warperComputeRect        = warperComputeRect.enlarge(warperEnlargement);}
\DoxyCodeLine{00180     warperComputeRect.x0     = tfloor(warperComputeRect.x0);}
\DoxyCodeLine{00181     warperComputeRect.y0     = tfloor(warperComputeRect.y0);}
\DoxyCodeLine{00182     warperComputeRect.x1     = tceil(warperComputeRect.x1);}
\DoxyCodeLine{00183     warperComputeRect.y1     = tceil(warperComputeRect.y1);}
\DoxyCodeLine{00184 }
\DoxyCodeLine{00185     \textcolor{comment}{// Compute the warped tile}}
\DoxyCodeLine{00186     \mbox{\hyperlink{class_t_tile}{TTile}} tileIn;}
\DoxyCodeLine{00187     m\_warped-\/>allocateAndCompute(}
\DoxyCodeLine{00188         tileIn, warpedComputeRect.getP00(),}
\DoxyCodeLine{00189         \mbox{\hyperlink{class_t_dimension_t}{TDimension}}(warpedComputeRect.getLx(), warpedComputeRect.getLy()),}
\DoxyCodeLine{00190         tile.getRaster(), frame, info);}
\DoxyCodeLine{00191     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rasIn = tileIn.getRaster();}
\DoxyCodeLine{00192 }
\DoxyCodeLine{00193     \textcolor{comment}{// Compute the warper tile}}
\DoxyCodeLine{00194     std::vector<TSpectrum::ColorKey> colors = \{}
\DoxyCodeLine{00195         TSpectrum::ColorKey(0, TPixel32::White),}
\DoxyCodeLine{00196         TSpectrum::ColorKey(1, TPixel32::Black)\};}
\DoxyCodeLine{00197     \mbox{\hyperlink{class_t_spectrum_param_p}{TSpectrumParamP}} cloudscolors = \mbox{\hyperlink{class_t_spectrum_param_p}{TSpectrumParamP}}(colors);}
\DoxyCodeLine{00198 }
\DoxyCodeLine{00199     \textcolor{comment}{// Build the warper}}
\DoxyCodeLine{00200     warperInfo.m\_affine = warperInfo.m\_affine;}
\DoxyCodeLine{00201     \mbox{\hyperlink{class_t_affine}{TAffine}} aff         = warperInfo.m\_affine.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}();}
\DoxyCodeLine{00202 }
\DoxyCodeLine{00203     \mbox{\hyperlink{class_t_tile}{TTile}} warperTile;}
\DoxyCodeLine{00204     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rasWarper =}
\DoxyCodeLine{00205         rasIn-\/>create(warperComputeRect.getLx(), warperComputeRect.getLy());}
\DoxyCodeLine{00206     warperTile.m\_pos = warperComputeRect.getP00();}
\DoxyCodeLine{00207     warperTile.setRaster(rasWarper);}
\DoxyCodeLine{00208 }
\DoxyCodeLine{00209     \{}
\DoxyCodeLine{00210       \mbox{\hyperlink{class_t_render_settings}{TRenderSettings}} info2(warperInfo);}
\DoxyCodeLine{00211 }
\DoxyCodeLine{00212       \textcolor{comment}{// Now, separate the part of the affine the Fx can handle from the rest.}}
\DoxyCodeLine{00213       \mbox{\hyperlink{class_t_affine}{TAffine}} fxHandledAffine = handledAffine(warperInfo, frame);}
\DoxyCodeLine{00214       info2.m\_affine          = fxHandledAffine;}
\DoxyCodeLine{00215 }
\DoxyCodeLine{00216       \mbox{\hyperlink{class_t_affine}{TAffine}} aff = warperInfo.m\_affine * fxHandledAffine.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}();}
\DoxyCodeLine{00217       aff.a13 /= warperInfo.m\_shrinkX;}
\DoxyCodeLine{00218       aff.a23 /= warperInfo.m\_shrinkY;}
\DoxyCodeLine{00219 }
\DoxyCodeLine{00220       \mbox{\hyperlink{class_t_rect_t}{TRectD}} rectIn = aff.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * warperComputeRect;}
\DoxyCodeLine{00221 }
\DoxyCodeLine{00222       \textcolor{comment}{// rectIn = rectIn.enlarge(getResampleFilterRadius(info));  //Needed to}}
\DoxyCodeLine{00223       \textcolor{comment}{// counter the resample filter}}
\DoxyCodeLine{00224 }
\DoxyCodeLine{00225       \mbox{\hyperlink{class_t_rect_t}{TRect}} rectInI(tfloor(rectIn.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}), tfloor(rectIn.y0), tceil(rectIn.x1) -\/ 1,}
\DoxyCodeLine{00226                     tceil(rectIn.y1) -\/ 1);}
\DoxyCodeLine{00227 }
\DoxyCodeLine{00228       \textcolor{comment}{// rasIn e' un raster dello stesso tipo di tile.getRaster()}}
\DoxyCodeLine{00229 }
\DoxyCodeLine{00230       \mbox{\hyperlink{class_t_tile}{TTile}} auxtile(}
\DoxyCodeLine{00231           warperTile.getRaster()-\/>create(rectInI.getLx(), rectInI.getLy()),}
\DoxyCodeLine{00232           convert(rectInI.getP00()));}
\DoxyCodeLine{00233 }
\DoxyCodeLine{00234       \mbox{\hyperlink{class_t_point_t}{TPointD}} mypos(auxtile.m\_pos -\/ pos);}
\DoxyCodeLine{00235 }
\DoxyCodeLine{00236       \textcolor{keywordtype}{double} scale2 = sqrt(fabs(info2.m\_affine.det()));}
\DoxyCodeLine{00237       doClouds(auxtile.getRaster(), cloudscolors, mypos, evolution, size, 0.0,}
\DoxyCodeLine{00238                1.0, PNOISE\_CLOUDS, scale2, frame);}
\DoxyCodeLine{00239 }
\DoxyCodeLine{00240       info2.m\_affine = aff;}
\DoxyCodeLine{00241       TRasterFx::applyAffine(warperTile, auxtile, info2);}
\DoxyCodeLine{00242     \}}
\DoxyCodeLine{00243 }
\DoxyCodeLine{00244     \textcolor{comment}{// Warp}}
\DoxyCodeLine{00245     \mbox{\hyperlink{class_t_point_t}{TPointD}} db;}
\DoxyCodeLine{00246     \mbox{\hyperlink{class_t_rect_t}{TRect}} rasComputeRectI(convert(tileComputeRect -\/ tileRect.getP00(), db));}
\DoxyCodeLine{00247     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} tileRas = tile.getRaster()-\/>extract(rasComputeRectI);}
\DoxyCodeLine{00248 }
\DoxyCodeLine{00249     \mbox{\hyperlink{class_t_point_t}{TPointD}} rasInPos(warpedComputeRect.getP00() -\/ tileComputeRect.getP00());}
\DoxyCodeLine{00250     \mbox{\hyperlink{class_t_point_t}{TPointD}} warperPos(}
\DoxyCodeLine{00251         (\mbox{\hyperlink{class_t_scale}{TScale}}(params.m\_warperScale) * warperComputeRect.getP00()) -\/}
\DoxyCodeLine{00252         tileComputeRect.getP00());}
\DoxyCodeLine{00253     warp(tileRas, rasIn, rasWarper, rasInPos, warperPos, params);}
\DoxyCodeLine{00254   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_random_wave_fx_aae67a9abbc50a8175fe2f189422e96c0}\label{class_random_wave_fx_aae67a9abbc50a8175fe2f189422e96c0}} 
\index{RandomWaveFx@{RandomWaveFx}!doDryCompute@{doDryCompute}}
\index{doDryCompute@{doDryCompute}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{doDryCompute()}{doDryCompute()}}
{\footnotesize\ttfamily void Random\+Wave\+Fx\+::do\+Dry\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Declares the computation scheme of this fx for rendering optimization purposes. This is an important function of the Toonz rendering API, and should be reimplemented with the necessary care. The Toonz rendering process makes use of this function to enact most of the optimization steps about the fx computation, in particular fx caching. A correct implementation of this method should follow these rules\+:  The invocation of child node computations should be faithfully reproduced.  TRaster\+Fx\+::compute and TRaster\+Fx\+::allocate\+And\+Compute calls have to be translated to TRaster\+Fx\+::dry\+Compute calls.  This fx is intended for precomputation stage, so the hard rendering code should be skipped here. By default, this method raises a dry\+Compute call to each input port in increasing order, using the TRaster\+Fx\+::transform method to identify the tiles to be passed on input precomputation. 

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_a47ec31d2d4c3a066cd6744fb8c80edf2}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00095                                                           \{}
\DoxyCodeLine{00096     \textcolor{keywordtype}{bool} isWarped = m\_warped.isConnected();}
\DoxyCodeLine{00097     \textcolor{keywordflow}{if} (!isWarped) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00098     \textcolor{keywordflow}{if} (fabs(m\_intensity-\/>getValue(frame)) < 0.01) \{}
\DoxyCodeLine{00099       m\_warped-\/>dryCompute(rect, frame, info);}
\DoxyCodeLine{00100       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00101     \}}
\DoxyCodeLine{00102 }
\DoxyCodeLine{00103     \textcolor{keywordtype}{double} scale    = sqrt(fabs(info.m\_affine.det()));}
\DoxyCodeLine{00104     \textcolor{keywordtype}{double} gridStep = 1.5 * m\_gridStep-\/>getValue(frame);}
\DoxyCodeLine{00105 }
\DoxyCodeLine{00106     \mbox{\hyperlink{struct_warp_params}{WarpParams}} params;}
\DoxyCodeLine{00107     params.m\_intensity   = m\_intensity-\/>getValue(frame) / gridStep;}
\DoxyCodeLine{00108     params.m\_warperScale = scale * gridStep;}
\DoxyCodeLine{00109     params.m\_sharpen     = m\_sharpen-\/>getValue();}
\DoxyCodeLine{00110 }
\DoxyCodeLine{00111     \mbox{\hyperlink{class_t_rect_t}{TRectD}} warpedBox, warpedComputeRect, tileComputeRect;}
\DoxyCodeLine{00112     m\_warped-\/>getBBox(frame, warpedBox, info);}
\DoxyCodeLine{00113 }
\DoxyCodeLine{00114     getWarpComputeRects(tileComputeRect, warpedComputeRect, warpedBox, rect,}
\DoxyCodeLine{00115                         params);}
\DoxyCodeLine{00116 }
\DoxyCodeLine{00117     \textcolor{keywordflow}{if} (tileComputeRect.getLx() <= 0 || tileComputeRect.getLy() <= 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00118     \textcolor{keywordflow}{if} (warpedComputeRect.getLx() <= 0 || warpedComputeRect.getLy() <= 0)}
\DoxyCodeLine{00119       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00120 }
\DoxyCodeLine{00121     m\_warped-\/>dryCompute(warpedComputeRect, frame, info);}
\DoxyCodeLine{00122   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_random_wave_fx_a057a1077d2ab52f26bbcbe2ef561862f}\label{class_random_wave_fx_a057a1077d2ab52f26bbcbe2ef561862f}} 
\index{RandomWaveFx@{RandomWaveFx}!doGetBBox@{doGetBBox}}
\index{doGetBBox@{doGetBBox}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{doGetBBox()}{doGetBBox()}}
{\footnotesize\ttfamily bool Random\+Wave\+Fx\+::do\+Get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{b\+Box,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00073                                                        \{}
\DoxyCodeLine{00074     \textcolor{keywordflow}{if} (m\_warped.isConnected()) \{}
\DoxyCodeLine{00075       \textcolor{keywordtype}{int} ret = m\_warped-\/>doGetBBox(frame, bBox, info);}
\DoxyCodeLine{00076 }
\DoxyCodeLine{00077       \textcolor{keywordflow}{if} (ret \&\& !bBox.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \{}
\DoxyCodeLine{00078         \textcolor{keywordflow}{if} (bBox != TConsts::infiniteRectD) \{}
\DoxyCodeLine{00079           \mbox{\hyperlink{struct_warp_params}{WarpParams}} params;}
\DoxyCodeLine{00080           params.m\_intensity = m\_intensity-\/>getValue(frame);}
\DoxyCodeLine{00081 }
\DoxyCodeLine{00082           bBox = bBox.enlarge(getWarpRadius(params));}
\DoxyCodeLine{00083         \}}
\DoxyCodeLine{00084         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00085       \}}
\DoxyCodeLine{00086     \}}
\DoxyCodeLine{00087 }
\DoxyCodeLine{00088     bBox = \mbox{\hyperlink{class_t_rect_t}{TRectD}}();}
\DoxyCodeLine{00089     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00090   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_random_wave_fx_ae1c9de1e3d1c47342732c6f56e4e2ecf}\label{class_random_wave_fx_ae1c9de1e3d1c47342732c6f56e4e2ecf}} 
\index{RandomWaveFx@{RandomWaveFx}!getMemoryRequirement@{getMemoryRequirement}}
\index{getMemoryRequirement@{getMemoryRequirement}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{getMemoryRequirement()}{getMemoryRequirement()}}
{\footnotesize\ttfamily int Random\+Wave\+Fx\+::get\+Memory\+Requirement (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Specifies the approximate size (in Mega\+Bytes) of the maximum allocation instance that this fx will need to perform in order to render the passed input. This method should be reimplemented in order to make the Toonz rendering process aware of the use of big raster memory chunks, at least. Observe that the passed tile geometry is implicitly {\itshape  already allocated \texorpdfstring{$<$}{<}\textbackslash{}i\texorpdfstring{$>$}{>} for the fx output. ~\newline
The default implementation returns 0, assuming that the passed implicit memory size is passed below in node computation without further allocation of resources. Fxs can reimplement this to -\/1 to explicitly disable the Toonz\textquotesingle{}s smart memory handling. ~\newline
 ~\newline
\begin{DoxyNote}{Note}
The rendering process ensures that the passed render settings are {\itshape handled} by the fx before this function is invoked -\/ do not waste code for it. 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRaster\+Fx\+::memory\+Size}} and TRaster\+Fx\+::can\+Handle methods. 
\end{DoxySeeAlso}
}

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_af8eb991c9756f4fb2e48d9f96cbacfba}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00259                                                                  \{}
\DoxyCodeLine{00260     \textcolor{comment}{// return -\/1;   //Deactivated. This fx is currently very inefficient if}}
\DoxyCodeLine{00261     \textcolor{comment}{// subdivided!}}
\DoxyCodeLine{00262 }
\DoxyCodeLine{00263     \textcolor{keywordtype}{int} shrink      = (info.m\_shrinkX + info.m\_shrinkY) / 2;}
\DoxyCodeLine{00264     \textcolor{keywordtype}{double} scale    = sqrt(fabs(info.m\_affine.det()));}
\DoxyCodeLine{00265     \textcolor{keywordtype}{double} gridStep = 1.5 * m\_gridStep-\/>getValue(frame);}
\DoxyCodeLine{00266 }
\DoxyCodeLine{00267     \mbox{\hyperlink{struct_warp_params}{WarpParams}} params;}
\DoxyCodeLine{00268     params.m\_intensity   = m\_intensity-\/>getValue(frame) / gridStep;}
\DoxyCodeLine{00269     params.m\_warperScale = scale * gridStep;}
\DoxyCodeLine{00270     params.m\_sharpen     = m\_sharpen-\/>getValue();}
\DoxyCodeLine{00271     params.m\_shrink      = shrink;}
\DoxyCodeLine{00272 }
\DoxyCodeLine{00273     \textcolor{keywordtype}{double} warperScaleFactor = 1.0 / params.m\_warperScale;}
\DoxyCodeLine{00274 }
\DoxyCodeLine{00275     \mbox{\hyperlink{class_t_rect_t}{TRectD}} warpedBox, warpedComputeRect, tileComputeRect;}
\DoxyCodeLine{00276     m\_warped-\/>getBBox(frame, warpedBox, info);}
\DoxyCodeLine{00277 }
\DoxyCodeLine{00278     getWarpComputeRects(tileComputeRect, warpedComputeRect, warpedBox, rect,}
\DoxyCodeLine{00279                         params);}
\DoxyCodeLine{00280 }
\DoxyCodeLine{00281     \mbox{\hyperlink{class_t_rect_t}{TRectD}} warperComputeRect(\mbox{\hyperlink{class_t_scale}{TScale}}(warperScaleFactor) * tileComputeRect);}
\DoxyCodeLine{00282     \textcolor{keywordtype}{double} warperEnlargement = getWarperEnlargement(params);}
\DoxyCodeLine{00283     warperComputeRect        = warperComputeRect.enlarge(warperEnlargement);}
\DoxyCodeLine{00284 }
\DoxyCodeLine{00285     \textcolor{keywordflow}{return} std::max(\mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRasterFx::memorySize}}(warpedComputeRect, info.m\_bpp),}
\DoxyCodeLine{00286                     \mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRasterFx::memorySize}}(warperComputeRect, info.m\_bpp));}
\DoxyCodeLine{00287   \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00560}{TRaster\+Fx\+::memory\+Size()}}.

\mbox{\Hypertarget{class_random_wave_fx_a32bf8fe9feb0e6e4d3cea9fc882d3312}\label{class_random_wave_fx_a32bf8fe9feb0e6e4d3cea9fc882d3312}} 
\index{RandomWaveFx@{RandomWaveFx}!getParamUIs@{getParamUIs}}
\index{getParamUIs@{getParamUIs}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{getParamUIs()}{getParamUIs()}}
{\footnotesize\ttfamily void Random\+Wave\+Fx\+::get\+Param\+UIs (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_param_u_i_concept}{TParam\+UIConcept}} $\ast$\&}]{params,  }\item[{int \&}]{length }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Returns a list of User Interface Concepts to be displayed when editing the fx parameters. \begin{DoxyNote}{Note}
Ownership of the returned array allocated with new\mbox{[}\mbox{]} is passed to callers. 
\end{DoxyNote}


Reimplemented from \mbox{\hyperlink{class_t_fx_a18766b107b77772d67c5678e7d832b18}{TFx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00055                                                                      \{}
\DoxyCodeLine{00056     concepts = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_param_u_i_concept}{TParamUIConcept}}[length = 1];}
\DoxyCodeLine{00057 }
\DoxyCodeLine{00058     concepts[0].\mbox{\hyperlink{class_t_param_u_i_concept_a2dbb7c954ca5f2441a6931945cf004a5}{m\_type}}  = TParamUIConcept::POINT\_2;}
\DoxyCodeLine{00059     concepts[0].m\_label = \textcolor{stringliteral}{"{}Position"{}};}
\DoxyCodeLine{00060     concepts[0].m\_params.push\_back(m\_posx);}
\DoxyCodeLine{00061     concepts[0].m\_params.push\_back(m\_posy);}
\DoxyCodeLine{00062   \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00078}{TParam\+UIConcept\+::m\+\_\+label}}, \mbox{\hyperlink{l00079}{TParam\+UIConcept\+::m\+\_\+params}}, and \mbox{\hyperlink{l00077}{TParam\+UIConcept\+::m\+\_\+type}}.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_random_wave_fx_afd5081f865c06ba5eb1e96063cd8e6c8}\label{class_random_wave_fx_afd5081f865c06ba5eb1e96063cd8e6c8}} 
\index{RandomWaveFx@{RandomWaveFx}!m\_evol@{m\_evol}}
\index{m\_evol@{m\_evol}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_evol}{m\_evol}}
{\footnotesize\ttfamily TDouble\+ParamP Random\+Wave\+Fx\+::m\+\_\+evol\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_random_wave_fx_acb2c7bff719f86502caf68a56c5e3610}\label{class_random_wave_fx_acb2c7bff719f86502caf68a56c5e3610}} 
\index{RandomWaveFx@{RandomWaveFx}!m\_gridStep@{m\_gridStep}}
\index{m\_gridStep@{m\_gridStep}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_gridStep}{m\_gridStep}}
{\footnotesize\ttfamily TDouble\+ParamP Random\+Wave\+Fx\+::m\+\_\+grid\+Step\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_random_wave_fx_a7cf80a76a8291e63862a5ee8274a6463}\label{class_random_wave_fx_a7cf80a76a8291e63862a5ee8274a6463}} 
\index{RandomWaveFx@{RandomWaveFx}!m\_intensity@{m\_intensity}}
\index{m\_intensity@{m\_intensity}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_intensity}{m\_intensity}}
{\footnotesize\ttfamily TDouble\+ParamP Random\+Wave\+Fx\+::m\+\_\+intensity\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_random_wave_fx_a76e45facad95aa43f46cdcadeb97c4a8}\label{class_random_wave_fx_a76e45facad95aa43f46cdcadeb97c4a8}} 
\index{RandomWaveFx@{RandomWaveFx}!m\_posx@{m\_posx}}
\index{m\_posx@{m\_posx}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_posx}{m\_posx}}
{\footnotesize\ttfamily TDouble\+ParamP Random\+Wave\+Fx\+::m\+\_\+posx\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_random_wave_fx_ad6819f7a0c3a094deb2a39a9d36801b5}\label{class_random_wave_fx_ad6819f7a0c3a094deb2a39a9d36801b5}} 
\index{RandomWaveFx@{RandomWaveFx}!m\_posy@{m\_posy}}
\index{m\_posy@{m\_posy}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_posy}{m\_posy}}
{\footnotesize\ttfamily TDouble\+ParamP Random\+Wave\+Fx\+::m\+\_\+posy\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_random_wave_fx_ac0d3c25608043c30ec1100a700f7af92}\label{class_random_wave_fx_ac0d3c25608043c30ec1100a700f7af92}} 
\index{RandomWaveFx@{RandomWaveFx}!m\_sharpen@{m\_sharpen}}
\index{m\_sharpen@{m\_sharpen}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_sharpen}{m\_sharpen}}
{\footnotesize\ttfamily TBool\+ParamP Random\+Wave\+Fx\+::m\+\_\+sharpen\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_random_wave_fx_adc537657677ec153fb68efce0a24d323}\label{class_random_wave_fx_adc537657677ec153fb68efce0a24d323}} 
\index{RandomWaveFx@{RandomWaveFx}!m\_warped@{m\_warped}}
\index{m\_warped@{m\_warped}!RandomWaveFx@{RandomWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_warped}{m\_warped}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} Random\+Wave\+Fx\+::m\+\_\+warped\hspace{0.3cm}{\ttfamily [protected]}}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/stdfx/randomwavefx.\+cpp\end{DoxyCompactItemize}
