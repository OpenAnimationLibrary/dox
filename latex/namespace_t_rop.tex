\hypertarget{namespace_t_rop}{}\doxysection{TRop Namespace Reference}
\label{namespace_t_rop}\index{TRop@{TRop}}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{class_t_rop_1_1_cmapped_quickput_settings}{Cmapped\+Quickput\+Settings}}
\item 
struct \mbox{\hyperlink{struct_t_rop_1_1_raylit_params}{Raylit\+Params}}
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}{Resample\+Filter\+Type}} \{ \newline
{\bfseries None}
, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}{Triangle}}
, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168adaa7b87b985724e085f7281d2817dfb6}{Mitchell}}
, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a5299db768d5b5c8554907b73a6075ce1}{Cubic5}}
, \newline
\mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad232a671a97d1958fa9caa4696f3efa7}{Cubic75}}
, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a4932c6c099d4f68848d72736be6f321e}{Cubic1}}
, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a8142bce9410b8ca2682b7f41d0fe1cda}{Hann2}}
, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad1a6a213a56880e3be5f9df4632a903d}{Hann3}}
, \newline
\mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad74259f9d68bb2918533b70790355a6c}{Hamming2}}
, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168adbd720438a66e557e65a1419610d9ef9}{Hamming3}}
, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a4e7a2bc406cecb691f8f0d5fa1d9d84c}{Lanczos2}}
, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a5fef44f41eda4cbf63092b0634616095}{Lanczos3}}
, \newline
\mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a6fd64688f6f661bd7c76dee932d048ca}{Gauss}}
, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a92694e20fb1c18f7987cda447d4553ff}{Closest\+Pixel}}
, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a152d46ac03e804c799ed08f703eeeb4e}{Bilinear}}
, {\bfseries How\+Many}
 \}
\item 
enum {\bfseries Color\+Mask} \{ {\bfseries RChan} = 0x1
, {\bfseries GChan} = 0x2
, {\bfseries BChan} = 0x4
, {\bfseries MChan} = 0x8
 \}
\item 
enum {\bfseries Erodilate\+Mask\+Type} \{ {\bfseries ED\+\_\+rectangular}
, {\bfseries ED\+\_\+circular}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a66da5845870f824caab9c6fc47d6b8bd}{rgbm\+Scale}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rin, const double $\ast$k, const double $\ast$a, const int $\ast$out0, const int $\ast$out1)
\begin{DoxyCompactList}\small\item\em Applies first order mappings to each of {\bfseries{rin\textquotesingle{}s}} channels. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a5fad2c1d5d972dfdf8547efc9386c986}{rgbm\+Scale}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rin, double kr, double kg, double kb, double km, double ar=0.\+0, double ag=0.\+0, double ab=0.\+0, double am=0.\+0)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ae2160d9b4cacd0527c741e83181f17be}{rgbm\+Adjust}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rin, const int $\ast$in0, const int $\ast$in1, const int $\ast$out0, const int $\ast$out1)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_aaea09eab581fd066c34b2b2ecec92f41}{check\+Board}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, const TPixel32 \&, const TPixel32 \&, const \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}} \&, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&)
\begin{DoxyCompactList}\small\item\em Make a checkoboard in {\bfseries{rout}}. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ae5fd1fb0c2f625e1da14fe92ae0e5122}{over}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&out, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&dn, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&up)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_aae58b5d8cb3097667c3d494780fa35b8}{over}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&out, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&up, const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&pos=\mbox{\hyperlink{class_t_point_t}{TPoint}}())
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a91b87be89fbd668e1e88bff94085b4ec}{over}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&out, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&up, const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}{Resample\+Filter\+Type}} filter\+Type=\mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}{Triangle}})
\begin{DoxyCompactList}\small\item\em Make the image over of the {\bfseries{up}} raster on the {\bfseries{out}} raster. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a744bf34f97ad2828655221fc27dffadf}{over}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&out, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&up, const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&pos, const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}{Resample\+Filter\+Type}} filter\+Type=\mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}{Triangle}})
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a9f1ee78ab7b55ece2630b90c93ba339f}{over}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&out, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&dn, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&up, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+GR8P}} \&mask)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_aedc165465ce6743825508055f5207aa8}{over}} (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+GR8P}} \&rup, const TPixel32 \&color)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ab40288730d28adc27b76cadca035beaa}{over}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&rup, \mbox{\hyperlink{class_t_palette}{TPalette}} $\ast$palette, const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&point=\mbox{\hyperlink{class_t_point_t}{TPoint}}(), const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff=\mbox{\hyperlink{class_t_affine}{TAffine}}())
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a5e39bc748039afe42001ba44f2d2a073}{resample}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&out, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&in, const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}{Resample\+Filter\+Type}} filter\+Type=\mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}{Triangle}}, double \mbox{\hyperlink{namespace_t_rop_a9baa771ae6b7beb73d594266761d2cf2}{blur}}=1.)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a1f6b04b4725e957a0d554e198e26a117}{quick\+Put}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&out, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&up, const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff, const TPixel32 \&color\+Scale=TPixel\+::\+Black, bool do\+Premultiply=false, bool \mbox{\hyperlink{namespace_t_rop_a35fb11523175f84027df48cc51d45d28}{white\+Transp}}=false, bool first\+Column=false, bool do\+Raster\+Darken\+Blended\+View=false)
\begin{DoxyCompactList}\small\item\em Like the over function, but only uses closest\+\_\+pixel filter. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_af44cb7fab841ce051f1414a5828bfbff}{quick\+Put}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&out, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&up, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&plt, const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff, const TPixel32 \&global\+Color\+Scale=TPixel\+::\+Black, bool inks\+Only=false)
\begin{DoxyCompactList}\small\item\em Like the over function but up image must be cmapped. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a43c9517b928a4d6c9fb68867884a22ce}{quick\+Put}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&dn, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&up\+CM32, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&plt, const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff, const \mbox{\hyperlink{class_t_rop_1_1_cmapped_quickput_settings}{Cmapped\+Quickput\+Settings}} \&settings)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a709bde5ef9b1c9a1b205855f9e8f7329}{quick\+Resample\+Color\+Filter}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&dn, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&up, const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&plt, UCHAR color\+Mask)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a1bf930e46aa120ad8522b0e39540e4b6}{convolve\+\_\+3\+\_\+i}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rin, int dx, int dy, double conv\mbox{[}$\,$\mbox{]})
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a5d086c7fcdee2a2fcec03005d7f7eda7}{convolve\+\_\+i}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rin, int dx, int dy, double conv\mbox{[}$\,$\mbox{]}, int radius)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a8af2a2c23b1112d7582523b6d3add109}{fracmove}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rin, double dx, double dy)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{convert}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} dst, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&src)
\begin{DoxyCompactList}\small\item\em Convert {\bfseries{src}} raster in raster type {\bfseries{dst}}. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a229eb7fd85c23c325ea4ba55478d5712}{copy}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} dst, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&src)
\begin{DoxyCompactList}\small\item\em Copy {\bfseries{src}} in {\bfseries{dst}}. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_adc7ac986d64b4e8ee8270846b454e4d8}{brush}} (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras, const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&a, const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&b, int radius, const TPixel32 \&color)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a1dfdba06d4f71d86755d8e0833a7a071}{compute\+BBox}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} ras, \mbox{\hyperlink{class_t_rect_t}{TRect}} \&bbox)
\begin{DoxyCompactList}\small\item\em Get {\bfseries{bbox}} of {\bfseries{ras}} raster. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a789f797a79d572d97182478cc9826c8a}{add\+Background}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} ras, const TPixel32 \&col)
\begin{DoxyCompactList}\small\item\em Add background of color {\bfseries{col}} to the {\bfseries{ras}} raster. \end{DoxyCompactList}\item 
DVAPI bool \mbox{\hyperlink{namespace_t_rop_aa724b97c8915446922e99821756d2275}{is\+Opaque}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} ras)
\begin{DoxyCompactList}\small\item\em Return true if {\bfseries{ras}} is opaque. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a1d8e2ff30b65313b6a82376d17be65cf}{invert}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} ras, bool inv\+Red=true, bool inv\+Green=true, bool inv\+Blue=true, bool inv\+Matte=false)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a0d74d2e7b5135fe978af69553d6bd3da}{add}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout, double v)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a2f513936a4a4450e3839a01eacb1d962}{add}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\begin{DoxyCompactList}\small\item\em Add {\bfseries{rdown}} pixels to {\bfseries{rup}} pixels and put the resulting raster in {\bfseries{rout}}. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a0809dd38dcd6506bcfbd7c07b17220e7}{colordodge}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a224ebd85bbce4f5eb5085ecd79d5f76c}{colorburn}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a2abcebe9e3631cd03f07055b838cc92b}{screen}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_afdf19f6890d2f927af99c25e6a125435}{sub}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout, bool matte)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a76f8b77a1eff52235e1124540365aba2}{mult}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout, int v, bool matte)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a06c4a7a2cea0acf26c099c4b5554bdab}{ropin}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&source, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&matte, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a6d075919a2603d7734e42c1b6ebc8cb8}{ropout}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&source, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&matte, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a572bb66b608047361c1d599a795c4fe7}{atop}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ac40128e0f0e7941fa551849ef6f14036}{txor}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ac115e66f53280dbca21075c52259b084}{cross\+Dissolve}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout, UCHAR v)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a99c6bf2fd7d769ac68ef2663b6bb5870}{lighten}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a49f90a16ba17adf6e194d8aefff4e172}{darken}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a0cf1cee72615a6140aa04f91f4d345f2}{ropmin}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout, bool matte)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a1e4be06e2ffe44d151a50c35a5cc25b3}{ropmax}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a69a13be2091e3060864a17534b00af7b}{linearburn}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a73e7c02af837288795455fb0280ab614}{overlay}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rup, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rdown, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_aa8671761db1d55d696b4b8bb71f8b2e4}{premultiply}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&ras)
\begin{DoxyCompactList}\small\item\em Make a premultiply of all raster pixels. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_add7d14f883c53c3d68ca0f256c42689f}{depremultiply}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&ras)
\begin{DoxyCompactList}\small\item\em Make a depremultiply of all raster pixels. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a8b092782761fe2b3ce0dfb289b3dd02e}{expand\+Color}} (const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \&ras32, bool precise)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a35fb11523175f84027df48cc51d45d28}{white\+Transp}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&ras)
\begin{DoxyCompactList}\small\item\em all white pixels are set to transparent \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_aea1238f9b183113d9a097177c9ef2f17}{apply\+Color\+Scale}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&ras, const TPixel32 \&color\+Scale)
\begin{DoxyCompactList}\small\item\em apply color filter and semi-\/transparency of column to the render result \end{DoxyCompactList}\item 
DVAPI \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \mbox{\hyperlink{namespace_t_rop_abb73976f88b3ec3d0a3b2cf822dff605}{shrink}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rin, int shrink)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ad4babe6813c171b27ede85b106642bf2}{gamma\+Correct}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} raster, double gamma)
\begin{DoxyCompactList}\small\item\em Make a {\bfseries{gamma}} correct in the {\bfseries{raster}}. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ae49245fbc12b809384cb6e1bf03c9b76}{gamma\+Correct\+RGBM}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} raster, double gammar, double gammag, double gammab, double gammam)
\begin{DoxyCompactList}\small\item\em Make a {\bfseries{gamma}} correct in the {\bfseries{raster}}. \end{DoxyCompactList}\item 
DVAPI int \mbox{\hyperlink{namespace_t_rop_ae6809ae7f416ba30d31d3e7305be87f9}{get\+Blur\+Border}} (double \mbox{\hyperlink{namespace_t_rop_a9baa771ae6b7beb73d594266761d2cf2}{blur}})
\begin{DoxyCompactList}\small\item\em Return the pixel size of the {\bfseries{blur}} border. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a7a6326a4ee5b8a7fd5e928d67926a8e6}{antialias}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&src, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&dst, int threshold, int softness)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a6dd60c2e85a75e42d593ee351876d614}{majority\+Despeckle}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&ras, int size\+Threshold)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a9baa771ae6b7beb73d594266761d2cf2}{blur}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&dst\+Ras, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&src\+Ras, double blur, int dx, int dy, bool use\+SSE=false)
\begin{DoxyCompactList}\small\item\em Make blur effect on {\bfseries{src\+Ras}} raster and put the result in {\bfseries{dst\+Ras}}. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ac6e615dabc3bd3a4f7681ca7d0a743f1}{raylit}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&dst\+Ras, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&src\+Ras, const \mbox{\hyperlink{struct_t_rop_1_1_raylit_params}{Raylit\+Params}} \&params)
\begin{DoxyCompactList}\small\item\em Make raylit effect on {\bfseries{src\+Ras}} raster and put the result in {\bfseries{dst\+Ras}}. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a6ed7aee971d5bb0c6a7304a76c161b51}{glass\+Raylit}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&dst\+Ras, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&src\+Ras, const \mbox{\hyperlink{struct_t_rop_1_1_raylit_params}{Raylit\+Params}} \&params)
\item 
\mbox{\Hypertarget{namespace_t_rop_a60b42d98c73278e9767aa2932c43f6a5}\label{namespace_t_rop_a60b42d98c73278e9767aa2932c43f6a5}} 
DVAPI void {\bfseries despeckle} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&ras, int size\+Threshold, bool check, bool trasparent\+Is\+White=false)
\item 
\mbox{\Hypertarget{namespace_t_rop_a46b386c0153301c1e78f6b7a3997677a}\label{namespace_t_rop_a46b386c0153301c1e78f6b7a3997677a}} 
DVAPI void {\bfseries despeckle} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rin, int size\+Threshold, bool check)
\item 
DVAPI \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \mbox{\hyperlink{namespace_t_rop_aec16db9b546d40b13e1e5b0946417b07}{copy\+And\+Swap\+RBChannels}} (const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \&src\+Raster)
\begin{DoxyCompactList}\small\item\em Return a raster with r b channels swapped. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a8ffa1a15060b77c5386240cdcb06394f}{make\+Stereo\+Raster}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&left, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&right)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ac744a16161fdfd8ce7de4cd12cd0307d}{set\+Channel}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rin, \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, UCHAR chan, bool greytones)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ae9c480cced8c0b7b1cb8402e99c5af8d}{erodilate}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rin, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&rout, double radius, Erodilate\+Mask\+Type type)
\item 
DVAPI \mbox{\hyperlink{struct___r_a_s_t_e_r}{\+\_\+\+RASTER}} $\ast$ \mbox{\hyperlink{namespace_t_rop_a6fc864590b3faf072c5468255ee9f3ea}{convert\+Raster50to46}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&in\+Ras, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&in\+Palette)
\begin{DoxyCompactList}\small\item\em Convert TRasterP in an old toonz raster! \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a8d7ac440af02d94cf688b9273e5a7d42}{release\+Raster46}} (\mbox{\hyperlink{struct___r_a_s_t_e_r}{\+\_\+\+RASTER}} $\ast$\&r, bool do\+Release\+Buffer=false)
\begin{DoxyCompactList}\small\item\em Release the old toonz raster. \end{DoxyCompactList}\item 
DVAPI \mbox{\hyperlink{struct___r_a_s_t_e_r}{\+\_\+\+RASTER}} $\ast$ \mbox{\hyperlink{namespace_t_rop_a275dd3a1daddba779d05f13b89b44db1}{read\+Raster46}} (const char $\ast$filename)
\begin{DoxyCompactList}\small\item\em Read an image in the path {\bfseries{filename}} and put it in an old toonz raster. \end{DoxyCompactList}\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a0403b9158edb19e8b805ef2cfffc8900}{lock\+Raster}} (\mbox{\hyperlink{struct___r_a_s_t_e_r}{\+\_\+\+RASTER}} $\ast$raster)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_afaf9411cf1fb10df32870e97d82043a0}{unlock\+Raster}} (\mbox{\hyperlink{struct___r_a_s_t_e_r}{\+\_\+\+RASTER}} $\ast$raster)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ae62af9d021cc9d4428b4a996c2c40918}{convert}} (const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \&ras\+Out, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&ras\+In, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} palette, bool transparency\+Check=false)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a86eca3417474265356482b543841bc90}{convert}} (const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \&ras\+Out, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&ras\+In, \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} palette, const \mbox{\hyperlink{class_t_rect_t}{TRect}} \&the\+Clip\+Rect, bool transparency\+Check=false, bool apply\+Fx=false)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a2ffbde782744822c73ea95817bbaf9ed}{convert}} (const \mbox{\hyperlink{class_t_tile}{TTile}} \&dst, const \mbox{\hyperlink{class_t_tile}{TTile}} \&src, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} plt, bool transparency\+Check, bool apply\+Fxs)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a0d6489eab1d284da27d796df4a860d5c}{apply\+Match\+Lines}} (\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} ras\+Out, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&ras\+Up, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&plt\+Out, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&match\+Plt, int ink\+Index, int matchline\+Prevalence, std\+::map$<$ int, int $>$ \&used\+Inks)
\item 
\mbox{\Hypertarget{namespace_t_rop_a7d9a6165e4b1e6b7d9ca75b471d4318b}\label{namespace_t_rop_a7d9a6165e4b1e6b7d9ca75b471d4318b}} 
DVAPI void {\bfseries merge\+Cmapped} (\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} ras\+Out, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&ras\+Up, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&plt\+Out, int matchline\+Prevalence, std\+::map$<$ int, int $>$ \&used\+Colors)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a98a26ca9c2980b8a0a33ee8475f7db64}{overlay\+Cmapped}} (\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} ras\+Out, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&ras\+Up, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&plt\+Out, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&up\+Plt, std\+::map$<$ int, int $>$ \&used\+Colors)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ab11c9fa6fc9221ea22161a5c148ef2e9}{erase\+Colors}} (\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} ras, std\+::vector$<$ int $>$ $\ast$color\+Ids, bool erase\+Inks, bool no\+Gap=false)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_af64e0fbf864d2bcffd3a959020dd4007}{erase\+Style\+Ids}} (\mbox{\hyperlink{class_t_toonz_image}{TToonz\+Image}} $\ast$image, const std\+::vector$<$ int $>$ style\+Ids)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_ab35a3fe8769547a6b9cdd219a630a296}{resample}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&out, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&in, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} palette, const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff, \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}{Resample\+Filter\+Type}} filter\+Type=\mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}{Triangle}}, double \mbox{\hyperlink{namespace_t_rop_a9baa771ae6b7beb73d594266761d2cf2}{blur}}=1.)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a4c6dae8ce37af1d30fded509f9ea7546}{convolve\+\_\+3\+\_\+i}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} rin, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&palette, int dx, int dy, double conv\mbox{[}$\,$\mbox{]})
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a3c1b6b5ed6465346721de15ac07de8e6}{convolve\+\_\+i}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} rin, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&palette, int dx, int dy, double conv\mbox{[}$\,$\mbox{]}, int radius)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_abdc4625a0fab7775638e375c71404b4c}{fracmove}} (\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout, \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} rin, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&palette, double dx, double dy)
\item 
\mbox{\Hypertarget{namespace_t_rop_ad7759afc120e9dfb5d0afb9539d0278c}\label{namespace_t_rop_ad7759afc120e9dfb5d0afb9539d0278c}} 
DVAPI void {\bfseries zoom\+Out\+Cm32\+Rgbm} (const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&rin, \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \&rout, const \mbox{\hyperlink{class_t_palette}{TPalette}} \&plt, int x1, int y1, int x2, int y2, int newx, int newy, int abs\+Zoom\+Level)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a35179ddf5774082da20b53eb7baf0e96}{make\+Icon}} (\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&rout, const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&rin)
\item 
DVAPI void \mbox{\hyperlink{namespace_t_rop_a4fd8400a235f04da06f526186d439291}{expand\+Paint}} (const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&ras\+CM)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The \mbox{\hyperlink{namespace_t_rop}{TRop}} namespace provides various algorithms to operate with Toonz\textquotesingle{}s raster types

The TRop\+::borders namespace contains functions and classes that perform contours extraction of a specified raster (either greyscale, fullcolor or colormap).

Image contours are currently extracted in a not-\/hierarchycal fashion (ie in succession) and supplied through a reimplementable reader class. 

\doxysubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{namespace_t_rop_a1489562a4d82f9d71613c87584bf3821}\label{namespace_t_rop_a1489562a4d82f9d71613c87584bf3821}} 
\index{TRop@{TRop}!ColorMask@{ColorMask}}
\index{ColorMask@{ColorMask}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{ColorMask}{ColorMask}}
{\footnotesize\ttfamily enum TRop\+::\+Color\+Mask}


\begin{DoxyCode}{0}
\DoxyCodeLine{00088 \{ RChan = 0x1, GChan = 0x2, BChan = 0x4, MChan = 0x8 \};}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a9f8c5a1cb56f7482862e506adb15a04e}\label{namespace_t_rop_a9f8c5a1cb56f7482862e506adb15a04e}} 
\index{TRop@{TRop}!ErodilateMaskType@{ErodilateMaskType}}
\index{ErodilateMaskType@{ErodilateMaskType}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{ErodilateMaskType}{ErodilateMaskType}}
{\footnotesize\ttfamily enum TRop\+::\+Erodilate\+Mask\+Type}


\begin{DoxyCode}{0}
\DoxyCodeLine{00090 \{ ED\_rectangular, ED\_circular \};}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}} 
\index{TRop@{TRop}!ResampleFilterType@{ResampleFilterType}}
\index{ResampleFilterType@{ResampleFilterType}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{ResampleFilterType}{ResampleFilterType}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}{TRop\+::\+Resample\+Filter\+Type}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{Triangle@{Triangle}!TRop@{TRop}}\index{TRop@{TRop}!Triangle@{Triangle}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}} 
Triangle&triangle filter \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Mitchell@{Mitchell}!TRop@{TRop}}\index{TRop@{TRop}!Mitchell@{Mitchell}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168adaa7b87b985724e085f7281d2817dfb6}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168adaa7b87b985724e085f7281d2817dfb6}} 
Mitchell&Mitchell-\/\+Netravali filter. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Cubic5@{Cubic5}!TRop@{TRop}}\index{TRop@{TRop}!Cubic5@{Cubic5}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a5299db768d5b5c8554907b73a6075ce1}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a5299db768d5b5c8554907b73a6075ce1}} 
Cubic5&cubic convolution, a = .5 \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Cubic75@{Cubic75}!TRop@{TRop}}\index{TRop@{TRop}!Cubic75@{Cubic75}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad232a671a97d1958fa9caa4696f3efa7}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad232a671a97d1958fa9caa4696f3efa7}} 
Cubic75&cubic convolution, a = .75 \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Cubic1@{Cubic1}!TRop@{TRop}}\index{TRop@{TRop}!Cubic1@{Cubic1}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a4932c6c099d4f68848d72736be6f321e}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a4932c6c099d4f68848d72736be6f321e}} 
Cubic1&cubic convolution, a = 1 \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Hann2@{Hann2}!TRop@{TRop}}\index{TRop@{TRop}!Hann2@{Hann2}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a8142bce9410b8ca2682b7f41d0fe1cda}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a8142bce9410b8ca2682b7f41d0fe1cda}} 
Hann2&Hann window, rad = 2. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Hann3@{Hann3}!TRop@{TRop}}\index{TRop@{TRop}!Hann3@{Hann3}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad1a6a213a56880e3be5f9df4632a903d}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad1a6a213a56880e3be5f9df4632a903d}} 
Hann3&Hann window, rad = 3. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Hamming2@{Hamming2}!TRop@{TRop}}\index{TRop@{TRop}!Hamming2@{Hamming2}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad74259f9d68bb2918533b70790355a6c}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad74259f9d68bb2918533b70790355a6c}} 
Hamming2&Hamming window, rad = 2. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Hamming3@{Hamming3}!TRop@{TRop}}\index{TRop@{TRop}!Hamming3@{Hamming3}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168adbd720438a66e557e65a1419610d9ef9}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168adbd720438a66e557e65a1419610d9ef9}} 
Hamming3&Hamming window, rad = 3. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Lanczos2@{Lanczos2}!TRop@{TRop}}\index{TRop@{TRop}!Lanczos2@{Lanczos2}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a4e7a2bc406cecb691f8f0d5fa1d9d84c}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a4e7a2bc406cecb691f8f0d5fa1d9d84c}} 
Lanczos2&Lanczos window, rad = 2. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Lanczos3@{Lanczos3}!TRop@{TRop}}\index{TRop@{TRop}!Lanczos3@{Lanczos3}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a5fef44f41eda4cbf63092b0634616095}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a5fef44f41eda4cbf63092b0634616095}} 
Lanczos3&Lanczos window, rad = 3. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Gauss@{Gauss}!TRop@{TRop}}\index{TRop@{TRop}!Gauss@{Gauss}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a6fd64688f6f661bd7c76dee932d048ca}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a6fd64688f6f661bd7c76dee932d048ca}} 
Gauss&Gaussian convolution. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ClosestPixel@{ClosestPixel}!TRop@{TRop}}\index{TRop@{TRop}!ClosestPixel@{ClosestPixel}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a92694e20fb1c18f7987cda447d4553ff}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a92694e20fb1c18f7987cda447d4553ff}} 
Closest\+Pixel&\textquotesingle{}Quick\textquotesingle{} filter \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Bilinear@{Bilinear}!TRop@{TRop}}\index{TRop@{TRop}!Bilinear@{Bilinear}}}\mbox{\Hypertarget{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a152d46ac03e804c799ed08f703eeeb4e}\label{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a152d46ac03e804c799ed08f703eeeb4e}} 
Bilinear&\textquotesingle{}Quick\textquotesingle{} filter \\
\hline

\end{DoxyEnumFields}

\begin{DoxyCode}{0}
\DoxyCodeLine{00054                         \{}
\DoxyCodeLine{00055   None,}
\DoxyCodeLine{00057   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}{Triangle}},}
\DoxyCodeLine{00059   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168adaa7b87b985724e085f7281d2817dfb6}{Mitchell}},}
\DoxyCodeLine{00061   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a5299db768d5b5c8554907b73a6075ce1}{Cubic5}},}
\DoxyCodeLine{00063   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad232a671a97d1958fa9caa4696f3efa7}{Cubic75}},}
\DoxyCodeLine{00065   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a4932c6c099d4f68848d72736be6f321e}{Cubic1}},}
\DoxyCodeLine{00067   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a8142bce9410b8ca2682b7f41d0fe1cda}{Hann2}},}
\DoxyCodeLine{00069   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad1a6a213a56880e3be5f9df4632a903d}{Hann3}},}
\DoxyCodeLine{00071   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168ad74259f9d68bb2918533b70790355a6c}{Hamming2}},}
\DoxyCodeLine{00073   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168adbd720438a66e557e65a1419610d9ef9}{Hamming3}},}
\DoxyCodeLine{00075   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a4e7a2bc406cecb691f8f0d5fa1d9d84c}{Lanczos2}},}
\DoxyCodeLine{00077   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a5fef44f41eda4cbf63092b0634616095}{Lanczos3}},}
\DoxyCodeLine{00079   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a6fd64688f6f661bd7c76dee932d048ca}{Gauss}},}
\DoxyCodeLine{00081   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a92694e20fb1c18f7987cda447d4553ff}{ClosestPixel}},}
\DoxyCodeLine{00083   \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168a152d46ac03e804c799ed08f703eeeb4e}{Bilinear}},}
\DoxyCodeLine{00084 }
\DoxyCodeLine{00085   HowMany}
\DoxyCodeLine{00086 \};}

\end{DoxyCode}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespace_t_rop_a2f513936a4a4450e3839a01eacb1d962}\label{namespace_t_rop_a2f513936a4a4450e3839a01eacb1d962}} 
\index{TRop@{TRop}!add@{add}}
\index{add@{add}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{add()}{add()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void TRop\+::add (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}



Add {\bfseries{rdown}} pixels to {\bfseries{rup}} pixels and put the resulting raster in {\bfseries{rout}}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00173                                      \{}
\DoxyCodeLine{00174   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{00175   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{00176   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{00177 }
\DoxyCodeLine{00178   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{00179     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{00180 }
\DoxyCodeLine{00181     USHORT r, g, b, m;}
\DoxyCodeLine{00182     r = downPix-\/>r + upPix-\/>r;}
\DoxyCodeLine{00183     g = downPix-\/>g + upPix-\/>g;}
\DoxyCodeLine{00184     b = downPix-\/>b + upPix-\/>b;}
\DoxyCodeLine{00185     m = downPix-\/>m + upPix-\/>m;}
\DoxyCodeLine{00186 }
\DoxyCodeLine{00187     outPix-\/>r = (UCHAR)tcrop<USHORT>(r, 0, 255);}
\DoxyCodeLine{00188     outPix-\/>g = (UCHAR)tcrop<USHORT>(g, 0, 255);}
\DoxyCodeLine{00189     outPix-\/>b = (UCHAR)tcrop<USHORT>(b, 0, 255);}
\DoxyCodeLine{00190     outPix-\/>m = (UCHAR)tcrop<USHORT>(m, 0, 255);}
\DoxyCodeLine{00191 }
\DoxyCodeLine{00192     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{00193   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00194     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{00195     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{00196     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{00197 }
\DoxyCodeLine{00198     \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{00199       FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{00200 }
\DoxyCodeLine{00201       TINT32 r, g, b, m;}
\DoxyCodeLine{00202       r = downPix-\/>r + upPix-\/>r;}
\DoxyCodeLine{00203       g = downPix-\/>g + upPix-\/>g;}
\DoxyCodeLine{00204       b = downPix-\/>b + upPix-\/>b;}
\DoxyCodeLine{00205       m = downPix-\/>m + upPix-\/>m;}
\DoxyCodeLine{00206 }
\DoxyCodeLine{00207       outPix-\/>r = (USHORT)tcrop<TINT32>(r, 0, 0xffff);}
\DoxyCodeLine{00208       outPix-\/>g = (USHORT)tcrop<TINT32>(g, 0, 0xffff);}
\DoxyCodeLine{00209       outPix-\/>b = (USHORT)tcrop<TINT32>(b, 0, 0xffff);}
\DoxyCodeLine{00210       outPix-\/>m = (USHORT)tcrop<TINT32>(m, 0, 0xffff);}
\DoxyCodeLine{00211 }
\DoxyCodeLine{00212       FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{00213     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00214       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} up8   = rup;}
\DoxyCodeLine{00215       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} down8 = rdown;}
\DoxyCodeLine{00216       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} out8  = rout;}
\DoxyCodeLine{00217 }
\DoxyCodeLine{00218       \textcolor{keywordflow}{if} (up8 \&\& down8 \&\& out8) \{}
\DoxyCodeLine{00219         FOR\_EACH\_PIXEL\_8\_BEGIN\_LOOP}
\DoxyCodeLine{00220 }
\DoxyCodeLine{00221         USHORT value = upPix-\/>value + downPix-\/>value;}
\DoxyCodeLine{00222 }
\DoxyCodeLine{00223         outPix-\/>value = (UCHAR)tcrop<USHORT>(value, 0, 255);}
\DoxyCodeLine{00224 }
\DoxyCodeLine{00225         FOR\_EACH\_PIXEL\_8\_END\_LOOP}
\DoxyCodeLine{00226       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00227         \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::add invalid raster combination"{}});}
\DoxyCodeLine{00228     \}}
\DoxyCodeLine{00229   \}}
\DoxyCodeLine{00230 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a0d74d2e7b5135fe978af69553d6bd3da}\label{namespace_t_rop_a0d74d2e7b5135fe978af69553d6bd3da}} 
\index{TRop@{TRop}!add@{add}}
\index{add@{add}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{add()}{add()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void TRop\+::add (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout,  }\item[{double}]{v }\end{DoxyParamCaption})}

Add {\bfseries{rdown}} pixels to {\bfseries{rup}} pixels in according with the factor {\bfseries{v}} and put the resulting raster in {\bfseries{rout}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{00108                          \{}
\DoxyCodeLine{00109   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{00110   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{00111   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{00112 }
\DoxyCodeLine{00113   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{00114     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{00115 }
\DoxyCodeLine{00116     TINT32 r, g, b, m;}
\DoxyCodeLine{00117     \textcolor{keywordflow}{if} (upPix-\/>m == 0)}
\DoxyCodeLine{00118       *outPix = *downPix;}
\DoxyCodeLine{00119     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00120       r         = downPix-\/>r + tround(upPix-\/>r * v);}
\DoxyCodeLine{00121       g         = downPix-\/>g + tround(upPix-\/>g * v);}
\DoxyCodeLine{00122       b         = downPix-\/>b + tround(upPix-\/>b * v);}
\DoxyCodeLine{00123       m         = downPix-\/>m + tround(upPix-\/>m * v);}
\DoxyCodeLine{00124       outPix-\/>r = (UCHAR)tcrop<TINT32>(r, (TINT32)0, (TINT32)255);}
\DoxyCodeLine{00125       outPix-\/>g = (UCHAR)tcrop<TINT32>(g, (TINT32)0, (TINT32)255);}
\DoxyCodeLine{00126       outPix-\/>b = (UCHAR)tcrop<TINT32>(b, (TINT32)0, (TINT32)255);}
\DoxyCodeLine{00127       outPix-\/>m = (UCHAR)tcrop<TINT32>(m, (TINT32)0, (TINT32)255);}
\DoxyCodeLine{00128     \}}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{00131   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00132     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{00133     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{00134     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{00135 }
\DoxyCodeLine{00136     \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{00137       FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{00138 }
\DoxyCodeLine{00139       TINT32 r, g, b, m;}
\DoxyCodeLine{00140       r = downPix-\/>r + tround(upPix-\/>r * v);}
\DoxyCodeLine{00141       g = downPix-\/>g + tround(upPix-\/>g * v);}
\DoxyCodeLine{00142       b = downPix-\/>b + tround(upPix-\/>b * v);}
\DoxyCodeLine{00143       m = downPix-\/>m + tround(upPix-\/>m * v);}
\DoxyCodeLine{00144 }
\DoxyCodeLine{00145       outPix-\/>r = (USHORT)tcrop<TINT32>(r, 0, 0xffff);}
\DoxyCodeLine{00146       outPix-\/>g = (USHORT)tcrop<TINT32>(g, 0, 0xffff);}
\DoxyCodeLine{00147       outPix-\/>b = (USHORT)tcrop<TINT32>(b, 0, 0xffff);}
\DoxyCodeLine{00148       outPix-\/>m = (USHORT)tcrop<TINT32>(m, 0, 0xffff);}
\DoxyCodeLine{00149 }
\DoxyCodeLine{00150       FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{00151     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00152       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} up8   = rup;}
\DoxyCodeLine{00153       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} down8 = rdown;}
\DoxyCodeLine{00154       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} out8  = rout;}
\DoxyCodeLine{00155 }
\DoxyCodeLine{00156       \textcolor{keywordflow}{if} (up8 \&\& down8 \&\& out8) \{}
\DoxyCodeLine{00157         FOR\_EACH\_PIXEL\_8\_BEGIN\_LOOP}
\DoxyCodeLine{00158 }
\DoxyCodeLine{00159         USHORT value = troundp(upPix-\/>value * v) + downPix-\/>value;}
\DoxyCodeLine{00160 }
\DoxyCodeLine{00161         outPix-\/>value = (UCHAR)tcrop<USHORT>(value, 0, 255);}
\DoxyCodeLine{00162 }
\DoxyCodeLine{00163         FOR\_EACH\_PIXEL\_8\_END\_LOOP}
\DoxyCodeLine{00164       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00165         \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::add invalid raster combination"{}});}
\DoxyCodeLine{00166     \}}
\DoxyCodeLine{00167   \}}
\DoxyCodeLine{00168 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00276}{Add\+Fx\+::process()}}.

\mbox{\Hypertarget{namespace_t_rop_a789f797a79d572d97182478cc9826c8a}\label{namespace_t_rop_a789f797a79d572d97182478cc9826c8a}} 
\index{TRop@{TRop}!addBackground@{addBackground}}
\index{addBackground@{addBackground}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{addBackground()}{addBackground()}}
{\footnotesize\ttfamily void TRop\+::add\+Background (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{ras,  }\item[{const TPixel32 \&}]{col }\end{DoxyParamCaption})}



Add background of color {\bfseries{col}} to the {\bfseries{ras}} raster. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00387                                                           \{}
\DoxyCodeLine{00388   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = ras;}
\DoxyCodeLine{00389   \textcolor{keywordflow}{if} (ras32)}
\DoxyCodeLine{00390     addBackground32(ras32, col);}
\DoxyCodeLine{00391   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00392     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}unsupported pixel type"{}});}
\DoxyCodeLine{00393 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00569}{TCleanupper\+::process()}}, and \mbox{\hyperlink{l00086}{Custom\+Style\+Manager\+::\+Style\+Loader\+Task\+::run()}}.

\mbox{\Hypertarget{namespace_t_rop_a7a6326a4ee5b8a7fd5e928d67926a8e6}\label{namespace_t_rop_a7a6326a4ee5b8a7fd5e928d67926a8e6}} 
\index{TRop@{TRop}!antialias@{antialias}}
\index{antialias@{antialias}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{antialias()}{antialias()}}
{\footnotesize\ttfamily void TRop\+::antialias (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{src,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{dst,  }\item[{int}]{threshold,  }\item[{int}]{softness }\end{DoxyParamCaption})}

Inserts antialias around jaggy lines. Threshold is a pixel distance intended from 0 to 256. Softness may vary from 0 to 100. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00379                                    \{}
\DoxyCodeLine{00380   assert(src-\/>getSize() == dst-\/>getSize());}
\DoxyCodeLine{00381 }
\DoxyCodeLine{00382   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} src32(src), dst32(dst);}
\DoxyCodeLine{00383   \textcolor{keywordflow}{if} (src32 \&\& dst32) \{}
\DoxyCodeLine{00384     makeAntialias<TPixel32>(src32, dst32, threshold, softness);}
\DoxyCodeLine{00385     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00386   \}}
\DoxyCodeLine{00387 }
\DoxyCodeLine{00388   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} src64(src), dst64(dst);}
\DoxyCodeLine{00389   \textcolor{keywordflow}{if} (src64 \&\& dst64) \{}
\DoxyCodeLine{00390     makeAntialias<TPixel64>(src64, dst64, threshold << 8, softness);}
\DoxyCodeLine{00391     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00392   \}}
\DoxyCodeLine{00393 }
\DoxyCodeLine{00394   \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} srcCM(src), dstCM(dst);}
\DoxyCodeLine{00395   \textcolor{keywordflow}{if} (srcCM \&\& dstCM) \{}
\DoxyCodeLine{00396     makeAntialias<TPixelCM32>(srcCM, dstCM, threshold, softness);}
\DoxyCodeLine{00397     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00398   \}}
\DoxyCodeLine{00399 }
\DoxyCodeLine{00400   assert(!\textcolor{stringliteral}{"{}Source and destination rasters must be of the same type!"{}});}
\DoxyCodeLine{00401 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_aea1238f9b183113d9a097177c9ef2f17}\label{namespace_t_rop_aea1238f9b183113d9a097177c9ef2f17}} 
\index{TRop@{TRop}!applyColorScale@{applyColorScale}}
\index{applyColorScale@{applyColorScale}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{applyColorScale()}{applyColorScale()}}
{\footnotesize\ttfamily void TRop\+::apply\+Color\+Scale (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{ras,  }\item[{const TPixel32 \&}]{color\+Scale }\end{DoxyParamCaption})}



apply color filter and semi-\/transparency of column to the render result 


\begin{DoxyCode}{0}
\DoxyCodeLine{01694                                                                           \{}
\DoxyCodeLine{01695   ras-\/>lock();}
\DoxyCodeLine{01696 }
\DoxyCodeLine{01697   \mbox{\hyperlink{namespace_t_rop_add7d14f883c53c3d68ca0f256c42689f}{TRop::depremultiply}}(ras);}
\DoxyCodeLine{01698 }
\DoxyCodeLine{01699   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = ras;}
\DoxyCodeLine{01700   \textcolor{keywordtype}{int} maxCh        = TPixel32::maxChannelValue;}
\DoxyCodeLine{01701   \textcolor{keywordflow}{if} (ras32) \{}
\DoxyCodeLine{01702     TPixel32 *endPix, *upPix = 0, *upRow = ras32-\/>pixels();}
\DoxyCodeLine{01703     TPixel32 *lastPix =}
\DoxyCodeLine{01704         upRow + ras32-\/>getWrap() * (ras32-\/>getLy() -\/ 1) + ras32-\/>getLx();}
\DoxyCodeLine{01705 }
\DoxyCodeLine{01706     \textcolor{keywordflow}{while} (upPix < lastPix) \{}
\DoxyCodeLine{01707       upPix  = upRow;}
\DoxyCodeLine{01708       endPix = upPix + ras32-\/>getLx();}
\DoxyCodeLine{01709       \textcolor{keywordflow}{while} (upPix < endPix) \{}
\DoxyCodeLine{01710         \textcolor{keywordtype}{int} maxCh = TPixel32::maxChannelValue;}
\DoxyCodeLine{01711         \textcolor{keywordtype}{int} r  = maxCh -\/ (maxCh -\/ (*upPix).r) * (maxCh -\/ colorScale.r) / maxCh;}
\DoxyCodeLine{01712         \textcolor{keywordtype}{int} g  = maxCh -\/ (maxCh -\/ (*upPix).g) * (maxCh -\/ colorScale.g) / maxCh;}
\DoxyCodeLine{01713         \textcolor{keywordtype}{int} b  = maxCh -\/ (maxCh -\/ (*upPix).b) * (maxCh -\/ colorScale.b) / maxCh;}
\DoxyCodeLine{01714         \textcolor{keywordtype}{int} m  = (*upPix).m * colorScale.m / maxCh;}
\DoxyCodeLine{01715         *upPix = TPixel32(r, g, b, m);}
\DoxyCodeLine{01716         ++upPix;}
\DoxyCodeLine{01717       \}}
\DoxyCodeLine{01718       upRow += ras32-\/>getWrap();}
\DoxyCodeLine{01719     \}}
\DoxyCodeLine{01720   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01721     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} ras64 = ras;}
\DoxyCodeLine{01722     \textcolor{keywordflow}{if} (ras64) \{}
\DoxyCodeLine{01723       TPixel64 *endPix, *upPix = 0, *upRow = ras64-\/>pixels();}
\DoxyCodeLine{01724       TPixel64 *lastPix =}
\DoxyCodeLine{01725           upRow + ras64-\/>getWrap() * (ras64-\/>getLy() -\/ 1) + ras64-\/>getLx();}
\DoxyCodeLine{01726 }
\DoxyCodeLine{01727       \textcolor{keywordtype}{int} maxCh64 = TPixel64::maxChannelValue;}
\DoxyCodeLine{01728       \textcolor{keywordflow}{while} (upPix < lastPix) \{}
\DoxyCodeLine{01729         upPix  = upRow;}
\DoxyCodeLine{01730         endPix = upPix + ras64-\/>getLx();}
\DoxyCodeLine{01731         \textcolor{keywordflow}{while} (upPix < endPix) \{}
\DoxyCodeLine{01732           \textcolor{keywordtype}{int} r =}
\DoxyCodeLine{01733               maxCh64 -\/ (maxCh64 -\/ (*upPix).r) * (maxCh -\/ colorScale.r) / maxCh;}
\DoxyCodeLine{01734           \textcolor{keywordtype}{int} g =}
\DoxyCodeLine{01735               maxCh64 -\/ (maxCh64 -\/ (*upPix).g) * (maxCh -\/ colorScale.g) / maxCh;}
\DoxyCodeLine{01736           \textcolor{keywordtype}{int} b =}
\DoxyCodeLine{01737               maxCh64 -\/ (maxCh64 -\/ (*upPix).b) * (maxCh -\/ colorScale.b) / maxCh;}
\DoxyCodeLine{01738           \textcolor{keywordtype}{int} m  = (*upPix).m * colorScale.m / maxCh;}
\DoxyCodeLine{01739           *upPix = TPixel64(r, g, b, m);}
\DoxyCodeLine{01740           ++upPix;}
\DoxyCodeLine{01741         \}}
\DoxyCodeLine{01742         upRow += ras64-\/>getWrap();}
\DoxyCodeLine{01743       \}}
\DoxyCodeLine{01744     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01745       ras-\/>unlock();}
\DoxyCodeLine{01746       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}TRop::premultiply invalid raster type"{}});}
\DoxyCodeLine{01747     \}}
\DoxyCodeLine{01748   \}}
\DoxyCodeLine{01749   \mbox{\hyperlink{namespace_t_rop_aa8671761db1d55d696b4b8bb71f8b2e4}{TRop::premultiply}}(ras);}
\DoxyCodeLine{01750   ras-\/>unlock();}
\DoxyCodeLine{01751 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l01546}{depremultiply()}}, and \mbox{\hyperlink{l01503}{premultiply()}}.

\mbox{\Hypertarget{namespace_t_rop_a0d6489eab1d284da27d796df4a860d5c}\label{namespace_t_rop_a0d6489eab1d284da27d796df4a860d5c}} 
\index{TRop@{TRop}!applyMatchLines@{applyMatchLines}}
\index{applyMatchLines@{applyMatchLines}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{applyMatchLines()}{applyMatchLines()}}
{\footnotesize\ttfamily void TRop\+::apply\+Match\+Lines (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}}}]{ras\+Out,  }\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&}]{ras\+Up,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{plt\+Out,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{match\+Plt,  }\item[{int}]{ink\+Index,  }\item[{int}]{matchline\+Prevalence,  }\item[{std\+::map$<$ int, int $>$ \&}]{used\+Inks }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00860                                                        \{}
\DoxyCodeLine{00861   assert(matchlinePrevalence >= 0);}
\DoxyCodeLine{00862   \textcolor{keywordflow}{if} (inkIndex == -\/1)}
\DoxyCodeLine{00863     doMergeCmapped(rasOut, rasUp, pltOut, matchPlt, \textcolor{keyword}{true}, matchlinePrevalence,}
\DoxyCodeLine{00864                    usedInks, \textcolor{keyword}{false});}
\DoxyCodeLine{00865   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (inkIndex == -\/2)}
\DoxyCodeLine{00866     doMergeCmapped(rasOut, rasUp, pltOut, matchPlt, \textcolor{keyword}{true}, matchlinePrevalence,}
\DoxyCodeLine{00867                    usedInks, \textcolor{keyword}{true});}
\DoxyCodeLine{00868   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00869     doApplyMatchLines(rasOut, rasUp, inkIndex, matchlinePrevalence);}
\DoxyCodeLine{00870 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a572bb66b608047361c1d599a795c4fe7}\label{namespace_t_rop_a572bb66b608047361c1d599a795c4fe7}} 
\index{TRop@{TRop}!atop@{atop}}
\index{atop@{atop}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{atop()}{atop()}}
{\footnotesize\ttfamily void TRop\+::atop (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00930                                       \{}
\DoxyCodeLine{00931   \textcolor{comment}{// calcola rup ATOP rdown}}
\DoxyCodeLine{00932 }
\DoxyCodeLine{00933   \textcolor{comment}{// da ottimizzare...}}
\DoxyCodeLine{00934   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{00935   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{00936   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{00937   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{00938   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{00939   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{00940 }
\DoxyCodeLine{00941   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{00942     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{00943 }
\DoxyCodeLine{00944     TPixel32 tmpPix(0, 0, 0, 0);}
\DoxyCodeLine{00945     \textcolor{keywordflow}{if} (downPix-\/>m != 0) \{}
\DoxyCodeLine{00946       \textcolor{keyword}{const} \textcolor{keywordtype}{int} MAGICFAC = (257U * 256U + 1U);}
\DoxyCodeLine{00947       UINT fac           = MAGICFAC * downPix-\/>m;}
\DoxyCodeLine{00948 }
\DoxyCodeLine{00949       tmpPix.r = (UINT)(upPix-\/>r * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00950       tmpPix.g = (UINT)(upPix-\/>g * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00951       tmpPix.b = (UINT)(upPix-\/>b * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00952       tmpPix.m = (UINT)(upPix-\/>m * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00953     \}}
\DoxyCodeLine{00954 }
\DoxyCodeLine{00955     overPix<TPixel32, UCHAR>(*outPix, *downPix, tmpPix);}
\DoxyCodeLine{00956 }
\DoxyCodeLine{00957     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{00958   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{00959     FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{00960 }
\DoxyCodeLine{00961     TPixel64 tmpPix(0, 0, 0, 0);}
\DoxyCodeLine{00962     \textcolor{keywordflow}{if} (downPix-\/>m != 0) \{}
\DoxyCodeLine{00963       \textcolor{keywordtype}{double} fac = downPix-\/>m / 65535.0;}
\DoxyCodeLine{00964 }
\DoxyCodeLine{00965       tmpPix.r = (USHORT)(upPix-\/>r * fac);}
\DoxyCodeLine{00966       tmpPix.g = (USHORT)(upPix-\/>g * fac);}
\DoxyCodeLine{00967       tmpPix.b = (USHORT)(upPix-\/>b * fac);}
\DoxyCodeLine{00968       tmpPix.m = (USHORT)(upPix-\/>m * fac);}
\DoxyCodeLine{00969     \}}
\DoxyCodeLine{00970 }
\DoxyCodeLine{00971     overPix<TPixel64, USHORT>(*outPix, *downPix, tmpPix);}
\DoxyCodeLine{00972 }
\DoxyCodeLine{00973     FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{00974   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00975     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::atop invalid raster combination"{}});}
\DoxyCodeLine{00976 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a9baa771ae6b7beb73d594266761d2cf2}\label{namespace_t_rop_a9baa771ae6b7beb73d594266761d2cf2}} 
\index{TRop@{TRop}!blur@{blur}}
\index{blur@{blur}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{blur()}{blur()}}
{\footnotesize\ttfamily void TRop\+::blur (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{dst\+Ras,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{src\+Ras,  }\item[{double}]{blur,  }\item[{int}]{dx,  }\item[{int}]{dy,  }\item[{bool}]{use\+SSE = {\ttfamily false} }\end{DoxyParamCaption})}



Make blur effect on {\bfseries{src\+Ras}} raster and put the result in {\bfseries{dst\+Ras}}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00958                                              \{}
\DoxyCodeLine{00959   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} dstRas32 = dstRas;}
\DoxyCodeLine{00960   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} srcRas32 = srcRas;}
\DoxyCodeLine{00961 }
\DoxyCodeLine{00962   \textcolor{keywordflow}{if} (dstRas32 \&\& srcRas32)}
\DoxyCodeLine{00963     doBlurRgb<TPixel32, UCHAR, float>(dstRas32, srcRas32, blur, dx, dy, useSSE);}
\DoxyCodeLine{00964   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00965     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} dstRas64 = dstRas;}
\DoxyCodeLine{00966     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} srcRas64 = srcRas;}
\DoxyCodeLine{00967     \textcolor{keywordflow}{if} (dstRas64 \&\& srcRas64)}
\DoxyCodeLine{00968       doBlurRgb<TPixel64, USHORT, double>(dstRas64, srcRas64, blur, dx, dy,}
\DoxyCodeLine{00969                                           useSSE);}
\DoxyCodeLine{00970     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00971       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} dstRasGR8 = dstRas;}
\DoxyCodeLine{00972       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} srcRasGR8 = srcRas;}
\DoxyCodeLine{00973 }
\DoxyCodeLine{00974       \textcolor{keywordflow}{if} (dstRasGR8 \&\& srcRasGR8)}
\DoxyCodeLine{00975         doBlurGray<TPixelGR8>(dstRasGR8, srcRasGR8, blur, dx, dy);}
\DoxyCodeLine{00976       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00977         \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR16P}} dstRasGR16 = dstRas;}
\DoxyCodeLine{00978         \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR16P}} srcRasGR16 = srcRas;}
\DoxyCodeLine{00979 }
\DoxyCodeLine{00980         \textcolor{keywordflow}{if} (dstRasGR16 \&\& srcRasGR16)}
\DoxyCodeLine{00981           doBlurGray<TPixelGR16>(dstRasGR16, srcRasGR16, blur, dx, dy);}
\DoxyCodeLine{00982         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00983           \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}TRop::blur unsupported pixel type"{}});}
\DoxyCodeLine{00984       \}}
\DoxyCodeLine{00985     \}}
\DoxyCodeLine{00986   \}}
\DoxyCodeLine{00987 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_adc7ac986d64b4e8ee8270846b454e4d8}\label{namespace_t_rop_adc7ac986d64b4e8ee8270846b454e4d8}} 
\index{TRop@{TRop}!brush@{brush}}
\index{brush@{brush}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{brush()}{brush()}}
{\footnotesize\ttfamily void TRop\+::brush (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}}]{ras,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&}]{a,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&}]{b,  }\item[{int}]{radius,  }\item[{const TPixel32 \&}]{color }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00048                                       \{}
\DoxyCodeLine{00049   \mbox{\hyperlink{class_t_point_t}{TPoint}} a = aa;}
\DoxyCodeLine{00050   \mbox{\hyperlink{class_t_point_t}{TPoint}} b = bb;}
\DoxyCodeLine{00051   \textcolor{keywordflow}{if} (a.y > b.y) std::swap(a, b);  \textcolor{comment}{//  a e' piu' in basso di b}}
\DoxyCodeLine{00052 }
\DoxyCodeLine{00053   \textcolor{keywordtype}{int} lx = ras-\/>getLx();}
\DoxyCodeLine{00054   \textcolor{keywordtype}{int} ly = ras-\/>getLy();}
\DoxyCodeLine{00055   ras-\/>lock();}
\DoxyCodeLine{00056 }
\DoxyCodeLine{00057   \textcolor{comment}{// -\/-\/-\/-\/-\/ radius = 0}}
\DoxyCodeLine{00058   \textcolor{keywordflow}{if} (radius == 0) \{}
\DoxyCodeLine{00059     \textcolor{comment}{//  k = +1/-\/1 se il rettangolo e' inclinato positivamente}}
\DoxyCodeLine{00060     \textcolor{comment}{//  (0<=m)/negativamente (m<0)}}
\DoxyCodeLine{00061     \textcolor{comment}{//  (se k<0 viene fatta una riflessione sulle ascisse prima di tornare alle}}
\DoxyCodeLine{00062     \textcolor{comment}{//  coordinate "{}di schermo"{})}}
\DoxyCodeLine{00063     \textcolor{keywordtype}{int} k  = 1;}
\DoxyCodeLine{00064     \textcolor{keywordtype}{int} dy = b.y -\/ a.y;}
\DoxyCodeLine{00065     \textcolor{keywordtype}{int} dx = b.x -\/ a.x;}
\DoxyCodeLine{00066     \textcolor{keywordflow}{if} (dx < 0) \{}
\DoxyCodeLine{00067       dx = -\/dx;}
\DoxyCodeLine{00068       k  = -\/1;}
\DoxyCodeLine{00069     \}}
\DoxyCodeLine{00070 }
\DoxyCodeLine{00071     assert(dx >= 0);}
\DoxyCodeLine{00072     assert(dy >= 0);}
\DoxyCodeLine{00073 }
\DoxyCodeLine{00074     \textcolor{keywordtype}{double} m;  \textcolor{comment}{//  m sara' definita solo per dx!=0)}}
\DoxyCodeLine{00075     \textcolor{keywordflow}{if} (dx > 0) \{}
\DoxyCodeLine{00076       m = dy / (double)dx;}
\DoxyCodeLine{00077     \}}
\DoxyCodeLine{00078     \textcolor{comment}{// double length = sqrt(dx*dx + dy*dy);}}
\DoxyCodeLine{00079     \textcolor{keyword}{const} \textcolor{keywordtype}{int} alpha = dy, beta = -\/dx;}
\DoxyCodeLine{00080     \textcolor{keyword}{const} \textcolor{keywordtype}{int} incE  = alpha;}
\DoxyCodeLine{00081     \textcolor{keyword}{const} \textcolor{keywordtype}{int} incNE = alpha + beta;}
\DoxyCodeLine{00082     \textcolor{keyword}{const} \textcolor{keywordtype}{int} incN  = beta;}
\DoxyCodeLine{00083 }
\DoxyCodeLine{00084     \textcolor{comment}{//  N.B. le coordinate sono relative ad un sist. di rif. con l'origine in a}}
\DoxyCodeLine{00085     \textcolor{comment}{//  l'eq. della retta e' alpha * x + beta * y = 0}}
\DoxyCodeLine{00086 }
\DoxyCodeLine{00087     \textcolor{keywordtype}{int} yMin = std::max(a.y, 0) -\/ a.y;  \textcolor{comment}{//  clipping y + cambio  riferimento}}
\DoxyCodeLine{00088     \textcolor{keywordtype}{int} yMax = std::min(b.y, ly -\/ 1) -\/ a.y;  \textcolor{comment}{//  (trasporto dell'origine in a)}}
\DoxyCodeLine{00089     \textcolor{keywordflow}{if} (dx > 0 \&\& m <= 1) \{}
\DoxyCodeLine{00090       \textcolor{comment}{//  midpoint algorithm}}
\DoxyCodeLine{00091       \mbox{\hyperlink{class_t_point_t}{TPoint}} segm;}
\DoxyCodeLine{00092       \textcolor{keywordflow}{if} (dy == 0)  \textcolor{comment}{//  segmento orizzontale: inizializza segm}}
\DoxyCodeLine{00093       \{}
\DoxyCodeLine{00094         segm.x = 0;}
\DoxyCodeLine{00095         segm.y = yMin;}
\DoxyCodeLine{00096       \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  0<m<=1 :  inizializza segm}}
\DoxyCodeLine{00097       \{}
\DoxyCodeLine{00098         segm.x = tceil((yMin -\/ 0.5) / m);}
\DoxyCodeLine{00099         segm.y = yMin;}
\DoxyCodeLine{00100       \}}
\DoxyCodeLine{00101 }
\DoxyCodeLine{00102       \textcolor{keywordtype}{int} dSegm = tfloor(alpha * (segm.x + 1) + beta * (segm.y + 0.5));}
\DoxyCodeLine{00103       \textcolor{keywordflow}{while} (segm.y <= yMax) \{}
\DoxyCodeLine{00104         \textcolor{keywordtype}{int} count =}
\DoxyCodeLine{00105             0;  \textcolor{comment}{//  i trati orizzontali di segm vengono disegnati in "{}blocco"{}}}
\DoxyCodeLine{00106         \textcolor{keywordflow}{while} (dSegm < 0 \&\& segm.x <= dx)  \textcolor{comment}{//  Est:  segm.x<=dx evita il ciclo}}
\DoxyCodeLine{00107         \{                                  \textcolor{comment}{//  infinito quando m=0 (incE=0)}}
\DoxyCodeLine{00108           dSegm = dSegm + incE;}
\DoxyCodeLine{00109           segm.x++;}
\DoxyCodeLine{00110           count++;}
\DoxyCodeLine{00111         \}}
\DoxyCodeLine{00112         \textcolor{comment}{//  NordEst}}
\DoxyCodeLine{00113         \textcolor{keywordtype}{int} xMin, xMax;}
\DoxyCodeLine{00114         \textcolor{keywordflow}{if} (k > 0) \{}
\DoxyCodeLine{00115           xMin = std::max(}
\DoxyCodeLine{00116               \{a.x + segm.x -\/ count, a.x, 0\});  \textcolor{comment}{//  clipping x + ritorno alle}}
\DoxyCodeLine{00117           xMax = std::min(}
\DoxyCodeLine{00118               \{a.x + segm.x, b.x, lx -\/ 1\});  \textcolor{comment}{//  coordinate "{}di schermo"{}}}
\DoxyCodeLine{00119 }
\DoxyCodeLine{00120         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00121           xMin = std::max(\{a.x -\/ segm.x, a.x -\/ dx,}
\DoxyCodeLine{00122                            0\});  \textcolor{comment}{//  clipping x + riflessione + ritorno}}
\DoxyCodeLine{00123           xMax = std::min(\{a.x -\/ segm.x + count, a.x,}
\DoxyCodeLine{00124                            lx -\/ 1\});  \textcolor{comment}{//  alle  coordinate "{}di schermo"{}}}
\DoxyCodeLine{00125         \}}
\DoxyCodeLine{00126 }
\DoxyCodeLine{00127         TPixel32 *p = ras-\/>pixels(segm.y + a.y) + xMin;}
\DoxyCodeLine{00128         TPixel32 *q = p + (xMax -\/ xMin);}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130         \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00131 }
\DoxyCodeLine{00132         dSegm = dSegm + incNE;}
\DoxyCodeLine{00133         segm.x++;}
\DoxyCodeLine{00134         segm.y++;}
\DoxyCodeLine{00135       \}}
\DoxyCodeLine{00136     \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  m>1 oppure segmento verticale}}
\DoxyCodeLine{00137     \{}
\DoxyCodeLine{00138       \textcolor{comment}{//  midpoint algorithm}}
\DoxyCodeLine{00139       \mbox{\hyperlink{class_t_point_t}{TPoint}} segm;}
\DoxyCodeLine{00140       \textcolor{keywordflow}{if} (dx == 0)  \textcolor{comment}{//  segmento verticale: inizializza segm}}
\DoxyCodeLine{00141       \{}
\DoxyCodeLine{00142         segm.x = 0;}
\DoxyCodeLine{00143         segm.y = yMin;}
\DoxyCodeLine{00144       \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  m>1 :  inizializza segm}}
\DoxyCodeLine{00145       \{}
\DoxyCodeLine{00146         segm.x = tround(yMin / m);}
\DoxyCodeLine{00147         segm.y = yMin;}
\DoxyCodeLine{00148       \}}
\DoxyCodeLine{00149 }
\DoxyCodeLine{00150       \textcolor{keywordtype}{int} dSegm = tfloor(alpha * (segm.x + 0.5) + beta * (segm.y + 1));}
\DoxyCodeLine{00151       \textcolor{keywordflow}{while} (segm.y <= yMax) \{}
\DoxyCodeLine{00152         \textcolor{keywordtype}{int} xMin, xMax;}
\DoxyCodeLine{00153         \textcolor{keywordflow}{if} (k > 0) \{}
\DoxyCodeLine{00154           xMin = std::max(a.x + segm.x, 0);       \textcolor{comment}{//  clipping x + ritorno alle}}
\DoxyCodeLine{00155           xMax = std::min(a.x + segm.x, lx -\/ 1);  \textcolor{comment}{//  coordinate "{}di schermo"{}}}
\DoxyCodeLine{00156 }
\DoxyCodeLine{00157         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00158           xMin =}
\DoxyCodeLine{00159               std::max(a.x -\/ segm.x, 0);  \textcolor{comment}{//  clipping x + riflessione + ritorno}}
\DoxyCodeLine{00160           xMax =}
\DoxyCodeLine{00161               std::min(a.x -\/ segm.x, lx -\/ 1);  \textcolor{comment}{//  alle  coordinate "{}di schermo"{}}}
\DoxyCodeLine{00162         \}}
\DoxyCodeLine{00163 }
\DoxyCodeLine{00164         TPixel32 *p = ras-\/>pixels(segm.y + a.y) + xMin;}
\DoxyCodeLine{00165         TPixel32 *q = p + (xMax -\/ xMin);}
\DoxyCodeLine{00166 }
\DoxyCodeLine{00167         \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00168 }
\DoxyCodeLine{00169         \textcolor{keywordflow}{if} (dSegm <= 0)  \textcolor{comment}{//  NordEst}}
\DoxyCodeLine{00170         \{}
\DoxyCodeLine{00171           dSegm = dSegm + incNE;}
\DoxyCodeLine{00172           segm.x++;}
\DoxyCodeLine{00173         \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  Nord}}
\DoxyCodeLine{00174         \{}
\DoxyCodeLine{00175           dSegm = dSegm + incN;}
\DoxyCodeLine{00176         \}}
\DoxyCodeLine{00177         segm.y++;}
\DoxyCodeLine{00178       \}}
\DoxyCodeLine{00179     \}}
\DoxyCodeLine{00180     ras-\/>unlock();}
\DoxyCodeLine{00181     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00182   \}}
\DoxyCodeLine{00183 }
\DoxyCodeLine{00184   \mbox{\hyperlink{class_half_cord}{HalfCord}} halfCord(radius);}
\DoxyCodeLine{00185 }
\DoxyCodeLine{00186   \textcolor{keywordtype}{int} x, y;}
\DoxyCodeLine{00187 }
\DoxyCodeLine{00188   \textcolor{comment}{// -\/-\/-\/-\/-\/ punti iniziali coincidenti: disegna un cerchio}}
\DoxyCodeLine{00189   \textcolor{keywordflow}{if} (a == b) \{}
\DoxyCodeLine{00190     \textcolor{keywordtype}{int} yMin = std::max(a.y -\/ radius, 0);       \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00191     \textcolor{keywordtype}{int} yMax = std::min(a.y + radius, ly -\/ 1);  \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00192     \textcolor{keywordflow}{for} (y = yMin; y <= yMax; y++) \{}
\DoxyCodeLine{00193       \textcolor{keywordtype}{int} deltay = abs(y -\/ a.y);}
\DoxyCodeLine{00194       \textcolor{keywordtype}{int} xMin   = std::max(a.x -\/ halfCord.getCord(deltay), 0);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00195       \textcolor{keywordtype}{int} xMax =}
\DoxyCodeLine{00196           std::min(a.x + halfCord.getCord(deltay), lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00197       TPixel32 *p         = ras-\/>pixels(y) + xMin;}
\DoxyCodeLine{00198       TPixel32 *q         = p + (xMax -\/ xMin);}
\DoxyCodeLine{00199       \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00200     \}}
\DoxyCodeLine{00201     ras-\/>unlock();}
\DoxyCodeLine{00202     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00203   \}}
\DoxyCodeLine{00204 }
\DoxyCodeLine{00205   \textcolor{comment}{// -\/-\/-\/-\/-\/  rettangolo orizzontale (a.y = b.y, a.x != b.x)}}
\DoxyCodeLine{00206   \textcolor{keywordflow}{if} (a.y == b.y) \{}
\DoxyCodeLine{00207     \textcolor{keywordtype}{int} yMin   = std::max((a.y -\/ radius), 0);       \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00208     \textcolor{keywordtype}{int} yMax   = std::min((a.y + radius), ly -\/ 1);  \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00209     \textcolor{keywordtype}{int} xLeft  = std::min(a.x, b.x);}
\DoxyCodeLine{00210     \textcolor{keywordtype}{int} xRight = std::max(a.x, b.x);}
\DoxyCodeLine{00211     \textcolor{keywordflow}{for} (y = yMin; y <= yMax; y++) \{}
\DoxyCodeLine{00212       \textcolor{keywordtype}{int} deltay = abs(y -\/ a.y);}
\DoxyCodeLine{00213       \textcolor{keywordtype}{int} xMin = std::max(xLeft -\/ halfCord.getCord(deltay), 0);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00214       \textcolor{keywordtype}{int} xMax =}
\DoxyCodeLine{00215           std::min(xRight + halfCord.getCord(deltay), lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00216       TPixel32 *p         = ras-\/>pixels(y) + xMin;}
\DoxyCodeLine{00217       TPixel32 *q         = p + (xMax -\/ xMin);}
\DoxyCodeLine{00218       \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00219     \}}
\DoxyCodeLine{00220     ras-\/>unlock();}
\DoxyCodeLine{00221     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00222   \}}
\DoxyCodeLine{00223 }
\DoxyCodeLine{00224   \textcolor{comment}{// -\/-\/-\/-\/-\/  rettangolo verticale (a.x = b.x, a.y != b.y)}}
\DoxyCodeLine{00225   \textcolor{keywordflow}{if} (a.x == b.x) \{}
\DoxyCodeLine{00226     \textcolor{keywordtype}{int} xMin = std::max(a.x -\/ radius, 0);       \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00227     \textcolor{keywordtype}{int} xMax = std::min(a.x + radius, lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00228     \textcolor{keywordflow}{for} (x = xMin; x <= xMax; x++) \{}
\DoxyCodeLine{00229       \textcolor{keywordtype}{int} deltax = abs(x -\/ a.x);}
\DoxyCodeLine{00230       \textcolor{keywordtype}{int} yMin   = std::max(a.y -\/ halfCord.getCord(deltax), 0);  \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00231       \textcolor{keywordtype}{int} yMax =}
\DoxyCodeLine{00232           std::min(b.y + halfCord.getCord(deltax), ly -\/ 1);  \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00233       \textcolor{keywordflow}{if} (yMin <= yMax) \{}
\DoxyCodeLine{00234         TPixel32 *p = ras-\/>pixels(yMin) + x;}
\DoxyCodeLine{00235         TPixel32 *q = ras-\/>pixels(yMax) + x;}
\DoxyCodeLine{00236         \textcolor{keywordtype}{int} wrap    = ras-\/>getWrap();}
\DoxyCodeLine{00237         \textcolor{keywordflow}{while} (p <= q) \{}
\DoxyCodeLine{00238           *p = col;}
\DoxyCodeLine{00239           p += wrap;}
\DoxyCodeLine{00240         \}}
\DoxyCodeLine{00241       \}}
\DoxyCodeLine{00242     \}}
\DoxyCodeLine{00243     ras-\/>unlock();}
\DoxyCodeLine{00244     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00245   \}}
\DoxyCodeLine{00246 }
\DoxyCodeLine{00247   \textcolor{comment}{// -\/-\/-\/-\/-\/  rettangolo inclinato}}
\DoxyCodeLine{00248   \textcolor{comment}{//    k = +1/-\/1 se il rettangolo e' inclinato positivamente/negativamente}}
\DoxyCodeLine{00249   \textcolor{keywordtype}{int} k  = 1;}
\DoxyCodeLine{00250   \textcolor{keywordtype}{int} dx = b.x -\/ a.x;}
\DoxyCodeLine{00251   \textcolor{keywordflow}{if} (dx < 0) \{}
\DoxyCodeLine{00252     dx = -\/dx;}
\DoxyCodeLine{00253     k  = -\/1;}
\DoxyCodeLine{00254   \}}
\DoxyCodeLine{00255   \textcolor{keywordtype}{int} dy = b.y -\/ a.y;}
\DoxyCodeLine{00256 }
\DoxyCodeLine{00257   assert(dx > 0);}
\DoxyCodeLine{00258   assert(dy > 0);}
\DoxyCodeLine{00259 }
\DoxyCodeLine{00260   \textcolor{keywordtype}{double} length  = sqrt((\textcolor{keywordtype}{double})(dx * dx + dy * dy));}
\DoxyCodeLine{00261   \textcolor{keyword}{const} \textcolor{keywordtype}{double} m = dy / (double)dx;}
\DoxyCodeLine{00262 }
\DoxyCodeLine{00263   \textcolor{comment}{// punto di tangenza superiore nel sistema di riferimento del cerchio}}
\DoxyCodeLine{00264   \mbox{\hyperlink{class_t_point_t}{TPointD}} up(-\/radius * dy / length, radius * dx / length);}
\DoxyCodeLine{00265 }
\DoxyCodeLine{00266   \textcolor{comment}{// semi-\/ampiezza orizzontale delle "{}calotte"{} circolari}}
\DoxyCodeLine{00267   \textcolor{keywordtype}{int} halfAmplCap = tfloor(-\/up.x);}
\DoxyCodeLine{00268 }
\DoxyCodeLine{00269   \textcolor{comment}{//  A meno di intersezioni relative tra le diverse zone:}}
\DoxyCodeLine{00270 }
\DoxyCodeLine{00271   \textcolor{comment}{//  le scanline della "{}calotta"{} circolare superiore sono}}
\DoxyCodeLine{00272   \textcolor{comment}{//  (b.y+cutExt,b.y+radius]}}
\DoxyCodeLine{00273   \textcolor{comment}{//  le scanline del trapezoide circolare superiore sono [b.y-\/cutIn,b.y+cutExt]}}
\DoxyCodeLine{00274   \textcolor{comment}{//  le scanline del parallelogramma sono (a.y+cutIn,b.y-\/cutIn)}}
\DoxyCodeLine{00275   \textcolor{comment}{//  le scanline del trapezoide circolare inferiore sono [a.y-\/cutExt,a.y+cutIn]}}
\DoxyCodeLine{00276   \textcolor{comment}{//  le scanline della "{}calotta"{} circolare inferiore sono}}
\DoxyCodeLine{00277   \textcolor{comment}{//  [a.y-\/radius,a.y-\/cutExt)}}
\DoxyCodeLine{00278   \textcolor{keywordtype}{int} cutExt, cutIn;}
\DoxyCodeLine{00279 }
\DoxyCodeLine{00280   \textcolor{comment}{// vertici del parallelogramma}}
\DoxyCodeLine{00281   \mbox{\hyperlink{class_t_point_t}{TPointD}} rightUp;}
\DoxyCodeLine{00282   \mbox{\hyperlink{class_t_point_t}{TPointD}} rightDown;}
\DoxyCodeLine{00283   \mbox{\hyperlink{class_t_point_t}{TPointD}} leftUp;}
\DoxyCodeLine{00284   \mbox{\hyperlink{class_t_point_t}{TPointD}} leftDown;}
\DoxyCodeLine{00285   \textcolor{keywordtype}{double} mParall;  \textcolor{comment}{// coeff. angolare parallelogramma}}
\DoxyCodeLine{00286 }
\DoxyCodeLine{00287   \textcolor{comment}{//  NOTA BENE:  halfAmplCap=0 <=> (radius=0 (caso a parte) , 1)}}
\DoxyCodeLine{00288   \textcolor{keywordflow}{if} (radius > 1) \{}
\DoxyCodeLine{00289     \textcolor{keywordflow}{for} (cutExt = radius;}
\DoxyCodeLine{00290          cutExt >= 0 \&\& halfCord.getCord(cutExt) <= halfAmplCap; cutExt-\/-\/)}
\DoxyCodeLine{00291       ;}
\DoxyCodeLine{00292     cutIn       = cutExt;  \textcolor{comment}{//  vedi else successivo}}
\DoxyCodeLine{00293     rightUp.x   = dx + halfCord.getCord(cutIn);}
\DoxyCodeLine{00294     rightUp.y   = dy -\/ cutIn;}
\DoxyCodeLine{00295     rightDown.x = halfCord.getCord(cutIn);}
\DoxyCodeLine{00296     rightDown.y = -\/cutIn;}
\DoxyCodeLine{00297     leftUp.x    = dx -\/ halfCord.getCord(cutIn);}
\DoxyCodeLine{00298     leftUp.y    = dy + cutIn;}
\DoxyCodeLine{00299     leftDown.x  = -\/halfCord.getCord(cutIn);}
\DoxyCodeLine{00300     leftDown.y  = cutIn;}
\DoxyCodeLine{00301     mParall     = dy / (double)dx;}
\DoxyCodeLine{00302   \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  N.B. cutExt != cutIn solo quando radius=1}}
\DoxyCodeLine{00303   \{}
\DoxyCodeLine{00304     cutExt = radius;  \textcolor{comment}{//  radius=1 => halfAmplCap=0 (non ci sono mai le}}
\DoxyCodeLine{00305                       \textcolor{comment}{//  "{}calotte"{} circolari)}}
\DoxyCodeLine{00306     cutIn = 0;        \textcolor{comment}{//  anche per radius=1 il limite "{}interno"{} dei trapezoidi}}
\DoxyCodeLine{00307                       \textcolor{comment}{//  circolari e' < radius}}
\DoxyCodeLine{00308     rightUp.x   = dx -\/ up.x;}
\DoxyCodeLine{00309     rightUp.y   = dy -\/ up.y;}
\DoxyCodeLine{00310     rightDown.x = -\/up.x;}
\DoxyCodeLine{00311     rightDown.y = -\/up.y;}
\DoxyCodeLine{00312     leftUp.x    = dx + up.x;}
\DoxyCodeLine{00313     leftUp.y    = dy + up.y;}
\DoxyCodeLine{00314     leftDown.x  = up.x;}
\DoxyCodeLine{00315     leftDown.y  = up.y;}
\DoxyCodeLine{00316     mParall     = m;}
\DoxyCodeLine{00317   \}}
\DoxyCodeLine{00318   \textcolor{comment}{// -\/-\/-\/-\/-\/  riempie "{}calotte"{} circolari}}
\DoxyCodeLine{00319 }
\DoxyCodeLine{00320   \textcolor{comment}{// -\/-\/-\/-\/-\/  riempie "{}calotta"{} circolare inferiore}}
\DoxyCodeLine{00321   \textcolor{keywordtype}{int} yMin = std::max(a.y -\/ radius, 0);           \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00322   \textcolor{keywordtype}{int} yMax = std::min(a.y -\/ cutExt -\/ 1, ly -\/ 1);  \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00323   \textcolor{keywordflow}{for} (y = yMin; y <= yMax; y++) \{}
\DoxyCodeLine{00324     \textcolor{keywordtype}{int} r               = halfCord.getCord(a.y -\/ y);}
\DoxyCodeLine{00325     \textcolor{keywordtype}{int} xMin            = std::max(a.x -\/ r, 0);       \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00326     \textcolor{keywordtype}{int} xMax            = std::min(a.x + r, lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00327     TPixel32 *p         = ras-\/>pixels(y) + xMin;}
\DoxyCodeLine{00328     TPixel32 *q         = p + (xMax -\/ xMin);}
\DoxyCodeLine{00329     \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00330   \}}
\DoxyCodeLine{00331   \textcolor{comment}{// -\/-\/-\/-\/-\/  riempie "{}calotta"{} circolare superiore}}
\DoxyCodeLine{00332   yMin = std::max(b.y + cutExt + 1, 0);   \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00333   yMax = std::min(b.y + radius, ly -\/ 1);  \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00334   \textcolor{keywordflow}{for} (y = yMin; y <= yMax; y++) \{}
\DoxyCodeLine{00335     \textcolor{keywordtype}{int} r               = halfCord.getCord(y -\/ b.y);}
\DoxyCodeLine{00336     \textcolor{keywordtype}{int} xMin            = std::max(b.x -\/ r, 0);       \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00337     \textcolor{keywordtype}{int} xMax            = std::min(b.x + r, lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00338     TPixel32 *p         = ras-\/>pixels(y) + xMin;}
\DoxyCodeLine{00339     TPixel32 *q         = p + (xMax -\/ xMin);}
\DoxyCodeLine{00340     \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00341   \}}
\DoxyCodeLine{00342   \textcolor{comment}{// -\/-\/-\/-\/-\/  riempie trapezoidi}}
\DoxyCodeLine{00343 }
\DoxyCodeLine{00344   \textcolor{comment}{// (se k<0 viene fatta una riflessione sulle ascisse prima di tornare alle}}
\DoxyCodeLine{00345   \textcolor{comment}{// coordinate "{}di schermo"{})}}
\DoxyCodeLine{00346 }
\DoxyCodeLine{00347   \textcolor{comment}{//  limite destro assoluto delle scanline trapezoide:}}
\DoxyCodeLine{00348   \textcolor{keywordtype}{int} xSegmMax = tround(dx -\/ up.x);  \textcolor{comment}{//  coordinata x del punto di tangenza}}
\DoxyCodeLine{00349                                      \textcolor{comment}{//  inferiore sul cerchio superiore}}
\DoxyCodeLine{00350 }
\DoxyCodeLine{00351   \textcolor{comment}{//  limite sinistro assoluto delle scanline:}}
\DoxyCodeLine{00352   \textcolor{keywordtype}{int} xSegmMin = tround(up.x);  \textcolor{comment}{//  coordinata x del punto di tangenza superiore}}
\DoxyCodeLine{00353                                 \textcolor{comment}{//  sul cerchio inferiore}}
\DoxyCodeLine{00354 }
\DoxyCodeLine{00355   \textcolor{comment}{// -\/-\/-\/-\/-\/  riempie trapezoide inferiore}}
\DoxyCodeLine{00356 }
\DoxyCodeLine{00357   \textcolor{comment}{// N.B. le coordinate sono relative ad un sist. di rif. con l'origine sul}}
\DoxyCodeLine{00358   \textcolor{comment}{// centro}}
\DoxyCodeLine{00359   \textcolor{comment}{// del cerchio inferiore}}
\DoxyCodeLine{00360 }
\DoxyCodeLine{00361   yMin = std::max(a.y -\/ cutExt, 0) -\/ a.y;                         \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00362   yMax = std::min(\{a.y + cutIn, b.y -\/ cutIn -\/ 1, ly -\/ 1\}) -\/ a.y;  \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00363 }
\DoxyCodeLine{00364   \textcolor{comment}{// l'eq. della retta e' alpha * x + beta * y + gammaRight = 0}}
\DoxyCodeLine{00365   \textcolor{keyword}{const} \textcolor{keywordtype}{int} alpha = dy, beta = -\/dx;}
\DoxyCodeLine{00366   \textcolor{keyword}{const} \textcolor{keywordtype}{double} gammaRight = rightDown.y * dx -\/ rightDown.x * dy;}
\DoxyCodeLine{00367   \textcolor{keyword}{const} \textcolor{keywordtype}{int} incE          = alpha;}
\DoxyCodeLine{00368   \textcolor{keyword}{const} \textcolor{keywordtype}{int} incNE         = alpha + beta;}
\DoxyCodeLine{00369   \textcolor{keyword}{const} \textcolor{keywordtype}{int} incN          = beta;}
\DoxyCodeLine{00370 }
\DoxyCodeLine{00371   if (m <= 1) \{}
\DoxyCodeLine{00372     \textcolor{comment}{//  midpoint algorithm; le scanline vengono disegnate solo}}
\DoxyCodeLine{00373     \textcolor{comment}{//  sul NordEst. L'ultima scanline non viene disegnata}}
\DoxyCodeLine{00374     \mbox{\hyperlink{class_t_point_t}{TPoint}} segmRight(}
\DoxyCodeLine{00375         tceil((yMin + 0.5 -\/ rightDown.y) / mParall + rightDown.x) -\/ 1, yMin);}
\DoxyCodeLine{00376     \textcolor{keywordtype}{int} dSegmRight = tfloor(alpha * (segmRight.x + 1) +}
\DoxyCodeLine{00377                             beta * (segmRight.y + 0.5) + gammaRight);}
\DoxyCodeLine{00378     \textcolor{keywordflow}{while} (segmRight.y <= yMax) \{}
\DoxyCodeLine{00379       \textcolor{keywordflow}{if} (dSegmRight < 0)  \textcolor{comment}{//  Est}}
\DoxyCodeLine{00380       \{}
\DoxyCodeLine{00381         dSegmRight = dSegmRight + incE;}
\DoxyCodeLine{00382         segmRight.x++;}
\DoxyCodeLine{00383       \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  NordEst}}
\DoxyCodeLine{00384       \{}
\DoxyCodeLine{00385         \textcolor{keywordtype}{int} xMin, xMax;}
\DoxyCodeLine{00386         \textcolor{keywordflow}{if} (k > 0) \{}
\DoxyCodeLine{00387           xMin = std::max(a.x -\/ halfCord.getCord(abs(segmRight.y)),}
\DoxyCodeLine{00388                           0);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00389           xMax = std::min(a.x + std::min(segmRight.x, xSegmMax),}
\DoxyCodeLine{00390                           lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00391         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00392           xMin = std::max(a.x -\/ std::min(segmRight.x, xSegmMax),}
\DoxyCodeLine{00393                           0);  \textcolor{comment}{//  clipping x + ritorno alle}}
\DoxyCodeLine{00394           xMax = std::min(a.x + halfCord.getCord(abs(segmRight.y)),}
\DoxyCodeLine{00395                           lx -\/ 1);  \textcolor{comment}{//   coordinate "{}di schermo"{}}}
\DoxyCodeLine{00396         \}}
\DoxyCodeLine{00397         TPixel32 *p         = ras-\/>pixels(segmRight.y + a.y) + xMin;}
\DoxyCodeLine{00398         TPixel32 *q         = p + (xMax -\/ xMin);}
\DoxyCodeLine{00399         \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00400 }
\DoxyCodeLine{00401         dSegmRight = dSegmRight + incNE;}
\DoxyCodeLine{00402         segmRight.x++;}
\DoxyCodeLine{00403         segmRight.y++;}
\DoxyCodeLine{00404       \}}
\DoxyCodeLine{00405     \}}
\DoxyCodeLine{00406   \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  m>1}}
\DoxyCodeLine{00407   \{}
\DoxyCodeLine{00408     \textcolor{comment}{//  midpoint algorithm; le scanline vengono disegnate sempre}}
\DoxyCodeLine{00409     \mbox{\hyperlink{class_t_point_t}{TPoint}} segmRight(tround((yMin -\/ rightDown.y) / mParall + rightDown.x),}
\DoxyCodeLine{00410                      yMin);}
\DoxyCodeLine{00411     \textcolor{keywordtype}{int} dSegmRight = tfloor(alpha * (segmRight.x + 0.5) +}
\DoxyCodeLine{00412                             beta * (segmRight.y + 1) + gammaRight);}
\DoxyCodeLine{00413     \textcolor{keywordflow}{while} (segmRight.y <= yMax) \{}
\DoxyCodeLine{00414       \textcolor{keywordtype}{int} xMin, xMax;}
\DoxyCodeLine{00415       \textcolor{keywordflow}{if} (k > 0) \{}
\DoxyCodeLine{00416         xMin = std::max(a.x -\/ halfCord.getCord(abs(segmRight.y)),}
\DoxyCodeLine{00417                         0);                          \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00418         xMax = std::min(a.x + segmRight.x, lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00419       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00420         xMin = std::max(a.x -\/ segmRight.x,}
\DoxyCodeLine{00421                         0);  \textcolor{comment}{//  clipping x + ritorno alle coordinate}}
\DoxyCodeLine{00422         xMax = std::min(a.x + halfCord.getCord(abs(segmRight.y)),}
\DoxyCodeLine{00423                         lx -\/ 1);  \textcolor{comment}{//  "{}di schermo"{}}}
\DoxyCodeLine{00424       \}}
\DoxyCodeLine{00425       TPixel32 *p         = ras-\/>pixels(segmRight.y + a.y) + xMin;}
\DoxyCodeLine{00426       TPixel32 *q         = p + (xMax -\/ xMin);}
\DoxyCodeLine{00427       \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00428 }
\DoxyCodeLine{00429       \textcolor{keywordflow}{if} (dSegmRight <= 0)  \textcolor{comment}{//  NordEst}}
\DoxyCodeLine{00430       \{}
\DoxyCodeLine{00431         dSegmRight = dSegmRight + incNE;}
\DoxyCodeLine{00432         segmRight.x++;}
\DoxyCodeLine{00433       \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  Nord}}
\DoxyCodeLine{00434       \{}
\DoxyCodeLine{00435         dSegmRight = dSegmRight + incN;}
\DoxyCodeLine{00436       \}}
\DoxyCodeLine{00437       segmRight.y++;}
\DoxyCodeLine{00438     \}}
\DoxyCodeLine{00439   \}}
\DoxyCodeLine{00440 }
\DoxyCodeLine{00441   \textcolor{comment}{// -\/-\/-\/-\/-\/  riempie trapezoide superiore}}
\DoxyCodeLine{00442 }
\DoxyCodeLine{00443   \textcolor{comment}{//  N.B. le coordinate sono relative ad un sist. di rif. con l'origine sul}}
\DoxyCodeLine{00444   \textcolor{comment}{//  centro}}
\DoxyCodeLine{00445   \textcolor{comment}{//  del cerchio superiore}}
\DoxyCodeLine{00446   yMin = std::max(\{b.y -\/ cutIn, a.y + cutIn + 1, 0\}) -\/ b.y;  \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00447   yMax = std::min(b.y + cutExt, ly -\/ 1) -\/ b.y;               \textcolor{comment}{//  clipping y}}
\DoxyCodeLine{00448 }
\DoxyCodeLine{00449   \textcolor{comment}{//   l'eq. della retta e' alpha * x + beta * y + gammaLeft = 0}}
\DoxyCodeLine{00450   \textcolor{keyword}{const} \textcolor{keywordtype}{double} gammaLeft = leftDown.y * dx -\/ leftDown.x * dy;}
\DoxyCodeLine{00451 }
\DoxyCodeLine{00452   \textcolor{keywordflow}{if} (m <= 1) \{}
\DoxyCodeLine{00453     \textcolor{comment}{//  midpoint algorithm; le scanline vengono disegnate solo}}
\DoxyCodeLine{00454     \textcolor{comment}{//  sul NordEst. L'ultima scanline non viene disegnata}}
\DoxyCodeLine{00455     \mbox{\hyperlink{class_t_point_t}{TPoint}} segmLeft(tceil((yMin -\/ 0.5 -\/ leftDown.y) / mParall + leftDown.x),}
\DoxyCodeLine{00456                     yMin);}
\DoxyCodeLine{00457     \textcolor{keywordtype}{int} dSegmLeft = tfloor(alpha * (segmLeft.x + 1) +}
\DoxyCodeLine{00458                            beta * (segmLeft.y + 0.5) + gammaLeft);}
\DoxyCodeLine{00459     \textcolor{keywordflow}{while} (segmLeft.y <= yMax) \{}
\DoxyCodeLine{00460       \textcolor{keywordtype}{int} xMin, xMax;}
\DoxyCodeLine{00461       \textcolor{keywordflow}{if} (k > 0) \{}
\DoxyCodeLine{00462         xMin = std::max(b.x + std::max(segmLeft.x, xSegmMin -\/ dx),}
\DoxyCodeLine{00463                         0);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00464         xMax = std::min(b.x + halfCord.getCord(abs(segmLeft.y)),}
\DoxyCodeLine{00465                         lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00466       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00467         xMin = std::max(b.x -\/ halfCord.getCord(abs(segmLeft.y)),}
\DoxyCodeLine{00468                         0);  \textcolor{comment}{//  clipping x + ritorno alle}}
\DoxyCodeLine{00469         xMax = std::min(b.x -\/ std::max(segmLeft.x, xSegmMin -\/ dx),}
\DoxyCodeLine{00470                         lx -\/ 1);  \textcolor{comment}{//   coordinate "{}di schermo"{}}}
\DoxyCodeLine{00471       \}}
\DoxyCodeLine{00472       TPixel32 *p = ras-\/>pixels(segmLeft.y + b.y) + xMin;}
\DoxyCodeLine{00473       TPixel32 *q = p + (xMax -\/ xMin);}
\DoxyCodeLine{00474 }
\DoxyCodeLine{00475       \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00476       \textcolor{keywordflow}{while} (dSegmLeft < 0) \{}
\DoxyCodeLine{00477         dSegmLeft = dSegmLeft + incE;}
\DoxyCodeLine{00478         segmLeft.x++;}
\DoxyCodeLine{00479       \}}
\DoxyCodeLine{00480       dSegmLeft = dSegmLeft + incNE;}
\DoxyCodeLine{00481       segmLeft.x++;}
\DoxyCodeLine{00482       segmLeft.y++;}
\DoxyCodeLine{00483     \}}
\DoxyCodeLine{00484   \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  m>1}}
\DoxyCodeLine{00485   \{}
\DoxyCodeLine{00486     \textcolor{comment}{//  midpoint algorithm; le scanline vengono disegnate sempre}}
\DoxyCodeLine{00487     \mbox{\hyperlink{class_t_point_t}{TPoint}} segmLeft(tround((yMin -\/ leftDown.y) / mParall + leftDown.x), yMin);}
\DoxyCodeLine{00488     \textcolor{keywordtype}{int} dSegmLeft = tfloor(alpha * (segmLeft.x + 0.5) +}
\DoxyCodeLine{00489                            beta * (segmLeft.y + 1) + gammaLeft);}
\DoxyCodeLine{00490     \textcolor{keywordflow}{while} (segmLeft.y <= yMax) \{}
\DoxyCodeLine{00491       \textcolor{keywordtype}{int} xMin, xMax;}
\DoxyCodeLine{00492       \textcolor{keywordflow}{if} (k > 0) \{}
\DoxyCodeLine{00493         xMin = std::max(b.x + segmLeft.x, 0);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00494         xMax = std::min(b.x + halfCord.getCord(abs(segmLeft.y)),}
\DoxyCodeLine{00495                         lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00496       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00497         xMin = std::max(b.x -\/ halfCord.getCord(abs(segmLeft.y)),}
\DoxyCodeLine{00498                         0);  \textcolor{comment}{//  clipping x + ritorno alle}}
\DoxyCodeLine{00499         xMax = std::min(b.x -\/ segmLeft.x, lx -\/ 1);  \textcolor{comment}{//   coordinate "{}di schermo"{}}}
\DoxyCodeLine{00500       \}}
\DoxyCodeLine{00501       TPixel32 *p = ras-\/>pixels(segmLeft.y + b.y) + xMin;}
\DoxyCodeLine{00502       TPixel32 *q = p + (xMax -\/ xMin);}
\DoxyCodeLine{00503 }
\DoxyCodeLine{00504       \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00505 }
\DoxyCodeLine{00506       \textcolor{keywordflow}{if} (dSegmLeft <= 0)  \textcolor{comment}{//  NordEst}}
\DoxyCodeLine{00507       \{}
\DoxyCodeLine{00508         dSegmLeft = dSegmLeft + incNE;}
\DoxyCodeLine{00509         segmLeft.x++;}
\DoxyCodeLine{00510       \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  Nord}}
\DoxyCodeLine{00511       \{}
\DoxyCodeLine{00512         dSegmLeft = dSegmLeft + incN;}
\DoxyCodeLine{00513       \}}
\DoxyCodeLine{00514       segmLeft.y++;}
\DoxyCodeLine{00515     \}}
\DoxyCodeLine{00516   \}}
\DoxyCodeLine{00517 }
\DoxyCodeLine{00518   \textcolor{comment}{// -\/-\/-\/-\/-\/  parallelogramma (in alternativa a "{}parallelogrammoide circolare"{})}}
\DoxyCodeLine{00519 }
\DoxyCodeLine{00520   \textcolor{comment}{// N.B. le coordinate sono relative ad un sist. di rif. con l'origine sul}}
\DoxyCodeLine{00521   \textcolor{comment}{// centro}}
\DoxyCodeLine{00522   \textcolor{comment}{// del cerchio inferiore}}
\DoxyCodeLine{00523 }
\DoxyCodeLine{00524   \textcolor{comment}{//  retta destra di equaz.   alpha * x + beta * y + gammaRight = 0}}
\DoxyCodeLine{00525   \textcolor{comment}{//  retta sinistra di equaz. alpha * x + beta * y + gammaLeft = 0}}
\DoxyCodeLine{00526 }
\DoxyCodeLine{00527   yMin = std::max(a.y + cutIn + 1, 0) -\/ a.y;       \textcolor{comment}{// clipping y}}
\DoxyCodeLine{00528   yMax = std::min(b.y -\/ cutIn -\/ 1, ly -\/ 1) -\/ a.y;  \textcolor{comment}{// clipping y}}
\DoxyCodeLine{00529   \textcolor{keywordflow}{if} (m <= 1) \{}
\DoxyCodeLine{00530     \textcolor{comment}{//  midpoint algorithm; le scanline vengono disegnate solo}}
\DoxyCodeLine{00531     \textcolor{comment}{//  sul NordEst. L'ultima scanline non viene disegnata}}
\DoxyCodeLine{00532     \mbox{\hyperlink{class_t_point_t}{TPoint}} segmRight(}
\DoxyCodeLine{00533         tceil((yMin + 0.5 -\/ rightDown.y) / mParall + rightDown.x) -\/ 1, yMin);}
\DoxyCodeLine{00534     \mbox{\hyperlink{class_t_point_t}{TPoint}} segmLeft =}
\DoxyCodeLine{00535         \mbox{\hyperlink{class_t_point_t}{TPoint}}(tceil((yMin -\/ 0.5 -\/ leftDown.y) / mParall + leftDown.x), yMin);}
\DoxyCodeLine{00536     \textcolor{keywordtype}{int} dSegmRight = tfloor(alpha * (segmRight.x + 1) +}
\DoxyCodeLine{00537                             beta * (segmRight.y + 0.5) + gammaRight);}
\DoxyCodeLine{00538     \textcolor{keywordtype}{int} dSegmLeft = tfloor(alpha * (segmLeft.x + 1) +}
\DoxyCodeLine{00539                            beta * (segmLeft.y + 0.5) + gammaLeft);}
\DoxyCodeLine{00540     \textcolor{keywordflow}{while} (segmRight.y <= yMax) \{}
\DoxyCodeLine{00541       \textcolor{keywordflow}{if} (dSegmRight < 0)  \textcolor{comment}{//  segmRight a Est}}
\DoxyCodeLine{00542       \{}
\DoxyCodeLine{00543         dSegmRight = dSegmRight + incE;}
\DoxyCodeLine{00544         segmRight.x++;}
\DoxyCodeLine{00545       \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  segmRight a NordEst}}
\DoxyCodeLine{00546       \{}
\DoxyCodeLine{00547         \textcolor{keywordtype}{int} xMin, xMax;}
\DoxyCodeLine{00548         \textcolor{keywordflow}{if} (k > 0) \{}
\DoxyCodeLine{00549           xMin =}
\DoxyCodeLine{00550               std::max(a.x + std::max(segmLeft.x, xSegmMin), 0);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00551           xMax = std::min(a.x + std::min(segmRight.x, xSegmMax),}
\DoxyCodeLine{00552                           lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00553         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00554           xMin = std::max(a.x -\/ std::min(segmRight.x, xSegmMax),}
\DoxyCodeLine{00555                           0);  \textcolor{comment}{//  clipping x + ritorno alle}}
\DoxyCodeLine{00556           xMax = std::min(a.x -\/ std::max(segmLeft.x, xSegmMin),}
\DoxyCodeLine{00557                           lx -\/ 1);  \textcolor{comment}{//   coordinate "{}di schermo"{}}}
\DoxyCodeLine{00558         \}}
\DoxyCodeLine{00559 }
\DoxyCodeLine{00560         TPixel32 *p = ras-\/>pixels(segmRight.y + a.y) + xMin;}
\DoxyCodeLine{00561         TPixel32 *q = p + (xMax -\/ xMin);}
\DoxyCodeLine{00562 }
\DoxyCodeLine{00563         \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00564 }
\DoxyCodeLine{00565         dSegmRight = dSegmRight + incNE;}
\DoxyCodeLine{00566         segmRight.x++;}
\DoxyCodeLine{00567         segmRight.y++;}
\DoxyCodeLine{00568 }
\DoxyCodeLine{00569         \textcolor{keywordflow}{while} (dSegmLeft < 0)  \textcolor{comment}{//  segmLeft a Est}}
\DoxyCodeLine{00570         \{}
\DoxyCodeLine{00571           dSegmLeft = dSegmLeft + incE;}
\DoxyCodeLine{00572           segmLeft.x++;}
\DoxyCodeLine{00573         \}}
\DoxyCodeLine{00574         \textcolor{comment}{//  segmLeft a NordEst}}
\DoxyCodeLine{00575         dSegmLeft = dSegmLeft + incNE;}
\DoxyCodeLine{00576         segmLeft.x++;}
\DoxyCodeLine{00577         segmLeft.y++;}
\DoxyCodeLine{00578       \}}
\DoxyCodeLine{00579     \}}
\DoxyCodeLine{00580   \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  m>1}}
\DoxyCodeLine{00581   \{}
\DoxyCodeLine{00582     \textcolor{comment}{//  midpoint algorithm; le scanline vengono disegnate sempre}}
\DoxyCodeLine{00583     \mbox{\hyperlink{class_t_point_t}{TPoint}} segmRight(tround((yMin -\/ rightDown.y) / mParall + rightDown.x),}
\DoxyCodeLine{00584                      yMin);}
\DoxyCodeLine{00585     \mbox{\hyperlink{class_t_point_t}{TPoint}} segmLeft(tround((yMin -\/ leftDown.y) / mParall + leftDown.x), yMin);}
\DoxyCodeLine{00586     \textcolor{keywordtype}{int} dSegmRight = tfloor(alpha * (segmRight.x + 0.5) +}
\DoxyCodeLine{00587                             beta * (segmRight.y + 1) + gammaRight);}
\DoxyCodeLine{00588     \textcolor{keywordtype}{int} dSegmLeft = tfloor(alpha * (segmLeft.x + 0.5) +}
\DoxyCodeLine{00589                            beta * (segmLeft.y + 1) + gammaLeft);}
\DoxyCodeLine{00590     \textcolor{keywordflow}{while} (segmRight.y <= yMax) \{}
\DoxyCodeLine{00591       \textcolor{keywordtype}{int} xMin, xMax;}
\DoxyCodeLine{00592       \textcolor{keywordflow}{if} (k > 0) \{}
\DoxyCodeLine{00593         xMin = std::max(a.x + segmLeft.x, 0);        \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00594         xMax = std::min(a.x + segmRight.x, lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00595       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00596         xMin = std::max(a.x -\/ segmRight.x, 0);  \textcolor{comment}{//  clipping x + ritorno alle}}
\DoxyCodeLine{00597         xMax = std::min(a.x -\/ segmLeft.x, lx -\/ 1);  \textcolor{comment}{//   coordinate "{}di schermo"{}}}
\DoxyCodeLine{00598       \}}
\DoxyCodeLine{00599 }
\DoxyCodeLine{00600       TPixel32 *p = ras-\/>pixels(segmRight.y + a.y) + xMin;}
\DoxyCodeLine{00601       TPixel32 *q = p + (xMax -\/ xMin);}
\DoxyCodeLine{00602 }
\DoxyCodeLine{00603       \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00604 }
\DoxyCodeLine{00605       \textcolor{keywordflow}{if} (dSegmRight <= 0)  \textcolor{comment}{//  segmRight a NordEst}}
\DoxyCodeLine{00606       \{}
\DoxyCodeLine{00607         dSegmRight = dSegmRight + incNE;}
\DoxyCodeLine{00608         segmRight.x++;}
\DoxyCodeLine{00609       \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  segmRight a Nord}}
\DoxyCodeLine{00610       \{}
\DoxyCodeLine{00611         dSegmRight = dSegmRight + incN;}
\DoxyCodeLine{00612       \}}
\DoxyCodeLine{00613       segmRight.y++;}
\DoxyCodeLine{00614 }
\DoxyCodeLine{00615       \textcolor{keywordflow}{if} (dSegmLeft <= 0)  \textcolor{comment}{//  segmLeft a NordEst}}
\DoxyCodeLine{00616       \{}
\DoxyCodeLine{00617         dSegmLeft = dSegmLeft + incNE;}
\DoxyCodeLine{00618         segmLeft.x++;}
\DoxyCodeLine{00619       \} \textcolor{keywordflow}{else}  \textcolor{comment}{//  segmLeft a Nord}}
\DoxyCodeLine{00620       \{}
\DoxyCodeLine{00621         dSegmLeft = dSegmLeft + incN;}
\DoxyCodeLine{00622       \}}
\DoxyCodeLine{00623     \}}
\DoxyCodeLine{00624   \}}
\DoxyCodeLine{00625 }
\DoxyCodeLine{00626   \textcolor{comment}{// -\/-\/-\/-\/  parallelogrammoide circolare (in alternativa a parallelogramma)}}
\DoxyCodeLine{00627 }
\DoxyCodeLine{00628   \textcolor{comment}{// N.B. coordinate di schermo (riflessione per k<0 )}}
\DoxyCodeLine{00629 }
\DoxyCodeLine{00630   yMin = std::max(b.y -\/ cutIn, 0);}
\DoxyCodeLine{00631   yMax = std::min(a.y + cutIn, ly -\/ 1);}
\DoxyCodeLine{00632   \textcolor{keywordflow}{for} (y = yMin; y <= yMax; y++) \{}
\DoxyCodeLine{00633     \textcolor{keywordtype}{int} xMin, xMax;}
\DoxyCodeLine{00634     \textcolor{keywordflow}{if} (k > 0) \{}
\DoxyCodeLine{00635       xMin = std::max(a.x -\/ halfCord.getCord(abs(y -\/ a.y)), 0);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00636       xMax = std::min(b.x + halfCord.getCord(abs(b.y -\/ y)),}
\DoxyCodeLine{00637                       lx -\/ 1);  \textcolor{comment}{//  clipping x}}
\DoxyCodeLine{00638     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00639       xMin = std::max(b.x -\/ halfCord.getCord(abs(b.y -\/ y)),}
\DoxyCodeLine{00640                       0);  \textcolor{comment}{//  clipping x + ritorno alle}}
\DoxyCodeLine{00641       xMax = std::min(a.x + halfCord.getCord(abs(y -\/ a.y)),}
\DoxyCodeLine{00642                       lx -\/ 1);  \textcolor{comment}{//   coordinate "{}di schermo"{}}}
\DoxyCodeLine{00643     \}}
\DoxyCodeLine{00644     TPixel32 *p         = ras-\/>pixels(y) + xMin;}
\DoxyCodeLine{00645     TPixel32 *q         = p + (xMax -\/ xMin);}
\DoxyCodeLine{00646     \textcolor{keywordflow}{while} (p <= q) *p++ = col;}
\DoxyCodeLine{00647   \}}
\DoxyCodeLine{00648   ras-\/>unlock();}
\DoxyCodeLine{00649 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_aaea09eab581fd066c34b2b2ecec92f41}\label{namespace_t_rop_aaea09eab581fd066c34b2b2ecec92f41}} 
\index{TRop@{TRop}!checkBoard@{checkBoard}}
\index{checkBoard@{checkBoard}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{checkBoard()}{checkBoard()}}
{\footnotesize\ttfamily void TRop\+::check\+Board (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{const TPixel32 \&}]{pix1,  }\item[{const TPixel32 \&}]{pix2,  }\item[{const \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}} \&}]{dim,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{offset }\end{DoxyParamCaption})}



Make a checkoboard in {\bfseries{rout}}. 

Two variables {\bfseries{TPixel32}} describe the checkboard color, {\bfseries{TDimension}} are checkboard dimension and {\bfseries{TPoinD}} the position 
\begin{DoxyCodeInclude}{0}

\end{DoxyCodeInclude}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{00081                                                                      \{}
\DoxyCodeLine{00082   \textcolor{comment}{// assert(offset.x<=dim.lx \&\& offset.y<=dim.ly);}}
\DoxyCodeLine{00083 }
\DoxyCodeLine{00084   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout32 = rout;}
\DoxyCodeLine{00085   \textcolor{keywordflow}{if} (rout32)}
\DoxyCodeLine{00086     do\_checkBoard<TPixel32>(rout32, pix1, pix2, dim, offset);}
\DoxyCodeLine{00087   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00088     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rout64 = rout;}
\DoxyCodeLine{00089     \textcolor{keywordflow}{if} (rout64)}
\DoxyCodeLine{00090       do\_checkBoard<TPixel64>(rout64, toPixel64(pix1), toPixel64(pix2), dim,}
\DoxyCodeLine{00091                               offset);}
\DoxyCodeLine{00092     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00093       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}unsupported pixel type"{}});}
\DoxyCodeLine{00094   \}}
\DoxyCodeLine{00095 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a224ebd85bbce4f5eb5085ecd79d5f76c}\label{namespace_t_rop_a224ebd85bbce4f5eb5085ecd79d5f76c}} 
\index{TRop@{TRop}!colorburn@{colorburn}}
\index{colorburn@{colorburn}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{colorburn()}{colorburn()}}
{\footnotesize\ttfamily void TRop\+::colorburn (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00302                                            \{}
\DoxyCodeLine{00303   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{00304   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{00305   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{00306   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{00307     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{00308     \textcolor{comment}{//  downPix-\/>r=0;}}
\DoxyCodeLine{00309     \textcolor{comment}{//  downPix-\/>g=255;}}
\DoxyCodeLine{00310     \textcolor{comment}{//  downPix-\/>b=0;}}
\DoxyCodeLine{00311     \textcolor{keywordtype}{double} r, g, b;}
\DoxyCodeLine{00312     \textcolor{keywordflow}{if} (upPix-\/>m) \{}
\DoxyCodeLine{00313       \textcolor{keywordflow}{if} (downPix-\/>r == 0 || downPix-\/>r == 255)}
\DoxyCodeLine{00314         r = downPix-\/>r;}
\DoxyCodeLine{00315       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (upPix-\/>r)}
\DoxyCodeLine{00316         r = 255 -\/ (((255 -\/ downPix-\/>r) << 8) / (double)upPix-\/>r);}
\DoxyCodeLine{00317       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00318         r = 0;}
\DoxyCodeLine{00319       \textcolor{keywordflow}{if} (downPix-\/>g == 0 || downPix-\/>g == 255)}
\DoxyCodeLine{00320         g = downPix-\/>g;}
\DoxyCodeLine{00321       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (upPix-\/>g)}
\DoxyCodeLine{00322         g = 255 -\/ (((255 -\/ downPix-\/>g) << 8) / (double)upPix-\/>g);}
\DoxyCodeLine{00323       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00324         g = 0;}
\DoxyCodeLine{00325       \textcolor{keywordflow}{if} (downPix-\/>b == 0 || downPix-\/>b == 255)}
\DoxyCodeLine{00326         b = downPix-\/>b;}
\DoxyCodeLine{00327       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (upPix-\/>b)}
\DoxyCodeLine{00328         b = 255 -\/ (((255 -\/ downPix-\/>b) << 8) / (double)upPix-\/>b);}
\DoxyCodeLine{00329       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00330         b = 0;}
\DoxyCodeLine{00331 }
\DoxyCodeLine{00332       \textcolor{keywordflow}{if} (upPix-\/>m != 255) \{}
\DoxyCodeLine{00333         TPixel32 tmpPix;}
\DoxyCodeLine{00334         tmpPix.r = (UCHAR)tcrop<double>(r, .0, 255.0);}
\DoxyCodeLine{00335         tmpPix.g = (UCHAR)tcrop<double>(g, .0, 255.0);}
\DoxyCodeLine{00336         tmpPix.b = (UCHAR)tcrop<double>(b, .0, 255.0);}
\DoxyCodeLine{00337         tmpPix.m = upPix-\/>m;}
\DoxyCodeLine{00338         ;}
\DoxyCodeLine{00339         overPix<TPixel32, UCHAR>(*outPix, *downPix, tmpPix);}
\DoxyCodeLine{00340       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00341         outPix-\/>r = (UCHAR)tcrop<double>(r, .0, 255.0);}
\DoxyCodeLine{00342         outPix-\/>g = (UCHAR)tcrop<double>(g, .0, 255.0);}
\DoxyCodeLine{00343         outPix-\/>b = (UCHAR)tcrop<double>(b, .0, 255.0);}
\DoxyCodeLine{00344         outPix-\/>m = downPix-\/>m;}
\DoxyCodeLine{00345       \}}
\DoxyCodeLine{00346     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00347       outPix = downPix;}
\DoxyCodeLine{00348     \}}
\DoxyCodeLine{00349     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{00350   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00351     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{00352     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{00353     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{00354 }
\DoxyCodeLine{00355     \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{00356       FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{00357       \textcolor{keywordtype}{double} r, g, b;}
\DoxyCodeLine{00358       \textcolor{keywordflow}{if} (upPix-\/>m) \{}
\DoxyCodeLine{00359         \textcolor{keywordflow}{if} (downPix-\/>r == 0 || downPix-\/>r == 65535)}
\DoxyCodeLine{00360           r = downPix-\/>r;}
\DoxyCodeLine{00361         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (upPix-\/>r)}
\DoxyCodeLine{00362           r = 65535 -\/ 65536 * ((65535.0 -\/ downPix-\/>r) / (\textcolor{keywordtype}{double})upPix-\/>r);}
\DoxyCodeLine{00363         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00364           r = 0;}
\DoxyCodeLine{00365         \textcolor{keywordflow}{if} (downPix-\/>g == 0 || downPix-\/>g == 65535)}
\DoxyCodeLine{00366           g = downPix-\/>g;}
\DoxyCodeLine{00367         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (upPix-\/>g)}
\DoxyCodeLine{00368           g = 65535 -\/ 65536 * ((65535.0 -\/ downPix-\/>g) / (\textcolor{keywordtype}{double})upPix-\/>g);}
\DoxyCodeLine{00369         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00370           g = 0;}
\DoxyCodeLine{00371         \textcolor{keywordflow}{if} (downPix-\/>b == 0 || downPix-\/>b == 65535)}
\DoxyCodeLine{00372           b = downPix-\/>b;}
\DoxyCodeLine{00373         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (upPix-\/>b)}
\DoxyCodeLine{00374           b = 65535 -\/ 65536 * ((65535.0 -\/ downPix-\/>b) / (\textcolor{keywordtype}{double})upPix-\/>b);}
\DoxyCodeLine{00375         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00376           b = 0;}
\DoxyCodeLine{00377 }
\DoxyCodeLine{00378         \textcolor{keywordflow}{if} (upPix-\/>m != 65535) \{}
\DoxyCodeLine{00379           TPixel64 tmpPix;}
\DoxyCodeLine{00380           tmpPix.r = (USHORT)tcrop<double>(r, .0, 65535.0);}
\DoxyCodeLine{00381           tmpPix.g = (USHORT)tcrop<double>(g, .0, 65535.0);}
\DoxyCodeLine{00382           tmpPix.b = (USHORT)tcrop<double>(b, .0, 65535.0);}
\DoxyCodeLine{00383           tmpPix.m = upPix-\/>m;}
\DoxyCodeLine{00384           overPix<TPixel64, USHORT>(*outPix, *downPix, tmpPix);}
\DoxyCodeLine{00385         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00386           outPix-\/>r = (USHORT)tcrop<double>(r, .0, 65535.0);}
\DoxyCodeLine{00387           outPix-\/>g = (USHORT)tcrop<double>(g, .0, 65535.0);}
\DoxyCodeLine{00388           outPix-\/>b = (USHORT)tcrop<double>(b, .0, 65535.0);}
\DoxyCodeLine{00389           outPix-\/>m = downPix-\/>m;}
\DoxyCodeLine{00390         \}}
\DoxyCodeLine{00391       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00392         outPix = downPix;}
\DoxyCodeLine{00393       \}}
\DoxyCodeLine{00394       FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{00395     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00396       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::color burn invalid raster combination"{}});}
\DoxyCodeLine{00397   \}}
\DoxyCodeLine{00398 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a0809dd38dcd6506bcfbd7c07b17220e7}\label{namespace_t_rop_a0809dd38dcd6506bcfbd7c07b17220e7}} 
\index{TRop@{TRop}!colordodge@{colordodge}}
\index{colordodge@{colordodge}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{colordodge()}{colordodge()}}
{\footnotesize\ttfamily void TRop\+::colordodge (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00235                                             \{}
\DoxyCodeLine{00236   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{00237   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{00238   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{00239   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{00240     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{00241 }
\DoxyCodeLine{00242     USHORT r, g, b, m;}
\DoxyCodeLine{00243 }
\DoxyCodeLine{00244     r = (USHORT)((downPix-\/>r << 8) / (256.0 -\/ upPix-\/>r));}
\DoxyCodeLine{00245     g = (USHORT)((downPix-\/>g << 8) / (256.0 -\/ upPix-\/>g));}
\DoxyCodeLine{00246     b = (USHORT)((downPix-\/>b << 8) / (256.0 -\/ upPix-\/>b));}
\DoxyCodeLine{00247 }
\DoxyCodeLine{00248     m = downPix-\/>m + upPix-\/>m;}
\DoxyCodeLine{00249 }
\DoxyCodeLine{00250     outPix-\/>r = (UCHAR)tcrop<USHORT>(r, 0, 255);}
\DoxyCodeLine{00251     outPix-\/>g = (UCHAR)tcrop<USHORT>(g, 0, 255);}
\DoxyCodeLine{00252     outPix-\/>b = (UCHAR)tcrop<USHORT>(b, 0, 255);}
\DoxyCodeLine{00253     outPix-\/>m = (UCHAR)tcrop<USHORT>(m, 0, 255);}
\DoxyCodeLine{00254 }
\DoxyCodeLine{00255     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{00256   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00257     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{00258     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{00259     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{00260 }
\DoxyCodeLine{00261     \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{00262       FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{00263 }
\DoxyCodeLine{00264       TINT32 r, g, b, m;}
\DoxyCodeLine{00265       r = (TINT32)(65536.0 * (downPix-\/>r / (65536.0 -\/ upPix-\/>r)));}
\DoxyCodeLine{00266 }
\DoxyCodeLine{00267       g = (TINT32)(65536.0 * (downPix-\/>g / (65536.0 -\/ upPix-\/>g)));}
\DoxyCodeLine{00268 }
\DoxyCodeLine{00269       b = (TINT32)(65536.0 * (downPix-\/>b / (65536.0 -\/ upPix-\/>b)));}
\DoxyCodeLine{00270 }
\DoxyCodeLine{00271       m = downPix-\/>m + upPix-\/>m;}
\DoxyCodeLine{00272 }
\DoxyCodeLine{00273       outPix-\/>r = (USHORT)tcrop<TINT32>(r, 0, 0xffff);}
\DoxyCodeLine{00274       outPix-\/>g = (USHORT)tcrop<TINT32>(g, 0, 0xffff);}
\DoxyCodeLine{00275       outPix-\/>b = (USHORT)tcrop<TINT32>(b, 0, 0xffff);}
\DoxyCodeLine{00276       outPix-\/>m = (USHORT)tcrop<TINT32>(m, 0, 0xffff);}
\DoxyCodeLine{00277 }
\DoxyCodeLine{00278       FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{00279     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00280       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} up8   = rup;}
\DoxyCodeLine{00281       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} down8 = rdown;}
\DoxyCodeLine{00282       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} out8  = rout;}
\DoxyCodeLine{00283 }
\DoxyCodeLine{00284       \textcolor{keywordflow}{if} (up8 \&\& down8 \&\& out8) \{}
\DoxyCodeLine{00285         FOR\_EACH\_PIXEL\_8\_BEGIN\_LOOP}
\DoxyCodeLine{00286         USHORT value;}
\DoxyCodeLine{00287         \textcolor{keywordflow}{if} (downPix-\/>value)}
\DoxyCodeLine{00288           value = (USHORT)((downPix-\/>value << 8) / (255.0 -\/ upPix-\/>value));}
\DoxyCodeLine{00289 }
\DoxyCodeLine{00290         outPix-\/>value = (UCHAR)tcrop<USHORT>(value, 0, 255);}
\DoxyCodeLine{00291 }
\DoxyCodeLine{00292         FOR\_EACH\_PIXEL\_8\_END\_LOOP}
\DoxyCodeLine{00293       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00294         \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::color dodge invalid raster combination"{}});}
\DoxyCodeLine{00295     \}}
\DoxyCodeLine{00296   \}}
\DoxyCodeLine{00297 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a1dfdba06d4f71d86755d8e0833a7a071}\label{namespace_t_rop_a1dfdba06d4f71d86755d8e0833a7a071}} 
\index{TRop@{TRop}!computeBBox@{computeBBox}}
\index{computeBBox@{computeBBox}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{computeBBox()}{computeBBox()}}
{\footnotesize\ttfamily void TRop\+::compute\+BBox (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{ras,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRect}} \&}]{bbox }\end{DoxyParamCaption})}



Get {\bfseries{bbox}} of {\bfseries{ras}} raster. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00190                                                 \{}
\DoxyCodeLine{00191   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = ras;}
\DoxyCodeLine{00192   \textcolor{keywordflow}{if} (ras32) \{}
\DoxyCodeLine{00193     ::computeBBox<TPixel32, UCHAR>(ras32, bbox);}
\DoxyCodeLine{00194     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00195   \}}
\DoxyCodeLine{00196 }
\DoxyCodeLine{00197   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} ras64 = ras;}
\DoxyCodeLine{00198   \textcolor{keywordflow}{if} (ras64) \{}
\DoxyCodeLine{00199     ::computeBBox<TPixel64, USHORT>(ras64, bbox);}
\DoxyCodeLine{00200     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00201   \}}
\DoxyCodeLine{00202 }
\DoxyCodeLine{00203   \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} rasCM32 = ras;}
\DoxyCodeLine{00204   \textcolor{keywordflow}{if} (rasCM32) \{}
\DoxyCodeLine{00205     computeBBoxCM32(rasCM32, bbox);}
\DoxyCodeLine{00206     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00207   \}}
\DoxyCodeLine{00208 }
\DoxyCodeLine{00209   \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} ras8 = ras;}
\DoxyCodeLine{00210   \textcolor{keywordflow}{if} (ras8) \{}
\DoxyCodeLine{00211     bbox = ras-\/>getBounds();}
\DoxyCodeLine{00212     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00213   \}}
\DoxyCodeLine{00214   assert(0);}
\DoxyCodeLine{00215 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_ae62af9d021cc9d4428b4a996c2c40918}\label{namespace_t_rop_ae62af9d021cc9d4428b4a996c2c40918}} 
\index{TRop@{TRop}!convert@{convert}}
\index{convert@{convert}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{convert()}{convert()}\hspace{0.1cm}{\footnotesize\ttfamily [1/4]}}
{\footnotesize\ttfamily void TRop\+::convert (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \&}]{ras\+Out,  }\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&}]{ras\+In,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}}}]{palette,  }\item[{bool}]{transparency\+Check = {\ttfamily false} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00064                                                                     \{}
\DoxyCodeLine{00065   \textcolor{keywordtype}{int} count = palette-\/>getStyleCount();}
\DoxyCodeLine{00066   \textcolor{keywordtype}{int} count2 =}
\DoxyCodeLine{00067       std::max(\{count, TPixelCM32::getMaxInk(), TPixelCM32::getMaxPaint()\});}
\DoxyCodeLine{00068 }
\DoxyCodeLine{00069   \textcolor{comment}{// per poter utilizzare lo switch (piu' efficiente) si utilizza 255}}
\DoxyCodeLine{00070   \textcolor{comment}{// anziche' TPixelCM32::getMaxTone()}}
\DoxyCodeLine{00071   assert(TPixelCM32::getMaxTone() == 255);}
\DoxyCodeLine{00072 }
\DoxyCodeLine{00073   \textcolor{keywordtype}{int} rasLx = rasOut-\/>getLx();}
\DoxyCodeLine{00074   \textcolor{keywordtype}{int} rasLy = rasOut-\/>getLy();}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076   rasOut-\/>lock();}
\DoxyCodeLine{00077   rasIn-\/>lock();}
\DoxyCodeLine{00078 \textcolor{preprocessor}{\#ifdef USE\_SSE2}}
\DoxyCodeLine{00079   \textcolor{keywordflow}{if} (TSystem::getCPUExtensions() \& TSystem::CpuSupportsSse2) \{}
\DoxyCodeLine{00080     \_\_m128i zeros = \_mm\_setzero\_si128();}
\DoxyCodeLine{00081     TPixelFloat *paints =}
\DoxyCodeLine{00082         (TPixelFloat *)\_aligned\_malloc(count2 * \textcolor{keyword}{sizeof}(TPixelFloat), 16);}
\DoxyCodeLine{00083     TPixelFloat *inks =}
\DoxyCodeLine{00084         (TPixelFloat *)\_aligned\_malloc(count2 * \textcolor{keyword}{sizeof}(TPixelFloat), 16);}
\DoxyCodeLine{00085 }
\DoxyCodeLine{00086     std::vector<TPixel32> paints2(count2);}
\DoxyCodeLine{00087     std::vector<TPixel32> inks2(count2);}
\DoxyCodeLine{00088     \textcolor{keywordflow}{if} (transparencyCheck) \{}
\DoxyCodeLine{00089       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < palette-\/>getStyleCount(); i++) \{}
\DoxyCodeLine{00090         paints2[i] = c\_transparencyCheckPaint;}
\DoxyCodeLine{00091         inks2[i]   = c\_transparencyCheckInk;}
\DoxyCodeLine{00092         paints[i]  = TPixelFloat(paints2[i]);}
\DoxyCodeLine{00093         inks[i]    = TPixelFloat(inks2[i]);}
\DoxyCodeLine{00094       \}}
\DoxyCodeLine{00095       paints2[0] = TPixel32::Transparent;}
\DoxyCodeLine{00096       paints[0]  = TPixelFloat(TPixel32::Transparent);}
\DoxyCodeLine{00097     \}}
\DoxyCodeLine{00098     \textcolor{comment}{/*}}
\DoxyCodeLine{00099 \textcolor{comment}{else if (true)}}
\DoxyCodeLine{00100 \textcolor{comment}{\{}}
\DoxyCodeLine{00101 \textcolor{comment}{            for(int i=0;i<palette-\/>getStyleCount();i++)}}
\DoxyCodeLine{00102 \textcolor{comment}{\{}}
\DoxyCodeLine{00103 \textcolor{comment}{paints2[i] = c\_transparencyCheckPaint;}}
\DoxyCodeLine{00104 \textcolor{comment}{                    inks2[i]   = c\_transparencyCheckInk;}}
\DoxyCodeLine{00105 \textcolor{comment}{paints[i]  = TPixelFloat(paints2[i]);}}
\DoxyCodeLine{00106 \textcolor{comment}{                    inks[i]    = TPixelFloat(inks2[i]);}}
\DoxyCodeLine{00107 \textcolor{comment}{            paints2[i] = TPixel32::Transparent;}}
\DoxyCodeLine{00108 \textcolor{comment}{            paints[i] = TPixelFloat(TPixel32::Transparent);}}
\DoxyCodeLine{00109 \textcolor{comment}{\}}}
\DoxyCodeLine{00110 \textcolor{comment}{            paints2[0] = TPixel32::Transparent;}}
\DoxyCodeLine{00111 \textcolor{comment}{            paints[0] = TPixelFloat(TPixel32::Transparent);}}
\DoxyCodeLine{00112 \textcolor{comment}{\}}}
\DoxyCodeLine{00113 \textcolor{comment}{*/}}
\DoxyCodeLine{00114     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00115       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < palette-\/>getStyleCount(); i++) \{}
\DoxyCodeLine{00116         TPixel32 color = ::premultiply(palette-\/>getStyle(i)-\/>getAverageColor());}
\DoxyCodeLine{00117         paints[i] = inks[i] = TPixelFloat(color);}
\DoxyCodeLine{00118         paints2[i] = inks2[i] = color;}
\DoxyCodeLine{00119       \}}
\DoxyCodeLine{00120 }
\DoxyCodeLine{00121     \textcolor{keywordtype}{float} maxTone     = (float)TPixelCM32::getMaxTone();}
\DoxyCodeLine{00122     \_\_m128 den\_packed = \_mm\_load1\_ps(\&maxTone);}
\DoxyCodeLine{00123 }
\DoxyCodeLine{00124     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < rasLy; ++y) \{}
\DoxyCodeLine{00125       TPixel32 *pix32   = rasOut-\/>pixels(y);}
\DoxyCodeLine{00126       \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *pixIn = rasIn-\/>pixels(y);}
\DoxyCodeLine{00127 }
\DoxyCodeLine{00128       \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *endPixIn = pixIn + rasLx;}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130       \textcolor{keywordflow}{while} (pixIn < endPixIn) \{}
\DoxyCodeLine{00131         \textcolor{keywordtype}{int} tt = pixIn-\/>getTone();}
\DoxyCodeLine{00132         \textcolor{keywordtype}{int} p  = pixIn-\/>getPaint();}
\DoxyCodeLine{00133         \textcolor{keywordtype}{int} i  = pixIn-\/>getInk();}
\DoxyCodeLine{00134         \textcolor{keywordflow}{switch} (tt) \{}
\DoxyCodeLine{00135         \textcolor{keywordflow}{case} 255:}
\DoxyCodeLine{00136           *pix32++ = paints2[p];}
\DoxyCodeLine{00137           \textcolor{keywordflow}{break};}
\DoxyCodeLine{00138         \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{00139           *pix32++ = inks2[i];}
\DoxyCodeLine{00140           \textcolor{keywordflow}{break};}
\DoxyCodeLine{00141         \textcolor{keywordflow}{default}: \{}
\DoxyCodeLine{00142           \textcolor{keywordtype}{float} t         = (float)tt;}
\DoxyCodeLine{00143           \_\_m128 a\_packed = \_mm\_load\_ps((\textcolor{keywordtype}{float} *)\&(inks[i]));}
\DoxyCodeLine{00144           \_\_m128 b\_packed = \_mm\_load\_ps((\textcolor{keywordtype}{float} *)\&(paints[p]));}
\DoxyCodeLine{00145 }
\DoxyCodeLine{00146           \_\_m128 num\_packed  = \_mm\_load1\_ps(\&t);}
\DoxyCodeLine{00147           \_\_m128 diff\_packed = \_mm\_sub\_ps(den\_packed, num\_packed);}
\DoxyCodeLine{00148 }
\DoxyCodeLine{00149           \textcolor{comment}{// calcola in modo vettoriale out = ((den-\/num)*a + num*b)/den}}
\DoxyCodeLine{00150           \_\_m128 outPix\_packed = \_mm\_mul\_ps(diff\_packed, a\_packed);}
\DoxyCodeLine{00151           \_\_m128 tmpPix\_packed = \_mm\_mul\_ps(num\_packed, b\_packed);}
\DoxyCodeLine{00152 }
\DoxyCodeLine{00153           outPix\_packed = \_mm\_add\_ps(outPix\_packed, tmpPix\_packed);}
\DoxyCodeLine{00154           outPix\_packed = \_mm\_div\_ps(outPix\_packed, den\_packed);}
\DoxyCodeLine{00155 }
\DoxyCodeLine{00156           \textcolor{comment}{// converte i canali da float a char}}
\DoxyCodeLine{00157           \_\_m128i outPix\_packed\_i = \_mm\_cvtps\_epi32(outPix\_packed);}
\DoxyCodeLine{00158           outPix\_packed\_i         = \_mm\_packs\_epi32(outPix\_packed\_i, zeros);}
\DoxyCodeLine{00159           outPix\_packed\_i         = \_mm\_packus\_epi16(outPix\_packed\_i, zeros);}
\DoxyCodeLine{00160 }
\DoxyCodeLine{00161           *(DWORD *)(pix32) = \_mm\_cvtsi128\_si32(outPix\_packed\_i);}
\DoxyCodeLine{00162           ++pix32;}
\DoxyCodeLine{00163         \}}
\DoxyCodeLine{00164         \}}
\DoxyCodeLine{00165         ++pixIn;}
\DoxyCodeLine{00166       \}}
\DoxyCodeLine{00167     \}}
\DoxyCodeLine{00168 }
\DoxyCodeLine{00169     \_aligned\_free(paints);}
\DoxyCodeLine{00170     \_aligned\_free(inks);}
\DoxyCodeLine{00171 }
\DoxyCodeLine{00172   \} \textcolor{keywordflow}{else}  \textcolor{comment}{// SSE2 not supported}}
\DoxyCodeLine{00173 \textcolor{preprocessor}{\#endif    }\textcolor{comment}{// \_WIN32}}
\DoxyCodeLine{00174   \{}
\DoxyCodeLine{00175 }
\DoxyCodeLine{00176     std::vector<TPixel32> paints(count2, TPixel32(255, 0, 0));}
\DoxyCodeLine{00177     std::vector<TPixel32> inks(count2, TPixel32(255, 0, 0));}
\DoxyCodeLine{00178     \textcolor{keywordflow}{if} (transparencyCheck) \{}
\DoxyCodeLine{00179       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < palette-\/>getStyleCount(); i++) \{}
\DoxyCodeLine{00180         paints[i] = c\_transparencyCheckPaint;}
\DoxyCodeLine{00181         inks[i]   = c\_transparencyCheckInk;}
\DoxyCodeLine{00182       \}}
\DoxyCodeLine{00183       paints[0] = TPixel32::Transparent;}
\DoxyCodeLine{00184     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00185       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < palette-\/>getStyleCount(); i++)}
\DoxyCodeLine{00186         paints[i] = inks[i] =}
\DoxyCodeLine{00187             ::premultiply(palette-\/>getStyle(i)-\/>getAverageColor());}
\DoxyCodeLine{00188 }
\DoxyCodeLine{00189     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < rasLy; ++y) \{}
\DoxyCodeLine{00190       TPixel32 *pix32      = rasOut-\/>pixels(y);}
\DoxyCodeLine{00191       \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *pixIn    = rasIn-\/>pixels(y);}
\DoxyCodeLine{00192       \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *endPixIn = pixIn + rasLx;}
\DoxyCodeLine{00193 }
\DoxyCodeLine{00194       \textcolor{keywordflow}{while} (pixIn < endPixIn) \{}
\DoxyCodeLine{00195         \textcolor{keywordtype}{int} t = pixIn-\/>getTone();}
\DoxyCodeLine{00196         \textcolor{keywordtype}{int} p = pixIn-\/>getPaint();}
\DoxyCodeLine{00197         \textcolor{keywordtype}{int} i = pixIn-\/>getInk();}
\DoxyCodeLine{00198 }
\DoxyCodeLine{00199         \textcolor{keywordflow}{if} (t == TPixelCM32::getMaxTone())}
\DoxyCodeLine{00200           *pix32++ = paints[p];}
\DoxyCodeLine{00201         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (t == 0)}
\DoxyCodeLine{00202           *pix32++ = inks[i];}
\DoxyCodeLine{00203         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00204           *pix32++ = blend(inks[i], paints[p], t, TPixelCM32::getMaxTone());}
\DoxyCodeLine{00205 }
\DoxyCodeLine{00206         ++pixIn;}
\DoxyCodeLine{00207       \}}
\DoxyCodeLine{00208     \}}
\DoxyCodeLine{00209   \}}
\DoxyCodeLine{00210   rasOut-\/>unlock();}
\DoxyCodeLine{00211   rasIn-\/>unlock();}
\DoxyCodeLine{00212 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a86eca3417474265356482b543841bc90}\label{namespace_t_rop_a86eca3417474265356482b543841bc90}} 
\index{TRop@{TRop}!convert@{convert}}
\index{convert@{convert}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{convert()}{convert()}\hspace{0.1cm}{\footnotesize\ttfamily [2/4]}}
{\footnotesize\ttfamily void TRop\+::convert (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \&}]{ras\+Out,  }\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&}]{ras\+In,  }\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}}}]{palette,  }\item[{const \mbox{\hyperlink{class_t_rect_t}{TRect}} \&}]{the\+Clip\+Rect,  }\item[{bool}]{transparency\+Check = {\ttfamily false},  }\item[{bool}]{apply\+Fx = {\ttfamily false} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00247                                           \{}
\DoxyCodeLine{00248   assert(palette);}
\DoxyCodeLine{00249   assert(rasIn \&\& rasOut);}
\DoxyCodeLine{00250 }
\DoxyCodeLine{00251   \mbox{\hyperlink{class_t_rect_t}{TRect}} clipRect(theClipRect);}
\DoxyCodeLine{00252   \textcolor{keywordflow}{if} (clipRect.isEmpty())}
\DoxyCodeLine{00253     clipRect = rasIn-\/>getBounds();}
\DoxyCodeLine{00254   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00255     \textcolor{keywordflow}{if} (!clipRect.overlaps(rasIn-\/>getBounds())) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00256     clipRect = clipRect * rasIn-\/>getBounds();}
\DoxyCodeLine{00257   \}}
\DoxyCodeLine{00258   \textcolor{keywordflow}{if} (clipRect.isEmpty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00259 }
\DoxyCodeLine{00260   \mbox{\hyperlink{class_t_rect_t}{TRect}} clipRectIn, clipRectOut;}
\DoxyCodeLine{00261 }
\DoxyCodeLine{00262   \textcolor{keywordflow}{if} (applyFx \&\& palette-\/>getFxRects(clipRect, clipRectIn, clipRectOut)) \{}
\DoxyCodeLine{00263     \mbox{\hyperlink{class_t_rect_t}{TRect}} rAux = clipRectIn;}
\DoxyCodeLine{00264     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rAuxIn =}
\DoxyCodeLine{00265         rasIn-\/>extract(clipRectIn);  \textcolor{comment}{// la extract modifica clipRectIn}}
\DoxyCodeLine{00266     \textcolor{keywordflow}{if} (rAux != clipRectIn \&\& rAux != rasIn-\/>getBounds()) \{}
\DoxyCodeLine{00267       \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} rNew(rAux.getSize());}
\DoxyCodeLine{00268       \mbox{\hyperlink{class_t_rect_t}{TRect}} tmpRect = clipRectIn -\/ rAux.getP00();}
\DoxyCodeLine{00269       rNew-\/>extract(tmpRect)-\/>copy(rAuxIn);}
\DoxyCodeLine{00270       rAuxIn     = rNew;}
\DoxyCodeLine{00271       clipRectIn = rAux;}
\DoxyCodeLine{00272     \}}
\DoxyCodeLine{00273 }
\DoxyCodeLine{00274     \mbox{\hyperlink{class_t_tile}{TTile}} tileIn(rAuxIn, \mbox{\hyperlink{class_t_point_t_adbdd512f2e40a9c9f908ced6f4ec5cbd}{::convert}}(clipRectIn.getP00()));}
\DoxyCodeLine{00275 }
\DoxyCodeLine{00276     rAux = clipRectOut;}
\DoxyCodeLine{00277     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rAuxOut =}
\DoxyCodeLine{00278         rasOut-\/>extract(clipRectOut);  \textcolor{comment}{// la extract modifica clipRectOut}}
\DoxyCodeLine{00279     \mbox{\hyperlink{class_t_tile}{TTile}} tileOut(rAuxOut, \mbox{\hyperlink{class_t_point_t_adbdd512f2e40a9c9f908ced6f4ec5cbd}{::convert}}(clipRectOut.getP00()));}
\DoxyCodeLine{00280     \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(tileOut, tileIn, palette, transparencyCheck, \textcolor{keyword}{true});}
\DoxyCodeLine{00281   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00282     \mbox{\hyperlink{class_t_rect_t}{TRect}} clipRectIn  = clipRect;}
\DoxyCodeLine{00283     \mbox{\hyperlink{class_t_rect_t}{TRect}} clipRectOut = clipRect;}
\DoxyCodeLine{00284     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \_rasOut  = rasOut-\/>extract(clipRectOut);}
\DoxyCodeLine{00285     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \_rasIn   = rasIn-\/>extract(clipRectIn);}
\DoxyCodeLine{00286 }
\DoxyCodeLine{00287     \mbox{\hyperlink{class_t_tile}{TTile}} t1(\_rasOut, \mbox{\hyperlink{class_t_point_t_adbdd512f2e40a9c9f908ced6f4ec5cbd}{::convert}}(clipRectOut.getP00()));}
\DoxyCodeLine{00288     \mbox{\hyperlink{class_t_tile}{TTile}} t2(\_rasIn, \mbox{\hyperlink{class_t_point_t_adbdd512f2e40a9c9f908ced6f4ec5cbd}{::convert}}(clipRectIn.getP00()));}
\DoxyCodeLine{00289 }
\DoxyCodeLine{00290     \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(t1, t2, palette, transparencyCheck, \textcolor{keyword}{false});}
\DoxyCodeLine{00291   \}}
\DoxyCodeLine{00292 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a2ffbde782744822c73ea95817bbaf9ed}\label{namespace_t_rop_a2ffbde782744822c73ea95817bbaf9ed}} 
\index{TRop@{TRop}!convert@{convert}}
\index{convert@{convert}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{convert()}{convert()}\hspace{0.1cm}{\footnotesize\ttfamily [3/4]}}
{\footnotesize\ttfamily void TRop\+::convert (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_tile}{TTile}} \&}]{dst,  }\item[{const \mbox{\hyperlink{class_t_tile}{TTile}} \&}]{src,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}}}]{plt,  }\item[{bool}]{transparency\+Check,  }\item[{bool}]{apply\+Fxs }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00297                                                           \{}
\DoxyCodeLine{00298   \textcolor{comment}{// if (dst-\/>getSize() != src-\/>getSize())}}
\DoxyCodeLine{00299   \textcolor{comment}{//  throw TRopException("{}convert: size mismatch"{});}}
\DoxyCodeLine{00300 }
\DoxyCodeLine{00301   \textcolor{comment}{// assert(plt);}}
\DoxyCodeLine{00302   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})dst.getRaster())}
\DoxyCodeLine{00303     do\_convert(dst, src, plt, transparencyCheck, applyFxs);}
\DoxyCodeLine{00304   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})dst.getRaster()) \{}
\DoxyCodeLine{00305     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} aux(dst.getRaster()-\/>getLx(), dst.getRaster()-\/>getLy());}
\DoxyCodeLine{00306     \mbox{\hyperlink{class_t_tile}{TTile}} taux(aux, dst.m\_pos);}
\DoxyCodeLine{00307     do\_convert(taux, src, plt, transparencyCheck, applyFxs);}
\DoxyCodeLine{00308     \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(dst.getRaster(), aux);}
\DoxyCodeLine{00309   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00310     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}unsupported pixel type"{}});}
\DoxyCodeLine{00311 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}\label{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}} 
\index{TRop@{TRop}!convert@{convert}}
\index{convert@{convert}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{convert()}{convert()}\hspace{0.1cm}{\footnotesize\ttfamily [4/4]}}
{\footnotesize\ttfamily void TRop\+::convert (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{dst,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{src }\end{DoxyParamCaption})}



Convert {\bfseries{src}} raster in raster type {\bfseries{dst}}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00336                                                     \{}
\DoxyCodeLine{00337   \textcolor{keywordflow}{if} (dst-\/>getSize() != src-\/>getSize())}
\DoxyCodeLine{00338     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}convert: size mismatch"{}});}
\DoxyCodeLine{00339 }
\DoxyCodeLine{00340   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} dst32   = dst;}
\DoxyCodeLine{00341   \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} dst8   = dst;}
\DoxyCodeLine{00342   \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR16P}} dst16 = dst;}
\DoxyCodeLine{00343   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} dst64   = dst;}
\DoxyCodeLine{00344   \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} dstCm = dst;}
\DoxyCodeLine{00345 }
\DoxyCodeLine{00346   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} src32      = src;}
\DoxyCodeLine{00347   \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} src8      = src;}
\DoxyCodeLine{00348   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} src64      = src;}
\DoxyCodeLine{00349   \mbox{\hyperlink{class_t_raster_p_t}{TRasterYUV422P}} srcYUV = src;}
\DoxyCodeLine{00350   \mbox{\hyperlink{class_t_raster_p_t}{TRasterYUV422P}} dstYUV = dst;}
\DoxyCodeLine{00351 }
\DoxyCodeLine{00352   src-\/>lock();}
\DoxyCodeLine{00353   dst-\/>lock();}
\DoxyCodeLine{00354 }
\DoxyCodeLine{00355   \textcolor{keywordflow}{if} (dst64 \&\& src32)}
\DoxyCodeLine{00356     do\_convert(dst64, src32);}
\DoxyCodeLine{00357   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dst8 \&\& src32)}
\DoxyCodeLine{00358     do\_convert(dst8, src32);}
\DoxyCodeLine{00359   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dst16 \&\& src32)}
\DoxyCodeLine{00360     do\_convert(dst16, src32);}
\DoxyCodeLine{00361   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dst32 \&\& src64)}
\DoxyCodeLine{00362     ditherConvert(src64, dst32);}
\DoxyCodeLine{00363   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dst16 \&\& src64)}
\DoxyCodeLine{00364     do\_convert(dst16, src64);}
\DoxyCodeLine{00365   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dst32 \&\& src8)}
\DoxyCodeLine{00366     do\_convert(dst32, src8);}
\DoxyCodeLine{00367   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dstYUV \&\& src32)}
\DoxyCodeLine{00368     do\_convert(dstYUV, src32);  \textcolor{comment}{// Obsolete conversions}}
\DoxyCodeLine{00369   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dst32 \&\& srcYUV)}
\DoxyCodeLine{00370     do\_convert(dst32, srcYUV);  \textcolor{comment}{//}}
\DoxyCodeLine{00371   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dstCm \&\& src32)}
\DoxyCodeLine{00372     do\_convert(dstCm, src32);  \textcolor{comment}{//}}
\DoxyCodeLine{00373   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dstCm \&\& src8)}
\DoxyCodeLine{00374     do\_convert(dstCm, src8);  \textcolor{comment}{//}}
\DoxyCodeLine{00375   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00376     dst-\/>unlock();}
\DoxyCodeLine{00377     src-\/>unlock();}
\DoxyCodeLine{00378 }
\DoxyCodeLine{00379     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}unsupported pixel type"{}});}
\DoxyCodeLine{00380   \}}
\DoxyCodeLine{00381 }
\DoxyCodeLine{00382   dst-\/>unlock();}
\DoxyCodeLine{00383   src-\/>unlock();}
\DoxyCodeLine{00384 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00093}{copy()}}, \mbox{\hyperlink{l00316}{over()}}, \mbox{\hyperlink{l04648}{resample()}}, and \mbox{\hyperlink{l00382}{Movie\+Renderer\+::\+Imp\+::save\+Frame()}}.

\mbox{\Hypertarget{namespace_t_rop_a6fc864590b3faf072c5468255ee9f3ea}\label{namespace_t_rop_a6fc864590b3faf072c5468255ee9f3ea}} 
\index{TRop@{TRop}!convertRaster50to46@{convertRaster50to46}}
\index{convertRaster50to46@{convertRaster50to46}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{convertRaster50to46()}{convertRaster50to46()}}
{\footnotesize\ttfamily \mbox{\hyperlink{struct___r_a_s_t_e_r}{\+\_\+\+RASTER}} $\ast$ TRop\+::convert\+Raster50to46 (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{in\+Ras,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{in\+Palette }\end{DoxyParamCaption})}



Convert TRasterP in an old toonz raster! 

Use the same buffer, not creates a new raster (the palette is new instead!) 
\begin{DoxyCode}{0}
\DoxyCodeLine{01044                                                                \{}
\DoxyCodeLine{01045   \textcolor{keywordtype}{int} lx   = inRas-\/>getLx();}
\DoxyCodeLine{01046   \textcolor{keywordtype}{int} ly   = inRas-\/>getLy();}
\DoxyCodeLine{01047   \textcolor{keywordtype}{int} wrap = inRas-\/>\mbox{\hyperlink{class_t_raster_a760946b6cb48d7414f90cd421078912c}{getWrap}}();}
\DoxyCodeLine{01048 }
\DoxyCodeLine{01049   assert(lx > 0 \&\& ly > 0);}
\DoxyCodeLine{01050   assert(inRas-\/>\mbox{\hyperlink{class_t_raster_a5ce02b7e8a5b8b594863aa272d8dcdbc}{getRawData}}());}
\DoxyCodeLine{01051   \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} rgr8   = (\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}})inRas;}
\DoxyCodeLine{01052   \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR16P}} rgr16 = (\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR16P}})inRas;}
\DoxyCodeLine{01053   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} r32     = (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})inRas;}
\DoxyCodeLine{01054   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} r64     = (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})inRas;}
\DoxyCodeLine{01055   \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} rcm   = (\mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}})inRas;}
\DoxyCodeLine{01056 }
\DoxyCodeLine{01057   \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} *rout = \textcolor{keyword}{new} \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}};}
\DoxyCodeLine{01058   memset(rout, 0, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}}));}
\DoxyCodeLine{01059 }
\DoxyCodeLine{01060   std::string id(TImageCache::instance()-\/>getUniqueId());}
\DoxyCodeLine{01061   rout-\/>cacheIdLength = \textcolor{keywordtype}{id}.size();}
\DoxyCodeLine{01062   rout-\/>cacheId       = \textcolor{keyword}{new} \textcolor{keywordtype}{char}[rout-\/>cacheIdLength];}
\DoxyCodeLine{01063   memcpy(rout-\/>cacheId, \textcolor{keywordtype}{id}.data(), \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}) * rout-\/>cacheIdLength);}
\DoxyCodeLine{01064   \{}
\DoxyCodeLine{01065     \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img;}
\DoxyCodeLine{01066     \textcolor{keywordflow}{if} (rcm)}
\DoxyCodeLine{01067       img = \mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}}(rcm, rcm-\/>getBounds());  \textcolor{comment}{// saveBox is not considered}}
\DoxyCodeLine{01068                                                   \textcolor{comment}{// in RASTER struct anyway}}
\DoxyCodeLine{01069     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01070       img = \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}}(inRas);}
\DoxyCodeLine{01071     TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a124eae4cf370288f42c22b3477cb5163}{add}}(\textcolor{keywordtype}{id}, img);}
\DoxyCodeLine{01072   \}}
\DoxyCodeLine{01073   inRas-\/>addRef();}
\DoxyCodeLine{01074 }
\DoxyCodeLine{01075   rout-\/>buffer        = inRas-\/>\mbox{\hyperlink{class_t_raster_a5ce02b7e8a5b8b594863aa272d8dcdbc}{getRawData}}();}
\DoxyCodeLine{01076   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} parent     = inRas-\/>getParent();}
\DoxyCodeLine{01077   rout-\/>native\_buffer = (parent) ? parent-\/>\mbox{\hyperlink{class_t_raster_a5ce02b7e8a5b8b594863aa272d8dcdbc}{getRawData}}() : inRas-\/>\mbox{\hyperlink{class_t_raster_a5ce02b7e8a5b8b594863aa272d8dcdbc}{getRawData}}();}
\DoxyCodeLine{01078   rout-\/>lx            = lx;}
\DoxyCodeLine{01079   rout-\/>ly            = ly;}
\DoxyCodeLine{01080   rout-\/>wrap          = wrap;}
\DoxyCodeLine{01081 }
\DoxyCodeLine{01082   \textcolor{keywordflow}{if} (rgr8)}
\DoxyCodeLine{01083     rout-\/>type = RAS\_GR8;}
\DoxyCodeLine{01084   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rgr16)}
\DoxyCodeLine{01085     rout-\/>type = RAS\_GR16;}
\DoxyCodeLine{01086   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (r32)}
\DoxyCodeLine{01087     rout-\/>type = RAS\_RGBM;}
\DoxyCodeLine{01088   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (r64)}
\DoxyCodeLine{01089     rout-\/>type = RAS\_RGBM64;}
\DoxyCodeLine{01090   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rcm)}
\DoxyCodeLine{01091     rout-\/>type = RAS\_CM32;}
\DoxyCodeLine{01092   \textcolor{keywordflow}{else}}
\DoxyCodeLine{01093     assert(!\textcolor{stringliteral}{"{}raster type not convertible!"{}});}
\DoxyCodeLine{01094 }
\DoxyCodeLine{01095   \textcolor{keywordflow}{if} (rout-\/>type != RAS\_CM32) \textcolor{keywordflow}{return} rout;}
\DoxyCodeLine{01096 }
\DoxyCodeLine{01097   \textcolor{keywordflow}{if} (!inPalette) \{}
\DoxyCodeLine{01098     assert(!\textcolor{stringliteral}{"{}missing palette!"{}});}
\DoxyCodeLine{01099     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{01100   \}}
\DoxyCodeLine{01101 }
\DoxyCodeLine{01102   rout-\/>cmap.info   = Tcm\_32\_default\_info;}
\DoxyCodeLine{01103   rout-\/>cmap.buffer = \textcolor{keyword}{new} \mbox{\hyperlink{struct_l_p_i_x_e_l}{LPIXEL}}[TCM\_CMAP\_PENBUFFER\_SIZE(rout-\/>cmap.info)];}
\DoxyCodeLine{01104   \textcolor{comment}{// rout-\/>cmap.penbuffer = new LPIXEL[TCM\_CMAP\_PENBUFFER\_SIZE}}
\DoxyCodeLine{01105   \textcolor{comment}{// (rout-\/>cmap.info)];}}
\DoxyCodeLine{01106   \textcolor{comment}{// rout-\/>cmap.colbuffer = new LPIXEL[TCM\_CMAP\_COLBUFFER\_SIZE}}
\DoxyCodeLine{01107   \textcolor{comment}{// (rout-\/>cmap.info)];}}
\DoxyCodeLine{01108 }
\DoxyCodeLine{01109   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < inPalette-\/>\mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}(); i++)}
\DoxyCodeLine{01110     rout-\/>cmap.buffer[i] =}
\DoxyCodeLine{01111         ::premultiplyLPIXEL(inPalette-\/>\mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(i)-\/>\mbox{\hyperlink{class_t_color_style_af5907c6146db5067fcf000edeb8e403b}{getAverageColor}}());}
\DoxyCodeLine{01112   \textcolor{comment}{// fillCmapRamp (rout-\/>cmap, inPalette-\/>getStyle(i)-\/>getMainColor(), i);}}
\DoxyCodeLine{01113 }
\DoxyCodeLine{01114   \textcolor{keywordflow}{return} rout;}
\DoxyCodeLine{01115 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l01153}{TImage\+Cache\+::add()}}, \mbox{\hyperlink{l00270}{TColor\+Style\+::get\+Average\+Color()}}, \mbox{\hyperlink{l00158}{TRaster\+::get\+Raw\+Data()}}, \mbox{\hyperlink{l00283}{TPalette\+::get\+Style()}}, \mbox{\hyperlink{l00255}{TPalette\+::get\+Style\+Count()}}, and \mbox{\hyperlink{l00121}{TRaster\+::get\+Wrap()}}.



Referenced by \mbox{\hyperlink{l01176}{read\+Raster46()}}.

\mbox{\Hypertarget{namespace_t_rop_a4c6dae8ce37af1d30fded509f9ea7546}\label{namespace_t_rop_a4c6dae8ce37af1d30fded509f9ea7546}} 
\index{TRop@{TRop}!convolve\_3\_i@{convolve\_3\_i}}
\index{convolve\_3\_i@{convolve\_3\_i}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{convolve\_3\_i()}{convolve\_3\_i()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void TRop\+::convolve\+\_\+3\+\_\+i (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}}}]{rin,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{palette,  }\item[{int}]{dx,  }\item[{int}]{dy,  }\item[{double}]{conv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00571                                        \{}
\DoxyCodeLine{00572   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout32 = rout;}
\DoxyCodeLine{00573 }
\DoxyCodeLine{00574   \textcolor{keywordflow}{if} (rout32) \{}
\DoxyCodeLine{00575     doConvolve\_cm32\_3\_i<TPixel32>(rout32, rin, palette, dx, dy, conv);}
\DoxyCodeLine{00576     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00577   \}}
\DoxyCodeLine{00578 }
\DoxyCodeLine{00579   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rout64 = rout;}
\DoxyCodeLine{00580   \textcolor{keywordflow}{if} (rout64) \{}
\DoxyCodeLine{00581     doConvolve\_cm32\_3\_i<TPixel64>(rout64, rin, palette, dx, dy, conv);}
\DoxyCodeLine{00582     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00583   \}}
\DoxyCodeLine{00584 }
\DoxyCodeLine{00585   \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::convolve\_3\_i: unsupported pixel type"{}});}
\DoxyCodeLine{00586 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a1bf930e46aa120ad8522b0e39540e4b6}\label{namespace_t_rop_a1bf930e46aa120ad8522b0e39540e4b6}} 
\index{TRop@{TRop}!convolve\_3\_i@{convolve\_3\_i}}
\index{convolve\_3\_i@{convolve\_3\_i}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{convolve\_3\_i()}{convolve\_3\_i()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void TRop\+::convolve\+\_\+3\+\_\+i (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rin,  }\item[{int}]{dx,  }\item[{int}]{dy,  }\item[{double}]{conv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00532                                        \{}
\DoxyCodeLine{00533   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rin32 = rin;}
\DoxyCodeLine{00534 }
\DoxyCodeLine{00535   \textcolor{keywordflow}{if} (rin32) \{}
\DoxyCodeLine{00536     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout32 = rout;}
\DoxyCodeLine{00537     \textcolor{keywordflow}{if} (rout32) \{}
\DoxyCodeLine{00538       doConvolve\_3\_i<TPixel32, TPixel32>(rout32, rin32, dx, dy, conv);}
\DoxyCodeLine{00539       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00540     \}}
\DoxyCodeLine{00541 }
\DoxyCodeLine{00542     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rout64 = rout;}
\DoxyCodeLine{00543     \textcolor{keywordflow}{if} (rout64) \{}
\DoxyCodeLine{00544       doConvolve\_3\_i<TPixel64, TPixel32>(rout64, rin32, dx, dy, conv);}
\DoxyCodeLine{00545       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00546     \}}
\DoxyCodeLine{00547   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00548     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rin64 = rin;}
\DoxyCodeLine{00549     \textcolor{keywordflow}{if} (rin64) \{}
\DoxyCodeLine{00550       \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout32 = rout;}
\DoxyCodeLine{00551       \textcolor{keywordflow}{if} (rout32) \{}
\DoxyCodeLine{00552         doConvolve\_3\_i<TPixel32, TPixel64>(rout32, rin64, dx, dy, conv);}
\DoxyCodeLine{00553         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00554       \}}
\DoxyCodeLine{00555 }
\DoxyCodeLine{00556       \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rout64 = rout;}
\DoxyCodeLine{00557       \textcolor{keywordflow}{if} (rout64) \{}
\DoxyCodeLine{00558         doConvolve\_3\_i<TPixel64, TPixel64>(rout64, rin64, dx, dy, conv);}
\DoxyCodeLine{00559         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00560       \}}
\DoxyCodeLine{00561     \}}
\DoxyCodeLine{00562   \}}
\DoxyCodeLine{00563 }
\DoxyCodeLine{00564   \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::convolve\_3\_i: unsupported pixel type"{}});}
\DoxyCodeLine{00565 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a3c1b6b5ed6465346721de15ac07de8e6}\label{namespace_t_rop_a3c1b6b5ed6465346721de15ac07de8e6}} 
\index{TRop@{TRop}!convolve\_i@{convolve\_i}}
\index{convolve\_i@{convolve\_i}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{convolve\_i()}{convolve\_i()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void TRop\+::convolve\+\_\+i (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}}}]{rin,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{palette,  }\item[{int}]{dx,  }\item[{int}]{dy,  }\item[{double}]{conv\mbox{[}$\,$\mbox{]},  }\item[{int}]{radius }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00629                                                                  \{}
\DoxyCodeLine{00630   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout32 = rout;}
\DoxyCodeLine{00631 }
\DoxyCodeLine{00632   \textcolor{keywordflow}{if} (rout32) \{}
\DoxyCodeLine{00633     doConvolve\_cm32\_i<TPixel32>(rout32, rin, palette, dx, dy, conv, radius);}
\DoxyCodeLine{00634     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00635   \}}
\DoxyCodeLine{00636 }
\DoxyCodeLine{00637   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rout64 = rout;}
\DoxyCodeLine{00638   \textcolor{keywordflow}{if} (rout64) \{}
\DoxyCodeLine{00639     doConvolve\_cm32\_i<TPixel64>(rout64, rin, palette, dx, dy, conv, radius);}
\DoxyCodeLine{00640     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00641   \}}
\DoxyCodeLine{00642 }
\DoxyCodeLine{00643   \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::convolve\_i: unsupported pixel type"{}});}
\DoxyCodeLine{00644 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a5d086c7fcdee2a2fcec03005d7f7eda7}\label{namespace_t_rop_a5d086c7fcdee2a2fcec03005d7f7eda7}} 
\index{TRop@{TRop}!convolve\_i@{convolve\_i}}
\index{convolve\_i@{convolve\_i}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{convolve\_i()}{convolve\_i()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void TRop\+::convolve\+\_\+i (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rin,  }\item[{int}]{dx,  }\item[{int}]{dy,  }\item[{double}]{conv\mbox{[}$\,$\mbox{]},  }\item[{int}]{radius }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00591                                                  \{}
\DoxyCodeLine{00592   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rin32 = rin;}
\DoxyCodeLine{00593 }
\DoxyCodeLine{00594   \textcolor{keywordflow}{if} (rin32) \{}
\DoxyCodeLine{00595     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout32 = rout;}
\DoxyCodeLine{00596     \textcolor{keywordflow}{if} (rout32) \{}
\DoxyCodeLine{00597       doConvolve\_i<TPixel32, TPixel32>(rout32, rin32, dx, dy, conv, radius);}
\DoxyCodeLine{00598       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00599     \}}
\DoxyCodeLine{00600 }
\DoxyCodeLine{00601     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rout64 = rout;}
\DoxyCodeLine{00602     \textcolor{keywordflow}{if} (rout64) \{}
\DoxyCodeLine{00603       doConvolve\_i<TPixel64, TPixel32>(rout64, rin32, dx, dy, conv, radius);}
\DoxyCodeLine{00604       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00605     \}}
\DoxyCodeLine{00606   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00607     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rin64 = rin;}
\DoxyCodeLine{00608     \textcolor{keywordflow}{if} (rin64) \{}
\DoxyCodeLine{00609       \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout32 = rout;}
\DoxyCodeLine{00610       \textcolor{keywordflow}{if} (rout32) \{}
\DoxyCodeLine{00611         doConvolve\_i<TPixel32, TPixel64>(rout32, rin64, dx, dy, conv, radius);}
\DoxyCodeLine{00612         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00613       \}}
\DoxyCodeLine{00614 }
\DoxyCodeLine{00615       \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rout64 = rout;}
\DoxyCodeLine{00616       \textcolor{keywordflow}{if} (rout64) \{}
\DoxyCodeLine{00617         doConvolve\_i<TPixel64, TPixel64>(rout64, rin64, dx, dy, conv, radius);}
\DoxyCodeLine{00618         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00619       \}}
\DoxyCodeLine{00620     \}}
\DoxyCodeLine{00621   \}}
\DoxyCodeLine{00622 }
\DoxyCodeLine{00623   \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::convolve\_i: unsupported pixel type"{}});}
\DoxyCodeLine{00624 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a229eb7fd85c23c325ea4ba55478d5712}\label{namespace_t_rop_a229eb7fd85c23c325ea4ba55478d5712}} 
\index{TRop@{TRop}!copy@{copy}}
\index{copy@{copy}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{copy()}{copy()}}
{\footnotesize\ttfamily void TRop\+::copy (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{dst,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{src }\end{DoxyParamCaption})}



Copy {\bfseries{src}} in {\bfseries{dst}}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00093                                                  \{}
\DoxyCodeLine{00094   assert(!((\mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}})src) || (\mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}})dst);}
\DoxyCodeLine{00095   \textcolor{keywordflow}{if} (dst-\/>getPixelSize() == src-\/>getPixelSize())}
\DoxyCodeLine{00096     dst-\/>\mbox{\hyperlink{class_t_raster_a3c590c4ebe4cb8c1f352437692ffd20e}{copy}}(src);}
\DoxyCodeLine{00097   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00098     \textcolor{keywordflow}{if} (dst-\/>getBounds() != src-\/>getBounds()) \{}
\DoxyCodeLine{00099       \mbox{\hyperlink{class_t_rect_t}{TRect}} rect = dst-\/>getBounds() * src-\/>getBounds();}
\DoxyCodeLine{00100       \textcolor{keywordflow}{if} (rect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00101       \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(dst-\/>extract(rect), src-\/>extract(rect));}
\DoxyCodeLine{00102     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00103       \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(dst, src);}
\DoxyCodeLine{00104   \}}
\DoxyCodeLine{00105 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00336}{convert()}}, \mbox{\hyperlink{l00263}{TRaster\+::copy()}}, and \mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{TRect\+T$<$ T $>$\+::is\+Empty()}}.



Referenced by \mbox{\hyperlink{l00511}{TCache\+Resource\+::download()}}, \mbox{\hyperlink{l00316}{over()}}, \mbox{\hyperlink{l00569}{TCleanupper\+::process()}}, and \mbox{\hyperlink{l00449}{TCache\+Resource\+::upload()}}.

\mbox{\Hypertarget{namespace_t_rop_aec16db9b546d40b13e1e5b0946417b07}\label{namespace_t_rop_aec16db9b546d40b13e1e5b0946417b07}} 
\index{TRop@{TRop}!copyAndSwapRBChannels@{copyAndSwapRBChannels}}
\index{copyAndSwapRBChannels@{copyAndSwapRBChannels}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{copyAndSwapRBChannels()}{copyAndSwapRBChannels()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} TRop\+::copy\+And\+Swap\+RBChannels (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \&}]{src\+Raster }\end{DoxyParamCaption})}



Return a raster with r b channels swapped. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00068                                                                   \{}
\DoxyCodeLine{00069   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} newRaster(srcRaster-\/>getSize());}
\DoxyCodeLine{00070   \textcolor{keywordtype}{int} lx = srcRaster-\/>getLx();}
\DoxyCodeLine{00071   \textcolor{keywordtype}{int} y  = srcRaster-\/>getLy();}
\DoxyCodeLine{00072   srcRaster-\/>lock();}
\DoxyCodeLine{00073   newRaster-\/>lock();}
\DoxyCodeLine{00074   \textcolor{keywordflow}{while} (-\/-\/y >= 0) \{}
\DoxyCodeLine{00075     TPixel32 *pix    = srcRaster-\/>pixels(y);}
\DoxyCodeLine{00076     TPixel32 *newpix = newRaster-\/>pixels(y);}
\DoxyCodeLine{00077     TPixel32 *endPix = pix + lx;}
\DoxyCodeLine{00078     \textcolor{keywordflow}{while} (pix < endPix) \{}
\DoxyCodeLine{00079       newpix-\/>r = pix-\/>b;}
\DoxyCodeLine{00080       newpix-\/>g = pix-\/>g;}
\DoxyCodeLine{00081       newpix-\/>b = pix-\/>r;}
\DoxyCodeLine{00082       newpix-\/>m = pix-\/>m;}
\DoxyCodeLine{00083       ++pix;}
\DoxyCodeLine{00084       ++newpix;}
\DoxyCodeLine{00085     \}}
\DoxyCodeLine{00086   \}}
\DoxyCodeLine{00087   srcRaster-\/>unlock();}
\DoxyCodeLine{00088   newRaster-\/>unlock();}
\DoxyCodeLine{00089 }
\DoxyCodeLine{00090   \textcolor{keywordflow}{return} newRaster;}
\DoxyCodeLine{00091 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_ac115e66f53280dbca21075c52259b084}\label{namespace_t_rop_ac115e66f53280dbca21075c52259b084}} 
\index{TRop@{TRop}!crossDissolve@{crossDissolve}}
\index{crossDissolve@{crossDissolve}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{crossDissolve()}{crossDissolve()}}
{\footnotesize\ttfamily void TRop\+::cross\+Dissolve (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout,  }\item[{UCHAR}]{v }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01027                                                         \{}
\DoxyCodeLine{01028   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{01029   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{01030   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{01031   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{01032   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{01033   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{01034 }
\DoxyCodeLine{01035   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{01036     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{01037 }
\DoxyCodeLine{01038     outPix-\/>r = (upPix-\/>r * v + downPix-\/>r * (255 -\/ v)) / 255;}
\DoxyCodeLine{01039     outPix-\/>g = (upPix-\/>g * v + downPix-\/>g * (255 -\/ v)) / 255;}
\DoxyCodeLine{01040     outPix-\/>b = (upPix-\/>b * v + downPix-\/>b * (255 -\/ v)) / 255;}
\DoxyCodeLine{01041     outPix-\/>m = (upPix-\/>m * v + downPix-\/>m * (255 -\/ v)) / 255;}
\DoxyCodeLine{01042 }
\DoxyCodeLine{01043     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{01044   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{01045     USHORT vv = v * 257;}
\DoxyCodeLine{01046 }
\DoxyCodeLine{01047     FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{01048 }
\DoxyCodeLine{01049     outPix-\/>r = (upPix-\/>r * vv + downPix-\/>r * (65535 -\/ vv)) / 65535;}
\DoxyCodeLine{01050     outPix-\/>g = (upPix-\/>g * vv + downPix-\/>g * (65535 -\/ vv)) / 65535;}
\DoxyCodeLine{01051     outPix-\/>b = (upPix-\/>b * vv + downPix-\/>b * (65535 -\/ vv)) / 65535;}
\DoxyCodeLine{01052     outPix-\/>m = (upPix-\/>m * vv + downPix-\/>m * (65535 -\/ vv)) / 65535;}
\DoxyCodeLine{01053 }
\DoxyCodeLine{01054     FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{01055   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01056     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::crossDissolve invalid raster combination"{}});}
\DoxyCodeLine{01057 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a49f90a16ba17adf6e194d8aefff4e172}\label{namespace_t_rop_a49f90a16ba17adf6e194d8aefff4e172}} 
\index{TRop@{TRop}!darken@{darken}}
\index{darken@{darken}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{darken()}{darken()}}
{\footnotesize\ttfamily void TRop\+::darken (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01062                                         \{}
\DoxyCodeLine{01063   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{01064   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{01065   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{01066   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{01067   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{01068   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{01069 }
\DoxyCodeLine{01070   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{01071     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{01072 }
\DoxyCodeLine{01073     \textcolor{keywordtype}{double} value0 = luminance(upPix);}
\DoxyCodeLine{01074     \textcolor{keywordtype}{double} value1 = luminance(downPix);}
\DoxyCodeLine{01075 }
\DoxyCodeLine{01076     \textcolor{keywordflow}{if} (value0 < value1)}
\DoxyCodeLine{01077       *outPix = *upPix;}
\DoxyCodeLine{01078     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01079       *outPix = *downPix;}
\DoxyCodeLine{01080 }
\DoxyCodeLine{01081     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{01082   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{01083     FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{01084 }
\DoxyCodeLine{01085     \textcolor{keywordtype}{double} value0 = luminance(upPix);}
\DoxyCodeLine{01086     \textcolor{keywordtype}{double} value1 = luminance(downPix);}
\DoxyCodeLine{01087 }
\DoxyCodeLine{01088     \textcolor{keywordflow}{if} (value0 < value1)}
\DoxyCodeLine{01089       *outPix = *upPix;}
\DoxyCodeLine{01090     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01091       *outPix = *downPix;}
\DoxyCodeLine{01092 }
\DoxyCodeLine{01093     FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{01094   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01095     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::darken invalid raster combination"{}});}
\DoxyCodeLine{01096 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_add7d14f883c53c3d68ca0f256c42689f}\label{namespace_t_rop_add7d14f883c53c3d68ca0f256c42689f}} 
\index{TRop@{TRop}!depremultiply@{depremultiply}}
\index{depremultiply@{depremultiply}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{depremultiply()}{depremultiply()}}
{\footnotesize\ttfamily void TRop\+::depremultiply (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{ras }\end{DoxyParamCaption})}



Make a depremultiply of all raster pixels. 


\begin{DoxyCode}{0}
\DoxyCodeLine{01546                                             \{}
\DoxyCodeLine{01547   ras-\/>lock();}
\DoxyCodeLine{01548   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = ras;}
\DoxyCodeLine{01549   \textcolor{keywordflow}{if} (ras32) \{}
\DoxyCodeLine{01550     TPixel32 *endPix, *upPix = 0, *upRow = ras32-\/>pixels();}
\DoxyCodeLine{01551     TPixel32 *lastPix =}
\DoxyCodeLine{01552         upRow + ras32-\/>getWrap() * (ras32-\/>getLy() -\/ 1) + ras32-\/>getLx();}
\DoxyCodeLine{01553 }
\DoxyCodeLine{01554     \textcolor{keywordflow}{while} (upPix < lastPix) \{}
\DoxyCodeLine{01555       upPix  = upRow;}
\DoxyCodeLine{01556       endPix = upPix + ras32-\/>getLx();}
\DoxyCodeLine{01557       \textcolor{keywordflow}{while} (upPix < endPix) \{}
\DoxyCodeLine{01558         \textcolor{keywordflow}{if} (upPix-\/>m != 0) depremult(*upPix);}
\DoxyCodeLine{01559         ++upPix;}
\DoxyCodeLine{01560       \}}
\DoxyCodeLine{01561       upRow += ras32-\/>getWrap();}
\DoxyCodeLine{01562     \}}
\DoxyCodeLine{01563   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01564     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} ras64 = ras;}
\DoxyCodeLine{01565     \textcolor{keywordflow}{if} (ras64) \{}
\DoxyCodeLine{01566       TPixel64 *endPix, *upPix = 0, *upRow = ras64-\/>pixels();}
\DoxyCodeLine{01567       TPixel64 *lastPix =}
\DoxyCodeLine{01568           upRow + ras64-\/>getWrap() * (ras64-\/>getLy() -\/ 1) + ras64-\/>getLx();}
\DoxyCodeLine{01569 }
\DoxyCodeLine{01570       \textcolor{keywordflow}{while} (upPix < lastPix) \{}
\DoxyCodeLine{01571         upPix  = upRow;}
\DoxyCodeLine{01572         endPix = upPix + ras64-\/>getLx();}
\DoxyCodeLine{01573         \textcolor{keywordflow}{while} (upPix < endPix) \{}
\DoxyCodeLine{01574           \textcolor{keywordflow}{if} (upPix-\/>m != 0) depremult(*upPix);}
\DoxyCodeLine{01575           ++upPix;}
\DoxyCodeLine{01576         \}}
\DoxyCodeLine{01577         upRow += ras64-\/>getWrap();}
\DoxyCodeLine{01578       \}}
\DoxyCodeLine{01579     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01580       ras-\/>unlock();}
\DoxyCodeLine{01581       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}TRop::depremultiply invalid raster type"{}});}
\DoxyCodeLine{01582     \}}
\DoxyCodeLine{01583   \}}
\DoxyCodeLine{01584   ras-\/>unlock();}
\DoxyCodeLine{01585 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l01694}{apply\+Color\+Scale()}}, and \mbox{\hyperlink{l00170}{texture\+\_\+utils\+::get\+Texture\+Data()}}.

\mbox{\Hypertarget{namespace_t_rop_ab11c9fa6fc9221ea22161a5c148ef2e9}\label{namespace_t_rop_ab11c9fa6fc9221ea22161a5c148ef2e9}} 
\index{TRop@{TRop}!eraseColors@{eraseColors}}
\index{eraseColors@{eraseColors}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{eraseColors()}{eraseColors()}}
{\footnotesize\ttfamily void TRop\+::erase\+Colors (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}}}]{ras,  }\item[{std\+::vector$<$ int $>$ $\ast$}]{color\+Ids,  }\item[{bool}]{erase\+Inks,  }\item[{bool}]{no\+Gap = {\ttfamily false} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00806                                                    \{}
\DoxyCodeLine{00807   \textcolor{comment}{// noGap option is available only when erasing Inks}}
\DoxyCodeLine{00808   assert(eraseInks || !noGap);}
\DoxyCodeLine{00809   \textcolor{keywordflow}{if} (colorIds) std::sort(colorIds-\/>begin(), colorIds-\/>end());}
\DoxyCodeLine{00810 }
\DoxyCodeLine{00811   \textcolor{keywordtype}{bool} hasGapPixel = \textcolor{keyword}{false};}
\DoxyCodeLine{00812 }
\DoxyCodeLine{00813   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < ras-\/>getLy(); y++) \{}
\DoxyCodeLine{00814     \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *pix = ras-\/>pixels(y), *endPix = pix + ras-\/>getLx();}
\DoxyCodeLine{00815 }
\DoxyCodeLine{00816     \textcolor{keywordflow}{for} (; pix < endPix; pix++) \{}
\DoxyCodeLine{00817       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{00818       \textcolor{keywordtype}{int} color      = eraseInks ? pix-\/>getInk() : pix-\/>getPaint();}
\DoxyCodeLine{00819 }
\DoxyCodeLine{00820       \textcolor{keywordflow}{if} (color == 0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00821 }
\DoxyCodeLine{00822       \textcolor{keywordflow}{if} (colorIds \&\&}
\DoxyCodeLine{00823           !std::binary\_search(colorIds-\/>begin(), colorIds-\/>end(), color))}
\DoxyCodeLine{00824         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00825 }
\DoxyCodeLine{00826       \textcolor{keywordflow}{if} (eraseInks) \{}
\DoxyCodeLine{00827         \textcolor{comment}{// no-\/gap case.}}
\DoxyCodeLine{00828         \textcolor{comment}{// even if some area is filled under the solid line, delete it and}}
\DoxyCodeLine{00829         \textcolor{comment}{// expand-\/fill again to make sure the colors will be separated at the}}
\DoxyCodeLine{00830         \textcolor{comment}{// center of the lines.}}
\DoxyCodeLine{00831         \textcolor{keywordflow}{if} (noGap \&\& pix-\/>getTone() == 0) \{}
\DoxyCodeLine{00832           pix-\/>setPaint(}
\DoxyCodeLine{00833               TPixelCM32::getMaxPaint());  \textcolor{comment}{// use paintId = 4095 as mark of}}
\DoxyCodeLine{00834                                            \textcolor{comment}{// pixels to be filled}}
\DoxyCodeLine{00835           hasGapPixel = \textcolor{keyword}{true};}
\DoxyCodeLine{00836         \}}
\DoxyCodeLine{00837         pix-\/>setInk(0);}
\DoxyCodeLine{00838         pix-\/>setTone(TPixelCM32::getMaxTone());}
\DoxyCodeLine{00839       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00840         pix-\/>setPaint(0);}
\DoxyCodeLine{00841     \}}
\DoxyCodeLine{00842   \}}
\DoxyCodeLine{00843 }
\DoxyCodeLine{00844   \textcolor{keywordflow}{if} (hasGapPixel) expandAreaAndFillGaps(ras);}
\DoxyCodeLine{00845 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_af64e0fbf864d2bcffd3a959020dd4007}\label{namespace_t_rop_af64e0fbf864d2bcffd3a959020dd4007}} 
\index{TRop@{TRop}!eraseStyleIds@{eraseStyleIds}}
\index{eraseStyleIds@{eraseStyleIds}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{eraseStyleIds()}{eraseStyleIds()}}
{\footnotesize\ttfamily void TRop\+::erase\+Style\+Ids (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_toonz_image}{TToonz\+Image}} $\ast$}]{image,  }\item[{const std\+::vector$<$ int $>$}]{style\+Ids }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00874                                                                           \{}
\DoxyCodeLine{00875   assert(image);}
\DoxyCodeLine{00876   \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} ras = image-\/>\mbox{\hyperlink{class_t_toonz_image_ae04ea13c3803157ac69b01a83ad65865}{getRaster}}();}
\DoxyCodeLine{00877 }
\DoxyCodeLine{00878   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00879   \textcolor{keywordflow}{for} (i = 0; i < (int)styleIds.size(); i++) \{}
\DoxyCodeLine{00880     \textcolor{keywordtype}{int} styleId = styleIds[i];}
\DoxyCodeLine{00881     ras-\/>lock();}
\DoxyCodeLine{00882     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < ras-\/>getLy(); y++) \{}
\DoxyCodeLine{00883       \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *pix = ras-\/>pixels(y), *endPix = pix + ras-\/>getLx();}
\DoxyCodeLine{00884       \textcolor{keywordflow}{while} (pix < endPix) \{}
\DoxyCodeLine{00885         \textcolor{keywordtype}{bool} isPaint = (pix-\/>getPaint() == styleId);}
\DoxyCodeLine{00886         \textcolor{keywordtype}{bool} isInk   = (pix-\/>getInk() == styleId);}
\DoxyCodeLine{00887         \textcolor{keywordflow}{if} (!isPaint \&\& !isInk) \{}
\DoxyCodeLine{00888           pix++;}
\DoxyCodeLine{00889           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00890         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (isPaint \&\& !isInk)}
\DoxyCodeLine{00891           *pix = \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}}(pix-\/>getInk(), 0, pix-\/>getTone());}
\DoxyCodeLine{00892         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!isPaint \&\& isInk)}
\DoxyCodeLine{00893           *pix = \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}}(0, pix-\/>getPaint(), TPixelCM32::getMaxTone());}
\DoxyCodeLine{00894         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (isPaint \&\& isInk)}
\DoxyCodeLine{00895           *pix = \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}}(0, 0, pix-\/>getTone());}
\DoxyCodeLine{00896         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00897           assert(0);}
\DoxyCodeLine{00898         pix++;}
\DoxyCodeLine{00899       \}}
\DoxyCodeLine{00900     \}}
\DoxyCodeLine{00901     ras-\/>unlock();}
\DoxyCodeLine{00902   \}}
\DoxyCodeLine{00903 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_ae9c480cced8c0b7b1cb8402e99c5af8d}\label{namespace_t_rop_ae9c480cced8c0b7b1cb8402e99c5af8d}} 
\index{TRop@{TRop}!erodilate@{erodilate}}
\index{erodilate@{erodilate}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{erodilate()}{erodilate()}}
{\footnotesize\ttfamily void TRop\+::erodilate (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rin,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout,  }\item[{double}]{radius,  }\item[{Erodilate\+Mask\+Type}]{type }\end{DoxyParamCaption})}

Applies classical morphological erosion/dilation to the specified input raster. \begin{DoxyNote}{Note}
Supports rin == rout. 
\end{DoxyNote}

\begin{DoxyCode}{0}
\DoxyCodeLine{00496                                              \{}
\DoxyCodeLine{00497   assert(src-\/>getSize() == dst-\/>getSize());}
\DoxyCodeLine{00498 }
\DoxyCodeLine{00499   src-\/>lock(), dst-\/>lock();}
\DoxyCodeLine{00500 }
\DoxyCodeLine{00501   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})src \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})dst) \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{00502     \textcolor{keywordflow}{case} ED\_rectangular:}
\DoxyCodeLine{00503       ::rect\_erodilate<TPixel32>(src, dst, radius);}
\DoxyCodeLine{00504       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00505     \textcolor{keywordflow}{case} ED\_circular:}
\DoxyCodeLine{00506       ::circular\_erodilate<TPixel32>(src, dst, radius);}
\DoxyCodeLine{00507       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00508     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00509       assert(!\textcolor{stringliteral}{"{}Unknown mask type"{}});}
\DoxyCodeLine{00510       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00511     \}}
\DoxyCodeLine{00512   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})src \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})dst)}
\DoxyCodeLine{00513     \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{00514     \textcolor{keywordflow}{case} ED\_rectangular:}
\DoxyCodeLine{00515       ::rect\_erodilate<TPixel64>(src, dst, radius);}
\DoxyCodeLine{00516       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00517     \textcolor{keywordflow}{case} ED\_circular:}
\DoxyCodeLine{00518       ::circular\_erodilate<TPixel64>(src, dst, radius);}
\DoxyCodeLine{00519       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00520     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00521       assert(!\textcolor{stringliteral}{"{}Unknown mask type"{}});}
\DoxyCodeLine{00522       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00523     \}}
\DoxyCodeLine{00524   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00525     assert(!\textcolor{stringliteral}{"{}Unsupported raster type!"{}});}
\DoxyCodeLine{00526 }
\DoxyCodeLine{00527   src-\/>unlock(), dst-\/>unlock();}
\DoxyCodeLine{00528 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a8b092782761fe2b3ce0dfb289b3dd02e}\label{namespace_t_rop_a8b092782761fe2b3ce0dfb289b3dd02e}} 
\index{TRop@{TRop}!expandColor@{expandColor}}
\index{expandColor@{expandColor}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{expandColor()}{expandColor()}}
{\footnotesize\ttfamily void TRop\+::expand\+Color (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \&}]{ras32,  }\item[{bool}]{precise }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01589                                                             \{}
\DoxyCodeLine{01590   \textcolor{keyword}{struct }locals \{}
\DoxyCodeLine{01591     \textcolor{keyword}{static} \textcolor{keywordtype}{void} copyRGB(TPixel32 *dst, TPixel32 *src) \{}
\DoxyCodeLine{01592       dst-\/>r = src-\/>r;}
\DoxyCodeLine{01593       dst-\/>g = src-\/>g;}
\DoxyCodeLine{01594       dst-\/>b = src-\/>b;}
\DoxyCodeLine{01595     \}}
\DoxyCodeLine{01596   \};  \textcolor{comment}{// locals}}
\DoxyCodeLine{01597   ras32-\/>lock();}
\DoxyCodeLine{01598   TPixel32 *endPix, *upPix = 0, *upRow = ras32-\/>pixels();}
\DoxyCodeLine{01599   TPixel32 *lastPix =}
\DoxyCodeLine{01600       upRow + ras32-\/>getWrap() * (ras32-\/>getLy() -\/ 1) + ras32-\/>getLx();}
\DoxyCodeLine{01601   \textcolor{keywordtype}{int} currentRow = 0;}
\DoxyCodeLine{01602   \textcolor{keywordflow}{while} (upPix < lastPix) \{}
\DoxyCodeLine{01603     upPix  = upRow;}
\DoxyCodeLine{01604     endPix = upPix + ras32-\/>getLx();}
\DoxyCodeLine{01605     \textcolor{keywordflow}{while} (upPix < endPix) \{}
\DoxyCodeLine{01606       \textcolor{keywordflow}{if} (upPix-\/>m == 0) \{}
\DoxyCodeLine{01607         \textcolor{comment}{// search 4-\/neighbor pixels}}
\DoxyCodeLine{01608         \textcolor{comment}{// left}}
\DoxyCodeLine{01609         \textcolor{keywordflow}{if} (upPix != upRow \&\& (upPix -\/ 1)-\/>m != 0)}
\DoxyCodeLine{01610           locals::copyRGB(upPix, upPix -\/ 1);}
\DoxyCodeLine{01611         \textcolor{comment}{// right}}
\DoxyCodeLine{01612         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (upPix != endPix -\/ 1 \&\& (upPix + 1)-\/>m != 0)}
\DoxyCodeLine{01613           locals::copyRGB(upPix, upPix + 1);}
\DoxyCodeLine{01614         \textcolor{comment}{// up}}
\DoxyCodeLine{01615         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (currentRow != 0 \&\& (upPix -\/ ras32-\/>getWrap())-\/>m != 0)}
\DoxyCodeLine{01616           locals::copyRGB(upPix, upPix -\/ ras32-\/>getWrap());}
\DoxyCodeLine{01617         \textcolor{comment}{// down}}
\DoxyCodeLine{01618         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (currentRow != ras32-\/>getLy() -\/ 1 \&\&}
\DoxyCodeLine{01619                  (upPix + ras32-\/>getWrap())-\/>m != 0)}
\DoxyCodeLine{01620           locals::copyRGB(upPix, upPix + ras32-\/>getWrap());}
\DoxyCodeLine{01621         \textcolor{comment}{// search 8-\/neighbor pixels}}
\DoxyCodeLine{01622         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (precise) \{}
\DoxyCodeLine{01623           \textcolor{comment}{// upper left}}
\DoxyCodeLine{01624           \textcolor{keywordflow}{if} (currentRow != 0 \&\& upPix != upRow \&\&}
\DoxyCodeLine{01625               (upPix -\/ ras32-\/>getWrap() -\/ 1)-\/>m != 0)}
\DoxyCodeLine{01626             locals::copyRGB(upPix, upPix -\/ ras32-\/>getWrap() -\/ 1);}
\DoxyCodeLine{01627           \textcolor{comment}{// upper right}}
\DoxyCodeLine{01628           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (currentRow != 0 \&\& upPix != endPix -\/ 1 \&\&}
\DoxyCodeLine{01629                    (upPix -\/ ras32-\/>getWrap() + 1)-\/>m != 0)}
\DoxyCodeLine{01630             locals::copyRGB(upPix, upPix -\/ ras32-\/>getWrap() + 1);}
\DoxyCodeLine{01631           \textcolor{comment}{// lower left}}
\DoxyCodeLine{01632           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (currentRow != ras32-\/>getLy() -\/ 1 \&\& upPix != upRow \&\&}
\DoxyCodeLine{01633                    (upPix + ras32-\/>getWrap() -\/ 1)-\/>m != 0)}
\DoxyCodeLine{01634             locals::copyRGB(upPix, upPix + ras32-\/>getWrap() -\/ 1);}
\DoxyCodeLine{01635           \textcolor{comment}{// lower right}}
\DoxyCodeLine{01636           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (currentRow != ras32-\/>getLy() -\/ 1 \&\& upPix != endPix -\/ 1 \&\&}
\DoxyCodeLine{01637                    (upPix + ras32-\/>getWrap() + 1)-\/>m != 0)}
\DoxyCodeLine{01638             locals::copyRGB(upPix, upPix + ras32-\/>getWrap() + 1);}
\DoxyCodeLine{01639         \}}
\DoxyCodeLine{01640       \}}
\DoxyCodeLine{01641       ++upPix;}
\DoxyCodeLine{01642     \}}
\DoxyCodeLine{01643     upRow += ras32-\/>getWrap();}
\DoxyCodeLine{01644     currentRow++;}
\DoxyCodeLine{01645   \}}
\DoxyCodeLine{01646   ras32-\/>unlock();}
\DoxyCodeLine{01647 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a4fd8400a235f04da06f526186d439291}\label{namespace_t_rop_a4fd8400a235f04da06f526186d439291}} 
\index{TRop@{TRop}!expandPaint@{expandPaint}}
\index{expandPaint@{expandPaint}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{expandPaint()}{expandPaint()}}
{\footnotesize\ttfamily void TRop\+::expand\+Paint (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&}]{ras\+CM }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00238                                                 \{}
\DoxyCodeLine{00239   distanceTransform(rasCM, SomePaint(), CopyPaint());}
\DoxyCodeLine{00240 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_abdc4625a0fab7775638e375c71404b4c}\label{namespace_t_rop_abdc4625a0fab7775638e375c71404b4c}} 
\index{TRop@{TRop}!fracmove@{fracmove}}
\index{fracmove@{fracmove}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{fracmove()}{fracmove()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void TRop\+::fracmove (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}}}]{rin,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{palette,  }\item[{double}]{dx,  }\item[{double}]{dy }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00093                                           \{}
\DoxyCodeLine{00094   \textcolor{keywordtype}{double} w[4] = \{1, 0, 0, 0\};}
\DoxyCodeLine{00095   \textcolor{keywordtype}{double} sum  = 0;}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097   \textcolor{keywordtype}{int} idx      = tfloor(dx);}
\DoxyCodeLine{00098   \textcolor{keywordtype}{int} idy      = tfloor(dy);}
\DoxyCodeLine{00099   \textcolor{keywordtype}{double} fracX = dx -\/ idx;}
\DoxyCodeLine{00100   \textcolor{keywordtype}{double} fracY = dy -\/ idy;}
\DoxyCodeLine{00101 }
\DoxyCodeLine{00102   \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{00103   \textcolor{keywordflow}{for} (i = 0; i < 2; ++i)}
\DoxyCodeLine{00104     \textcolor{keywordflow}{for} (j                = 0; j < 2; ++j)}
\DoxyCodeLine{00105       sum += w[j + 2 * i] = fabs(fracX -\/ j) * fabs(fracY -\/ i);}
\DoxyCodeLine{00106 }
\DoxyCodeLine{00107   \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) w[i] /= sum;}
\DoxyCodeLine{00108 }
\DoxyCodeLine{00109   TRop::convolve\_i(rout, rin, idx, idy, w, 2);}
\DoxyCodeLine{00110 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a8af2a2c23b1112d7582523b6d3add109}\label{namespace_t_rop_a8af2a2c23b1112d7582523b6d3add109}} 
\index{TRop@{TRop}!fracmove@{fracmove}}
\index{fracmove@{fracmove}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{fracmove()}{fracmove()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void TRop\+::fracmove (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rin,  }\item[{double}]{dx,  }\item[{double}]{dy }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00067                                                                      \{}
\DoxyCodeLine{00068   \textcolor{comment}{// Using a bilinear filter is best -\/ consider that only 4 pixels should}}
\DoxyCodeLine{00069   \textcolor{comment}{// contribute}}
\DoxyCodeLine{00070   \textcolor{comment}{// to a fractionarily shifted one, with weights proportional to the}}
\DoxyCodeLine{00071   \textcolor{comment}{// intersection areas.}}
\DoxyCodeLine{00072   \textcolor{keywordtype}{double} w[4] = \{1, 0, 0, 0\};}
\DoxyCodeLine{00073   \textcolor{keywordtype}{double} sum  = 0;}
\DoxyCodeLine{00074 }
\DoxyCodeLine{00075   \textcolor{keywordtype}{int} idx      = tfloor(dx);}
\DoxyCodeLine{00076   \textcolor{keywordtype}{int} idy      = tfloor(dy);}
\DoxyCodeLine{00077   \textcolor{keywordtype}{double} fracX = dx -\/ idx;}
\DoxyCodeLine{00078   \textcolor{keywordtype}{double} fracY = dy -\/ idy;}
\DoxyCodeLine{00079 }
\DoxyCodeLine{00080   \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{00081   \textcolor{keywordflow}{for} (i = 0; i < 2; ++i)}
\DoxyCodeLine{00082     \textcolor{keywordflow}{for} (j                = 0; j < 2; ++j)}
\DoxyCodeLine{00083       sum += w[j + 2 * i] = fabs(fracX -\/ j) * fabs(fracY -\/ i);}
\DoxyCodeLine{00084 }
\DoxyCodeLine{00085   \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) w[i] /= sum;}
\DoxyCodeLine{00086 }
\DoxyCodeLine{00087   TRop::convolve\_i(rout, rin, idx, idy, w, 2);}
\DoxyCodeLine{00088 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_ad4babe6813c171b27ede85b106642bf2}\label{namespace_t_rop_ad4babe6813c171b27ede85b106642bf2}} 
\index{TRop@{TRop}!gammaCorrect@{gammaCorrect}}
\index{gammaCorrect@{gammaCorrect}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{gammaCorrect()}{gammaCorrect()}}
{\footnotesize\ttfamily void TRop\+::gamma\+Correct (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{raster,  }\item[{double}]{gamma }\end{DoxyParamCaption})}



Make a {\bfseries{gamma}} correct in the {\bfseries{raster}}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00173                                                      \{}
\DoxyCodeLine{00174   \textcolor{keywordflow}{if} (gamma <= 0) gamma = 0.01;}
\DoxyCodeLine{00175   raster-\/>lock();}
\DoxyCodeLine{00176 }
\DoxyCodeLine{00177   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})raster)}
\DoxyCodeLine{00178     doGammaCorrect<TPixel32, UCHAR>(raster, gamma);}
\DoxyCodeLine{00179   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})raster)}
\DoxyCodeLine{00180     doGammaCorrect<TPixel64, USHORT>(raster, gamma);}
\DoxyCodeLine{00181   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00182     raster-\/>unlock();}
\DoxyCodeLine{00183     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}isOpaque: unsupported pixel type"{}});}
\DoxyCodeLine{00184   \}}
\DoxyCodeLine{00185   raster-\/>unlock();}
\DoxyCodeLine{00186 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00644}{Previewer\+::\+Imp\+::on\+Render\+Raster\+Completed()}}, and \mbox{\hyperlink{l00382}{Movie\+Renderer\+::\+Imp\+::save\+Frame()}}.

\mbox{\Hypertarget{namespace_t_rop_ae49245fbc12b809384cb6e1bf03c9b76}\label{namespace_t_rop_ae49245fbc12b809384cb6e1bf03c9b76}} 
\index{TRop@{TRop}!gammaCorrectRGBM@{gammaCorrectRGBM}}
\index{gammaCorrectRGBM@{gammaCorrectRGBM}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{gammaCorrectRGBM()}{gammaCorrectRGBM()}}
{\footnotesize\ttfamily void TRop\+::gamma\+Correct\+RGBM (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{raster,  }\item[{double}]{gammar,  }\item[{double}]{gammag,  }\item[{double}]{gammab,  }\item[{double}]{gammam }\end{DoxyParamCaption})}



Make a {\bfseries{gamma}} correct in the {\bfseries{raster}}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00190                                                           \{}
\DoxyCodeLine{00191   \textcolor{keywordflow}{if} (gammar <= 0) gammar = 0.01;}
\DoxyCodeLine{00192   \textcolor{keywordflow}{if} (gammag <= 0) gammag = 0.01;}
\DoxyCodeLine{00193   \textcolor{keywordflow}{if} (gammab <= 0) gammab = 0.01;}
\DoxyCodeLine{00194   \textcolor{keywordflow}{if} (gammam <= 0) gammam = 0.01;}
\DoxyCodeLine{00195 }
\DoxyCodeLine{00196   raster-\/>lock();}
\DoxyCodeLine{00197 }
\DoxyCodeLine{00198   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})raster)}
\DoxyCodeLine{00199     doGammaCorrectRGBM<TPixel32, UCHAR>(raster, gammar, gammag, gammab, gammam);}
\DoxyCodeLine{00200   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})raster)}
\DoxyCodeLine{00201     doGammaCorrectRGBM<TPixel64, USHORT>(raster, gammar, gammag, gammab,}
\DoxyCodeLine{00202                                          gammam);}
\DoxyCodeLine{00203   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00204     raster-\/>unlock();}
\DoxyCodeLine{00205     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}isOpaque: unsupported pixel type"{}});}
\DoxyCodeLine{00206   \}}
\DoxyCodeLine{00207   raster-\/>unlock();}
\DoxyCodeLine{00208 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_ae6809ae7f416ba30d31d3e7305be87f9}\label{namespace_t_rop_ae6809ae7f416ba30d31d3e7305be87f9}} 
\index{TRop@{TRop}!getBlurBorder@{getBlurBorder}}
\index{getBlurBorder@{getBlurBorder}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{getBlurBorder()}{getBlurBorder()}}
{\footnotesize\ttfamily int TRop\+::get\+Blur\+Border (\begin{DoxyParamCaption}\item[{double}]{blur }\end{DoxyParamCaption})}



Return the pixel size of the {\bfseries{blur}} border. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00948                                    \{}
\DoxyCodeLine{00949   \textcolor{keywordtype}{int} brad = (int)ceil(blur); \textcolor{comment}{/* number of pixels involved in the filtering */}}
\DoxyCodeLine{00950 }
\DoxyCodeLine{00951   \textcolor{keywordtype}{int} border = brad * 2;  \textcolor{comment}{// per sicurezza}}
\DoxyCodeLine{00952   \textcolor{keywordflow}{return} border;}
\DoxyCodeLine{00953 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a6ed7aee971d5bb0c6a7304a76c161b51}\label{namespace_t_rop_a6ed7aee971d5bb0c6a7304a76c161b51}} 
\index{TRop@{TRop}!glassRaylit@{glassRaylit}}
\index{glassRaylit@{glassRaylit}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{glassRaylit()}{glassRaylit()}}
{\footnotesize\ttfamily void TRop\+::glass\+Raylit (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{dst\+Ras,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{src\+Ras,  }\item[{const \mbox{\hyperlink{struct_t_rop_1_1_raylit_params}{Raylit\+Params}} \&}]{params }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00471                                                    \{}
\DoxyCodeLine{00472   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})dstRas \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})srcRas)}
\DoxyCodeLine{00473     doRaylit<TPixel32>(srcRas, dstRas, params, \&performColorRaylit<TPixel32>);}
\DoxyCodeLine{00474   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})dstRas \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})srcRas)}
\DoxyCodeLine{00475     doRaylit<TPixel64>(srcRas, dstRas, params, \&performColorRaylit<TPixel64>);}
\DoxyCodeLine{00476   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00477     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}TRop::raylit unsupported pixel type"{}});}
\DoxyCodeLine{00478 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a1d8e2ff30b65313b6a82376d17be65cf}\label{namespace_t_rop_a1d8e2ff30b65313b6a82376d17be65cf}} 
\index{TRop@{TRop}!invert@{invert}}
\index{invert@{invert}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{invert()}{invert()}}
{\footnotesize\ttfamily void TRop\+::invert (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{ras,  }\item[{bool}]{inv\+Red = {\ttfamily true},  }\item[{bool}]{inv\+Green = {\ttfamily true},  }\item[{bool}]{inv\+Blue = {\ttfamily true},  }\item[{bool}]{inv\+Matte = {\ttfamily false} }\end{DoxyParamCaption})}

Invert {\bfseries{ras}} color in according with {\bfseries{inv\+Red}}, {\bfseries{inv\+Green}}, {\bfseries{inv\+Blue}}, {\bfseries{inv\+Matte}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{00082                                  \{}
\DoxyCodeLine{00083   \textcolor{keywordflow}{if} (!invRed \&\& !invGreen \&\& !invBlue) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00084   \textcolor{keywordtype}{bool} flag = invRed \&\& invGreen \&\& invBlue \&\& !invMatte;}
\DoxyCodeLine{00085 }
\DoxyCodeLine{00086   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = ras;}
\DoxyCodeLine{00087   ras-\/>lock();}
\DoxyCodeLine{00088   \textcolor{keywordflow}{if} (ras32)}
\DoxyCodeLine{00089     \textcolor{keywordflow}{if} (flag)}
\DoxyCodeLine{00090       do\_invert<TPixel32>(ras32);}
\DoxyCodeLine{00091     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00092       do\_invert<TPixel32>(ras, invRed, invGreen, invBlue, invMatte);}
\DoxyCodeLine{00093   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00094     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} ras64 = ras;}
\DoxyCodeLine{00095     \textcolor{keywordflow}{if} (ras64)}
\DoxyCodeLine{00096       \textcolor{keywordflow}{if} (flag)}
\DoxyCodeLine{00097         do\_invert<TPixel64>(ras64);}
\DoxyCodeLine{00098       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00099         do\_invert<TPixel64>(ras64, invRed, invGreen, invBlue, invMatte);}
\DoxyCodeLine{00100     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00101       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} ras8 = ras;}
\DoxyCodeLine{00102       \textcolor{keywordflow}{if} (ras8)}
\DoxyCodeLine{00103         do\_invert<TPixelGR8>(ras8);}
\DoxyCodeLine{00104       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00105         ras-\/>unlock();}
\DoxyCodeLine{00106         \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}unsupported pixel type"{}});}
\DoxyCodeLine{00107       \}}
\DoxyCodeLine{00108     \}}
\DoxyCodeLine{00109   \}}
\DoxyCodeLine{00110   ras-\/>unlock();}
\DoxyCodeLine{00111 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_aa724b97c8915446922e99821756d2275}\label{namespace_t_rop_aa724b97c8915446922e99821756d2275}} 
\index{TRop@{TRop}!isOpaque@{isOpaque}}
\index{isOpaque@{isOpaque}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{isOpaque()}{isOpaque()}}
{\footnotesize\ttfamily bool TRop\+::is\+Opaque (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{ras }\end{DoxyParamCaption})}



Return true if {\bfseries{ras}} is opaque. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00041                                 \{}
\DoxyCodeLine{00042   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = ras;}
\DoxyCodeLine{00043   \textcolor{keywordflow}{if} (ras32)}
\DoxyCodeLine{00044     \textcolor{keywordflow}{return} isOpaque32(ras32);}
\DoxyCodeLine{00045   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}}(ras))}
\DoxyCodeLine{00046     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00047   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00048     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}isOpaque: unsupported pixel type"{}});}
\DoxyCodeLine{00049 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a99c6bf2fd7d769ac68ef2663b6bb5870}\label{namespace_t_rop_a99c6bf2fd7d769ac68ef2663b6bb5870}} 
\index{TRop@{TRop}!lighten@{lighten}}
\index{lighten@{lighten}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{lighten()}{lighten()}}
{\footnotesize\ttfamily void TRop\+::lighten (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01101                                          \{}
\DoxyCodeLine{01102   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{01103   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{01104   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{01105   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{01106   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{01107   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{01108 }
\DoxyCodeLine{01109   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{01110     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{01111 }
\DoxyCodeLine{01112     \textcolor{keywordtype}{double} value0 = luminance(upPix);}
\DoxyCodeLine{01113     \textcolor{keywordtype}{double} value1 = luminance(downPix);}
\DoxyCodeLine{01114 }
\DoxyCodeLine{01115     \textcolor{keywordflow}{if} (value0 > value1) \{}
\DoxyCodeLine{01116       TINT32 r, g, b, m;}
\DoxyCodeLine{01117       \textcolor{keywordflow}{if} (upPix-\/>m == 0)}
\DoxyCodeLine{01118         *outPix = *downPix;}
\DoxyCodeLine{01119       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01120         r         = downPix-\/>r + upPix-\/>r;}
\DoxyCodeLine{01121         g         = downPix-\/>g + upPix-\/>g;}
\DoxyCodeLine{01122         b         = downPix-\/>b + upPix-\/>b;}
\DoxyCodeLine{01123         m         = downPix-\/>m + upPix-\/>m;}
\DoxyCodeLine{01124         outPix-\/>r = (UCHAR)tcrop<TINT32>(r, (TINT32)0, (TINT32)255);}
\DoxyCodeLine{01125         outPix-\/>g = (UCHAR)tcrop<TINT32>(g, (TINT32)0, (TINT32)255);}
\DoxyCodeLine{01126         outPix-\/>b = (UCHAR)tcrop<TINT32>(b, (TINT32)0, (TINT32)255);}
\DoxyCodeLine{01127         outPix-\/>m = (UCHAR)tcrop<TINT32>(m, (TINT32)0, (TINT32)255);}
\DoxyCodeLine{01128       \}}
\DoxyCodeLine{01129     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01130       *outPix = *downPix;}
\DoxyCodeLine{01131     \}}
\DoxyCodeLine{01132 }
\DoxyCodeLine{01133     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{01134   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{01135     FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{01136 }
\DoxyCodeLine{01137     \textcolor{keywordtype}{double} value0 = luminance(upPix);}
\DoxyCodeLine{01138     \textcolor{keywordtype}{double} value1 = luminance(downPix);}
\DoxyCodeLine{01139 }
\DoxyCodeLine{01140     \textcolor{keywordflow}{if} (value0 > value1) \{}
\DoxyCodeLine{01141       TINT32 r, g, b, m;}
\DoxyCodeLine{01142       \textcolor{keywordflow}{if} (upPix-\/>m == 0)}
\DoxyCodeLine{01143         *outPix = *downPix;}
\DoxyCodeLine{01144       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01145         r         = downPix-\/>r + upPix-\/>r;}
\DoxyCodeLine{01146         g         = downPix-\/>g + upPix-\/>g;}
\DoxyCodeLine{01147         b         = downPix-\/>b + upPix-\/>b;}
\DoxyCodeLine{01148         m         = downPix-\/>m + upPix-\/>m;}
\DoxyCodeLine{01149         outPix-\/>r = (USHORT)tcrop<TINT32>(r, (TINT32)0, (TINT32)65535);}
\DoxyCodeLine{01150         outPix-\/>g = (USHORT)tcrop<TINT32>(g, (TINT32)0, (TINT32)65535);}
\DoxyCodeLine{01151         outPix-\/>b = (USHORT)tcrop<TINT32>(b, (TINT32)0, (TINT32)65535);}
\DoxyCodeLine{01152         outPix-\/>m = (USHORT)tcrop<TINT32>(m, (TINT32)0, (TINT32)65535);}
\DoxyCodeLine{01153       \}}
\DoxyCodeLine{01154     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01155       *outPix = *downPix;}
\DoxyCodeLine{01156     \}}
\DoxyCodeLine{01157 }
\DoxyCodeLine{01158     FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{01159   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01160     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::lighten invalid raster combination"{}});}
\DoxyCodeLine{01161 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a69a13be2091e3060864a17534b00af7b}\label{namespace_t_rop_a69a13be2091e3060864a17534b00af7b}} 
\index{TRop@{TRop}!linearburn@{linearburn}}
\index{linearburn@{linearburn}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{linearburn()}{linearburn()}}
{\footnotesize\ttfamily void TRop\+::linearburn (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01309                                             \{}
\DoxyCodeLine{01310   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{01311   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{01312   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{01313 }
\DoxyCodeLine{01314   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{01315     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{01316     \textcolor{keywordflow}{if} (upPix-\/>m) \{}
\DoxyCodeLine{01317       TPixel32 app;}
\DoxyCodeLine{01318       \textcolor{keywordflow}{if} (downPix-\/>m) \{}
\DoxyCodeLine{01319         TINT32 r, g, b, m;}
\DoxyCodeLine{01320         TPixel32 tmpPix;}
\DoxyCodeLine{01321         tmpPix = depremultiply(*downPix);}
\DoxyCodeLine{01322         r      = tmpPix.r + upPix-\/>r -\/ 255;}
\DoxyCodeLine{01323         g      = tmpPix.g + upPix-\/>g -\/ 255;}
\DoxyCodeLine{01324         b      = tmpPix.b + upPix-\/>b -\/ 255;}
\DoxyCodeLine{01325         m      = tmpPix.m + upPix-\/>m -\/ 255;}
\DoxyCodeLine{01326 }
\DoxyCodeLine{01327         app.r = (UCHAR)tcrop<TINT32>(r, (TINT32)0, (TINT32)255);}
\DoxyCodeLine{01328         app.g = (UCHAR)tcrop<TINT32>(g, (TINT32)0, (TINT32)255);}
\DoxyCodeLine{01329         app.b = (UCHAR)tcrop<TINT32>(b, (TINT32)0, (TINT32)255);}
\DoxyCodeLine{01330         \textcolor{comment}{// app.m = (UCHAR)tcrop<TINT32> (m, (TINT32)0, (TINT32)255);}}
\DoxyCodeLine{01331         app.m = upPix-\/>m;}
\DoxyCodeLine{01332       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01333         app = *upPix;}
\DoxyCodeLine{01334       overPix<TPixel32, UCHAR>(*outPix, *downPix, app);}
\DoxyCodeLine{01335     \}}
\DoxyCodeLine{01336     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{01337   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01338     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{01339     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{01340     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{01341 }
\DoxyCodeLine{01342     \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{01343       FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{01344 }
\DoxyCodeLine{01345       \textcolor{keywordflow}{if} (upPix-\/>m) \{}
\DoxyCodeLine{01346         TPixel64 app;}
\DoxyCodeLine{01347         \textcolor{keywordflow}{if} (downPix-\/>m) \{}
\DoxyCodeLine{01348           TINT32 r, g, b, m;}
\DoxyCodeLine{01349           TPixel64 tmpPix;}
\DoxyCodeLine{01350           tmpPix = depremultiply(*downPix);}
\DoxyCodeLine{01351           r      = tmpPix.r + upPix-\/>r -\/ 65535;}
\DoxyCodeLine{01352           g      = tmpPix.g + upPix-\/>g -\/ 65535;}
\DoxyCodeLine{01353           b      = tmpPix.b + upPix-\/>b -\/ 65535;}
\DoxyCodeLine{01354           m      = tmpPix.m + upPix-\/>m -\/ 65535;}
\DoxyCodeLine{01355 }
\DoxyCodeLine{01356           app.r = (USHORT)tcrop<TINT32>(r, 0, 0xffff);}
\DoxyCodeLine{01357           app.g = (USHORT)tcrop<TINT32>(g, 0, 0xffff);}
\DoxyCodeLine{01358           app.b = (USHORT)tcrop<TINT32>(b, 0, 0xffff);}
\DoxyCodeLine{01359           \textcolor{comment}{// app.m = (UCHAR)tcrop<TINT32> (m, (TINT32)0, (TINT32)255);}}
\DoxyCodeLine{01360           app.m = upPix-\/>m;}
\DoxyCodeLine{01361         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01362           app = *upPix;}
\DoxyCodeLine{01363         overPix<TPixel64, USHORT>(*outPix, *downPix, app);}
\DoxyCodeLine{01364       \}}
\DoxyCodeLine{01365 }
\DoxyCodeLine{01366       FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{01367     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01368       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} up8   = rup;}
\DoxyCodeLine{01369       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} down8 = rdown;}
\DoxyCodeLine{01370       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} out8  = rout;}
\DoxyCodeLine{01371 }
\DoxyCodeLine{01372       \textcolor{keywordflow}{if} (up8 \&\& down8 \&\& out8) \{}
\DoxyCodeLine{01373         FOR\_EACH\_PIXEL\_8\_BEGIN\_LOOP}
\DoxyCodeLine{01374         USHORT value = troundp(upPix-\/>value + downPix-\/>value -\/ 255);}
\DoxyCodeLine{01375 }
\DoxyCodeLine{01376         outPix-\/>value = (UCHAR)tcrop<USHORT>(value, 0, 255);}
\DoxyCodeLine{01377 }
\DoxyCodeLine{01378         FOR\_EACH\_PIXEL\_8\_END\_LOOP}
\DoxyCodeLine{01379       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01380         \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::max invalid raster combination"{}});}
\DoxyCodeLine{01381     \}}
\DoxyCodeLine{01382   \}}
\DoxyCodeLine{01383 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a0403b9158edb19e8b805ef2cfffc8900}\label{namespace_t_rop_a0403b9158edb19e8b805ef2cfffc8900}} 
\index{TRop@{TRop}!lockRaster@{lockRaster}}
\index{lockRaster@{lockRaster}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{lockRaster()}{lockRaster()}}
{\footnotesize\ttfamily void TRop\+::lock\+Raster (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct___r_a_s_t_e_r}{\+\_\+\+RASTER}} $\ast$}]{raster }\end{DoxyParamCaption})}

Retrieves the input raster from Toonz internal cache. Need to call it before using the raster. 
\begin{DoxyCode}{0}
\DoxyCodeLine{01144                                     \{}
\DoxyCodeLine{01145   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img(TImageCache::instance()-\/>get(}
\DoxyCodeLine{01146       std::string(raster-\/>cacheId, raster-\/>cacheIdLength), \textcolor{keyword}{true}));}
\DoxyCodeLine{01147   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} cacheRas;}
\DoxyCodeLine{01148   \textcolor{keywordflow}{if} (raster-\/>type == RAS\_CM32)}
\DoxyCodeLine{01149     cacheRas = \mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}}(img)-\/>getRaster();}
\DoxyCodeLine{01150   \textcolor{keywordflow}{else}}
\DoxyCodeLine{01151     cacheRas = \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}}(img)-\/>getRaster();}
\DoxyCodeLine{01152   cacheRas-\/>addRef();}
\DoxyCodeLine{01153   raster-\/>buffer  = cacheRas-\/>\mbox{\hyperlink{class_t_raster_a5ce02b7e8a5b8b594863aa272d8dcdbc}{getRawData}}();}
\DoxyCodeLine{01154   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} parent = cacheRas-\/>getParent();}
\DoxyCodeLine{01155   raster-\/>native\_buffer =}
\DoxyCodeLine{01156       (parent) ? parent-\/>\mbox{\hyperlink{class_t_raster_a5ce02b7e8a5b8b594863aa272d8dcdbc}{getRawData}}() : cacheRas-\/>\mbox{\hyperlink{class_t_raster_a5ce02b7e8a5b8b594863aa272d8dcdbc}{getRawData}}();}
\DoxyCodeLine{01157 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00158}{TRaster\+::get\+Raw\+Data()}}.

\mbox{\Hypertarget{namespace_t_rop_a6dd60c2e85a75e42d593ee351876d614}\label{namespace_t_rop_a6dd60c2e85a75e42d593ee351876d614}} 
\index{TRop@{TRop}!majorityDespeckle@{majorityDespeckle}}
\index{majorityDespeckle@{majorityDespeckle}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{majorityDespeckle()}{majorityDespeckle()}}
{\footnotesize\ttfamily DVAPI void TRop\+::majority\+Despeckle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{ras,  }\item[{int}]{size\+Threshold }\end{DoxyParamCaption})}

Performs despeckling by replacing the color of small uniform areas (those enclosable in a square of specified edge length) with that most occurring along the area border. \mbox{\Hypertarget{namespace_t_rop_a35179ddf5774082da20b53eb7baf0e96}\label{namespace_t_rop_a35179ddf5774082da20b53eb7baf0e96}} 
\index{TRop@{TRop}!makeIcon@{makeIcon}}
\index{makeIcon@{makeIcon}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{makeIcon()}{makeIcon()}}
{\footnotesize\ttfamily void TRop\+::make\+Icon (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&}]{rout,  }\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&}]{rin }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01437                                                                 \{}
\DoxyCodeLine{01438   \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{01439   \textcolor{keywordtype}{int} lx = rin-\/>getLx();}
\DoxyCodeLine{01440   \textcolor{keywordtype}{int} ly = rin-\/>getLy();}
\DoxyCodeLine{01441 }
\DoxyCodeLine{01442   \mbox{\hyperlink{class_t_dimension_t}{TDimension}} dim(\_rout-\/>getSize());}
\DoxyCodeLine{01443   \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} rout;}
\DoxyCodeLine{01444 }
\DoxyCodeLine{01445   rout = \_rout;}
\DoxyCodeLine{01446 }
\DoxyCodeLine{01447   rout-\/>lock();}
\DoxyCodeLine{01448   rin-\/>lock();}
\DoxyCodeLine{01449   \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *pixOut0 = (\mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *)rout-\/>getRawData();}
\DoxyCodeLine{01450 }
\DoxyCodeLine{01451   \textcolor{keywordtype}{int} countY  = 0;}
\DoxyCodeLine{01452   \textcolor{keywordtype}{bool} newRow = \textcolor{keyword}{true};}
\DoxyCodeLine{01453 }
\DoxyCodeLine{01454   \textcolor{keywordflow}{for} (i = 0; i < ly; i++) \{}
\DoxyCodeLine{01455     \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *pixIn  = (\mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *)rin-\/>pixels(i);}
\DoxyCodeLine{01456     \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *pixOut = pixOut0;}
\DoxyCodeLine{01457     \textcolor{keywordtype}{int} countX         = 0;}
\DoxyCodeLine{01458     \textcolor{keywordtype}{bool} newColumn     = \textcolor{keyword}{true};}
\DoxyCodeLine{01459     \textcolor{keywordflow}{for} (j = 0; j < lx; j++) \{}
\DoxyCodeLine{01460       \textcolor{keywordflow}{if} ((newRow \&\& newColumn) || pixOut-\/>getTone() > pixIn-\/>getTone())}
\DoxyCodeLine{01461         *pixOut = *pixIn;}
\DoxyCodeLine{01462 }
\DoxyCodeLine{01463       pixIn++;}
\DoxyCodeLine{01464       countX += dim.lx;}
\DoxyCodeLine{01465       \textcolor{keywordflow}{if} (countX >= lx) \{}
\DoxyCodeLine{01466         countX -\/= lx, pixOut++;}
\DoxyCodeLine{01467         newColumn = \textcolor{keyword}{true};}
\DoxyCodeLine{01468       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01469         newColumn = \textcolor{keyword}{false};}
\DoxyCodeLine{01470     \}}
\DoxyCodeLine{01471 }
\DoxyCodeLine{01472     countY += dim.ly;}
\DoxyCodeLine{01473     \textcolor{keywordflow}{if} (countY >= ly) \{}
\DoxyCodeLine{01474       countY -\/= ly;}
\DoxyCodeLine{01475       pixOut0 += rout-\/>getWrap();}
\DoxyCodeLine{01476       newRow = \textcolor{keyword}{true};}
\DoxyCodeLine{01477     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01478       newRow = \textcolor{keyword}{false};}
\DoxyCodeLine{01479   \}}
\DoxyCodeLine{01480   rout-\/>unlock();}
\DoxyCodeLine{01481   rin-\/>unlock();}
\DoxyCodeLine{01482 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a8ffa1a15060b77c5386240cdcb06394f}\label{namespace_t_rop_a8ffa1a15060b77c5386240cdcb06394f}} 
\index{TRop@{TRop}!makeStereoRaster@{makeStereoRaster}}
\index{makeStereoRaster@{makeStereoRaster}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{makeStereoRaster()}{makeStereoRaster()}}
{\footnotesize\ttfamily void TRop\+::make\+Stereo\+Raster (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{left,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{right }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00325                                                                        \{}
\DoxyCodeLine{00326   assert(left-\/>getSize() == right-\/>getSize());}
\DoxyCodeLine{00327 }
\DoxyCodeLine{00328   left-\/>lock();}
\DoxyCodeLine{00329 }
\DoxyCodeLine{00330   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})left \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})right)}
\DoxyCodeLine{00331     doMakeStereoRaster<TPixel32>(left, right);}
\DoxyCodeLine{00332   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})left \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})right)}
\DoxyCodeLine{00333     doMakeStereoRaster<TPixel64>(left, right);}
\DoxyCodeLine{00334   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00335     left-\/>unlock();}
\DoxyCodeLine{00336     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}setChannel: unsupported pixel type"{}});}
\DoxyCodeLine{00337   \}}
\DoxyCodeLine{00338 }
\DoxyCodeLine{00339   left-\/>unlock();}
\DoxyCodeLine{00340 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a76f8b77a1eff52235e1124540365aba2}\label{namespace_t_rop_a76f8b77a1eff52235e1124540365aba2}} 
\index{TRop@{TRop}!mult@{mult}}
\index{mult@{mult}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{mult()}{mult()}}
{\footnotesize\ttfamily void TRop\+::mult (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout,  }\item[{int}]{v,  }\item[{bool}]{matte }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00592                                                          \{}
\DoxyCodeLine{00593   \textcolor{comment}{/*}}
\DoxyCodeLine{00594 \textcolor{comment}{Let U be 'up', D be 'down' and M be 'multiplied' (the result), and suppose for}}
\DoxyCodeLine{00595 \textcolor{comment}{the moment}}
\DoxyCodeLine{00596 \textcolor{comment}{that pixels are both NOT premultiplied and normalized to [0, 1].}}
\DoxyCodeLine{00597 \textcolor{comment}{}}
\DoxyCodeLine{00598 \textcolor{comment}{The additional value v is used to add to RGB components of the U pixel:}}
\DoxyCodeLine{00599 \textcolor{comment}{}}
\DoxyCodeLine{00600 \textcolor{comment}{U'\_rgb = (U\_rgb + v / 255)}}
\DoxyCodeLine{00601 \textcolor{comment}{}}
\DoxyCodeLine{00602 \textcolor{comment}{The matte component is either U\_m D\_m in case (matte == true), or D\_m in case}}
\DoxyCodeLine{00603 \textcolor{comment}{(matte == false).}}
\DoxyCodeLine{00604 \textcolor{comment}{Please, observe that in the case (matte == false) that choice makes the product}}
\DoxyCodeLine{00605 \textcolor{comment}{NOT COMMUTATIVE,}}
\DoxyCodeLine{00606 \textcolor{comment}{but I think that's justified -\/ it's simply the most obvious use case.}}
\DoxyCodeLine{00607 \textcolor{comment}{}}
\DoxyCodeLine{00608 \textcolor{comment}{In case (matte == true), each channel is multiplied independently, and that's}}
\DoxyCodeLine{00609 \textcolor{comment}{it.}}
\DoxyCodeLine{00610 \textcolor{comment}{}}
\DoxyCodeLine{00611 \textcolor{comment}{The matter is more complicated when (matte == false). The problem in this case}}
\DoxyCodeLine{00612 \textcolor{comment}{is dealing with rgb}}
\DoxyCodeLine{00613 \textcolor{comment}{components when U and D both have some transparency.  When U is fully}}
\DoxyCodeLine{00614 \textcolor{comment}{transparent, we expect the}}
\DoxyCodeLine{00615 \textcolor{comment}{result to be D, and vice-\/versa, which is non-\/trivial.}}
\DoxyCodeLine{00616 \textcolor{comment}{}}
\DoxyCodeLine{00617 \textcolor{comment}{We REQUIRE that (let's denote r only here):}}
\DoxyCodeLine{00618 \textcolor{comment}{}}
\DoxyCodeLine{00619 \textcolor{comment}{M\_r = M\_r\_u = U\_r (1 -\/ D\_m) + U\_r D\_r D\_m,   when  U\_m == 1    (When U is fully}}
\DoxyCodeLine{00620 \textcolor{comment}{opaque, M\_r is a D\_m-\/linear}}
\DoxyCodeLine{00621 \textcolor{comment}{                                                                combination of}}
\DoxyCodeLine{00622 \textcolor{comment}{U\_r and U\_r D\_r)}}
\DoxyCodeLine{00623 \textcolor{comment}{M\_r = M\_r\_d = D\_r (1 -\/ U\_m) + U\_r D\_r U\_m,   when  D\_m == 1    (Vice-\/versa, when}}
\DoxyCodeLine{00624 \textcolor{comment}{it's D that is fully opaque)}}
\DoxyCodeLine{00625 \textcolor{comment}{}}
\DoxyCodeLine{00626 \textcolor{comment}{Finally, we're building a weighted sum, by U\_m and D\_m of the two above:}}
\DoxyCodeLine{00627 \textcolor{comment}{}}
\DoxyCodeLine{00628 \textcolor{comment}{M\_r = (M\_r\_u * U\_m + M\_r\_d * D\_m) / (U\_m + D\_m) =}}
\DoxyCodeLine{00629 \textcolor{comment}{    = (...) =}}
\DoxyCodeLine{00630 \textcolor{comment}{    = [ U\_r U\_m (1 -\/ D\_m) + D\_r D\_m (1 -\/ U\_m) + 2 U\_r U\_m  D\_r D\_m ] / (U\_m +}}
\DoxyCodeLine{00631 \textcolor{comment}{D\_m)}}
\DoxyCodeLine{00632 \textcolor{comment}{*/}}
\DoxyCodeLine{00633 }
\DoxyCodeLine{00634   \textcolor{comment}{// 32-\/bit images case}}
\DoxyCodeLine{00635   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32 = rup, down32 = rdown, out32 = rout;}
\DoxyCodeLine{00636 }
\DoxyCodeLine{00637   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{00638     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} maxChannelF = float(TPixel32::maxChannelValue);}
\DoxyCodeLine{00639     \textcolor{keyword}{static} \textcolor{keyword}{const} UCHAR maxChannelC = UCHAR(TPixel32::maxChannelValue);}
\DoxyCodeLine{00640 }
\DoxyCodeLine{00641     \textcolor{keywordtype}{float} vf = v;}
\DoxyCodeLine{00642 }
\DoxyCodeLine{00643     \textcolor{keywordflow}{if} (matte) \{}
\DoxyCodeLine{00644       \textcolor{keywordtype}{float} dnMf, upMf\_norm, outMf;}
\DoxyCodeLine{00645 }
\DoxyCodeLine{00646       FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP  \textcolor{comment}{// Awful... should be explicit...}}
\DoxyCodeLine{00647 }
\DoxyCodeLine{00648           dnMf  = downPix-\/>m;}
\DoxyCodeLine{00649       upMf\_norm = upPix-\/>m / maxChannelF;}
\DoxyCodeLine{00650 }
\DoxyCodeLine{00651       outMf = downPix-\/>m * upMf\_norm;}
\DoxyCodeLine{00652 }
\DoxyCodeLine{00653       outPix-\/>r =}
\DoxyCodeLine{00654           tcrop((upPix-\/>r / upMf\_norm + vf) * (downPix-\/>r / dnMf), 0.0f, outMf);}
\DoxyCodeLine{00655       outPix-\/>g =}
\DoxyCodeLine{00656           tcrop((upPix-\/>g / upMf\_norm + vf) * (downPix-\/>g / dnMf), 0.0f, outMf);}
\DoxyCodeLine{00657       outPix-\/>b =}
\DoxyCodeLine{00658           tcrop((upPix-\/>b / upMf\_norm + vf) * (downPix-\/>b / dnMf), 0.0f, outMf);}
\DoxyCodeLine{00659       outPix-\/>m = outMf;}
\DoxyCodeLine{00660 }
\DoxyCodeLine{00661       \textcolor{comment}{// NOTE:  + 0.5f in the crop arguments could take care of rounding...}}
\DoxyCodeLine{00662 }
\DoxyCodeLine{00663       FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{00664     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00665       \textcolor{keywordtype}{float} umf\_norm, dmf\_norm, umdmf\_norm, outMf;}
\DoxyCodeLine{00666       \textcolor{keywordtype}{float} mSumf, uf, df, ufdf, normalizer;}
\DoxyCodeLine{00667 }
\DoxyCodeLine{00668       FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{00669 }
\DoxyCodeLine{00670       mSumf = upPix-\/>m + float(downPix-\/>m);}
\DoxyCodeLine{00671       \textcolor{keywordflow}{if} (mSumf > 0.0f) \{}
\DoxyCodeLine{00672         umf\_norm = upPix-\/>m / maxChannelF, dmf\_norm = downPix-\/>m / maxChannelF;}
\DoxyCodeLine{00673         outMf = upPix-\/>m +}
\DoxyCodeLine{00674                 (1.0f -\/ umf\_norm) *}
\DoxyCodeLine{00675                     downPix-\/>m;  \textcolor{comment}{// umf\_norm should be ensured in [0.0, 1.0].}}
\DoxyCodeLine{00676         \textcolor{comment}{// Convex combination should be in the conversion range.}}
\DoxyCodeLine{00677         normalizer = outMf / (maxChannelF * mSumf);}
\DoxyCodeLine{00678         umdmf\_norm = umf\_norm * dmf\_norm;}
\DoxyCodeLine{00679 }
\DoxyCodeLine{00680         uf = upPix-\/>r + vf * umdmf\_norm, df = downPix-\/>r, ufdf = uf * df;}
\DoxyCodeLine{00681         outPix-\/>r = tcrop((uf * (maxChannelC -\/ downPix-\/>m) +}
\DoxyCodeLine{00682                            df * (maxChannelC -\/ upPix-\/>m) + ufdf + ufdf) *}
\DoxyCodeLine{00683                               normalizer,}
\DoxyCodeLine{00684                           0.0f, outMf);}
\DoxyCodeLine{00685 }
\DoxyCodeLine{00686         uf = upPix-\/>g + vf * umdmf\_norm, df = downPix-\/>g, ufdf = uf * df;}
\DoxyCodeLine{00687         outPix-\/>g = tcrop((uf * (maxChannelC -\/ downPix-\/>m) +}
\DoxyCodeLine{00688                            df * (maxChannelC -\/ upPix-\/>m) + ufdf + ufdf) *}
\DoxyCodeLine{00689                               normalizer,}
\DoxyCodeLine{00690                           0.0f, outMf);}
\DoxyCodeLine{00691 }
\DoxyCodeLine{00692         uf = upPix-\/>b + vf * umdmf\_norm, df = downPix-\/>b, ufdf = uf * df;}
\DoxyCodeLine{00693         outPix-\/>b = tcrop((uf * (maxChannelC -\/ downPix-\/>m) +}
\DoxyCodeLine{00694                            df * (maxChannelC -\/ upPix-\/>m) + ufdf + ufdf) *}
\DoxyCodeLine{00695                               normalizer,}
\DoxyCodeLine{00696                           0.0f, outMf);}
\DoxyCodeLine{00697 }
\DoxyCodeLine{00698         outPix-\/>m = outMf;}
\DoxyCodeLine{00699       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00700         *outPix = TPixel32::Transparent;}
\DoxyCodeLine{00701 }
\DoxyCodeLine{00702       FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{00703     \}}
\DoxyCodeLine{00704 }
\DoxyCodeLine{00705     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00706   \}}
\DoxyCodeLine{00707 }
\DoxyCodeLine{00708   \textcolor{comment}{// 64-\/bit images case}}
\DoxyCodeLine{00709   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64 = rup, down64 = rdown, out64 = rout;}
\DoxyCodeLine{00710 }
\DoxyCodeLine{00711   \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{00712     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} maxChannelF = double(TPixel64::maxChannelValue);}
\DoxyCodeLine{00713     \textcolor{keyword}{static} \textcolor{keyword}{const} USHORT maxChannelC = USHORT(TPixel64::maxChannelValue);}
\DoxyCodeLine{00714 }
\DoxyCodeLine{00715     \textcolor{keywordtype}{double} vf =}
\DoxyCodeLine{00716         v * (TPixel64::maxChannelValue / double(TPixel32::maxChannelValue));}
\DoxyCodeLine{00717 }
\DoxyCodeLine{00718     \textcolor{keywordflow}{if} (matte) \{}
\DoxyCodeLine{00719       \textcolor{keywordtype}{double} dnMf, upMf\_norm, outMf;}
\DoxyCodeLine{00720 }
\DoxyCodeLine{00721       FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{00722 }
\DoxyCodeLine{00723       dnMf      = downPix-\/>m;}
\DoxyCodeLine{00724       upMf\_norm = upPix-\/>m / maxChannelF;}
\DoxyCodeLine{00725 }
\DoxyCodeLine{00726       outMf = downPix-\/>m * upMf\_norm;}
\DoxyCodeLine{00727 }
\DoxyCodeLine{00728       outPix-\/>r =}
\DoxyCodeLine{00729           tcrop((upPix-\/>r / upMf\_norm + vf) * (downPix-\/>r / dnMf), 0.0, outMf);}
\DoxyCodeLine{00730       outPix-\/>g =}
\DoxyCodeLine{00731           tcrop((upPix-\/>g / upMf\_norm + vf) * (downPix-\/>g / dnMf), 0.0, outMf);}
\DoxyCodeLine{00732       outPix-\/>b =}
\DoxyCodeLine{00733           tcrop((upPix-\/>b / upMf\_norm + vf) * (downPix-\/>b / dnMf), 0.0, outMf);}
\DoxyCodeLine{00734       outPix-\/>m = outMf;}
\DoxyCodeLine{00735 }
\DoxyCodeLine{00736       FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{00737     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00738       \textcolor{keywordtype}{double} umf\_norm, dmf\_norm, umdmf\_norm, outMf;}
\DoxyCodeLine{00739       \textcolor{keywordtype}{double} mSumf, uf, df, ufdf, normalizer;}
\DoxyCodeLine{00740 }
\DoxyCodeLine{00741       FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{00742 }
\DoxyCodeLine{00743       mSumf = upPix-\/>m + double(downPix-\/>m);}
\DoxyCodeLine{00744       \textcolor{keywordflow}{if} (mSumf > 0.0) \{}
\DoxyCodeLine{00745         umf\_norm = upPix-\/>m / maxChannelF, dmf\_norm = downPix-\/>m / maxChannelF;}
\DoxyCodeLine{00746         outMf = upPix-\/>m + (1.0 -\/ umf\_norm) * downPix-\/>m;}
\DoxyCodeLine{00747 }
\DoxyCodeLine{00748         normalizer = outMf / (maxChannelF * mSumf);}
\DoxyCodeLine{00749         umdmf\_norm = umf\_norm * dmf\_norm;}
\DoxyCodeLine{00750 }
\DoxyCodeLine{00751         uf = upPix-\/>r + vf * umdmf\_norm, df = downPix-\/>r, ufdf = uf * df;}
\DoxyCodeLine{00752         outPix-\/>r = tcrop((uf * (maxChannelC -\/ downPix-\/>m) +}
\DoxyCodeLine{00753                            df * (maxChannelC -\/ upPix-\/>m) + ufdf + ufdf) *}
\DoxyCodeLine{00754                               normalizer,}
\DoxyCodeLine{00755                           0.0, outMf);}
\DoxyCodeLine{00756 }
\DoxyCodeLine{00757         uf = upPix-\/>g + vf * umdmf\_norm, df = downPix-\/>g, ufdf = uf * df;}
\DoxyCodeLine{00758         outPix-\/>g = tcrop((uf * (maxChannelC -\/ downPix-\/>m) +}
\DoxyCodeLine{00759                            df * (maxChannelC -\/ upPix-\/>m) + ufdf + ufdf) *}
\DoxyCodeLine{00760                               normalizer,}
\DoxyCodeLine{00761                           0.0, outMf);}
\DoxyCodeLine{00762 }
\DoxyCodeLine{00763         uf = upPix-\/>b + vf * umdmf\_norm, df = downPix-\/>b, ufdf = uf * df;}
\DoxyCodeLine{00764         outPix-\/>b = tcrop((uf * (maxChannelC -\/ downPix-\/>m) +}
\DoxyCodeLine{00765                            df * (maxChannelC -\/ upPix-\/>m) + ufdf + ufdf) *}
\DoxyCodeLine{00766                               normalizer,}
\DoxyCodeLine{00767                           0.0, outMf);}
\DoxyCodeLine{00768 }
\DoxyCodeLine{00769         outPix-\/>m = outMf;}
\DoxyCodeLine{00770       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00771         *outPix = TPixel64::Transparent;}
\DoxyCodeLine{00772 }
\DoxyCodeLine{00773       FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{00774     \}}
\DoxyCodeLine{00775 }
\DoxyCodeLine{00776     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00777   \}}
\DoxyCodeLine{00778 }
\DoxyCodeLine{00779   \textcolor{comment}{// According to the specifics, throw an exception. I think it's not}}
\DoxyCodeLine{00780   \textcolor{comment}{// appropriate, though.}}
\DoxyCodeLine{00781   \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::mult invalid raster combination"{}});}
\DoxyCodeLine{00782 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_ae5fd1fb0c2f625e1da14fe92ae0e5122}\label{namespace_t_rop_ae5fd1fb0c2f625e1da14fe92ae0e5122}} 
\index{TRop@{TRop}!over@{over}}
\index{over@{over}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{over()}{over()}\hspace{0.1cm}{\footnotesize\ttfamily [1/7]}}
{\footnotesize\ttfamily void TRop\+::over (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{out,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{dn,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{up }\end{DoxyParamCaption})}

Make the image over of the {\bfseries{up}} raster on the {\bfseries{dn}} raster and put the resulting raster in {\bfseries{rout}} 


\begin{DoxyCodeInclude}{0}

\end{DoxyCodeInclude}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{00286                                      \{}
\DoxyCodeLine{00287   \mbox{\hyperlink{class_t_rect_t}{TRect}} rect = rout-\/>getBounds() * rdn-\/>getBounds() * rup-\/>getBounds();}
\DoxyCodeLine{00288   \textcolor{keywordflow}{if} (rect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00289 }
\DoxyCodeLine{00290   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} cRout = rout-\/>extract(rect);}
\DoxyCodeLine{00291   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} cRdn  = rdn-\/>extract(rect);}
\DoxyCodeLine{00292   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} cRup  = rup-\/>extract(rect);}
\DoxyCodeLine{00293   rout-\/>lock();}
\DoxyCodeLine{00294   rdn-\/>lock();}
\DoxyCodeLine{00295   rup-\/>lock();}
\DoxyCodeLine{00296   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout32 = cRout, rdn32 = cRdn, rup32 = cRup;}
\DoxyCodeLine{00297   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rout64 = cRout, rdn64 = cRdn, rup64 = cRup;}
\DoxyCodeLine{00298   \textcolor{keywordflow}{if} (rout32 \&\& rdn32 \&\& rup32)}
\DoxyCodeLine{00299     do\_overT3<TPixel32>(rout32, rdn32, rup32);}
\DoxyCodeLine{00300   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rout64 \&\& rdn64 \&\& rup64)}
\DoxyCodeLine{00301     do\_overT3<TPixel64>(rout64, rdn64, rup64);}
\DoxyCodeLine{00302   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00303     rout-\/>unlock();}
\DoxyCodeLine{00304     rdn-\/>unlock();}
\DoxyCodeLine{00305     rup-\/>unlock();}
\DoxyCodeLine{00306     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}unsupported pixel type"{}});}
\DoxyCodeLine{00307   \}}
\DoxyCodeLine{00308 }
\DoxyCodeLine{00309   rout-\/>unlock();}
\DoxyCodeLine{00310   rdn-\/>unlock();}
\DoxyCodeLine{00311   rup-\/>unlock();}
\DoxyCodeLine{00312 \}}

\end{DoxyCode}


References \mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{TRect\+T$<$ T $>$\+::is\+Empty()}}.



Referenced by \mbox{\hyperlink{l00438}{over()}}, \mbox{\hyperlink{l00260}{Over\+Fx\+::process()}}, and \mbox{\hyperlink{l00711}{Toonz\+Scene\+::render\+Frame()}}.

\mbox{\Hypertarget{namespace_t_rop_a9f1ee78ab7b55ece2630b90c93ba339f}\label{namespace_t_rop_a9f1ee78ab7b55ece2630b90c93ba339f}} 
\index{TRop@{TRop}!over@{over}}
\index{over@{over}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{over()}{over()}\hspace{0.1cm}{\footnotesize\ttfamily [2/7]}}
{\footnotesize\ttfamily void TRop\+::over (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{out,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{dn,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{up,  }\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+GR8P}} \&}]{mask }\end{DoxyParamCaption})}

Make the image over of the {\bfseries{up}} raster on the {\bfseries{dn}} raster using a {\bfseries{mask}} and put the resulting raster in {\bfseries{rout}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{00476                                          \{}
\DoxyCodeLine{00477   out-\/>lock();}
\DoxyCodeLine{00478   up-\/>lock();}
\DoxyCodeLine{00479   dn-\/>lock();}
\DoxyCodeLine{00480 }
\DoxyCodeLine{00481   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32 = out;}
\DoxyCodeLine{00482   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} dn32  = dn;}
\DoxyCodeLine{00483   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32  = up;}
\DoxyCodeLine{00484 }
\DoxyCodeLine{00485   \textcolor{keywordflow}{if} (out32 \&\& dn32 \&\& up32)}
\DoxyCodeLine{00486     do\_over<TPixel32, TPixel32, TPixel32>(out32, dn32, up32, mask);}
\DoxyCodeLine{00487   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00488     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64 = out;}
\DoxyCodeLine{00489     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} dn64  = dn;}
\DoxyCodeLine{00490     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64  = up;}
\DoxyCodeLine{00491     \textcolor{keywordflow}{if} (out64 \&\& dn64 \&\& up64)}
\DoxyCodeLine{00492       do\_over<TPixel64, TPixel64, TPixel64>(out64, dn64, up64, mask);}
\DoxyCodeLine{00493     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00494       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}unsupported pixel type"{}});}
\DoxyCodeLine{00495   \}}
\DoxyCodeLine{00496   out-\/>unlock();}
\DoxyCodeLine{00497   up-\/>unlock();}
\DoxyCodeLine{00498   dn-\/>unlock();}
\DoxyCodeLine{00499 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a91b87be89fbd668e1e88bff94085b4ec}\label{namespace_t_rop_a91b87be89fbd668e1e88bff94085b4ec}} 
\index{TRop@{TRop}!over@{over}}
\index{over@{over}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{over()}{over()}\hspace{0.1cm}{\footnotesize\ttfamily [3/7]}}
{\footnotesize\ttfamily void TRop\+::over (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{out,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{up,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff,  }\item[{\mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}{Resample\+Filter\+Type}}}]{filter\+Type = {\ttfamily \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}{Triangle}}} }\end{DoxyParamCaption})}



Make the image over of the {\bfseries{up}} raster on the {\bfseries{out}} raster. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00417                                                \{}
\DoxyCodeLine{00418   out-\/>lock();}
\DoxyCodeLine{00419   up-\/>lock();}
\DoxyCodeLine{00420 }
\DoxyCodeLine{00421   \textcolor{keywordflow}{if} (filterType == ClosestPixel || filterType == Bilinear)}
\DoxyCodeLine{00422     ::quickPut(out, up, aff, filterType);}
\DoxyCodeLine{00423   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00424     \mbox{\hyperlink{class_t_rect_t}{TRect}} rasterBounds = up-\/>getBounds();}
\DoxyCodeLine{00425     \mbox{\hyperlink{class_t_rect_t}{TRectD}} dbounds(rasterBounds.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, rasterBounds.y0, rasterBounds.x1 + 1,}
\DoxyCodeLine{00426                    rasterBounds.y1 + 1);}
\DoxyCodeLine{00427     dbounds = aff * dbounds;}
\DoxyCodeLine{00428     \mbox{\hyperlink{class_t_rect_t}{TRect}} bounds(tfloor(dbounds.x0), tfloor(dbounds.y0), tceil(dbounds.x1) -\/ 1,}
\DoxyCodeLine{00429                  tceil(dbounds.y1) -\/ 1);}
\DoxyCodeLine{00430     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} tmp = up-\/>create(bounds.getLx(), bounds.getLy());}
\DoxyCodeLine{00431     \mbox{\hyperlink{namespace_t_rop_a5e39bc748039afe42001ba44f2d2a073}{resample}}(tmp, up, \mbox{\hyperlink{class_t_translation}{TTranslation}}(-\/bounds.x0, -\/bounds.y0) * aff, filterType);}
\DoxyCodeLine{00432     over(out, tmp, bounds.getP00());}
\DoxyCodeLine{00433   \}}
\DoxyCodeLine{00434   out-\/>unlock();}
\DoxyCodeLine{00435   up-\/>unlock();}
\DoxyCodeLine{00436 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00083}{Bilinear}}, \mbox{\hyperlink{l00081}{Closest\+Pixel}}, \mbox{\hyperlink{l04648}{resample()}}, and \mbox{\hyperlink{l00557}{TRect\+T$<$ T $>$\+::x0}}.

\mbox{\Hypertarget{namespace_t_rop_a744bf34f97ad2828655221fc27dffadf}\label{namespace_t_rop_a744bf34f97ad2828655221fc27dffadf}} 
\index{TRop@{TRop}!over@{over}}
\index{over@{over}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{over()}{over()}\hspace{0.1cm}{\footnotesize\ttfamily [4/7]}}
{\footnotesize\ttfamily void TRop\+::over (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{out,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{up,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff,  }\item[{\mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}{Resample\+Filter\+Type}}}]{filter\+Type = {\ttfamily \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}{Triangle}}} }\end{DoxyParamCaption})}

Make the image over of the {\bfseries{up}} raster on the {\bfseries{out}} raster starting from {\bfseries{pos}}. Position {\bfseries{pos}} must be already transformed using {\bfseries{aff}}. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00439                                                                    \{}
\DoxyCodeLine{00440   \textcolor{keywordflow}{if} (aff.\mbox{\hyperlink{class_t_affine_a5671bcda5ebc9262ec1681bb96cf8633}{isIdentity}}())}
\DoxyCodeLine{00441     \textcolor{comment}{// simple over with offset}}
\DoxyCodeLine{00442     \mbox{\hyperlink{namespace_t_rop_ae5fd1fb0c2f625e1da14fe92ae0e5122}{TRop::over}}(out, up, pos);}
\DoxyCodeLine{00443   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00444     \mbox{\hyperlink{class_t_rect_t}{TRect}} rasterBounds = up-\/>getBounds();}
\DoxyCodeLine{00445     \mbox{\hyperlink{class_t_rect_t}{TRectD}} dbounds(rasterBounds.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, rasterBounds.y0, rasterBounds.x1,}
\DoxyCodeLine{00446                    rasterBounds.y1);}
\DoxyCodeLine{00447     dbounds = aff * dbounds;}
\DoxyCodeLine{00448     \mbox{\hyperlink{class_t_rect_t}{TRect}} bounds(tfloor(dbounds.x0), tfloor(dbounds.y0), tceil(dbounds.x1),}
\DoxyCodeLine{00449                  tceil(dbounds.y1));}
\DoxyCodeLine{00450     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} tmp = up-\/>create(bounds.getLx(), bounds.getLy());}
\DoxyCodeLine{00451     \mbox{\hyperlink{namespace_t_rop_a5e39bc748039afe42001ba44f2d2a073}{resample}}(tmp, up, \mbox{\hyperlink{class_t_translation}{TTranslation}}(-\/dbounds.getP00()) * aff, filterType);}
\DoxyCodeLine{00452     \mbox{\hyperlink{namespace_t_rop_ae5fd1fb0c2f625e1da14fe92ae0e5122}{TRop::over}}(out, tmp, pos);}
\DoxyCodeLine{00453   \}}
\DoxyCodeLine{00454 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00096}{TAffine\+::is\+Identity()}}, \mbox{\hyperlink{l00285}{over()}}, \mbox{\hyperlink{l04648}{resample()}}, and \mbox{\hyperlink{l00557}{TRect\+T$<$ T $>$\+::x0}}.

\mbox{\Hypertarget{namespace_t_rop_aae58b5d8cb3097667c3d494780fa35b8}\label{namespace_t_rop_aae58b5d8cb3097667c3d494780fa35b8}} 
\index{TRop@{TRop}!over@{over}}
\index{over@{over}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{over()}{over()}\hspace{0.1cm}{\footnotesize\ttfamily [5/7]}}
{\footnotesize\ttfamily void TRop\+::over (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{out,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{up,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&}]{pos = {\ttfamily \mbox{\hyperlink{class_t_point_t}{TPoint}}()} }\end{DoxyParamCaption})}

Make the image over of the {\bfseries{up}} raster on the {\bfseries{out}} raster starting from {\bfseries{pos}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{00316                                                                             \{}
\DoxyCodeLine{00317   \mbox{\hyperlink{class_t_rect_t}{TRect}} outRect(rout-\/>getBounds());}
\DoxyCodeLine{00318   \mbox{\hyperlink{class_t_rect_t}{TRect}} upRect(rup-\/>getBounds() + pos);}
\DoxyCodeLine{00319   \mbox{\hyperlink{class_t_rect_t}{TRect}} intersection = outRect * upRect;}
\DoxyCodeLine{00320   \textcolor{keywordflow}{if} (intersection.isEmpty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00321 }
\DoxyCodeLine{00322   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} cRout = rout-\/>extract(intersection);}
\DoxyCodeLine{00323   \mbox{\hyperlink{class_t_rect_t}{TRect}} r        = intersection -\/ pos;}
\DoxyCodeLine{00324   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} cRup  = rup-\/>extract(r);}
\DoxyCodeLine{00325 }
\DoxyCodeLine{00326   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout32 = cRout, rup32 = cRup;}
\DoxyCodeLine{00327   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rout64 = cRout, rup64 = cRup;}
\DoxyCodeLine{00328 }
\DoxyCodeLine{00329   \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} rout8 = cRout, rup8 = cRup;}
\DoxyCodeLine{00330 }
\DoxyCodeLine{00331   \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} routCM32 = cRout, rupCM32 = cRup;}
\DoxyCodeLine{00332 }
\DoxyCodeLine{00333   rout-\/>lock();}
\DoxyCodeLine{00334   rup-\/>lock();}
\DoxyCodeLine{00335 }
\DoxyCodeLine{00336   \textcolor{comment}{// TRaster64P rout64 = rout, rin64 = rin;}}
\DoxyCodeLine{00337   \textcolor{keywordflow}{if} (rout32 \&\& rup32) \{}
\DoxyCodeLine{00338 \textcolor{preprocessor}{\#ifdef USE\_SSE2}}
\DoxyCodeLine{00339     \textcolor{keywordflow}{if} (TSystem::getCPUExtensions() \& TSystem::CpuSupportsSse2)}
\DoxyCodeLine{00340       do\_over\_SSE2(rout32, rup32);}
\DoxyCodeLine{00341     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00342 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00343       do\_overT2<TPixel32, UCHAR>(rout32, rup32);}
\DoxyCodeLine{00344   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rout64) \{}
\DoxyCodeLine{00345     \textcolor{keywordflow}{if} (!rup64) \{}
\DoxyCodeLine{00346       \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} raux(cRup-\/>getSize());}
\DoxyCodeLine{00347       \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(raux, cRup);}
\DoxyCodeLine{00348       rup64 = raux;}
\DoxyCodeLine{00349     \}}
\DoxyCodeLine{00350     do\_overT2<TPixel64, USHORT>(rout64, rup64);}
\DoxyCodeLine{00351   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rout32 \&\& rup8)}
\DoxyCodeLine{00352     do\_over(rout32, rup8);}
\DoxyCodeLine{00353   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rout8 \&\& rup32)}
\DoxyCodeLine{00354     do\_over(rout8, rup32);}
\DoxyCodeLine{00355   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rout8 \&\& rup8)}
\DoxyCodeLine{00356     \mbox{\hyperlink{namespace_t_rop_a229eb7fd85c23c325ea4ba55478d5712}{TRop::copy}}(rout8, rup8);}
\DoxyCodeLine{00357   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (routCM32 \&\& rupCM32)}
\DoxyCodeLine{00358     do\_over(routCM32, rupCM32);}
\DoxyCodeLine{00359   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00360     rout-\/>unlock();}
\DoxyCodeLine{00361     rup-\/>unlock();}
\DoxyCodeLine{00362     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}unsupported pixel type"{}});}
\DoxyCodeLine{00363   \}}
\DoxyCodeLine{00364 }
\DoxyCodeLine{00365   rout-\/>unlock();}
\DoxyCodeLine{00366   rup-\/>unlock();}
\DoxyCodeLine{00367 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00336}{convert()}}, and \mbox{\hyperlink{l00093}{copy()}}.

\mbox{\Hypertarget{namespace_t_rop_aedc165465ce6743825508055f5207aa8}\label{namespace_t_rop_aedc165465ce6743825508055f5207aa8}} 
\index{TRop@{TRop}!over@{over}}
\index{over@{over}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{over()}{over()}\hspace{0.1cm}{\footnotesize\ttfamily [6/7]}}
{\footnotesize\ttfamily void TRop\+::over (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}}]{rout,  }\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+GR8P}} \&}]{rup,  }\item[{const TPixel32 \&}]{color }\end{DoxyParamCaption})}

Make a coloring of {\bfseries{rup}} with {\bfseries{color}} and put the resulting raster in {\bfseries{rout}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{00277                                        \{}
\DoxyCodeLine{00278   rout-\/>lock();}
\DoxyCodeLine{00279   do\_over(rout, rup, color);}
\DoxyCodeLine{00280   rout-\/>unlock();}
\DoxyCodeLine{00281 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_ab40288730d28adc27b76cadca035beaa}\label{namespace_t_rop_ab40288730d28adc27b76cadca035beaa}} 
\index{TRop@{TRop}!over@{over}}
\index{over@{over}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{over()}{over()}\hspace{0.1cm}{\footnotesize\ttfamily [7/7]}}
{\footnotesize\ttfamily void TRop\+::over (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&}]{rup,  }\item[{\mbox{\hyperlink{class_t_palette}{TPalette}} $\ast$}]{palette,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&}]{point = {\ttfamily \mbox{\hyperlink{class_t_point_t}{TPoint}}()},  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff = {\ttfamily \mbox{\hyperlink{class_t_affine}{TAffine}}()} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00457                                                          \{}
\DoxyCodeLine{00458   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} app(rup-\/>getSize());}
\DoxyCodeLine{00459   \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(app, rup, palette);}
\DoxyCodeLine{00460   \mbox{\hyperlink{namespace_t_rop_ae5fd1fb0c2f625e1da14fe92ae0e5122}{TRop::over}}(rout, app, point, aff);}
\DoxyCodeLine{00461 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a73e7c02af837288795455fb0280ab614}\label{namespace_t_rop_a73e7c02af837288795455fb0280ab614}} 
\index{TRop@{TRop}!overlay@{overlay}}
\index{overlay@{overlay}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{overlay()}{overlay()}}
{\footnotesize\ttfamily void TRop\+::overlay (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01388                                          \{}
\DoxyCodeLine{01389   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{01390   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{01391   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{01392 }
\DoxyCodeLine{01393   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{01394     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{01395     \textcolor{keywordflow}{if} (upPix-\/>m) \{}
\DoxyCodeLine{01396       TPixel32 app;}
\DoxyCodeLine{01397       TPixel32 tmpPix, tmp2Pix;}
\DoxyCodeLine{01398       \textcolor{keywordflow}{if} (downPix-\/>m) \{}
\DoxyCodeLine{01399         tmpPix  = *downPix;}
\DoxyCodeLine{01400         tmp2Pix = depremultiply(*upPix);}
\DoxyCodeLine{01401         \textcolor{keywordflow}{if} (tmpPix.r < 128)}
\DoxyCodeLine{01402           app.r = troundp(2 * tmp2Pix.r * (tmpPix.r / 255.0));}
\DoxyCodeLine{01403         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01404           SHORT r =}
\DoxyCodeLine{01405               255 *}
\DoxyCodeLine{01406               (1 -\/ 2 * (1.0 -\/ tmpPix.r / 255.0) * (1.0 -\/ tmp2Pix.r / 255.0));}
\DoxyCodeLine{01407           app.r = (UCHAR)tcrop<SHORT>(r, 0, 255);}
\DoxyCodeLine{01408         \}}
\DoxyCodeLine{01409         \textcolor{keywordflow}{if} (tmpPix.g < 128)}
\DoxyCodeLine{01410           app.g = troundp(2 * tmp2Pix.g * (tmpPix.g / 255.0));}
\DoxyCodeLine{01411         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01412           SHORT g =}
\DoxyCodeLine{01413               255 *}
\DoxyCodeLine{01414               (1 -\/ 2 * (1.0 -\/ tmpPix.g / 255.0) * (1.0 -\/ tmp2Pix.g / 255.0));}
\DoxyCodeLine{01415           app.g = (UCHAR)tcrop<SHORT>(g, 0, 255);}
\DoxyCodeLine{01416         \}}
\DoxyCodeLine{01417         \textcolor{keywordflow}{if} (tmpPix.b < 128)}
\DoxyCodeLine{01418           app.b = troundp(2 * tmp2Pix.b * (tmpPix.b / 255.0));}
\DoxyCodeLine{01419         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01420           SHORT b =}
\DoxyCodeLine{01421               255 *}
\DoxyCodeLine{01422               (1 -\/ 2 * (1.0 -\/ tmpPix.b / 255.0) * (1.0 -\/ tmp2Pix.b / 255.0));}
\DoxyCodeLine{01423           app.b = (UCHAR)tcrop<SHORT>(b, 0, 255);}
\DoxyCodeLine{01424         \}}
\DoxyCodeLine{01425         app.m = tmp2Pix.m;}
\DoxyCodeLine{01426         app   = premultiply(app);}
\DoxyCodeLine{01427       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01428         app = *upPix;}
\DoxyCodeLine{01429       overPix<TPixel32, UCHAR>(*outPix, *downPix, app);}
\DoxyCodeLine{01430     \}}
\DoxyCodeLine{01431     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{01432   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01433     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{01434     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{01435     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{01436 }
\DoxyCodeLine{01437     \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{01438       FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{01439 }
\DoxyCodeLine{01440       \textcolor{keywordflow}{if} (upPix-\/>m) \{}
\DoxyCodeLine{01441         TPixel64 app;}
\DoxyCodeLine{01442         TPixel64 tmpPix, tmp2Pix;}
\DoxyCodeLine{01443         \textcolor{keywordflow}{if} (downPix-\/>m) \{}
\DoxyCodeLine{01444           tmpPix  = *downPix;}
\DoxyCodeLine{01445           tmp2Pix = depremultiply(*upPix);}
\DoxyCodeLine{01446           \textcolor{keywordflow}{if} (tmpPix.r < 32768)}
\DoxyCodeLine{01447             app.r = troundp(2 * tmp2Pix.r * (tmpPix.r / 65535.0));}
\DoxyCodeLine{01448           \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01449             SHORT r = 65535 * (1 -\/}
\DoxyCodeLine{01450                                2 * (1.0 -\/ tmpPix.r / 65535.0) *}
\DoxyCodeLine{01451                                    (1.0 -\/ tmp2Pix.r / 65535.0));}
\DoxyCodeLine{01452             app.r = (USHORT)tcrop<TINT32>(r, 0, 65535);}
\DoxyCodeLine{01453           \}}
\DoxyCodeLine{01454           \textcolor{keywordflow}{if} (tmpPix.g < 32768)}
\DoxyCodeLine{01455             app.g = troundp(2 * tmp2Pix.g * (tmpPix.g / 65535.0));}
\DoxyCodeLine{01456           \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01457             SHORT g = 65535 * (1 -\/}
\DoxyCodeLine{01458                                2 * (1.0 -\/ tmpPix.g / 65535.0) *}
\DoxyCodeLine{01459                                    (1.0 -\/ tmp2Pix.g / 65535.0));}
\DoxyCodeLine{01460             app.g = (USHORT)tcrop<TINT32>(g, 0, 65535);}
\DoxyCodeLine{01461           \}}
\DoxyCodeLine{01462           \textcolor{keywordflow}{if} (tmpPix.b < 32768)}
\DoxyCodeLine{01463             app.b = troundp(2 * tmp2Pix.b * (tmpPix.b / 65535.0));}
\DoxyCodeLine{01464           \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01465             SHORT b = 65535 * (1 -\/}
\DoxyCodeLine{01466                                2 * (1.0 -\/ tmpPix.b / 65535.0) *}
\DoxyCodeLine{01467                                    (1.0 -\/ tmp2Pix.b / 65535.0));}
\DoxyCodeLine{01468             app.b = (USHORT)tcrop<TINT32>(b, 0, 65535);}
\DoxyCodeLine{01469           \}}
\DoxyCodeLine{01470           app.m = tmp2Pix.m;}
\DoxyCodeLine{01471           app   = premultiply(app);}
\DoxyCodeLine{01472         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01473           app = *upPix;}
\DoxyCodeLine{01474         overPix<TPixel64, USHORT>(*outPix, *downPix, app);}
\DoxyCodeLine{01475       \}}
\DoxyCodeLine{01476       FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{01477     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01478       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} up8   = rup;}
\DoxyCodeLine{01479       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} down8 = rdown;}
\DoxyCodeLine{01480       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} out8  = rout;}
\DoxyCodeLine{01481 }
\DoxyCodeLine{01482       \textcolor{keywordflow}{if} (up8 \&\& down8 \&\& out8) \{}
\DoxyCodeLine{01483         FOR\_EACH\_PIXEL\_8\_BEGIN\_LOOP}
\DoxyCodeLine{01484 }
\DoxyCodeLine{01485         USHORT value;}
\DoxyCodeLine{01486         \textcolor{keywordflow}{if} (downPix-\/>value < 128)}
\DoxyCodeLine{01487           value = troundp(2 * upPix-\/>value * (downPix-\/>value / 255.0));}
\DoxyCodeLine{01488         \textcolor{keywordflow}{else}}
\DoxyCodeLine{01489           value = 255 * (1 -\/}
\DoxyCodeLine{01490                          2 * (1.0 -\/ downPix-\/>value / 255.0) *}
\DoxyCodeLine{01491                              (1.0 -\/ upPix-\/>value / 255.0));}
\DoxyCodeLine{01492         outPix-\/>value = (UCHAR)tcrop<USHORT>(value, 0, 255);}
\DoxyCodeLine{01493 }
\DoxyCodeLine{01494         FOR\_EACH\_PIXEL\_8\_END\_LOOP}
\DoxyCodeLine{01495       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01496         \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::max invalid raster combination"{}});}
\DoxyCodeLine{01497     \}}
\DoxyCodeLine{01498   \}}
\DoxyCodeLine{01499 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a98a26ca9c2980b8a0a33ee8475f7db64}\label{namespace_t_rop_a98a26ca9c2980b8a0a33ee8475f7db64}} 
\index{TRop@{TRop}!overlayCmapped@{overlayCmapped}}
\index{overlayCmapped@{overlayCmapped}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{overlayCmapped()}{overlayCmapped()}}
{\footnotesize\ttfamily void TRop\+::overlay\+Cmapped (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}}}]{ras\+Out,  }\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&}]{ras\+Up,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{plt\+Out,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{up\+Plt,  }\item[{std\+::map$<$ int, int $>$ \&}]{used\+Colors }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00913                                                         \{}
\DoxyCodeLine{00914   assert(rasOut \&\& rasUp);}
\DoxyCodeLine{00915   assert(rasOut-\/>getSize() == rasUp-\/>getSize());}
\DoxyCodeLine{00916 }
\DoxyCodeLine{00917   \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} downPlt = pltOut-\/>\mbox{\hyperlink{class_t_palette_abc3ef5824d89e65687b32c530cf25325}{clone}}();}
\DoxyCodeLine{00918   std::map<int, int>::iterator it;}
\DoxyCodeLine{00919   \textcolor{keywordflow}{for} (it = usedColors.begin(); it != usedColors.end(); it++)}
\DoxyCodeLine{00920     downPlt-\/>\mbox{\hyperlink{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}{getPage}}(0)-\/>\mbox{\hyperlink{class_t_palette_1_1_page_a6836aae497ab21f4ec1af5f026c68d5f}{addStyle}}(TPixel32::Red);}
\DoxyCodeLine{00921 }
\DoxyCodeLine{00922   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < rasOut-\/>getLy(); y++) \{}
\DoxyCodeLine{00923     \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *pixDown = rasOut-\/>pixels(y);}
\DoxyCodeLine{00924     \mbox{\hyperlink{class_t_pixel_c_m32}{TPixelCM32}} *pixUp   = rasUp-\/>pixels(y);}
\DoxyCodeLine{00925 }
\DoxyCodeLine{00926     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = 0; x < rasOut-\/>getLx(); x++, pixUp++, pixDown++) \{}
\DoxyCodeLine{00927       \textcolor{keywordflow}{if} (isTransparent(pixUp))  \textcolor{comment}{// WARNING! cannot check transparent pixels}}
\DoxyCodeLine{00928                                  \textcolor{comment}{// with *pixup==TPixelCM32() since also}}
\DoxyCodeLine{00929                                  \textcolor{comment}{// 0x183000ff i.e., is a valid transparent}}
\DoxyCodeLine{00930                                  \textcolor{comment}{// value}}
\DoxyCodeLine{00931         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00932       \textcolor{keywordtype}{int} tone = pixUp-\/>getTone();}
\DoxyCodeLine{00933       \textcolor{keywordflow}{if} (isTransparent(pixDown) || tone == 255 || tone == 0 ||}
\DoxyCodeLine{00934           pixUp-\/>getPaint() !=}
\DoxyCodeLine{00935               0)  \textcolor{comment}{// up e' punto interno, o esterno non antialiasato}}
\DoxyCodeLine{00936       \{}
\DoxyCodeLine{00937         addColors(*pixUp, downPlt, upPlt, usedColors);}
\DoxyCodeLine{00938         pixDown-\/>setInk(usedColors[pixUp-\/>getInk()]);}
\DoxyCodeLine{00939         pixDown-\/>setPaint(usedColors[pixUp-\/>getPaint()]);}
\DoxyCodeLine{00940         pixDown-\/>setTone(tone);}
\DoxyCodeLine{00941       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tone <= pixDown-\/>getTone() || tone < 128)  \textcolor{comment}{// up e' bordo}}
\DoxyCodeLine{00942                                                             \textcolor{comment}{// esterno}}
\DoxyCodeLine{00943                                                             \textcolor{comment}{// antialiasato piu'}}
\DoxyCodeLine{00944                                                             \textcolor{comment}{// opaco di down}}
\DoxyCodeLine{00945       \{}
\DoxyCodeLine{00946         \textcolor{keywordtype}{int} ink = pixUp-\/>getInk();}
\DoxyCodeLine{00947         \textcolor{keywordflow}{if} (usedColors.find(ink) == usedColors.end())}
\DoxyCodeLine{00948           addColor(downPlt, ink, upPlt, usedColors);}
\DoxyCodeLine{00949         pixDown-\/>setInk(usedColors[ink]);}
\DoxyCodeLine{00950         pixDown-\/>setTone(tone < 128 ? 0 : tone);}
\DoxyCodeLine{00951       \}}
\DoxyCodeLine{00952     \}}
\DoxyCodeLine{00953   \}}
\DoxyCodeLine{00954 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_aa8671761db1d55d696b4b8bb71f8b2e4}\label{namespace_t_rop_aa8671761db1d55d696b4b8bb71f8b2e4}} 
\index{TRop@{TRop}!premultiply@{premultiply}}
\index{premultiply@{premultiply}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{premultiply()}{premultiply()}}
{\footnotesize\ttfamily void TRop\+::premultiply (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{ras }\end{DoxyParamCaption})}



Make a premultiply of all raster pixels. 


\begin{DoxyCode}{0}
\DoxyCodeLine{01503                                           \{}
\DoxyCodeLine{01504   ras-\/>lock();}
\DoxyCodeLine{01505   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = ras;}
\DoxyCodeLine{01506   \textcolor{keywordflow}{if} (ras32) \{}
\DoxyCodeLine{01507     TPixel32 *endPix, *upPix = 0, *upRow = ras32-\/>pixels();}
\DoxyCodeLine{01508     TPixel32 *lastPix =}
\DoxyCodeLine{01509         upRow + ras32-\/>getWrap() * (ras32-\/>getLy() -\/ 1) + ras32-\/>getLx();}
\DoxyCodeLine{01510 }
\DoxyCodeLine{01511     \textcolor{keywordflow}{while} (upPix < lastPix) \{}
\DoxyCodeLine{01512       upPix  = upRow;}
\DoxyCodeLine{01513       endPix = upPix + ras32-\/>getLx();}
\DoxyCodeLine{01514       \textcolor{keywordflow}{while} (upPix < endPix) \{}
\DoxyCodeLine{01515         premult(*upPix);}
\DoxyCodeLine{01516         ++upPix;}
\DoxyCodeLine{01517       \}}
\DoxyCodeLine{01518       upRow += ras32-\/>getWrap();}
\DoxyCodeLine{01519     \}}
\DoxyCodeLine{01520   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01521     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} ras64 = ras;}
\DoxyCodeLine{01522     \textcolor{keywordflow}{if} (ras64) \{}
\DoxyCodeLine{01523       TPixel64 *endPix, *upPix = 0, *upRow = ras64-\/>pixels();}
\DoxyCodeLine{01524       TPixel64 *lastPix =}
\DoxyCodeLine{01525           upRow + ras64-\/>getWrap() * (ras64-\/>getLy() -\/ 1) + ras64-\/>getLx();}
\DoxyCodeLine{01526 }
\DoxyCodeLine{01527       \textcolor{keywordflow}{while} (upPix < lastPix) \{}
\DoxyCodeLine{01528         upPix  = upRow;}
\DoxyCodeLine{01529         endPix = upPix + ras64-\/>getLx();}
\DoxyCodeLine{01530         \textcolor{keywordflow}{while} (upPix < endPix) \{}
\DoxyCodeLine{01531           premult(*upPix);}
\DoxyCodeLine{01532           ++upPix;}
\DoxyCodeLine{01533         \}}
\DoxyCodeLine{01534         upRow += ras64-\/>getWrap();}
\DoxyCodeLine{01535       \}}
\DoxyCodeLine{01536     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01537       ras-\/>unlock();}
\DoxyCodeLine{01538       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}TRop::premultiply invalid raster type"{}});}
\DoxyCodeLine{01539     \}}
\DoxyCodeLine{01540   \}}
\DoxyCodeLine{01541   ras-\/>unlock();}
\DoxyCodeLine{01542 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l01694}{apply\+Color\+Scale()}}.

\mbox{\Hypertarget{namespace_t_rop_a43c9517b928a4d6c9fb68867884a22ce}\label{namespace_t_rop_a43c9517b928a4d6c9fb68867884a22ce}} 
\index{TRop@{TRop}!quickPut@{quickPut}}
\index{quickPut@{quickPut}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{quickPut()}{quickPut()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void TRop\+::quick\+Put (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{dn,  }\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&}]{up\+CM32,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{plt,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff,  }\item[{const \mbox{\hyperlink{class_t_rop_1_1_cmapped_quickput_settings}{Cmapped\+Quickput\+Settings}} \&}]{settings }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{04668 \{}
\DoxyCodeLine{04669   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} dn32 = dn;}
\DoxyCodeLine{04670   \textcolor{keywordflow}{if} (dn32 \&\& upCM32)}
\DoxyCodeLine{04671     doQuickPutCmapped(dn32, upCM32, plt, aff,}
\DoxyCodeLine{04672                       settings);  \textcolor{comment}{// globalColorScale, inksOnly,}}
\DoxyCodeLine{04673                                   \textcolor{comment}{// transparencyCheck, blackBgCheck, inkIndex,}}
\DoxyCodeLine{04674                                   \textcolor{comment}{// paintIndex);}}
\DoxyCodeLine{04675   \textcolor{keywordflow}{else}}
\DoxyCodeLine{04676     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}raster type mismatch"{}});}
\DoxyCodeLine{04677 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_af44cb7fab841ce051f1414a5828bfbff}\label{namespace_t_rop_af44cb7fab841ce051f1414a5828bfbff}} 
\index{TRop@{TRop}!quickPut@{quickPut}}
\index{quickPut@{quickPut}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{quickPut()}{quickPut()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void TRop\+::quick\+Put (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{out,  }\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&}]{up,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{plt,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff,  }\item[{const TPixel32 \&}]{global\+Color\+Scale = {\ttfamily TPixel\+:\+:Black},  }\item[{bool}]{inks\+Only = {\ttfamily false} }\end{DoxyParamCaption})}



Like the over function but up image must be cmapped. 

Only uses closest\+\_\+pixel filter. Global\+Matte is the opacity, used for onionskinning 
\begin{DoxyCode}{0}
\DoxyCodeLine{04642                                                                      \{}
\DoxyCodeLine{04643   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} dn32 = dn;}
\DoxyCodeLine{04644   \textcolor{keywordflow}{if} (dn32 \&\& upCM32)}
\DoxyCodeLine{04645     \textcolor{keywordflow}{if} (areAlmostEqual(aff.a12, 0) \&\& areAlmostEqual(aff.a21, 0))}
\DoxyCodeLine{04646       doQuickPutCmapped(dn32, upCM32, plt, aff.a11, aff.a22, aff.a13, aff.a23,}
\DoxyCodeLine{04647                         globalColorScale, inksOnly);}
\DoxyCodeLine{04648     \textcolor{keywordflow}{else}}
\DoxyCodeLine{04649       doQuickPutCmapped(dn32, upCM32, plt, aff, globalColorScale, inksOnly);}
\DoxyCodeLine{04650   \textcolor{keywordflow}{else}}
\DoxyCodeLine{04651     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}raster type mismatch"{}});}
\DoxyCodeLine{04652 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a1f6b04b4725e957a0d554e198e26a117}\label{namespace_t_rop_a1f6b04b4725e957a0d554e198e26a117}} 
\index{TRop@{TRop}!quickPut@{quickPut}}
\index{quickPut@{quickPut}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{quickPut()}{quickPut()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void TRop\+::quick\+Put (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{out,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{up,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff,  }\item[{const TPixel32 \&}]{color\+Scale = {\ttfamily TPixel\+:\+:Black},  }\item[{bool}]{do\+Premultiply = {\ttfamily false},  }\item[{bool}]{white\+Transp = {\ttfamily false},  }\item[{bool}]{first\+Column = {\ttfamily false},  }\item[{bool}]{do\+Raster\+Darken\+Blended\+View = {\ttfamily false} }\end{DoxyParamCaption})}



Like the over function, but only uses closest\+\_\+pixel filter. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00468                                                     \{}
\DoxyCodeLine{00469   ::quickPut(out, up, aff, ClosestPixel, colorScale, doPremultiply, whiteTransp,}
\DoxyCodeLine{00470              firstColumn, doRasterDarkenBlendedView);}
\DoxyCodeLine{00471 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00081}{Closest\+Pixel}}, and \mbox{\hyperlink{l01651}{white\+Transp()}}.

\mbox{\Hypertarget{namespace_t_rop_a709bde5ef9b1c9a1b205855f9e8f7329}\label{namespace_t_rop_a709bde5ef9b1c9a1b205855f9e8f7329}} 
\index{TRop@{TRop}!quickResampleColorFilter@{quickResampleColorFilter}}
\index{quickResampleColorFilter@{quickResampleColorFilter}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{quickResampleColorFilter()}{quickResampleColorFilter()}}
{\footnotesize\ttfamily void TRop\+::quick\+Resample\+Color\+Filter (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{dn,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{up,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{plt,  }\item[{UCHAR}]{color\+Mask }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{04681                                                      \{}
\DoxyCodeLine{04682   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} dn32     = dn;}
\DoxyCodeLine{04683   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32     = up;}
\DoxyCodeLine{04684   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64     = up;}
\DoxyCodeLine{04685   \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} upCM32 = up;}
\DoxyCodeLine{04686   \textcolor{keywordflow}{if} (dn32 \&\& up32)}
\DoxyCodeLine{04687     doQuickResampleColorFilter(dn32, up32, aff, colorMask);}
\DoxyCodeLine{04688   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dn32 \&\& upCM32)}
\DoxyCodeLine{04689     doQuickResampleColorFilter(dn32, upCM32, plt, aff, colorMask);}
\DoxyCodeLine{04690   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dn32 \&\& up64)}
\DoxyCodeLine{04691     doQuickResampleColorFilter(dn32, up64, aff, colorMask);}
\DoxyCodeLine{04692   \textcolor{comment}{// else if (dn32 \&\& upCM32)}}
\DoxyCodeLine{04693   \textcolor{comment}{//  doQuickResampleColorFilter(dn32, upCM32, aff, plt, colorMask);}}
\DoxyCodeLine{04694   \textcolor{keywordflow}{else}}
\DoxyCodeLine{04695     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}raster type mismatch"{}});}
\DoxyCodeLine{04696 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_ac6e615dabc3bd3a4f7681ca7d0a743f1}\label{namespace_t_rop_ac6e615dabc3bd3a4f7681ca7d0a743f1}} 
\index{TRop@{TRop}!raylit@{raylit}}
\index{raylit@{raylit}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{raylit()}{raylit()}}
{\footnotesize\ttfamily void TRop\+::raylit (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{dst\+Ras,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{src\+Ras,  }\item[{const \mbox{\hyperlink{struct_t_rop_1_1_raylit_params}{Raylit\+Params}} \&}]{params }\end{DoxyParamCaption})}



Make raylit effect on {\bfseries{src\+Ras}} raster and put the result in {\bfseries{dst\+Ras}}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00457                                               \{}
\DoxyCodeLine{00458   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})dstRas \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})srcRas)}
\DoxyCodeLine{00459     doRaylit<TPixel32>(srcRas, dstRas, params,}
\DoxyCodeLine{00460                        \&performStandardRaylit<TPixel32>);}
\DoxyCodeLine{00461   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})dstRas \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})srcRas)}
\DoxyCodeLine{00462     doRaylit<TPixel64>(srcRas, dstRas, params,}
\DoxyCodeLine{00463                        \&performStandardRaylit<TPixel64>);}
\DoxyCodeLine{00464   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00465     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}TRop::raylit unsupported pixel type"{}});}
\DoxyCodeLine{00466 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a275dd3a1daddba779d05f13b89b44db1}\label{namespace_t_rop_a275dd3a1daddba779d05f13b89b44db1}} 
\index{TRop@{TRop}!readRaster46@{readRaster46}}
\index{readRaster46@{readRaster46}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{readRaster46()}{readRaster46()}}
{\footnotesize\ttfamily \mbox{\hyperlink{struct___r_a_s_t_e_r}{\+\_\+\+RASTER}} $\ast$ TRop\+::read\+Raster46 (\begin{DoxyParamCaption}\item[{const char $\ast$}]{filename }\end{DoxyParamCaption})}



Read an image in the path {\bfseries{filename}} and put it in an old toonz raster. 


\begin{DoxyCode}{0}
\DoxyCodeLine{01176                                                 \{}
\DoxyCodeLine{01177   \textcolor{comment}{// No more called in Toonz...}}
\DoxyCodeLine{01178 }
\DoxyCodeLine{01179   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img;}
\DoxyCodeLine{01180 }
\DoxyCodeLine{01181   \mbox{\hyperlink{class_t_image_reader_ade3cafcda8a3e691b08892fb9cb3a97a}{TImageReader::load}}(\mbox{\hyperlink{class_t_file_path}{TFilePath}}(filename), img);}
\DoxyCodeLine{01182 }
\DoxyCodeLine{01183   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}})img) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{01184 }
\DoxyCodeLine{01185   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} rimg = (\mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}})img;}
\DoxyCodeLine{01186 }
\DoxyCodeLine{01187   \textcolor{keywordflow}{if} (!rimg) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{01188   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} ras = rimg-\/>getRaster();}
\DoxyCodeLine{01189 }
\DoxyCodeLine{01190   \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_t_rop_a6fc864590b3faf072c5468255ee9f3ea}{TRop::convertRaster50to46}}(ras, 0);}
\DoxyCodeLine{01191 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l01043}{convert\+Raster50to46()}}, and \mbox{\hyperlink{l00155}{TImage\+Reader\+::load()}}.

\mbox{\Hypertarget{namespace_t_rop_a8d7ac440af02d94cf688b9273e5a7d42}\label{namespace_t_rop_a8d7ac440af02d94cf688b9273e5a7d42}} 
\index{TRop@{TRop}!releaseRaster46@{releaseRaster46}}
\index{releaseRaster46@{releaseRaster46}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{releaseRaster46()}{releaseRaster46()}}
{\footnotesize\ttfamily void TRop\+::release\+Raster46 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct___r_a_s_t_e_r}{\+\_\+\+RASTER}} $\ast$\&}]{r,  }\item[{bool}]{do\+Release\+Buffer = {\ttfamily false} }\end{DoxyParamCaption})}



Release the old toonz raster. 

If the {\bfseries{do\+Release\+Buffer}} is true, the buffer is released (the palette is always deleted!) 
\begin{DoxyCode}{0}
\DoxyCodeLine{01119                                                             \{}
\DoxyCodeLine{01120   \textcolor{comment}{// Buffer release no more supported. These are now intended as smart}}
\DoxyCodeLine{01121   \textcolor{comment}{// pointers to rasters -\/ they release themselves on their own.}}
\DoxyCodeLine{01122   assert(!doReleaseBuffer);}
\DoxyCodeLine{01123 }
\DoxyCodeLine{01124   \textcolor{keywordflow}{if} (r-\/>type == RAS\_CM32) \{}
\DoxyCodeLine{01125     \textcolor{keyword}{delete}[] r-\/>cmap.buffer;}
\DoxyCodeLine{01126     \textcolor{comment}{// delete [] r-\/>cmap.penbuffer;}}
\DoxyCodeLine{01127     \textcolor{comment}{// delete [] r-\/>cmap.colbuffer;}}
\DoxyCodeLine{01128   \}}
\DoxyCodeLine{01129 }
\DoxyCodeLine{01130   \textcolor{keywordflow}{if} (doReleaseBuffer \&\& r-\/>native\_buffer == r-\/>buffer)}
\DoxyCodeLine{01131     \textcolor{keyword}{delete} r-\/>buffer;  \textcolor{comment}{// Should not happen}}
\DoxyCodeLine{01132 }
\DoxyCodeLine{01133   \textcolor{comment}{// Unlock if locked, and remove the cache reference}}
\DoxyCodeLine{01134   \textcolor{keywordflow}{if} (r-\/>buffer) unlockRaster(r);}
\DoxyCodeLine{01135   TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a57d63227dfe2532b0aed22c47113be66}{remove}}(std::string(r-\/>cacheId, r-\/>cacheIdLength));}
\DoxyCodeLine{01136   \textcolor{keyword}{delete}[] r-\/>cacheId;}
\DoxyCodeLine{01137 }
\DoxyCodeLine{01138   \textcolor{keyword}{delete} r;}
\DoxyCodeLine{01139   r = 0;}
\DoxyCodeLine{01140 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l01260}{TImage\+Cache\+::remove()}}, and \mbox{\hyperlink{l01161}{unlock\+Raster()}}.

\mbox{\Hypertarget{namespace_t_rop_ab35a3fe8769547a6b9cdd219a630a296}\label{namespace_t_rop_ab35a3fe8769547a6b9cdd219a630a296}} 
\index{TRop@{TRop}!resample@{resample}}
\index{resample@{resample}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{resample()}{resample()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void TRop\+::resample (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{out,  }\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster\+CM32P}} \&}]{in,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}}}]{palette,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff,  }\item[{\mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}{TRop\+::\+Resample\+Filter\+Type}}}]{filter\+Type = {\ttfamily \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}{Triangle}}},  }\item[{double}]{blur = {\ttfamily 1.} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{04622                                                                     \{}
\DoxyCodeLine{04623   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rin      = in;}
\DoxyCodeLine{04624   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout32 = out;}
\DoxyCodeLine{04625   in-\/>lock();}
\DoxyCodeLine{04626   out-\/>lock();}
\DoxyCodeLine{04627   \textcolor{keywordflow}{if} (rout32)}
\DoxyCodeLine{04628     rop\_resample\_rgbm\_2<TPixel32>(rout32, rin, aff, filterType, blur,}
\DoxyCodeLine{04629                                   palette.getPointer());}
\DoxyCodeLine{04630   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{04631     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rout64 = out;}
\DoxyCodeLine{04632     \textcolor{keywordflow}{if} (rout64)}
\DoxyCodeLine{04633       rop\_resample\_rgbm\_2<TPixel64>(rout64, rin, aff, filterType, blur,}
\DoxyCodeLine{04634                                     palette.getPointer());}
\DoxyCodeLine{04635     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{04636       in-\/>unlock();}
\DoxyCodeLine{04637       out-\/>unlock();}
\DoxyCodeLine{04638       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}unsupported pixel type"{}});}
\DoxyCodeLine{04639       \textcolor{keywordflow}{return};}
\DoxyCodeLine{04640     \}}
\DoxyCodeLine{04641   \}}
\DoxyCodeLine{04642   in-\/>unlock();}
\DoxyCodeLine{04643   out-\/>unlock();}
\DoxyCodeLine{04644 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a5e39bc748039afe42001ba44f2d2a073}\label{namespace_t_rop_a5e39bc748039afe42001ba44f2d2a073}} 
\index{TRop@{TRop}!resample@{resample}}
\index{resample@{resample}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{resample()}{resample()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void TRop\+::resample (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{out,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{in,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff,  }\item[{\mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168}{Resample\+Filter\+Type}}}]{filter\+Type = {\ttfamily \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}{Triangle}}},  }\item[{double}]{blur = {\ttfamily 1.} }\end{DoxyParamCaption})}

Apply the transformation {\bfseries{aff}} to the raster {\bfseries{in}} and put the resulting raster in {\bfseries{rout}} 

It can be specified a resample filter type and a blur factor. 
\begin{DoxyCodeInclude}{0}

\end{DoxyCodeInclude}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{04650                                  \{}
\DoxyCodeLine{04651   rin-\/>lock();}
\DoxyCodeLine{04652   rout-\/>lock();}
\DoxyCodeLine{04653 }
\DoxyCodeLine{04654   \textcolor{keywordflow}{if} (filterType == ClosestPixel || filterType == Bilinear) \{}
\DoxyCodeLine{04655     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})rout || (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})rin)}
\DoxyCodeLine{04656       filterType = \mbox{\hyperlink{namespace_t_rop_a2780cb0189f5717b67b6aca3f5471168af59a8bad64d2b117020f864efd67b2b5}{Triangle}};}
\DoxyCodeLine{04657     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{04658       quickResample(rout, rin, aff, filterType);}
\DoxyCodeLine{04659       rin-\/>unlock();}
\DoxyCodeLine{04660       rout-\/>unlock();}
\DoxyCodeLine{04661       \textcolor{keywordflow}{return};}
\DoxyCodeLine{04662     \}}
\DoxyCodeLine{04663   \}}
\DoxyCodeLine{04664 }
\DoxyCodeLine{04665   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rout32 = rout, rin32 = rin;}
\DoxyCodeLine{04666   \textcolor{keywordflow}{if} (rout32) \{}
\DoxyCodeLine{04667     \textcolor{keywordflow}{if} (!rin32) \{}
\DoxyCodeLine{04668       rin32 = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}(rin-\/>getLx(), rin-\/>getLy());}
\DoxyCodeLine{04669       \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(rin32, rin);}
\DoxyCodeLine{04670     \}}
\DoxyCodeLine{04671     do\_resample<TPixel32>(rout32, rin32, aff, filterType, blur);}
\DoxyCodeLine{04672   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{04673 \textcolor{preprocessor}{\#ifndef TNZCORE\_LIGHT}}
\DoxyCodeLine{04674     \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}} routCM32 = rout, rinCM32 = rin;}
\DoxyCodeLine{04675     \textcolor{keywordflow}{if} (routCM32 \&\& rinCM32)}
\DoxyCodeLine{04676       do\_resample(routCM32, rinCM32, aff);}
\DoxyCodeLine{04677     \textcolor{keywordflow}{else}}
\DoxyCodeLine{04678 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04679     \{}
\DoxyCodeLine{04680       \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rout64 = rout, rin64 = rin;}
\DoxyCodeLine{04681       \textcolor{keywordflow}{if} (rout64) \{}
\DoxyCodeLine{04682         \textcolor{keywordflow}{if} (!rin64) \{}
\DoxyCodeLine{04683           rin64 = \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}}(rin-\/>getLx(), rin-\/>getLy());}
\DoxyCodeLine{04684           \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(rin64, rin);}
\DoxyCodeLine{04685         \}}
\DoxyCodeLine{04686         do\_resample<TPixel64>(rout64, rin64, aff, filterType, blur);}
\DoxyCodeLine{04687       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{04688         \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} routGR8 = rout, rinGR8 = rin;}
\DoxyCodeLine{04689         \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rin32 = rin;}
\DoxyCodeLine{04690         \textcolor{keywordflow}{if} (routGR8 \&\& rinGR8)}
\DoxyCodeLine{04691           do\_resample(routGR8, rinGR8, aff, filterType, blur);}
\DoxyCodeLine{04692         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (routGR8 \&\& rin32)}
\DoxyCodeLine{04693           do\_resample(routGR8, rin32, aff, filterType, blur);}
\DoxyCodeLine{04694         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{04695           rin-\/>unlock();}
\DoxyCodeLine{04696           rout-\/>unlock();}
\DoxyCodeLine{04697           \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}unsupported pixel type"{}});}
\DoxyCodeLine{04698         \}}
\DoxyCodeLine{04699       \}}
\DoxyCodeLine{04700     \}}
\DoxyCodeLine{04701   \}}
\DoxyCodeLine{04702   rin-\/>unlock();}
\DoxyCodeLine{04703   rout-\/>unlock();}
\DoxyCodeLine{04704 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00083}{Bilinear}}, \mbox{\hyperlink{l00081}{Closest\+Pixel}}, \mbox{\hyperlink{l00336}{convert()}}, and \mbox{\hyperlink{l00057}{Triangle}}.



Referenced by \mbox{\hyperlink{l00076}{TRaster\+Image\+::make\+Icon()}}, \mbox{\hyperlink{l00416}{over()}}, \mbox{\hyperlink{l00569}{TCleanupper\+::process()}}, and \mbox{\hyperlink{l00086}{Custom\+Style\+Manager\+::\+Style\+Loader\+Task\+::run()}}.

\mbox{\Hypertarget{namespace_t_rop_ae2160d9b4cacd0527c741e83181f17be}\label{namespace_t_rop_ae2160d9b4cacd0527c741e83181f17be}} 
\index{TRop@{TRop}!rgbmAdjust@{rgbmAdjust}}
\index{rgbmAdjust@{rgbmAdjust}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{rgbmAdjust()}{rgbmAdjust()}}
{\footnotesize\ttfamily void TRop\+::rgbm\+Adjust (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rin,  }\item[{const int $\ast$}]{in0,  }\item[{const int $\ast$}]{in1,  }\item[{const int $\ast$}]{out0,  }\item[{const int $\ast$}]{out1 }\end{DoxyParamCaption})}

Transforms each input channel interval into the corresponding channel interval, cropping values if necessary.

Specified pointers are associated to int\mbox{[}5\mbox{]} arrays representing the 5-\/ple (RGB, R, G, B, M) -\/ where RGBM adjustment apply first. Then, Global apply equally on RGB channels (but not on M).

\begin{DoxyNote}{Note}
The input and output rasters must have the same size and pixel type. Supports rout == rin. 
\end{DoxyNote}

\begin{DoxyCode}{0}
\DoxyCodeLine{00279                                                                         \{}
\DoxyCodeLine{00280   \textcolor{keywordflow}{if} (rout-\/>getSize() != rin-\/>getSize()) \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}size mismatch"{}});}
\DoxyCodeLine{00281 }
\DoxyCodeLine{00282   rout-\/>lock();}
\DoxyCodeLine{00283   rin-\/>lock();}
\DoxyCodeLine{00284 }
\DoxyCodeLine{00285   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})rout \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})rin)}
\DoxyCodeLine{00286     do\_rgbmAdjust<TPixel32>(rout, rin, \&do\_rgbmScale\_lut<TPixel32>, in0, in1,}
\DoxyCodeLine{00287                             out0, out1);}
\DoxyCodeLine{00288   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})rout \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})rin) \{}
\DoxyCodeLine{00289     \textcolor{keywordflow}{if} (rin-\/>getLx() * rin-\/>getLy() < TPixel64::maxChannelValue)}
\DoxyCodeLine{00290       do\_rgbmAdjust<TPixel64>(rout, rin, \&do\_rgbmScale<TPixel64>, in0, in1,}
\DoxyCodeLine{00291                               out0, out1);}
\DoxyCodeLine{00292     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00293       do\_rgbmAdjust<TPixel64>(rout, rin, \&do\_rgbmScale\_lut<TPixel64>, in0, in1,}
\DoxyCodeLine{00294                               out0, out1);}
\DoxyCodeLine{00295   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}})rout \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}})rin)}
\DoxyCodeLine{00296     do\_greyAdjust<TPixelGR8>(rout, rin, in0[0], in1[0], out0[0], out1[0]);}
\DoxyCodeLine{00297   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR16P}})rout \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR16P}})rin)}
\DoxyCodeLine{00298     do\_greyAdjust<TPixelGR16>(rout, rin, in0[0], in1[0], out0[0], out1[0]);}
\DoxyCodeLine{00299   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00300     rout-\/>unlock();}
\DoxyCodeLine{00301     rin-\/>unlock();}
\DoxyCodeLine{00302     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}pixel type mismatch"{}});}
\DoxyCodeLine{00303   \}}
\DoxyCodeLine{00304 }
\DoxyCodeLine{00305   rout-\/>unlock();}
\DoxyCodeLine{00306   rin-\/>unlock();}
\DoxyCodeLine{00307 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a66da5845870f824caab9c6fc47d6b8bd}\label{namespace_t_rop_a66da5845870f824caab9c6fc47d6b8bd}} 
\index{TRop@{TRop}!rgbmScale@{rgbmScale}}
\index{rgbmScale@{rgbmScale}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{rgbmScale()}{rgbmScale()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void TRop\+::rgbm\+Scale (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rin,  }\item[{const double $\ast$}]{k,  }\item[{const double $\ast$}]{a,  }\item[{const int $\ast$}]{out0,  }\item[{const int $\ast$}]{out1 }\end{DoxyParamCaption})}



Applies first order mappings to each of {\bfseries{rin\textquotesingle{}s}} channels. 

\begin{DoxyNote}{Note}
The input and output rasters must have the same size and pixel type. Supports rout == rin. 
\end{DoxyNote}

\begin{DoxyCode}{0}
\DoxyCodeLine{00231                                                                         \{}
\DoxyCodeLine{00232   \textcolor{keywordflow}{if} (rout-\/>getSize() != rin-\/>getSize()) \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}size mismatch"{}});}
\DoxyCodeLine{00233 }
\DoxyCodeLine{00234   rout-\/>lock();}
\DoxyCodeLine{00235   rin-\/>lock();}
\DoxyCodeLine{00236 }
\DoxyCodeLine{00237   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})rout \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})rin)}
\DoxyCodeLine{00238     do\_rgbmScale\_lut<TPixel32>(rout, rin, a, k, out0, out1);}
\DoxyCodeLine{00239   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})rout \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})rin) \{}
\DoxyCodeLine{00240     \textcolor{keywordflow}{if} (rin-\/>getLx() * rin-\/>getLy() < TPixel64::maxChannelValue)}
\DoxyCodeLine{00241       do\_rgbmScale<TPixel64>(rout, rin, a, k, out0, out1);}
\DoxyCodeLine{00242     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00243       do\_rgbmScale\_lut<TPixel64>(rout, rin, a, k, out0, out1);}
\DoxyCodeLine{00244   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}})rout \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}})rin)}
\DoxyCodeLine{00245     do\_greyScale\_lut<TPixelGR8>(rout, rin, a[0], k[0], out0[0], out1[0]);}
\DoxyCodeLine{00246   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR16P}})rout \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR16P}})rin)}
\DoxyCodeLine{00247     do\_greyScale\_lut<TPixelGR16>(rout, rin, a[0], k[0], out0[0], out1[0]);}
\DoxyCodeLine{00248   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00249     rout-\/>unlock();}
\DoxyCodeLine{00250     rin-\/>unlock();}
\DoxyCodeLine{00251     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}pixel type mismatch"{}});}
\DoxyCodeLine{00252   \}}
\DoxyCodeLine{00253 }
\DoxyCodeLine{00254   rout-\/>unlock();}
\DoxyCodeLine{00255   rin-\/>unlock();}
\DoxyCodeLine{00256 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a5fad2c1d5d972dfdf8547efc9386c986}\label{namespace_t_rop_a5fad2c1d5d972dfdf8547efc9386c986}} 
\index{TRop@{TRop}!rgbmScale@{rgbmScale}}
\index{rgbmScale@{rgbmScale}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{rgbmScale()}{rgbmScale()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void TRop\+::rgbm\+Scale (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rin,  }\item[{double}]{kr,  }\item[{double}]{kg,  }\item[{double}]{kb,  }\item[{double}]{km,  }\item[{double}]{ar = {\ttfamily 0.0},  }\item[{double}]{ag = {\ttfamily 0.0},  }\item[{double}]{ab = {\ttfamily 0.0},  }\item[{double}]{am = {\ttfamily 0.0} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00262                                 \{}
\DoxyCodeLine{00263   \textcolor{keywordtype}{double} k[4], a[4];}
\DoxyCodeLine{00264 }
\DoxyCodeLine{00265   a[0] = ar, a[1] = ag, a[2] = ab, a[3] = am;}
\DoxyCodeLine{00266   k[0] = kr, k[1] = kg, k[2] = kb, k[3] = km;}
\DoxyCodeLine{00267 }
\DoxyCodeLine{00268   \textcolor{keywordtype}{int} out0[4], out1[4];}
\DoxyCodeLine{00269 }
\DoxyCodeLine{00270   out0[0] = out0[1] = out0[2] = out0[3] = 0;}
\DoxyCodeLine{00271   out1[0] = out1[1] = out1[2] = out1[3] = 255;}
\DoxyCodeLine{00272 }
\DoxyCodeLine{00273   \mbox{\hyperlink{namespace_t_rop_a66da5845870f824caab9c6fc47d6b8bd}{rgbmScale}}(rout, rin, k, a, out0, out1);}
\DoxyCodeLine{00274 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a06c4a7a2cea0acf26c099c4b5554bdab}\label{namespace_t_rop_a06c4a7a2cea0acf26c099c4b5554bdab}} 
\index{TRop@{TRop}!ropin@{ropin}}
\index{ropin@{ropin}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{ropin()}{ropin()}}
{\footnotesize\ttfamily void TRop\+::ropin (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{source,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{matte,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00787                                        \{}
\DoxyCodeLine{00788   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} source32 = source;}
\DoxyCodeLine{00789   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} matte32  = matte;}
\DoxyCodeLine{00790   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32    = rout;}
\DoxyCodeLine{00791   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} source64 = source;}
\DoxyCodeLine{00792   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} matte64  = matte;}
\DoxyCodeLine{00793   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64    = rout;}
\DoxyCodeLine{00794 }
\DoxyCodeLine{00795   \textcolor{keywordflow}{if} (source32 \&\& matte32 \&\& out32) \{}
\DoxyCodeLine{00796     FOR\_EACH\_PIXEL\_BEGIN\_LOOP(TPixelRGBM32, source32, TPixelRGBM32, matte32,}
\DoxyCodeLine{00797                               TPixelRGBM32, out32)}
\DoxyCodeLine{00798 }
\DoxyCodeLine{00799     \textcolor{keywordflow}{if} (downPix-\/>m == 0)}
\DoxyCodeLine{00800       outPix-\/>r = outPix-\/>g = outPix-\/>b = outPix-\/>m = 0;}
\DoxyCodeLine{00801     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (downPix-\/>m == 255)}
\DoxyCodeLine{00802       *outPix = *upPix;}
\DoxyCodeLine{00803     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00804       \textcolor{comment}{/*}}
\DoxyCodeLine{00805 \textcolor{comment}{\_\_m128i zeros = \_mm\_setzero\_si128();}}
\DoxyCodeLine{00806 \textcolor{comment}{}}
\DoxyCodeLine{00807 \textcolor{comment}{\_\_m128i upPix\_packed\_i= \_mm\_unpacklo\_epi8(\_mm\_cvtsi32\_si128(*(DWORD*)upPix),}}
\DoxyCodeLine{00808 \textcolor{comment}{zeros);}}
\DoxyCodeLine{00809 \textcolor{comment}{\_\_m128  upPix\_packed  = \_mm\_cvtepi32\_ps(\_mm\_unpacklo\_epi16(upPix\_packed\_i,}}
\DoxyCodeLine{00810 \textcolor{comment}{zeros));}}
\DoxyCodeLine{00811 \textcolor{comment}{}}
\DoxyCodeLine{00812 \textcolor{comment}{float fac = downPix-\/>m / 255.0;}}
\DoxyCodeLine{00813 \textcolor{comment}{\_\_m128 fac\_packed = \_mm\_load1\_ps(\&fac);}}
\DoxyCodeLine{00814 \textcolor{comment}{}}
\DoxyCodeLine{00815 \textcolor{comment}{upPix\_packed = \_mm\_mul\_ps(upPix\_packed, fac\_packed);}}
\DoxyCodeLine{00816 \textcolor{comment}{}}
\DoxyCodeLine{00817 \textcolor{comment}{\_\_m128i outPix\_packed\_i = \_mm\_cvtps\_epi32(upPix\_packed);}}
\DoxyCodeLine{00818 \textcolor{comment}{outPix\_packed\_i = \_mm\_packs\_epi32(outPix\_packed\_i, zeros);}}
\DoxyCodeLine{00819 \textcolor{comment}{outPix\_packed\_i = \_mm\_packus\_epi16(outPix\_packed\_i, zeros);}}
\DoxyCodeLine{00820 \textcolor{comment}{*(DWORD*)(outPix) = \_mm\_cvtsi128\_si32(outPix\_packed\_i);}}
\DoxyCodeLine{00821 \textcolor{comment}{*/}}
\DoxyCodeLine{00822 }
\DoxyCodeLine{00823       \textcolor{keyword}{const} \textcolor{keywordtype}{int} MAGICFAC = (257U * 256U + 1U);}
\DoxyCodeLine{00824       UINT fac           = MAGICFAC * downPix-\/>m;}
\DoxyCodeLine{00825 }
\DoxyCodeLine{00826       outPix-\/>r = (UINT)(upPix-\/>r * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00827       outPix-\/>g = (UINT)(upPix-\/>g * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00828       outPix-\/>b = (UINT)(upPix-\/>b * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00829       outPix-\/>m = (UINT)(upPix-\/>m * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00830     \}}
\DoxyCodeLine{00831 }
\DoxyCodeLine{00832     FOR\_EACH\_PIXEL\_END\_LOOP(source32, matte32, out32)}
\DoxyCodeLine{00833   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (source64 \&\& matte64 \&\& out64)}
\DoxyCodeLine{00834 }
\DoxyCodeLine{00835   \{}
\DoxyCodeLine{00836     FOR\_EACH\_PIXEL\_BEGIN\_LOOP(TPixelRGBM64, source64, TPixelRGBM64, matte64,}
\DoxyCodeLine{00837                               TPixelRGBM64, out64)}
\DoxyCodeLine{00838 }
\DoxyCodeLine{00839     \textcolor{keywordflow}{if} (downPix-\/>m == 0)}
\DoxyCodeLine{00840       outPix-\/>r = outPix-\/>g = outPix-\/>b = outPix-\/>m = 0;}
\DoxyCodeLine{00841     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (downPix-\/>m == 65535)}
\DoxyCodeLine{00842       *outPix = *upPix;}
\DoxyCodeLine{00843     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00844       \textcolor{comment}{/*}}
\DoxyCodeLine{00845 \textcolor{comment}{\_\_m128i zeros = \_mm\_setzero\_si128();}}
\DoxyCodeLine{00846 \textcolor{comment}{}}
\DoxyCodeLine{00847 \textcolor{comment}{\_\_m128i upPix\_packed\_i= \_mm\_unpacklo\_epi8(\_mm\_cvtsi32\_si128(*(DWORD*)upPix),}}
\DoxyCodeLine{00848 \textcolor{comment}{zeros);}}
\DoxyCodeLine{00849 \textcolor{comment}{\_\_m128  upPix\_packed  = \_mm\_cvtepi32\_ps(\_mm\_unpacklo\_epi16(upPix\_packed\_i,}}
\DoxyCodeLine{00850 \textcolor{comment}{zeros));}}
\DoxyCodeLine{00851 \textcolor{comment}{}}
\DoxyCodeLine{00852 \textcolor{comment}{float fac = downPix-\/>m / 255.0;}}
\DoxyCodeLine{00853 \textcolor{comment}{\_\_m128 fac\_packed = \_mm\_load1\_ps(\&fac);}}
\DoxyCodeLine{00854 \textcolor{comment}{}}
\DoxyCodeLine{00855 \textcolor{comment}{upPix\_packed = \_mm\_mul\_ps(upPix\_packed, fac\_packed);}}
\DoxyCodeLine{00856 \textcolor{comment}{}}
\DoxyCodeLine{00857 \textcolor{comment}{\_\_m128i outPix\_packed\_i = \_mm\_cvtps\_epi32(upPix\_packed);}}
\DoxyCodeLine{00858 \textcolor{comment}{outPix\_packed\_i = \_mm\_packs\_epi32(outPix\_packed\_i, zeros);}}
\DoxyCodeLine{00859 \textcolor{comment}{outPix\_packed\_i = \_mm\_packus\_epi16(outPix\_packed\_i, zeros);}}
\DoxyCodeLine{00860 \textcolor{comment}{*(DWORD*)(outPix) = \_mm\_cvtsi128\_si32(outPix\_packed\_i);}}
\DoxyCodeLine{00861 \textcolor{comment}{*/}}
\DoxyCodeLine{00862       \textcolor{keywordtype}{double} fac = downPix-\/>m / 65535.0;}
\DoxyCodeLine{00863 }
\DoxyCodeLine{00864       outPix-\/>r = (USHORT)(upPix-\/>r * fac);}
\DoxyCodeLine{00865       outPix-\/>g = (USHORT)(upPix-\/>g * fac);}
\DoxyCodeLine{00866       outPix-\/>b = (USHORT)(upPix-\/>b * fac);}
\DoxyCodeLine{00867       outPix-\/>m = (USHORT)(upPix-\/>m * fac);}
\DoxyCodeLine{00868     \}}
\DoxyCodeLine{00869 }
\DoxyCodeLine{00870     FOR\_EACH\_PIXEL\_END\_LOOP(source64, matte64, out64)}
\DoxyCodeLine{00871   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00872     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::in invalid raster combination"{}});}
\DoxyCodeLine{00873 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a1e4be06e2ffe44d151a50c35a5cc25b3}\label{namespace_t_rop_a1e4be06e2ffe44d151a50c35a5cc25b3}} 
\index{TRop@{TRop}!ropmax@{ropmax}}
\index{ropmax@{ropmax}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{ropmax()}{ropmax()}}
{\footnotesize\ttfamily void TRop\+::ropmax (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01261                                         \{}
\DoxyCodeLine{01262   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{01263   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{01264   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{01265 }
\DoxyCodeLine{01266   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{01267     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{01268 }
\DoxyCodeLine{01269     outPix-\/>r = upPix-\/>r > downPix-\/>r ? upPix-\/>r : downPix-\/>r;}
\DoxyCodeLine{01270     outPix-\/>g = upPix-\/>g > downPix-\/>g ? upPix-\/>g : downPix-\/>g;}
\DoxyCodeLine{01271     outPix-\/>b = upPix-\/>b > downPix-\/>b ? upPix-\/>b : downPix-\/>b;}
\DoxyCodeLine{01272     outPix-\/>m = upPix-\/>m > downPix-\/>m ? upPix-\/>m : downPix-\/>m;}
\DoxyCodeLine{01273 }
\DoxyCodeLine{01274     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{01275   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01276     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{01277     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{01278     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{01279 }
\DoxyCodeLine{01280     \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{01281       FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{01282 }
\DoxyCodeLine{01283       outPix-\/>r = upPix-\/>r > downPix-\/>r ? upPix-\/>r : downPix-\/>r;}
\DoxyCodeLine{01284       outPix-\/>g = upPix-\/>g > downPix-\/>g ? upPix-\/>g : downPix-\/>g;}
\DoxyCodeLine{01285       outPix-\/>b = upPix-\/>b > downPix-\/>b ? upPix-\/>b : downPix-\/>b;}
\DoxyCodeLine{01286       outPix-\/>m = upPix-\/>m > downPix-\/>m ? upPix-\/>m : downPix-\/>m;}
\DoxyCodeLine{01287 }
\DoxyCodeLine{01288       FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{01289     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01290       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} up8   = rup;}
\DoxyCodeLine{01291       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} down8 = rdown;}
\DoxyCodeLine{01292       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} out8  = rout;}
\DoxyCodeLine{01293 }
\DoxyCodeLine{01294       \textcolor{keywordflow}{if} (up8 \&\& down8 \&\& out8) \{}
\DoxyCodeLine{01295         FOR\_EACH\_PIXEL\_8\_BEGIN\_LOOP}
\DoxyCodeLine{01296 }
\DoxyCodeLine{01297         outPix-\/>value =}
\DoxyCodeLine{01298             upPix-\/>value > downPix-\/>value ? upPix-\/>value : downPix-\/>value;}
\DoxyCodeLine{01299 }
\DoxyCodeLine{01300         FOR\_EACH\_PIXEL\_8\_END\_LOOP}
\DoxyCodeLine{01301       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01302         \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::max invalid raster combination"{}});}
\DoxyCodeLine{01303     \}}
\DoxyCodeLine{01304   \}}
\DoxyCodeLine{01305 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a0cf1cee72615a6140aa04f91f4d345f2}\label{namespace_t_rop_a0cf1cee72615a6140aa04f91f4d345f2}} 
\index{TRop@{TRop}!ropmin@{ropmin}}
\index{ropmin@{ropmin}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{ropmin()}{ropmin()}}
{\footnotesize\ttfamily void TRop\+::ropmin (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout,  }\item[{bool}]{matte }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01166                                                     \{}
\DoxyCodeLine{01167   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{01168   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{01169   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{01170 }
\DoxyCodeLine{01171   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{01172     \textcolor{keywordflow}{if} (matte) \{}
\DoxyCodeLine{01173       FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{01174 }
\DoxyCodeLine{01175       outPix-\/>r = upPix-\/>r < downPix-\/>r ? upPix-\/>r : downPix-\/>r;}
\DoxyCodeLine{01176       outPix-\/>g = upPix-\/>g < downPix-\/>g ? upPix-\/>g : downPix-\/>g;}
\DoxyCodeLine{01177       outPix-\/>b = upPix-\/>b < downPix-\/>b ? upPix-\/>b : downPix-\/>b;}
\DoxyCodeLine{01178       outPix-\/>m = upPix-\/>m < downPix-\/>m ? upPix-\/>m : downPix-\/>m;}
\DoxyCodeLine{01179 }
\DoxyCodeLine{01180       FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{01181     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01182       FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{01183       \textcolor{keywordflow}{if} (upPix-\/>m >= 255) \{}
\DoxyCodeLine{01184         outPix-\/>r = upPix-\/>r < downPix-\/>r ? upPix-\/>r : downPix-\/>r;}
\DoxyCodeLine{01185         outPix-\/>g = upPix-\/>g < downPix-\/>g ? upPix-\/>g : downPix-\/>g;}
\DoxyCodeLine{01186         outPix-\/>b = upPix-\/>b < downPix-\/>b ? upPix-\/>b : downPix-\/>b;}
\DoxyCodeLine{01187         outPix-\/>m = upPix-\/>m < downPix-\/>m ? upPix-\/>m : downPix-\/>m;}
\DoxyCodeLine{01188 }
\DoxyCodeLine{01189       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (upPix-\/>m) \{}
\DoxyCodeLine{01190         TPixel32 tmp;}
\DoxyCodeLine{01191         tmp.r = upPix-\/>r < downPix-\/>r ? upPix-\/>r : downPix-\/>r;}
\DoxyCodeLine{01192         tmp.g = upPix-\/>g < downPix-\/>g ? upPix-\/>g : downPix-\/>g;}
\DoxyCodeLine{01193         tmp.b = upPix-\/>b < downPix-\/>b ? upPix-\/>b : downPix-\/>b;}
\DoxyCodeLine{01194         \textcolor{comment}{// tmp.m = upPix-\/>m < downPix-\/>m ? upPix-\/>m : downPix-\/>m;}}
\DoxyCodeLine{01195         outPix-\/>r = upPix-\/>m * (tmp.r -\/ downPix-\/>r) / 255.0 + downPix-\/>r;}
\DoxyCodeLine{01196         outPix-\/>g = upPix-\/>m * (tmp.g -\/ downPix-\/>g) / 255.0 + downPix-\/>g;}
\DoxyCodeLine{01197         outPix-\/>b = upPix-\/>m * (tmp.b -\/ downPix-\/>b) / 255.0 + downPix-\/>b;}
\DoxyCodeLine{01198         outPix-\/>m = upPix-\/>m * (tmp.m -\/ downPix-\/>m) / 255.0 + downPix-\/>m;}
\DoxyCodeLine{01199       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01200         *outPix = *downPix;}
\DoxyCodeLine{01201       FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{01202     \}}
\DoxyCodeLine{01203   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01204     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{01205     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{01206     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{01207 }
\DoxyCodeLine{01208     \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{01209       \textcolor{keywordflow}{if} (matte) \{}
\DoxyCodeLine{01210         FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{01211 }
\DoxyCodeLine{01212         outPix-\/>r = upPix-\/>r < downPix-\/>r ? upPix-\/>r : downPix-\/>r;}
\DoxyCodeLine{01213         outPix-\/>g = upPix-\/>g < downPix-\/>g ? upPix-\/>g : downPix-\/>g;}
\DoxyCodeLine{01214         outPix-\/>b = upPix-\/>b < downPix-\/>b ? upPix-\/>b : downPix-\/>b;}
\DoxyCodeLine{01215         outPix-\/>m = upPix-\/>m < downPix-\/>m ? upPix-\/>m : downPix-\/>m;}
\DoxyCodeLine{01216 }
\DoxyCodeLine{01217         FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{01218       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01219         FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{01220         \textcolor{keywordflow}{if} (upPix-\/>m >= 65535) \{}
\DoxyCodeLine{01221           outPix-\/>r = upPix-\/>r < downPix-\/>r ? upPix-\/>r : downPix-\/>r;}
\DoxyCodeLine{01222           outPix-\/>g = upPix-\/>g < downPix-\/>g ? upPix-\/>g : downPix-\/>g;}
\DoxyCodeLine{01223           outPix-\/>b = upPix-\/>b < downPix-\/>b ? upPix-\/>b : downPix-\/>b;}
\DoxyCodeLine{01224           outPix-\/>m = upPix-\/>m < downPix-\/>m ? upPix-\/>m : downPix-\/>m;}
\DoxyCodeLine{01225 }
\DoxyCodeLine{01226         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (upPix-\/>m) \{}
\DoxyCodeLine{01227           TPixel32 tmp;}
\DoxyCodeLine{01228           tmp.r = upPix-\/>r < downPix-\/>r ? upPix-\/>r : downPix-\/>r;}
\DoxyCodeLine{01229           tmp.g = upPix-\/>g < downPix-\/>g ? upPix-\/>g : downPix-\/>g;}
\DoxyCodeLine{01230           tmp.b = upPix-\/>b < downPix-\/>b ? upPix-\/>b : downPix-\/>b;}
\DoxyCodeLine{01231           \textcolor{comment}{// tmp.m = upPix-\/>m < downPix-\/>m ? upPix-\/>m : downPix-\/>m;}}
\DoxyCodeLine{01232           outPix-\/>r = upPix-\/>m * (tmp.r -\/ downPix-\/>r) / 65535.0 + downPix-\/>r;}
\DoxyCodeLine{01233           outPix-\/>g = upPix-\/>m * (tmp.g -\/ downPix-\/>g) / 65535.0 + downPix-\/>g;}
\DoxyCodeLine{01234           outPix-\/>b = upPix-\/>m * (tmp.b -\/ downPix-\/>b) / 65535.0 + downPix-\/>b;}
\DoxyCodeLine{01235           outPix-\/>m = upPix-\/>m * (tmp.m -\/ downPix-\/>m) / 65535.0 + downPix-\/>m;}
\DoxyCodeLine{01236         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01237           *outPix = *downPix;}
\DoxyCodeLine{01238         FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{01239       \}}
\DoxyCodeLine{01240     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01241       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} up8   = rup;}
\DoxyCodeLine{01242       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} down8 = rdown;}
\DoxyCodeLine{01243       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} out8  = rout;}
\DoxyCodeLine{01244 }
\DoxyCodeLine{01245       \textcolor{keywordflow}{if} (up8 \&\& down8 \&\& out8) \{}
\DoxyCodeLine{01246         FOR\_EACH\_PIXEL\_8\_BEGIN\_LOOP}
\DoxyCodeLine{01247 }
\DoxyCodeLine{01248         outPix-\/>value =}
\DoxyCodeLine{01249             upPix-\/>value < downPix-\/>value ? upPix-\/>value : downPix-\/>value;}
\DoxyCodeLine{01250 }
\DoxyCodeLine{01251         FOR\_EACH\_PIXEL\_8\_END\_LOOP}
\DoxyCodeLine{01252       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01253         \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::min invalid raster combination"{}});}
\DoxyCodeLine{01254     \}}
\DoxyCodeLine{01255   \}}
\DoxyCodeLine{01256 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a6d075919a2603d7734e42c1b6ebc8cb8}\label{namespace_t_rop_a6d075919a2603d7734e42c1b6ebc8cb8}} 
\index{TRop@{TRop}!ropout@{ropout}}
\index{ropout@{ropout}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{ropout()}{ropout()}}
{\footnotesize\ttfamily void TRop\+::ropout (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{source,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{matte,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00878                                         \{}
\DoxyCodeLine{00879   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} source32 = source;}
\DoxyCodeLine{00880   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} matte32  = matte;}
\DoxyCodeLine{00881   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32    = rout;}
\DoxyCodeLine{00882   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} source64 = source;}
\DoxyCodeLine{00883   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} matte64  = matte;}
\DoxyCodeLine{00884   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64    = rout;}
\DoxyCodeLine{00885 }
\DoxyCodeLine{00886   \textcolor{keywordflow}{if} (source32 \&\& matte32 \&\& out32) \{}
\DoxyCodeLine{00887     FOR\_EACH\_PIXEL\_BEGIN\_LOOP(TPixelRGBM32, source32, TPixelRGBM32, matte32,}
\DoxyCodeLine{00888                               TPixelRGBM32, out32)}
\DoxyCodeLine{00889 }
\DoxyCodeLine{00890     \textcolor{keywordflow}{if} (downPix-\/>m == 255)}
\DoxyCodeLine{00891       outPix-\/>r = outPix-\/>g = outPix-\/>b = outPix-\/>m = 0;}
\DoxyCodeLine{00892     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (downPix-\/>m == 0)}
\DoxyCodeLine{00893       *outPix = *upPix;}
\DoxyCodeLine{00894     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00895       \textcolor{keyword}{const} \textcolor{keywordtype}{int} MAGICFAC = (257U * 256U + 1U);}
\DoxyCodeLine{00896       UINT fac           = MAGICFAC * (255 -\/ downPix-\/>m);}
\DoxyCodeLine{00897 }
\DoxyCodeLine{00898       outPix-\/>r = (UINT)(upPix-\/>r * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00899       outPix-\/>g = (UINT)(upPix-\/>g * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00900       outPix-\/>b = (UINT)(upPix-\/>b * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00901       outPix-\/>m = (UINT)(upPix-\/>m * fac + (1U << 23)) >> 24;}
\DoxyCodeLine{00902     \}}
\DoxyCodeLine{00903 }
\DoxyCodeLine{00904     FOR\_EACH\_PIXEL\_END\_LOOP(source32, matte32, out32)}
\DoxyCodeLine{00905   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (source64 \&\& matte64 \&\& out64) \{}
\DoxyCodeLine{00906     FOR\_EACH\_PIXEL\_BEGIN\_LOOP(TPixelRGBM64, source64, TPixelRGBM64, matte64,}
\DoxyCodeLine{00907                               TPixelRGBM64, out64)}
\DoxyCodeLine{00908 }
\DoxyCodeLine{00909     \textcolor{keywordflow}{if} (downPix-\/>m == 65535)}
\DoxyCodeLine{00910       outPix-\/>r = outPix-\/>g = outPix-\/>b = outPix-\/>m = 0;}
\DoxyCodeLine{00911     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (downPix-\/>m == 0)}
\DoxyCodeLine{00912       *outPix = *upPix;}
\DoxyCodeLine{00913     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00914       \textcolor{keywordtype}{double} fac = (65535 -\/ downPix-\/>m) / 65535.0;}
\DoxyCodeLine{00915 }
\DoxyCodeLine{00916       outPix-\/>r = (USHORT)(upPix-\/>r * fac);}
\DoxyCodeLine{00917       outPix-\/>g = (USHORT)(upPix-\/>g * fac);}
\DoxyCodeLine{00918       outPix-\/>b = (USHORT)(upPix-\/>b * fac);}
\DoxyCodeLine{00919       outPix-\/>m = (USHORT)(upPix-\/>m * fac);}
\DoxyCodeLine{00920     \}}
\DoxyCodeLine{00921 }
\DoxyCodeLine{00922     FOR\_EACH\_PIXEL\_END\_LOOP(source64, matte64, out64)}
\DoxyCodeLine{00923   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00924     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::out invalid raster combination"{}});}
\DoxyCodeLine{00925 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_a2abcebe9e3631cd03f07055b838cc92b}\label{namespace_t_rop_a2abcebe9e3631cd03f07055b838cc92b}} 
\index{TRop@{TRop}!screen@{screen}}
\index{screen@{screen}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{screen()}{screen()}}
{\footnotesize\ttfamily void TRop\+::screen (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00403                                         \{}
\DoxyCodeLine{00404   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{00405   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{00406   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{00407   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{00408     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{00409 }
\DoxyCodeLine{00410     \textcolor{keywordtype}{double} r, g, b;}
\DoxyCodeLine{00411     r = 256 -\/ ((256 -\/ upPix-\/>r) * (256 -\/ downPix-\/>r) >> 8);}
\DoxyCodeLine{00412     g = 256 -\/ ((256 -\/ upPix-\/>g) * (256 -\/ downPix-\/>g) >> 8);}
\DoxyCodeLine{00413     b = 256 -\/ ((256 -\/ upPix-\/>b) * (256 -\/ downPix-\/>b) >> 8);}
\DoxyCodeLine{00414 }
\DoxyCodeLine{00415     \textcolor{keywordflow}{if} (upPix-\/>m != 255) \{}
\DoxyCodeLine{00416       \textcolor{keywordtype}{double} m;}
\DoxyCodeLine{00417       m = 256 -\/ ((256 -\/ upPix-\/>m) * (256 -\/ downPix-\/>m) >> 8);}
\DoxyCodeLine{00418       TPixel32 tmpPix;}
\DoxyCodeLine{00419       tmpPix.r = (UCHAR)tcrop<double>(r, 0, 255);}
\DoxyCodeLine{00420       tmpPix.g = (UCHAR)tcrop<double>(g, 0, 255);}
\DoxyCodeLine{00421       tmpPix.b = (UCHAR)tcrop<double>(b, 0, 255);}
\DoxyCodeLine{00422       tmpPix.m = (UCHAR)tcrop<double>(m, 0, 255);}
\DoxyCodeLine{00423       overPix<TPixel32, UCHAR>(*outPix, *downPix, tmpPix);}
\DoxyCodeLine{00424     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00425       outPix-\/>r = (UCHAR)tcrop<double>(r, 0, 255);}
\DoxyCodeLine{00426       outPix-\/>g = (UCHAR)tcrop<double>(g, 0, 255);}
\DoxyCodeLine{00427       outPix-\/>b = (UCHAR)tcrop<double>(b, 0, 255);}
\DoxyCodeLine{00428       outPix-\/>m = upPix-\/>m;}
\DoxyCodeLine{00429     \}}
\DoxyCodeLine{00430     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{00431   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00432     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{00433     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{00434     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{00435 }
\DoxyCodeLine{00436     \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{00437       FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{00438 }
\DoxyCodeLine{00439       \textcolor{keywordtype}{double} r, g, b;}
\DoxyCodeLine{00440       r = 65536 -\/ (65536 -\/ upPix-\/>r) * ((65536 -\/ downPix-\/>r) / 65536.0);}
\DoxyCodeLine{00441       g = 65536 -\/ (65536 -\/ upPix-\/>g) * ((65536 -\/ downPix-\/>g) / 65536.0);}
\DoxyCodeLine{00442       b = 65536 -\/ (65536 -\/ upPix-\/>b) * ((65536 -\/ downPix-\/>b) / 65536.0);}
\DoxyCodeLine{00443 }
\DoxyCodeLine{00444       \textcolor{keywordflow}{if} (upPix-\/>m != 65535) \{}
\DoxyCodeLine{00445         \textcolor{keywordtype}{double} m;}
\DoxyCodeLine{00446         m = 65536 -\/ (65536 -\/ upPix-\/>m) * ((65536 -\/ downPix-\/>m) / 65536.0);}
\DoxyCodeLine{00447         TPixel64 tmpPix;}
\DoxyCodeLine{00448         tmpPix.r = (USHORT)tcrop<double>(r, 0, 65535);}
\DoxyCodeLine{00449         tmpPix.g = (USHORT)tcrop<double>(g, 0, 65535);}
\DoxyCodeLine{00450         tmpPix.b = (USHORT)tcrop<double>(b, 0, 65535);}
\DoxyCodeLine{00451         tmpPix.m = (USHORT)tcrop<double>(m, 0, 65535);}
\DoxyCodeLine{00452         overPix<TPixel64, USHORT>(*outPix, *downPix, tmpPix);}
\DoxyCodeLine{00453       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00454         outPix-\/>r = (USHORT)tcrop<double>(r, 0, 65535);}
\DoxyCodeLine{00455         outPix-\/>g = (USHORT)tcrop<double>(g, 0, 65535);}
\DoxyCodeLine{00456         outPix-\/>b = (USHORT)tcrop<double>(b, 0, 65535);}
\DoxyCodeLine{00457         outPix-\/>m = upPix-\/>m;}
\DoxyCodeLine{00458       \}}
\DoxyCodeLine{00459 }
\DoxyCodeLine{00460       FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{00461     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00462       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} up8   = rup;}
\DoxyCodeLine{00463       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} down8 = rdown;}
\DoxyCodeLine{00464       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} out8  = rout;}
\DoxyCodeLine{00465 }
\DoxyCodeLine{00466       \textcolor{keywordflow}{if} (up8 \&\& down8 \&\& out8) \{}
\DoxyCodeLine{00467         FOR\_EACH\_PIXEL\_8\_BEGIN\_LOOP}
\DoxyCodeLine{00468         USHORT value;}
\DoxyCodeLine{00469         \textcolor{keywordflow}{if} (downPix-\/>value)}
\DoxyCodeLine{00470           value = (USHORT)((downPix-\/>value << 8) / (255.0 -\/ upPix-\/>value));}
\DoxyCodeLine{00471 }
\DoxyCodeLine{00472         outPix-\/>value = (UCHAR)tcrop<USHORT>(value, 0, 255);}
\DoxyCodeLine{00473 }
\DoxyCodeLine{00474         FOR\_EACH\_PIXEL\_8\_END\_LOOP}
\DoxyCodeLine{00475       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00476         \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::color dodge invalid raster combination"{}});}
\DoxyCodeLine{00477     \}}
\DoxyCodeLine{00478   \}}
\DoxyCodeLine{00479 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_ac744a16161fdfd8ce7de4cd12cd0307d}\label{namespace_t_rop_ac744a16161fdfd8ce7de4cd12cd0307d}} 
\index{TRop@{TRop}!setChannel@{setChannel}}
\index{setChannel@{setChannel}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{setChannel()}{setChannel()}}
{\footnotesize\ttfamily void TRop\+::set\+Channel (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rin,  }\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rout,  }\item[{UCHAR}]{chan,  }\item[{bool}]{greytones }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00255                                       \{}
\DoxyCodeLine{00256   assert(rin-\/>getSize() == rout-\/>getSize());}
\DoxyCodeLine{00257 }
\DoxyCodeLine{00258   rout-\/>lock();}
\DoxyCodeLine{00259 }
\DoxyCodeLine{00260   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})rin \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})rout)}
\DoxyCodeLine{00261     doSetChannel<TPixel32>(rin, rout, chan, greytones);}
\DoxyCodeLine{00262   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})rin \&\& (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})rout)}
\DoxyCodeLine{00263     doSetChannel<TPixel64>(rin, rout, chan, greytones);}
\DoxyCodeLine{00264   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00265     rout-\/>unlock();}
\DoxyCodeLine{00266     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}setChannel: unsupported pixel type"{}});}
\DoxyCodeLine{00267   \}}
\DoxyCodeLine{00268 }
\DoxyCodeLine{00269   rout-\/>unlock();}
\DoxyCodeLine{00270 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_abb73976f88b3ec3d0a3b2cf822dff605}\label{namespace_t_rop_abb73976f88b3ec3d0a3b2cf822dff605}} 
\index{TRop@{TRop}!shrink@{shrink}}
\index{shrink@{shrink}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{shrink()}{shrink()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} TRop\+::shrink (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}}]{rin,  }\item[{int}]{shrink }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00274                                               \{}
\DoxyCodeLine{00275   \textcolor{keywordtype}{int} pixelSize = rin-\/>getPixelSize();}
\DoxyCodeLine{00276 }
\DoxyCodeLine{00277   \textcolor{keywordtype}{int} lx = (rin-\/>getLx() -\/ 1) / shrink + 1;}
\DoxyCodeLine{00278   \textcolor{keywordtype}{int} ly = (rin-\/>getLy() -\/ 1) / shrink + 1;}
\DoxyCodeLine{00279 }
\DoxyCodeLine{00280   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rout;}
\DoxyCodeLine{00281 }
\DoxyCodeLine{00282   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})rin)}
\DoxyCodeLine{00283     rout = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}(lx, ly);}
\DoxyCodeLine{00284   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})rin)}
\DoxyCodeLine{00285     rout                      = \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}}(lx, ly);}
\DoxyCodeLine{00286   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}})rin) rout = \mbox{\hyperlink{class_t_raster_p_t}{TRasterCM32P}}(lx, ly);}
\DoxyCodeLine{00287   \textcolor{keywordflow}{if} ((\mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}})rin) rout  = \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}}(lx, ly);}
\DoxyCodeLine{00288 }
\DoxyCodeLine{00289   \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{00290 }
\DoxyCodeLine{00291   \textcolor{keywordflow}{for} (i = 0; i < ly; i++) \{}
\DoxyCodeLine{00292     UCHAR *bufin =}
\DoxyCodeLine{00293         (UCHAR *)rin-\/>\mbox{\hyperlink{class_t_raster_a5ce02b7e8a5b8b594863aa272d8dcdbc}{getRawData}}() + (i * shrink) * rin-\/>\mbox{\hyperlink{class_t_raster_a760946b6cb48d7414f90cd421078912c}{getWrap}}() * pixelSize;}
\DoxyCodeLine{00294     UCHAR *bufout =}
\DoxyCodeLine{00295         (UCHAR *)rout-\/>getRawData() + i * rout-\/>getWrap() * pixelSize;}
\DoxyCodeLine{00296     \textcolor{keywordflow}{for} (j = 0; j < lx; j++) \{}
\DoxyCodeLine{00297       memcpy(bufout, bufin, pixelSize);}
\DoxyCodeLine{00298       bufin += shrink * pixelSize;}
\DoxyCodeLine{00299       bufout += pixelSize;}
\DoxyCodeLine{00300     \}}
\DoxyCodeLine{00301   \}}
\DoxyCodeLine{00302   \textcolor{keywordflow}{return} rout;}
\DoxyCodeLine{00303 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_afdf19f6890d2f927af99c25e6a125435}\label{namespace_t_rop_afdf19f6890d2f927af99c25e6a125435}} 
\index{TRop@{TRop}!sub@{sub}}
\index{sub@{sub}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{sub()}{sub()}}
{\footnotesize\ttfamily void TRop\+::sub (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout,  }\item[{bool}]{matte }\end{DoxyParamCaption})}

Subtract {\bfseries{rdown}} pixels to {\bfseries{rup}} pixels and put the resulting raster in {\bfseries{rout}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{00484                            \{}
\DoxyCodeLine{00485   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{00486   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{00487   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{00488   \textcolor{keywordflow}{if} (matte) \{}
\DoxyCodeLine{00489     \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{00490       FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{00491 }
\DoxyCodeLine{00492       SHORT r = downPix-\/>r -\/ upPix-\/>r;}
\DoxyCodeLine{00493       SHORT g = downPix-\/>g -\/ upPix-\/>g;}
\DoxyCodeLine{00494       SHORT b = downPix-\/>b -\/ upPix-\/>b;}
\DoxyCodeLine{00495       SHORT m = downPix-\/>m -\/ upPix-\/>m;}
\DoxyCodeLine{00496 }
\DoxyCodeLine{00497       outPix-\/>r = (UCHAR)tcrop<SHORT>(r, 0, 255);}
\DoxyCodeLine{00498       outPix-\/>g = (UCHAR)tcrop<SHORT>(g, 0, 255);}
\DoxyCodeLine{00499       outPix-\/>b = (UCHAR)tcrop<SHORT>(b, 0, 255);}
\DoxyCodeLine{00500       outPix-\/>m = (UCHAR)tcrop<SHORT>(m, 0, 255);}
\DoxyCodeLine{00501 }
\DoxyCodeLine{00502       FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{00503     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00504       \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{00505       \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{00506       \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{00507 }
\DoxyCodeLine{00508       \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{00509         FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{00510 }
\DoxyCodeLine{00511         TINT32 r  = downPix-\/>r -\/ upPix-\/>r;}
\DoxyCodeLine{00512         TINT32 g  = downPix-\/>g -\/ upPix-\/>g;}
\DoxyCodeLine{00513         TINT32 b  = downPix-\/>b -\/ upPix-\/>b;}
\DoxyCodeLine{00514         TINT32 m  = downPix-\/>m -\/ upPix-\/>m;}
\DoxyCodeLine{00515         outPix-\/>r = (USHORT)tcrop<TINT32>(r, 0, 0xffff);}
\DoxyCodeLine{00516         outPix-\/>g = (USHORT)tcrop<TINT32>(g, 0, 0xffff);}
\DoxyCodeLine{00517         outPix-\/>b = (USHORT)tcrop<TINT32>(b, 0, 0xffff);}
\DoxyCodeLine{00518         outPix-\/>m = (USHORT)tcrop<TINT32>(m, 0, 0xffff);}
\DoxyCodeLine{00519 }
\DoxyCodeLine{00520         FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{00521       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00522         \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} up8   = rup;}
\DoxyCodeLine{00523         \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} down8 = rdown;}
\DoxyCodeLine{00524         \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} out8  = rout;}
\DoxyCodeLine{00525 }
\DoxyCodeLine{00526         \textcolor{keywordflow}{if} (up8 \&\& down8 \&\& out8) \{}
\DoxyCodeLine{00527           FOR\_EACH\_PIXEL\_8\_BEGIN\_LOOP}
\DoxyCodeLine{00528 }
\DoxyCodeLine{00529           SHORT value   = upPix-\/>value -\/ downPix-\/>value;}
\DoxyCodeLine{00530           outPix-\/>value = (UCHAR)tcrop<SHORT>(value, 0, 255);}
\DoxyCodeLine{00531 }
\DoxyCodeLine{00532           FOR\_EACH\_PIXEL\_8\_END\_LOOP}
\DoxyCodeLine{00533         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00534           \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::sub invalid raster combination"{}});}
\DoxyCodeLine{00535       \}}
\DoxyCodeLine{00536     \}}
\DoxyCodeLine{00537   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00538     \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{00539       FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{00540 }
\DoxyCodeLine{00541       SHORT r = downPix-\/>r -\/ upPix-\/>r;}
\DoxyCodeLine{00542       SHORT g = downPix-\/>g -\/ upPix-\/>g;}
\DoxyCodeLine{00543       SHORT b = downPix-\/>b -\/ upPix-\/>b;}
\DoxyCodeLine{00544       SHORT m = downPix-\/>m;  \textcolor{comment}{// -\/ upPix-\/>m;}}
\DoxyCodeLine{00545 }
\DoxyCodeLine{00546       outPix-\/>r = (UCHAR)tcrop<SHORT>(r, 0, 255);}
\DoxyCodeLine{00547       outPix-\/>g = (UCHAR)tcrop<SHORT>(g, 0, 255);}
\DoxyCodeLine{00548       outPix-\/>b = (UCHAR)tcrop<SHORT>(b, 0, 255);}
\DoxyCodeLine{00549       outPix-\/>m = (UCHAR)tcrop<SHORT>(m, 0, 255);}
\DoxyCodeLine{00550 }
\DoxyCodeLine{00551       FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{00552     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00553       \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{00554       \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{00555       \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{00556 }
\DoxyCodeLine{00557       \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{00558         FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{00559 }
\DoxyCodeLine{00560         TINT32 r  = downPix-\/>r -\/ upPix-\/>r;}
\DoxyCodeLine{00561         TINT32 g  = downPix-\/>g -\/ upPix-\/>g;}
\DoxyCodeLine{00562         TINT32 b  = downPix-\/>b -\/ upPix-\/>b;}
\DoxyCodeLine{00563         TINT32 m  = downPix-\/>m;  \textcolor{comment}{// -\/ upPix-\/>m;}}
\DoxyCodeLine{00564         outPix-\/>r = (USHORT)tcrop<TINT32>(r, 0, 0xffff);}
\DoxyCodeLine{00565         outPix-\/>g = (USHORT)tcrop<TINT32>(g, 0, 0xffff);}
\DoxyCodeLine{00566         outPix-\/>b = (USHORT)tcrop<TINT32>(b, 0, 0xffff);}
\DoxyCodeLine{00567         outPix-\/>m = (USHORT)tcrop<TINT32>(m, 0, 0xffff);}
\DoxyCodeLine{00568 }
\DoxyCodeLine{00569         FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{00570       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00571         \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} up8   = rup;}
\DoxyCodeLine{00572         \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} down8 = rdown;}
\DoxyCodeLine{00573         \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} out8  = rout;}
\DoxyCodeLine{00574 }
\DoxyCodeLine{00575         \textcolor{keywordflow}{if} (up8 \&\& down8 \&\& out8) \{}
\DoxyCodeLine{00576           FOR\_EACH\_PIXEL\_8\_BEGIN\_LOOP}
\DoxyCodeLine{00577 }
\DoxyCodeLine{00578           SHORT value   = upPix-\/>value -\/ downPix-\/>value;}
\DoxyCodeLine{00579           outPix-\/>value = (UCHAR)tcrop<SHORT>(value, 0, 255);}
\DoxyCodeLine{00580 }
\DoxyCodeLine{00581           FOR\_EACH\_PIXEL\_8\_END\_LOOP}
\DoxyCodeLine{00582         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00583           \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::sub invalid raster combination"{}});}
\DoxyCodeLine{00584       \}}
\DoxyCodeLine{00585     \}}
\DoxyCodeLine{00586   \}}
\DoxyCodeLine{00587 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00343}{Sub\+Fx\+::process()}}.

\mbox{\Hypertarget{namespace_t_rop_ac40128e0f0e7941fa551849ef6f14036}\label{namespace_t_rop_ac40128e0f0e7941fa551849ef6f14036}} 
\index{TRop@{TRop}!txor@{txor}}
\index{txor@{txor}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{txor()}{txor()}}
{\footnotesize\ttfamily void TRop\+::txor (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rup,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rdown,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{rout }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00981                                       \{}
\DoxyCodeLine{00982   \textcolor{comment}{// da ottimizzare...}}
\DoxyCodeLine{00983   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} up32   = rup;}
\DoxyCodeLine{00984   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} down32 = rdown;}
\DoxyCodeLine{00985   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32  = rout;}
\DoxyCodeLine{00986   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} up64   = rup;}
\DoxyCodeLine{00987   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} down64 = rdown;}
\DoxyCodeLine{00988   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64  = rout;}
\DoxyCodeLine{00989 }
\DoxyCodeLine{00990   \textcolor{keywordflow}{if} (up32 \&\& down32 \&\& out32) \{}
\DoxyCodeLine{00991     FOR\_EACH\_PIXEL\_32\_BEGIN\_LOOP}
\DoxyCodeLine{00992 }
\DoxyCodeLine{00993     TUINT32 notUpM   = 255 -\/ upPix-\/>m;}
\DoxyCodeLine{00994     TUINT32 notDownM = 255 -\/ downPix-\/>m;}
\DoxyCodeLine{00995 }
\DoxyCodeLine{00996     TUINT32 r = notUpM + upPix-\/>r * (notDownM);}
\DoxyCodeLine{00997     TUINT32 g = notUpM + upPix-\/>g * (notDownM);}
\DoxyCodeLine{00998     TUINT32 b = notUpM + upPix-\/>b * (notDownM);}
\DoxyCodeLine{00999 }
\DoxyCodeLine{01000     outPix-\/>r = (UCHAR)tcrop<TUINT32>(0, 255, r);}
\DoxyCodeLine{01001     outPix-\/>g = (UCHAR)tcrop<TUINT32>(0, 255, g);}
\DoxyCodeLine{01002     outPix-\/>b = (UCHAR)tcrop<TUINT32>(0, 255, b);}
\DoxyCodeLine{01003 }
\DoxyCodeLine{01004     FOR\_EACH\_PIXEL\_32\_END\_LOOP}
\DoxyCodeLine{01005   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (up64 \&\& down64 \&\& out64) \{}
\DoxyCodeLine{01006     FOR\_EACH\_PIXEL\_64\_BEGIN\_LOOP}
\DoxyCodeLine{01007 }
\DoxyCodeLine{01008     TUINT32 notUpM   = 65535 -\/ upPix-\/>m;}
\DoxyCodeLine{01009     TUINT32 notDownM = 65535 -\/ downPix-\/>m;}
\DoxyCodeLine{01010 }
\DoxyCodeLine{01011     TUINT32 r = notUpM + upPix-\/>r * (notDownM);}
\DoxyCodeLine{01012     TUINT32 g = notUpM + upPix-\/>g * (notDownM);}
\DoxyCodeLine{01013     TUINT32 b = notUpM + upPix-\/>b * (notDownM);}
\DoxyCodeLine{01014 }
\DoxyCodeLine{01015     outPix-\/>r = (USHORT)tcrop<TUINT32>(0, 65535, r);}
\DoxyCodeLine{01016     outPix-\/>g = (USHORT)tcrop<TUINT32>(0, 65535, g);}
\DoxyCodeLine{01017     outPix-\/>b = (USHORT)tcrop<TUINT32>(0, 65535, b);}
\DoxyCodeLine{01018 }
\DoxyCodeLine{01019     FOR\_EACH\_PIXEL\_64\_END\_LOOP}
\DoxyCodeLine{01020   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01021     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_rop_exception}{TRopException}}(\textcolor{stringliteral}{"{}TRop::xor invalid raster combination"{}});}
\DoxyCodeLine{01022 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_t_rop_afaf9411cf1fb10df32870e97d82043a0}\label{namespace_t_rop_afaf9411cf1fb10df32870e97d82043a0}} 
\index{TRop@{TRop}!unlockRaster@{unlockRaster}}
\index{unlockRaster@{unlockRaster}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{unlockRaster()}{unlockRaster()}}
{\footnotesize\ttfamily void TRop\+::unlock\+Raster (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct___r_a_s_t_e_r}{\+\_\+\+RASTER}} $\ast$}]{raster }\end{DoxyParamCaption})}

Surrenders the input raster\textquotesingle{}s buffer to the cache. Should be called before inactivity periods. 
\begin{DoxyCode}{0}
\DoxyCodeLine{01161                                       \{}
\DoxyCodeLine{01162   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img(TImageCache::instance()-\/>get(}
\DoxyCodeLine{01163       std::string(raster-\/>cacheId, raster-\/>cacheIdLength), \textcolor{keyword}{true}));}
\DoxyCodeLine{01164   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} cacheRas;}
\DoxyCodeLine{01165   \textcolor{keywordflow}{if} (raster-\/>type == RAS\_CM32)}
\DoxyCodeLine{01166     cacheRas = \mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}}(img)-\/>getRaster();}
\DoxyCodeLine{01167   \textcolor{keywordflow}{else}}
\DoxyCodeLine{01168     cacheRas = \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}}(img)-\/>getRaster();}
\DoxyCodeLine{01169   cacheRas-\/>release();}
\DoxyCodeLine{01170   raster-\/>buffer        = 0;}
\DoxyCodeLine{01171   raster-\/>native\_buffer = 0;}
\DoxyCodeLine{01172 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l01119}{release\+Raster46()}}.

\mbox{\Hypertarget{namespace_t_rop_a35fb11523175f84027df48cc51d45d28}\label{namespace_t_rop_a35fb11523175f84027df48cc51d45d28}} 
\index{TRop@{TRop}!whiteTransp@{whiteTransp}}
\index{whiteTransp@{whiteTransp}!TRop@{TRop}}
\doxysubsubsection{\texorpdfstring{whiteTransp()}{whiteTransp()}}
{\footnotesize\ttfamily void TRop\+::white\+Transp (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{ras }\end{DoxyParamCaption})}



all white pixels are set to transparent 


\begin{DoxyCode}{0}
\DoxyCodeLine{01651                                           \{}
\DoxyCodeLine{01652   ras-\/>lock();}
\DoxyCodeLine{01653   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = ras;}
\DoxyCodeLine{01654   \textcolor{keywordflow}{if} (ras32) \{}
\DoxyCodeLine{01655     TPixel32 *endPix, *upPix = 0, *upRow = ras32-\/>pixels();}
\DoxyCodeLine{01656     TPixel32 *lastPix =}
\DoxyCodeLine{01657         upRow + ras32-\/>getWrap() * (ras32-\/>getLy() -\/ 1) + ras32-\/>getLx();}
\DoxyCodeLine{01658 }
\DoxyCodeLine{01659     \textcolor{keywordflow}{while} (upPix < lastPix) \{}
\DoxyCodeLine{01660       upPix  = upRow;}
\DoxyCodeLine{01661       endPix = upPix + ras32-\/>getLx();}
\DoxyCodeLine{01662       \textcolor{keywordflow}{while} (upPix < endPix) \{}
\DoxyCodeLine{01663         \textcolor{keywordflow}{if} (*upPix == TPixel::White) *upPix = TPixel::Transparent;}
\DoxyCodeLine{01664         ++upPix;}
\DoxyCodeLine{01665       \}}
\DoxyCodeLine{01666       upRow += ras32-\/>getWrap();}
\DoxyCodeLine{01667     \}}
\DoxyCodeLine{01668   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01669     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} ras64 = ras;}
\DoxyCodeLine{01670     \textcolor{keywordflow}{if} (ras64) \{}
\DoxyCodeLine{01671       TPixel64 *endPix, *upPix = 0, *upRow = ras64-\/>pixels();}
\DoxyCodeLine{01672       TPixel64 *lastPix =}
\DoxyCodeLine{01673           upRow + ras64-\/>getWrap() * (ras64-\/>getLy() -\/ 1) + ras64-\/>getLx();}
\DoxyCodeLine{01674 }
\DoxyCodeLine{01675       \textcolor{keywordflow}{while} (upPix < lastPix) \{}
\DoxyCodeLine{01676         upPix  = upRow;}
\DoxyCodeLine{01677         endPix = upPix + ras64-\/>getLx();}
\DoxyCodeLine{01678         \textcolor{keywordflow}{while} (upPix < endPix) \{}
\DoxyCodeLine{01679           \textcolor{keywordflow}{if} (*upPix == TPixel64::White) *upPix = TPixel64::Transparent;}
\DoxyCodeLine{01680           ++upPix;}
\DoxyCodeLine{01681         \}}
\DoxyCodeLine{01682         upRow += ras64-\/>getWrap();}
\DoxyCodeLine{01683       \}}
\DoxyCodeLine{01684     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01685       ras-\/>unlock();}
\DoxyCodeLine{01686       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}TRop::premultiply invalid raster type"{}});}
\DoxyCodeLine{01687     \}}
\DoxyCodeLine{01688   \}}
\DoxyCodeLine{01689   ras-\/>unlock();}
\DoxyCodeLine{01690 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00465}{quick\+Put()}}.

