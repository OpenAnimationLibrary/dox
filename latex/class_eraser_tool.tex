\hypertarget{class_eraser_tool}{}\doxysection{Eraser\+Tool Class Reference}
\label{class_eraser_tool}\index{EraserTool@{EraserTool}}
Inheritance diagram for Eraser\+Tool\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_eraser_tool}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296c}{Tool\+Type}} \mbox{\hyperlink{class_eraser_tool_a972afb01f91f1d7cff87dd5ea3e8335a}{get\+Tool\+Type}} () const override
\item 
void \mbox{\hyperlink{class_eraser_tool_a59979313b8409fd36025927655489c21}{draw}} () override
\begin{DoxyCompactList}\small\item\em Draws the tool on the viewer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_eraser_tool_a58a66e61f4af88050c6d2964426d8401}{start\+Erase}} (\mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}} vi, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos)
\item 
void \mbox{\hyperlink{class_eraser_tool_a8f2f959b506f641d499ce59a6092fc5b}{erase}} (\mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}} vi, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos)
\item 
void \mbox{\hyperlink{class_eraser_tool_a6a91903ca89d04c30d8249c0b029856e}{erase}} (\mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}} vi, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect)
\item 
void \mbox{\hyperlink{class_eraser_tool_aca8fe891550b413569152153592119c1}{stop\+Erase}} (\mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}} vi)
\item 
void \mbox{\hyperlink{class_eraser_tool_adc44ceeac1ae6d7983a26050c2764bc4}{left\+Button\+Down}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_eraser_tool_a5858cb6b17a3c0cb190292d2caf7b492}{left\+Button\+Drag}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_eraser_tool_a8b7408031c2b732808e324342c392411}{left\+Button\+Up}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&) override
\item 
void \mbox{\hyperlink{class_eraser_tool_a9b2fccbc45990f9a5388ddad938c9845}{left\+Button\+Double\+Click}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\begin{DoxyCompactList}\small\item\em Viene chiusa la polyline e si da il via alla cancellazione. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_eraser_tool_a3a9024219f9ce4cfb890b8209689cdf4}{mouse\+Move}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
bool \mbox{\hyperlink{class_eraser_tool_afcd9c815a5585364231a65a3102c3592}{on\+Property\+Changed}} (std\+::string property\+Name) override
\item 
void \mbox{\hyperlink{class_eraser_tool_ae7fce14dcfbe2341df60eea86c9b50e0}{on\+Enter}} () override
\begin{DoxyCompactList}\small\item\em Callback for the mouse entering the viewer area. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_eraser_tool_a9d9e765cdb8805aa71fba45fa311fd35}{on\+Leave}} () override
\begin{DoxyCompactList}\small\item\em Callback for the mouse leaving the viewer area. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_eraser_tool_a9412b875b79714088b675feedfe87baf}{on\+Activate}} () override
\begin{DoxyCompactList}\small\item\em Callback invoked whenever the tool activates. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_t_property_group}{TProperty\+Group}} $\ast$ \mbox{\hyperlink{class_eraser_tool_a04ff12e49b87c220ef550553de7928ba}{get\+Properties}} (int target\+Type) override
\item 
int \mbox{\hyperlink{class_eraser_tool_aebdb04386db322fe5627cb013c1a736b}{get\+Cursor\+Id}} () const override
\begin{DoxyCompactList}\small\item\em Returns the type of cursor used by the tool. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_eraser_tool_a55b8227fa7264a7c8f0b8c32e5b6d7f0}{on\+Image\+Changed}} () override
\begin{DoxyCompactList}\small\item\em Notifies changes in the image in use. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_eraser_tool_ab602657186ae68782460de011a075e1e}{on\+Deactivate}} () override
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_eraser_tool_ae2eddd907458c4c4a25f702cb96205aa}\label{class_eraser_tool_ae2eddd907458c4c4a25f702cb96205aa}} 
\index{EraserTool@{EraserTool}!EraserTool@{EraserTool}}
\index{EraserTool@{EraserTool}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{EraserTool()}{EraserTool()}}
{\footnotesize\ttfamily Eraser\+Tool\+::\+Eraser\+Tool (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00376     : \mbox{\hyperlink{class_t_tool}{TTool}}(\textcolor{stringliteral}{"{}T\_Eraser"{}})}
\DoxyCodeLine{00377     , m\_eraseType(\textcolor{stringliteral}{"{}Type:"{}})  \textcolor{comment}{// "{}W\_ToolOptions\_Erasetype"{}}}
\DoxyCodeLine{00378     , m\_interpolation(\textcolor{stringliteral}{"{}interpolation:"{}})}
\DoxyCodeLine{00379     , m\_toolSize(\textcolor{stringliteral}{"{}Size:"{}}, 1, 1000, 10)  \textcolor{comment}{// "{}W\_ToolOptions\_EraserToolSize"{}}}
\DoxyCodeLine{00380     , m\_selective(\textcolor{stringliteral}{"{}Selective"{}}, \textcolor{keyword}{false})   \textcolor{comment}{// "{}W\_ToolOptions\_Selective"{}}}
\DoxyCodeLine{00381     , m\_invertOption(\textcolor{stringliteral}{"{}Invert"{}}, \textcolor{keyword}{false})   \textcolor{comment}{// "{}W\_ToolOptions\_Invert"{}}}
\DoxyCodeLine{00382     , m\_multi(\textcolor{stringliteral}{"{}Frame Range"{}}, \textcolor{keyword}{false})     \textcolor{comment}{// "{}W\_ToolOptions\_FrameRange"{}}}
\DoxyCodeLine{00383     , m\_pointSize(-\/1)}
\DoxyCodeLine{00384     , m\_undo(0)}
\DoxyCodeLine{00385     , m\_currCell(-\/1, -\/1)}
\DoxyCodeLine{00386     , m\_stroke(0)}
\DoxyCodeLine{00387     , m\_thick(5)}
\DoxyCodeLine{00388     , m\_active(\textcolor{keyword}{false})}
\DoxyCodeLine{00389     , m\_firstTime(\textcolor{keyword}{true}) \{}
\DoxyCodeLine{00390   bind(\mbox{\hyperlink{class_t_tool_adf0ea3a7f9d003f761fe57638dd6eff4a6528d353c20fcbe8932de09845117046}{TTool::VectorImage}});}
\DoxyCodeLine{00391 }
\DoxyCodeLine{00392   m\_toolSize.setNonLinearSlider();}
\DoxyCodeLine{00393 }
\DoxyCodeLine{00394   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_toolSize);}
\DoxyCodeLine{00395   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_eraseType);}
\DoxyCodeLine{00396   m\_eraseType.addValue(NORMAL\_ERASE);}
\DoxyCodeLine{00397   m\_eraseType.addValue(RECT\_ERASE);}
\DoxyCodeLine{00398   m\_eraseType.addValue(FREEHAND\_ERASE);}
\DoxyCodeLine{00399   m\_eraseType.addValue(POLYLINE\_ERASE);}
\DoxyCodeLine{00400   m\_eraseType.addValue(SEGMENT\_ERASE);}
\DoxyCodeLine{00401   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_selective);}
\DoxyCodeLine{00402   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_invertOption);}
\DoxyCodeLine{00403   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_multi);}
\DoxyCodeLine{00404   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_interpolation);}
\DoxyCodeLine{00405   m\_interpolation.addValue(LINEAR\_INTERPOLATION);}
\DoxyCodeLine{00406   m\_interpolation.addValue(EASE\_IN\_INTERPOLATION);}
\DoxyCodeLine{00407   m\_interpolation.addValue(EASE\_OUT\_INTERPOLATION);}
\DoxyCodeLine{00408   m\_interpolation.addValue(EASE\_IN\_OUT\_INTERPOLATION);}
\DoxyCodeLine{00409 }
\DoxyCodeLine{00410   m\_selective.setId(\textcolor{stringliteral}{"{}Selective"{}});}
\DoxyCodeLine{00411   m\_invertOption.setId(\textcolor{stringliteral}{"{}Invert"{}});}
\DoxyCodeLine{00412   m\_multi.setId(\textcolor{stringliteral}{"{}FrameRange"{}});}
\DoxyCodeLine{00413   m\_eraseType.setId(\textcolor{stringliteral}{"{}Type"{}});}
\DoxyCodeLine{00414   m\_interpolation.setId(\textcolor{stringliteral}{"{}Interpolation"{}});}
\DoxyCodeLine{00415 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_eraser_tool_a6d0623b817c1d4b9e69c175e0504e5b7}\label{class_eraser_tool_a6d0623b817c1d4b9e69c175e0504e5b7}} 
\index{EraserTool@{EraserTool}!````~EraserTool@{$\sim$EraserTool}}
\index{````~EraserTool@{$\sim$EraserTool}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{$\sim$EraserTool()}{~EraserTool()}}
{\footnotesize\ttfamily Eraser\+Tool\+::$\sim$\+Eraser\+Tool (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00419                         \{}
\DoxyCodeLine{00420   \textcolor{keywordflow}{if} (m\_stroke) \textcolor{keyword}{delete} m\_stroke;}
\DoxyCodeLine{00421 }
\DoxyCodeLine{00422   \textcolor{keywordflow}{if} (m\_firstStroke) \textcolor{keyword}{delete} m\_firstStroke;}
\DoxyCodeLine{00423 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_eraser_tool_a59979313b8409fd36025927655489c21}\label{class_eraser_tool_a59979313b8409fd36025927655489c21}} 
\index{EraserTool@{EraserTool}!draw@{draw}}
\index{draw@{draw}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{draw()}{draw()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::draw (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Draws the tool on the viewer. 



Reimplemented from \mbox{\hyperlink{class_t_tool_a058bf656d73bf3cd63b9826cbaaf48e0}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00448                       \{}
\DoxyCodeLine{00449   \textcolor{keywordflow}{if} (m\_pointSize <= 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00450 }
\DoxyCodeLine{00451   \textcolor{keywordtype}{double} pixelSize2 = getPixelSize() * getPixelSize();}
\DoxyCodeLine{00452   m\_thick           = pixelSize2 / 2.0;}
\DoxyCodeLine{00453 }
\DoxyCodeLine{00454   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} image(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00455   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = image;}
\DoxyCodeLine{00456   \textcolor{keywordflow}{if} (vi) \{}
\DoxyCodeLine{00457     \textcolor{keywordtype}{bool} blackBg = ToonzCheck::instance()-\/>getChecks() \& \mbox{\hyperlink{class_toonz_check_add5b28b42f552cf90e3cfcde9e737876ab6d35869ac2f7cfc956d498b2089a1ff}{ToonzCheck::eBlackBg}};}
\DoxyCodeLine{00458     \textcolor{keywordflow}{if} (m\_eraseType.getValue() == RECT\_ERASE) \{}
\DoxyCodeLine{00459       TPixel color = blackBg ? TPixel32::White : TPixel32::Red;}
\DoxyCodeLine{00460       \textcolor{keywordflow}{if} (m\_multi.getValue() \&\& m\_firstFrameSelected)}
\DoxyCodeLine{00461         drawRect(m\_firstRect, color, 0x3F33, \textcolor{keyword}{true});}
\DoxyCodeLine{00462 }
\DoxyCodeLine{00463       \textcolor{keywordflow}{if} (m\_active || (m\_multi.getValue() \&\& !m\_firstFrameSelected))}
\DoxyCodeLine{00464         drawRect(m\_selectingRect, color, 0xFFFF, \textcolor{keyword}{true});}
\DoxyCodeLine{00465     \}}
\DoxyCodeLine{00466     \textcolor{keywordflow}{if} (m\_eraseType.getValue() == NORMAL\_ERASE) \{}
\DoxyCodeLine{00467       \textcolor{comment}{// If toggled off, don't draw brush outline}}
\DoxyCodeLine{00468       \textcolor{keywordflow}{if} (!Preferences::instance()-\/>isCursorOutlineEnabled()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00469 }
\DoxyCodeLine{00470       tglColor(TPixel32(255, 0, 255));}
\DoxyCodeLine{00471       tglDrawCircle(m\_brushPos, m\_pointSize);}
\DoxyCodeLine{00472     \}}
\DoxyCodeLine{00473     \textcolor{keywordflow}{if} ((m\_eraseType.getValue() == FREEHAND\_ERASE ||}
\DoxyCodeLine{00474          m\_eraseType.getValue() == POLYLINE\_ERASE ||}
\DoxyCodeLine{00475          m\_eraseType.getValue() == SEGMENT\_ERASE) \&\&}
\DoxyCodeLine{00476         m\_multi.getValue() \&\& m\_firstStroke) \{}
\DoxyCodeLine{00477       TPixel color = blackBg ? TPixel32::White : TPixel32::Red;}
\DoxyCodeLine{00478       tglColor(color);}
\DoxyCodeLine{00479       glPushAttrib(GL\_ALL\_ATTRIB\_BITS);}
\DoxyCodeLine{00480       glEnable(GL\_BLEND);}
\DoxyCodeLine{00481       glBlendFunc(GL\_ONE\_MINUS\_DST\_COLOR, GL\_ONE\_MINUS\_SRC\_ALPHA);}
\DoxyCodeLine{00482       \textcolor{keywordflow}{if} (m\_firstFrameSelected) \{}
\DoxyCodeLine{00483         glLineStipple(1, 0x3F33);}
\DoxyCodeLine{00484         glEnable(GL\_LINE\_STIPPLE);}
\DoxyCodeLine{00485       \}}
\DoxyCodeLine{00486       drawStrokeCenterline(*m\_firstStroke, 1);}
\DoxyCodeLine{00487       glPopAttrib();}
\DoxyCodeLine{00488     \}}
\DoxyCodeLine{00489     \textcolor{keywordflow}{if} (m\_eraseType.getValue() == POLYLINE\_ERASE \&\& !m\_polyline.empty()) \{}
\DoxyCodeLine{00490       TPixel color = blackBg ? TPixel32::White : TPixel32::Black;}
\DoxyCodeLine{00491       tglColor(color);}
\DoxyCodeLine{00492       tglDrawCircle(m\_polyline[0], 2);}
\DoxyCodeLine{00493       glBegin(GL\_LINE\_STRIP);}
\DoxyCodeLine{00494       \textcolor{keywordflow}{for} (UINT i = 0; i < m\_polyline.size(); i++) tglVertex(m\_polyline[i]);}
\DoxyCodeLine{00495       tglVertex(m\_mousePos);}
\DoxyCodeLine{00496       glEnd();}
\DoxyCodeLine{00497     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((m\_eraseType.getValue() == FREEHAND\_ERASE ||}
\DoxyCodeLine{00498                 m\_eraseType.getValue() == SEGMENT\_ERASE) \&\&}
\DoxyCodeLine{00499                !m\_track.\mbox{\hyperlink{class_stroke_generator_a85461eab47ef4791610974866efb61aa}{isEmpty}}()) \{}
\DoxyCodeLine{00500       TPixel color = blackBg ? TPixel32::White : TPixel32::Black;}
\DoxyCodeLine{00501       tglColor(color);}
\DoxyCodeLine{00502       glPushMatrix();}
\DoxyCodeLine{00503       m\_track.\mbox{\hyperlink{class_stroke_generator_a36ec59cf8b18831d60760706068c9c8f}{drawAllFragments}}();}
\DoxyCodeLine{00504       glPopMatrix();}
\DoxyCodeLine{00505     \}}
\DoxyCodeLine{00506   \}}
\DoxyCodeLine{00507 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00448}{draw()}}, \mbox{\hyperlink{l00224}{Stroke\+Generator\+::draw\+All\+Fragments()}}, \mbox{\hyperlink{l00044}{Toonz\+Check\+::e\+Black\+Bg}}, \mbox{\hyperlink{l00276}{TTool\+::get\+Image()}}, and \mbox{\hyperlink{l00025}{Stroke\+Generator\+::is\+Empty()}}.



Referenced by \mbox{\hyperlink{l00448}{draw()}}, and \mbox{\hyperlink{l01184}{on\+Leave()}}.

\mbox{\Hypertarget{class_eraser_tool_a8f2f959b506f641d499ce59a6092fc5b}\label{class_eraser_tool_a8f2f959b506f641d499ce59a6092fc5b}} 
\index{EraserTool@{EraserTool}!erase@{erase}}
\index{erase@{erase}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{erase()}{erase()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Eraser\+Tool\+::erase (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}}}]{vi,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00551                                                            \{}
\DoxyCodeLine{00552   std::vector<int>::iterator it = m\_indexes.begin();}
\DoxyCodeLine{00553   m\_distance2 += tdistance2(m\_oldMousePos, pos);}
\DoxyCodeLine{00554 }
\DoxyCodeLine{00555   \textcolor{keywordflow}{if} (m\_distance2 < minDistance2 * getPixelSize() * getPixelSize()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00556 }
\DoxyCodeLine{00557   m\_distance2   = 0;}
\DoxyCodeLine{00558   m\_oldMousePos = pos;}
\DoxyCodeLine{00559 }
\DoxyCodeLine{00560   \textcolor{comment}{// quadrato circoscritto alla circonferenza}}
\DoxyCodeLine{00561   \mbox{\hyperlink{class_t_rect_t}{TRectD}} circumscribedSquare(pos.x -\/ m\_pointSize, pos.y -\/ m\_pointSize,}
\DoxyCodeLine{00562                              pos.x + m\_pointSize, pos.y + m\_pointSize);}
\DoxyCodeLine{00563   \textcolor{keywordflow}{if} (!circumscribedSquare.overlaps(vi-\/>getBBox())) \{}
\DoxyCodeLine{00564     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00565     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00566   \}}
\DoxyCodeLine{00567 }
\DoxyCodeLine{00568   std::vector<double> intersections;}
\DoxyCodeLine{00569   std::vector<DoublePair> sortedWRanges;}
\DoxyCodeLine{00570 }
\DoxyCodeLine{00571   std::vector<TStroke *> splitStrokes;}
\DoxyCodeLine{00572   \textcolor{keywordtype}{double} rectEdge\_2 = m\_pointSize * M\_SQRT1\_2;}
\DoxyCodeLine{00573 }
\DoxyCodeLine{00574   \textcolor{comment}{// quadrato iscritto nella circonferenza}}
\DoxyCodeLine{00575   \mbox{\hyperlink{class_t_rect_t}{TRectD}} enrolledSquare(pos.x -\/ rectEdge\_2, pos.y -\/ rectEdge\_2,}
\DoxyCodeLine{00576                         pos.x + rectEdge\_2, pos.y + rectEdge\_2);}
\DoxyCodeLine{00577 }
\DoxyCodeLine{00578   UINT i            = 0;}
\DoxyCodeLine{00579   \textcolor{keywordtype}{double} pointSize2 = sq(m\_pointSize);}
\DoxyCodeLine{00580 }
\DoxyCodeLine{00581   std::vector<int> oneStrokeIndex(1);}
\DoxyCodeLine{00582   \textcolor{keywordtype}{int} index = TTool::getApplication()-\/>getCurrentLevelStyleIndex();}
\DoxyCodeLine{00583   QMutexLocker lock(vi-\/>getMutex());}
\DoxyCodeLine{00584   \textcolor{keywordflow}{while} (i < vi-\/>getStrokeCount()) \{}
\DoxyCodeLine{00585     assert(it != m\_indexes.end());}
\DoxyCodeLine{00586 }
\DoxyCodeLine{00587     \mbox{\hyperlink{class_t_stroke}{TStroke}} *oldStroke = vi-\/>getStroke(i);}
\DoxyCodeLine{00588     \textcolor{keywordflow}{if} (!vi-\/>inCurrentGroup(i) ||}
\DoxyCodeLine{00589         (m\_selective.getValue() \&\& oldStroke-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}() != index)) \{}
\DoxyCodeLine{00590       i++;}
\DoxyCodeLine{00591       it++;}
\DoxyCodeLine{00592       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00593     \}}
\DoxyCodeLine{00594 }
\DoxyCodeLine{00595     \mbox{\hyperlink{class_t_rect_t}{TRectD}} strokeBBox = oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}();}
\DoxyCodeLine{00596 }
\DoxyCodeLine{00597     \textcolor{keywordflow}{if} (!circumscribedSquare.overlaps(strokeBBox)) \{  \textcolor{comment}{// stroke all'esterno del}}
\DoxyCodeLine{00598                                                       \textcolor{comment}{// quadrato circoscritto}}
\DoxyCodeLine{00599                                                       \textcolor{comment}{// alla circonferenxa}}
\DoxyCodeLine{00600       i++;}
\DoxyCodeLine{00601       it++;}
\DoxyCodeLine{00602       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00603     \}}
\DoxyCodeLine{00604 }
\DoxyCodeLine{00605     \textcolor{keywordflow}{if} (enrolledSquare.contains(strokeBBox)) \{  \textcolor{comment}{// stroke tutta contenuta nel}}
\DoxyCodeLine{00606                                                 \textcolor{comment}{// quadrato iscritto nella}}
\DoxyCodeLine{00607                                                 \textcolor{comment}{// circonferenza}}
\DoxyCodeLine{00608       \textcolor{keywordflow}{if} (*it != -\/1) m\_undo-\/>addOldStroke(*it, vi-\/>getVIStroke(i));}
\DoxyCodeLine{00609       oneStrokeIndex[0] = i;}
\DoxyCodeLine{00610       vi-\/>removeStrokes(oneStrokeIndex, \textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{00611 }
\DoxyCodeLine{00612       it = m\_indexes.erase(it);}
\DoxyCodeLine{00613       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00614     \}}
\DoxyCodeLine{00615 }
\DoxyCodeLine{00616     splitStrokes.clear();}
\DoxyCodeLine{00617     intersections.clear();}
\DoxyCodeLine{00618     \textcolor{comment}{/*int intersNum=*/}intersect(*oldStroke, pos, m\_pointSize, intersections);}
\DoxyCodeLine{00619 }
\DoxyCodeLine{00620     \textcolor{comment}{/*}}
\DoxyCodeLine{00621 \textcolor{comment}{\#ifdef \_DEBUG}}
\DoxyCodeLine{00622 \textcolor{comment}{if(intersections.size()==2 \&\& intersections[0]==intersections[1])}}
\DoxyCodeLine{00623 \textcolor{comment}{\{}}
\DoxyCodeLine{00624 \textcolor{comment}{intersections.clear();}}
\DoxyCodeLine{00625 \textcolor{comment}{intersect( *oldStroke, pos, m\_pointSize, intersections );}}
\DoxyCodeLine{00626 \textcolor{comment}{\}}}
\DoxyCodeLine{00627 \textcolor{comment}{\#endif}}
\DoxyCodeLine{00628 \textcolor{comment}{*/}}
\DoxyCodeLine{00629 }
\DoxyCodeLine{00630     \textcolor{keywordflow}{if} (intersections.empty()) \{}
\DoxyCodeLine{00631       \textcolor{comment}{// BASTEREBBE CONTROLLARE UN SOLO PUNTO PERCHE' SE LA}}
\DoxyCodeLine{00632       \textcolor{comment}{// STROKE NON INTERSECA IL CERCHIO E CONTENTIENE ALMENO}}
\DoxyCodeLine{00633       \textcolor{comment}{// UN PUNTO, LA CONTIENE TUTTA. MA SICCOME NON MI FIDO}}
\DoxyCodeLine{00634       \textcolor{comment}{// DELLA INTERSECT, NE CONTROLLO UN PAIO E AVVANTAGGIO (CON L' AND)}}
\DoxyCodeLine{00635       \textcolor{comment}{// IL NON CONTENIMENTO, DATO CHE E' MEGLIO CANCELLARE UNA COSA IN}}
\DoxyCodeLine{00636       \textcolor{comment}{// MENO, CHE UNA IN PIU'}}
\DoxyCodeLine{00637       \textcolor{keywordflow}{if} (tdistance2(oldStroke-\/>\mbox{\hyperlink{class_t_stroke_ace861e064b925c5d41a6d7381ae6ada5}{getPoint}}(0), pos) < pointSize2 \&\&}
\DoxyCodeLine{00638           tdistance2(oldStroke-\/>\mbox{\hyperlink{class_t_stroke_ace861e064b925c5d41a6d7381ae6ada5}{getPoint}}(1), pos) <}
\DoxyCodeLine{00639               pointSize2) \{  \textcolor{comment}{// stroke tutta contenuta nella circonferenxa}}
\DoxyCodeLine{00640         \textcolor{keywordflow}{if} (*it != -\/1) m\_undo-\/>addOldStroke(*it, vi-\/>getVIStroke(i));}
\DoxyCodeLine{00641         oneStrokeIndex[0] = i;}
\DoxyCodeLine{00642         vi-\/>removeStrokes(oneStrokeIndex, \textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{00643         it = m\_indexes.erase(it);}
\DoxyCodeLine{00644       \} \textcolor{keywordflow}{else} \{  \textcolor{comment}{// non colpita}}
\DoxyCodeLine{00645         i++;}
\DoxyCodeLine{00646         it++;}
\DoxyCodeLine{00647       \}}
\DoxyCodeLine{00648       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00649     \}}
\DoxyCodeLine{00650 }
\DoxyCodeLine{00651     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ almeno un'intersezione}}
\DoxyCodeLine{00652     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00653 }
\DoxyCodeLine{00654     \textcolor{keywordflow}{if} (intersections.size() == 1) \{}
\DoxyCodeLine{00655       \textcolor{keywordflow}{if} (oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a3565d6c34d3eb02fb1a6993ca626425c}{isSelfLoop}}()) \{  \textcolor{comment}{// una sola intersezione di una stroke}}
\DoxyCodeLine{00656                                       \textcolor{comment}{// chiusa con un cerchio dovrebbe accadere}}
\DoxyCodeLine{00657         \textcolor{comment}{// solo in caso di sfioramento, quindi faccio finta di nulla}}
\DoxyCodeLine{00658         i++;}
\DoxyCodeLine{00659         it++;}
\DoxyCodeLine{00660         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00661       \}}
\DoxyCodeLine{00662 }
\DoxyCodeLine{00663       \textcolor{keywordflow}{if} (*it != -\/1) m\_undo-\/>addOldStroke(*it, vi-\/>getVIStroke(i));}
\DoxyCodeLine{00664 }
\DoxyCodeLine{00665       \textcolor{keywordtype}{double} w0            = intersections[0];}
\DoxyCodeLine{00666       \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} hitPoint = oldStroke-\/>\mbox{\hyperlink{class_t_stroke_ada4f6fc3fea4a7c0b949cd1d9dc6e640}{getThickPoint}}(w0);}
\DoxyCodeLine{00667       \textcolor{keywordtype}{int} chunck;}
\DoxyCodeLine{00668       \textcolor{keywordtype}{double} t;}
\DoxyCodeLine{00669       oldStroke-\/>\mbox{\hyperlink{class_t_stroke_aa984dd40b1109e4afeae144085d11c7e}{getChunkAndT}}(w0, chunck, t);}
\DoxyCodeLine{00670 }
\DoxyCodeLine{00671       \textcolor{keywordtype}{int} chunckIndex;}
\DoxyCodeLine{00672       \textcolor{keywordtype}{double} w1;}
\DoxyCodeLine{00673       \textcolor{keywordflow}{if} (tdistance2(oldStroke-\/>\mbox{\hyperlink{class_t_stroke_ace861e064b925c5d41a6d7381ae6ada5}{getPoint}}(0), pos) < pointSize2) \{}
\DoxyCodeLine{00674         chunckIndex = oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a81b63663a798724333d8de692fdbcac0}{getChunkCount}}() -\/ 1;}
\DoxyCodeLine{00675         w1          = 1;}
\DoxyCodeLine{00676       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00677         chunckIndex = 0;}
\DoxyCodeLine{00678         w1          = 0;}
\DoxyCodeLine{00679       \}}
\DoxyCodeLine{00680 }
\DoxyCodeLine{00681       UINT cI;}
\DoxyCodeLine{00682       std::vector<TThickPoint> points;}
\DoxyCodeLine{00683       \textcolor{keywordflow}{if} (w1 == 0) \{}
\DoxyCodeLine{00684         \textcolor{keywordflow}{for} (cI = chunckIndex; cI < (UINT)chunck; cI++) \{}
\DoxyCodeLine{00685           points.push\_back(oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a06b18ffed330411aad73ef1748a3f263}{getChunk}}(cI)-\/>\mbox{\hyperlink{class_t_thick_quadratic_abf58f97664876561f84fa68a90f33d8b}{getThickP0}}());}
\DoxyCodeLine{00686           points.push\_back(oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a06b18ffed330411aad73ef1748a3f263}{getChunk}}(cI)-\/>\mbox{\hyperlink{class_t_thick_quadratic_a77408faf6a40d919069ca5ce7733169a}{getThickP1}}());}
\DoxyCodeLine{00687         \}}
\DoxyCodeLine{00688 }
\DoxyCodeLine{00689         \mbox{\hyperlink{class_t_thick_quadratic}{TThickQuadratic}} t1, t2;}
\DoxyCodeLine{00690         oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a06b18ffed330411aad73ef1748a3f263}{getChunk}}(chunck)-\/>split(t, t1, t2);}
\DoxyCodeLine{00691         points.push\_back(t1.\mbox{\hyperlink{class_t_thick_quadratic_abf58f97664876561f84fa68a90f33d8b}{getThickP0}}());}
\DoxyCodeLine{00692         points.push\_back(t1.\mbox{\hyperlink{class_t_thick_quadratic_a77408faf6a40d919069ca5ce7733169a}{getThickP1}}());}
\DoxyCodeLine{00693         points.push\_back(hitPoint);}
\DoxyCodeLine{00694       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00695         \mbox{\hyperlink{class_t_thick_quadratic}{TThickQuadratic}} t1, t2;}
\DoxyCodeLine{00696         oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a06b18ffed330411aad73ef1748a3f263}{getChunk}}(chunck)-\/>split(t, t1, t2);}
\DoxyCodeLine{00697         points.push\_back(hitPoint);}
\DoxyCodeLine{00698         points.push\_back(t2.\mbox{\hyperlink{class_t_thick_quadratic_a77408faf6a40d919069ca5ce7733169a}{getThickP1}}());}
\DoxyCodeLine{00699         points.push\_back(t2.\mbox{\hyperlink{class_t_thick_quadratic_aa33c22ffd048565884c957888a677f83}{getThickP2}}());}
\DoxyCodeLine{00700 }
\DoxyCodeLine{00701         \textcolor{keywordflow}{for} (cI = chunck + 1; cI <= (UINT)chunckIndex; cI++) \{}
\DoxyCodeLine{00702           points.push\_back(oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a06b18ffed330411aad73ef1748a3f263}{getChunk}}(cI)-\/>\mbox{\hyperlink{class_t_thick_quadratic_a77408faf6a40d919069ca5ce7733169a}{getThickP1}}());}
\DoxyCodeLine{00703           points.push\_back(oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a06b18ffed330411aad73ef1748a3f263}{getChunk}}(cI)-\/>\mbox{\hyperlink{class_t_thick_quadratic_aa33c22ffd048565884c957888a677f83}{getThickP2}}());}
\DoxyCodeLine{00704         \}}
\DoxyCodeLine{00705       \}}
\DoxyCodeLine{00706 }
\DoxyCodeLine{00707       oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a939e478aa10028d3e5787a8cfe6c901d}{reshape}}(\&(points[0]), points.size());}
\DoxyCodeLine{00708 }
\DoxyCodeLine{00709       vi-\/>notifyChangedStrokes(i);  \textcolor{comment}{// per adesso cosi', pero' e' lento}}
\DoxyCodeLine{00710 }
\DoxyCodeLine{00711       *it = -\/1;}
\DoxyCodeLine{00712       i++;}
\DoxyCodeLine{00713       it++;}
\DoxyCodeLine{00714       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00715     \}}
\DoxyCodeLine{00716 }
\DoxyCodeLine{00717     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ piu'}}
\DoxyCodeLine{00718     \textcolor{comment}{// intersezioni-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00719 }
\DoxyCodeLine{00720     \textcolor{keywordflow}{if} (intersections.size() \& 1 \&\&}
\DoxyCodeLine{00721         oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a3565d6c34d3eb02fb1a6993ca626425c}{isSelfLoop}}()) \{  \textcolor{comment}{// non dovrebbe mai accadere}}
\DoxyCodeLine{00722       assert(0);}
\DoxyCodeLine{00723       i++;}
\DoxyCodeLine{00724       it++;}
\DoxyCodeLine{00725       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00726     \}}
\DoxyCodeLine{00727 }
\DoxyCodeLine{00728     \textcolor{keywordflow}{if} (intersections.size() == 2 \&\&}
\DoxyCodeLine{00729         intersections[0] == intersections[1]) \{  \textcolor{comment}{// solo sfiorata}}
\DoxyCodeLine{00730       i++;}
\DoxyCodeLine{00731       it++;}
\DoxyCodeLine{00732       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00733     \}}
\DoxyCodeLine{00734 }
\DoxyCodeLine{00735     UINT oldStrokeSize = vi-\/>getStrokeCount();}
\DoxyCodeLine{00736 }
\DoxyCodeLine{00737     \textcolor{keywordflow}{if} (*it != -\/1) m\_undo-\/>addOldStroke(*it, vi-\/>getVIStroke(i));}
\DoxyCodeLine{00738 }
\DoxyCodeLine{00739     sortedWRanges.clear();}
\DoxyCodeLine{00740 }
\DoxyCodeLine{00741     \textcolor{keywordflow}{if} (tdistance2(vi-\/>getStroke(i)-\/>getPoint(0), pos) > pointSize2) \{}
\DoxyCodeLine{00742       \textcolor{keywordflow}{if} (intersections[0] == 0.0)}
\DoxyCodeLine{00743         intersections.erase(intersections.begin());}
\DoxyCodeLine{00744       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00745         intersections.insert(intersections.begin(), 0.0);}
\DoxyCodeLine{00746     \}}
\DoxyCodeLine{00747 }
\DoxyCodeLine{00748     \textcolor{keywordflow}{if} (intersections[0] != 1.0) intersections.push\_back(1.0);}
\DoxyCodeLine{00749 }
\DoxyCodeLine{00750     sortedWRanges.reserve(intersections.size() / 2);}
\DoxyCodeLine{00751 }
\DoxyCodeLine{00752     \textcolor{keywordflow}{for} (UINT j = 0; j < intersections.size() -\/ 1; j += 2)}
\DoxyCodeLine{00753       sortedWRanges.push\_back(}
\DoxyCodeLine{00754           std::make\_pair(intersections[j], intersections[j + 1]));}
\DoxyCodeLine{00755 }
\DoxyCodeLine{00756 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{00757 }
\DoxyCodeLine{00758     \textcolor{keywordflow}{for} (UINT kkk = 0; kkk < sortedWRanges.size() -\/ 1; kkk++) \{}
\DoxyCodeLine{00759       assert(sortedWRanges[kkk].first < sortedWRanges[kkk].second);}
\DoxyCodeLine{00760       assert(sortedWRanges[kkk].second <= sortedWRanges[kkk + 1].first);}
\DoxyCodeLine{00761     \}}
\DoxyCodeLine{00762     assert(sortedWRanges.back().first < sortedWRanges.back().second);}
\DoxyCodeLine{00763 }
\DoxyCodeLine{00764 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00765 }
\DoxyCodeLine{00766     vi-\/>splitStroke(i, sortedWRanges);}
\DoxyCodeLine{00767 }
\DoxyCodeLine{00768     UINT addedStroke = vi-\/>getStrokeCount() -\/}
\DoxyCodeLine{00769                        (oldStrokeSize -\/ 1);  \textcolor{comment}{//-\/1 perche' e' quella tolta}}
\DoxyCodeLine{00770 }
\DoxyCodeLine{00771     i += addedStroke;}
\DoxyCodeLine{00772 }
\DoxyCodeLine{00773     *it = -\/1;}
\DoxyCodeLine{00774     m\_indexes.insert(it, addedStroke -\/ 1, -\/1);}
\DoxyCodeLine{00775     it = m\_indexes.begin() + i;}
\DoxyCodeLine{00776   \}}
\DoxyCodeLine{00777 }
\DoxyCodeLine{00778   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00779 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_eraser_tool_a6a91903ca89d04c30d8249c0b029856e}\label{class_eraser_tool_a6a91903ca89d04c30d8249c0b029856e}} 
\index{EraserTool@{EraserTool}!erase@{erase}}
\index{erase@{erase}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{erase()}{erase()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Eraser\+Tool\+::erase (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}}}]{vi,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00783                                                      \{}
\DoxyCodeLine{00784   \textcolor{keywordflow}{if} (rect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} > rect.x1) std::swap(rect.x1, rect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}});}
\DoxyCodeLine{00785   \textcolor{keywordflow}{if} (rect.y0 > rect.y1) std::swap(rect.y1, rect.y0);}
\DoxyCodeLine{00786   \textcolor{keywordtype}{int} i     = 0;}
\DoxyCodeLine{00787   \textcolor{keywordtype}{int} index = TTool::getApplication()-\/>getCurrentLevelStyleIndex();}
\DoxyCodeLine{00788   std::vector<int> eraseStrokes;}
\DoxyCodeLine{00789 }
\DoxyCodeLine{00790   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *level =}
\DoxyCodeLine{00791       TTool::getApplication()-\/>getCurrentLevel()-\/>getSimpleLevel();}
\DoxyCodeLine{00792   m\_undo = \textcolor{keyword}{new} UndoEraser(level, \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}());}
\DoxyCodeLine{00793   \textcolor{keywordflow}{for} (i = 0; i < (int)vi-\/>getStrokeCount(); i++) \{}
\DoxyCodeLine{00794     \textcolor{keywordflow}{if} (!vi-\/>inCurrentGroup(i)) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00795     \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke = vi-\/>getStroke(i);}
\DoxyCodeLine{00796     \textcolor{keywordflow}{if} (!m\_invertOption.getValue()) \{}
\DoxyCodeLine{00797       \textcolor{keywordflow}{if} ((!m\_selective.getValue() || stroke-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}() == index) \&\&}
\DoxyCodeLine{00798           rect.contains(stroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}())) \{}
\DoxyCodeLine{00799         m\_undo-\/>addOldStroke(i, vi-\/>getVIStroke(i));}
\DoxyCodeLine{00800         eraseStrokes.push\_back(i);}
\DoxyCodeLine{00801       \}}
\DoxyCodeLine{00802     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00803       \textcolor{keywordflow}{if} ((!m\_selective.getValue() || stroke-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}() == index) \&\&}
\DoxyCodeLine{00804           !rect.contains(stroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}())) \{}
\DoxyCodeLine{00805         m\_undo-\/>addOldStroke(i, vi-\/>getVIStroke(i));}
\DoxyCodeLine{00806         eraseStrokes.push\_back(i);}
\DoxyCodeLine{00807       \}}
\DoxyCodeLine{00808     \}}
\DoxyCodeLine{00809   \}}
\DoxyCodeLine{00810   \textcolor{keywordflow}{for} (i = (\textcolor{keywordtype}{int})eraseStrokes.size() -\/ 1; i >= 0; i-\/-\/)}
\DoxyCodeLine{00811     vi-\/>deleteStroke(eraseStrokes[i]);}
\DoxyCodeLine{00812   TUndoManager::manager()-\/>add(m\_undo);}
\DoxyCodeLine{00813   m\_undo = 0;}
\DoxyCodeLine{00814   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00815 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_eraser_tool_aebdb04386db322fe5627cb013c1a736b}\label{class_eraser_tool_aebdb04386db322fe5627cb013c1a736b}} 
\index{EraserTool@{EraserTool}!getCursorId@{getCursorId}}
\index{getCursorId@{getCursorId}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{getCursorId()}{getCursorId()}}
{\footnotesize\ttfamily int Eraser\+Tool\+::get\+Cursor\+Id (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Returns the type of cursor used by the tool. 

\begin{DoxySeeAlso}{See also}
For a list of cursor ids \mbox{\hyperlink{}{cursor.\+h}} 
\end{DoxySeeAlso}


Reimplemented from \mbox{\hyperlink{class_t_tool_a1768a57b8b6d1480618fd923fad15f1d}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00291 \{ \textcolor{keywordflow}{return} ToolCursor::EraserCursor; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_eraser_tool_a04ff12e49b87c220ef550553de7928ba}\label{class_eraser_tool_a04ff12e49b87c220ef550553de7928ba}} 
\index{EraserTool@{EraserTool}!getProperties@{getProperties}}
\index{getProperties@{getProperties}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{getProperties()}{getProperties()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_property_group}{TProperty\+Group}} $\ast$ Eraser\+Tool\+::get\+Properties (\begin{DoxyParamCaption}\item[{int}]{target\+Type }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00289 \{ \textcolor{keywordflow}{return} \&m\_prop; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_eraser_tool_a972afb01f91f1d7cff87dd5ea3e8335a}\label{class_eraser_tool_a972afb01f91f1d7cff87dd5ea3e8335a}} 
\index{EraserTool@{EraserTool}!getToolType@{getToolType}}
\index{getToolType@{getToolType}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{getToolType()}{getToolType()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296c}{Tool\+Type}} Eraser\+Tool\+::get\+Tool\+Type (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00266 \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296ca01ffd66b00b05a88c02ce8ceb5da3b8b}{TTool::LevelWriteTool}}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_eraser_tool_a9b2fccbc45990f9a5388ddad938c9845}\label{class_eraser_tool_a9b2fccbc45990f9a5388ddad938c9845}} 
\index{EraserTool@{EraserTool}!leftButtonDoubleClick@{leftButtonDoubleClick}}
\index{leftButtonDoubleClick@{leftButtonDoubleClick}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDoubleClick()}{leftButtonDoubleClick()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::left\+Button\+Double\+Click (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Viene chiusa la polyline e si da il via alla cancellazione. 

Viene creato lo {\bfseries{stroke}} rappresentante la polyline disegnata. Se e\textquotesingle{} selzionato il metodo di cancellazione \char`\"{}frame range\char`\"{} viene richiamato il metodo {\bfseries{multi\+Ereser\+Region}}, altrimenti viene richiamato il metodo {\bfseries{erase\+Region}} 

Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01063                                                              \{}
\DoxyCodeLine{01064   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = \mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true});}
\DoxyCodeLine{01065   \textcolor{keywordflow}{if} (m\_eraseType.getValue() == POLYLINE\_ERASE) \{}
\DoxyCodeLine{01066     closePolyline(pos);}
\DoxyCodeLine{01067 }
\DoxyCodeLine{01068     std::vector<TThickPoint> strokePoints;}
\DoxyCodeLine{01069     \textcolor{keywordflow}{for} (UINT i = 0; i < m\_polyline.size() -\/ 1; i++) \{}
\DoxyCodeLine{01070       strokePoints.push\_back(\mbox{\hyperlink{class_t_thick_point}{TThickPoint}}(m\_polyline[i], 1));}
\DoxyCodeLine{01071       strokePoints.push\_back(}
\DoxyCodeLine{01072           \mbox{\hyperlink{class_t_thick_point}{TThickPoint}}(0.5 * (m\_polyline[i] + m\_polyline[i + 1]), 1));}
\DoxyCodeLine{01073     \}}
\DoxyCodeLine{01074     strokePoints.push\_back(\mbox{\hyperlink{class_t_thick_point}{TThickPoint}}(m\_polyline.back(), 1));}
\DoxyCodeLine{01075     m\_polyline.clear();}
\DoxyCodeLine{01076     \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}(strokePoints);}
\DoxyCodeLine{01077     assert(stroke-\/>\mbox{\hyperlink{class_t_stroke_ace861e064b925c5d41a6d7381ae6ada5}{getPoint}}(0) == stroke-\/>\mbox{\hyperlink{class_t_stroke_ace861e064b925c5d41a6d7381ae6ada5}{getPoint}}(1));}
\DoxyCodeLine{01078     \textcolor{keywordflow}{if} (m\_multi.getValue())}
\DoxyCodeLine{01079       multiErase(stroke, e, \&EraserTool::eraseRegion);}
\DoxyCodeLine{01080     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01081       eraseRegion(vi, stroke);}
\DoxyCodeLine{01082       m\_active = \textcolor{keyword}{false};}
\DoxyCodeLine{01083       \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{01084     \}}
\DoxyCodeLine{01085     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{01086   \}}
\DoxyCodeLine{01087 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00276}{TTool\+::get\+Image()}}, \mbox{\hyperlink{l00236}{TStroke\+::get\+Point()}}, \mbox{\hyperlink{l00540}{TTool\+::invalidate()}}, \mbox{\hyperlink{l01062}{left\+Button\+Double\+Click()}}, and \mbox{\hyperlink{l00609}{TTool\+::notify\+Image\+Changed()}}.



Referenced by \mbox{\hyperlink{l01062}{left\+Button\+Double\+Click()}}.

\mbox{\Hypertarget{class_eraser_tool_adc44ceeac1ae6d7983a26050c2764bc4}\label{class_eraser_tool_adc44ceeac1ae6d7983a26050c2764bc4}} 
\index{EraserTool@{EraserTool}!leftButtonDown@{leftButtonDown}}
\index{leftButtonDown@{leftButtonDown}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDown()}{leftButtonDown()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::left\+Button\+Down (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00838                                                                         \{}
\DoxyCodeLine{00839   m\_brushPos = m\_mousePos = pos;}
\DoxyCodeLine{00840 }
\DoxyCodeLine{00841   m\_active = \textcolor{keyword}{true};}
\DoxyCodeLine{00842 }
\DoxyCodeLine{00843   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} image(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true}));}
\DoxyCodeLine{00844   m\_activeImage = image;}
\DoxyCodeLine{00845   \textcolor{keywordflow}{if} (m\_eraseType.getValue() == NORMAL\_ERASE) \{}
\DoxyCodeLine{00846     \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = image) startErase(vi, pos \textcolor{comment}{/*,imageLocation*/});}
\DoxyCodeLine{00847   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == RECT\_ERASE) \{}
\DoxyCodeLine{00848     m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} = pos.x;}
\DoxyCodeLine{00849     m\_selectingRect.y0 = pos.y;}
\DoxyCodeLine{00850     m\_selectingRect.x1 = pos.x + 1;}
\DoxyCodeLine{00851     m\_selectingRect.y1 = pos.y + 1;}
\DoxyCodeLine{00852     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00853   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == FREEHAND\_ERASE ||}
\DoxyCodeLine{00854              m\_eraseType.getValue() == SEGMENT\_ERASE) \{}
\DoxyCodeLine{00855     startFreehand(pos);}
\DoxyCodeLine{00856   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == POLYLINE\_ERASE) \{}
\DoxyCodeLine{00857     addPointPolyline(pos);}
\DoxyCodeLine{00858   \}}
\DoxyCodeLine{00859 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_eraser_tool_a5858cb6b17a3c0cb190292d2caf7b492}\label{class_eraser_tool_a5858cb6b17a3c0cb190292d2caf7b492}} 
\index{EraserTool@{EraserTool}!leftButtonDrag@{leftButtonDrag}}
\index{leftButtonDrag@{leftButtonDrag}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDrag()}{leftButtonDrag()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::left\+Button\+Drag (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00863                                                                         \{}
\DoxyCodeLine{00864   m\_brushPos = m\_mousePos = pos;}
\DoxyCodeLine{00865 }
\DoxyCodeLine{00866   \textcolor{keywordflow}{if} (!m\_active) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00867 }
\DoxyCodeLine{00868   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} image(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true}));}
\DoxyCodeLine{00869   \textcolor{keywordflow}{if} (m\_eraseType.getValue() == RECT\_ERASE) \{}
\DoxyCodeLine{00870     m\_selectingRect.x1 = pos.x;}
\DoxyCodeLine{00871     m\_selectingRect.y1 = pos.y;}
\DoxyCodeLine{00872     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00873     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00874   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == NORMAL\_ERASE) \{}
\DoxyCodeLine{00875     \textcolor{keywordflow}{if} (!m\_undo) leftButtonDown(pos, e);}
\DoxyCodeLine{00876     \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = image) erase(vi, pos);}
\DoxyCodeLine{00877   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == FREEHAND\_ERASE ||}
\DoxyCodeLine{00878              m\_eraseType.getValue() == SEGMENT\_ERASE) \{}
\DoxyCodeLine{00879     freehandDrag(pos);}
\DoxyCodeLine{00880   \}}
\DoxyCodeLine{00881 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_eraser_tool_a8b7408031c2b732808e324342c392411}\label{class_eraser_tool_a8b7408031c2b732808e324342c392411}} 
\index{EraserTool@{EraserTool}!leftButtonUp@{leftButtonUp}}
\index{leftButtonUp@{leftButtonUp}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{leftButtonUp()}{leftButtonUp()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::left\+Button\+Up (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00983                                                                       \{}
\DoxyCodeLine{00984   \textcolor{keywordflow}{if} (!m\_active) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00985   m\_active = \textcolor{keyword}{false};}
\DoxyCodeLine{00986   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} image(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true}));}
\DoxyCodeLine{00987   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = image;}
\DoxyCodeLine{00988 }
\DoxyCodeLine{00989   \mbox{\hyperlink{class_t_application}{TTool::Application}} *application = TTool::getApplication();}
\DoxyCodeLine{00990   \textcolor{keywordflow}{if} (!vi || !application) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00991   \textcolor{keywordflow}{if} (m\_eraseType.getValue() == NORMAL\_ERASE) \{}
\DoxyCodeLine{00992     \textcolor{keywordflow}{if} (!m\_undo) leftButtonDown(pos, e);}
\DoxyCodeLine{00993     stopErase(vi);}
\DoxyCodeLine{00994   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == RECT\_ERASE) \{}
\DoxyCodeLine{00995     \textcolor{keywordflow}{if} (m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} > m\_selectingRect.x1)}
\DoxyCodeLine{00996       std::swap(m\_selectingRect.x1, m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}});}
\DoxyCodeLine{00997     \textcolor{keywordflow}{if} (m\_selectingRect.y0 > m\_selectingRect.y1)}
\DoxyCodeLine{00998       std::swap(m\_selectingRect.y1, m\_selectingRect.y0);}
\DoxyCodeLine{00999 }
\DoxyCodeLine{01000     \textcolor{keywordflow}{if} (m\_multi.getValue()) \{}
\DoxyCodeLine{01001       \textcolor{keywordflow}{if} (m\_firstFrameSelected) \{}
\DoxyCodeLine{01002         multiEraseRect(m\_firstFrameId, \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}(), m\_firstRect,}
\DoxyCodeLine{01003                        m\_selectingRect, m\_invertOption.getValue());}
\DoxyCodeLine{01004         \textcolor{keywordflow}{if} (e.isShiftPressed()) \{}
\DoxyCodeLine{01005           m\_firstRect    = m\_selectingRect;}
\DoxyCodeLine{01006           m\_firstFrameId = \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}();}
\DoxyCodeLine{01007         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01008           \textcolor{keywordflow}{if} (application-\/>getCurrentFrame()-\/>isEditingScene()) \{}
\DoxyCodeLine{01009             application-\/>getCurrentColumn()-\/>setColumnIndex(m\_currCell.first);}
\DoxyCodeLine{01010             application-\/>getCurrentFrame()-\/>setFrame(m\_currCell.second);}
\DoxyCodeLine{01011           \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01012             application-\/>getCurrentFrame()-\/>setFid(m\_veryFirstFrameId);}
\DoxyCodeLine{01013           resetMulti();}
\DoxyCodeLine{01014         \}}
\DoxyCodeLine{01015         \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();  \textcolor{comment}{// invalidate(m\_selectingRect.enlarge(2));}}
\DoxyCodeLine{01016       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01017         \textcolor{keywordflow}{if} (application-\/>getCurrentFrame()-\/>isEditingScene())}
\DoxyCodeLine{01018           m\_currCell = std::pair<int, int>(}
\DoxyCodeLine{01019               application-\/>getCurrentColumn()-\/>getColumnIndex(),}
\DoxyCodeLine{01020               application-\/>getCurrentFrame()-\/>getFrame());}
\DoxyCodeLine{01021       \}}
\DoxyCodeLine{01022       \textcolor{keywordflow}{return};}
\DoxyCodeLine{01023     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01024       erase(vi, m\_selectingRect);}
\DoxyCodeLine{01025       \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{01026       m\_selectingRect.empty();}
\DoxyCodeLine{01027     \}}
\DoxyCodeLine{01028   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == FREEHAND\_ERASE) \{}
\DoxyCodeLine{01029     closeFreehand(pos);}
\DoxyCodeLine{01030     \textcolor{keywordflow}{if} (m\_multi.getValue()) \{}
\DoxyCodeLine{01031       multiErase(m\_stroke, e, \&EraserTool::eraseRegion);}
\DoxyCodeLine{01032       \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{01033     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01034       eraseRegion(vi, m\_stroke);}
\DoxyCodeLine{01035       \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{01036       \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{01037     \}}
\DoxyCodeLine{01038     m\_track.\mbox{\hyperlink{class_stroke_generator_a4a78460714a37e461296d169715ba460}{clear}}();}
\DoxyCodeLine{01039   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == SEGMENT\_ERASE) \{}
\DoxyCodeLine{01040     \textcolor{keywordtype}{double} error = (30.0 / 11) * sqrt(getPixelSize() * getPixelSize());}
\DoxyCodeLine{01041     m\_stroke     = m\_track.\mbox{\hyperlink{class_stroke_generator_a647b44a77222a0d8b4bc21db2fdb9f93}{makeStroke}}(error);}
\DoxyCodeLine{01042     m\_stroke-\/>\mbox{\hyperlink{class_t_stroke_a33f59dfbed74b577700351eac8c2fc7b}{setStyle}}(1);}
\DoxyCodeLine{01043     \textcolor{keywordflow}{if} (m\_multi.getValue()) \{}
\DoxyCodeLine{01044       multiErase(m\_stroke, e, \&EraserTool::eraseSegments);}
\DoxyCodeLine{01045       \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{01046     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01047       eraseSegments(vi, m\_stroke);}
\DoxyCodeLine{01048       \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{01049       \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{01050     \}}
\DoxyCodeLine{01051     m\_track.\mbox{\hyperlink{class_stroke_generator_a4a78460714a37e461296d169715ba460}{clear}}();}
\DoxyCodeLine{01052   \}}
\DoxyCodeLine{01053 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_eraser_tool_a3a9024219f9ce4cfb890b8209689cdf4}\label{class_eraser_tool_a3a9024219f9ce4cfb890b8209689cdf4}} 
\index{EraserTool@{EraserTool}!mouseMove@{mouseMove}}
\index{mouseMove@{mouseMove}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{mouseMove()}{mouseMove()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::mouse\+Move (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01091                                                                    \{}
\DoxyCodeLine{01092   \textcolor{keyword}{struct }Locals \{}
\DoxyCodeLine{01093     \mbox{\hyperlink{class_eraser_tool}{EraserTool}} *m\_this;}
\DoxyCodeLine{01094 }
\DoxyCodeLine{01095     \textcolor{keywordtype}{void} setValue(\mbox{\hyperlink{class_t_range_property}{TDoubleProperty}} \&prop, \textcolor{keywordtype}{double} value) \{}
\DoxyCodeLine{01096       prop.setValue(value);}
\DoxyCodeLine{01097 }
\DoxyCodeLine{01098       m\_this-\/>\mbox{\hyperlink{class_eraser_tool_afcd9c815a5585364231a65a3102c3592}{onPropertyChanged}}(prop.getName());}
\DoxyCodeLine{01099       TTool::getApplication()-\/>getCurrentTool()-\/>\mbox{\hyperlink{class_tool_handle_a39e34f1a30868bad11a629228b07bd40}{notifyToolChanged}}();}
\DoxyCodeLine{01100     \}}
\DoxyCodeLine{01101 }
\DoxyCodeLine{01102     \textcolor{keywordtype}{void} addValue(\mbox{\hyperlink{class_t_range_property}{TDoubleProperty}} \&prop, \textcolor{keywordtype}{double} add) \{}
\DoxyCodeLine{01103       \textcolor{keyword}{const} TDoubleProperty::Range \&range = prop.getRange();}
\DoxyCodeLine{01104       setValue(prop, tcrop(prop.getValue() + add, range.first, range.second));}
\DoxyCodeLine{01105     \}}
\DoxyCodeLine{01106 }
\DoxyCodeLine{01107   \} locals = \{\textcolor{keyword}{this}\};}
\DoxyCodeLine{01108 }
\DoxyCodeLine{01109   \textcolor{keywordflow}{switch} (e.getModifiersMask()) \{}
\DoxyCodeLine{01110   \textcolor{keywordflow}{case} \mbox{\hyperlink{class_t_mouse_event_affce294e0ebf6961a40caf6d040f767fa27d3e5267c6700f12ac7dac4973c21da}{TMouseEvent::ALT\_KEY}}: \{}
\DoxyCodeLine{01111     \textcolor{comment}{// User wants to alter the maximum brush size}}
\DoxyCodeLine{01112     \textcolor{keyword}{const} \mbox{\hyperlink{class_t_point_t}{TPointD}} \&diff = pos -\/ m\_mousePos;}
\DoxyCodeLine{01113     \textcolor{keywordtype}{double} \mbox{\hyperlink{namespacetcg_1_1poly__ops_a2ce6c8bcbc58bd7f994a759686a09f87}{add}}          = (fabs(diff.x) > fabs(diff.y)) ? diff.x : diff.y;}
\DoxyCodeLine{01114 }
\DoxyCodeLine{01115     locals.addValue(m\_toolSize, add);}
\DoxyCodeLine{01116     \textcolor{keywordflow}{break};}
\DoxyCodeLine{01117   \}}
\DoxyCodeLine{01118 }
\DoxyCodeLine{01119   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01120     m\_brushPos = pos;}
\DoxyCodeLine{01121     \textcolor{keywordflow}{break};}
\DoxyCodeLine{01122   \}}
\DoxyCodeLine{01123 }
\DoxyCodeLine{01124   m\_oldMousePos = m\_mousePos = pos;}
\DoxyCodeLine{01125   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{01126 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_eraser_tool_a9412b875b79714088b675feedfe87baf}\label{class_eraser_tool_a9412b875b79714088b675feedfe87baf}} 
\index{EraserTool@{EraserTool}!onActivate@{onActivate}}
\index{onActivate@{onActivate}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{onActivate()}{onActivate()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::on\+Activate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback invoked whenever the tool activates. 



Reimplemented from \mbox{\hyperlink{class_t_tool_ac286a2681633b4db6106596b4f54e53b}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01191                             \{}
\DoxyCodeLine{01192   resetMulti();}
\DoxyCodeLine{01193   m\_polyline.clear();}
\DoxyCodeLine{01194   \mbox{\hyperlink{class_eraser_tool_ae7fce14dcfbe2341df60eea86c9b50e0}{onEnter}}();}
\DoxyCodeLine{01195 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l01191}{on\+Activate()}}, and \mbox{\hyperlink{l01156}{on\+Enter()}}.



Referenced by \mbox{\hyperlink{l01191}{on\+Activate()}}.

\mbox{\Hypertarget{class_eraser_tool_ab602657186ae68782460de011a075e1e}\label{class_eraser_tool_ab602657186ae68782460de011a075e1e}} 
\index{EraserTool@{EraserTool}!onDeactivate@{onDeactivate}}
\index{onDeactivate@{onDeactivate}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{onDeactivate()}{onDeactivate()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::on\+Deactivate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

When the tool is switched during dragging, Erase end processing is performed 

Reimplemented from \mbox{\hyperlink{class_t_tool_a00fee58728c1e12fb50846f47d7e9f5e}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01676                               \{}
\DoxyCodeLine{01677   \textcolor{keywordflow}{if} (!m\_active) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01678 }
\DoxyCodeLine{01679   m\_active = \textcolor{keyword}{false};}
\DoxyCodeLine{01680 }
\DoxyCodeLine{01681   \textcolor{comment}{// TODO : finishing erase procedure is only available for normal type.}}
\DoxyCodeLine{01682   \textcolor{comment}{// Supporting other types is needed. 2016/1/22 shun\_iwasawa}}
\DoxyCodeLine{01683   \textcolor{keywordflow}{if} (m\_eraseType.getValue() != NORMAL\_ERASE) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01684 }
\DoxyCodeLine{01685   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} image(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true}));}
\DoxyCodeLine{01686   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi                = image;}
\DoxyCodeLine{01687   \mbox{\hyperlink{class_t_application}{TTool::Application}} *application = TTool::getApplication();}
\DoxyCodeLine{01688   \textcolor{keywordflow}{if} (!vi || !application) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01689 }
\DoxyCodeLine{01690   stopErase(vi);}
\DoxyCodeLine{01691 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00276}{TTool\+::get\+Image()}}, and \mbox{\hyperlink{l01676}{on\+Deactivate()}}.



Referenced by \mbox{\hyperlink{l01676}{on\+Deactivate()}}.

\mbox{\Hypertarget{class_eraser_tool_ae7fce14dcfbe2341df60eea86c9b50e0}\label{class_eraser_tool_ae7fce14dcfbe2341df60eea86c9b50e0}} 
\index{EraserTool@{EraserTool}!onEnter@{onEnter}}
\index{onEnter@{onEnter}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{onEnter()}{onEnter()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::on\+Enter (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback for the mouse entering the viewer area. 



Reimplemented from \mbox{\hyperlink{class_t_tool_a3e775cfcd05aa3c35048b11fa40ab3e4}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01156                          \{}
\DoxyCodeLine{01157   \textcolor{keywordflow}{if} (m\_firstTime) \{}
\DoxyCodeLine{01158     m\_toolSize.setValue(EraseVectorSize);}
\DoxyCodeLine{01159     m\_eraseType.setValue(::to\_wstring(EraseVectorType.getValue()));}
\DoxyCodeLine{01160     m\_interpolation.setValue(::to\_wstring(EraseVectorInterpolation.getValue()));}
\DoxyCodeLine{01161     m\_selective.setValue(EraseVectorSelective ? 1 : 0);}
\DoxyCodeLine{01162     m\_invertOption.setValue(EraseVectorInvert ? 1 : 0);}
\DoxyCodeLine{01163     m\_multi.setValue(EraseVectorRange ? 1 : 0);}
\DoxyCodeLine{01164     m\_firstTime = \textcolor{keyword}{false};}
\DoxyCodeLine{01165   \}}
\DoxyCodeLine{01166 }
\DoxyCodeLine{01167   \textcolor{keywordtype}{double} x = m\_toolSize.getValue();}
\DoxyCodeLine{01168 }
\DoxyCodeLine{01169   \textcolor{keywordtype}{double} minRange = 1;}
\DoxyCodeLine{01170   \textcolor{keywordtype}{double} maxRange = 100;}
\DoxyCodeLine{01171 }
\DoxyCodeLine{01172   \textcolor{keywordtype}{double} minSize = 2;}
\DoxyCodeLine{01173   \textcolor{keywordtype}{double} maxSize = 100;}
\DoxyCodeLine{01174 }
\DoxyCodeLine{01175   m\_pointSize =}
\DoxyCodeLine{01176       ((x -\/ minRange) / (maxRange -\/ minRange) * (maxSize -\/ minSize) + minSize) *}
\DoxyCodeLine{01177       0.5;}
\DoxyCodeLine{01178 }
\DoxyCodeLine{01179   \textcolor{comment}{//  getApplication()-\/>editImage();}}
\DoxyCodeLine{01180 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l01156}{on\+Enter()}}.



Referenced by \mbox{\hyperlink{l01191}{on\+Activate()}}, and \mbox{\hyperlink{l01156}{on\+Enter()}}.

\mbox{\Hypertarget{class_eraser_tool_a55b8227fa7264a7c8f0b8c32e5b6d7f0}\label{class_eraser_tool_a55b8227fa7264a7c8f0b8c32e5b6d7f0}} 
\index{EraserTool@{EraserTool}!onImageChanged@{onImageChanged}}
\index{onImageChanged@{onImageChanged}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{onImageChanged()}{onImageChanged()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::on\+Image\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Notifies changes in the image in use. 



Reimplemented from \mbox{\hyperlink{class_t_tool_aaf1e021290e74c1b085e4b095668e1ed}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00950                                 \{}
\DoxyCodeLine{00951   \textcolor{keywordflow}{if} (m\_active) \{}
\DoxyCodeLine{00952     stopErase(m\_activeImage);}
\DoxyCodeLine{00953   \}}
\DoxyCodeLine{00954   \textcolor{keywordflow}{if} (!m\_multi.getValue()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00955   \mbox{\hyperlink{class_t_application}{TTool::Application}} *application = TTool::getApplication();}
\DoxyCodeLine{00956   \textcolor{keywordflow}{if} (!application) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00957   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *xshl = 0;}
\DoxyCodeLine{00958   \textcolor{keywordflow}{if} (application-\/>getCurrentLevel()-\/>getLevel())}
\DoxyCodeLine{00959     xshl = application-\/>getCurrentLevel()-\/>getLevel()-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{00960 }
\DoxyCodeLine{00961   \textcolor{keywordflow}{if} (!xshl || m\_level.getPointer() != xshl ||}
\DoxyCodeLine{00962       (m\_eraseType.getValue() == RECT\_ERASE \&\& m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) ||}
\DoxyCodeLine{00963       ((m\_eraseType.getValue() == FREEHAND\_ERASE ||}
\DoxyCodeLine{00964         m\_eraseType.getValue() == POLYLINE\_ERASE ||}
\DoxyCodeLine{00965         m\_eraseType.getValue() == SEGMENT\_ERASE) \&\&}
\DoxyCodeLine{00966        !m\_firstStroke))}
\DoxyCodeLine{00967     resetMulti();}
\DoxyCodeLine{00968   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_firstFrameId == \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}())}
\DoxyCodeLine{00969     m\_firstFrameSelected = \textcolor{keyword}{false};  \textcolor{comment}{// nel caso sono passato allo stato 1 e torno}}
\DoxyCodeLine{00970                                    \textcolor{comment}{// all'immagine iniziale, torno allo stato}}
\DoxyCodeLine{00971                                    \textcolor{comment}{// iniziale}}
\DoxyCodeLine{00972   \textcolor{keywordflow}{else} \{                           \textcolor{comment}{// cambio stato.}}
\DoxyCodeLine{00973     m\_firstFrameSelected = \textcolor{keyword}{true};}
\DoxyCodeLine{00974     \textcolor{keywordflow}{if} (m\_eraseType.getValue() == RECT\_ERASE) \{}
\DoxyCodeLine{00975       assert(!m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}());}
\DoxyCodeLine{00976       m\_firstRect = m\_selectingRect;}
\DoxyCodeLine{00977     \}}
\DoxyCodeLine{00978   \}}
\DoxyCodeLine{00979 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00688}{TTool\+::get\+Current\+Fid()}}, \mbox{\hyperlink{l00095}{TXsh\+Level\+::get\+Simple\+Level()}}, \mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{TRect\+T$<$ T $>$\+::is\+Empty()}}, and \mbox{\hyperlink{l00950}{on\+Image\+Changed()}}.



Referenced by \mbox{\hyperlink{l00950}{on\+Image\+Changed()}}.

\mbox{\Hypertarget{class_eraser_tool_a9d9e765cdb8805aa71fba45fa311fd35}\label{class_eraser_tool_a9d9e765cdb8805aa71fba45fa311fd35}} 
\index{EraserTool@{EraserTool}!onLeave@{onLeave}}
\index{onLeave@{onLeave}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{onLeave()}{onLeave()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::on\+Leave (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback for the mouse leaving the viewer area. 



Reimplemented from \mbox{\hyperlink{class_t_tool_af7fb05265a94131da081da654e271a22}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01184                          \{}
\DoxyCodeLine{01185   \mbox{\hyperlink{class_eraser_tool_a59979313b8409fd36025927655489c21}{draw}}();}
\DoxyCodeLine{01186   m\_pointSize = -\/1;}
\DoxyCodeLine{01187 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00448}{draw()}}, and \mbox{\hyperlink{l01184}{on\+Leave()}}.



Referenced by \mbox{\hyperlink{l01184}{on\+Leave()}}.

\mbox{\Hypertarget{class_eraser_tool_afcd9c815a5585364231a65a3102c3592}\label{class_eraser_tool_afcd9c815a5585364231a65a3102c3592}} 
\index{EraserTool@{EraserTool}!onPropertyChanged@{onPropertyChanged}}
\index{onPropertyChanged@{onPropertyChanged}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{onPropertyChanged()}{onPropertyChanged()}}
{\footnotesize\ttfamily bool Eraser\+Tool\+::on\+Property\+Changed (\begin{DoxyParamCaption}\item[{std\+::string}]{property\+Name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

\begin{DoxyVerb} Does the tasks associated to changes in \p propertyName and returns \p
\end{DoxyVerb}
 true; Does the tasks associated to changes in {\ttfamily property\+Name} and returns {\ttfamily true}. 

Reimplemented from \mbox{\hyperlink{class_t_tool_a06694e0586f807c34b18e16341aa9ee2}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01130                                                          \{}
\DoxyCodeLine{01131   EraseVectorType          = ::to\_string(m\_eraseType.getValue());}
\DoxyCodeLine{01132   EraseVectorInterpolation = ::to\_string(m\_interpolation.getValue());}
\DoxyCodeLine{01133   EraseVectorSize          = m\_toolSize.getValue();}
\DoxyCodeLine{01134   EraseVectorSelective     = m\_selective.getValue();}
\DoxyCodeLine{01135   EraseVectorInvert        = m\_invertOption.getValue();}
\DoxyCodeLine{01136   EraseVectorRange         = m\_multi.getValue();}
\DoxyCodeLine{01137 }
\DoxyCodeLine{01138   \textcolor{keywordtype}{double} x = m\_toolSize.getValue();}
\DoxyCodeLine{01139 }
\DoxyCodeLine{01140   \textcolor{keywordtype}{double} minRange = 1;}
\DoxyCodeLine{01141   \textcolor{keywordtype}{double} maxRange = 100;}
\DoxyCodeLine{01142 }
\DoxyCodeLine{01143   \textcolor{keywordtype}{double} minSize = 2;}
\DoxyCodeLine{01144   \textcolor{keywordtype}{double} maxSize = 100;}
\DoxyCodeLine{01145 }
\DoxyCodeLine{01146   m\_pointSize =}
\DoxyCodeLine{01147       ((x -\/ minRange) / (maxRange -\/ minRange) * (maxSize -\/ minSize) + minSize) *}
\DoxyCodeLine{01148       0.5;}
\DoxyCodeLine{01149   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{01150 }
\DoxyCodeLine{01151   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01152 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00540}{TTool\+::invalidate()}}, and \mbox{\hyperlink{l01130}{on\+Property\+Changed()}}.



Referenced by \mbox{\hyperlink{l01130}{on\+Property\+Changed()}}.

\mbox{\Hypertarget{class_eraser_tool_a58a66e61f4af88050c6d2964426d8401}\label{class_eraser_tool_a58a66e61f4af88050c6d2964426d8401}} 
\index{EraserTool@{EraserTool}!startErase@{startErase}}
\index{startErase@{startErase}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{startErase()}{startErase()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::start\+Erase (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}}}]{vi,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00535 \{}
\DoxyCodeLine{00536   UINT size = vi-\/>getStrokeCount();}
\DoxyCodeLine{00537   m\_indexes.resize(size);}
\DoxyCodeLine{00538   \textcolor{keywordflow}{for} (UINT i = 0; i < size; i++) m\_indexes[i] = i;}
\DoxyCodeLine{00539 }
\DoxyCodeLine{00540   \textcolor{keywordflow}{if} (m\_undo) \textcolor{keyword}{delete} m\_undo;}
\DoxyCodeLine{00541   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *level =}
\DoxyCodeLine{00542       TTool::getApplication()-\/>getCurrentLevel()-\/>getSimpleLevel();}
\DoxyCodeLine{00543   m\_undo        = \textcolor{keyword}{new} UndoEraser(level, \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}());}
\DoxyCodeLine{00544   m\_oldMousePos = pos;}
\DoxyCodeLine{00545   m\_distance2   = minDistance2 * getPixelSize() * getPixelSize();}
\DoxyCodeLine{00546   erase(vi, pos);}
\DoxyCodeLine{00547 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_eraser_tool_aca8fe891550b413569152153592119c1}\label{class_eraser_tool_aca8fe891550b413569152153592119c1}} 
\index{EraserTool@{EraserTool}!stopErase@{stopErase}}
\index{stopErase@{stopErase}!EraserTool@{EraserTool}}
\doxysubsubsection{\texorpdfstring{stopErase()}{stopErase()}}
{\footnotesize\ttfamily void Eraser\+Tool\+::stop\+Erase (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}}}]{vi }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00819                                            \{}
\DoxyCodeLine{00820   assert(m\_undo != 0);}
\DoxyCodeLine{00821 }
\DoxyCodeLine{00822   UINT size = m\_indexes.size();}
\DoxyCodeLine{00823 }
\DoxyCodeLine{00824   assert(size == vi-\/>getStrokeCount());}
\DoxyCodeLine{00825   UINT i = 0;}
\DoxyCodeLine{00826   \textcolor{keywordflow}{for} (; i < size; i++) \{}
\DoxyCodeLine{00827     \textcolor{keywordflow}{if} (m\_indexes[i] == -\/1) m\_undo-\/>addNewStroke(i, vi-\/>getVIStroke(i));}
\DoxyCodeLine{00828   \}}
\DoxyCodeLine{00829   TUndoManager::manager()-\/>add(m\_undo);}
\DoxyCodeLine{00830   m\_undo   = 0;}
\DoxyCodeLine{00831   m\_active = \textcolor{keyword}{false};}
\DoxyCodeLine{00832   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00833   \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{00834 \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/tnztools/vectorerasertool.\+cpp\end{DoxyCompactItemize}
