\hypertarget{class_file_viewer}{}\doxysection{File\+Viewer Class Reference}
\label{class_file_viewer}\index{FileViewer@{FileViewer}}
Inheritance diagram for File\+Viewer\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_file_viewer}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_file_viewer_a237399a847f0eccbd347a23e517c2a37}{File\+Viewer}} (QWidget $\ast$parent=0, Qt\+::\+WFlags flags=Qt\+::\+Tool)
\item 
void \mbox{\hyperlink{class_file_viewer_aa7ef9796fa411274642f0e6165b7c8e0}{set\+Path}} (const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&fp, int from=0, int to=0, int step=0, \mbox{\hyperlink{class_t_sound_track}{TSound\+Track}} $\ast$snd=0)
\item 
void \mbox{\hyperlink{class_file_viewer_a649e0943e83737c5c8e0fc15da542a63}{clear\+Viewer\+Cache}} ()
\item 
void \mbox{\hyperlink{class_file_viewer_a43aff05d6089dc9797677ab3cf4e2081}{update\+File\+Info}} (const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&fp)
\item 
void \mbox{\hyperlink{class_file_viewer_adad89f2e5c47b981f9955f0bdd9ba229}{show\+Frame}} (int frame\+Index)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_file_viewer_a8a3b94f13628d8046733ccf4b76aecf6}{drag\+Enter\+Event}} (QDrag\+Enter\+Event $\ast$event)
\item 
void \mbox{\hyperlink{class_file_viewer_aeb7cf008f1a8aea85161e501e6d4f41c}{drop\+Event}} (QDrop\+Event $\ast$event)
\item 
void \mbox{\hyperlink{class_file_viewer_a2cb4234ccf6cca2f329ef46223593f32}{paint\+Event}} (QPaint\+Event $\ast$)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_file_viewer_a237399a847f0eccbd347a23e517c2a37}\label{class_file_viewer_a237399a847f0eccbd347a23e517c2a37}} 
\index{FileViewer@{FileViewer}!FileViewer@{FileViewer}}
\index{FileViewer@{FileViewer}!FileViewer@{FileViewer}}
\doxysubsubsection{\texorpdfstring{FileViewer()}{FileViewer()}}
{\footnotesize\ttfamily File\+Viewer\+::\+File\+Viewer (\begin{DoxyParamCaption}\item[{QWidget $\ast$}]{parent = {\ttfamily 0},  }\item[{Qt\+::\+WFlags}]{flags = {\ttfamily Qt\+:\+:Tool} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00041     : QWidget(parent), m\_fileSize(0), m\_player(0), m\_snd(0), m\_soundOn(\textcolor{keyword}{false}) \{}
\DoxyCodeLine{00042   setAcceptDrops(\textcolor{keyword}{true});}
\DoxyCodeLine{00043 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_file_viewer_a649e0943e83737c5c8e0fc15da542a63}\label{class_file_viewer_a649e0943e83737c5c8e0fc15da542a63}} 
\index{FileViewer@{FileViewer}!clearViewerCache@{clearViewerCache}}
\index{clearViewerCache@{clearViewerCache}!FileViewer@{FileViewer}}
\doxysubsubsection{\texorpdfstring{clearViewerCache()}{clearViewerCache()}}
{\footnotesize\ttfamily void File\+Viewer\+::clear\+Viewer\+Cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00112                                   \{}
\DoxyCodeLine{00113   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00114   \textcolor{keywordflow}{for} (i = 0; i < (int)m\_fids.size(); i++) \{}
\DoxyCodeLine{00115     \mbox{\hyperlink{class_t_frame_id}{TFrameId}} fid = m\_fids[i];}
\DoxyCodeLine{00116     \textcolor{keywordtype}{string} \textcolor{keywordtype}{id}    = toString(m\_levelName) + toString(fid.getNumber());}
\DoxyCodeLine{00117     \textcolor{keywordflow}{if} (TImageCache::instance()-\/>isCached(\textcolor{keywordtype}{id}))}
\DoxyCodeLine{00118       TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a57d63227dfe2532b0aed22c47113be66}{remove}}(\textcolor{keywordtype}{id});}
\DoxyCodeLine{00119   \}}
\DoxyCodeLine{00120 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_file_viewer_a8a3b94f13628d8046733ccf4b76aecf6}\label{class_file_viewer_a8a3b94f13628d8046733ccf4b76aecf6}} 
\index{FileViewer@{FileViewer}!dragEnterEvent@{dragEnterEvent}}
\index{dragEnterEvent@{dragEnterEvent}!FileViewer@{FileViewer}}
\doxysubsubsection{\texorpdfstring{dragEnterEvent()}{dragEnterEvent()}}
{\footnotesize\ttfamily void File\+Viewer\+::drag\+Enter\+Event (\begin{DoxyParamCaption}\item[{QDrag\+Enter\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00047                                                       \{}
\DoxyCodeLine{00048   \textcolor{keywordflow}{if} (event-\/>mimeData()-\/>hasUrls()) \textcolor{keyword}{event}-\/>acceptProposedAction();}
\DoxyCodeLine{00049 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_file_viewer_aeb7cf008f1a8aea85161e501e6d4f41c}\label{class_file_viewer_aeb7cf008f1a8aea85161e501e6d4f41c}} 
\index{FileViewer@{FileViewer}!dropEvent@{dropEvent}}
\index{dropEvent@{dropEvent}!FileViewer@{FileViewer}}
\doxysubsubsection{\texorpdfstring{dropEvent()}{dropEvent()}}
{\footnotesize\ttfamily void File\+Viewer\+::drop\+Event (\begin{DoxyParamCaption}\item[{QDrop\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00053                                             \{}
\DoxyCodeLine{00054   QList<QUrl> urls = \textcolor{keyword}{event}-\/>mimeData()-\/>urls();}
\DoxyCodeLine{00055   \mbox{\hyperlink{class_t_file_path}{TFilePath}} path   = \mbox{\hyperlink{class_t_file_path}{TFilePath}}(urls[0].toLocalFile().toStdString());}
\DoxyCodeLine{00056   \textcolor{keywordflow}{if} (path.isEmpty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00057   setPath(path);}
\DoxyCodeLine{00058   \textcolor{keyword}{event}-\/>acceptProposedAction();}
\DoxyCodeLine{00059 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_file_viewer_a2cb4234ccf6cca2f329ef46223593f32}\label{class_file_viewer_a2cb4234ccf6cca2f329ef46223593f32}} 
\index{FileViewer@{FileViewer}!paintEvent@{paintEvent}}
\index{paintEvent@{paintEvent}!FileViewer@{FileViewer}}
\doxysubsubsection{\texorpdfstring{paintEvent()}{paintEvent()}}
{\footnotesize\ttfamily void File\+Viewer\+::paint\+Event (\begin{DoxyParamCaption}\item[{QPaint\+Event $\ast$}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00185 \{ QPainter p(\textcolor{keyword}{this}); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_file_viewer_aa7ef9796fa411274642f0e6165b7c8e0}\label{class_file_viewer_aa7ef9796fa411274642f0e6165b7c8e0}} 
\index{FileViewer@{FileViewer}!setPath@{setPath}}
\index{setPath@{setPath}!FileViewer@{FileViewer}}
\doxysubsubsection{\texorpdfstring{setPath()}{setPath()}}
{\footnotesize\ttfamily void File\+Viewer\+::set\+Path (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{fp,  }\item[{int}]{from = {\ttfamily 0},  }\item[{int}]{to = {\ttfamily 0},  }\item[{int}]{step = {\ttfamily 0},  }\item[{\mbox{\hyperlink{class_t_sound_track}{TSound\+Track}} $\ast$}]{snd = {\ttfamily 0} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00064                                            \{}
\DoxyCodeLine{00065   \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{int})m\_fids.size() > 0) clearViewerCache();}
\DoxyCodeLine{00066   m\_path = fp;}
\DoxyCodeLine{00067   m\_snd  = snd;}
\DoxyCodeLine{00068   m\_fids.clear();}
\DoxyCodeLine{00069   m\_index    = -\/1;}
\DoxyCodeLine{00070   m\_fileSize = 0;}
\DoxyCodeLine{00071   m\_fileDate = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00072   \textcolor{keywordflow}{if} (fp.\mbox{\hyperlink{class_t_file_path_a698bbf714436eb6923359044900cde2b}{getDots}}() == \textcolor{stringliteral}{"{}.."{}}) \{}
\DoxyCodeLine{00073     m\_levelName = fp.\mbox{\hyperlink{class_t_file_path_ac17d65d827432f0fae28fed699bf4afa}{withoutParentDir}}().\mbox{\hyperlink{class_t_file_path_a12f35b225e1882372ad7e02ad7fce543}{withFrame}}().getWideString();}
\DoxyCodeLine{00074   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00075     m\_levelName = fp.\mbox{\hyperlink{class_t_file_path_ac17d65d827432f0fae28fed699bf4afa}{withoutParentDir}}().getWideString();}
\DoxyCodeLine{00076     updateFileInfo(m\_path);}
\DoxyCodeLine{00077   \}}
\DoxyCodeLine{00078   m\_lr = \mbox{\hyperlink{class_t_level_reader_p}{TLevelReaderP}}();}
\DoxyCodeLine{00079   \textcolor{keywordflow}{if} (step != 0)  \textcolor{comment}{// e' un render}}
\DoxyCodeLine{00080     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = from; i <= to; i += step) m\_fids.push\_back(\mbox{\hyperlink{class_t_frame_id}{TFrameId}}(i));}
\DoxyCodeLine{00081   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (fp != \mbox{\hyperlink{class_t_file_path}{TFilePath}}() \&\&}
\DoxyCodeLine{00082            TSystem::doesExistFileOrLevel(fp))  \textcolor{comment}{// e' un view}}
\DoxyCodeLine{00083   \{}
\DoxyCodeLine{00084     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{00085       m\_lr          = \mbox{\hyperlink{class_t_level_reader_p}{TLevelReaderP}}(fp);}
\DoxyCodeLine{00086       \mbox{\hyperlink{class_t_level_p}{TLevelP}} level = m\_lr-\/>loadInfo();}
\DoxyCodeLine{00087       \textcolor{keywordflow}{if} (!level || level-\/>getFrameCount() == 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00088       m\_palette = level-\/>getPalette();}
\DoxyCodeLine{00089       \textcolor{keywordflow}{if} (!m\_palette \&\& (fp.\mbox{\hyperlink{class_t_file_path_aefca624df1a5468a4c78ec6d5dbfae26}{getType}}() == \textcolor{stringliteral}{"{}tzp"{}} || fp.\mbox{\hyperlink{class_t_file_path_aefca624df1a5468a4c78ec6d5dbfae26}{getType}}() == \textcolor{stringliteral}{"{}tzu"{}}))}
\DoxyCodeLine{00090         m\_palette =}
\DoxyCodeLine{00091             ToonzImageUtils::loadTzPalette(fp.\mbox{\hyperlink{class_t_file_path_a1437b0e0720e9258b622f68b6858e95d}{withType}}(\textcolor{stringliteral}{"{}plt"{}}).withNoFrame());}
\DoxyCodeLine{00092 }
\DoxyCodeLine{00093       \textcolor{keywordflow}{for} (TLevel::Iterator it = level-\/>begin(); it != level-\/>end(); ++it)}
\DoxyCodeLine{00094         m\_fids.push\_back(it-\/>first);}
\DoxyCodeLine{00095       showFrame(0);}
\DoxyCodeLine{00096     \} \textcolor{keywordflow}{catch} (...) \{}
\DoxyCodeLine{00097       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00098     \}}
\DoxyCodeLine{00099   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00100     m\_image = \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}}();}
\DoxyCodeLine{00101   \textcolor{comment}{//  else}}
\DoxyCodeLine{00102   \textcolor{comment}{//    setImage(TImageP());}}
\DoxyCodeLine{00103   \textcolor{comment}{// resetZoom();}}
\DoxyCodeLine{00104 }
\DoxyCodeLine{00105   showFrame(0);}
\DoxyCodeLine{00106   \textcolor{comment}{// configureNotify();}}
\DoxyCodeLine{00107   \textcolor{comment}{//  if(m\_listener) m\_listener-\/>onPathChange(fp);}}
\DoxyCodeLine{00108 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_file_viewer_adad89f2e5c47b981f9955f0bdd9ba229}\label{class_file_viewer_adad89f2e5c47b981f9955f0bdd9ba229}} 
\index{FileViewer@{FileViewer}!showFrame@{showFrame}}
\index{showFrame@{showFrame}!FileViewer@{FileViewer}}
\doxysubsubsection{\texorpdfstring{showFrame()}{showFrame()}}
{\footnotesize\ttfamily void File\+Viewer\+::show\+Frame (\begin{DoxyParamCaption}\item[{int}]{frame\+Index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00137                                     \{}
\DoxyCodeLine{00138   \textcolor{keywordflow}{if} (m\_fids.empty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00139 }
\DoxyCodeLine{00140   index   = tcrop(index, 0, (\textcolor{keywordtype}{int})(m\_fids.size() -\/ 1));}
\DoxyCodeLine{00141   m\_index = index;}
\DoxyCodeLine{00142 }
\DoxyCodeLine{00143   \mbox{\hyperlink{class_t_frame_id}{TFrameId}} fid = m\_fids[index];}
\DoxyCodeLine{00144   \textcolor{keywordtype}{string} \textcolor{keywordtype}{id}    = toString(m\_levelName) + toString(fid.getNumber());}
\DoxyCodeLine{00145 }
\DoxyCodeLine{00146   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{00147     \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img;}
\DoxyCodeLine{00148     \textcolor{keywordflow}{if} (TImageCache::instance()-\/>isCached(\textcolor{keywordtype}{id}))}
\DoxyCodeLine{00149       img = TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_aea3ac2752efd6fa9689f5a7c1e895e41}{get}}(\textcolor{keywordtype}{id}, \textcolor{keyword}{false});}
\DoxyCodeLine{00150     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_lr) \{}
\DoxyCodeLine{00151       \mbox{\hyperlink{class_t_image_reader_p}{TImageReaderP}} ir = m\_lr-\/>getFrameReader(fid);}
\DoxyCodeLine{00152       \textcolor{keywordflow}{if} (m\_path.\mbox{\hyperlink{class_t_file_path_a698bbf714436eb6923359044900cde2b}{getDots}}() == \textcolor{stringliteral}{"{}.."{}}) \{}
\DoxyCodeLine{00153         \textcolor{keywordflow}{if} (ir)}
\DoxyCodeLine{00154           updateFileInfo(ir-\/>getFilePath());}
\DoxyCodeLine{00155         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00156           m\_fileSize = 0;}
\DoxyCodeLine{00157           m\_fileDate = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00158         \}}
\DoxyCodeLine{00159       \}}
\DoxyCodeLine{00160       img = ir-\/>load();}
\DoxyCodeLine{00161       \textcolor{keywordflow}{if} (img) \{}
\DoxyCodeLine{00162         \textcolor{keywordflow}{if} (!img-\/>getPalette() \&\& m\_palette)}
\DoxyCodeLine{00163           img-\/>\mbox{\hyperlink{class_t_image_a3377c18a849addff5c2cb238176ad04f}{setPalette}}(m\_palette.getPointer());}
\DoxyCodeLine{00164         TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a124eae4cf370288f42c22b3477cb5163}{add}}(\textcolor{keywordtype}{id}, img);}
\DoxyCodeLine{00165       \}}
\DoxyCodeLine{00166     \}}
\DoxyCodeLine{00167     m\_image = img;}
\DoxyCodeLine{00168     \textcolor{comment}{//    setImage(img);}}
\DoxyCodeLine{00169   \} \textcolor{keywordflow}{catch} (...) \{}
\DoxyCodeLine{00170     m\_image = \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}}();}
\DoxyCodeLine{00171     \textcolor{comment}{//    setImage(TImageP());}}
\DoxyCodeLine{00172   \}}
\DoxyCodeLine{00173   \textcolor{comment}{//  invalidate();}}
\DoxyCodeLine{00174   update();}
\DoxyCodeLine{00175 }
\DoxyCodeLine{00176   \textcolor{comment}{//  if(m\_listener)}}
\DoxyCodeLine{00177   \textcolor{comment}{//  \{}}
\DoxyCodeLine{00178   \textcolor{comment}{//      m\_listener-\/>onFrameChange(getFrameId());}}
\DoxyCodeLine{00179   \textcolor{comment}{//  \}}}
\DoxyCodeLine{00180   \textcolor{comment}{//  playSound();}}
\DoxyCodeLine{00181 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_file_viewer_a43aff05d6089dc9797677ab3cf4e2081}\label{class_file_viewer_a43aff05d6089dc9797677ab3cf4e2081}} 
\index{FileViewer@{FileViewer}!updateFileInfo@{updateFileInfo}}
\index{updateFileInfo@{updateFileInfo}!FileViewer@{FileViewer}}
\doxysubsubsection{\texorpdfstring{updateFileInfo()}{updateFileInfo()}}
{\footnotesize\ttfamily void File\+Viewer\+::update\+File\+Info (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{fp }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00124                                                    \{}
\DoxyCodeLine{00125   \mbox{\hyperlink{class_t_file_status}{TFileStatus}} fs(fp);}
\DoxyCodeLine{00126   \textcolor{keywordflow}{if} (fs.doesExist()) \{}
\DoxyCodeLine{00127     m\_fileSize = (int)((fs.getSize() + 1023) / 1024);}
\DoxyCodeLine{00128     m\_fileDate = fs.getLastModificationTime().getFormattedString();}
\DoxyCodeLine{00129   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00130     m\_fileSize = 0;}
\DoxyCodeLine{00131     m\_fileDate = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00132   \}}
\DoxyCodeLine{00133 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonz/fileviewerpopup.\+h\item 
E\+:/opentoonz/toonz/sources/toonz/fileviewerpopup.\+cpp\end{DoxyCompactItemize}
