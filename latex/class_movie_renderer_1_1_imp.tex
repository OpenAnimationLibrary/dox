\hypertarget{class_movie_renderer_1_1_imp}{}\doxysection{Movie\+Renderer\+::Imp Class Reference}
\label{class_movie_renderer_1_1_imp}\index{MovieRenderer::Imp@{MovieRenderer::Imp}}
Inheritance diagram for Movie\+Renderer\+::Imp\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_movie_renderer_1_1_imp}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_movie_renderer_1_1_imp_ac6e085db9d128f54d4e35efb14f9c135}{Imp}} (\mbox{\hyperlink{class_toonz_scene}{Toonz\+Scene}} $\ast$scene, const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&movie\+Path, int thread\+Count, bool cache\+Results)
\item 
void \mbox{\hyperlink{class_movie_renderer_1_1_imp_a8a70aa0241932852101908c93e57365f}{on\+Render\+Raster\+Completed}} (const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&render\+Data) override
\item 
void \mbox{\hyperlink{class_movie_renderer_1_1_imp_a6ab85d36f6c10210221aa4e8c616d479}{on\+Render\+Failure}} (const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&render\+Data, \mbox{\hyperlink{class_t_exception}{TException}} \&e) override
\item 
void \mbox{\hyperlink{class_movie_renderer_1_1_imp_ac86c54ce82feda4b353e89ebce84216b}{on\+Render\+Finished}} (bool is\+Canceled=false) override
\item 
void \mbox{\hyperlink{class_movie_renderer_1_1_imp_a66999057c680141e8c99097848082e62}{do\+Render\+Raster\+Completed}} (const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&render\+Data)
\item 
void \mbox{\hyperlink{class_movie_renderer_1_1_imp_a832b8979e9f72d56276ec6b58bba8a9e}{do\+Preview\+Raster\+Completed}} (const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&render\+Data)
\item 
void \mbox{\hyperlink{class_movie_renderer_1_1_imp_a672a24838298237364eabcac08e630ec}{prepare\+For\+Start}} ()
\item 
void \mbox{\hyperlink{class_movie_renderer_1_1_imp_ad2f5a81ee8d9462d3d7f94ec86310868}{add\+Soundtrack}} (int r0, int r1, double fps, int board\+Duration=0)
\item 
void \mbox{\hyperlink{class_movie_renderer_1_1_imp_a876d0b661b631b129c4c5174272a6ee1}{post\+Process\+Image}} (const \mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&img, bool has64bit\+Output\+Support, const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&mark, int frame)
\item 
std\+::pair$<$ bool, int $>$ \mbox{\hyperlink{class_movie_renderer_1_1_imp_a600b9af83be9025249d0bd22371774b8}{save\+Frame}} (double frame, const std\+::pair$<$ \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}, \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} $>$ \&rasters)
\item 
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a3dd1583ad1851d6f9046e299e43542c3}\label{class_movie_renderer_1_1_imp_a3dd1583ad1851d6f9046e299e43542c3}} 
std\+::string {\bfseries get\+Render\+Cache\+Id} ()
\item 
int \mbox{\hyperlink{class_movie_renderer_1_1_imp_a1e347dec816251ca0ca426339a71124b}{add\+Board}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_toonz_scene}{Toonz\+Scene}} $\ast$ \mbox{\hyperlink{class_movie_renderer_1_1_imp_ac7ec3cd931c140e7ceedf1142aa29e6b}{m\+\_\+scene}}
\item 
\mbox{\hyperlink{class_t_renderer}{TRenderer}} \mbox{\hyperlink{class_movie_renderer_1_1_imp_abeb6da0281ec2d81441b62f66b467b13}{m\+\_\+renderer}}
\item 
\mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \mbox{\hyperlink{class_movie_renderer_1_1_imp_a1c3499c9b3aa81784795c358f91a6027}{m\+\_\+fp}}
\item 
\mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \mbox{\hyperlink{class_movie_renderer_1_1_imp_a0536b5566f2b72c9468ec4ca1506c72d}{m\+\_\+render\+Settings}}
\item 
\mbox{\hyperlink{class_t_dimension_t}{TDimension}} \mbox{\hyperlink{class_movie_renderer_1_1_imp_a7c2e14ccfc7ebd06a80730140007ff82}{m\+\_\+frame\+Size}}
\item 
double \mbox{\hyperlink{class_movie_renderer_1_1_imp_a00e9b4470c91a35ab71d1ace3884a56c}{m\+\_\+x\+Dpi}}
\item 
double \mbox{\hyperlink{class_movie_renderer_1_1_imp_a30ce52bca58298617dc84f5c54eb5e30}{m\+\_\+y\+Dpi}}
\item 
std\+::set$<$ \mbox{\hyperlink{class_movie_renderer_1_1_listener}{Movie\+Renderer\+::\+Listener}} $\ast$ $>$ \mbox{\hyperlink{class_movie_renderer_1_1_imp_ab9079d5ed2b5ad349bb11743db452727}{m\+\_\+listeners}}
\item 
std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{class_level_updater}{Level\+Updater}} $>$ \mbox{\hyperlink{class_movie_renderer_1_1_imp_a1a2802e5d7eb81c7394398dd559d9c9d}{m\+\_\+level\+UpdaterA}}
\item 
std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{class_level_updater}{Level\+Updater}} $>$ \mbox{\hyperlink{class_movie_renderer_1_1_imp_a89dfee571e072493b72bd1be241c0cc1}{m\+\_\+level\+UpdaterB}}
\item 
\mbox{\hyperlink{class_t_smart_pointer_t}{TSound\+TrackP}} \mbox{\hyperlink{class_movie_renderer_1_1_imp_a76586f81a2a28a1b9306409735c2b5f8}{m\+\_\+st}}
\item 
std\+::map$<$ double, std\+::pair$<$ \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}, \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} $>$ $>$ \mbox{\hyperlink{class_movie_renderer_1_1_imp_a3db4041204f7e275e50fc89ff49213c1}{m\+\_\+to\+Be\+Saved}}
\item 
std\+::vector$<$ std\+::pair$<$ double, \mbox{\hyperlink{class_t_fx_pair}{TFx\+Pair}} $>$ $>$ \mbox{\hyperlink{class_movie_renderer_1_1_imp_ae84848cece329c9e8f3e17646449d4d1}{m\+\_\+frames\+To\+Be\+Rendered}}
\item 
std\+::string \mbox{\hyperlink{class_movie_renderer_1_1_imp_a9fdfc7abd5ade9cac413039b93b895e5}{m\+\_\+render\+Cache\+Id}}
\item 
std\+::map$<$ double, bool $>$ \mbox{\hyperlink{class_movie_renderer_1_1_imp_a4ae3fa172a0bf50dd78dbc3d5d20531d}{m\+\_\+to\+Be\+Applied\+Gamma}}
\item 
\mbox{\hyperlink{class_t_thread_1_1_mutex}{TThread\+::\+Mutex}} \mbox{\hyperlink{class_movie_renderer_1_1_imp_a571337aaf898a7af21a05ea407210c59}{m\+\_\+mutex}}
\item 
int \mbox{\hyperlink{class_movie_renderer_1_1_imp_a441e9bbf1ea016c97225a63e057b41db}{m\+\_\+render\+Session\+Id}}
\item 
long \mbox{\hyperlink{class_movie_renderer_1_1_imp_adfb2b4648b4ffd0eea969b3622a40a5a}{m\+\_\+white\+Sample}}
\item 
int \mbox{\hyperlink{class_movie_renderer_1_1_imp_a853a853ac4affa3836f227f3c5ac622d}{m\+\_\+next\+Frame\+Idx\+To\+Save}}
\item 
int \mbox{\hyperlink{class_movie_renderer_1_1_imp_a188b1407131c2c18c37408eff409264c}{m\+\_\+saving\+Threads\+Count}}
\item 
bool \mbox{\hyperlink{class_movie_renderer_1_1_imp_a4811c72452c85a868df6db55ce9ae305}{m\+\_\+first\+Completed\+Raster}}
\item 
bool \mbox{\hyperlink{class_movie_renderer_1_1_imp_ad78521a1fc8b22aa21ce4cb333abe018}{m\+\_\+failure}}
\item 
bool \mbox{\hyperlink{class_movie_renderer_1_1_imp_ac52dd385c89e467b3cd814613fdf4ea7}{m\+\_\+cache\+Results}}
\item 
bool \mbox{\hyperlink{class_movie_renderer_1_1_imp_ab465ef58ed529077ff1809ba522bc5cd}{m\+\_\+preview}}
\item 
bool \mbox{\hyperlink{class_movie_renderer_1_1_imp_a7ee70acc75857485e90fccbb51c58167}{m\+\_\+movie\+Type}}
\item 
bool \mbox{\hyperlink{class_movie_renderer_1_1_imp_a7c2e6205764a8498edecc08e2ae2de49}{m\+\_\+seq\+Required}}
\item 
bool \mbox{\hyperlink{class_movie_renderer_1_1_imp_a2dd2b440bfc1ce0a2029a97efc323ee5}{m\+\_\+wait\+After\+Finish}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_ac6e085db9d128f54d4e35efb14f9c135}\label{class_movie_renderer_1_1_imp_ac6e085db9d128f54d4e35efb14f9c135}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!Imp@{Imp}}
\index{Imp@{Imp}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{Imp()}{Imp()}}
{\footnotesize\ttfamily Movie\+Renderer\+::\+Imp\+::\+Imp (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_toonz_scene}{Toonz\+Scene}} $\ast$}]{scene,  }\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{movie\+Path,  }\item[{int}]{thread\+Count,  }\item[{bool}]{cache\+Results }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00176     : m\_scene(scene)}
\DoxyCodeLine{00177     , m\_renderer(threadCount)}
\DoxyCodeLine{00178     , m\_fp(moviePath)}
\DoxyCodeLine{00179     , m\_frameSize(scene-\/>\mbox{\hyperlink{class_toonz_scene_a750b5ab623ccec744013b0c83bf20abc}{getCurrentCamera}}()-\/>\mbox{\hyperlink{class_t_camera_a9a7c573e7a2c397ffae4b747809ea2a5}{getRes}}())}
\DoxyCodeLine{00180     , m\_xDpi(72)}
\DoxyCodeLine{00181     , m\_yDpi(72)}
\DoxyCodeLine{00182     , m\_renderSessionId(RenderSessionId++)}
\DoxyCodeLine{00183     , m\_nextFrameIdxToSave(0)}
\DoxyCodeLine{00184     , m\_savingThreadsCount(0)}
\DoxyCodeLine{00185     , m\_whiteSample(0)}
\DoxyCodeLine{00186     , m\_firstCompletedRaster(}
\DoxyCodeLine{00187           \textcolor{keyword}{true})         \textcolor{comment}{//< I know, sounds weird -\/ it's just set to false}}
\DoxyCodeLine{00188     , m\_failure(\textcolor{keyword}{false})  \textcolor{comment}{//  AFTER the first completed raster gets processed}}
\DoxyCodeLine{00189     , m\_cacheResults(cacheResults)}
\DoxyCodeLine{00190     , m\_preview(moviePath.isEmpty())}
\DoxyCodeLine{00191     , m\_movieType(isMovieType(moviePath))}
\DoxyCodeLine{00192     , m\_seqRequired(isSequencialRequired(moviePath)) \{}
\DoxyCodeLine{00193   m\_renderCacheId =}
\DoxyCodeLine{00194       m\_fp.\mbox{\hyperlink{class_t_file_path_a3ebf9ced558cfef97a60bba536b23c6f}{withName}}(m\_fp.\mbox{\hyperlink{class_t_file_path_af94f9b0aeceb6cdb980fa1789473503a}{getName}}() + \textcolor{stringliteral}{"{}\#RENDERID"{}} +}
\DoxyCodeLine{00195                     QString::number(m\_renderSessionId).toStdString())}
\DoxyCodeLine{00196           .\mbox{\hyperlink{class_t_file_path_a9b256108e6e5ff99f3ba828d4cdbd7ee}{getLevelName}}();}
\DoxyCodeLine{00197 }
\DoxyCodeLine{00198   m\_renderer.addPort(\textcolor{keyword}{this});}
\DoxyCodeLine{00199   m\_waitAfterFinish = m\_movieType \&\& !m\_seqRequired \&\& threadCount > 1;}
\DoxyCodeLine{00200 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_ae59350bdfbd4c4d764077b17a08d606f}\label{class_movie_renderer_1_1_imp_ae59350bdfbd4c4d764077b17a08d606f}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!````~Imp@{$\sim$Imp}}
\index{````~Imp@{$\sim$Imp}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{$\sim$Imp()}{~Imp()}}
{\footnotesize\ttfamily Movie\+Renderer\+::\+Imp\+::$\sim$\+Imp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00204                        \{}
\DoxyCodeLine{00205   m\_renderer.removePort(\textcolor{keyword}{this});  \textcolor{comment}{// Please, note: a TRenderer instance is}}
\DoxyCodeLine{00206                                 \textcolor{comment}{// currently a shared-\/pointer-\/like}}
\DoxyCodeLine{00207 \}  \textcolor{comment}{// object to a private worker. *That* object may outlive the TRenderer}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a1e347dec816251ca0ca426339a71124b}\label{class_movie_renderer_1_1_imp_a1e347dec816251ca0ca426339a71124b}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!addBoard@{addBoard}}
\index{addBoard@{addBoard}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{addBoard()}{addBoard()}}
{\footnotesize\ttfamily int Movie\+Renderer\+::\+Imp\+::add\+Board (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00777                                \{}
\DoxyCodeLine{00778   \mbox{\hyperlink{class_board_settings}{BoardSettings}} *boardSettings =}
\DoxyCodeLine{00779       m\_scene-\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}()-\/>\mbox{\hyperlink{class_t_scene_properties_abea7b4b8e4f0cedbf753b26ec30b5331}{getOutputProperties}}()-\/>getBoardSettings();}
\DoxyCodeLine{00780   \textcolor{keywordflow}{if} (!boardSettings-\/>isActive()) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00781   \textcolor{keywordtype}{int} duration = boardSettings-\/>getDuration();}
\DoxyCodeLine{00782   \textcolor{keywordflow}{if} (duration == 0) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00783   \textcolor{comment}{// Get the image size}}
\DoxyCodeLine{00784   \textcolor{keywordtype}{int} shrinkX = m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a52dd41881bbf6aaf953fe300be2e233e}{m\_shrinkX}},}
\DoxyCodeLine{00785       shrinkY = m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_ae1882f584ce9ffad12ce6bf9ff23814c}{m\_shrinkY}};}
\DoxyCodeLine{00786   \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}} cameraRes(\textcolor{keywordtype}{double}(m\_frameSize.lx) / shrinkX,}
\DoxyCodeLine{00787                         \textcolor{keywordtype}{double}(m\_frameSize.ly) / shrinkY);}
\DoxyCodeLine{00788   \mbox{\hyperlink{class_t_dimension_t}{TDimension}} cameraResI(cameraRes.lx, cameraRes.ly);}
\DoxyCodeLine{00789 }
\DoxyCodeLine{00790   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} boardRas =}
\DoxyCodeLine{00791       boardSettings-\/>getBoardRaster(cameraResI, shrinkX, m\_scene);}
\DoxyCodeLine{00792 }
\DoxyCodeLine{00793   \textcolor{keywordflow}{if} (m\_levelUpdaterA.get()) \{}
\DoxyCodeLine{00794     \textcolor{comment}{// Flush images}}
\DoxyCodeLine{00795     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{00796       \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} img(boardRas);}
\DoxyCodeLine{00797       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} f = 0; f < duration; f++) \{}
\DoxyCodeLine{00798         m\_levelUpdaterA-\/>update(\mbox{\hyperlink{class_t_frame_id}{TFrameId}}(f + 1), img);}
\DoxyCodeLine{00799         \textcolor{keywordflow}{if} (m\_levelUpdaterB.get())}
\DoxyCodeLine{00800           m\_levelUpdaterB-\/>update(\mbox{\hyperlink{class_t_frame_id}{TFrameId}}(f + 1), img);}
\DoxyCodeLine{00801       \}}
\DoxyCodeLine{00802     \} \textcolor{keywordflow}{catch} (...) \{}
\DoxyCodeLine{00803       \textcolor{comment}{// Nothing. The images could not be saved for whatever reason.}}
\DoxyCodeLine{00804       \textcolor{comment}{// Failure is reported.}}
\DoxyCodeLine{00805     \}}
\DoxyCodeLine{00806   \}}
\DoxyCodeLine{00807   \textcolor{keywordflow}{return} duration;}
\DoxyCodeLine{00808 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_ad2f5a81ee8d9462d3d7f94ec86310868}\label{class_movie_renderer_1_1_imp_ad2f5a81ee8d9462d3d7f94ec86310868}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!addSoundtrack@{addSoundtrack}}
\index{addSoundtrack@{addSoundtrack}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{addSoundtrack()}{addSoundtrack()}}
{\footnotesize\ttfamily void Movie\+Renderer\+::\+Imp\+::add\+Soundtrack (\begin{DoxyParamCaption}\item[{int}]{r0,  }\item[{int}]{r1,  }\item[{double}]{fps,  }\item[{int}]{board\+Duration = {\ttfamily 0} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00310                                                           \{}
\DoxyCodeLine{00311   \mbox{\hyperlink{macros_8h_abcaf2f3bbaba74cf330e778baf26fb8a}{TCG\_ASSERT}}(r0 <= r1, \textcolor{keywordflow}{return} );}
\DoxyCodeLine{00312 }
\DoxyCodeLine{00313   \mbox{\hyperlink{class_t_xsheet_1_1_sound_properties}{TXsheet::SoundProperties}} *prop =}
\DoxyCodeLine{00314       \textcolor{keyword}{new} \mbox{\hyperlink{class_t_xsheet_1_1_sound_properties}{TXsheet::SoundProperties}}();  \textcolor{comment}{// Ownership will be surrendered ...}}
\DoxyCodeLine{00315   prop-\/>m\_frameRate = fps;}
\DoxyCodeLine{00316 }
\DoxyCodeLine{00317   \mbox{\hyperlink{class_t_sound_track}{TSoundTrack}} *snd = m\_scene-\/>\mbox{\hyperlink{class_toonz_scene_ae3c828e3223fd809fd59189233d0576a}{getXsheet}}()-\/>makeSound(prop);  \textcolor{comment}{// ... here}}
\DoxyCodeLine{00318   \textcolor{keywordflow}{if} (!snd) \{}
\DoxyCodeLine{00319     \textcolor{comment}{// No soundtrack}}
\DoxyCodeLine{00320     m\_whiteSample = (r1 -\/ r0 + 1) * 918;  \textcolor{comment}{// 918?? wtf... I don't think it has}}
\DoxyCodeLine{00321     \textcolor{keywordflow}{return};  \textcolor{comment}{// any arcane meaning -\/ but i'm not touching it.}}
\DoxyCodeLine{00322   \}          \textcolor{comment}{// My impression would be that... no sound implies}}
\DoxyCodeLine{00323              \textcolor{comment}{// no access to m\_whiteSample, no?}}
\DoxyCodeLine{00324 }
\DoxyCodeLine{00325   \textcolor{keywordtype}{double} samplePerFrame = snd-\/>getSampleRate() / fps;}
\DoxyCodeLine{00326 }
\DoxyCodeLine{00327   \textcolor{comment}{// Extract the useful part of scene soundtrack}}
\DoxyCodeLine{00328   \mbox{\hyperlink{class_t_smart_pointer_t}{TSoundTrackP}} snd1 = snd-\/>\mbox{\hyperlink{class_t_sound_track_a6efbb9d14bb633cff1257095eba11096}{extract}}((TINT32)(r0 * samplePerFrame),}
\DoxyCodeLine{00329                                    (TINT32)(r1 * samplePerFrame));}
\DoxyCodeLine{00330   assert(!m\_st);}
\DoxyCodeLine{00331   \textcolor{keywordflow}{if} (!m\_st) \{}
\DoxyCodeLine{00332     \textcolor{comment}{// First, add white sound before the 'from' instant}}
\DoxyCodeLine{00333     m\_st          = \mbox{\hyperlink{class_t_sound_track_a9a83177a9a5b9a7470f32b87e7f21f3d}{TSoundTrack::create}}(snd1-\/>\mbox{\hyperlink{class_t_sound_track_aa58db0cee313f7174bc023e295b701a9}{getFormat}}(), m\_whiteSample);}
\DoxyCodeLine{00334     m\_whiteSample = 0;  \textcolor{comment}{// Why?  Probably being pedantic here... I guess}}
\DoxyCodeLine{00335   \}}
\DoxyCodeLine{00336 }
\DoxyCodeLine{00337   \textcolor{comment}{// Then, add the rest}}
\DoxyCodeLine{00338   TINT32 fromSample = m\_st-\/>getSampleCount();}
\DoxyCodeLine{00339   TINT32 numSample =}
\DoxyCodeLine{00340       std::max(TINT32((r1 -\/ r0 + 1) * samplePerFrame), snd1-\/>getSampleCount());}
\DoxyCodeLine{00341 }
\DoxyCodeLine{00342   m\_st = \mbox{\hyperlink{namespace_t_sop_a0fefdd72dbc5cf869c88ffef4e0adb7e}{TSop::insertBlank}}(m\_st, fromSample, numSample + m\_whiteSample);}
\DoxyCodeLine{00343   m\_st-\/>\mbox{\hyperlink{class_t_sound_track_a77370b67b41927689f5490bbe15a907d}{copy}}(snd1, TINT32(fromSample + m\_whiteSample));}
\DoxyCodeLine{00344 }
\DoxyCodeLine{00345   \textcolor{comment}{// insert blank sound for clapperboard}}
\DoxyCodeLine{00346   \textcolor{keywordflow}{if} (boardDuration > 0)}
\DoxyCodeLine{00347     m\_st = \mbox{\hyperlink{namespace_t_sop_a0fefdd72dbc5cf869c88ffef4e0adb7e}{TSop::insertBlank}}(m\_st, 0, TINT32(boardDuration * samplePerFrame));}
\DoxyCodeLine{00348 }
\DoxyCodeLine{00349   m\_whiteSample = 0;}
\DoxyCodeLine{00350 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a832b8979e9f72d56276ec6b58bba8a9e}\label{class_movie_renderer_1_1_imp_a832b8979e9f72d56276ec6b58bba8a9e}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!doPreviewRasterCompleted@{doPreviewRasterCompleted}}
\index{doPreviewRasterCompleted@{doPreviewRasterCompleted}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{doPreviewRasterCompleted()}{doPreviewRasterCompleted()}}
{\footnotesize\ttfamily void Movie\+Renderer\+::\+Imp\+::do\+Preview\+Raster\+Completed (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&}]{render\+Data }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00620                                   \{}
\DoxyCodeLine{00621   \textcolor{comment}{// Most probably unused now. I'm not reviewing this.}}
\DoxyCodeLine{00622 }
\DoxyCodeLine{00623   assert(!m\_levelUpdaterA.get());}
\DoxyCodeLine{00624 }
\DoxyCodeLine{00625   QMutexLocker sl(\&m\_mutex);}
\DoxyCodeLine{00626 }
\DoxyCodeLine{00627   QString name = getPreviewName(m\_renderSessionId);}
\DoxyCodeLine{00628 }
\DoxyCodeLine{00629   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} ras = renderData.m\_rasA-\/>clone();}
\DoxyCodeLine{00630   \textcolor{keywordflow}{if} (renderData.m\_rasB) \{}
\DoxyCodeLine{00631     assert(m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_aadbd5a3a50b242b366a93023d5f7da07}{m\_stereoscopic}});}
\DoxyCodeLine{00632     TRop::makeStereoRaster(ras, renderData.m\_rasB);}
\DoxyCodeLine{00633   \}}
\DoxyCodeLine{00634 }
\DoxyCodeLine{00635   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} img(ras);}
\DoxyCodeLine{00636   img-\/>setDpi(m\_xDpi, m\_yDpi);}
\DoxyCodeLine{00637 }
\DoxyCodeLine{00638   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{00639     \textcolor{keywordflow}{if} (renderData.m\_info.m\_mark != \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}())}
\DoxyCodeLine{00640       addMark(renderData.m\_info.m\_mark, img);}
\DoxyCodeLine{00641 }
\DoxyCodeLine{00642     \textcolor{keywordflow}{if} (img-\/>getRaster()-\/>getPixelSize() == 8) \{}
\DoxyCodeLine{00643       \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} aux(img-\/>getRaster()-\/>getLx(), img-\/>getRaster()-\/>getLy());}
\DoxyCodeLine{00644       \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(aux, img-\/>getRaster());}
\DoxyCodeLine{00645       img-\/>setRaster(aux);}
\DoxyCodeLine{00646     \}}
\DoxyCodeLine{00647 }
\DoxyCodeLine{00648     QString frameName = name + QString::number(renderData.m\_frames[0] + 1);}
\DoxyCodeLine{00649 }
\DoxyCodeLine{00650     TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a124eae4cf370288f42c22b3477cb5163}{add}}(frameName.toStdString(), img);}
\DoxyCodeLine{00651 }
\DoxyCodeLine{00652     \textcolor{comment}{// controlla se ci sono frame(uguali ad altri) da mettere in cache}}
\DoxyCodeLine{00653 }
\DoxyCodeLine{00654     std::vector<double>::const\_iterator jt;}
\DoxyCodeLine{00655     \textcolor{keywordflow}{for} (jt = renderData.m\_frames.begin(), ++jt;}
\DoxyCodeLine{00656          jt != renderData.m\_frames.end(); ++jt) \{}
\DoxyCodeLine{00657       frameName = name + QString::number(*jt + 1);}
\DoxyCodeLine{00658       TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a124eae4cf370288f42c22b3477cb5163}{add}}(frameName.toStdString(), img);}
\DoxyCodeLine{00659     \}}
\DoxyCodeLine{00660   \} \textcolor{keywordflow}{catch} (...) \{}
\DoxyCodeLine{00661   \}}
\DoxyCodeLine{00662 }
\DoxyCodeLine{00663   std::set<MovieRenderer::Listener *>::iterator listenerIt =}
\DoxyCodeLine{00664       m\_listeners.begin();}
\DoxyCodeLine{00665 }
\DoxyCodeLine{00666   \textcolor{keywordtype}{bool} okToContinue = \textcolor{keyword}{true};}
\DoxyCodeLine{00667 }
\DoxyCodeLine{00668   \textcolor{keywordflow}{for} (; listenerIt != m\_listeners.end(); ++listenerIt)}
\DoxyCodeLine{00669     okToContinue \&= (*listenerIt)-\/>onFrameCompleted(renderData.m\_frames[0]);}
\DoxyCodeLine{00670 }
\DoxyCodeLine{00671   \textcolor{keywordflow}{if} (!okToContinue) \{}
\DoxyCodeLine{00672     \textcolor{comment}{// Svuoto la cache nel caso in cui si esce dal render prima della fine}}
\DoxyCodeLine{00673     \textcolor{keywordtype}{int} from, to;}
\DoxyCodeLine{00674     getRange(m\_scene, \textcolor{keyword}{true}, from, to);}
\DoxyCodeLine{00675     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = from; i < to; i++) \{}
\DoxyCodeLine{00676       QString frameName = name + QString::number(i + 1);}
\DoxyCodeLine{00677       TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a57d63227dfe2532b0aed22c47113be66}{remove}}(frameName.toStdString());}
\DoxyCodeLine{00678     \}}
\DoxyCodeLine{00679 }
\DoxyCodeLine{00680     m\_renderer.stopRendering();}
\DoxyCodeLine{00681   \}}
\DoxyCodeLine{00682 }
\DoxyCodeLine{00683   m\_firstCompletedRaster = \textcolor{keyword}{false};}
\DoxyCodeLine{00684 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a66999057c680141e8c99097848082e62}\label{class_movie_renderer_1_1_imp_a66999057c680141e8c99097848082e62}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!doRenderRasterCompleted@{doRenderRasterCompleted}}
\index{doRenderRasterCompleted@{doRenderRasterCompleted}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{doRenderRasterCompleted()}{doRenderRasterCompleted()}}
{\footnotesize\ttfamily void Movie\+Renderer\+::\+Imp\+::do\+Render\+Raster\+Completed (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&}]{render\+Data }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00472                                                                            \{}
\DoxyCodeLine{00473   assert(!(m\_cacheResults \&\&}
\DoxyCodeLine{00474            m\_levelUpdaterB.get()));  \textcolor{comment}{// Cannot cache results on stereoscopy}}
\DoxyCodeLine{00475 }
\DoxyCodeLine{00476   QMutexLocker locker(\&m\_mutex);}
\DoxyCodeLine{00477 }
\DoxyCodeLine{00478   \textcolor{keywordtype}{bool} allowMT    = Preferences::instance()-\/>getFfmpegMultiThread();}
\DoxyCodeLine{00479   \textcolor{keywordtype}{bool} requireSeq = allowMT ? m\_seqRequired : m\_movieType;}
\DoxyCodeLine{00480 }
\DoxyCodeLine{00481   \textcolor{comment}{// Build soundtrack at the first time a frame is completed -\/ and the filetype}}
\DoxyCodeLine{00482   \textcolor{comment}{// is that of a movie.}}
\DoxyCodeLine{00483   \textcolor{keywordflow}{if} (m\_firstCompletedRaster \&\& m\_movieType \&\& !m\_st) \{}
\DoxyCodeLine{00484     \textcolor{keywordtype}{int} boardDuration = addBoard();}
\DoxyCodeLine{00485 }
\DoxyCodeLine{00486     \textcolor{keywordtype}{int} from, to;}
\DoxyCodeLine{00487     getRange(m\_scene, \textcolor{keyword}{false}, from, to);}
\DoxyCodeLine{00488 }
\DoxyCodeLine{00489     \mbox{\hyperlink{class_t_level_p}{TLevelP}} oldLevel(m\_levelUpdaterA-\/>getInputLevel());}
\DoxyCodeLine{00490     \textcolor{keywordflow}{if} (oldLevel) \{}
\DoxyCodeLine{00491       from = std::min(from, oldLevel-\/>begin()-\/>first.getNumber() -\/ 1);}
\DoxyCodeLine{00492       to   = std::max(to, (-\/-\/oldLevel-\/>end())-\/>first.getNumber() -\/ 1);}
\DoxyCodeLine{00493     \}}
\DoxyCodeLine{00494 }
\DoxyCodeLine{00495     addSoundtrack(}
\DoxyCodeLine{00496         from, to,}
\DoxyCodeLine{00497         m\_scene-\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}()-\/>\mbox{\hyperlink{class_t_scene_properties_abea7b4b8e4f0cedbf753b26ec30b5331}{getOutputProperties}}()-\/>\mbox{\hyperlink{class_t_output_properties_a0d9662971bc33097aa1b55111965b967}{getFrameRate}}(),}
\DoxyCodeLine{00498         boardDuration);}
\DoxyCodeLine{00499 }
\DoxyCodeLine{00500     \textcolor{keywordflow}{if} (m\_st) \{}
\DoxyCodeLine{00501       m\_levelUpdaterA-\/>getLevelWriter()-\/>saveSoundTrack(m\_st.getPointer());}
\DoxyCodeLine{00502       \textcolor{keywordflow}{if} (m\_levelUpdaterB.get())}
\DoxyCodeLine{00503         m\_levelUpdaterB-\/>getLevelWriter()-\/>saveSoundTrack(m\_st.getPointer());}
\DoxyCodeLine{00504     \}}
\DoxyCodeLine{00505   \}}
\DoxyCodeLine{00506 }
\DoxyCodeLine{00507   \textcolor{comment}{// Output frames must be *cloned*, since the supplied rasters will be}}
\DoxyCodeLine{00508   \textcolor{comment}{// overwritten by m\_renderer}}
\DoxyCodeLine{00509   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} toBeSavedRasA = renderData.m\_rasA-\/>clone();}
\DoxyCodeLine{00510   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} toBeSavedRasB =}
\DoxyCodeLine{00511       renderData.m\_rasB ? renderData.m\_rasB-\/>clone() : \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}();}
\DoxyCodeLine{00512 }
\DoxyCodeLine{00513   m\_toBeSaved[renderData.m\_frames[0]] =}
\DoxyCodeLine{00514       std::make\_pair(toBeSavedRasA, toBeSavedRasB);}
\DoxyCodeLine{00515 }
\DoxyCodeLine{00516   m\_toBeAppliedGamma[renderData.m\_frames[0]] = \textcolor{keyword}{true};}
\DoxyCodeLine{00517 }
\DoxyCodeLine{00518   \textcolor{comment}{// Prepare the cluster's frames to be saved (possibly in the future)}}
\DoxyCodeLine{00519   std::vector<double>::const\_iterator jt;}
\DoxyCodeLine{00520   \textcolor{keywordflow}{for} (jt = renderData.m\_frames.begin(), ++jt; jt != renderData.m\_frames.end();}
\DoxyCodeLine{00521        ++jt) \{}
\DoxyCodeLine{00522     m\_toBeSaved[*jt]        = std::make\_pair(toBeSavedRasA, toBeSavedRasB);}
\DoxyCodeLine{00523     m\_toBeAppliedGamma[*jt] = \textcolor{keyword}{false};}
\DoxyCodeLine{00524   \}}
\DoxyCodeLine{00525 }
\DoxyCodeLine{00526   \textcolor{comment}{// Attempt flushing as many frames as possible to the level updater(s)}}
\DoxyCodeLine{00527   \textcolor{keywordflow}{while} (!m\_toBeSaved.empty()) \{}
\DoxyCodeLine{00528     std::map<double, std::pair<TRasterP, TRasterP>>::iterator ft =}
\DoxyCodeLine{00529         m\_toBeSaved.begin();}
\DoxyCodeLine{00530 }
\DoxyCodeLine{00531     \textcolor{comment}{// In the *movie type* case, frames must be saved sequentially.}}
\DoxyCodeLine{00532     \textcolor{comment}{// If the frame is not the next one in the sequence, wait until *that* frame}}
\DoxyCodeLine{00533     \textcolor{comment}{// is available.}}
\DoxyCodeLine{00534     \textcolor{keywordflow}{if} (requireSeq \&\&}
\DoxyCodeLine{00535         (ft-\/>first != m\_framesToBeRendered[m\_nextFrameIdxToSave].first))}
\DoxyCodeLine{00536       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00537 }
\DoxyCodeLine{00538     \textcolor{comment}{// This thread will be the one processing ft -\/ remove it from the map to}}
\DoxyCodeLine{00539     \textcolor{comment}{// prevent another}}
\DoxyCodeLine{00540     \textcolor{comment}{// thread from interfering}}
\DoxyCodeLine{00541     \textcolor{keywordtype}{double} frame = ft-\/>first;}
\DoxyCodeLine{00542     std::pair<TRasterP, TRasterP> rasters = ft-\/>second;}
\DoxyCodeLine{00543 }
\DoxyCodeLine{00544     ++m\_nextFrameIdxToSave;}
\DoxyCodeLine{00545     m\_toBeSaved.erase(ft);}
\DoxyCodeLine{00546 }
\DoxyCodeLine{00547     \textcolor{comment}{// Save current frame}}
\DoxyCodeLine{00548     std::pair<bool, int> savedFrame;}
\DoxyCodeLine{00549     \{}
\DoxyCodeLine{00550       \textcolor{comment}{// Time the saving procedure}}
\DoxyCodeLine{00551       \textcolor{keyword}{struct }SaveTimer \{}
\DoxyCodeLine{00552         \textcolor{keywordtype}{int} \&m\_count;}
\DoxyCodeLine{00553         SaveTimer(\textcolor{keywordtype}{int} \&count) : m\_count(count) \{}
\DoxyCodeLine{00554           \textcolor{keywordflow}{if} (m\_count++ == 0) \mbox{\hyperlink{class_t_stop_watch_aaee6e300a0123a333d7cb80ad253125e}{TStopWatch::global}}(0).\mbox{\hyperlink{class_t_stop_watch_a81eefb8cd2dc776cc31799973be063a8}{start}}();}
\DoxyCodeLine{00555         \}}
\DoxyCodeLine{00556         \string~SaveTimer() \{}
\DoxyCodeLine{00557           \textcolor{keywordflow}{if} (-\/-\/m\_count == 0) \mbox{\hyperlink{class_t_stop_watch_aaee6e300a0123a333d7cb80ad253125e}{TStopWatch::global}}(0).stop();}
\DoxyCodeLine{00558         \}}
\DoxyCodeLine{00559       \} saveTimer(m\_savingThreadsCount);}
\DoxyCodeLine{00560 }
\DoxyCodeLine{00561       \textcolor{comment}{// Unlock the mutex only in case this is NOT a movie type. Single images}}
\DoxyCodeLine{00562       \textcolor{comment}{// can be saved concurrently.}}
\DoxyCodeLine{00563       \textcolor{keyword}{struct }MutexUnlocker \{}
\DoxyCodeLine{00564         QMutexLocker *m\_locker;}
\DoxyCodeLine{00565         \string~MutexUnlocker() \{}
\DoxyCodeLine{00566           \textcolor{keywordflow}{if} (m\_locker) m\_locker-\/>relock();}
\DoxyCodeLine{00567         \}}
\DoxyCodeLine{00568       \} unlocker = \{requireSeq ? (QMutexLocker *)0}
\DoxyCodeLine{00569                                : (locker.unlock(), \&locker)\};}
\DoxyCodeLine{00570 }
\DoxyCodeLine{00571       savedFrame = \mbox{\hyperlink{class_movie_renderer_1_1_imp_a600b9af83be9025249d0bd22371774b8}{saveFrame}}(frame, rasters);}
\DoxyCodeLine{00572     \}}
\DoxyCodeLine{00573 }
\DoxyCodeLine{00574     \textcolor{comment}{// Report status and deal with responses}}
\DoxyCodeLine{00575     \textcolor{keywordtype}{bool} okToContinue = \textcolor{keyword}{true};}
\DoxyCodeLine{00576 }
\DoxyCodeLine{00577     std::set<MovieRenderer::Listener *>::iterator lt = m\_listeners.begin();}
\DoxyCodeLine{00578 }
\DoxyCodeLine{00579     \textcolor{keywordflow}{if} (savedFrame.first) \{}
\DoxyCodeLine{00580       \textcolor{keywordflow}{for} (; lt != m\_listeners.end(); ++lt)}
\DoxyCodeLine{00581         okToContinue \&= (*lt)-\/>onFrameCompleted(savedFrame.second);}
\DoxyCodeLine{00582     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00583       \textcolor{keywordflow}{for} (; lt != m\_listeners.end(); ++lt) \{}
\DoxyCodeLine{00584         \mbox{\hyperlink{class_t_exception}{TException}} e;}
\DoxyCodeLine{00585         okToContinue \&= (*lt)-\/>onFrameFailed(savedFrame.second, e);}
\DoxyCodeLine{00586       \}}
\DoxyCodeLine{00587     \}}
\DoxyCodeLine{00588 }
\DoxyCodeLine{00589     \textcolor{keywordflow}{if} (!okToContinue) \{}
\DoxyCodeLine{00590       \textcolor{comment}{// Some listener invoked termination of the render procedure. It seems}}
\DoxyCodeLine{00591       \textcolor{comment}{// it's their right}}
\DoxyCodeLine{00592       \textcolor{comment}{// to do so. I wonder what happens if two listeners would disagree on the}}
\DoxyCodeLine{00593       \textcolor{comment}{// matter...}}
\DoxyCodeLine{00594       \textcolor{comment}{// BTW stop the rendering, alright.}}
\DoxyCodeLine{00595 }
\DoxyCodeLine{00596       \{}
\DoxyCodeLine{00597         \textcolor{keywordtype}{int} from, to;}
\DoxyCodeLine{00598         getRange(m\_scene, \textcolor{keyword}{false}, from,}
\DoxyCodeLine{00599                  to);  \textcolor{comment}{// It's ok since cancels can only happen from Toonz...}}
\DoxyCodeLine{00600 }
\DoxyCodeLine{00601         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = from; i < to; i++)}
\DoxyCodeLine{00602           TImageCache::instance()-\/>remove(m\_renderCacheId +}
\DoxyCodeLine{00603                                           std::to\_string(i + 1));}
\DoxyCodeLine{00604       \}}
\DoxyCodeLine{00605 }
\DoxyCodeLine{00606       m\_renderer.stopRendering();}
\DoxyCodeLine{00607 }
\DoxyCodeLine{00608       m\_levelUpdaterA}
\DoxyCodeLine{00609           .reset();  \textcolor{comment}{// No more saving. Further attempts to save images}}
\DoxyCodeLine{00610       m\_levelUpdaterB.reset();  \textcolor{comment}{// will be rejected and treated as failures.}}
\DoxyCodeLine{00611     \}}
\DoxyCodeLine{00612   \}}
\DoxyCodeLine{00613 }
\DoxyCodeLine{00614   m\_firstCompletedRaster = \textcolor{keyword}{false};}
\DoxyCodeLine{00615 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a6ab85d36f6c10210221aa4e8c616d479}\label{class_movie_renderer_1_1_imp_a6ab85d36f6c10210221aa4e8c616d479}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!onRenderFailure@{onRenderFailure}}
\index{onRenderFailure@{onRenderFailure}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{onRenderFailure()}{onRenderFailure()}}
{\footnotesize\ttfamily void Movie\+Renderer\+::\+Imp\+::on\+Render\+Failure (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&}]{render\+Data,  }\item[{\mbox{\hyperlink{class_t_exception}{TException}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_render_port}{TRender\+Port}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00689                                                         \{}
\DoxyCodeLine{00690   QMutexLocker sl(\&m\_mutex);  \textcolor{comment}{// Lock as soon as possible.}}
\DoxyCodeLine{00691                               \textcolor{comment}{// No sense making it later in this case!}}
\DoxyCodeLine{00692   m\_failure = \textcolor{keyword}{true};}
\DoxyCodeLine{00693 }
\DoxyCodeLine{00694   \textcolor{keywordtype}{bool} allowMT    = Preferences::instance()-\/>getFfmpegMultiThread();}
\DoxyCodeLine{00695   \textcolor{keywordtype}{bool} requireSeq = allowMT ? m\_seqRequired : m\_movieType;}
\DoxyCodeLine{00696 }
\DoxyCodeLine{00697   \textcolor{comment}{// If the saver object has already been destroyed -\/ or it was never}}
\DoxyCodeLine{00698   \textcolor{comment}{// created to begin with, nothing to be done}}
\DoxyCodeLine{00699   \textcolor{keywordflow}{if} (!m\_levelUpdaterA.get()) \textcolor{keywordflow}{return};  \textcolor{comment}{// The preview case would fall here}}
\DoxyCodeLine{00700 }
\DoxyCodeLine{00701   \textcolor{comment}{// Flush out as much as we can of the frames that were already rendered}}
\DoxyCodeLine{00702   m\_toBeSaved[0.0] =}
\DoxyCodeLine{00703       std::make\_pair(\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}(), \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}());  \textcolor{comment}{// ?? Why is this ??}}
\DoxyCodeLine{00704 }
\DoxyCodeLine{00705   std::map<double, std::pair<TRasterP, TRasterP>>::iterator it =}
\DoxyCodeLine{00706       m\_toBeSaved.begin();}
\DoxyCodeLine{00707   \textcolor{keywordflow}{while} (it != m\_toBeSaved.end()) \{}
\DoxyCodeLine{00708     \textcolor{keywordflow}{if} (requireSeq \&\&}
\DoxyCodeLine{00709         (it-\/>first != m\_framesToBeRendered[m\_nextFrameIdxToSave].first))}
\DoxyCodeLine{00710       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00711 }
\DoxyCodeLine{00712     \textcolor{comment}{// o\_o!}}
\DoxyCodeLine{00713     \textcolor{comment}{// I would have expected that at least those frames that were computed could}}
\DoxyCodeLine{00714     \textcolor{comment}{// attempt saving! Why is this not addressed? They're even marked as}}
\DoxyCodeLine{00715     \textcolor{comment}{// 'failed'!}}
\DoxyCodeLine{00716 }
\DoxyCodeLine{00717     \textcolor{keywordtype}{double} stretchFac = (double)renderData.m\_info.m\_timeStretchTo /}
\DoxyCodeLine{00718                         renderData.m\_info.m\_timeStretchFrom;}
\DoxyCodeLine{00719 }
\DoxyCodeLine{00720     \textcolor{keywordtype}{int} fr;}
\DoxyCodeLine{00721     if (stretchFac != 1)}
\DoxyCodeLine{00722       fr = tround(it-\/>first * stretchFac);}
\DoxyCodeLine{00723     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00724       fr = (int)it-\/>first;}
\DoxyCodeLine{00725 }
\DoxyCodeLine{00726     \textcolor{comment}{// No saving? Really?}}
\DoxyCodeLine{00727 }
\DoxyCodeLine{00728     std::set<MovieRenderer::Listener *>::iterator lt = m\_listeners.begin();}
\DoxyCodeLine{00729     \textcolor{keywordtype}{bool} okToContinue                                = \textcolor{keyword}{true};}
\DoxyCodeLine{00730 }
\DoxyCodeLine{00731     \textcolor{keywordflow}{for} (; lt != m\_listeners.end(); ++lt)}
\DoxyCodeLine{00732       okToContinue \&= (*lt)-\/>onFrameFailed((\textcolor{keywordtype}{int})it-\/>first, e);}
\DoxyCodeLine{00733 }
\DoxyCodeLine{00734     \textcolor{keywordflow}{if} (!okToContinue) m\_renderer.stopRendering();}
\DoxyCodeLine{00735 }
\DoxyCodeLine{00736     ++m\_nextFrameIdxToSave;}
\DoxyCodeLine{00737     m\_toBeSaved.erase(it++);}
\DoxyCodeLine{00738   \}}
\DoxyCodeLine{00739 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_ac86c54ce82feda4b353e89ebce84216b}\label{class_movie_renderer_1_1_imp_ac86c54ce82feda4b353e89ebce84216b}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!onRenderFinished@{onRenderFinished}}
\index{onRenderFinished@{onRenderFinished}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{onRenderFinished()}{onRenderFinished()}}
{\footnotesize\ttfamily void Movie\+Renderer\+::\+Imp\+::on\+Render\+Finished (\begin{DoxyParamCaption}\item[{bool}]{is\+Canceled = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_render_port}{TRender\+Port}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00743                                                        \{}
\DoxyCodeLine{00744   \mbox{\hyperlink{class_t_file_path}{TFilePath}} levelName(}
\DoxyCodeLine{00745       m\_levelUpdaterA.get()}
\DoxyCodeLine{00746           ? m\_fp}
\DoxyCodeLine{00747           : \mbox{\hyperlink{class_t_file_path}{TFilePath}}(getPreviewName(m\_renderSessionId).toStdWString()));}
\DoxyCodeLine{00748 }
\DoxyCodeLine{00749   \textcolor{keywordflow}{if} (m\_waitAfterFinish) \{}
\DoxyCodeLine{00750     \textcolor{comment}{// Wait half a second to add some stability before finalizing}}
\DoxyCodeLine{00751     QEventLoop eloop;}
\DoxyCodeLine{00752     QTimer timer;}
\DoxyCodeLine{00753     timer.connect(\&timer, \&QTimer::timeout, \&eloop, \&QEventLoop::quit);}
\DoxyCodeLine{00754     timer.start(500);}
\DoxyCodeLine{00755     eloop.exec();}
\DoxyCodeLine{00756   \}}
\DoxyCodeLine{00757 }
\DoxyCodeLine{00758   \textcolor{comment}{// Close updaters. After this, the output levels should be finalized on disk.}}
\DoxyCodeLine{00759   m\_levelUpdaterA.reset();}
\DoxyCodeLine{00760   m\_levelUpdaterB.reset();}
\DoxyCodeLine{00761 }
\DoxyCodeLine{00762   \textcolor{keywordflow}{if} (!m\_failure) \{}
\DoxyCodeLine{00763     \textcolor{comment}{// Inform listeners of the render completion}}
\DoxyCodeLine{00764     std::set<MovieRenderer::Listener *>::iterator it;}
\DoxyCodeLine{00765     \textcolor{keywordflow}{for} (it = m\_listeners.begin(); it != m\_listeners.end(); ++it)}
\DoxyCodeLine{00766       (*it)-\/>onSequenceCompleted(levelName);}
\DoxyCodeLine{00767 }
\DoxyCodeLine{00768     \textcolor{comment}{// I wonder why listeners are not informed of a failed sequence, btw...}}
\DoxyCodeLine{00769   \}}
\DoxyCodeLine{00770 }
\DoxyCodeLine{00771   release();  \textcolor{comment}{// The movieRenderer is released by the render process. It could}}
\DoxyCodeLine{00772               \textcolor{comment}{// eventually be deleted.}}
\DoxyCodeLine{00773 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a8a70aa0241932852101908c93e57365f}\label{class_movie_renderer_1_1_imp_a8a70aa0241932852101908c93e57365f}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!onRenderRasterCompleted@{onRenderRasterCompleted}}
\index{onRenderRasterCompleted@{onRenderRasterCompleted}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{onRenderRasterCompleted()}{onRenderRasterCompleted()}}
{\footnotesize\ttfamily void Movie\+Renderer\+::\+Imp\+::on\+Render\+Raster\+Completed (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&}]{render\+Data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_render_port}{TRender\+Port}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00354                                                                            \{}
\DoxyCodeLine{00355   \textcolor{keywordflow}{if} (m\_preview)}
\DoxyCodeLine{00356     doPreviewRasterCompleted(renderData);}
\DoxyCodeLine{00357   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00358     doRenderRasterCompleted(renderData);}
\DoxyCodeLine{00359 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a876d0b661b631b129c4c5174272a6ee1}\label{class_movie_renderer_1_1_imp_a876d0b661b631b129c4c5174272a6ee1}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!postProcessImage@{postProcessImage}}
\index{postProcessImage@{postProcessImage}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{postProcessImage()}{postProcessImage()}}
{\footnotesize\ttfamily void Movie\+Renderer\+::\+Imp\+::post\+Process\+Image (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&}]{img,  }\item[{bool}]{has64bit\+Output\+Support,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} \&}]{mark,  }\item[{int}]{frame }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00365                                                                            \{}
\DoxyCodeLine{00366   img-\/>setDpi(m\_xDpi, m\_yDpi);}
\DoxyCodeLine{00367 }
\DoxyCodeLine{00368   \textcolor{keywordflow}{if} (img-\/>getRaster()-\/>getPixelSize() == 8 \&\& !has64bitOutputSupport) \{}
\DoxyCodeLine{00369     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} aux(img-\/>getRaster()-\/>getLx(), img-\/>getRaster()-\/>getLy());}
\DoxyCodeLine{00370     \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(aux, img-\/>getRaster());}
\DoxyCodeLine{00371     img-\/>setRaster(aux);}
\DoxyCodeLine{00372   \}}
\DoxyCodeLine{00373 }
\DoxyCodeLine{00374   \textcolor{keywordflow}{if} (mark) addMark(mark, img);}
\DoxyCodeLine{00375 }
\DoxyCodeLine{00376   \textcolor{keywordflow}{if} (Preferences::instance()-\/>isSceneNumberingEnabled())}
\DoxyCodeLine{00377     TRasterImageUtils::addGlobalNumbering(img, m\_scene-\/>\mbox{\hyperlink{class_toonz_scene_a1fa0a1cbf9eb6360d980392acc99924b}{getSceneName}}(), frame);}
\DoxyCodeLine{00378 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a672a24838298237364eabcac08e630ec}\label{class_movie_renderer_1_1_imp_a672a24838298237364eabcac08e630ec}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!prepareForStart@{prepareForStart}}
\index{prepareForStart@{prepareForStart}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{prepareForStart()}{prepareForStart()}}
{\footnotesize\ttfamily void Movie\+Renderer\+::\+Imp\+::prepare\+For\+Start (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00212                                        \{}
\DoxyCodeLine{00213   \textcolor{keyword}{struct }locals \{}
\DoxyCodeLine{00214     \textcolor{keyword}{static} \textcolor{keywordtype}{void} eraseUncompatibleExistingLevel(}
\DoxyCodeLine{00215         \textcolor{keyword}{const} \mbox{\hyperlink{class_t_file_path}{TFilePath}} \&fp, \textcolor{keyword}{const} \mbox{\hyperlink{class_t_dimension_t}{TDimension}} \&imageSize)  \textcolor{comment}{// nothrow}}
\DoxyCodeLine{00216     \{}
\DoxyCodeLine{00217       assert(!fp.isEmpty());}
\DoxyCodeLine{00218 }
\DoxyCodeLine{00219       \textcolor{keywordflow}{if} (TSystem::doesExistFileOrLevel(fp)) \{}
\DoxyCodeLine{00220         \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespace_t_sop_a12e3eb96f32b4d2ebddf0b2c99a43eb4}{remove}} = \textcolor{keyword}{false};}
\DoxyCodeLine{00221         \textcolor{comment}{// In case the raster specifics are different from those of a currently}}
\DoxyCodeLine{00222         \textcolor{comment}{// existing movie, erase it}}
\DoxyCodeLine{00223         \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{00224           \textcolor{keywordflow}{if} (fp.isFfmpegType()) \{}
\DoxyCodeLine{00225             TSystem::removeFileOrLevel(fp);}
\DoxyCodeLine{00226           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00227             \mbox{\hyperlink{class_t_level_reader_p}{TLevelReaderP}} lr(fp);}
\DoxyCodeLine{00228             lr-\/>loadInfo();}
\DoxyCodeLine{00229 }
\DoxyCodeLine{00230             \textcolor{keyword}{const} \mbox{\hyperlink{class_t_image_info}{TImageInfo}} *info = lr-\/>getImageInfo();}
\DoxyCodeLine{00231             \textcolor{keywordflow}{if} (!info || info-\/>m\_lx != imageSize.lx ||}
\DoxyCodeLine{00232                 info-\/>m\_ly != imageSize.ly)}
\DoxyCodeLine{00233               TSystem::removeFileOrLevel(fp);  \textcolor{comment}{// nothrow}}
\DoxyCodeLine{00234           \}}
\DoxyCodeLine{00235         \} \textcolor{keywordflow}{catch} (...) \{}
\DoxyCodeLine{00236           \textcolor{comment}{// Same if the level could not be read/opened}}
\DoxyCodeLine{00237           TSystem::removeFileOrLevel(fp);  \textcolor{comment}{// nothrow}}
\DoxyCodeLine{00238         \}}
\DoxyCodeLine{00239 }
\DoxyCodeLine{00240         \textcolor{comment}{// NOTE: The level removal procedure could still fail.}}
\DoxyCodeLine{00241         \textcolor{comment}{// In this case, no signaling takes place. The level readers will throw}}
\DoxyCodeLine{00242         \textcolor{comment}{// when the time to write on the file comes, leading to a render}}
\DoxyCodeLine{00243         \textcolor{comment}{// failure.}}
\DoxyCodeLine{00244       \}}
\DoxyCodeLine{00245     \}}
\DoxyCodeLine{00246   \};}
\DoxyCodeLine{00247 }
\DoxyCodeLine{00248   \mbox{\hyperlink{class_t_output_properties}{TOutputProperties}} *oprop = m\_scene-\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}()-\/>\mbox{\hyperlink{class_t_scene_properties_abea7b4b8e4f0cedbf753b26ec30b5331}{getOutputProperties}}();}
\DoxyCodeLine{00249   \textcolor{keywordtype}{double} frameRate         = (double)oprop-\/>\mbox{\hyperlink{class_t_output_properties_a0d9662971bc33097aa1b55111965b967}{getFrameRate}}();}
\DoxyCodeLine{00250 }
\DoxyCodeLine{00251   \textcolor{comment}{/*-\/-\/ Frame rate の stretch -\/-\/*/}}
\DoxyCodeLine{00252   \textcolor{keywordtype}{double} stretchFactor = oprop-\/>\mbox{\hyperlink{class_t_output_properties_afa7c771452b57b50047aa4afc6032cad}{getRenderSettings}}().\mbox{\hyperlink{class_t_render_settings_a6b8313c094bdb0c2ab6902b1f895694e}{m\_timeStretchTo}} /}
\DoxyCodeLine{00253                          oprop-\/>\mbox{\hyperlink{class_t_output_properties_afa7c771452b57b50047aa4afc6032cad}{getRenderSettings}}().\mbox{\hyperlink{class_t_render_settings_aec1a905d4eec617a546c286480f41b2a}{m\_timeStretchFrom}};}
\DoxyCodeLine{00254   frameRate *= stretchFactor;}
\DoxyCodeLine{00255 }
\DoxyCodeLine{00256   \textcolor{comment}{// Get the shrink}}
\DoxyCodeLine{00257   \textcolor{keywordtype}{int} shrinkX = m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a52dd41881bbf6aaf953fe300be2e233e}{m\_shrinkX}},}
\DoxyCodeLine{00258       shrinkY = m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_ae1882f584ce9ffad12ce6bf9ff23814c}{m\_shrinkY}};}
\DoxyCodeLine{00259 }
\DoxyCodeLine{00260   \textcolor{comment}{// Build the render area}}
\DoxyCodeLine{00261   \mbox{\hyperlink{class_t_point_t}{TPointD}} cameraPos(-\/0.5 * m\_frameSize.lx, -\/0.5 * m\_frameSize.ly);}
\DoxyCodeLine{00262   \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}} cameraRes(\textcolor{keywordtype}{double}(m\_frameSize.lx) / shrinkX,}
\DoxyCodeLine{00263                         \textcolor{keywordtype}{double}(m\_frameSize.ly) / shrinkY);}
\DoxyCodeLine{00264   \mbox{\hyperlink{class_t_dimension_t}{TDimension}} cameraResI(cameraRes.lx, cameraRes.ly);}
\DoxyCodeLine{00265 }
\DoxyCodeLine{00266   \mbox{\hyperlink{class_t_rect_t}{TRectD}} renderArea(cameraPos.x, cameraPos.y, cameraPos.x + cameraRes.lx,}
\DoxyCodeLine{00267                     cameraPos.y + cameraRes.ly);}
\DoxyCodeLine{00268   \mbox{\hyperlink{class_t_render_port_a743d79f021d27a9f8017ef468839cadb}{setRenderArea}}(renderArea);}
\DoxyCodeLine{00269 }
\DoxyCodeLine{00270   \textcolor{keywordflow}{if} (!m\_fp.isEmpty()) \{}
\DoxyCodeLine{00271     \textcolor{keywordflow}{try}  \textcolor{comment}{// Construction of a LevelUpdater may throw (well, almost ANY operation}}
\DoxyCodeLine{00272          \textcolor{comment}{// on a LevelUpdater}}
\DoxyCodeLine{00273     \{    \textcolor{comment}{// could throw). But due to backward compatibility this function is}}
\DoxyCodeLine{00274          \textcolor{comment}{// assumed to be non-\/throwing.}}
\DoxyCodeLine{00275       \textcolor{keywordflow}{if} (!m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_aadbd5a3a50b242b366a93023d5f7da07}{m\_stereoscopic}}) \{}
\DoxyCodeLine{00276         locals::eraseUncompatibleExistingLevel(m\_fp, cameraResI);}
\DoxyCodeLine{00277 }
\DoxyCodeLine{00278         m\_levelUpdaterA.reset(\textcolor{keyword}{new} \mbox{\hyperlink{class_level_updater}{LevelUpdater}}(}
\DoxyCodeLine{00279             m\_fp, oprop-\/>\mbox{\hyperlink{class_t_output_properties_a9ef174e6f6239219fa563b037246c8d4}{getFileFormatProperties}}(m\_fp.\mbox{\hyperlink{class_t_file_path_aefca624df1a5468a4c78ec6d5dbfae26}{getType}}())));}
\DoxyCodeLine{00280         m\_levelUpdaterA-\/>getLevelWriter()-\/>setFrameRate(frameRate);}
\DoxyCodeLine{00281       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00282         \mbox{\hyperlink{class_t_file_path}{TFilePath}} leftFp  = m\_fp.\mbox{\hyperlink{class_t_file_path_a3ebf9ced558cfef97a60bba536b23c6f}{withName}}(m\_fp.\mbox{\hyperlink{class_t_file_path_af94f9b0aeceb6cdb980fa1789473503a}{getName}}() + \textcolor{stringliteral}{"{}\_l"{}});}
\DoxyCodeLine{00283         \mbox{\hyperlink{class_t_file_path}{TFilePath}} rightFp = m\_fp.\mbox{\hyperlink{class_t_file_path_a3ebf9ced558cfef97a60bba536b23c6f}{withName}}(m\_fp.\mbox{\hyperlink{class_t_file_path_af94f9b0aeceb6cdb980fa1789473503a}{getName}}() + \textcolor{stringliteral}{"{}\_r"{}});}
\DoxyCodeLine{00284 }
\DoxyCodeLine{00285         locals::eraseUncompatibleExistingLevel(leftFp, cameraResI);}
\DoxyCodeLine{00286         locals::eraseUncompatibleExistingLevel(rightFp, cameraResI);}
\DoxyCodeLine{00287 }
\DoxyCodeLine{00288         m\_levelUpdaterA.reset(\textcolor{keyword}{new} \mbox{\hyperlink{class_level_updater}{LevelUpdater}}(}
\DoxyCodeLine{00289             leftFp, oprop-\/>\mbox{\hyperlink{class_t_output_properties_a9ef174e6f6239219fa563b037246c8d4}{getFileFormatProperties}}(leftFp.\mbox{\hyperlink{class_t_file_path_aefca624df1a5468a4c78ec6d5dbfae26}{getType}}())));}
\DoxyCodeLine{00290         m\_levelUpdaterA-\/>getLevelWriter()-\/>setFrameRate(frameRate);}
\DoxyCodeLine{00291 }
\DoxyCodeLine{00292         m\_levelUpdaterB.reset(\textcolor{keyword}{new} \mbox{\hyperlink{class_level_updater}{LevelUpdater}}(}
\DoxyCodeLine{00293             rightFp, oprop-\/>\mbox{\hyperlink{class_t_output_properties_a9ef174e6f6239219fa563b037246c8d4}{getFileFormatProperties}}(rightFp.\mbox{\hyperlink{class_t_file_path_aefca624df1a5468a4c78ec6d5dbfae26}{getType}}())));}
\DoxyCodeLine{00294         m\_levelUpdaterB-\/>getLevelWriter()-\/>setFrameRate(frameRate);}
\DoxyCodeLine{00295       \}}
\DoxyCodeLine{00296     \} \textcolor{keywordflow}{catch} (...) \{}
\DoxyCodeLine{00297       \textcolor{comment}{// If we get here, it's because one of the LevelUpdaters could not be}}
\DoxyCodeLine{00298       \textcolor{comment}{// created. So, let's say}}
\DoxyCodeLine{00299       \textcolor{comment}{// that if one could not be created, then ALL OF THEM couldn't (ie saving}}
\DoxyCodeLine{00300       \textcolor{comment}{// is not possible at all).}}
\DoxyCodeLine{00301       m\_levelUpdaterA.reset();}
\DoxyCodeLine{00302       m\_levelUpdaterB.reset();}
\DoxyCodeLine{00303     \}}
\DoxyCodeLine{00304   \}}
\DoxyCodeLine{00305 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a600b9af83be9025249d0bd22371774b8}\label{class_movie_renderer_1_1_imp_a600b9af83be9025249d0bd22371774b8}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!saveFrame@{saveFrame}}
\index{saveFrame@{saveFrame}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{saveFrame()}{saveFrame()}}
{\footnotesize\ttfamily std\+::pair$<$ bool, int $>$ Movie\+Renderer\+::\+Imp\+::save\+Frame (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{const std\+::pair$<$ \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}, \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} $>$ \&}]{rasters }\end{DoxyParamCaption})}

Saves the specified rasters at the specified time; returns whether the frames were successfully saved, and the associated time-\/adjusted level frame. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00383                                                               \{}
\DoxyCodeLine{00384   \textcolor{keywordtype}{bool} success = \textcolor{keyword}{false};}
\DoxyCodeLine{00385 }
\DoxyCodeLine{00386   \textcolor{comment}{// Build the frame number to write to}}
\DoxyCodeLine{00387   \textcolor{keywordtype}{double} stretchFac = double(m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a6b8313c094bdb0c2ab6902b1f895694e}{m\_timeStretchTo}}) /}
\DoxyCodeLine{00388                       m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_aec1a905d4eec617a546c286480f41b2a}{m\_timeStretchFrom}};}
\DoxyCodeLine{00389 }
\DoxyCodeLine{00390   \textcolor{keywordtype}{int} fr = (stretchFac != 1) ? tround(frame * stretchFac) : int(frame);}
\DoxyCodeLine{00391 }
\DoxyCodeLine{00392   \textcolor{keywordtype}{int} boardDuration = 0;}
\DoxyCodeLine{00393   \textcolor{keywordflow}{if} (m\_movieType) \{}
\DoxyCodeLine{00394     \mbox{\hyperlink{class_board_settings}{BoardSettings}} *bs =}
\DoxyCodeLine{00395         m\_scene-\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}()-\/>\mbox{\hyperlink{class_t_scene_properties_abea7b4b8e4f0cedbf753b26ec30b5331}{getOutputProperties}}()-\/>getBoardSettings();}
\DoxyCodeLine{00396     boardDuration = (bs-\/>isActive()) ? bs-\/>getDuration() : 0;}
\DoxyCodeLine{00397   \}}
\DoxyCodeLine{00398 }
\DoxyCodeLine{00399   \mbox{\hyperlink{class_t_frame_id}{TFrameId}} fid(fr + 1 + boardDuration);}
\DoxyCodeLine{00400 }
\DoxyCodeLine{00401   \textcolor{keywordflow}{if} (m\_levelUpdaterA.get()) \{}
\DoxyCodeLine{00402     assert(m\_levelUpdaterB.get() || !rasters.second);}
\DoxyCodeLine{00403 }
\DoxyCodeLine{00404     \textcolor{comment}{// Analyze writer}}
\DoxyCodeLine{00405     \textcolor{keywordtype}{bool} has64bitOutputSupport = \textcolor{keyword}{false};}
\DoxyCodeLine{00406     \{}
\DoxyCodeLine{00407       \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_image_writer_p}{TImageWriterP}} writerA =}
\DoxyCodeLine{00408               m\_levelUpdaterA-\/>getLevelWriter()-\/>getFrameWriter(fid))}
\DoxyCodeLine{00409         has64bitOutputSupport = writerA-\/>is64bitOutputSupported();}
\DoxyCodeLine{00410 }
\DoxyCodeLine{00411       \textcolor{comment}{// NOTE: If the writer could not be retrieved, the updater will throw.}}
\DoxyCodeLine{00412       \textcolor{comment}{// Failure will be caught then.}}
\DoxyCodeLine{00413     \}}
\DoxyCodeLine{00414 }
\DoxyCodeLine{00415     \textcolor{comment}{// Prepare the images to be flushed}}
\DoxyCodeLine{00416     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rasterA = rasters.first, rasterB = rasters.second;}
\DoxyCodeLine{00417     assert(rasterA);}
\DoxyCodeLine{00418 }
\DoxyCodeLine{00419     \textcolor{comment}{/*-\/-\/-\/ 同じラスタのキャッシュを使いまわすとき、}}
\DoxyCodeLine{00420 \textcolor{comment}{    最初のものだけガンマをかけ、以降はそれを使いまわすようにする。}}
\DoxyCodeLine{00421 \textcolor{comment}{-\/-\/-\/*/}}
\DoxyCodeLine{00422     \textcolor{keywordflow}{if} (m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a50a57f97b30445a34582da914064d8ca}{m\_gamma}} != 1.0 \&\& m\_toBeAppliedGamma[frame]) \{}
\DoxyCodeLine{00423       \mbox{\hyperlink{namespace_t_rop_ad4babe6813c171b27ede85b106642bf2}{TRop::gammaCorrect}}(rasterA, m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a50a57f97b30445a34582da914064d8ca}{m\_gamma}});}
\DoxyCodeLine{00424       \textcolor{keywordflow}{if} (rasterB) \mbox{\hyperlink{namespace_t_rop_ad4babe6813c171b27ede85b106642bf2}{TRop::gammaCorrect}}(rasterB, m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a50a57f97b30445a34582da914064d8ca}{m\_gamma}});}
\DoxyCodeLine{00425     \}}
\DoxyCodeLine{00426 }
\DoxyCodeLine{00427     \textcolor{comment}{// Flush images}}
\DoxyCodeLine{00428     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{00429       \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} imgA(rasterA);}
\DoxyCodeLine{00430       postProcessImage(imgA, has64bitOutputSupport, m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a2cbb6a122530787ede233e5e59e44113}{m\_mark}},}
\DoxyCodeLine{00431                        fid.getNumber());}
\DoxyCodeLine{00432 }
\DoxyCodeLine{00433       m\_levelUpdaterA-\/>update(fid, imgA);}
\DoxyCodeLine{00434 }
\DoxyCodeLine{00435       \textcolor{keywordflow}{if} (rasterB) \{}
\DoxyCodeLine{00436         \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} imgB(rasterB);}
\DoxyCodeLine{00437         postProcessImage(imgB, has64bitOutputSupport, m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a2cbb6a122530787ede233e5e59e44113}{m\_mark}},}
\DoxyCodeLine{00438                          fid.getNumber());}
\DoxyCodeLine{00439 }
\DoxyCodeLine{00440         m\_levelUpdaterB-\/>update(fid, imgB);}
\DoxyCodeLine{00441       \}}
\DoxyCodeLine{00442 }
\DoxyCodeLine{00443       \textcolor{comment}{// Should no more throw from here on}}
\DoxyCodeLine{00444 }
\DoxyCodeLine{00445       \textcolor{keywordflow}{if} (m\_cacheResults) \{}
\DoxyCodeLine{00446         \textcolor{keywordflow}{if} (imgA-\/>getRaster()-\/>getPixelSize() == 8) \{}
\DoxyCodeLine{00447           \textcolor{comment}{// Convert 64-\/bit images to 32 -\/ cached images are supposed to be}}
\DoxyCodeLine{00448           \textcolor{comment}{// 32-\/bit}}
\DoxyCodeLine{00449           \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} aux(imgA-\/>getRaster()-\/>getLx(),}
\DoxyCodeLine{00450                          imgA-\/>getRaster()-\/>getLy());}
\DoxyCodeLine{00451 }
\DoxyCodeLine{00452           \mbox{\hyperlink{namespace_t_rop_a45a08fb48dd7d33ec629d722081d55c6}{TRop::convert}}(aux, imgA-\/>getRaster());}
\DoxyCodeLine{00453           imgA-\/>setRaster(aux);}
\DoxyCodeLine{00454         \}}
\DoxyCodeLine{00455 }
\DoxyCodeLine{00456         TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a124eae4cf370288f42c22b3477cb5163}{add}}(}
\DoxyCodeLine{00457             m\_renderCacheId + std::to\_string(fid.getNumber()), imgA);}
\DoxyCodeLine{00458       \}}
\DoxyCodeLine{00459 }
\DoxyCodeLine{00460       success = \textcolor{keyword}{true};}
\DoxyCodeLine{00461     \} \textcolor{keywordflow}{catch} (...) \{}
\DoxyCodeLine{00462       \textcolor{comment}{// Nothing. The images could not be saved for whatever reason.}}
\DoxyCodeLine{00463       \textcolor{comment}{// Failure is reported.}}
\DoxyCodeLine{00464     \}}
\DoxyCodeLine{00465   \}}
\DoxyCodeLine{00466 }
\DoxyCodeLine{00467   \textcolor{keywordflow}{return} std::make\_pair(success, fr);}
\DoxyCodeLine{00468 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l01153}{TImage\+Cache\+::add()}}, \mbox{\hyperlink{l00336}{TRop\+::convert()}}, and \mbox{\hyperlink{l00173}{TRop\+::gamma\+Correct()}}.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_movie_renderer_1_1_imp_ac52dd385c89e467b3cd814613fdf4ea7}\label{class_movie_renderer_1_1_imp_ac52dd385c89e467b3cd814613fdf4ea7}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_cacheResults@{m\_cacheResults}}
\index{m\_cacheResults@{m\_cacheResults}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_cacheResults}{m\_cacheResults}}
{\footnotesize\ttfamily bool Movie\+Renderer\+::\+Imp\+::m\+\_\+cache\+Results}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_ad78521a1fc8b22aa21ce4cb333abe018}\label{class_movie_renderer_1_1_imp_ad78521a1fc8b22aa21ce4cb333abe018}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_failure@{m\_failure}}
\index{m\_failure@{m\_failure}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_failure}{m\_failure}}
{\footnotesize\ttfamily bool Movie\+Renderer\+::\+Imp\+::m\+\_\+failure}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a4811c72452c85a868df6db55ce9ae305}\label{class_movie_renderer_1_1_imp_a4811c72452c85a868df6db55ce9ae305}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_firstCompletedRaster@{m\_firstCompletedRaster}}
\index{m\_firstCompletedRaster@{m\_firstCompletedRaster}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_firstCompletedRaster}{m\_firstCompletedRaster}}
{\footnotesize\ttfamily bool Movie\+Renderer\+::\+Imp\+::m\+\_\+first\+Completed\+Raster}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a1c3499c9b3aa81784795c358f91a6027}\label{class_movie_renderer_1_1_imp_a1c3499c9b3aa81784795c358f91a6027}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_fp@{m\_fp}}
\index{m\_fp@{m\_fp}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_fp}{m\_fp}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} Movie\+Renderer\+::\+Imp\+::m\+\_\+fp}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a7c2e14ccfc7ebd06a80730140007ff82}\label{class_movie_renderer_1_1_imp_a7c2e14ccfc7ebd06a80730140007ff82}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_frameSize@{m\_frameSize}}
\index{m\_frameSize@{m\_frameSize}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_frameSize}{m\_frameSize}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_dimension_t}{TDimension}} Movie\+Renderer\+::\+Imp\+::m\+\_\+frame\+Size}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_ae84848cece329c9e8f3e17646449d4d1}\label{class_movie_renderer_1_1_imp_ae84848cece329c9e8f3e17646449d4d1}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_framesToBeRendered@{m\_framesToBeRendered}}
\index{m\_framesToBeRendered@{m\_framesToBeRendered}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_framesToBeRendered}{m\_framesToBeRendered}}
{\footnotesize\ttfamily std\+::vector$<$std\+::pair$<$double, \mbox{\hyperlink{class_t_fx_pair}{TFx\+Pair}}$>$ $>$ Movie\+Renderer\+::\+Imp\+::m\+\_\+frames\+To\+Be\+Rendered}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a1a2802e5d7eb81c7394398dd559d9c9d}\label{class_movie_renderer_1_1_imp_a1a2802e5d7eb81c7394398dd559d9c9d}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_levelUpdaterA@{m\_levelUpdaterA}}
\index{m\_levelUpdaterA@{m\_levelUpdaterA}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_levelUpdaterA}{m\_levelUpdaterA}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$\mbox{\hyperlink{class_level_updater}{Level\+Updater}}$>$ Movie\+Renderer\+::\+Imp\+::m\+\_\+level\+UpdaterA}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a89dfee571e072493b72bd1be241c0cc1}\label{class_movie_renderer_1_1_imp_a89dfee571e072493b72bd1be241c0cc1}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_levelUpdaterB@{m\_levelUpdaterB}}
\index{m\_levelUpdaterB@{m\_levelUpdaterB}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_levelUpdaterB}{m\_levelUpdaterB}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$\mbox{\hyperlink{class_level_updater}{Level\+Updater}}$>$ Movie\+Renderer\+::\+Imp\+::m\+\_\+level\+UpdaterB}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_ab9079d5ed2b5ad349bb11743db452727}\label{class_movie_renderer_1_1_imp_ab9079d5ed2b5ad349bb11743db452727}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_listeners@{m\_listeners}}
\index{m\_listeners@{m\_listeners}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_listeners}{m\_listeners}}
{\footnotesize\ttfamily std\+::set$<$\mbox{\hyperlink{class_movie_renderer_1_1_listener}{Movie\+Renderer\+::\+Listener}} $\ast$$>$ Movie\+Renderer\+::\+Imp\+::m\+\_\+listeners}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a7ee70acc75857485e90fccbb51c58167}\label{class_movie_renderer_1_1_imp_a7ee70acc75857485e90fccbb51c58167}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_movieType@{m\_movieType}}
\index{m\_movieType@{m\_movieType}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_movieType}{m\_movieType}}
{\footnotesize\ttfamily bool Movie\+Renderer\+::\+Imp\+::m\+\_\+movie\+Type}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a571337aaf898a7af21a05ea407210c59}\label{class_movie_renderer_1_1_imp_a571337aaf898a7af21a05ea407210c59}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_mutex@{m\_mutex}}
\index{m\_mutex@{m\_mutex}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_mutex}{m\_mutex}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_thread_1_1_mutex}{TThread\+::\+Mutex}} Movie\+Renderer\+::\+Imp\+::m\+\_\+mutex}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a853a853ac4affa3836f227f3c5ac622d}\label{class_movie_renderer_1_1_imp_a853a853ac4affa3836f227f3c5ac622d}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_nextFrameIdxToSave@{m\_nextFrameIdxToSave}}
\index{m\_nextFrameIdxToSave@{m\_nextFrameIdxToSave}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_nextFrameIdxToSave}{m\_nextFrameIdxToSave}}
{\footnotesize\ttfamily int Movie\+Renderer\+::\+Imp\+::m\+\_\+next\+Frame\+Idx\+To\+Save}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_ab465ef58ed529077ff1809ba522bc5cd}\label{class_movie_renderer_1_1_imp_ab465ef58ed529077ff1809ba522bc5cd}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_preview@{m\_preview}}
\index{m\_preview@{m\_preview}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_preview}{m\_preview}}
{\footnotesize\ttfamily bool Movie\+Renderer\+::\+Imp\+::m\+\_\+preview}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a9fdfc7abd5ade9cac413039b93b895e5}\label{class_movie_renderer_1_1_imp_a9fdfc7abd5ade9cac413039b93b895e5}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_renderCacheId@{m\_renderCacheId}}
\index{m\_renderCacheId@{m\_renderCacheId}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_renderCacheId}{m\_renderCacheId}}
{\footnotesize\ttfamily std\+::string Movie\+Renderer\+::\+Imp\+::m\+\_\+render\+Cache\+Id}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_abeb6da0281ec2d81441b62f66b467b13}\label{class_movie_renderer_1_1_imp_abeb6da0281ec2d81441b62f66b467b13}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_renderer@{m\_renderer}}
\index{m\_renderer@{m\_renderer}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_renderer}{m\_renderer}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_renderer}{TRenderer}} Movie\+Renderer\+::\+Imp\+::m\+\_\+renderer}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a441e9bbf1ea016c97225a63e057b41db}\label{class_movie_renderer_1_1_imp_a441e9bbf1ea016c97225a63e057b41db}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_renderSessionId@{m\_renderSessionId}}
\index{m\_renderSessionId@{m\_renderSessionId}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_renderSessionId}{m\_renderSessionId}}
{\footnotesize\ttfamily int Movie\+Renderer\+::\+Imp\+::m\+\_\+render\+Session\+Id}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a0536b5566f2b72c9468ec4ca1506c72d}\label{class_movie_renderer_1_1_imp_a0536b5566f2b72c9468ec4ca1506c72d}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_renderSettings@{m\_renderSettings}}
\index{m\_renderSettings@{m\_renderSettings}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_renderSettings}{m\_renderSettings}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} Movie\+Renderer\+::\+Imp\+::m\+\_\+render\+Settings}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a188b1407131c2c18c37408eff409264c}\label{class_movie_renderer_1_1_imp_a188b1407131c2c18c37408eff409264c}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_savingThreadsCount@{m\_savingThreadsCount}}
\index{m\_savingThreadsCount@{m\_savingThreadsCount}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_savingThreadsCount}{m\_savingThreadsCount}}
{\footnotesize\ttfamily int Movie\+Renderer\+::\+Imp\+::m\+\_\+saving\+Threads\+Count}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_ac7ec3cd931c140e7ceedf1142aa29e6b}\label{class_movie_renderer_1_1_imp_ac7ec3cd931c140e7ceedf1142aa29e6b}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_scene@{m\_scene}}
\index{m\_scene@{m\_scene}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_scene}{m\_scene}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_toonz_scene}{Toonz\+Scene}}$\ast$ Movie\+Renderer\+::\+Imp\+::m\+\_\+scene}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a7c2e6205764a8498edecc08e2ae2de49}\label{class_movie_renderer_1_1_imp_a7c2e6205764a8498edecc08e2ae2de49}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_seqRequired@{m\_seqRequired}}
\index{m\_seqRequired@{m\_seqRequired}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_seqRequired}{m\_seqRequired}}
{\footnotesize\ttfamily bool Movie\+Renderer\+::\+Imp\+::m\+\_\+seq\+Required}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a76586f81a2a28a1b9306409735c2b5f8}\label{class_movie_renderer_1_1_imp_a76586f81a2a28a1b9306409735c2b5f8}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_st@{m\_st}}
\index{m\_st@{m\_st}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_st}{m\_st}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_smart_pointer_t}{TSound\+TrackP}} Movie\+Renderer\+::\+Imp\+::m\+\_\+st}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a4ae3fa172a0bf50dd78dbc3d5d20531d}\label{class_movie_renderer_1_1_imp_a4ae3fa172a0bf50dd78dbc3d5d20531d}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_toBeAppliedGamma@{m\_toBeAppliedGamma}}
\index{m\_toBeAppliedGamma@{m\_toBeAppliedGamma}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_toBeAppliedGamma}{m\_toBeAppliedGamma}}
{\footnotesize\ttfamily std\+::map$<$double, bool$>$ Movie\+Renderer\+::\+Imp\+::m\+\_\+to\+Be\+Applied\+Gamma}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a3db4041204f7e275e50fc89ff49213c1}\label{class_movie_renderer_1_1_imp_a3db4041204f7e275e50fc89ff49213c1}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_toBeSaved@{m\_toBeSaved}}
\index{m\_toBeSaved@{m\_toBeSaved}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_toBeSaved}{m\_toBeSaved}}
{\footnotesize\ttfamily std\+::map$<$double, std\+::pair$<$\mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}, \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}$>$ $>$ Movie\+Renderer\+::\+Imp\+::m\+\_\+to\+Be\+Saved}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a2dd2b440bfc1ce0a2029a97efc323ee5}\label{class_movie_renderer_1_1_imp_a2dd2b440bfc1ce0a2029a97efc323ee5}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_waitAfterFinish@{m\_waitAfterFinish}}
\index{m\_waitAfterFinish@{m\_waitAfterFinish}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_waitAfterFinish}{m\_waitAfterFinish}}
{\footnotesize\ttfamily bool Movie\+Renderer\+::\+Imp\+::m\+\_\+wait\+After\+Finish}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_adfb2b4648b4ffd0eea969b3622a40a5a}\label{class_movie_renderer_1_1_imp_adfb2b4648b4ffd0eea969b3622a40a5a}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_whiteSample@{m\_whiteSample}}
\index{m\_whiteSample@{m\_whiteSample}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_whiteSample}{m\_whiteSample}}
{\footnotesize\ttfamily long Movie\+Renderer\+::\+Imp\+::m\+\_\+white\+Sample}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a00e9b4470c91a35ab71d1ace3884a56c}\label{class_movie_renderer_1_1_imp_a00e9b4470c91a35ab71d1ace3884a56c}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_xDpi@{m\_xDpi}}
\index{m\_xDpi@{m\_xDpi}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_xDpi}{m\_xDpi}}
{\footnotesize\ttfamily double Movie\+Renderer\+::\+Imp\+::m\+\_\+x\+Dpi}

\mbox{\Hypertarget{class_movie_renderer_1_1_imp_a30ce52bca58298617dc84f5c54eb5e30}\label{class_movie_renderer_1_1_imp_a30ce52bca58298617dc84f5c54eb5e30}} 
\index{MovieRenderer::Imp@{MovieRenderer::Imp}!m\_yDpi@{m\_yDpi}}
\index{m\_yDpi@{m\_yDpi}!MovieRenderer::Imp@{MovieRenderer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_yDpi}{m\_yDpi}}
{\footnotesize\ttfamily double Movie\+Renderer\+::\+Imp\+::m\+\_\+y\+Dpi}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonzlib/movierenderer.\+cpp\end{DoxyCompactItemize}
