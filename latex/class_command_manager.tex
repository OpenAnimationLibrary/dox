\hypertarget{class_command_manager}{}\doxysection{Command\+Manager Class Reference}
\label{class_command_manager}\index{CommandManager@{CommandManager}}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_command_manager_a4a2ae1f11156e7a08a80fb650ce820c2}{set\+Handler}} (Command\+Id id, \mbox{\hyperlink{class_command_handler_interface}{Command\+Handler\+Interface}} $\ast$handler)
\item 
void \mbox{\hyperlink{class_command_manager_a85016ad7dec0486fbc63ba7c4355a860}{define}} (Command\+Id id, Command\+Type type, std\+::string default\+Shortcut\+String, QAction $\ast$action)
\item 
\mbox{\Hypertarget{class_command_manager_ad6e91216bc09c7f41fd778829b097254}\label{class_command_manager_ad6e91216bc09c7f41fd778829b097254}} 
QAction $\ast$ {\bfseries create\+Action} (const char $\ast$id, const char $\ast$name, const char $\ast$default\+Shortcut)
\item 
void \mbox{\hyperlink{class_command_manager_a4fb493bb843b24b0d605cedb37a779ee}{get\+Actions}} (Command\+Type type, std\+::vector$<$ QAction $\ast$ $>$ \&actions)
\item 
QAction $\ast$ \mbox{\hyperlink{class_command_manager_a2b6062e0f4d3d2140cfa4bfe7521e1ac}{get\+Action\+From\+Shortcut}} (std\+::string shortcut\+String)
\item 
std\+::string \mbox{\hyperlink{class_command_manager_a4b8578bd4fb8804c505d2c2fed37516e}{get\+Shortcut\+From\+Action}} (QAction $\ast$action)
\item 
std\+::string \mbox{\hyperlink{class_command_manager_a339ad1846f95a617a8ed8ef721493085}{get\+Shortcut\+From\+Id}} (Command\+Id id)
\item 
int \mbox{\hyperlink{class_command_manager_ac1a1635efb374ca97133a1f5a112511d}{get\+Key\+From\+Shortcut}} (const std\+::string \&shortcut)
\item 
int \mbox{\hyperlink{class_command_manager_a8a536fb476ff2410bf6cdb32ae8a89ff}{get\+Key\+From\+Id}} (Command\+Id id)
\item 
void \mbox{\hyperlink{class_command_manager_a9c213ecad51eee3d5adbe37ff11ac43f}{set\+Shortcut}} (QAction $\ast$action, std\+::string shortcut\+String, bool keep\+Default=true)
\item 
QAction $\ast$ \mbox{\hyperlink{class_command_manager_a98f36600425b456ea5778c17e8438723}{get\+Action}} (Command\+Id id, bool create\+If\+Needed=false)
\item 
QAction $\ast$ \mbox{\hyperlink{class_command_manager_af3fbfb96266df4f8adac5f7fc48fbf42}{create\+Action}} (Command\+Id id, QObject $\ast$parent=0, bool state=true)
\item 
void \mbox{\hyperlink{class_command_manager_a05623722d922a9737a3c45d9b83b3a28}{execute}} (QAction $\ast$action)
\item 
void \mbox{\hyperlink{class_command_manager_adbab3663bb4d06c3e2a6afce0b2e8d5a}{execute}} (QAction $\ast$action, QAction $\ast$menu\+Action)
\item 
void \mbox{\hyperlink{class_command_manager_a4c40304eefae852e9240c59a2d737232}{execute}} (Command\+Id id)
\item 
void \mbox{\hyperlink{class_command_manager_a69ffd85616fb353ecc7523637189db82}{enable}} (Command\+Id id, bool enabled)
\item 
void \mbox{\hyperlink{class_command_manager_a58e99980dec1146ad76e0f714dd589e0}{set\+Checked}} (Command\+Id id, bool checked)
\item 
void \mbox{\hyperlink{class_command_manager_a6b02a1412f15de13b4655d3de0d4e2fb}{set\+Toggle\+Texts}} (Command\+Id id, const QString \&on\+Text, const QString \&off\+Text)
\item 
std\+::string \mbox{\hyperlink{class_command_manager_a7b973ed17cec2ead5e80c39e858c4d38}{get\+Id\+From\+Action}} (QAction $\ast$action)
\item 
void \mbox{\hyperlink{class_command_manager_ae01b04cfd5987b3caead664fa8303611}{load\+Shortcuts}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{class_command_manager}{Command\+Manager}} $\ast$ \mbox{\hyperlink{class_command_manager_ab5a1c6a00f4260d316dea51b99b6b785}{instance}} ()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_command_manager_ae6a6acf03e200dfc65a7a26fbbfd207d}\label{class_command_manager_ae6a6acf03e200dfc65a7a26fbbfd207d}} 
\index{CommandManager@{CommandManager}!````~CommandManager@{$\sim$CommandManager}}
\index{````~CommandManager@{$\sim$CommandManager}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{$\sim$CommandManager()}{~CommandManager()}}
{\footnotesize\ttfamily Command\+Manager\+::$\sim$\+Command\+Manager (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00066                                 \{}
\DoxyCodeLine{00067   std::map<std::string, Node *>::iterator it;}
\DoxyCodeLine{00068   \textcolor{keywordflow}{for} (it = m\_idTable.begin(); it != m\_idTable.end(); ++it) \textcolor{keyword}{delete} it-\/>second;}
\DoxyCodeLine{00069 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_command_manager_af3fbfb96266df4f8adac5f7fc48fbf42}\label{class_command_manager_af3fbfb96266df4f8adac5f7fc48fbf42}} 
\index{CommandManager@{CommandManager}!createAction@{createAction}}
\index{createAction@{createAction}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{createAction()}{createAction()}}
{\footnotesize\ttfamily QAction $\ast$ Command\+Manager\+::create\+Action (\begin{DoxyParamCaption}\item[{Command\+Id}]{id,  }\item[{QObject $\ast$}]{parent = {\ttfamily 0},  }\item[{bool}]{state = {\ttfamily true} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00354                                                   \{}
\DoxyCodeLine{00355   \mbox{\hyperlink{class_node}{Node}} *node = getNode(\textcolor{keywordtype}{id}, \textcolor{keyword}{false});}
\DoxyCodeLine{00356   \textcolor{keywordflow}{if} (!node) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00357   QAction *refAction = node-\/>m\_qaction;}
\DoxyCodeLine{00358   \textcolor{keywordflow}{if} (!refAction) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00359   QString text = refAction-\/>text();}
\DoxyCodeLine{00360   \textcolor{keywordflow}{if} (node-\/>m\_onText != \textcolor{stringliteral}{"{}"{}} \&\& node-\/>m\_offText != \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00361     text = state ? node-\/>m\_onText : node-\/>m\_offText;}
\DoxyCodeLine{00362   QAction *action = \textcolor{keyword}{new} QAction(text, parent);}
\DoxyCodeLine{00363   action-\/>setShortcut(refAction-\/>shortcut());}
\DoxyCodeLine{00364   \textcolor{keywordflow}{return} action;}
\DoxyCodeLine{00365 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a85016ad7dec0486fbc63ba7c4355a860}\label{class_command_manager_a85016ad7dec0486fbc63ba7c4355a860}} 
\index{CommandManager@{CommandManager}!define@{define}}
\index{define@{define}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{define()}{define()}}
{\footnotesize\ttfamily void Command\+Manager\+::define (\begin{DoxyParamCaption}\item[{Command\+Id}]{id,  }\item[{Command\+Type}]{type,  }\item[{std\+::string}]{default\+Shortcut\+String,  }\item[{QAction $\ast$}]{action }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00115                                               \{}
\DoxyCodeLine{00116   assert(type != UndefinedCommandType);}
\DoxyCodeLine{00117   assert(qaction != 0);}
\DoxyCodeLine{00118   assert(m\_qactionTable.count(qaction) == 0);}
\DoxyCodeLine{00119 }
\DoxyCodeLine{00120   \mbox{\hyperlink{class_node}{Node}} *node = getNode(\textcolor{keywordtype}{id});}
\DoxyCodeLine{00121   \textcolor{keywordflow}{if} (node-\/>m\_type != UndefinedCommandType) \{}
\DoxyCodeLine{00122     assert(!\textcolor{stringliteral}{"{}Duplicate command id"{}});}
\DoxyCodeLine{00123   \}}
\DoxyCodeLine{00124   node-\/>m\_type    = type;}
\DoxyCodeLine{00125   node-\/>m\_qaction = qaction;}
\DoxyCodeLine{00126   node-\/>m\_qaction-\/>setEnabled(}
\DoxyCodeLine{00127       (node-\/>m\_enabled \&\&}
\DoxyCodeLine{00128        (node-\/>m\_handler || node-\/>m\_qaction-\/>actionGroup() != 0)) ||}
\DoxyCodeLine{00129       node-\/>m\_type == MiscCommandType ||}
\DoxyCodeLine{00130       node-\/>m\_type == ToolModifierCommandType ||}
\DoxyCodeLine{00131       node-\/>m\_type == CellMarkCommandType);}
\DoxyCodeLine{00132 }
\DoxyCodeLine{00133   m\_qactionTable[qaction] = node;}
\DoxyCodeLine{00134   qaction-\/>setShortcutContext(Qt::ApplicationShortcut);}
\DoxyCodeLine{00135   \textcolor{comment}{// user defined shortcuts will be loaded afterwards in loadShortcuts()}}
\DoxyCodeLine{00136   QString defaultShortcutQString =}
\DoxyCodeLine{00137       QString::fromStdString(defaultShortcutString);}
\DoxyCodeLine{00138   \textcolor{keywordflow}{if} (!defaultShortcutQString.isEmpty()) \{}
\DoxyCodeLine{00139     qaction-\/>setShortcut(QKeySequence(defaultShortcutQString));}
\DoxyCodeLine{00140     m\_shortcutTable[defaultShortcutString] = node;}
\DoxyCodeLine{00141   \}}
\DoxyCodeLine{00142 }
\DoxyCodeLine{00143   \textcolor{keywordflow}{if} (type == ToolCommandType) updateToolTip(qaction);}
\DoxyCodeLine{00144 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a69ffd85616fb353ecc7523637189db82}\label{class_command_manager_a69ffd85616fb353ecc7523637189db82}} 
\index{CommandManager@{CommandManager}!enable@{enable}}
\index{enable@{enable}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{enable()}{enable()}}
{\footnotesize\ttfamily void Command\+Manager\+::enable (\begin{DoxyParamCaption}\item[{Command\+Id}]{id,  }\item[{bool}]{enabled }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00318                                                       \{}
\DoxyCodeLine{00319   \mbox{\hyperlink{class_node}{Node}} *node = getNode(\textcolor{keywordtype}{id}, \textcolor{keyword}{false});}
\DoxyCodeLine{00320   \textcolor{keywordflow}{if} (!node) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00321   \textcolor{keywordflow}{if} (node-\/>m\_enabled == enabled) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00322   node-\/>m\_enabled = enabled;}
\DoxyCodeLine{00323   \textcolor{keywordflow}{if} (node-\/>m\_qaction)}
\DoxyCodeLine{00324     node-\/>m\_qaction-\/>setEnabled(}
\DoxyCodeLine{00325         node-\/>m\_enabled \&\&}
\DoxyCodeLine{00326         (!!node-\/>m\_handler || node-\/>m\_qaction-\/>actionGroup() != 0));}
\DoxyCodeLine{00327 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a4c40304eefae852e9240c59a2d737232}\label{class_command_manager_a4c40304eefae852e9240c59a2d737232}} 
\index{CommandManager@{CommandManager}!execute@{execute}}
\index{execute@{execute}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{execute()}{execute()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void Command\+Manager\+::execute (\begin{DoxyParamCaption}\item[{Command\+Id}]{id }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00192                                          \{}
\DoxyCodeLine{00193   \mbox{\hyperlink{class_node}{Node}} *node = getNode(\textcolor{keywordtype}{id}, \textcolor{keyword}{false});}
\DoxyCodeLine{00194   \textcolor{keywordflow}{if} (node \&\& node-\/>m\_handler) \{}
\DoxyCodeLine{00195     QAction *action = node-\/>m\_qaction;}
\DoxyCodeLine{00196     \textcolor{keywordflow}{if} (action \&\& action-\/>isCheckable()) \{}
\DoxyCodeLine{00197       \textcolor{comment}{// principalmente per i tool}}
\DoxyCodeLine{00198       action-\/>setChecked(\textcolor{keyword}{true});}
\DoxyCodeLine{00199     \}}
\DoxyCodeLine{00200     node-\/>m\_handler-\/>execute();}
\DoxyCodeLine{00201   \}}
\DoxyCodeLine{00202 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a05623722d922a9737a3c45d9b83b3a28}\label{class_command_manager_a05623722d922a9737a3c45d9b83b3a28}} 
\index{CommandManager@{CommandManager}!execute@{execute}}
\index{execute@{execute}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{execute()}{execute()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void Command\+Manager\+::execute (\begin{DoxyParamCaption}\item[{QAction $\ast$}]{action }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00171                                              \{}
\DoxyCodeLine{00172   assert(qaction);}
\DoxyCodeLine{00173   std::map<QAction *, Node *>::iterator it = m\_qactionTable.find(qaction);}
\DoxyCodeLine{00174   assert(it != m\_qactionTable.end());}
\DoxyCodeLine{00175   \textcolor{keywordflow}{if} (it != m\_qactionTable.end() \&\& it-\/>second-\/>m\_handler) \{}
\DoxyCodeLine{00176     it-\/>second-\/>m\_handler-\/>execute();}
\DoxyCodeLine{00177   \}}
\DoxyCodeLine{00178 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_adbab3663bb4d06c3e2a6afce0b2e8d5a}\label{class_command_manager_adbab3663bb4d06c3e2a6afce0b2e8d5a}} 
\index{CommandManager@{CommandManager}!execute@{execute}}
\index{execute@{execute}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{execute()}{execute()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void Command\+Manager\+::execute (\begin{DoxyParamCaption}\item[{QAction $\ast$}]{action,  }\item[{QAction $\ast$}]{menu\+Action }\end{DoxyParamCaption})}

If action is defined in m\+\_\+qaction\+Table recall {\bfseries{execute(action)}}, otherwise recall execute(menu\+Action). 
\begin{DoxyCode}{0}
\DoxyCodeLine{00182                                                                  \{}
\DoxyCodeLine{00183   std::map<QAction *, Node *>::iterator it = m\_qactionTable.find(action);}
\DoxyCodeLine{00184   \textcolor{keywordflow}{if} (it != m\_qactionTable.end())}
\DoxyCodeLine{00185     execute(action);}
\DoxyCodeLine{00186   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00187     execute(menuAction);}
\DoxyCodeLine{00188 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a98f36600425b456ea5778c17e8438723}\label{class_command_manager_a98f36600425b456ea5778c17e8438723}} 
\index{CommandManager@{CommandManager}!getAction@{getAction}}
\index{getAction@{getAction}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{getAction()}{getAction()}}
{\footnotesize\ttfamily QAction $\ast$ Command\+Manager\+::get\+Action (\begin{DoxyParamCaption}\item[{Command\+Id}]{id,  }\item[{bool}]{create\+If\+Needed = {\ttfamily false} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00342                                                                     \{}
\DoxyCodeLine{00343   \mbox{\hyperlink{class_node}{Node}} *node = getNode(\textcolor{keywordtype}{id}, createIfNeeded);}
\DoxyCodeLine{00344   \textcolor{keywordflow}{if} (node) \{}
\DoxyCodeLine{00345     \textcolor{keywordflow}{return} node-\/>m\_qaction;}
\DoxyCodeLine{00346   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00347     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00348   \}}
\DoxyCodeLine{00349 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a2b6062e0f4d3d2140cfa4bfe7521e1ac}\label{class_command_manager_a2b6062e0f4d3d2140cfa4bfe7521e1ac}} 
\index{CommandManager@{CommandManager}!getActionFromShortcut@{getActionFromShortcut}}
\index{getActionFromShortcut@{getActionFromShortcut}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{getActionFromShortcut()}{getActionFromShortcut()}}
{\footnotesize\ttfamily QAction $\ast$ Command\+Manager\+::get\+Action\+From\+Shortcut (\begin{DoxyParamCaption}\item[{std\+::string}]{shortcut\+String }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00216                                                                        \{}
\DoxyCodeLine{00217   std::map<std::string, Node *>::iterator it =}
\DoxyCodeLine{00218       m\_shortcutTable.find(shortcutString);}
\DoxyCodeLine{00219   \textcolor{keywordflow}{return} it != m\_shortcutTable.end() ? it-\/>second-\/>m\_qaction : 0;}
\DoxyCodeLine{00220 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a4fb493bb843b24b0d605cedb37a779ee}\label{class_command_manager_a4fb493bb843b24b0d605cedb37a779ee}} 
\index{CommandManager@{CommandManager}!getActions@{getActions}}
\index{getActions@{getActions}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{getActions()}{getActions()}}
{\footnotesize\ttfamily void Command\+Manager\+::get\+Actions (\begin{DoxyParamCaption}\item[{Command\+Type}]{type,  }\item[{std\+::vector$<$ QAction $\ast$ $>$ \&}]{actions }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00207                                                                \{}
\DoxyCodeLine{00208   AuxActionsCreatorManager::instance()-\/>createAuxActions(qApp);}
\DoxyCodeLine{00209   std::map<QAction *, Node *>::iterator it;}
\DoxyCodeLine{00210   \textcolor{keywordflow}{for} (it = m\_qactionTable.begin(); it != m\_qactionTable.end(); ++it)}
\DoxyCodeLine{00211     \textcolor{keywordflow}{if} (it-\/>second-\/>m\_type == type) actions.push\_back(it-\/>first);}
\DoxyCodeLine{00212 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a7b973ed17cec2ead5e80c39e858c4d38}\label{class_command_manager_a7b973ed17cec2ead5e80c39e858c4d38}} 
\index{CommandManager@{CommandManager}!getIdFromAction@{getIdFromAction}}
\index{getIdFromAction@{getIdFromAction}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{getIdFromAction()}{getIdFromAction()}}
{\footnotesize\ttfamily std\+::string Command\+Manager\+::get\+Id\+From\+Action (\begin{DoxyParamCaption}\item[{QAction $\ast$}]{action }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00380                                                          \{}
\DoxyCodeLine{00381   std::map<QAction *, Node *>::iterator it = m\_qactionTable.find(action);}
\DoxyCodeLine{00382   \textcolor{keywordflow}{if} (it != m\_qactionTable.end())}
\DoxyCodeLine{00383     \textcolor{keywordflow}{return} it-\/>second-\/>m\_id;}
\DoxyCodeLine{00384   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00385     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00386 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a8a536fb476ff2410bf6cdb32ae8a89ff}\label{class_command_manager_a8a536fb476ff2410bf6cdb32ae8a89ff}} 
\index{CommandManager@{CommandManager}!getKeyFromId@{getKeyFromId}}
\index{getKeyFromId@{getKeyFromId}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{getKeyFromId()}{getKeyFromId()}}
{\footnotesize\ttfamily int Command\+Manager\+::get\+Key\+From\+Id (\begin{DoxyParamCaption}\item[{Command\+Id}]{id }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00254                                                \{}
\DoxyCodeLine{00255   \textcolor{keywordflow}{return} getKeyFromShortcut(getShortcutFromId(\textcolor{keywordtype}{id}));}
\DoxyCodeLine{00256 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_ac1a1635efb374ca97133a1f5a112511d}\label{class_command_manager_ac1a1635efb374ca97133a1f5a112511d}} 
\index{CommandManager@{CommandManager}!getKeyFromShortcut@{getKeyFromShortcut}}
\index{getKeyFromShortcut@{getKeyFromShortcut}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{getKeyFromShortcut()}{getKeyFromShortcut()}}
{\footnotesize\ttfamily int Command\+Manager\+::get\+Key\+From\+Shortcut (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{shortcut }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00243                                                                 \{}
\DoxyCodeLine{00244   QString qShortcut = QString::fromStdString(shortcut);}
\DoxyCodeLine{00245   \textcolor{keywordflow}{if} (qShortcut == \textcolor{stringliteral}{"{}"{}}) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00246 }
\DoxyCodeLine{00247   QKeySequence ks(qShortcut);}
\DoxyCodeLine{00248   assert(ks.count() == 1);}
\DoxyCodeLine{00249   \textcolor{keywordflow}{return} ks[0];}
\DoxyCodeLine{00250 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a4b8578bd4fb8804c505d2c2fed37516e}\label{class_command_manager_a4b8578bd4fb8804c505d2c2fed37516e}} 
\index{CommandManager@{CommandManager}!getShortcutFromAction@{getShortcutFromAction}}
\index{getShortcutFromAction@{getShortcutFromAction}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{getShortcutFromAction()}{getShortcutFromAction()}}
{\footnotesize\ttfamily std\+::string Command\+Manager\+::get\+Shortcut\+From\+Action (\begin{DoxyParamCaption}\item[{QAction $\ast$}]{action }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00224                                                                \{}
\DoxyCodeLine{00225   std::map<std::string, Node *>::iterator it = m\_shortcutTable.begin();}
\DoxyCodeLine{00226   \textcolor{keywordflow}{for} (; it != m\_shortcutTable.end(); ++it) \{}
\DoxyCodeLine{00227     \textcolor{keywordflow}{if} (it-\/>second-\/>m\_qaction == action) \textcolor{keywordflow}{return} it-\/>first;}
\DoxyCodeLine{00228   \}}
\DoxyCodeLine{00229   \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00230 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a339ad1846f95a617a8ed8ef721493085}\label{class_command_manager_a339ad1846f95a617a8ed8ef721493085}} 
\index{CommandManager@{CommandManager}!getShortcutFromId@{getShortcutFromId}}
\index{getShortcutFromId@{getShortcutFromId}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{getShortcutFromId()}{getShortcutFromId()}}
{\footnotesize\ttfamily std\+::string Command\+Manager\+::get\+Shortcut\+From\+Id (\begin{DoxyParamCaption}\item[{Command\+Id}]{id }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00234                                                           \{}
\DoxyCodeLine{00235   QAction *action = getAction(\textcolor{keywordtype}{id});}
\DoxyCodeLine{00236   assert(action);}
\DoxyCodeLine{00237   \textcolor{keywordflow}{if} (!action) \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00238   \textcolor{keywordflow}{return} getShortcutFromAction(action);}
\DoxyCodeLine{00239 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_ab5a1c6a00f4260d316dea51b99b6b785}\label{class_command_manager_ab5a1c6a00f4260d316dea51b99b6b785}} 
\index{CommandManager@{CommandManager}!instance@{instance}}
\index{instance@{instance}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{instance()}{instance()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_command_manager}{Command\+Manager}} $\ast$ Command\+Manager\+::instance (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00073                                          \{}
\DoxyCodeLine{00074   \textcolor{keyword}{static} \mbox{\hyperlink{class_command_manager}{CommandManager}} \_instance;}
\DoxyCodeLine{00075   \textcolor{keywordflow}{return} \&\_instance;}
\DoxyCodeLine{00076 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_ae01b04cfd5987b3caead664fa8303611}\label{class_command_manager_ae01b04cfd5987b3caead664fa8303611}} 
\index{CommandManager@{CommandManager}!loadShortcuts@{loadShortcuts}}
\index{loadShortcuts@{loadShortcuts}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{loadShortcuts()}{loadShortcuts()}}
{\footnotesize\ttfamily void Command\+Manager\+::load\+Shortcuts (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00391                                    \{}
\DoxyCodeLine{00392   \mbox{\hyperlink{class_t_file_path}{TFilePath}} fp = ToonzFolder::getMyModuleDir() + \mbox{\hyperlink{class_t_file_path}{TFilePath}}(\textcolor{stringliteral}{"{}shortcuts.ini"{}});}
\DoxyCodeLine{00393   \textcolor{keywordflow}{if} (!\mbox{\hyperlink{class_t_file_status}{TFileStatus}}(fp).doesExist()) \{}
\DoxyCodeLine{00394     \textcolor{comment}{// if user shortcut file does not exist, then try to load from template}}
\DoxyCodeLine{00395     \mbox{\hyperlink{class_t_file_path}{TFilePath}} tmplFp =}
\DoxyCodeLine{00396         ToonzFolder::getTemplateModuleDir() + \mbox{\hyperlink{class_t_file_path}{TFilePath}}(\textcolor{stringliteral}{"{}shortcuts.ini"{}});}
\DoxyCodeLine{00397     \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_file_status}{TFileStatus}}(tmplFp).doesExist()) TSystem::copyFile(fp, tmplFp);}
\DoxyCodeLine{00398     \textcolor{comment}{// if neither settings exist, do nothing and return}}
\DoxyCodeLine{00399     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00400       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00401   \}}
\DoxyCodeLine{00402 }
\DoxyCodeLine{00403   QSettings settings(toQString(fp), QSettings::IniFormat);}
\DoxyCodeLine{00404   settings.beginGroup(\textcolor{stringliteral}{"{}shortcuts"{}});}
\DoxyCodeLine{00405   QStringList ids = settings.allKeys();}
\DoxyCodeLine{00406   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < ids.size(); i++) \{}
\DoxyCodeLine{00407     std::string \textcolor{keywordtype}{id}   = ids.at(i).toStdString();}
\DoxyCodeLine{00408     QString shortcut = settings.value(ids.at(i), \textcolor{stringliteral}{"{}"{}}).toString();}
\DoxyCodeLine{00409     QAction *action  = getAction(\&\textcolor{keywordtype}{id}[0], \textcolor{keyword}{false});}
\DoxyCodeLine{00410     \textcolor{keywordflow}{if} (action) \{}
\DoxyCodeLine{00411       QString oldShortcut = action-\/>shortcut().toString();}
\DoxyCodeLine{00412       \textcolor{keywordflow}{if} (oldShortcut == shortcut) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00413       \textcolor{keywordflow}{if} (!oldShortcut.isEmpty())}
\DoxyCodeLine{00414         m\_shortcutTable.erase(oldShortcut.toStdString());}
\DoxyCodeLine{00415       \textcolor{keywordflow}{if} (!shortcut.isEmpty()) \{}
\DoxyCodeLine{00416         QAction *other = getActionFromShortcut(shortcut.toStdString());}
\DoxyCodeLine{00417         \textcolor{keywordflow}{if} (other) other-\/>setShortcut(QKeySequence());}
\DoxyCodeLine{00418         m\_shortcutTable[shortcut.toStdString()] = getNode(\&\textcolor{keywordtype}{id}[0]);}
\DoxyCodeLine{00419       \}}
\DoxyCodeLine{00420       action-\/>setShortcut(QKeySequence(shortcut));}
\DoxyCodeLine{00421     \}}
\DoxyCodeLine{00422   \}}
\DoxyCodeLine{00423   settings.endGroup();}
\DoxyCodeLine{00424 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a58e99980dec1146ad76e0f714dd589e0}\label{class_command_manager_a58e99980dec1146ad76e0f714dd589e0}} 
\index{CommandManager@{CommandManager}!setChecked@{setChecked}}
\index{setChecked@{setChecked}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{setChecked()}{setChecked()}}
{\footnotesize\ttfamily void Command\+Manager\+::set\+Checked (\begin{DoxyParamCaption}\item[{Command\+Id}]{id,  }\item[{bool}]{checked }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00331                                                           \{}
\DoxyCodeLine{00332   \mbox{\hyperlink{class_node}{Node}} *node = getNode(\textcolor{keywordtype}{id}, \textcolor{keyword}{false});}
\DoxyCodeLine{00333   \textcolor{keywordflow}{if} (!node) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00334   \textcolor{keywordflow}{if} (node-\/>m\_qaction) \{}
\DoxyCodeLine{00335     node-\/>m\_qaction-\/>setChecked(checked);}
\DoxyCodeLine{00336     \textcolor{keywordflow}{if} (node-\/>m\_handler) node-\/>m\_handler-\/>execute();}
\DoxyCodeLine{00337   \}}
\DoxyCodeLine{00338 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a4a2ae1f11156e7a08a80fb650ce820c2}\label{class_command_manager_a4a2ae1f11156e7a08a80fb650ce820c2}} 
\index{CommandManager@{CommandManager}!setHandler@{setHandler}}
\index{setHandler@{setHandler}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{setHandler()}{setHandler()}}
{\footnotesize\ttfamily void Command\+Manager\+::set\+Handler (\begin{DoxyParamCaption}\item[{Command\+Id}]{id,  }\item[{\mbox{\hyperlink{class_command_handler_interface}{Command\+Handler\+Interface}} $\ast$}]{handler }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00153                                                                   \{}
\DoxyCodeLine{00154   \mbox{\hyperlink{class_node}{Node}} *node = getNode(\textcolor{keywordtype}{id});}
\DoxyCodeLine{00155   \textcolor{keywordflow}{if} (node-\/>m\_handler != handler) \{}
\DoxyCodeLine{00156     \textcolor{keyword}{delete} node-\/>m\_handler;}
\DoxyCodeLine{00157     node-\/>m\_handler = handler;}
\DoxyCodeLine{00158   \}}
\DoxyCodeLine{00159   \textcolor{keywordflow}{if} (node-\/>m\_qaction) \{}
\DoxyCodeLine{00160     node-\/>m\_qaction-\/>setEnabled(}
\DoxyCodeLine{00161         node-\/>m\_enabled \&\&}
\DoxyCodeLine{00162         (!!node-\/>m\_handler || node-\/>m\_qaction-\/>actionGroup() != 0));}
\DoxyCodeLine{00163   \}}
\DoxyCodeLine{00164 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a9c213ecad51eee3d5adbe37ff11ac43f}\label{class_command_manager_a9c213ecad51eee3d5adbe37ff11ac43f}} 
\index{CommandManager@{CommandManager}!setShortcut@{setShortcut}}
\index{setShortcut@{setShortcut}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{setShortcut()}{setShortcut()}}
{\footnotesize\ttfamily void Command\+Manager\+::set\+Shortcut (\begin{DoxyParamCaption}\item[{QAction $\ast$}]{action,  }\item[{std\+::string}]{shortcut\+String,  }\item[{bool}]{keep\+Default = {\ttfamily true} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00261                                                    \{}
\DoxyCodeLine{00262   QString shortcut = QString::fromStdString(shortcutString);}
\DoxyCodeLine{00263 }
\DoxyCodeLine{00264   std::string oldShortcutString = action-\/>shortcut().toString().toStdString();}
\DoxyCodeLine{00265   \textcolor{keywordflow}{if} (oldShortcutString == shortcutString) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00266 }
\DoxyCodeLine{00267   \textcolor{comment}{// Cerco il nodo corrispondente ad action. Deve esistere}}
\DoxyCodeLine{00268   std::map<QAction *, Node *>::iterator it = m\_qactionTable.find(action);}
\DoxyCodeLine{00269   \mbox{\hyperlink{class_node}{Node}} *node = it != m\_qactionTable.end() ? it-\/>second : 0;}
\DoxyCodeLine{00270   assert(node);}
\DoxyCodeLine{00271   assert(node-\/>m\_qaction == action);}
\DoxyCodeLine{00272 }
\DoxyCodeLine{00273   QKeySequence ks(shortcut);}
\DoxyCodeLine{00274   assert(ks.count() == 1 || ks.count() == 0 \&\& shortcut == \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00275 }
\DoxyCodeLine{00276   \textcolor{keywordflow}{if} (node-\/>m\_type == ZoomCommandType \&\& ks.count() > 1) \{}
\DoxyCodeLine{00277     DVGui::warning(}
\DoxyCodeLine{00278         QObject::tr(\textcolor{stringliteral}{"{}It is not possible to assign a shortcut with modifiers to "{}}}
\DoxyCodeLine{00279                     \textcolor{stringliteral}{"{}the visualization commands."{}}));}
\DoxyCodeLine{00280     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00281   \}}
\DoxyCodeLine{00282   \textcolor{comment}{// lo shortcut e' gia' assegnato?}}
\DoxyCodeLine{00283   QString oldActionId;}
\DoxyCodeLine{00284   std::map<std::string, Node *>::iterator sit =}
\DoxyCodeLine{00285       m\_shortcutTable.find(shortcutString);}
\DoxyCodeLine{00286   \textcolor{keywordflow}{if} (sit != m\_shortcutTable.end()) \{}
\DoxyCodeLine{00287     \textcolor{comment}{// la vecchia azione non ha piu' shortcut}}
\DoxyCodeLine{00288     oldActionId = QString::fromStdString(sit-\/>second-\/>m\_id);}
\DoxyCodeLine{00289     sit-\/>second-\/>m\_qaction-\/>setShortcut(QKeySequence());}
\DoxyCodeLine{00290     \textcolor{keywordflow}{if} (sit-\/>second-\/>m\_type == ToolCommandType)}
\DoxyCodeLine{00291       updateToolTip(sit-\/>second-\/>m\_qaction);}
\DoxyCodeLine{00292   \}}
\DoxyCodeLine{00293   \textcolor{comment}{// assegno lo shortcut all'azione}}
\DoxyCodeLine{00294   action-\/>setShortcut(}
\DoxyCodeLine{00295       QKeySequence::fromString(QString::fromStdString(shortcutString)));}
\DoxyCodeLine{00296   \textcolor{keywordflow}{if} (node-\/>m\_type == ToolCommandType) updateToolTip(action);}
\DoxyCodeLine{00297 }
\DoxyCodeLine{00298   \textcolor{comment}{// Aggiorno la tabella shortcut -\/> azioni}}
\DoxyCodeLine{00299   \textcolor{comment}{// Cancello il riferimento all'eventuale vecchio shortcut di action}}
\DoxyCodeLine{00300   \textcolor{keywordflow}{if} (oldShortcutString != \textcolor{stringliteral}{"{}"{}}) m\_shortcutTable.erase(oldShortcutString);}
\DoxyCodeLine{00301   \textcolor{comment}{// e aggiungo il nuovo legame}}
\DoxyCodeLine{00302   m\_shortcutTable[shortcutString] = node;}
\DoxyCodeLine{00303 }
\DoxyCodeLine{00304   \textcolor{comment}{// registro il tutto}}
\DoxyCodeLine{00305   \mbox{\hyperlink{class_t_file_path}{TFilePath}} fp = ToonzFolder::getMyModuleDir() + \mbox{\hyperlink{class_t_file_path}{TFilePath}}(\textcolor{stringliteral}{"{}shortcuts.ini"{}});}
\DoxyCodeLine{00306   QSettings settings(toQString(fp), QSettings::IniFormat);}
\DoxyCodeLine{00307   settings.beginGroup(\textcolor{stringliteral}{"{}shortcuts"{}});}
\DoxyCodeLine{00308   settings.setValue(QString::fromStdString(node-\/>m\_id),}
\DoxyCodeLine{00309                     QString::fromStdString(shortcutString));}
\DoxyCodeLine{00310   \textcolor{keywordflow}{if} (keepDefault) \{}
\DoxyCodeLine{00311     \textcolor{keywordflow}{if} (oldActionId != \textcolor{stringliteral}{"{}"{}}) settings.remove(oldActionId);}
\DoxyCodeLine{00312   \}}
\DoxyCodeLine{00313   settings.endGroup();}
\DoxyCodeLine{00314 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_command_manager_a6b02a1412f15de13b4655d3de0d4e2fb}\label{class_command_manager_a6b02a1412f15de13b4655d3de0d4e2fb}} 
\index{CommandManager@{CommandManager}!setToggleTexts@{setToggleTexts}}
\index{setToggleTexts@{setToggleTexts}!CommandManager@{CommandManager}}
\doxysubsubsection{\texorpdfstring{setToggleTexts()}{setToggleTexts()}}
{\footnotesize\ttfamily void Command\+Manager\+::set\+Toggle\+Texts (\begin{DoxyParamCaption}\item[{Command\+Id}]{id,  }\item[{const QString \&}]{on\+Text,  }\item[{const QString \&}]{off\+Text }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00370                                                             \{}
\DoxyCodeLine{00371   \mbox{\hyperlink{class_node}{Node}} *node = getNode(\textcolor{keywordtype}{id}, \textcolor{keyword}{false});}
\DoxyCodeLine{00372   \textcolor{keywordflow}{if} (node) \{}
\DoxyCodeLine{00373     node-\/>m\_onText  = onText;}
\DoxyCodeLine{00374     node-\/>m\_offText = offText;}
\DoxyCodeLine{00375   \}}
\DoxyCodeLine{00376 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/toonzqt/menubarcommand.\+h\item 
E\+:/opentoonz/toonz/sources/toonzqt/menubarcommand.\+cpp\end{DoxyCompactItemize}
