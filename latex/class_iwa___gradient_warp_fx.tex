\hypertarget{class_iwa___gradient_warp_fx}{}\doxysection{Iwa\+\_\+\+Gradient\+Warp\+Fx Class Reference}
\label{class_iwa___gradient_warp_fx}\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
Inheritance diagram for Iwa\+\_\+\+Gradient\+Warp\+Fx\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=5.000000cm]{class_iwa___gradient_warp_fx}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_iwa___gradient_warp_fx_a097926a05ce25ba2691c4eb61fefc0f3}{do\+Compute}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&settings) override
\item 
bool \mbox{\hyperlink{class_iwa___gradient_warp_fx_ab6622dc948d166ff1d5fd0b30d475cc3}{do\+Get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&b\+Box, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
bool \mbox{\hyperlink{class_iwa___gradient_warp_fx_afacbb0b1bddad8fedefb316137dad41d}{can\+Handle}} (const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info, double frame) override
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_iwa___gradient_warp_fx_a0306c7f9eaa4cd043146107236edad77}{get\+\_\+render\+\_\+real\+\_\+hv}} (const double frame, const \mbox{\hyperlink{class_t_affine}{TAffine}} affine, double \&h\+\_\+maxlen, double \&v\+\_\+maxlen)
\item 
void \mbox{\hyperlink{class_iwa___gradient_warp_fx_a51668d80221cb64544a6d6245afacf29}{get\+\_\+render\+\_\+enlarge}} (const double frame, const \mbox{\hyperlink{class_t_affine}{TAffine}} affine, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&b\+Box)
\item 
{\footnotesize template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ }\\void \mbox{\hyperlink{class_iwa___gradient_warp_fx_a877be9b7793c6e9981dc5bba6f53e96f}{set\+Source\+Raster}} (const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} src\+Ras, \mbox{\hyperlink{structfloat4}{float4}} $\ast$dst\+Mem, \mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} dim)
\item 
{\footnotesize template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ }\\void \mbox{\hyperlink{class_iwa___gradient_warp_fx_abf4cd206f0d41866d07d8344966fda8c}{set\+Warper\+Raster}} (const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} src\+Ras, float $\ast$dst\+Mem, \mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} dim)
\item 
{\footnotesize template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ }\\void \mbox{\hyperlink{class_iwa___gradient_warp_fx_af3388bae7afd2b3669dac23500740959}{set\+Output\+Raster}} (\mbox{\hyperlink{structfloat4}{float4}} $\ast$src\+Mem, const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} dst\+Ras, \mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} dim, \mbox{\hyperlink{structint2}{int2}} margin)
\item 
void \mbox{\hyperlink{class_iwa___gradient_warp_fx_ae5699c62cdc18aefa8dd93b0bd24c15f}{do\+Compute\+\_\+\+CPU}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, const double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&settings, double h\+Length, double v\+Length, int margin, \mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} \&enlarged\+Dim, \mbox{\hyperlink{structfloat4}{float4}} $\ast$source\+\_\+host, float $\ast$warper\+\_\+host, \mbox{\hyperlink{structfloat4}{float4}} $\ast$result\+\_\+host)
\item 
\mbox{\hyperlink{structfloat4}{float4}} \mbox{\hyperlink{class_iwa___gradient_warp_fx_a2275214e79d90c88743e4bc26ce5085c}{get\+Source\+Val\+\_\+\+CPU}} (\mbox{\hyperlink{structfloat4}{float4}} $\ast$source\+\_\+host, \mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} \&enlarged\+Dim, int pos\+\_\+x, int pos\+\_\+y)
\item 
\mbox{\hyperlink{structfloat4}{float4}} \mbox{\hyperlink{class_iwa___gradient_warp_fx_a1b48e9847e6acee2abbafdf9325b8586}{interp\+\_\+\+CPU}} (\mbox{\hyperlink{structfloat4}{float4}} val1, \mbox{\hyperlink{structfloat4}{float4}} val2, float ratio)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} \mbox{\hyperlink{class_iwa___gradient_warp_fx_a992fc5741150d0d4760c24d044cfd209}{m\+\_\+source}}
\item 
\mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} \mbox{\hyperlink{class_iwa___gradient_warp_fx_ac27fb26a754463c548f784b8f3bf1e88}{m\+\_\+warper}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___gradient_warp_fx_a373f779bf687f08fd6ee71e7d725238f}{m\+\_\+h\+\_\+maxlen}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___gradient_warp_fx_a237ea8f2276108f9ff88e10011a18a9d}{m\+\_\+v\+\_\+maxlen}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_iwa___gradient_warp_fx_acd5a56a00fcdc62ab3e469a7adf8daf2}{m\+\_\+scale}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_ae98fd5c16b312bafe7f207df0da75cc4}\label{class_iwa___gradient_warp_fx_ae98fd5c16b312bafe7f207df0da75cc4}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{Iwa\_GradientWarpFx()}{Iwa\_GradientWarpFx()}}
{\footnotesize\ttfamily Iwa\+\_\+\+Gradient\+Warp\+Fx\+::\+Iwa\+\_\+\+Gradient\+Warp\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00083     : m\_h\_maxlen(0.0), m\_v\_maxlen(0.0), m\_scale(1.0) \{}
\DoxyCodeLine{00084   \textcolor{comment}{/*-\/ 共通パラメータのバインド -\/*/}}
\DoxyCodeLine{00085   \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Source"{}}, m\_source);}
\DoxyCodeLine{00086   \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Warper"{}}, m\_warper);}
\DoxyCodeLine{00087   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}h\_maxlen"{}}, m\_h\_maxlen);}
\DoxyCodeLine{00088   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}v\_maxlen"{}}, m\_v\_maxlen);}
\DoxyCodeLine{00089   bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}scale"{}}, m\_scale);}
\DoxyCodeLine{00090 }
\DoxyCodeLine{00091   m\_h\_maxlen-\/>setMeasureName(\textcolor{stringliteral}{"{}fxLength"{}});}
\DoxyCodeLine{00092   m\_v\_maxlen-\/>setMeasureName(\textcolor{stringliteral}{"{}fxLength"{}});}
\DoxyCodeLine{00093   m\_h\_maxlen-\/>setValueRange(-\/100.0, 100.0);}
\DoxyCodeLine{00094   m\_v\_maxlen-\/>setValueRange(-\/100.0, 100.0);}
\DoxyCodeLine{00095   m\_scale-\/>setValueRange(1.0, 100.0);}
\DoxyCodeLine{00096 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_afacbb0b1bddad8fedefb316137dad41d}\label{class_iwa___gradient_warp_fx_afacbb0b1bddad8fedefb316137dad41d}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!canHandle@{canHandle}}
\index{canHandle@{canHandle}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{canHandle()}{canHandle()}}
{\footnotesize\ttfamily bool Iwa\+\_\+\+Gradient\+Warp\+Fx\+::can\+Handle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info,  }\item[{double}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00303                                                                             \{}
\DoxyCodeLine{00304   \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00305 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_a097926a05ce25ba2691c4eb61fefc0f3}\label{class_iwa___gradient_warp_fx_a097926a05ce25ba2691c4eb61fefc0f3}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!doCompute@{doCompute}}
\index{doCompute@{doCompute}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{doCompute()}{doCompute()}}
{\footnotesize\ttfamily void Iwa\+\_\+\+Gradient\+Warp\+Fx\+::do\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{settings }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00101                                                                     \{}
\DoxyCodeLine{00102   \textcolor{comment}{/*-\/ ソース画像が刺さっていなければreturn -\/*/}}
\DoxyCodeLine{00103   \textcolor{keywordflow}{if} (!m\_source.isConnected()) \{}
\DoxyCodeLine{00104     tile.getRaster()-\/>clear();}
\DoxyCodeLine{00105     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00106   \}}
\DoxyCodeLine{00107   \textcolor{comment}{/*-\/ 参照画像が刺さっていなければ、ソース画像をそのまま返す -\/*/}}
\DoxyCodeLine{00108   \textcolor{keywordflow}{if} (!m\_warper.isConnected()) \{}
\DoxyCodeLine{00109     m\_source-\/>compute(tile, frame, settings);}
\DoxyCodeLine{00110     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00111   \}}
\DoxyCodeLine{00112 }
\DoxyCodeLine{00113   \textcolor{comment}{/*-\/  計算パラメータを得る -\/*/}}
\DoxyCodeLine{00114   \textcolor{comment}{/*-\/ 移動距離のピクセルサイズ -\/*/}}
\DoxyCodeLine{00115   \textcolor{comment}{/*-\/-\/-\/ 拡大縮小(移動回転しないで)のGeometryを反映させる -\/-\/-\/*/}}
\DoxyCodeLine{00116   \textcolor{keywordtype}{double} k       = sqrt(fabs(settings.\mbox{\hyperlink{class_t_render_settings_a1250181bf3fe8e05db005d5faa76b3ea}{m\_affine}}.det()));}
\DoxyCodeLine{00117   \textcolor{keywordtype}{double} hLength = m\_h\_maxlen-\/>getValue(frame) * k;}
\DoxyCodeLine{00118   \textcolor{keywordtype}{double} vLength = m\_v\_maxlen-\/>getValue(frame) * k;}
\DoxyCodeLine{00119 }
\DoxyCodeLine{00120   \textcolor{keywordtype}{double} scale = m\_scale-\/>getValue(frame);}
\DoxyCodeLine{00121 }
\DoxyCodeLine{00122   \textcolor{comment}{/*-\/ ワープ距離が０なら、ソース画像をそのまま返す -\/*/}}
\DoxyCodeLine{00123   \textcolor{keywordflow}{if} (hLength == 0.0 \&\& vLength == 0.0) \{}
\DoxyCodeLine{00124     m\_source-\/>compute(tile, frame, settings);}
\DoxyCodeLine{00125     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00126   \}}
\DoxyCodeLine{00127 }
\DoxyCodeLine{00128   \textcolor{keywordtype}{int} margin = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(}
\DoxyCodeLine{00129       ceil((std::abs(hLength) < std::abs(vLength)) ? std::abs(vLength) : std::abs(hLength)));}
\DoxyCodeLine{00130 }
\DoxyCodeLine{00131   \textcolor{comment}{/*-\/ 素材計算範囲を計算 -\/*/}}
\DoxyCodeLine{00132   \textcolor{comment}{/*-\/ 出力範囲 -\/*/}}
\DoxyCodeLine{00133   \mbox{\hyperlink{class_t_rect_t}{TRectD}} rectOut(tile.m\_pos, \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}}(tile.getRaster()-\/>getLx(),}
\DoxyCodeLine{00134                                          tile.getRaster()-\/>getLy()));}
\DoxyCodeLine{00135   \mbox{\hyperlink{class_t_rect_t}{TRectD}} enlargedRect = rectOut.enlarge((\textcolor{keywordtype}{double})margin);}
\DoxyCodeLine{00136   \mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} enlargedDim((\textcolor{keywordtype}{int})enlargedRect.getLx(), (\textcolor{keywordtype}{int})enlargedRect.getLy());}
\DoxyCodeLine{00137 }
\DoxyCodeLine{00138   \textcolor{comment}{/*-\/ ソース画像を正規化して格納 -\/*/}}
\DoxyCodeLine{00139   \mbox{\hyperlink{structfloat4}{float4}} *source\_host;}
\DoxyCodeLine{00140   \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} source\_host\_ras(enlargedDim.lx * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structfloat4}{float4}}), enlargedDim.ly);}
\DoxyCodeLine{00141   source\_host\_ras-\/>lock();}
\DoxyCodeLine{00142   source\_host = (\mbox{\hyperlink{structfloat4}{float4}} *)source\_host\_ras-\/>getRawData();}
\DoxyCodeLine{00143   \{}
\DoxyCodeLine{00144     \textcolor{comment}{/*-\/}}
\DoxyCodeLine{00145 \textcolor{comment}{     * タイルはこのフォーカス内だけ使用。正規化してsource\_hostに取り込んだらもう使わない。}}
\DoxyCodeLine{00146 \textcolor{comment}{     * -\/*/}}
\DoxyCodeLine{00147     \mbox{\hyperlink{class_t_tile}{TTile}} sourceTile;}
\DoxyCodeLine{00148     m\_source-\/>allocateAndCompute(sourceTile, enlargedRect.getP00(), enlargedDim,}
\DoxyCodeLine{00149                                  tile.getRaster(), frame, settings);}
\DoxyCodeLine{00150     \textcolor{comment}{/*-\/ タイルの画像を０〜１に正規化してホストメモリに読み込む -\/*/}}
\DoxyCodeLine{00151     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})sourceTile.getRaster();}
\DoxyCodeLine{00152     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} ras64 = (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})sourceTile.getRaster();}
\DoxyCodeLine{00153     \textcolor{keywordflow}{if} (ras32)}
\DoxyCodeLine{00154       setSourceRaster<TRaster32P, TPixel32>(ras32, source\_host, enlargedDim);}
\DoxyCodeLine{00155     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ras64)}
\DoxyCodeLine{00156       setSourceRaster<TRaster64P, TPixel64>(ras64, source\_host, enlargedDim);}
\DoxyCodeLine{00157   \}}
\DoxyCodeLine{00158 }
\DoxyCodeLine{00159   \textcolor{comment}{/*-\/ 参照画像を正規化して格納 -\/*/}}
\DoxyCodeLine{00160   \textcolor{keywordtype}{float} *warper\_host;}
\DoxyCodeLine{00161   \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} warper\_host\_ras(enlargedDim.lx * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}), enlargedDim.ly);}
\DoxyCodeLine{00162   warper\_host\_ras-\/>lock();}
\DoxyCodeLine{00163   warper\_host = (\textcolor{keywordtype}{float} *)warper\_host\_ras-\/>getRawData();}
\DoxyCodeLine{00164   \{}
\DoxyCodeLine{00165     \textcolor{comment}{/*-\/}}
\DoxyCodeLine{00166 \textcolor{comment}{     * タイルはこのフォーカス内だけ使用。正規化してwarper\_hostに取り込んだらもう使わない}}
\DoxyCodeLine{00167 \textcolor{comment}{     * -\/*/}}
\DoxyCodeLine{00168     \mbox{\hyperlink{class_t_tile}{TTile}} warperTile;}
\DoxyCodeLine{00169     m\_warper-\/>allocateAndCompute(warperTile, enlargedRect.getP00(), enlargedDim,}
\DoxyCodeLine{00170                                  tile.getRaster(), frame, settings);}
\DoxyCodeLine{00171     \textcolor{comment}{/*-\/ タイルの画像の輝度値を０〜１に正規化してホストメモリに読み込む -\/*/}}
\DoxyCodeLine{00172     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ras32 = (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})warperTile.getRaster();}
\DoxyCodeLine{00173     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} ras64 = (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})warperTile.getRaster();}
\DoxyCodeLine{00174     \textcolor{keywordflow}{if} (ras32)}
\DoxyCodeLine{00175       setWarperRaster<TRaster32P, TPixel32>(ras32, warper\_host, enlargedDim);}
\DoxyCodeLine{00176     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ras64)}
\DoxyCodeLine{00177       setWarperRaster<TRaster64P, TPixel64>(ras64, warper\_host, enlargedDim);}
\DoxyCodeLine{00178   \}}
\DoxyCodeLine{00179 }
\DoxyCodeLine{00180   \textcolor{comment}{/*-\/ 変位値をScale倍して増やす -\/*/}}
\DoxyCodeLine{00181   hLength *= scale;}
\DoxyCodeLine{00182   vLength *= scale;}
\DoxyCodeLine{00183 }
\DoxyCodeLine{00184   \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}} result\_host\_ras;}
\DoxyCodeLine{00185 }
\DoxyCodeLine{00186   result\_host\_ras =}
\DoxyCodeLine{00187       \mbox{\hyperlink{class_t_raster_p_t}{TRasterGR8P}}(enlargedDim.lx * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structfloat4}{float4}}), enlargedDim.ly);}
\DoxyCodeLine{00188   \textcolor{comment}{/*-\/ 結果を収めるメモリ -\/*/}}
\DoxyCodeLine{00189   \mbox{\hyperlink{structfloat4}{float4}} *result\_host;}
\DoxyCodeLine{00190   result\_host\_ras-\/>lock();}
\DoxyCodeLine{00191   result\_host = (\mbox{\hyperlink{structfloat4}{float4}} *)result\_host\_ras-\/>getRawData();}
\DoxyCodeLine{00192   doCompute\_CPU(tile, frame, settings, hLength, vLength, margin, enlargedDim,}
\DoxyCodeLine{00193                 source\_host, warper\_host, result\_host);}
\DoxyCodeLine{00194   \textcolor{comment}{/*-\/ ポインタ入れ替え -\/*/}}
\DoxyCodeLine{00195   source\_host = result\_host;}
\DoxyCodeLine{00196 }
\DoxyCodeLine{00197   \mbox{\hyperlink{structint2}{int2}} yohaku = \{(enlargedDim.lx -\/ tile.getRaster()-\/>getSize().lx) / 2,}
\DoxyCodeLine{00198                  (enlargedDim.ly -\/ tile.getRaster()-\/>getSize().ly) / 2\};}
\DoxyCodeLine{00199   \textcolor{comment}{/*-\/ ラスタのクリア -\/*/}}
\DoxyCodeLine{00200   tile.getRaster()-\/>clear();}
\DoxyCodeLine{00201   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} outRas32 = (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})tile.getRaster();}
\DoxyCodeLine{00202   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} outRas64 = (\mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}})tile.getRaster();}
\DoxyCodeLine{00203   \textcolor{keywordflow}{if} (outRas32)}
\DoxyCodeLine{00204     setOutputRaster<TRaster32P, TPixel32>(source\_host, outRas32, enlargedDim,}
\DoxyCodeLine{00205                                           yohaku);}
\DoxyCodeLine{00206   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (outRas64)}
\DoxyCodeLine{00207     setOutputRaster<TRaster64P, TPixel64>(source\_host, outRas64, enlargedDim,}
\DoxyCodeLine{00208                                           yohaku);}
\DoxyCodeLine{00209 }
\DoxyCodeLine{00210   \textcolor{comment}{/*-\/ ソース画像のメモリ解放 -\/*/}}
\DoxyCodeLine{00211   source\_host\_ras-\/>unlock();}
\DoxyCodeLine{00212   \textcolor{comment}{/*-\/ 参照画像のメモリ解放 -\/*/}}
\DoxyCodeLine{00213   warper\_host\_ras-\/>unlock();}
\DoxyCodeLine{00214   result\_host\_ras-\/>unlock();}
\DoxyCodeLine{00215 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_ae5699c62cdc18aefa8dd93b0bd24c15f}\label{class_iwa___gradient_warp_fx_ae5699c62cdc18aefa8dd93b0bd24c15f}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!doCompute\_CPU@{doCompute\_CPU}}
\index{doCompute\_CPU@{doCompute\_CPU}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{doCompute\_CPU()}{doCompute\_CPU()}}
{\footnotesize\ttfamily void Iwa\+\_\+\+Gradient\+Warp\+Fx\+::do\+Compute\+\_\+\+CPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{const double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{settings,  }\item[{double}]{h\+Length,  }\item[{double}]{v\+Length,  }\item[{int}]{margin,  }\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} \&}]{enlarged\+Dim,  }\item[{\mbox{\hyperlink{structfloat4}{float4}} $\ast$}]{source\+\_\+host,  }\item[{float $\ast$}]{warper\+\_\+host,  }\item[{\mbox{\hyperlink{structfloat4}{float4}} $\ast$}]{result\+\_\+host }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00226                                                             \{}
\DoxyCodeLine{00227   \mbox{\hyperlink{structfloat4}{float4}} *res\_p = result\_host + margin * enlargedDim.lx + margin;}
\DoxyCodeLine{00228 }
\DoxyCodeLine{00229   \textcolor{keywordtype}{float} *warp\_up    = warper\_host + (margin + 1) * enlargedDim.lx + margin;}
\DoxyCodeLine{00230   \textcolor{keywordtype}{float} *warp\_down  = warper\_host + (margin -\/ 1) * enlargedDim.lx + margin;}
\DoxyCodeLine{00231   \textcolor{keywordtype}{float} *warp\_right = warper\_host + margin * enlargedDim.lx + 1 + margin;}
\DoxyCodeLine{00232   \textcolor{keywordtype}{float} *warp\_left  = warper\_host + margin * enlargedDim.lx -\/ 1 + margin;}
\DoxyCodeLine{00233 }
\DoxyCodeLine{00234   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = margin; j < enlargedDim.ly -\/ margin; j++) \{}
\DoxyCodeLine{00235     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = margin; i < enlargedDim.lx -\/ margin;}
\DoxyCodeLine{00236          i++, res\_p++, warp\_up++, warp\_down++, warp\_right++, warp\_left++) \{}
\DoxyCodeLine{00237       \textcolor{comment}{/*-\/ 勾配を得る -\/*/}}
\DoxyCodeLine{00238       \mbox{\hyperlink{structfloat2}{float2}} grad = \{\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}((*warp\_right) -\/ (*warp\_left)),}
\DoxyCodeLine{00239                      \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}((*warp\_up) -\/ (*warp\_down))\};}
\DoxyCodeLine{00240       \textcolor{comment}{/*-\/ 参照点 -\/*/}}
\DoxyCodeLine{00241       \mbox{\hyperlink{structfloat2}{float2}} samplePos = \{\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(i + grad.x * hLength),}
\DoxyCodeLine{00242                           \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(j + grad.y * vLength)\};}
\DoxyCodeLine{00243 }
\DoxyCodeLine{00244       \mbox{\hyperlink{structint2}{int2}} index = \{}
\DoxyCodeLine{00245           (int)(samplePos.x + (\textcolor{keywordtype}{float})enlargedDim.lx) -\/ enlargedDim.lx,}
\DoxyCodeLine{00246           (\textcolor{keywordtype}{int})(samplePos.y + (float)enlargedDim.ly) -\/ enlargedDim.ly\};}
\DoxyCodeLine{00247       \mbox{\hyperlink{structfloat2}{float2}} ratio = \{samplePos.x -\/ (float)index.x,}
\DoxyCodeLine{00248                       samplePos.y -\/ (\textcolor{keywordtype}{float})index.y\};}
\DoxyCodeLine{00249 }
\DoxyCodeLine{00250       \textcolor{comment}{/*-\/ サンプリング点回りのピクセルを線形補間 -\/*/}}
\DoxyCodeLine{00251       \mbox{\hyperlink{structfloat4}{float4}} col1 = interp\_CPU(}
\DoxyCodeLine{00252           getSourceVal\_CPU(source\_host, enlargedDim, index.x, index.y),}
\DoxyCodeLine{00253           getSourceVal\_CPU(source\_host, enlargedDim, index.x + 1, index.y),}
\DoxyCodeLine{00254           ratio.x);}
\DoxyCodeLine{00255       \mbox{\hyperlink{structfloat4}{float4}} col2 = interp\_CPU(}
\DoxyCodeLine{00256           getSourceVal\_CPU(source\_host, enlargedDim, index.x, index.y + 1),}
\DoxyCodeLine{00257           getSourceVal\_CPU(source\_host, enlargedDim, index.x + 1, index.y + 1),}
\DoxyCodeLine{00258           ratio.x);}
\DoxyCodeLine{00259       *res\_p = interp\_CPU(col1, col2, ratio.y);}
\DoxyCodeLine{00260     \}}
\DoxyCodeLine{00261 }
\DoxyCodeLine{00262     res\_p += 2 * margin;}
\DoxyCodeLine{00263     warp\_up += 2 * margin;}
\DoxyCodeLine{00264     warp\_down += 2 * margin;}
\DoxyCodeLine{00265     warp\_right += 2 * margin;}
\DoxyCodeLine{00266     warp\_left += 2 * margin;}
\DoxyCodeLine{00267   \}}
\DoxyCodeLine{00268 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_ab6622dc948d166ff1d5fd0b30d475cc3}\label{class_iwa___gradient_warp_fx_ab6622dc948d166ff1d5fd0b30d475cc3}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!doGetBBox@{doGetBBox}}
\index{doGetBBox@{doGetBBox}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{doGetBBox()}{doGetBBox()}}
{\footnotesize\ttfamily bool Iwa\+\_\+\+Gradient\+Warp\+Fx\+::do\+Get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{b\+Box,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00290                                                                 \{}
\DoxyCodeLine{00291   \textcolor{keywordflow}{if} (!m\_source.isConnected()) \{}
\DoxyCodeLine{00292     bBox = \mbox{\hyperlink{class_t_rect_t}{TRectD}}();}
\DoxyCodeLine{00293     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00294   \}}
\DoxyCodeLine{00295 }
\DoxyCodeLine{00296   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} ret = m\_source-\/>doGetBBox(frame, bBox, info);}
\DoxyCodeLine{00297   get\_render\_enlarge(frame, info.m\_affine, bBox);}
\DoxyCodeLine{00298   \textcolor{keywordflow}{return} ret;}
\DoxyCodeLine{00299 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_a51668d80221cb64544a6d6245afacf29}\label{class_iwa___gradient_warp_fx_a51668d80221cb64544a6d6245afacf29}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!get\_render\_enlarge@{get\_render\_enlarge}}
\index{get\_render\_enlarge@{get\_render\_enlarge}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{get\_render\_enlarge()}{get\_render\_enlarge()}}
{\footnotesize\ttfamily void Iwa\+\_\+\+Gradient\+Warp\+Fx\+::get\+\_\+render\+\_\+enlarge (\begin{DoxyParamCaption}\item[{const double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}}}]{affine,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{b\+Box }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00328                                                           \{}
\DoxyCodeLine{00329   \textcolor{keywordtype}{double} h\_maxlen = 0.0;}
\DoxyCodeLine{00330   \textcolor{keywordtype}{double} v\_maxlen = 0.0;}
\DoxyCodeLine{00331   this-\/>get\_render\_real\_hv(frame, affine, h\_maxlen, v\_maxlen);}
\DoxyCodeLine{00332   \textcolor{keyword}{const} \textcolor{keywordtype}{int} margin =}
\DoxyCodeLine{00333       \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(ceil((h\_maxlen < v\_maxlen) ? v\_maxlen : h\_maxlen));}
\DoxyCodeLine{00334   \textcolor{keywordflow}{if} (0 < margin) \{}
\DoxyCodeLine{00335     bBox = bBox.enlarge(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(margin));}
\DoxyCodeLine{00336   \}}
\DoxyCodeLine{00337 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_a0306c7f9eaa4cd043146107236edad77}\label{class_iwa___gradient_warp_fx_a0306c7f9eaa4cd043146107236edad77}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!get\_render\_real\_hv@{get\_render\_real\_hv}}
\index{get\_render\_real\_hv@{get\_render\_real\_hv}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{get\_render\_real\_hv()}{get\_render\_real\_hv()}}
{\footnotesize\ttfamily void Iwa\+\_\+\+Gradient\+Warp\+Fx\+::get\+\_\+render\+\_\+real\+\_\+hv (\begin{DoxyParamCaption}\item[{const double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}}}]{affine,  }\item[{double \&}]{h\+\_\+maxlen,  }\item[{double \&}]{v\+\_\+maxlen }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00312                                                               \{}
\DoxyCodeLine{00313   \textcolor{comment}{/*-\/-\/-\/ ベクトルにする(プラス値) -\/-\/-\/ */}}
\DoxyCodeLine{00314   \mbox{\hyperlink{class_t_point_t}{TPointD}} rend\_vect;}
\DoxyCodeLine{00315   rend\_vect.x = std::abs(m\_h\_maxlen-\/>getValue(frame));}
\DoxyCodeLine{00316   rend\_vect.y = std::abs(m\_v\_maxlen-\/>getValue(frame));}
\DoxyCodeLine{00317   \textcolor{comment}{/*-\/-\/-\/ 拡大縮小(移動回転しないで)のGeometryを反映させる -\/-\/-\/*/}}
\DoxyCodeLine{00318   rend\_vect = rend\_vect * sqrt(fabs(affine.det()));}
\DoxyCodeLine{00319   \textcolor{comment}{/*-\/-\/-\/ 方向は無視して長さを返す(プラス値) -\/-\/-\/*/}}
\DoxyCodeLine{00320   h\_maxlen = rend\_vect.x;}
\DoxyCodeLine{00321   v\_maxlen = rend\_vect.y;}
\DoxyCodeLine{00322 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_a2275214e79d90c88743e4bc26ce5085c}\label{class_iwa___gradient_warp_fx_a2275214e79d90c88743e4bc26ce5085c}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!getSourceVal\_CPU@{getSourceVal\_CPU}}
\index{getSourceVal\_CPU@{getSourceVal\_CPU}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{getSourceVal\_CPU()}{getSourceVal\_CPU()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structfloat4}{float4}} Iwa\+\_\+\+Gradient\+Warp\+Fx\+::get\+Source\+Val\+\_\+\+CPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structfloat4}{float4}} $\ast$}]{source\+\_\+host,  }\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimensionI}} \&}]{enlarged\+Dim,  }\item[{int}]{pos\+\_\+x,  }\item[{int}]{pos\+\_\+y }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00272                                                        \{}
\DoxyCodeLine{00273   \textcolor{keywordflow}{if} (pos\_x < 0 || pos\_x >= enlargedDim.lx || pos\_y < 0 ||}
\DoxyCodeLine{00274       pos\_y >= enlargedDim.ly)}
\DoxyCodeLine{00275     \textcolor{keywordflow}{return} \mbox{\hyperlink{structfloat4}{float4}}\{0.0f, 0.0f, 0.0f, 0.0f\};}
\DoxyCodeLine{00276 }
\DoxyCodeLine{00277   \textcolor{keywordflow}{return} source\_host[pos\_y * enlargedDim.lx + pos\_x];}
\DoxyCodeLine{00278 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_a1b48e9847e6acee2abbafdf9325b8586}\label{class_iwa___gradient_warp_fx_a1b48e9847e6acee2abbafdf9325b8586}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!interp\_CPU@{interp\_CPU}}
\index{interp\_CPU@{interp\_CPU}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{interp\_CPU()}{interp\_CPU()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structfloat4}{float4}} Iwa\+\_\+\+Gradient\+Warp\+Fx\+::interp\+\_\+\+CPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structfloat4}{float4}}}]{val1,  }\item[{\mbox{\hyperlink{structfloat4}{float4}}}]{val2,  }\item[{float}]{ratio }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00280                                                                            \{}
\DoxyCodeLine{00281   \textcolor{keywordflow}{return} \mbox{\hyperlink{structfloat4}{float4}}\{(1.0f -\/ ratio) * val1.x + ratio * val2.x,}
\DoxyCodeLine{00282                 (1.0f -\/ ratio) * val1.y + ratio * val2.y,}
\DoxyCodeLine{00283                 (1.0f -\/ ratio) * val1.z + ratio * val2.z,}
\DoxyCodeLine{00284                 (1.0f -\/ ratio) * val1.w + ratio * val2.w\};}
\DoxyCodeLine{00285 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_af3388bae7afd2b3669dac23500740959}\label{class_iwa___gradient_warp_fx_af3388bae7afd2b3669dac23500740959}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!setOutputRaster@{setOutputRaster}}
\index{setOutputRaster@{setOutputRaster}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{setOutputRaster()}{setOutputRaster()}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ \\
void Iwa\+\_\+\+Gradient\+Warp\+Fx\+::set\+Output\+Raster (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structfloat4}{float4}} $\ast$}]{src\+Mem,  }\item[{const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}}}]{dst\+Ras,  }\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimensionI}}}]{dim,  }\item[{\mbox{\hyperlink{structint2}{int2}}}]{margin }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00052                                                                        \{}
\DoxyCodeLine{00053   \textcolor{keywordtype}{int} out\_j = 0;}
\DoxyCodeLine{00054   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = margin.y; j < dstRas-\/>getLy() + margin.y; j++, out\_j++) \{}
\DoxyCodeLine{00055     PIXEL *pix     = dstRas-\/>pixels(out\_j);}
\DoxyCodeLine{00056     \mbox{\hyperlink{structfloat4}{float4}} *chan\_p = srcMem;}
\DoxyCodeLine{00057     chan\_p += j * dim.lx + margin.x;}
\DoxyCodeLine{00058     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dstRas-\/>getLx(); i++, pix++, chan\_p++) \{}
\DoxyCodeLine{00059       \textcolor{keywordtype}{float} val;}
\DoxyCodeLine{00060       val    = (*chan\_p).x * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00061       pix-\/>r = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00062                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00063                                              : val);}
\DoxyCodeLine{00064       val    = (*chan\_p).y * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00065       pix-\/>g = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00066                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00067                                              : val);}
\DoxyCodeLine{00068       val    = (*chan\_p).z * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00069       pix-\/>b = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00070                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00071                                              : val);}
\DoxyCodeLine{00072       val    = (*chan\_p).w * (float)PIXEL::maxChannelValue + 0.5f;}
\DoxyCodeLine{00073       pix-\/>m = (\textcolor{keyword}{typename} PIXEL::Channel)((val > (\textcolor{keywordtype}{float})PIXEL::maxChannelValue)}
\DoxyCodeLine{00074                                              ? (\textcolor{keywordtype}{float})PIXEL::maxChannelValue}
\DoxyCodeLine{00075                                              : val);}
\DoxyCodeLine{00076     \}}
\DoxyCodeLine{00077   \}}
\DoxyCodeLine{00078 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_a877be9b7793c6e9981dc5bba6f53e96f}\label{class_iwa___gradient_warp_fx_a877be9b7793c6e9981dc5bba6f53e96f}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!setSourceRaster@{setSourceRaster}}
\index{setSourceRaster@{setSourceRaster}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{setSourceRaster()}{setSourceRaster()}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ \\
void Iwa\+\_\+\+Gradient\+Warp\+Fx\+::set\+Source\+Raster (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}}}]{src\+Ras,  }\item[{\mbox{\hyperlink{structfloat4}{float4}} $\ast$}]{dst\+Mem,  }\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimensionI}}}]{dim }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00014                                                           \{}
\DoxyCodeLine{00015   \mbox{\hyperlink{structfloat4}{float4}} *chann\_p = dstMem;}
\DoxyCodeLine{00016   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dim.ly; j++) \{}
\DoxyCodeLine{00017     PIXEL *pix = srcRas-\/>pixels(j);}
\DoxyCodeLine{00018     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim.lx; i++, pix++, chann\_p++) \{}
\DoxyCodeLine{00019       (*chann\_p).x = (float)pix-\/>r / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00020       (*chann\_p).y = (float)pix-\/>g / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00021       (*chann\_p).z = (float)pix-\/>b / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00022       (*chann\_p).w = (float)pix-\/>m / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00023     \}}
\DoxyCodeLine{00024   \}}
\DoxyCodeLine{00025 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_abf4cd206f0d41866d07d8344966fda8c}\label{class_iwa___gradient_warp_fx_abf4cd206f0d41866d07d8344966fda8c}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!setWarperRaster@{setWarperRaster}}
\index{setWarperRaster@{setWarperRaster}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{setWarperRaster()}{setWarperRaster()}}
{\footnotesize\ttfamily template$<$typename \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} , typename PIXEL $>$ \\
void Iwa\+\_\+\+Gradient\+Warp\+Fx\+::set\+Warper\+Raster (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}}}]{src\+Ras,  }\item[{float $\ast$}]{dst\+Mem,  }\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimensionI}}}]{dim }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00033                                                           \{}
\DoxyCodeLine{00034   \textcolor{keywordtype}{float} *chann\_p = dstMem;}
\DoxyCodeLine{00035   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dim.ly; j++) \{}
\DoxyCodeLine{00036     PIXEL *pix = warperRas-\/>pixels(j);}
\DoxyCodeLine{00037     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim.lx; i++, pix++, chann\_p++) \{}
\DoxyCodeLine{00038       \textcolor{keywordtype}{float} r = (float)pix-\/>r / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00039       \textcolor{keywordtype}{float} g = (float)pix-\/>g / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00040       \textcolor{keywordtype}{float} b = (float)pix-\/>b / (\textcolor{keywordtype}{float})PIXEL::maxChannelValue;}
\DoxyCodeLine{00041 }
\DoxyCodeLine{00042       (*chann\_p) = 0.298912f * r + 0.586611f * g + 0.114478f * b;}
\DoxyCodeLine{00043     \}}
\DoxyCodeLine{00044   \}}
\DoxyCodeLine{00045 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_iwa___gradient_warp_fx_a373f779bf687f08fd6ee71e7d725238f}\label{class_iwa___gradient_warp_fx_a373f779bf687f08fd6ee71e7d725238f}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!m\_h\_maxlen@{m\_h\_maxlen}}
\index{m\_h\_maxlen@{m\_h\_maxlen}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{m\_h\_maxlen}{m\_h\_maxlen}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Gradient\+Warp\+Fx\+::m\+\_\+h\+\_\+maxlen\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___gradient_warp_fx_acd5a56a00fcdc62ab3e469a7adf8daf2}\label{class_iwa___gradient_warp_fx_acd5a56a00fcdc62ab3e469a7adf8daf2}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!m\_scale@{m\_scale}}
\index{m\_scale@{m\_scale}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{m\_scale}{m\_scale}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Gradient\+Warp\+Fx\+::m\+\_\+scale\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___gradient_warp_fx_a992fc5741150d0d4760c24d044cfd209}\label{class_iwa___gradient_warp_fx_a992fc5741150d0d4760c24d044cfd209}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!m\_source@{m\_source}}
\index{m\_source@{m\_source}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{m\_source}{m\_source}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} Iwa\+\_\+\+Gradient\+Warp\+Fx\+::m\+\_\+source\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___gradient_warp_fx_a237ea8f2276108f9ff88e10011a18a9d}\label{class_iwa___gradient_warp_fx_a237ea8f2276108f9ff88e10011a18a9d}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!m\_v\_maxlen@{m\_v\_maxlen}}
\index{m\_v\_maxlen@{m\_v\_maxlen}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{m\_v\_maxlen}{m\_v\_maxlen}}
{\footnotesize\ttfamily TDouble\+ParamP Iwa\+\_\+\+Gradient\+Warp\+Fx\+::m\+\_\+v\+\_\+maxlen\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_iwa___gradient_warp_fx_ac27fb26a754463c548f784b8f3bf1e88}\label{class_iwa___gradient_warp_fx_ac27fb26a754463c548f784b8f3bf1e88}} 
\index{Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}!m\_warper@{m\_warper}}
\index{m\_warper@{m\_warper}!Iwa\_GradientWarpFx@{Iwa\_GradientWarpFx}}
\doxysubsubsection{\texorpdfstring{m\_warper}{m\_warper}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} Iwa\+\_\+\+Gradient\+Warp\+Fx\+::m\+\_\+warper\hspace{0.3cm}{\ttfamily [protected]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/stdfx/iwa\+\_\+gradientwarpfx.\+h\item 
E\+:/opentoonz/toonz/sources/stdfx/iwa\+\_\+gradientwarpfx.\+cpp\end{DoxyCompactItemize}
