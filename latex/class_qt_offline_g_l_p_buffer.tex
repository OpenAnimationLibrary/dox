\hypertarget{class_qt_offline_g_l_p_buffer}{}\doxysection{Qt\+Offline\+GLPBuffer Class Reference}
\label{class_qt_offline_g_l_p_buffer}\index{QtOfflineGLPBuffer@{QtOfflineGLPBuffer}}
Inheritance diagram for Qt\+Offline\+GLPBuffer\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_qt_offline_g_l_p_buffer}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_qt_offline_g_l_p_buffer_a48e5c552ecca19303267f6341667b822}{Qt\+Offline\+GLPBuffer}} (\mbox{\hyperlink{class_t_dimension_t}{TDimension}} raster\+Size)
\item 
void \mbox{\hyperlink{class_qt_offline_g_l_p_buffer_ac97823cb6a12874d7adb15efadbcf227}{create\+Context}} (\mbox{\hyperlink{class_t_dimension_t}{TDimension}} raster\+Size)
\item 
void \mbox{\hyperlink{class_qt_offline_g_l_p_buffer_a587e0751bf37a5c7178d75d7ddde451f}{make\+Current}} () override
\item 
void \mbox{\hyperlink{class_qt_offline_g_l_p_buffer_a6615699e1743aa8d9cd10191e0aa1374}{done\+Current}} () override
\item 
void \mbox{\hyperlink{class_qt_offline_g_l_p_buffer_a8ae4eed897aa303c73d58bdaf46234df}{get\+Raster}} (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} raster) override
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::shared\+\_\+ptr$<$ QGLPixel\+Buffer $>$ \mbox{\hyperlink{class_qt_offline_g_l_p_buffer_afef7f18953894b71f9469fcb943e26f3}{m\+\_\+context}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_qt_offline_g_l_p_buffer_a48e5c552ecca19303267f6341667b822}\label{class_qt_offline_g_l_p_buffer_a48e5c552ecca19303267f6341667b822}} 
\index{QtOfflineGLPBuffer@{QtOfflineGLPBuffer}!QtOfflineGLPBuffer@{QtOfflineGLPBuffer}}
\index{QtOfflineGLPBuffer@{QtOfflineGLPBuffer}!QtOfflineGLPBuffer@{QtOfflineGLPBuffer}}
\doxysubsubsection{\texorpdfstring{QtOfflineGLPBuffer()}{QtOfflineGLPBuffer()}}
{\footnotesize\ttfamily Qt\+Offline\+GLPBuffer\+::\+Qt\+Offline\+GLPBuffer (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimension}}}]{raster\+Size }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00241     : \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOfflineGL::Imp}}(rasterSize.lx, rasterSize.ly), m\_context(0) \{}
\DoxyCodeLine{00242   createContext(rasterSize);}
\DoxyCodeLine{00243 }
\DoxyCodeLine{00244   makeCurrent();}
\DoxyCodeLine{00245 }
\DoxyCodeLine{00246   glClearColor(0.0f, 0.0f, 0.0f, 0.0f);}
\DoxyCodeLine{00247   glClear(GL\_COLOR\_BUFFER\_BIT);}
\DoxyCodeLine{00248 }
\DoxyCodeLine{00249   doneCurrent();}
\DoxyCodeLine{00250 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_qt_offline_g_l_p_buffer_af2d9b8fe0b96337081e46543df5e5909}\label{class_qt_offline_g_l_p_buffer_af2d9b8fe0b96337081e46543df5e5909}} 
\index{QtOfflineGLPBuffer@{QtOfflineGLPBuffer}!````~QtOfflineGLPBuffer@{$\sim$QtOfflineGLPBuffer}}
\index{````~QtOfflineGLPBuffer@{$\sim$QtOfflineGLPBuffer}!QtOfflineGLPBuffer@{QtOfflineGLPBuffer}}
\doxysubsubsection{\texorpdfstring{$\sim$QtOfflineGLPBuffer()}{~QtOfflineGLPBuffer()}}
{\footnotesize\ttfamily Qt\+Offline\+GLPBuffer\+::$\sim$\+Qt\+Offline\+GLPBuffer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00254 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_qt_offline_g_l_p_buffer_ac97823cb6a12874d7adb15efadbcf227}\label{class_qt_offline_g_l_p_buffer_ac97823cb6a12874d7adb15efadbcf227}} 
\index{QtOfflineGLPBuffer@{QtOfflineGLPBuffer}!createContext@{createContext}}
\index{createContext@{createContext}!QtOfflineGLPBuffer@{QtOfflineGLPBuffer}}
\doxysubsubsection{\texorpdfstring{createContext()}{createContext()}}
{\footnotesize\ttfamily void Qt\+Offline\+GLPBuffer\+::create\+Context (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimension}}}]{raster\+Size }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00258                                                             \{}
\DoxyCodeLine{00259   \textcolor{comment}{// Imposto il formato dei Pixel (pixelFormat)}}
\DoxyCodeLine{00260   \textcolor{comment}{/*}}
\DoxyCodeLine{00261 \textcolor{comment}{32,                    // 32-\/bit color depth}}
\DoxyCodeLine{00262 \textcolor{comment}{0, 0, 0, 0, 0, 0,      // color bits ignored}}
\DoxyCodeLine{00263 \textcolor{comment}{8,                     // no alpha buffer}}
\DoxyCodeLine{00264 \textcolor{comment}{0,                     // shift bit ignored}}
\DoxyCodeLine{00265 \textcolor{comment}{0,                     // no accumulation buffer}}
\DoxyCodeLine{00266 \textcolor{comment}{0, 0, 0, 0,            // accum bits ignored}}
\DoxyCodeLine{00267 \textcolor{comment}{32,                    // 32-\/bit z-\/buffer}}
\DoxyCodeLine{00268 \textcolor{comment}{32,                    // max stencil buffer}}
\DoxyCodeLine{00269 \textcolor{comment}{0,                     // no auxiliary buffer}}
\DoxyCodeLine{00270 \textcolor{comment}{PFD\_MAIN\_PLANE,        // main layer}}
\DoxyCodeLine{00271 \textcolor{comment}{0,                     // reserved}}
\DoxyCodeLine{00272 \textcolor{comment}{0, 0, 0                // layer masks ignored}}
\DoxyCodeLine{00273 \textcolor{comment}{}}
\DoxyCodeLine{00274 \textcolor{comment}{ATTENZIONE !! SU MAC IL FORMATO E' DIVERSO (casomai possiamo mettere un ifdef)}}
\DoxyCodeLine{00275 \textcolor{comment}{}}
\DoxyCodeLine{00276 \textcolor{comment}{SPECIFICHE  MAC = depth\_size 24, stencil\_size 8, alpha\_size 1}}
\DoxyCodeLine{00277 \textcolor{comment}{}}
\DoxyCodeLine{00278 \textcolor{comment}{*/}}
\DoxyCodeLine{00279 }
\DoxyCodeLine{00280   QGLFormat fmt;}
\DoxyCodeLine{00281 }
\DoxyCodeLine{00282 \textcolor{preprocessor}{\#if defined(\_WIN32)}}
\DoxyCodeLine{00283   fmt.setAlphaBufferSize(8);}
\DoxyCodeLine{00284   fmt.setAlpha(\textcolor{keyword}{false});}
\DoxyCodeLine{00285   fmt.setRgba(\textcolor{keyword}{true});}
\DoxyCodeLine{00286   fmt.setDepthBufferSize(32);}
\DoxyCodeLine{00287   fmt.setDepth(\textcolor{keyword}{true});}
\DoxyCodeLine{00288   fmt.setStencilBufferSize(32);}
\DoxyCodeLine{00289   fmt.setStencil(\textcolor{keyword}{true});}
\DoxyCodeLine{00290   fmt.setAccum(\textcolor{keyword}{false});}
\DoxyCodeLine{00291   fmt.setPlane(0);}
\DoxyCodeLine{00292 \textcolor{preprocessor}{\#elif defined(MACOSX)}}
\DoxyCodeLine{00293   fmt.setAlphaBufferSize(1);}
\DoxyCodeLine{00294   fmt.setAlpha(\textcolor{keyword}{false});}
\DoxyCodeLine{00295   fmt.setRgba(\textcolor{keyword}{true});}
\DoxyCodeLine{00296   fmt.setDepthBufferSize(24);}
\DoxyCodeLine{00297   fmt.setDepth(\textcolor{keyword}{true});}
\DoxyCodeLine{00298   fmt.setStencilBufferSize(8);}
\DoxyCodeLine{00299   fmt.setStencil(\textcolor{keyword}{true});}
\DoxyCodeLine{00300   fmt.setAccum(\textcolor{keyword}{false});}
\DoxyCodeLine{00301   fmt.setPlane(0);}
\DoxyCodeLine{00302 \textcolor{preprocessor}{\#elif defined(LINUX) || defined(FREEBSD)}}
\DoxyCodeLine{00303   fmt.setAlphaBufferSize(1);}
\DoxyCodeLine{00304   fmt.setAlpha(\textcolor{keyword}{false});}
\DoxyCodeLine{00305   fmt.setRgba(\textcolor{keyword}{true});}
\DoxyCodeLine{00306   fmt.setDepthBufferSize(24);}
\DoxyCodeLine{00307   fmt.setDepth(\textcolor{keyword}{true});}
\DoxyCodeLine{00308   fmt.setStencilBufferSize(8);}
\DoxyCodeLine{00309   fmt.setStencil(\textcolor{keyword}{true});}
\DoxyCodeLine{00310   fmt.setAccum(\textcolor{keyword}{false});}
\DoxyCodeLine{00311   fmt.setPlane(0);}
\DoxyCodeLine{00312 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00313 }
\DoxyCodeLine{00314   \textcolor{comment}{// Il PixelBuffer deve essere con width ed height potenze di 2}}
\DoxyCodeLine{00315 }
\DoxyCodeLine{00316   \textcolor{keywordtype}{int} sizeMax = std::max(rasterSize.lx, rasterSize.ly);}
\DoxyCodeLine{00317 }
\DoxyCodeLine{00318   \textcolor{comment}{// trovo la potenza di 2 che "{}contiene"{} sizeMax e la utilizzo per il PBuffer}}
\DoxyCodeLine{00319   \textcolor{keywordtype}{int} pBufferSize = 2;}
\DoxyCodeLine{00320   \textcolor{keywordflow}{while} (pBufferSize < sizeMax) pBufferSize *= 2;}
\DoxyCodeLine{00321 }
\DoxyCodeLine{00322   m\_context =}
\DoxyCodeLine{00323       std::make\_shared<QGLPixelBuffer>(QSize(pBufferSize, pBufferSize), fmt);}
\DoxyCodeLine{00324 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_qt_offline_g_l_p_buffer_a6615699e1743aa8d9cd10191e0aa1374}\label{class_qt_offline_g_l_p_buffer_a6615699e1743aa8d9cd10191e0aa1374}} 
\index{QtOfflineGLPBuffer@{QtOfflineGLPBuffer}!doneCurrent@{doneCurrent}}
\index{doneCurrent@{doneCurrent}!QtOfflineGLPBuffer@{QtOfflineGLPBuffer}}
\doxysubsubsection{\texorpdfstring{doneCurrent()}{doneCurrent()}}
{\footnotesize\ttfamily void Qt\+Offline\+GLPBuffer\+::done\+Current (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOffline\+GL\+::\+Imp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00336                                      \{}
\DoxyCodeLine{00337   \textcolor{keywordflow}{if} (m\_context) m\_context-\/>doneCurrent();}
\DoxyCodeLine{00338 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_qt_offline_g_l_p_buffer_a8ae4eed897aa303c73d58bdaf46234df}\label{class_qt_offline_g_l_p_buffer_a8ae4eed897aa303c73d58bdaf46234df}} 
\index{QtOfflineGLPBuffer@{QtOfflineGLPBuffer}!getRaster@{getRaster}}
\index{getRaster@{getRaster}!QtOfflineGLPBuffer@{QtOfflineGLPBuffer}}
\doxysubsubsection{\texorpdfstring{getRaster()}{getRaster()}}
{\footnotesize\ttfamily void Qt\+Offline\+GLPBuffer\+::get\+Raster (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}}]{raster }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOffline\+GL\+::\+Imp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00342                                                     \{}
\DoxyCodeLine{00343   makeCurrent();}
\DoxyCodeLine{00344   glFlush();}
\DoxyCodeLine{00345 }
\DoxyCodeLine{00346   \textcolor{comment}{// The image is stored using a 32-\/bit ARGB format (0xAARRGGBB).}}
\DoxyCodeLine{00347   QImage image = m\_context-\/>toImage();}
\DoxyCodeLine{00348 }
\DoxyCodeLine{00349   \textcolor{keywordtype}{int} lx = raster-\/>getLx(), ly = raster-\/>getLy();}
\DoxyCodeLine{00350 }
\DoxyCodeLine{00351   \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} emptyRaster;}
\DoxyCodeLine{00352   \textcolor{keywordflow}{if} (image.height() == 0 || image.width() == 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00353 }
\DoxyCodeLine{00354   \textcolor{comment}{// devo iniziare a leggere la Y da un certo offset}}
\DoxyCodeLine{00355   \textcolor{comment}{// dato dalla differenza tra la y della image e la y del raster}}
\DoxyCodeLine{00356   \textcolor{keywordtype}{int} yOffset = image.height() -\/ ly;}
\DoxyCodeLine{00357   raster-\/>lock();}
\DoxyCodeLine{00358 }
\DoxyCodeLine{00359   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < ly; y++) \{}
\DoxyCodeLine{00360     QRgb *inpPix = (QRgb *)image.scanLine(yOffset + y);}
\DoxyCodeLine{00361 }
\DoxyCodeLine{00362     TPixel32 *pix    = raster-\/>pixels(ly -\/ 1 -\/ y);}
\DoxyCodeLine{00363     TPixel32 *endPix = pix + lx;}
\DoxyCodeLine{00364 }
\DoxyCodeLine{00365     \textcolor{keywordflow}{for} (; pix < endPix; ++pix) \{}
\DoxyCodeLine{00366       pix-\/>m = 255;}
\DoxyCodeLine{00367       pix-\/>r = qRed(*inpPix);}
\DoxyCodeLine{00368       pix-\/>g = qGreen(*inpPix);}
\DoxyCodeLine{00369       pix-\/>b = qBlue(*inpPix);}
\DoxyCodeLine{00370       inpPix++;}
\DoxyCodeLine{00371     \}}
\DoxyCodeLine{00372   \}}
\DoxyCodeLine{00373   raster-\/>unlock();}
\DoxyCodeLine{00374 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_qt_offline_g_l_p_buffer_a587e0751bf37a5c7178d75d7ddde451f}\label{class_qt_offline_g_l_p_buffer_a587e0751bf37a5c7178d75d7ddde451f}} 
\index{QtOfflineGLPBuffer@{QtOfflineGLPBuffer}!makeCurrent@{makeCurrent}}
\index{makeCurrent@{makeCurrent}!QtOfflineGLPBuffer@{QtOfflineGLPBuffer}}
\doxysubsubsection{\texorpdfstring{makeCurrent()}{makeCurrent()}}
{\footnotesize\ttfamily void Qt\+Offline\+GLPBuffer\+::make\+Current (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOffline\+GL\+::\+Imp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00328                                      \{}
\DoxyCodeLine{00329   \textcolor{keywordflow}{if} (m\_context) \{}
\DoxyCodeLine{00330     m\_context-\/>makeCurrent();}
\DoxyCodeLine{00331   \}}
\DoxyCodeLine{00332 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_qt_offline_g_l_p_buffer_afef7f18953894b71f9469fcb943e26f3}\label{class_qt_offline_g_l_p_buffer_afef7f18953894b71f9469fcb943e26f3}} 
\index{QtOfflineGLPBuffer@{QtOfflineGLPBuffer}!m\_context@{m\_context}}
\index{m\_context@{m\_context}!QtOfflineGLPBuffer@{QtOfflineGLPBuffer}}
\doxysubsubsection{\texorpdfstring{m\_context}{m\_context}}
{\footnotesize\ttfamily std\+::shared\+\_\+ptr$<$QGLPixel\+Buffer$>$ Qt\+Offline\+GLPBuffer\+::m\+\_\+context}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/qtofflinegl.\+h\item 
E\+:/opentoonz/toonz/sources/common/tvrender/qtofflinegl.\+cpp\end{DoxyCompactItemize}
