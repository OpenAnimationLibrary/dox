\hypertarget{class_glow_fx}{}\doxysection{Glow\+Fx Class Reference}
\label{class_glow_fx}\index{GlowFx@{GlowFx}}
Inheritance diagram for Glow\+Fx\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=5.000000cm]{class_glow_fx}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{class_glow_fx_a6f7c3bb68d5b4b90a0d10f474f9b2752}{do\+Get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&bbox, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
void \mbox{\hyperlink{class_glow_fx_a9c16857ffbfdbd52e1c6585e9e0db836}{build\+Light\+Rects}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&tile\+Rect, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&in\+Rect, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&out\+Rect, double blur)
\item 
void \mbox{\hyperlink{class_glow_fx_a903595cdc9cf1b38ec09a024b5b6b4c5}{do\+Compute}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&ri) override
\item 
void \mbox{\hyperlink{class_glow_fx_afea7656eaf477533b81f1c67ba96b60f}{do\+Dry\+Compute}} (\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
bool \mbox{\hyperlink{class_glow_fx_afc3d8e64b817264f584ca49536044a5b}{can\+Handle}} (const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info, double frame) override
\item 
int \mbox{\hyperlink{class_glow_fx_a466926f826b5bebca54e45cb14e48888}{get\+Memory\+Requirement}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
\mbox{\hyperlink{class_t_fx_port}{TFx\+Port}} $\ast$ \mbox{\hyperlink{class_glow_fx_ae675b9eae842cdde603439afc8deae89}{get\+Xsheet\+Port}} () const override
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_glow_fx_ab53dc26d9f9217ef921ce9b10bfcc726}\label{class_glow_fx_ab53dc26d9f9217ef921ce9b10bfcc726}} 
\index{GlowFx@{GlowFx}!GlowFx@{GlowFx}}
\index{GlowFx@{GlowFx}!GlowFx@{GlowFx}}
\doxysubsubsection{\texorpdfstring{GlowFx()}{GlowFx()}}
{\footnotesize\ttfamily Glow\+Fx\+::\+Glow\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00124       : m\_value(10.0)}
\DoxyCodeLine{00125       , m\_brightness(100.0)}
\DoxyCodeLine{00126       , m\_color(TPixel::White)}
\DoxyCodeLine{00127       , m\_fade(0.0) \{}
\DoxyCodeLine{00128     m\_value-\/>setMeasureName(\textcolor{stringliteral}{"{}fxLength"{}});}
\DoxyCodeLine{00129     m\_color-\/>enableMatte(\textcolor{keyword}{true});}
\DoxyCodeLine{00130     m\_value-\/>setValueRange(0, (std::numeric\_limits<double>::max)());}
\DoxyCodeLine{00131     m\_brightness-\/>setValueRange(0, (std::numeric\_limits<double>::max)());}
\DoxyCodeLine{00132     m\_fade-\/>setValueRange(0.0, 100.0);}
\DoxyCodeLine{00133     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}value"{}}, m\_value);}
\DoxyCodeLine{00134     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}brightness"{}}, m\_brightness);}
\DoxyCodeLine{00135     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}color"{}}, m\_color);}
\DoxyCodeLine{00136     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}fade"{}}, m\_fade);}
\DoxyCodeLine{00137 }
\DoxyCodeLine{00138     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Light"{}}, m\_light);}
\DoxyCodeLine{00139     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Source"{}}, m\_lighted);}
\DoxyCodeLine{00140   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_glow_fx_ad835aa34f19b4e9402b21d437c2c8093}\label{class_glow_fx_ad835aa34f19b4e9402b21d437c2c8093}} 
\index{GlowFx@{GlowFx}!````~GlowFx@{$\sim$GlowFx}}
\index{````~GlowFx@{$\sim$GlowFx}!GlowFx@{GlowFx}}
\doxysubsubsection{\texorpdfstring{$\sim$GlowFx()}{~GlowFx()}}
{\footnotesize\ttfamily Glow\+Fx\+::$\sim$\+Glow\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00144 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_glow_fx_a9c16857ffbfdbd52e1c6585e9e0db836}\label{class_glow_fx_a9c16857ffbfdbd52e1c6585e9e0db836}} 
\index{GlowFx@{GlowFx}!buildLightRects@{buildLightRects}}
\index{buildLightRects@{buildLightRects}!GlowFx@{GlowFx}}
\doxysubsubsection{\texorpdfstring{buildLightRects()}{buildLightRects()}}
{\footnotesize\ttfamily void Glow\+Fx\+::build\+Light\+Rects (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{tile\+Rect,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{in\+Rect,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{out\+Rect,  }\item[{double}]{blur }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00171                                                             \{}
\DoxyCodeLine{00172     \textcolor{keywordflow}{if} (inRect !=}
\DoxyCodeLine{00173         TConsts::infiniteRectD)  \textcolor{comment}{// Could be, if the input light is a zerary Fx}}
\DoxyCodeLine{00174       makeRectCoherent(inRect, tileRect.getP00());}
\DoxyCodeLine{00175 }
\DoxyCodeLine{00176     \textcolor{keywordtype}{int} blurI = tceil(blur);}
\DoxyCodeLine{00177 }
\DoxyCodeLine{00178     \textcolor{comment}{// It seems that the TRop::blur does wrong with these (cuts at the borders).}}
\DoxyCodeLine{00179     \textcolor{comment}{// I don't know why -\/ they would be best...}}
\DoxyCodeLine{00180     \textcolor{comment}{// TRectD blurOutRect((lightRect).enlarge(blurI) * tileRect);}}
\DoxyCodeLine{00181     \textcolor{comment}{// lightRect = ((tileRect).enlarge(blurI) * lightRect);}}
\DoxyCodeLine{00182 }
\DoxyCodeLine{00183     \textcolor{comment}{// So we revert to the sum of the two}}
\DoxyCodeLine{00184     outRect = inRect = ((tileRect).enlarge(blurI) * inRect) +}
\DoxyCodeLine{00185                        ((inRect).enlarge(blurI) * tileRect);}
\DoxyCodeLine{00186   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_glow_fx_afc3d8e64b817264f584ca49536044a5b}\label{class_glow_fx_afc3d8e64b817264f584ca49536044a5b}} 
\index{GlowFx@{GlowFx}!canHandle@{canHandle}}
\index{canHandle@{canHandle}!GlowFx@{GlowFx}}
\doxysubsubsection{\texorpdfstring{canHandle()}{canHandle()}}
{\footnotesize\ttfamily bool Glow\+Fx\+::can\+Handle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info,  }\item[{double}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00326                                                                      \{}
\DoxyCodeLine{00327     \textcolor{keywordflow}{if} (m\_light.isConnected())}
\DoxyCodeLine{00328       \textcolor{keywordflow}{return} (m\_value-\/>getValue(frame) == 0) ? true}
\DoxyCodeLine{00329                                              : isAlmostIsotropic(info.m\_affine);}
\DoxyCodeLine{00330 }
\DoxyCodeLine{00331     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00332   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_glow_fx_a903595cdc9cf1b38ec09a024b5b6b4c5}\label{class_glow_fx_a903595cdc9cf1b38ec09a024b5b6b4c5}} 
\index{GlowFx@{GlowFx}!doCompute@{doCompute}}
\index{doCompute@{doCompute}!GlowFx@{GlowFx}}
\doxysubsubsection{\texorpdfstring{doCompute()}{doCompute()}}
{\footnotesize\ttfamily void Glow\+Fx\+::do\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{ri }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00191                                                      \{}
\DoxyCodeLine{00192     Status status = getFxStatus(m\_light, m\_lighted);}
\DoxyCodeLine{00193 }
\DoxyCodeLine{00194     \textcolor{keywordflow}{if} (status \& NoPortsConnected)}
\DoxyCodeLine{00195       \textcolor{comment}{// If no port, just do nothing :)}}
\DoxyCodeLine{00196       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00197 }
\DoxyCodeLine{00198     \textcolor{comment}{// Calculate source}}
\DoxyCodeLine{00199     \textcolor{keywordflow}{if} (status \& Port1Connected) m\_lighted-\/>compute(tile, frame, ri);}
\DoxyCodeLine{00200 }
\DoxyCodeLine{00201     \textcolor{comment}{// Calculate light}}
\DoxyCodeLine{00202     \textcolor{keywordflow}{if} (status \& Port0Connected) \{}
\DoxyCodeLine{00203       \textcolor{comment}{// Init light infos}}
\DoxyCodeLine{00204       \mbox{\hyperlink{class_t_dimension_t}{TDimension}} tileSize(tile.getRaster()-\/>getSize());}
\DoxyCodeLine{00205       \mbox{\hyperlink{class_t_rect_t}{TRectD}} tileRect(tile.m\_pos, \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}}(tileSize.lx, tileSize.ly));}
\DoxyCodeLine{00206 }
\DoxyCodeLine{00207       \textcolor{keywordtype}{double} scale = sqrt(fabs(ri.\mbox{\hyperlink{class_t_render_settings_a1250181bf3fe8e05db005d5faa76b3ea}{m\_affine}}.det()));}
\DoxyCodeLine{00208       \textcolor{keywordtype}{double} blur  = m\_value-\/>getValue(frame) * scale;}
\DoxyCodeLine{00209 }
\DoxyCodeLine{00210       \textcolor{comment}{// Build the light interesting rect}}
\DoxyCodeLine{00211       \mbox{\hyperlink{class_t_rect_t}{TRectD}} lightRect, blurOutRect;}
\DoxyCodeLine{00212       m\_light-\/>getBBox(frame, lightRect, ri);}
\DoxyCodeLine{00213 }
\DoxyCodeLine{00214       buildLightRects(tileRect, lightRect, blurOutRect, blur);}
\DoxyCodeLine{00215 }
\DoxyCodeLine{00216       \textcolor{keywordflow}{if} ((lightRect.getLx() <= 0) || (lightRect.getLy() <= 0)) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00217       \textcolor{keywordflow}{if} ((blurOutRect.getLx() <= 0) || (blurOutRect.getLy() <= 0)) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00218 }
\DoxyCodeLine{00219       \textcolor{comment}{// Calculate the light tile}}
\DoxyCodeLine{00220       \mbox{\hyperlink{class_t_tile}{TTile}} lightTile;}
\DoxyCodeLine{00221       \mbox{\hyperlink{class_t_dimension_t}{TDimension}} lightSize(tround(lightRect.getLx()),}
\DoxyCodeLine{00222                            tround(lightRect.getLy()));}
\DoxyCodeLine{00223       m\_light-\/>allocateAndCompute(lightTile, lightRect.getP00(), lightSize,}
\DoxyCodeLine{00224                                   tile.getRaster(), frame, ri);}
\DoxyCodeLine{00225 }
\DoxyCodeLine{00226       \textcolor{comment}{// Init glow parameters}}
\DoxyCodeLine{00227       TPixel32 color    = m\_color-\/>getValue(frame);}
\DoxyCodeLine{00228       \textcolor{keywordtype}{double} brightness = m\_brightness-\/>getValue(frame) / 100.0;}
\DoxyCodeLine{00229       \textcolor{keywordtype}{double} fade       = m\_fade-\/>getValue(frame) / 100.0;}
\DoxyCodeLine{00230 }
\DoxyCodeLine{00231       \textcolor{comment}{// Now, apply the glow}}
\DoxyCodeLine{00232 }
\DoxyCodeLine{00233       \textcolor{comment}{// First, deal with the fade}}
\DoxyCodeLine{00234       \{}
\DoxyCodeLine{00235         \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} light     = lightTile.getRaster();}
\DoxyCodeLine{00236         \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} light32 = light;}
\DoxyCodeLine{00237         \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} light64 = light;}
\DoxyCodeLine{00238         \textcolor{keywordflow}{if} (light32)}
\DoxyCodeLine{00239           ::fade(light32, fade, color);}
\DoxyCodeLine{00240         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (light64)}
\DoxyCodeLine{00241           ::fade(light64, fade, toPixel64(color));}
\DoxyCodeLine{00242         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00243           assert(\textcolor{keyword}{false});}
\DoxyCodeLine{00244       \}}
\DoxyCodeLine{00245 }
\DoxyCodeLine{00246       \textcolor{comment}{// Then, build the blur}}
\DoxyCodeLine{00247       \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} blurOut;}
\DoxyCodeLine{00248       \textcolor{keywordflow}{if} (blur > 0) \{}
\DoxyCodeLine{00249         \textcolor{comment}{// Build a temporary output to the blur}}
\DoxyCodeLine{00250         \{}
\DoxyCodeLine{00251           \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} light(lightTile.getRaster());}
\DoxyCodeLine{00252 }
\DoxyCodeLine{00253           blurOut = light-\/>create(tround(blurOutRect.getLx()),}
\DoxyCodeLine{00254                                   tround(blurOutRect.getLy()));}
\DoxyCodeLine{00255 }
\DoxyCodeLine{00256           \textcolor{comment}{// Apply the blur. Please note that SSE2 should not be used for now -\/}}
\DoxyCodeLine{00257           \textcolor{comment}{// I've seen it}}
\DoxyCodeLine{00258           \textcolor{comment}{// doing strange things to the blur...}}
\DoxyCodeLine{00259           \mbox{\hyperlink{class_t_point_t}{TPointD}} displacement(lightRect.getP00() -\/ blurOutRect.getP00());}
\DoxyCodeLine{00260           \mbox{\hyperlink{namespace_t_rop_a9baa771ae6b7beb73d594266761d2cf2}{TRop::blur}}(blurOut, light, blur, tround(displacement.x),}
\DoxyCodeLine{00261                      tround(displacement.y), \textcolor{keyword}{false});}
\DoxyCodeLine{00262         \}}
\DoxyCodeLine{00263       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00264         blurOut = lightTile.getRaster();}
\DoxyCodeLine{00265 }
\DoxyCodeLine{00266       \textcolor{comment}{// Apply the rgbm scale}}
\DoxyCodeLine{00267       \mbox{\hyperlink{namespace_t_rop_a66da5845870f824caab9c6fc47d6b8bd}{TRop::rgbmScale}}(blurOut, blurOut, 1, 1, 1, brightness);}
\DoxyCodeLine{00268 }
\DoxyCodeLine{00269       \textcolor{comment}{// Apply the add}}
\DoxyCodeLine{00270       \{}
\DoxyCodeLine{00271         \mbox{\hyperlink{class_t_rect_t}{TRectD}} interestingRect(tileRect * blurOutRect);}
\DoxyCodeLine{00272 }
\DoxyCodeLine{00273         \mbox{\hyperlink{class_t_rect_t}{TRect}} interestingTileRect(tround(interestingRect.x0 -\/ tileRect.x0),}
\DoxyCodeLine{00274                                   tround(interestingRect.y0 -\/ tileRect.y0),}
\DoxyCodeLine{00275                                   tround(interestingRect.x1 -\/ tileRect.x0) -\/ 1,}
\DoxyCodeLine{00276                                   tround(interestingRect.y1 -\/ tileRect.y0) -\/ 1);}
\DoxyCodeLine{00277         \mbox{\hyperlink{class_t_rect_t}{TRect}} interestingBlurRect(}
\DoxyCodeLine{00278             tround(interestingRect.x0 -\/ blurOutRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}),}
\DoxyCodeLine{00279             tround(interestingRect.y0 -\/ blurOutRect.y0),}
\DoxyCodeLine{00280             tround(interestingRect.x1 -\/ blurOutRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}) -\/ 1,}
\DoxyCodeLine{00281             tround(interestingRect.y1 -\/ blurOutRect.y0) -\/ 1);}
\DoxyCodeLine{00282 }
\DoxyCodeLine{00283         \textcolor{keywordflow}{if} ((interestingTileRect.getLx() <= 0) ||}
\DoxyCodeLine{00284             (interestingTileRect.getLy() <= 0))}
\DoxyCodeLine{00285           \textcolor{keywordflow}{return};}
\DoxyCodeLine{00286         \textcolor{keywordflow}{if} ((interestingBlurRect.getLx() <= 0) ||}
\DoxyCodeLine{00287             (interestingBlurRect.getLy() <= 0))}
\DoxyCodeLine{00288           \textcolor{keywordflow}{return};}
\DoxyCodeLine{00289 }
\DoxyCodeLine{00290         \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} tileInterestRas(}
\DoxyCodeLine{00291             tile.getRaster()-\/>extract(interestingTileRect));}
\DoxyCodeLine{00292         \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} blurInterestRas(blurOut-\/>extract(interestingBlurRect));}
\DoxyCodeLine{00293         \mbox{\hyperlink{namespace_t_rop_a0d74d2e7b5135fe978af69553d6bd3da}{TRop::add}}(blurInterestRas, tileInterestRas, tileInterestRas);}
\DoxyCodeLine{00294       \}}
\DoxyCodeLine{00295     \}}
\DoxyCodeLine{00296   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_glow_fx_afea7656eaf477533b81f1c67ba96b60f}\label{class_glow_fx_afea7656eaf477533b81f1c67ba96b60f}} 
\index{GlowFx@{GlowFx}!doDryCompute@{doDryCompute}}
\index{doDryCompute@{doDryCompute}!GlowFx@{GlowFx}}
\doxysubsubsection{\texorpdfstring{doDryCompute()}{doDryCompute()}}
{\footnotesize\ttfamily void Glow\+Fx\+::do\+Dry\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Declares the computation scheme of this fx for rendering optimization purposes. This is an important function of the Toonz rendering API, and should be reimplemented with the necessary care. The Toonz rendering process makes use of this function to enact most of the optimization steps about the fx computation, in particular fx caching. A correct implementation of this method should follow these rules\+:  The invocation of child node computations should be faithfully reproduced.  TRaster\+Fx\+::compute and TRaster\+Fx\+::allocate\+And\+Compute calls have to be translated to TRaster\+Fx\+::dry\+Compute calls.  This fx is intended for precomputation stage, so the hard rendering code should be skipped here. By default, this method raises a dry\+Compute call to each input port in increasing order, using the TRaster\+Fx\+::transform method to identify the tiles to be passed on input precomputation. 

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_a47ec31d2d4c3a066cd6744fb8c80edf2}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00301                                                           \{}
\DoxyCodeLine{00302     Status status = getFxStatus(m\_light, m\_lighted);}
\DoxyCodeLine{00303     \textcolor{keywordflow}{if} (status \& NoPortsConnected) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00304 }
\DoxyCodeLine{00305     \textcolor{keywordflow}{if} (status \& Port1Connected) m\_lighted-\/>dryCompute(rect, frame, info);}
\DoxyCodeLine{00306 }
\DoxyCodeLine{00307     \textcolor{keywordflow}{if} (status \& Port0Connected) \{}
\DoxyCodeLine{00308       \textcolor{keywordtype}{double} scale = sqrt(fabs(info.m\_affine.det()));}
\DoxyCodeLine{00309       \textcolor{keywordtype}{double} blur  = m\_value-\/>getValue(frame) * scale;}
\DoxyCodeLine{00310 }
\DoxyCodeLine{00311       \mbox{\hyperlink{class_t_rect_t}{TRectD}} lightRect, blurOutRect;}
\DoxyCodeLine{00312       m\_light-\/>getBBox(frame, lightRect, info);}
\DoxyCodeLine{00313 }
\DoxyCodeLine{00314       buildLightRects(rect, lightRect, blurOutRect, blur);}
\DoxyCodeLine{00315 }
\DoxyCodeLine{00316       \textcolor{keywordflow}{if} ((lightRect.getLx() <= 0) || (lightRect.getLy() <= 0)) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00317       \textcolor{keywordflow}{if} ((blurOutRect.getLx() <= 0) || (blurOutRect.getLy() <= 0)) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00318 }
\DoxyCodeLine{00319       m\_light-\/>dryCompute(lightRect, frame, info);}
\DoxyCodeLine{00320     \}}
\DoxyCodeLine{00321   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_glow_fx_a6f7c3bb68d5b4b90a0d10f474f9b2752}\label{class_glow_fx_a6f7c3bb68d5b4b90a0d10f474f9b2752}} 
\index{GlowFx@{GlowFx}!doGetBBox@{doGetBBox}}
\index{doGetBBox@{doGetBBox}!GlowFx@{GlowFx}}
\doxysubsubsection{\texorpdfstring{doGetBBox()}{doGetBBox()}}
{\footnotesize\ttfamily bool Glow\+Fx\+::do\+Get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{bbox,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00149                                                        \{}
\DoxyCodeLine{00150     \textcolor{keywordflow}{if} (getActiveTimeRegion().contains(frame)) \{}
\DoxyCodeLine{00151       \textcolor{keywordflow}{if} (m\_light.isConnected()) \{}
\DoxyCodeLine{00152         \mbox{\hyperlink{class_t_rect_t}{TRectD}} b0, b1;}
\DoxyCodeLine{00153         \textcolor{keywordtype}{bool} ret = m\_light-\/>doGetBBox(frame, b0, info);}
\DoxyCodeLine{00154         bbox     = b0.enlarge(tceil(m\_value-\/>getValue(frame)));}
\DoxyCodeLine{00155         \textcolor{keywordflow}{if} (m\_lighted.isConnected()) \{}
\DoxyCodeLine{00156           ret = ret \&\& m\_lighted-\/>doGetBBox(frame, b1, info);}
\DoxyCodeLine{00157           bbox += b1;}
\DoxyCodeLine{00158         \}}
\DoxyCodeLine{00159         \textcolor{keywordflow}{return} ret;}
\DoxyCodeLine{00160       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_lighted.isConnected()) \{}
\DoxyCodeLine{00161         \textcolor{keywordflow}{return} m\_lighted-\/>doGetBBox(frame, bbox, info);}
\DoxyCodeLine{00162       \}}
\DoxyCodeLine{00163     \}}
\DoxyCodeLine{00164 }
\DoxyCodeLine{00165     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00166   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_glow_fx_a466926f826b5bebca54e45cb14e48888}\label{class_glow_fx_a466926f826b5bebca54e45cb14e48888}} 
\index{GlowFx@{GlowFx}!getMemoryRequirement@{getMemoryRequirement}}
\index{getMemoryRequirement@{getMemoryRequirement}!GlowFx@{GlowFx}}
\doxysubsubsection{\texorpdfstring{getMemoryRequirement()}{getMemoryRequirement()}}
{\footnotesize\ttfamily int Glow\+Fx\+::get\+Memory\+Requirement (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Specifies the approximate size (in Mega\+Bytes) of the maximum allocation instance that this fx will need to perform in order to render the passed input. This method should be reimplemented in order to make the Toonz rendering process aware of the use of big raster memory chunks, at least. Observe that the passed tile geometry is implicitly {\itshape  already allocated \texorpdfstring{$<$}{<}\textbackslash{}i\texorpdfstring{$>$}{>} for the fx output. ~\newline
The default implementation returns 0, assuming that the passed implicit memory size is passed below in node computation without further allocation of resources. Fxs can reimplement this to -\/1 to explicitly disable the Toonz\textquotesingle{}s smart memory handling. ~\newline
 ~\newline
\begin{DoxyNote}{Note}
The rendering process ensures that the passed render settings are {\itshape handled} by the fx before this function is invoked -\/ do not waste code for it. 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRaster\+Fx\+::memory\+Size}} and TRaster\+Fx\+::can\+Handle methods. 
\end{DoxySeeAlso}
}

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_af8eb991c9756f4fb2e48d9f96cbacfba}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00337                                                                  \{}
\DoxyCodeLine{00338     \textcolor{keywordtype}{double} scale = sqrt(fabs(info.m\_affine.det()));}
\DoxyCodeLine{00339     \textcolor{keywordtype}{double} blur  = m\_value-\/>getValue(frame) * scale;}
\DoxyCodeLine{00340 }
\DoxyCodeLine{00341     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRasterFx::memorySize}}(rect.enlarge(blur), info.m\_bpp);}
\DoxyCodeLine{00342   \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00560}{TRaster\+Fx\+::memory\+Size()}}.

\mbox{\Hypertarget{class_glow_fx_ae675b9eae842cdde603439afc8deae89}\label{class_glow_fx_ae675b9eae842cdde603439afc8deae89}} 
\index{GlowFx@{GlowFx}!getXsheetPort@{getXsheetPort}}
\index{getXsheetPort@{getXsheetPort}!GlowFx@{GlowFx}}
\doxysubsubsection{\texorpdfstring{getXsheetPort()}{getXsheetPort()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_fx_port}{TFx\+Port}} $\ast$ Glow\+Fx\+::get\+Xsheet\+Port (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_fx}{TFx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00346 \{ \textcolor{keywordflow}{return} getInputPort(1); \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/stdfx/glowfx.\+cpp\end{DoxyCompactItemize}
