\hypertarget{class_local_blur_fx}{}\doxysection{Local\+Blur\+Fx Class Reference}
\label{class_local_blur_fx}\index{LocalBlurFx@{LocalBlurFx}}
Inheritance diagram for Local\+Blur\+Fx\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=5.000000cm]{class_local_blur_fx}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{class_local_blur_fx_a84863dd873cb59d033147e9985eda1f9}{can\+Handle}} (const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info, double frame) override
\item 
bool \mbox{\hyperlink{class_local_blur_fx_ad58d92137509026eb005d9c3b97bc189}{do\+Get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&b\+Box, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
void \mbox{\hyperlink{class_local_blur_fx_a2a6cd9ef61b3a705b21f14f8750876a9}{enlarge}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&bbox, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&requested\+Rect, int blur)
\item 
void \mbox{\hyperlink{class_local_blur_fx_a0fca6fd9a0346dd29afdf421b8fa5ad2}{do\+Dry\+Compute}} (\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
void \mbox{\hyperlink{class_local_blur_fx_a0cdc725f84a614942aa1a030bd5228d4}{do\+Compute}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
int \mbox{\hyperlink{class_local_blur_fx_af16e61b79fb86f12c8bf10947b3fe383}{get\+Memory\+Requirement}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} \mbox{\hyperlink{class_local_blur_fx_a65503750894e0aade263256f8f52c259}{m\+\_\+up}}
\item 
\mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} \mbox{\hyperlink{class_local_blur_fx_a602644cc0aafe10b39906751906ad97f}{m\+\_\+ref}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_local_blur_fx_a4b930cf5e02fe75cf21d087286004f70}{m\+\_\+value}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_local_blur_fx_a464d48785453384acc8ecce3c161770c}\label{class_local_blur_fx_a464d48785453384acc8ecce3c161770c}} 
\index{LocalBlurFx@{LocalBlurFx}!LocalBlurFx@{LocalBlurFx}}
\index{LocalBlurFx@{LocalBlurFx}!LocalBlurFx@{LocalBlurFx}}
\doxysubsubsection{\texorpdfstring{LocalBlurFx()}{LocalBlurFx()}}
{\footnotesize\ttfamily Local\+Blur\+Fx\+::\+Local\+Blur\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00244                 : m\_value(20) \{}
\DoxyCodeLine{00245     m\_value-\/>setMeasureName(\textcolor{stringliteral}{"{}fxLength"{}});}
\DoxyCodeLine{00246     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Source"{}}, m\_up);}
\DoxyCodeLine{00247     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Reference"{}}, m\_ref);}
\DoxyCodeLine{00248     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}value"{}}, m\_value);}
\DoxyCodeLine{00249     m\_value-\/>setValueRange(0, (std::numeric\_limits<double>::max)());}
\DoxyCodeLine{00250   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_local_blur_fx_a1396f6dc49a297b01bdc9a49b52a80ff}\label{class_local_blur_fx_a1396f6dc49a297b01bdc9a49b52a80ff}} 
\index{LocalBlurFx@{LocalBlurFx}!````~LocalBlurFx@{$\sim$LocalBlurFx}}
\index{````~LocalBlurFx@{$\sim$LocalBlurFx}!LocalBlurFx@{LocalBlurFx}}
\doxysubsubsection{\texorpdfstring{$\sim$LocalBlurFx()}{~LocalBlurFx()}}
{\footnotesize\ttfamily Local\+Blur\+Fx\+::$\sim$\+Local\+Blur\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00252 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_local_blur_fx_a84863dd873cb59d033147e9985eda1f9}\label{class_local_blur_fx_a84863dd873cb59d033147e9985eda1f9}} 
\index{LocalBlurFx@{LocalBlurFx}!canHandle@{canHandle}}
\index{canHandle@{canHandle}!LocalBlurFx@{LocalBlurFx}}
\doxysubsubsection{\texorpdfstring{canHandle()}{canHandle()}}
{\footnotesize\ttfamily bool Local\+Blur\+Fx\+::can\+Handle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info,  }\item[{double}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00254                                                                      \{}
\DoxyCodeLine{00255     \textcolor{keywordflow}{return} (isAlmostIsotropic(info.m\_affine) || m\_value-\/>getValue(frame) == 0);}
\DoxyCodeLine{00256   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_local_blur_fx_a0cdc725f84a614942aa1a030bd5228d4}\label{class_local_blur_fx_a0cdc725f84a614942aa1a030bd5228d4}} 
\index{LocalBlurFx@{LocalBlurFx}!doCompute@{doCompute}}
\index{doCompute@{doCompute}!LocalBlurFx@{LocalBlurFx}}
\doxysubsubsection{\texorpdfstring{doCompute()}{doCompute()}}
{\footnotesize\ttfamily void Local\+Blur\+Fx\+::do\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00344                                                          \{}
\DoxyCodeLine{00345   \mbox{\hyperlink{class_t_tile}{TTile}} refTile;}
\DoxyCodeLine{00346   \textcolor{keywordtype}{bool} isUp   = m\_up.isConnected();}
\DoxyCodeLine{00347   \textcolor{keywordtype}{bool} isDown = m\_ref.isConnected();}
\DoxyCodeLine{00348 }
\DoxyCodeLine{00349   \textcolor{keywordflow}{if} (!isUp) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00350 }
\DoxyCodeLine{00351   \textcolor{keywordflow}{if} (!isDown) \{}
\DoxyCodeLine{00352     m\_up-\/>compute(tile, frame, info);}
\DoxyCodeLine{00353     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00354   \}}
\DoxyCodeLine{00355 }
\DoxyCodeLine{00356   \textcolor{comment}{// Generic case}}
\DoxyCodeLine{00357   assert(isAlmostIsotropic(info.m\_affine));}
\DoxyCodeLine{00358   \textcolor{keywordtype}{double} blur =}
\DoxyCodeLine{00359       fabs(m\_value-\/>getValue(frame) * sqrt(fabs(info.m\_affine.det())));}
\DoxyCodeLine{00360   \textcolor{keywordtype}{int} blurI = tceil(blur);}
\DoxyCodeLine{00361 }
\DoxyCodeLine{00362   \textcolor{comment}{// Get the requested tile's geometry}}
\DoxyCodeLine{00363   \mbox{\hyperlink{class_t_rect_t}{TRectD}} rectOut(tile.m\_pos, \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}}(tile.getRaster()-\/>getLx(),}
\DoxyCodeLine{00364                                          tile.getRaster()-\/>getLy()));}
\DoxyCodeLine{00365 }
\DoxyCodeLine{00366   \textcolor{comment}{// Retrieve the input interesting geometry -\/ and ensure that something}}
\DoxyCodeLine{00367   \textcolor{comment}{// actually has}}
\DoxyCodeLine{00368   \textcolor{comment}{// to be computed}}
\DoxyCodeLine{00369   \mbox{\hyperlink{class_t_rect_t}{TRectD}} bboxIn;}
\DoxyCodeLine{00370   \textcolor{keywordflow}{if} (!m\_up-\/>getBBox(frame, bboxIn, info) || rectOut.isEmpty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00371 }
\DoxyCodeLine{00372   \mbox{\hyperlink{class_t_rect_t}{TRectD}} rectIn(rectOut);}
\DoxyCodeLine{00373   enlarge(bboxIn, rectIn, blurI);}
\DoxyCodeLine{00374 }
\DoxyCodeLine{00375   \textcolor{keywordflow}{if} (rectIn.isEmpty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00376 }
\DoxyCodeLine{00377   \textcolor{comment}{// Finally, allocate and compute the blur argument}}
\DoxyCodeLine{00378   \mbox{\hyperlink{class_t_tile}{TTile}} tileIn;}
\DoxyCodeLine{00379   m\_up-\/>allocateAndCompute(tileIn, rectIn.getP00(),}
\DoxyCodeLine{00380                            \mbox{\hyperlink{class_t_dimension_t}{TDimension}}(rectIn.getLx(), rectIn.getLy()),}
\DoxyCodeLine{00381                            tile.getRaster(), frame, info);}
\DoxyCodeLine{00382 }
\DoxyCodeLine{00383   \mbox{\hyperlink{class_t_tile}{TTile}} tileRef;}
\DoxyCodeLine{00384   m\_ref-\/>allocateAndCompute(tileRef, rectIn.getP00(),}
\DoxyCodeLine{00385                             \mbox{\hyperlink{class_t_dimension_t}{TDimension}}(rectIn.getLx(), rectIn.getLy()),}
\DoxyCodeLine{00386                             tile.getRaster(), frame, info);}
\DoxyCodeLine{00387 }
\DoxyCodeLine{00388   \textcolor{comment}{// Perform Local Blur}}
\DoxyCodeLine{00389   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} inRas(tileIn.getRaster());}
\DoxyCodeLine{00390   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} refRas(tileRef.getRaster());}
\DoxyCodeLine{00391   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} outRas(tile.getRaster());}
\DoxyCodeLine{00392 }
\DoxyCodeLine{00393   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} in32(inRas);}
\DoxyCodeLine{00394   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} ref32(refRas);}
\DoxyCodeLine{00395   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} out32(outRas);}
\DoxyCodeLine{00396 }
\DoxyCodeLine{00397   \mbox{\hyperlink{class_t_point_t}{TPoint}} displacement(convert(}
\DoxyCodeLine{00398       rectIn.getP00() -\/ tile.m\_pos));  \textcolor{comment}{// inTile position relative to (out)tile}}
\DoxyCodeLine{00399   \textcolor{comment}{// The difference already has integer coordinates due to enlarge()}}
\DoxyCodeLine{00400 }
\DoxyCodeLine{00401   \textcolor{keywordflow}{if} (in32 \&\& ref32 \&\& out32)}
\DoxyCodeLine{00402     doLocalBlur<TPixelRGBM32, TPixelGR8>(in32, ref32, out32, blur,}
\DoxyCodeLine{00403                                          displacement);}
\DoxyCodeLine{00404   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00405     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} in64(inRas);}
\DoxyCodeLine{00406     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} ref64(refRas);}
\DoxyCodeLine{00407     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} out64(outRas);}
\DoxyCodeLine{00408 }
\DoxyCodeLine{00409     \textcolor{keywordflow}{if} (in64 \&\& ref64 \&\& out64)}
\DoxyCodeLine{00410       doLocalBlur<TPixelRGBM64, TPixelGR16>(in64, ref64, out64, blur,}
\DoxyCodeLine{00411                                             displacement);}
\DoxyCodeLine{00412     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00413       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}LocalBlurFx: unsupported raster type"{}});}
\DoxyCodeLine{00414   \}}
\DoxyCodeLine{00415 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_local_blur_fx_a0fca6fd9a0346dd29afdf421b8fa5ad2}\label{class_local_blur_fx_a0fca6fd9a0346dd29afdf421b8fa5ad2}} 
\index{LocalBlurFx@{LocalBlurFx}!doDryCompute@{doDryCompute}}
\index{doDryCompute@{doDryCompute}!LocalBlurFx@{LocalBlurFx}}
\doxysubsubsection{\texorpdfstring{doDryCompute()}{doDryCompute()}}
{\footnotesize\ttfamily void Local\+Blur\+Fx\+::do\+Dry\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Declares the computation scheme of this fx for rendering optimization purposes. This is an important function of the Toonz rendering API, and should be reimplemented with the necessary care. The Toonz rendering process makes use of this function to enact most of the optimization steps about the fx computation, in particular fx caching. A correct implementation of this method should follow these rules\+:  The invocation of child node computations should be faithfully reproduced.  TRaster\+Fx\+::compute and TRaster\+Fx\+::allocate\+And\+Compute calls have to be translated to TRaster\+Fx\+::dry\+Compute calls.  This fx is intended for precomputation stage, so the hard rendering code should be skipped here. By default, this method raises a dry\+Compute call to each input port in increasing order, using the TRaster\+Fx\+::transform method to identify the tiles to be passed on input precomputation. 

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_a47ec31d2d4c3a066cd6744fb8c80edf2}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00311                                                             \{}
\DoxyCodeLine{00312   \textcolor{comment}{// Mimics the doCompute() without actual computation.}}
\DoxyCodeLine{00313 }
\DoxyCodeLine{00314   \mbox{\hyperlink{class_t_tile}{TTile}} refTile;}
\DoxyCodeLine{00315   \textcolor{keywordtype}{bool} isUp   = m\_up.isConnected();}
\DoxyCodeLine{00316   \textcolor{keywordtype}{bool} isDown = m\_ref.isConnected();}
\DoxyCodeLine{00317 }
\DoxyCodeLine{00318   \textcolor{keywordflow}{if} (!isUp) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00319 }
\DoxyCodeLine{00320   \textcolor{keywordflow}{if} (!isDown) \{}
\DoxyCodeLine{00321     m\_up-\/>dryCompute(rectOut, frame, info);}
\DoxyCodeLine{00322     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00323   \}}
\DoxyCodeLine{00324 }
\DoxyCodeLine{00325   \textcolor{keywordtype}{double} blur =}
\DoxyCodeLine{00326       fabs(m\_value-\/>getValue(frame) * sqrt(fabs(info.m\_affine.det())));}
\DoxyCodeLine{00327   \textcolor{keywordtype}{int} blurI = tceil(blur);}
\DoxyCodeLine{00328 }
\DoxyCodeLine{00329   \mbox{\hyperlink{class_t_rect_t}{TRectD}} bboxIn;}
\DoxyCodeLine{00330   \textcolor{keywordflow}{if} (!m\_up-\/>getBBox(frame, bboxIn, info) || rectOut.isEmpty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00331 }
\DoxyCodeLine{00332   \mbox{\hyperlink{class_t_rect_t}{TRectD}} rectIn(rectOut);}
\DoxyCodeLine{00333   enlarge(bboxIn, rectIn, blurI);}
\DoxyCodeLine{00334 }
\DoxyCodeLine{00335   \textcolor{keywordflow}{if} (rectIn.isEmpty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00336 }
\DoxyCodeLine{00337   m\_up-\/>dryCompute(rectOut, frame, info);}
\DoxyCodeLine{00338   m\_ref-\/>dryCompute(rectOut, frame, info);}
\DoxyCodeLine{00339 \}}

\end{DoxyCode}


References \mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{TRect\+T$<$ T $>$\+::is\+Empty()}}.

\mbox{\Hypertarget{class_local_blur_fx_ad58d92137509026eb005d9c3b97bc189}\label{class_local_blur_fx_ad58d92137509026eb005d9c3b97bc189}} 
\index{LocalBlurFx@{LocalBlurFx}!doGetBBox@{doGetBBox}}
\index{doGetBBox@{doGetBBox}!LocalBlurFx@{LocalBlurFx}}
\doxysubsubsection{\texorpdfstring{doGetBBox()}{doGetBBox()}}
{\footnotesize\ttfamily bool Local\+Blur\+Fx\+::do\+Get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{b\+Box,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00259                                                        \{}
\DoxyCodeLine{00260     \textcolor{keywordflow}{if} (m\_up.isConnected()) \{}
\DoxyCodeLine{00261       \textcolor{keywordtype}{bool} ret = m\_up-\/>doGetBBox(frame, bBox, info);}
\DoxyCodeLine{00262 }
\DoxyCodeLine{00263       \textcolor{keywordtype}{double} blur = fabs(m\_value-\/>getValue(frame));}
\DoxyCodeLine{00264       \textcolor{keywordtype}{int} blurI   = tceil(blur);}
\DoxyCodeLine{00265       bBox        = bBox.enlarge(blurI);}
\DoxyCodeLine{00266 }
\DoxyCodeLine{00267       \textcolor{keywordflow}{return} ret;}
\DoxyCodeLine{00268     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00269       bBox = \mbox{\hyperlink{class_t_rect_t}{TRectD}}();}
\DoxyCodeLine{00270       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00271     \}}
\DoxyCodeLine{00272   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_local_blur_fx_a2a6cd9ef61b3a705b21f14f8750876a9}\label{class_local_blur_fx_a2a6cd9ef61b3a705b21f14f8750876a9}} 
\index{LocalBlurFx@{LocalBlurFx}!enlarge@{enlarge}}
\index{enlarge@{enlarge}!LocalBlurFx@{LocalBlurFx}}
\doxysubsubsection{\texorpdfstring{enlarge()}{enlarge()}}
{\footnotesize\ttfamily void Local\+Blur\+Fx\+::enlarge (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{bbox,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{requested\+Rect,  }\item[{int}]{blur }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00287                                                                              \{}
\DoxyCodeLine{00288   \textcolor{comment}{// See BlurFx: this is a faithful replica}}
\DoxyCodeLine{00289   \textcolor{keywordflow}{if} (bbox.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}() || requestedRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \{}
\DoxyCodeLine{00290     requestedRect.empty();}
\DoxyCodeLine{00291     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00292   \}}
\DoxyCodeLine{00293 }
\DoxyCodeLine{00294   \mbox{\hyperlink{class_t_rect_t}{TRectD}} enlargedBBox(bbox.enlarge(blur));}
\DoxyCodeLine{00295   \mbox{\hyperlink{class_t_rect_t}{TRectD}} enlargedOut(requestedRect.enlarge(blur));}
\DoxyCodeLine{00296 }
\DoxyCodeLine{00297   \mbox{\hyperlink{class_t_point_t}{TPointD}} originalP00(requestedRect.getP00());}
\DoxyCodeLine{00298   requestedRect = (enlargedOut * bbox) + (enlargedBBox * requestedRect);}
\DoxyCodeLine{00299 }
\DoxyCodeLine{00300   requestedRect -\/= originalP00;}
\DoxyCodeLine{00301   requestedRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} = tfloor(requestedRect.x0);}
\DoxyCodeLine{00302   requestedRect.y0 = tfloor(requestedRect.y0);}
\DoxyCodeLine{00303   requestedRect.x1 = tceil(requestedRect.x1);}
\DoxyCodeLine{00304   requestedRect.y1 = tceil(requestedRect.y1);}
\DoxyCodeLine{00305   requestedRect += originalP00;}
\DoxyCodeLine{00306 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_local_blur_fx_af16e61b79fb86f12c8bf10947b3fe383}\label{class_local_blur_fx_af16e61b79fb86f12c8bf10947b3fe383}} 
\index{LocalBlurFx@{LocalBlurFx}!getMemoryRequirement@{getMemoryRequirement}}
\index{getMemoryRequirement@{getMemoryRequirement}!LocalBlurFx@{LocalBlurFx}}
\doxysubsubsection{\texorpdfstring{getMemoryRequirement()}{getMemoryRequirement()}}
{\footnotesize\ttfamily int Local\+Blur\+Fx\+::get\+Memory\+Requirement (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Specifies the approximate size (in Mega\+Bytes) of the maximum allocation instance that this fx will need to perform in order to render the passed input. This method should be reimplemented in order to make the Toonz rendering process aware of the use of big raster memory chunks, at least. Observe that the passed tile geometry is implicitly {\itshape  already allocated \texorpdfstring{$<$}{<}\textbackslash{}i\texorpdfstring{$>$}{>} for the fx output. ~\newline
The default implementation returns 0, assuming that the passed implicit memory size is passed below in node computation without further allocation of resources. Fxs can reimplement this to -\/1 to explicitly disable the Toonz\textquotesingle{}s smart memory handling. ~\newline
 ~\newline
\begin{DoxyNote}{Note}
The rendering process ensures that the passed render settings are {\itshape handled} by the fx before this function is invoked -\/ do not waste code for it. 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRaster\+Fx\+::memory\+Size}} and TRaster\+Fx\+::can\+Handle methods. 
\end{DoxySeeAlso}
}

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_af8eb991c9756f4fb2e48d9f96cbacfba}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00420                                                                    \{}
\DoxyCodeLine{00421   \textcolor{keywordtype}{double} blur =}
\DoxyCodeLine{00422       fabs(m\_value-\/>getValue(frame) * sqrt(fabs(info.m\_affine.det())));}
\DoxyCodeLine{00423   \textcolor{keywordtype}{int} blurI = tceil(blur);}
\DoxyCodeLine{00424 }
\DoxyCodeLine{00425   \textcolor{keywordflow}{return} 2 * \mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRasterFx::memorySize}}(rect.enlarge(blurI), info.m\_bpp);}
\DoxyCodeLine{00426 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00560}{TRaster\+Fx\+::memory\+Size()}}.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_local_blur_fx_a602644cc0aafe10b39906751906ad97f}\label{class_local_blur_fx_a602644cc0aafe10b39906751906ad97f}} 
\index{LocalBlurFx@{LocalBlurFx}!m\_ref@{m\_ref}}
\index{m\_ref@{m\_ref}!LocalBlurFx@{LocalBlurFx}}
\doxysubsubsection{\texorpdfstring{m\_ref}{m\_ref}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} Local\+Blur\+Fx\+::m\+\_\+ref\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_local_blur_fx_a65503750894e0aade263256f8f52c259}\label{class_local_blur_fx_a65503750894e0aade263256f8f52c259}} 
\index{LocalBlurFx@{LocalBlurFx}!m\_up@{m\_up}}
\index{m\_up@{m\_up}!LocalBlurFx@{LocalBlurFx}}
\doxysubsubsection{\texorpdfstring{m\_up}{m\_up}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} Local\+Blur\+Fx\+::m\+\_\+up\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_local_blur_fx_a4b930cf5e02fe75cf21d087286004f70}\label{class_local_blur_fx_a4b930cf5e02fe75cf21d087286004f70}} 
\index{LocalBlurFx@{LocalBlurFx}!m\_value@{m\_value}}
\index{m\_value@{m\_value}!LocalBlurFx@{LocalBlurFx}}
\doxysubsubsection{\texorpdfstring{m\_value}{m\_value}}
{\footnotesize\ttfamily TDouble\+ParamP Local\+Blur\+Fx\+::m\+\_\+value\hspace{0.3cm}{\ttfamily [protected]}}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/stdfx/localblurfx.\+cpp\end{DoxyCompactItemize}
