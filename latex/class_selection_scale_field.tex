\hypertarget{class_selection_scale_field}{}\doxysection{Selection\+Scale\+Field Class Reference}
\label{class_selection_scale_field}\index{SelectionScaleField@{SelectionScaleField}}
Inheritance diagram for Selection\+Scale\+Field\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=4.000000cm]{class_selection_scale_field}
\end{center}
\end{figure}
\doxysubsection*{Signals}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_selection_scale_field_adc06e47379f2322e6327c6fdc57ea0d6}\label{class_selection_scale_field_adc06e47379f2322e6327c6fdc57ea0d6}} 
void {\bfseries value\+Change} (bool add\+To\+Undo)
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_selection_scale_field_a1543e0d9b3df9ce4a842ba0d95e681c2}{Selection\+Scale\+Field}} (\mbox{\hyperlink{class_selection_tool}{Selection\+Tool}} $\ast$tool, int action\+Id, QString name)
\item 
void \mbox{\hyperlink{class_selection_scale_field_adf090832ea1ab6d182723670ac55c2f2}{update\+Status}} ()
\item 
bool \mbox{\hyperlink{class_selection_scale_field_aedf5d18031ce8496a6b6092dcad371e2}{apply\+Change}} (bool add\+To\+Undo=true)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Slots}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_selection_scale_field_a8ef917c6384c59dad5bae940b6eb2753}{on\+Change}} (\mbox{\hyperlink{class_t_measured_value}{TMeasured\+Value}} $\ast$fld, bool add\+To\+Undo=true)
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_selection_scale_field_a1543e0d9b3df9ce4a842ba0d95e681c2}\label{class_selection_scale_field_a1543e0d9b3df9ce4a842ba0d95e681c2}} 
\index{SelectionScaleField@{SelectionScaleField}!SelectionScaleField@{SelectionScaleField}}
\index{SelectionScaleField@{SelectionScaleField}!SelectionScaleField@{SelectionScaleField}}
\doxysubsubsection{\texorpdfstring{SelectionScaleField()}{SelectionScaleField()}}
{\footnotesize\ttfamily Selection\+Scale\+Field\+::\+Selection\+Scale\+Field (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_selection_tool}{Selection\+Tool}} $\ast$}]{tool,  }\item[{int}]{action\+Id,  }\item[{QString}]{name }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01243     : \mbox{\hyperlink{class_measured_value_field}{MeasuredValueField}}(0, name), m\_tool(tool), m\_id(\textcolor{keywordtype}{id}) \{}
\DoxyCodeLine{01244   \textcolor{keywordtype}{bool} ret = connect(\textcolor{keyword}{this}, SIGNAL(measuredValueChanged(\mbox{\hyperlink{class_t_measured_value}{TMeasuredValue}} *, \textcolor{keywordtype}{bool})),}
\DoxyCodeLine{01245                      SLOT(onChange(\mbox{\hyperlink{class_t_measured_value}{TMeasuredValue}} *, \textcolor{keywordtype}{bool})));}
\DoxyCodeLine{01246   assert(ret);}
\DoxyCodeLine{01247   setMeasure(\textcolor{stringliteral}{"{}scale"{}});}
\DoxyCodeLine{01248   updateStatus();}
\DoxyCodeLine{01249 }
\DoxyCodeLine{01250   setMaximumWidth(getMaximumWidthForSelectionToolField(\textcolor{keyword}{this}));}
\DoxyCodeLine{01251 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_selection_scale_field_a73f8d47ac02d3bd70b05cc12e0a16a2d}\label{class_selection_scale_field_a73f8d47ac02d3bd70b05cc12e0a16a2d}} 
\index{SelectionScaleField@{SelectionScaleField}!````~SelectionScaleField@{$\sim$SelectionScaleField}}
\index{````~SelectionScaleField@{$\sim$SelectionScaleField}!SelectionScaleField@{SelectionScaleField}}
\doxysubsubsection{\texorpdfstring{$\sim$SelectionScaleField()}{~SelectionScaleField()}}
{\footnotesize\ttfamily Selection\+Scale\+Field\+::$\sim$\+Selection\+Scale\+Field (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00495 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_selection_scale_field_aedf5d18031ce8496a6b6092dcad371e2}\label{class_selection_scale_field_aedf5d18031ce8496a6b6092dcad371e2}} 
\index{SelectionScaleField@{SelectionScaleField}!applyChange@{applyChange}}
\index{applyChange@{applyChange}!SelectionScaleField@{SelectionScaleField}}
\doxysubsubsection{\texorpdfstring{applyChange()}{applyChange()}}
{\footnotesize\ttfamily bool Selection\+Scale\+Field\+::apply\+Change (\begin{DoxyParamCaption}\item[{bool}]{add\+To\+Undo = {\ttfamily true} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01255                                                     \{}
\DoxyCodeLine{01256   \textcolor{keywordflow}{if} (!m\_tool || (m\_tool-\/>isSelectionEmpty() \&\& !m\_tool-\/>isLevelType()))}
\DoxyCodeLine{01257     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{01258   \textcolor{keyword}{using namespace }DragSelectionTool;}
\DoxyCodeLine{01259   \mbox{\hyperlink{class_drag_selection_tool_1_1_drag_tool}{DragTool}} *scaleTool = createNewScaleTool(m\_tool, ScaleType::GLOBAL);}
\DoxyCodeLine{01260   \textcolor{keywordtype}{double} p            = getValue();}
\DoxyCodeLine{01261   \textcolor{keywordflow}{if} (p == 0) p = 0.00001;}
\DoxyCodeLine{01262   \mbox{\hyperlink{class_drag_selection_tool_1_1_four_points}{FourPoints}} points = m\_tool-\/>getBBox();}
\DoxyCodeLine{01263   \mbox{\hyperlink{class_t_point_t}{TPointD}} center    = m\_tool-\/>getCenter();}
\DoxyCodeLine{01264   \mbox{\hyperlink{class_t_point_t}{TPointD}} p0M       = points.\mbox{\hyperlink{class_drag_selection_tool_1_1_four_points_a6ee06390172fb31fa17e80273c947f4c}{getPoint}}(7);}
\DoxyCodeLine{01265   \mbox{\hyperlink{class_t_point_t}{TPointD}} p1M       = points.\mbox{\hyperlink{class_drag_selection_tool_1_1_four_points_a6ee06390172fb31fa17e80273c947f4c}{getPoint}}(5);}
\DoxyCodeLine{01266   \mbox{\hyperlink{class_t_point_t}{TPointD}} pM1       = points.\mbox{\hyperlink{class_drag_selection_tool_1_1_four_points_a6ee06390172fb31fa17e80273c947f4c}{getPoint}}(6);}
\DoxyCodeLine{01267   \mbox{\hyperlink{class_t_point_t}{TPointD}} pM0       = points.\mbox{\hyperlink{class_drag_selection_tool_1_1_four_points_a6ee06390172fb31fa17e80273c947f4c}{getPoint}}(4);}
\DoxyCodeLine{01268   \textcolor{keywordtype}{int} pointIndex;}
\DoxyCodeLine{01269   \mbox{\hyperlink{class_t_point_t}{TPointD}} \mbox{\hyperlink{namespacetcg_1_1numeric__ops_abd17f65a269ec069dc06d0f97e41fb77}{sign}}(1, 1);}
\DoxyCodeLine{01270   \mbox{\hyperlink{class_t_point_t}{TPointD}} scaleFactor = m\_tool-\/>m\_deformValues.m\_scaleValue;}
\DoxyCodeLine{01271   \mbox{\hyperlink{class_t_point_t}{TPointD}} newPos;}
\DoxyCodeLine{01272   \textcolor{keywordflow}{if} (m\_id == 0) \{}
\DoxyCodeLine{01273     \textcolor{keywordflow}{if} (p1M == p0M) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{01274     pointIndex      = 7;}
\DoxyCodeLine{01275     \mbox{\hyperlink{class_t_point_t}{TPointD}} v       = normalize(p1M -\/ p0M);}
\DoxyCodeLine{01276     \textcolor{keywordtype}{double} currentD = tdistance(p1M, p0M);}
\DoxyCodeLine{01277     \textcolor{keywordtype}{double} startD   = currentD / scaleFactor.x;}
\DoxyCodeLine{01278     \textcolor{keywordtype}{double} d      = (currentD -\/ startD * p) * tdistance(center, p0M) / currentD;}
\DoxyCodeLine{01279     newPos        = \mbox{\hyperlink{class_t_point_t}{TPointD}}(p0M.x + d * v.x, p0M.y + d * v.y);}
\DoxyCodeLine{01280     scaleFactor.x = p;}
\DoxyCodeLine{01281   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_id == 1) \{}
\DoxyCodeLine{01282     \textcolor{keywordflow}{if} (pM1 == pM0) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{01283     pointIndex      = 4;}
\DoxyCodeLine{01284     \mbox{\hyperlink{class_t_point_t}{TPointD}} v       = normalize(pM1 -\/ pM0);}
\DoxyCodeLine{01285     \textcolor{keywordtype}{double} currentD = tdistance(pM1, pM0);}
\DoxyCodeLine{01286     \textcolor{keywordtype}{double} startD   = currentD / scaleFactor.y;}
\DoxyCodeLine{01287     \textcolor{keywordtype}{double} d      = (currentD -\/ startD * p) * tdistance(center, pM0) / currentD;}
\DoxyCodeLine{01288     newPos        = \mbox{\hyperlink{class_t_point_t}{TPointD}}(pM0.x + d * v.x, pM0.y + d * v.y);}
\DoxyCodeLine{01289     scaleFactor.y = p;}
\DoxyCodeLine{01290   \}}
\DoxyCodeLine{01291 }
\DoxyCodeLine{01292   m\_tool-\/>m\_deformValues.m\_scaleValue =}
\DoxyCodeLine{01293       scaleFactor;  \textcolor{comment}{// Instruction order is relevant}}
\DoxyCodeLine{01294   scaleTool-\/>transform(pointIndex,}
\DoxyCodeLine{01295                        newPos);  \textcolor{comment}{// This line invokes GUI update using the}}
\DoxyCodeLine{01296                                  \textcolor{comment}{// value set above}}
\DoxyCodeLine{01297   \textcolor{keywordflow}{if} (!m\_tool-\/>isLevelType() \&\& addToUndo) scaleTool-\/>addTransformUndo();}
\DoxyCodeLine{01298   setCursorPosition(0);}
\DoxyCodeLine{01299   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01300 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_selection_scale_field_a8ef917c6384c59dad5bae940b6eb2753}\label{class_selection_scale_field_a8ef917c6384c59dad5bae940b6eb2753}} 
\index{SelectionScaleField@{SelectionScaleField}!onChange@{onChange}}
\index{onChange@{onChange}!SelectionScaleField@{SelectionScaleField}}
\doxysubsubsection{\texorpdfstring{onChange}{onChange}}
{\footnotesize\ttfamily void Selection\+Scale\+Field\+::on\+Change (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_measured_value}{TMeasured\+Value}} $\ast$}]{fld,  }\item[{bool}]{add\+To\+Undo = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01304                                                                       \{}
\DoxyCodeLine{01305   \textcolor{keywordflow}{if} (!m\_tool-\/>isEnabled()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01306   \textcolor{keywordflow}{if} (!applyChange(addToUndo)) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01307   emit valueChange(addToUndo);}
\DoxyCodeLine{01308 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_selection_scale_field_adf090832ea1ab6d182723670ac55c2f2}\label{class_selection_scale_field_adf090832ea1ab6d182723670ac55c2f2}} 
\index{SelectionScaleField@{SelectionScaleField}!updateStatus@{updateStatus}}
\index{updateStatus@{updateStatus}!SelectionScaleField@{SelectionScaleField}}
\doxysubsubsection{\texorpdfstring{updateStatus()}{updateStatus()}}
{\footnotesize\ttfamily void Selection\+Scale\+Field\+::update\+Status (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01312                                        \{}
\DoxyCodeLine{01313   \textcolor{keywordflow}{if} (!m\_tool || !m\_tool-\/>isSelectionEditable() ||}
\DoxyCodeLine{01314       (m\_tool-\/>isSelectionEmpty() \&\& !m\_tool-\/>isLevelType())) \{}
\DoxyCodeLine{01315     setValue(0);}
\DoxyCodeLine{01316     setDisabled(\textcolor{keyword}{true});}
\DoxyCodeLine{01317     \textcolor{keywordflow}{return};}
\DoxyCodeLine{01318   \}}
\DoxyCodeLine{01319   setDisabled(\textcolor{keyword}{false});}
\DoxyCodeLine{01320   \textcolor{keywordflow}{if} (m\_id == 0)}
\DoxyCodeLine{01321     setValue(m\_tool-\/>m\_deformValues.m\_scaleValue.x);}
\DoxyCodeLine{01322   \textcolor{keywordflow}{else}}
\DoxyCodeLine{01323     setValue(m\_tool-\/>m\_deformValues.m\_scaleValue.y);}
\DoxyCodeLine{01324   setCursorPosition(0);}
\DoxyCodeLine{01325 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/tnztools/tooloptionscontrols.\+h\item 
E\+:/opentoonz/toonz/sources/tnztools/tooloptionscontrols.\+cpp\end{DoxyCompactItemize}
