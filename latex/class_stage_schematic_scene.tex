\hypertarget{class_stage_schematic_scene}{}\doxysection{Stage\+Schematic\+Scene Class Reference}
\label{class_stage_schematic_scene}\index{StageSchematicScene@{StageSchematicScene}}


{\ttfamily \#include $<$stageschematicscene.\+h$>$}

Inheritance diagram for Stage\+Schematic\+Scene\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_stage_schematic_scene}
\end{center}
\end{figure}
\doxysubsection*{Signals}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_stage_schematic_scene_a5f99da76af783634a410268e2549530d}\label{class_stage_schematic_scene_a5f99da76af783634a410268e2549530d}} 
void {\bfseries edit\+Object} ()
\item 
\mbox{\Hypertarget{class_stage_schematic_scene_abb10d95066e930f4f3219b020b028985}\label{class_stage_schematic_scene_abb10d95066e930f4f3219b020b028985}} 
void {\bfseries do\+Collapse} (QList$<$ \mbox{\hyperlink{class_t_stage_object_id}{TStage\+Object\+Id}} $>$)
\item 
\mbox{\Hypertarget{class_stage_schematic_scene_a4298ca07ed7f6e276f0e9789f84d46dd}\label{class_stage_schematic_scene_a4298ca07ed7f6e276f0e9789f84d46dd}} 
void {\bfseries do\+Explode\+Child} (QList$<$ \mbox{\hyperlink{class_t_stage_object_id}{TStage\+Object\+Id}} $>$)
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_stage_schematic_scene_ae7fac4c94c034aac117f4394ffbd0153}{Stage\+Schematic\+Scene}} (QWidget $\ast$parent)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a6e3778c802f4b08489465b6e6479b68b}{update\+Scene}} () override
\begin{DoxyCompactList}\small\item\em Clear all item an regenerate the \mbox{\hyperlink{namespace_stage}{Stage}} Schematic graph. \end{DoxyCompactList}\item 
QGraphics\+Item $\ast$ \mbox{\hyperlink{class_stage_schematic_scene_acf161972df71baccbb940c9325ca3164}{get\+Current\+Node}} () override
\begin{DoxyCompactList}\small\item\em Reurns the current node. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_stage_schematic_scene_afe1eae02907240cb91687310b0dca5bc}{reorder\+Scene}} () override
\begin{DoxyCompactList}\small\item\em Replace all nodes in the scene. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$ \mbox{\hyperlink{class_stage_schematic_scene_ad742570feba53072d118107291ae0f1f}{get\+Xsheet}} ()
\item 
\mbox{\hyperlink{class_t_xsheet_handle}{TXsheet\+Handle}} $\ast$ \mbox{\hyperlink{class_stage_schematic_scene_a81d76a1b816b758fe8f0de1de15669d5}{get\+Xsheet\+Handle}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a6d4c74a581f83fc1e28fe5ef7678eb69}{set\+Xsheet\+Handle}} (\mbox{\hyperlink{class_t_xsheet_handle}{TXsheet\+Handle}} $\ast$xsh\+Handle)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a98fd41a2249eb3d5aa3f9d35ef5bb1e0}{set\+Object\+Handle}} (\mbox{\hyperlink{class_t_object_handle}{TObject\+Handle}} $\ast$obj\+Handle)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a1f850acb49955bce922dbb44dd0f66c4}{set\+Column\+Handle}} (\mbox{\hyperlink{class_t_column_handle}{TColumn\+Handle}} $\ast$col\+Handle)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a1e3c2ddd2a0122d351aa1ff3407eadac}{set\+Fx\+Handle}} (\mbox{\hyperlink{class_t_fx_handle}{TFx\+Handle}} $\ast$fx\+Handle)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_ac2537e009a6faff1efd2cc81cb1c876a}{set\+Scene\+Handle}} (\mbox{\hyperlink{class_t_scene_handle}{TScene\+Handle}} $\ast$scene\+Handle)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_aaf49cdda711d4d0fbbd417e497bd2e7d}{set\+Frame\+Handle}} (\mbox{\hyperlink{class_t_frame_handle}{TFrame\+Handle}} $\ast$frame\+Handle)
\item 
\mbox{\hyperlink{class_t_stage_object_id}{TStage\+Object\+Id}} \mbox{\hyperlink{class_stage_schematic_scene_a2e37d0bd8208fd551306d256a0894da1}{get\+Current\+Object}} ()
\item 
\mbox{\hyperlink{class_t_frame_handle}{TFrame\+Handle}} $\ast$ \mbox{\hyperlink{class_stage_schematic_scene_ad49ea2bc824ff8bc72cba1a2e7e331c5}{get\+Frame\+Handle}} ()
\item 
\mbox{\hyperlink{class_t_column_handle}{TColumn\+Handle}} $\ast$ \mbox{\hyperlink{class_stage_schematic_scene_a60011702ed23954b78a09da274b0bbd3}{get\+Column\+Handle}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a7941bbbf725e9bc4f4d77d158fa69248}{update\+Nested\+Group\+Editors}} (\mbox{\hyperlink{class_stage_schematic_node}{Stage\+Schematic\+Node}} $\ast$node, const QPointF \&new\+Pos)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a7a7a0dc1a46a39dd0a894707fa38c91d}{resize\+Nodes}} (bool maximized\+Node)
\item 
bool \mbox{\hyperlink{class_stage_schematic_scene_adfe6d944ae0bb150365a8033e9179b70}{is\+Show\+Letter\+On\+Port\+Flag\+Enabled}} ()
\item 
\mbox{\hyperlink{class_schematic_viewer}{Schematic\+Viewer}} $\ast$ \mbox{\hyperlink{class_stage_schematic_scene_af853dcbd3ac0fd6aa6055667839448a3}{get\+Schematic\+Viewer}} ()
\item 
\mbox{\hyperlink{class_stage_object_selection}{Stage\+Object\+Selection}} $\ast$ \mbox{\hyperlink{class_stage_schematic_scene_af6dece2b58ea00fd1b5308d3b52a7bc3}{get\+Stage\+Selection}} () const
\end{DoxyCompactItemize}
\doxysubsection*{Protected Slots}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a15b750ec16f3ab994755b8b1276474f1}{on\+Selection\+Switched}} (\mbox{\hyperlink{class_t_selection}{TSelection}} $\ast$old\+Sel, \mbox{\hyperlink{class_t_selection}{TSelection}} $\ast$new\+Sel) override
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_aa4ae3bc0a606c1135f28644b741ee423}{on\+Pegbar\+Added}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a6430be8da3267407a4c79a5387af7c93}{on\+Spline\+Added}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_ae61f823a8b4db91ec5275e5a65722ebf}{on\+Camera\+Added}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_aaa4236609d6c1642b4ba5ec0a9379447}{on\+Reset\+Center}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a3ce9364bb6e41fd7acef2b0c982c59f1}{on\+Camera\+Activate}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a38b7b249a84fb6fcb1bcc8d0be3a9803}{on\+Remove\+Spline}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_ae184c7bca007cc029ad082fbe648472d}{on\+Save\+Spline}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_ac133d3c474f76cd27e5fecac63daa8f0}{on\+Load\+Spline}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a4550f415cbf29ab78ecee6be67caf7a0}{on\+Path\+Toggled}} (int state)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a6bb546c114e1a90483d1c62bf645514d}{on\+Cp\+Toggled}} (bool toggled)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a99169f6f1a1f25060a13718c5f6b352d}{on\+Xsheet\+Changed}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a9f0f4254b5f4f24f2c0e2c813831bade}{on\+Scene\+Changed}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a3929a807ce21d7d10e07f2f69e76af52}{on\+Current\+Object\+Changed}} (const \mbox{\hyperlink{class_t_stage_object_id}{TStage\+Object\+Id}} \&, bool)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_adf84cfe9dac857e531637aac566acddd}{on\+Current\+Column\+Changed}} (int)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a20a32e02938d1dcc81a820127c350036}{on\+Selection\+Changed}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a00783dea860d53016e24d7fa4e7b2815}{on\+Collapse}} (QList$<$ \mbox{\hyperlink{class_t_stage_object_id}{TStage\+Object\+Id}} $>$)
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a5f02858487e62b2d6ea3839756361223}{on\+Edit\+Group}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a6e8aecdc851b38adfd8584c460a7a651}{on\+Node\+Changed\+Size}} ()
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a030725eec5809b026a984412da77282f}{on\+Switch\+Port\+Mode\+Toggled}} (bool with\+Letter)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a3dd44393a061d35f524fe86adf1b7b29}{context\+Menu\+Event}} (QGraphics\+Scene\+Context\+Menu\+Event $\ast$cme) override
\item 
void \mbox{\hyperlink{class_stage_schematic_scene_a7bcda96e85cfc4a19cd5863906d62fd8}{mouse\+Press\+Event}} (QGraphics\+Scene\+Mouse\+Event $\ast$me) override
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
It is the implementation of the \mbox{\hyperlink{class_schematic_scene}{Schematic\+Scene}} representig the QGraphics\+Scene for the \mbox{\hyperlink{namespace_stage}{Stage}} Schematic. All \mbox{\hyperlink{class_stage_schematic_node}{Stage\+Schematic\+Node}}, \mbox{\hyperlink{class_stage_schematic_spline_node}{Stage\+Schematic\+Spline\+Node}} and link are pleced and handled in this scene. The scene maintains two mapping\+: one for \mbox{\hyperlink{class_stage_schematic_node}{Stage\+Schematic\+Node}} and one for \mbox{\hyperlink{class_stage_schematic_spline_node}{Stage\+Schematic\+Spline\+Node}}. These mapping can be used to retrieve nodes and spline.~\newline
To regenearte the scene use the \mbox{\hyperlink{class_stage_schematic_scene_a6e3778c802f4b08489465b6e6479b68b}{update\+Scene()}}.~\newline
To oreder nodes in the scene use the \mbox{\hyperlink{class_stage_schematic_scene_afe1eae02907240cb91687310b0dca5bc}{reorder\+Scene()}}. 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_stage_schematic_scene_ae7fac4c94c034aac117f4394ffbd0153}\label{class_stage_schematic_scene_ae7fac4c94c034aac117f4394ffbd0153}} 
\index{StageSchematicScene@{StageSchematicScene}!StageSchematicScene@{StageSchematicScene}}
\index{StageSchematicScene@{StageSchematicScene}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{StageSchematicScene()}{StageSchematicScene()}}
{\footnotesize\ttfamily Stage\+Schematic\+Scene\+::\+Stage\+Schematic\+Scene (\begin{DoxyParamCaption}\item[{QWidget $\ast$}]{parent }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00134     : \mbox{\hyperlink{class_schematic_scene}{SchematicScene}}(parent)}
\DoxyCodeLine{00135     , m\_nextNodePos(0, 0)}
\DoxyCodeLine{00136     , m\_xshHandle(0)}
\DoxyCodeLine{00137     , m\_objHandle(0)}
\DoxyCodeLine{00138     , m\_colHandle(0)}
\DoxyCodeLine{00139     , m\_sceneHandle(0)}
\DoxyCodeLine{00140     , m\_frameHandle(0)}
\DoxyCodeLine{00141     , m\_gridDimension(eSmall)}
\DoxyCodeLine{00142     , m\_showLetterOnPortFlag(ShowLetterOnOutputPortOfStageNode != 0)}
\DoxyCodeLine{00143     , m\_viewer() \{}
\DoxyCodeLine{00144   m\_viewer = (\mbox{\hyperlink{class_schematic_viewer}{SchematicViewer}} *)parent;}
\DoxyCodeLine{00145 }
\DoxyCodeLine{00146   QPointF sceneCenter = sceneRect().center();}
\DoxyCodeLine{00147   m\_firstPos          = \mbox{\hyperlink{class_t_point_t}{TPointD}}(sceneCenter.x(), sceneCenter.y());}
\DoxyCodeLine{00148 }
\DoxyCodeLine{00149   m\_selection = \textcolor{keyword}{new} \mbox{\hyperlink{class_stage_object_selection}{StageObjectSelection}}();}
\DoxyCodeLine{00150   connect(m\_selection, SIGNAL(doCollapse(QList<TStageObjectId>)), \textcolor{keyword}{this},}
\DoxyCodeLine{00151           SLOT(onCollapse(QList<TStageObjectId>)));}
\DoxyCodeLine{00152   connect(m\_selection, SIGNAL(doExplodeChild(QList<TStageObjectId>)), \textcolor{keyword}{this},}
\DoxyCodeLine{00153           SIGNAL(doExplodeChild(QList<TStageObjectId>)));}
\DoxyCodeLine{00154   connect(\textcolor{keyword}{this}, SIGNAL(selectionChanged()), \textcolor{keyword}{this}, SLOT(onSelectionChanged()));}
\DoxyCodeLine{00155   m\_highlightedLinks.clear();}
\DoxyCodeLine{00156 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_aada9746d98256ce15bffa1a152c44771}\label{class_stage_schematic_scene_aada9746d98256ce15bffa1a152c44771}} 
\index{StageSchematicScene@{StageSchematicScene}!````~StageSchematicScene@{$\sim$StageSchematicScene}}
\index{````~StageSchematicScene@{$\sim$StageSchematicScene}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{$\sim$StageSchematicScene()}{~StageSchematicScene()}}
{\footnotesize\ttfamily Stage\+Schematic\+Scene\+::$\sim$\+Stage\+Schematic\+Scene (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00160 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_stage_schematic_scene_a3dd44393a061d35f524fe86adf1b7b29}\label{class_stage_schematic_scene_a3dd44393a061d35f524fe86adf1b7b29}} 
\index{StageSchematicScene@{StageSchematicScene}!contextMenuEvent@{contextMenuEvent}}
\index{contextMenuEvent@{contextMenuEvent}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{contextMenuEvent()}{contextMenuEvent()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::context\+Menu\+Event (\begin{DoxyParamCaption}\item[{QGraphics\+Scene\+Context\+Menu\+Event $\ast$}]{cme }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01124                                          \{}
\DoxyCodeLine{01125   QPointF scenePos                = cme-\/>scenePos();}
\DoxyCodeLine{01126   QList<QGraphicsItem *> itemList = items(scenePos);}
\DoxyCodeLine{01127   \textcolor{keywordflow}{if} (!itemList.isEmpty()) \{}
\DoxyCodeLine{01128     SchematicScene::contextMenuEvent(cme);}
\DoxyCodeLine{01129     \textcolor{keywordflow}{return};}
\DoxyCodeLine{01130   \}}
\DoxyCodeLine{01131 }
\DoxyCodeLine{01132   QMenu menu(views()[0]);}
\DoxyCodeLine{01133 }
\DoxyCodeLine{01134   \textcolor{comment}{// AddPegbar}}
\DoxyCodeLine{01135   QAction *addPegbar = \textcolor{keyword}{new} QAction(tr(\textcolor{stringliteral}{"{}\&New Pegbar"{}}), \&menu);}
\DoxyCodeLine{01136   connect(addPegbar, SIGNAL(triggered()), \textcolor{keyword}{this}, SLOT(onPegbarAdded()));}
\DoxyCodeLine{01137 }
\DoxyCodeLine{01138   \textcolor{comment}{// AddSpline}}
\DoxyCodeLine{01139   QAction *addSpline = \textcolor{keyword}{new} QAction(tr(\textcolor{stringliteral}{"{}\&New Motion Path"{}}), \&menu);}
\DoxyCodeLine{01140   connect(addSpline, SIGNAL(triggered()), \textcolor{keyword}{this}, SLOT(onSplineAdded()));}
\DoxyCodeLine{01141 }
\DoxyCodeLine{01142   \textcolor{comment}{// AddCamera}}
\DoxyCodeLine{01143   QAction *addCamera = \textcolor{keyword}{new} QAction(tr(\textcolor{stringliteral}{"{}\&New Camera"{}}), \&menu);}
\DoxyCodeLine{01144   connect(addCamera, SIGNAL(triggered()), \textcolor{keyword}{this}, SLOT(onCameraAdded()));}
\DoxyCodeLine{01145 }
\DoxyCodeLine{01146   QAction *paste = CommandManager::instance()-\/>getAction(\textcolor{stringliteral}{"{}MI\_Paste"{}});}
\DoxyCodeLine{01147 }
\DoxyCodeLine{01148   \textcolor{comment}{// this is to place the node at the clicked position}}
\DoxyCodeLine{01149   addPegbar-\/>setData(cme-\/>scenePos());}
\DoxyCodeLine{01150   addSpline-\/>setData(cme-\/>scenePos());}
\DoxyCodeLine{01151   addCamera-\/>setData(cme-\/>scenePos());}
\DoxyCodeLine{01152 }
\DoxyCodeLine{01153   menu.addAction(addPegbar);}
\DoxyCodeLine{01154   menu.addAction(addCamera);}
\DoxyCodeLine{01155   menu.addAction(addSpline);}
\DoxyCodeLine{01156 }
\DoxyCodeLine{01157   \textcolor{comment}{// Close sub xsheet and move to parent sheet}}
\DoxyCodeLine{01158   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene      = m\_sceneHandle-\/>getScene();}
\DoxyCodeLine{01159   \mbox{\hyperlink{class_child_stack}{ChildStack}} *childStack = scene-\/>\mbox{\hyperlink{class_toonz_scene_ae2cbc582144c92adc5076cd5f556c95a}{getChildStack}}();}
\DoxyCodeLine{01160   \textcolor{keywordflow}{if} (childStack \&\& childStack-\/>\mbox{\hyperlink{class_child_stack_adf32015ee9da2ea3255ba9bd2597f899}{getAncestorCount}}() > 0) \{}
\DoxyCodeLine{01161     menu.addSeparator();}
\DoxyCodeLine{01162     menu.addAction(CommandManager::instance()-\/>getAction(\textcolor{stringliteral}{"{}MI\_CloseChild"{}}));}
\DoxyCodeLine{01163   \}}
\DoxyCodeLine{01164 }
\DoxyCodeLine{01165   menu.addSeparator();}
\DoxyCodeLine{01166   menu.addAction(paste);}
\DoxyCodeLine{01167   m\_selection-\/>setPastePosition(\mbox{\hyperlink{class_t_point_t}{TPointD}}(scenePos.x(), scenePos.y()));}
\DoxyCodeLine{01168   menu.exec(cme-\/>screenPos());}
\DoxyCodeLine{01169 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a60011702ed23954b78a09da274b0bbd3}\label{class_stage_schematic_scene_a60011702ed23954b78a09da274b0bbd3}} 
\index{StageSchematicScene@{StageSchematicScene}!getColumnHandle@{getColumnHandle}}
\index{getColumnHandle@{getColumnHandle}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{getColumnHandle()}{getColumnHandle()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_column_handle}{TColumn\+Handle}} $\ast$ Stage\+Schematic\+Scene\+::get\+Column\+Handle (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00133 \{ \textcolor{keywordflow}{return} m\_colHandle; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_acf161972df71baccbb940c9325ca3164}\label{class_stage_schematic_scene_acf161972df71baccbb940c9325ca3164}} 
\index{StageSchematicScene@{StageSchematicScene}!getCurrentNode@{getCurrentNode}}
\index{getCurrentNode@{getCurrentNode}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{getCurrentNode()}{getCurrentNode()}}
{\footnotesize\ttfamily QGraphics\+Item $\ast$ Stage\+Schematic\+Scene\+::get\+Current\+Node (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reurns the current node. 



Reimplemented from \mbox{\hyperlink{class_schematic_scene}{Schematic\+Scene}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00660                                                    \{}
\DoxyCodeLine{00661   QList<QGraphicsItem *> allItems = items();}
\DoxyCodeLine{00662 }
\DoxyCodeLine{00663   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \textcolor{keyword}{const} item : allItems) \{}
\DoxyCodeLine{00664     \mbox{\hyperlink{class_stage_schematic_node}{StageSchematicNode}} *node = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_stage_schematic_node}{StageSchematicNode}} *\textcolor{keyword}{>}(item);}
\DoxyCodeLine{00665     \textcolor{keywordflow}{if} (node \&\& node-\/>getStageObject()-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}() == m\_objHandle-\/>getObjectId())}
\DoxyCodeLine{00666       \textcolor{keywordflow}{return} node;}
\DoxyCodeLine{00667   \}}
\DoxyCodeLine{00668   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00669 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00520}{TStage\+Object\+::get\+Id()}}.

\mbox{\Hypertarget{class_stage_schematic_scene_a2e37d0bd8208fd551306d256a0894da1}\label{class_stage_schematic_scene_a2e37d0bd8208fd551306d256a0894da1}} 
\index{StageSchematicScene@{StageSchematicScene}!getCurrentObject@{getCurrentObject}}
\index{getCurrentObject@{getCurrentObject}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{getCurrentObject()}{getCurrentObject()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_stage_object_id}{TStage\+Object\+Id}} Stage\+Schematic\+Scene\+::get\+Current\+Object (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01261                                                      \{}
\DoxyCodeLine{01262   \textcolor{keywordflow}{return} m\_objHandle-\/>getObjectId();}
\DoxyCodeLine{01263 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_ad49ea2bc824ff8bc72cba1a2e7e331c5}\label{class_stage_schematic_scene_ad49ea2bc824ff8bc72cba1a2e7e331c5}} 
\index{StageSchematicScene@{StageSchematicScene}!getFrameHandle@{getFrameHandle}}
\index{getFrameHandle@{getFrameHandle}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{getFrameHandle()}{getFrameHandle()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_frame_handle}{TFrame\+Handle}} $\ast$ Stage\+Schematic\+Scene\+::get\+Frame\+Handle (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00132 \{ \textcolor{keywordflow}{return} m\_frameHandle; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_af853dcbd3ac0fd6aa6055667839448a3}\label{class_stage_schematic_scene_af853dcbd3ac0fd6aa6055667839448a3}} 
\index{StageSchematicScene@{StageSchematicScene}!getSchematicViewer@{getSchematicViewer}}
\index{getSchematicViewer@{getSchematicViewer}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{getSchematicViewer()}{getSchematicViewer()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_schematic_viewer}{Schematic\+Viewer}} $\ast$ Stage\+Schematic\+Scene\+::get\+Schematic\+Viewer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00140 \{ \textcolor{keywordflow}{return} m\_viewer; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_af6dece2b58ea00fd1b5308d3b52a7bc3}\label{class_stage_schematic_scene_af6dece2b58ea00fd1b5308d3b52a7bc3}} 
\index{StageSchematicScene@{StageSchematicScene}!getStageSelection@{getStageSelection}}
\index{getStageSelection@{getStageSelection}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{getStageSelection()}{getStageSelection()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_stage_object_selection}{Stage\+Object\+Selection}} $\ast$ Stage\+Schematic\+Scene\+::get\+Stage\+Selection (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00142 \{ \textcolor{keywordflow}{return} m\_selection; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_ad742570feba53072d118107291ae0f1f}\label{class_stage_schematic_scene_ad742570feba53072d118107291ae0f1f}} 
\index{StageSchematicScene@{StageSchematicScene}!getXsheet@{getXsheet}}
\index{getXsheet@{getXsheet}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{getXsheet()}{getXsheet()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$ Stage\+Schematic\+Scene\+::get\+Xsheet (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01085 \{ \textcolor{keywordflow}{return} m\_xshHandle-\/>getXsheet(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a81d76a1b816b758fe8f0de1de15669d5}\label{class_stage_schematic_scene_a81d76a1b816b758fe8f0de1de15669d5}} 
\index{StageSchematicScene@{StageSchematicScene}!getXsheetHandle@{getXsheetHandle}}
\index{getXsheetHandle@{getXsheetHandle}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{getXsheetHandle()}{getXsheetHandle()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_xsheet_handle}{TXsheet\+Handle}} $\ast$ Stage\+Schematic\+Scene\+::get\+Xsheet\+Handle (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00119 \{ \textcolor{keywordflow}{return} m\_xshHandle; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_adfe6d944ae0bb150365a8033e9179b70}\label{class_stage_schematic_scene_adfe6d944ae0bb150365a8033e9179b70}} 
\index{StageSchematicScene@{StageSchematicScene}!isShowLetterOnPortFlagEnabled@{isShowLetterOnPortFlagEnabled}}
\index{isShowLetterOnPortFlagEnabled@{isShowLetterOnPortFlagEnabled}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{isShowLetterOnPortFlagEnabled()}{isShowLetterOnPortFlagEnabled()}}
{\footnotesize\ttfamily bool Stage\+Schematic\+Scene\+::is\+Show\+Letter\+On\+Port\+Flag\+Enabled (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00138 \{ \textcolor{keywordflow}{return} m\_showLetterOnPortFlag; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a7bcda96e85cfc4a19cd5863906d62fd8}\label{class_stage_schematic_scene_a7bcda96e85cfc4a19cd5863906d62fd8}} 
\index{StageSchematicScene@{StageSchematicScene}!mousePressEvent@{mousePressEvent}}
\index{mousePressEvent@{mousePressEvent}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{mousePressEvent()}{mousePressEvent()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::mouse\+Press\+Event (\begin{DoxyParamCaption}\item[{QGraphics\+Scene\+Mouse\+Event $\ast$}]{me }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01173                                                                       \{}
\DoxyCodeLine{01174   QList<QGraphicsItem *> items = selectedItems();}
\DoxyCodeLine{01175   SchematicScene::mousePressEvent(me);}
\DoxyCodeLine{01176   \textcolor{keywordflow}{if} (me-\/>button() == Qt::MidButton) \{}
\DoxyCodeLine{01177     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{01178     \textcolor{keywordflow}{for} (i = 0; i < items.size(); i++) items[i]-\/>setSelected(\textcolor{keyword}{true});}
\DoxyCodeLine{01179   \}}
\DoxyCodeLine{01180 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a3ce9364bb6e41fd7acef2b0c982c59f1}\label{class_stage_schematic_scene_a3ce9364bb6e41fd7acef2b0c982c59f1}} 
\index{StageSchematicScene@{StageSchematicScene}!onCameraActivate@{onCameraActivate}}
\index{onCameraActivate@{onCameraActivate}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onCameraActivate}{onCameraActivate}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Camera\+Activate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00981                                            \{}
\DoxyCodeLine{00982   TStageObjectCmd::setAsActiveCamera(m\_xshHandle, m\_objHandle);}
\DoxyCodeLine{00983 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_ae61f823a8b4db91ec5275e5a65722ebf}\label{class_stage_schematic_scene_ae61f823a8b4db91ec5275e5a65722ebf}} 
\index{StageSchematicScene@{StageSchematicScene}!onCameraAdded@{onCameraAdded}}
\index{onCameraAdded@{onCameraAdded}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onCameraAdded}{onCameraAdded}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Camera\+Added (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00955                                         \{}
\DoxyCodeLine{00956   \textcolor{comment}{// if this command called from the context menu, place the node at the}}
\DoxyCodeLine{00957   \textcolor{comment}{// cllicked position}}
\DoxyCodeLine{00958   \textcolor{comment}{// clickedPos will be null(0,0) if it called from the toolbar}}
\DoxyCodeLine{00959   QPointF clickedPos = qobject\_cast<QAction *>(sender())-\/>data().toPointF();}
\DoxyCodeLine{00960 }
\DoxyCodeLine{00961   TStageObjectCmd::addNewCamera(m\_xshHandle, m\_objHandle, clickedPos);}
\DoxyCodeLine{00962 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a00783dea860d53016e24d7fa4e7b2815}\label{class_stage_schematic_scene_a00783dea860d53016e24d7fa4e7b2815}} 
\index{StageSchematicScene@{StageSchematicScene}!onCollapse@{onCollapse}}
\index{onCollapse@{onCollapse}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onCollapse}{onCollapse}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Collapse (\begin{DoxyParamCaption}\item[{QList$<$ \mbox{\hyperlink{class_t_stage_object_id}{TStage\+Object\+Id}} $>$}]{objects }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01241                                                                   \{}
\DoxyCodeLine{01242   emit doCollapse(objects);}
\DoxyCodeLine{01243 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a6bb546c114e1a90483d1c62bf645514d}\label{class_stage_schematic_scene_a6bb546c114e1a90483d1c62bf645514d}} 
\index{StageSchematicScene@{StageSchematicScene}!onCpToggled@{onCpToggled}}
\index{onCpToggled@{onCpToggled}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onCpToggled}{onCpToggled}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Cp\+Toggled (\begin{DoxyParamCaption}\item[{bool}]{toggled }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01076                                                   \{}
\DoxyCodeLine{01077   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} objId = m\_objHandle-\/>getObjectId();}
\DoxyCodeLine{01078   \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *obj    = m\_xshHandle-\/>getXsheet()-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(objId);}
\DoxyCodeLine{01079   TStageObjectCmd::enableSplineUppk(obj, toggled, m\_xshHandle);}
\DoxyCodeLine{01080   update();}
\DoxyCodeLine{01081 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_adf84cfe9dac857e531637aac566acddd}\label{class_stage_schematic_scene_adf84cfe9dac857e531637aac566acddd}} 
\index{StageSchematicScene@{StageSchematicScene}!onCurrentColumnChanged@{onCurrentColumnChanged}}
\index{onCurrentColumnChanged@{onCurrentColumnChanged}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onCurrentColumnChanged}{onCurrentColumnChanged}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Current\+Column\+Changed (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01117                                                           \{}
\DoxyCodeLine{01118   m\_colHandle-\/>setColumnIndex(index);}
\DoxyCodeLine{01119 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a3929a807ce21d7d10e07f2f69e76af52}\label{class_stage_schematic_scene_a3929a807ce21d7d10e07f2f69e76af52}} 
\index{StageSchematicScene@{StageSchematicScene}!onCurrentObjectChanged@{onCurrentObjectChanged}}
\index{onCurrentObjectChanged@{onCurrentObjectChanged}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onCurrentObjectChanged}{onCurrentObjectChanged}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Current\+Object\+Changed (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_stage_object_id}{TStage\+Object\+Id}} \&}]{id,  }\item[{bool}]{is\+Spline }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01102                                                                 \{}
\DoxyCodeLine{01103   \textcolor{comment}{// revert the pre-\/selected node to normal text color}}
\DoxyCodeLine{01104   QMap<TStageObjectId, StageSchematicNode *>::iterator it;}
\DoxyCodeLine{01105   it = m\_nodeTable.find(getCurrentObject());}
\DoxyCodeLine{01106   \textcolor{keywordflow}{if} (it != m\_nodeTable.end()) \{}
\DoxyCodeLine{01107     it.value()-\/>update();}
\DoxyCodeLine{01108   \}}
\DoxyCodeLine{01109 }
\DoxyCodeLine{01110   m\_objHandle-\/>setObjectId(\textcolor{keywordtype}{id});}
\DoxyCodeLine{01111   \textcolor{keywordflow}{if} (m\_frameHandle-\/>isEditingLevel()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01112   m\_objHandle-\/>setIsSpline(isSpline);}
\DoxyCodeLine{01113 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a5f02858487e62b2d6ea3839756361223}\label{class_stage_schematic_scene_a5f02858487e62b2d6ea3839756361223}} 
\index{StageSchematicScene@{StageSchematicScene}!onEditGroup@{onEditGroup}}
\index{onEditGroup@{onEditGroup}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onEditGroup}{onEditGroup}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Edit\+Group (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01247                                       \{}
\DoxyCodeLine{01248   \textcolor{keywordflow}{if} (m\_selection-\/>isEmpty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01249   \mbox{\hyperlink{class_t_stage_object_tree}{TStageObjectTree}} *pegTree  = m\_xshHandle-\/>getXsheet()-\/>\mbox{\hyperlink{class_t_xsheet_a5dc925584e35e1678f5678b79c470959}{getStageObjectTree}}();}
\DoxyCodeLine{01250   QList<TStageObjectId> objs = m\_selection-\/>getObjects();}
\DoxyCodeLine{01251   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{01252   \textcolor{keywordflow}{for} (i = 0; i < objs.size(); i++) \{}
\DoxyCodeLine{01253     \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *obj = pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_a688e5b4f2f5730afb0cb10264f13a113}{getStageObject}}(objs[i], \textcolor{keyword}{false});}
\DoxyCodeLine{01254     \textcolor{keywordflow}{if} (obj \&\& obj-\/>isGrouped() \&\& !obj-\/>isGroupEditing()) obj-\/>editGroup();}
\DoxyCodeLine{01255   \}}
\DoxyCodeLine{01256   \mbox{\hyperlink{class_stage_schematic_scene_a6e3778c802f4b08489465b6e6479b68b}{updateScene}}();}
\DoxyCodeLine{01257 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_ac133d3c474f76cd27e5fecac63daa8f0}\label{class_stage_schematic_scene_ac133d3c474f76cd27e5fecac63daa8f0}} 
\index{StageSchematicScene@{StageSchematicScene}!onLoadSpline@{onLoadSpline}}
\index{onLoadSpline@{onLoadSpline}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onLoadSpline}{onLoadSpline}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Load\+Spline (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01026                                        \{}
\DoxyCodeLine{01027   \mbox{\hyperlink{class_t_file_path}{TFilePath}} projectFolder =}
\DoxyCodeLine{01028       m\_sceneHandle-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_afec1477d4fe0bb1e1152e80c3a0b20ab}{getProject}}()-\/>\mbox{\hyperlink{class_t_project_a593eef0243c736a73e92e459fb0ed71d}{getProjectFolder}}();}
\DoxyCodeLine{01029   QString fileNameStr = QFileDialog::getOpenFileName(}
\DoxyCodeLine{01030       this-\/>views()[0], QObject::tr(\textcolor{stringliteral}{"{}Load Motion Path"{}}),}
\DoxyCodeLine{01031       QString::fromStdWString(projectFolder.getWideString()),}
\DoxyCodeLine{01032       QObject::tr(\textcolor{stringliteral}{"{}Motion Path files (*.mpath)"{}}));}
\DoxyCodeLine{01033   \textcolor{keywordflow}{if} (fileNameStr == \textcolor{stringliteral}{"{}"{}}) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01034   \mbox{\hyperlink{class_t_file_path}{TFilePath}} fp(fileNameStr.toStdWString());}
\DoxyCodeLine{01035   \textcolor{keywordflow}{if} (fp.getType() == \textcolor{stringliteral}{"{}"{}}) fp = fp.withType(\textcolor{stringliteral}{"{}mpath"{}});}
\DoxyCodeLine{01036   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{01037     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{class_t_file_status}{TFileStatus}}(fp).doesExist()) \{}
\DoxyCodeLine{01038       QString msg;}
\DoxyCodeLine{01039       msg = \textcolor{stringliteral}{"{}Motion path "{}} + toQString(fp) + \textcolor{stringliteral}{"{} doesn't exists."{}};}
\DoxyCodeLine{01040       DVGui::info(msg);}
\DoxyCodeLine{01041       \textcolor{keywordflow}{return};}
\DoxyCodeLine{01042     \}}
\DoxyCodeLine{01043     assert(m\_objHandle-\/>isSpline());}
\DoxyCodeLine{01044     \textcolor{comment}{// ObjectID of the parent node to which the spline is connected}}
\DoxyCodeLine{01045     \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} \textcolor{keywordtype}{id} = m\_objHandle-\/>getObjectId();}
\DoxyCodeLine{01046     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh      = m\_xshHandle-\/>getXsheet();}
\DoxyCodeLine{01047 }
\DoxyCodeLine{01048     \mbox{\hyperlink{class_t_stage_object_spline}{TStageObjectSpline}} *spline =}
\DoxyCodeLine{01049         xsh-\/>\mbox{\hyperlink{class_t_xsheet_a5dc925584e35e1678f5678b79c470959}{getStageObjectTree}}()-\/>\mbox{\hyperlink{class_t_stage_object_tree_a688e5b4f2f5730afb0cb10264f13a113}{getStageObject}}(\textcolor{keywordtype}{id}, \textcolor{keyword}{false})-\/>\mbox{\hyperlink{class_t_stage_object_a425cb2dbcefe6ba4e288e1e8bdd16f72}{getSpline}}();}
\DoxyCodeLine{01050     \textcolor{keywordflow}{if} (!spline) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01051 }
\DoxyCodeLine{01052     \mbox{\hyperlink{class_t_i_stream}{TIStream}} is(fp);}
\DoxyCodeLine{01053     \textcolor{keywordflow}{if} (is) \{}
\DoxyCodeLine{01054       spline-\/>\mbox{\hyperlink{class_t_stage_object_spline_a80792903608810c9bd4e84ee9c95d1ca}{loadData}}(is);}
\DoxyCodeLine{01055       m\_objHandle-\/>setSplineObject(spline);}
\DoxyCodeLine{01056       m\_objHandle-\/>commitSplineChanges();}
\DoxyCodeLine{01057       IconGenerator::instance()-\/>invalidate(spline);}
\DoxyCodeLine{01058     \}}
\DoxyCodeLine{01059   \} \textcolor{keywordflow}{catch} (...) \{}
\DoxyCodeLine{01060     DVGui::warning(QObject::tr(\textcolor{stringliteral}{"{}It is not possible to load the motion path."{}}));}
\DoxyCodeLine{01061   \}}
\DoxyCodeLine{01062 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a6e8aecdc851b38adfd8584c460a7a651}\label{class_stage_schematic_scene_a6e8aecdc851b38adfd8584c460a7a651}} 
\index{StageSchematicScene@{StageSchematicScene}!onNodeChangedSize@{onNodeChangedSize}}
\index{onNodeChangedSize@{onNodeChangedSize}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onNodeChangedSize}{onNodeChangedSize}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Node\+Changed\+Size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01267                                             \{}
\DoxyCodeLine{01268   \textcolor{keywordflow}{if} (resizingNodes) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01269   \mbox{\hyperlink{class_stage_schematic_scene_a6e3778c802f4b08489465b6e6479b68b}{updateScene}}();}
\DoxyCodeLine{01270 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a4550f415cbf29ab78ecee6be67caf7a0}\label{class_stage_schematic_scene_a4550f415cbf29ab78ecee6be67caf7a0}} 
\index{StageSchematicScene@{StageSchematicScene}!onPathToggled@{onPathToggled}}
\index{onPathToggled@{onPathToggled}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onPathToggled}{onPathToggled}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Path\+Toggled (\begin{DoxyParamCaption}\item[{int}]{state }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01066                                                  \{}
\DoxyCodeLine{01067   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} objId = m\_objHandle-\/>getObjectId();}
\DoxyCodeLine{01068   \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *obj    = m\_xshHandle-\/>getXsheet()-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(objId);}
\DoxyCodeLine{01069   TStageObjectCmd::enableSplineAim(obj, state, m\_xshHandle);}
\DoxyCodeLine{01070   onSceneChanged();}
\DoxyCodeLine{01071   update();}
\DoxyCodeLine{01072 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_aa4ae3bc0a606c1135f28644b741ee423}\label{class_stage_schematic_scene_aa4ae3bc0a606c1135f28644b741ee423}} 
\index{StageSchematicScene@{StageSchematicScene}!onPegbarAdded@{onPegbarAdded}}
\index{onPegbarAdded@{onPegbarAdded}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onPegbarAdded}{onPegbarAdded}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Pegbar\+Added (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00932                                         \{}
\DoxyCodeLine{00933   \textcolor{comment}{// if this command called from the context menu, place the node at the}}
\DoxyCodeLine{00934   \textcolor{comment}{// cllicked position}}
\DoxyCodeLine{00935   \textcolor{comment}{// clickedPos will be null(0,0) if it called from the toolbar}}
\DoxyCodeLine{00936   QPointF clickedPos = qobject\_cast<QAction *>(sender())-\/>data().toPointF();}
\DoxyCodeLine{00937 }
\DoxyCodeLine{00938   TStageObjectCmd::addNewPegbar(m\_xshHandle, m\_objHandle, clickedPos);}
\DoxyCodeLine{00939 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a38b7b249a84fb6fcb1bcc8d0be3a9803}\label{class_stage_schematic_scene_a38b7b249a84fb6fcb1bcc8d0be3a9803}} 
\index{StageSchematicScene@{StageSchematicScene}!onRemoveSpline@{onRemoveSpline}}
\index{onRemoveSpline@{onRemoveSpline}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onRemoveSpline}{onRemoveSpline}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Remove\+Spline (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00987 \{ m\_selection-\/>deleteSelection(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_aaa4236609d6c1642b4ba5ec0a9379447}\label{class_stage_schematic_scene_aaa4236609d6c1642b4ba5ec0a9379447}} 
\index{StageSchematicScene@{StageSchematicScene}!onResetCenter@{onResetCenter}}
\index{onResetCenter@{onResetCenter}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onResetCenter}{onResetCenter}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Reset\+Center (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00974                                         \{}
\DoxyCodeLine{00975   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} \textcolor{keywordtype}{id} = m\_objHandle-\/>getObjectId();}
\DoxyCodeLine{00976   TStageObjectCmd::resetCenterAndOffset(\textcolor{keywordtype}{id}, m\_xshHandle);}
\DoxyCodeLine{00977 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_ae184c7bca007cc029ad082fbe648472d}\label{class_stage_schematic_scene_ae184c7bca007cc029ad082fbe648472d}} 
\index{StageSchematicScene@{StageSchematicScene}!onSaveSpline@{onSaveSpline}}
\index{onSaveSpline@{onSaveSpline}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onSaveSpline}{onSaveSpline}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Save\+Spline (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00991                                        \{}
\DoxyCodeLine{00992   \mbox{\hyperlink{class_t_file_path}{TFilePath}} projectFolder =}
\DoxyCodeLine{00993       m\_sceneHandle-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_afec1477d4fe0bb1e1152e80c3a0b20ab}{getProject}}()-\/>\mbox{\hyperlink{class_t_project_a593eef0243c736a73e92e459fb0ed71d}{getProjectFolder}}();}
\DoxyCodeLine{00994   QString fileNameStr = QFileDialog::getSaveFileName(}
\DoxyCodeLine{00995       this-\/>views()[0], QObject::tr(\textcolor{stringliteral}{"{}Save Motion Path"{}}),}
\DoxyCodeLine{00996       QString::fromStdWString(projectFolder.getWideString()),}
\DoxyCodeLine{00997       QObject::tr(\textcolor{stringliteral}{"{}Motion Path files (*.mpath)"{}}));}
\DoxyCodeLine{00998   \textcolor{keywordflow}{if} (fileNameStr == \textcolor{stringliteral}{"{}"{}}) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00999   \mbox{\hyperlink{class_t_file_path}{TFilePath}} fp(fileNameStr.toStdWString());}
\DoxyCodeLine{01000   \textcolor{keywordflow}{if} (fp.getType() == \textcolor{stringliteral}{"{}"{}}) fp = fp.withType(\textcolor{stringliteral}{"{}mpath"{}});}
\DoxyCodeLine{01001   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{01002     assert(m\_objHandle-\/>isSpline());}
\DoxyCodeLine{01003     \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} \textcolor{keywordtype}{id}        = m\_objHandle-\/>getObjectId();}
\DoxyCodeLine{01004     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh             = m\_xshHandle-\/>getXsheet();}
\DoxyCodeLine{01005     \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *currentObj = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a5dc925584e35e1678f5678b79c470959}{getStageObjectTree}}()-\/>\mbox{\hyperlink{class_t_stage_object_tree_a688e5b4f2f5730afb0cb10264f13a113}{getStageObject}}(\textcolor{keywordtype}{id});}
\DoxyCodeLine{01006 }
\DoxyCodeLine{01007     \textcolor{keywordflow}{if} (currentObj == 0) \textcolor{keywordflow}{throw} \textcolor{stringliteral}{"{}no currentObj"{}};}
\DoxyCodeLine{01008     \mbox{\hyperlink{class_t_stage_object_spline}{TStageObjectSpline}} *spline = currentObj-\/>\mbox{\hyperlink{class_t_stage_object_a425cb2dbcefe6ba4e288e1e8bdd16f72}{getSpline}}();}
\DoxyCodeLine{01009     \textcolor{keywordflow}{if} (spline == 0) \textcolor{keywordflow}{throw} \textcolor{stringliteral}{"{}no spline"{}};}
\DoxyCodeLine{01010     \mbox{\hyperlink{class_t_o_stream}{TOStream}} os(fp);}
\DoxyCodeLine{01011 }
\DoxyCodeLine{01012     \textcolor{comment}{// Only points are saved}}
\DoxyCodeLine{01013     \textcolor{keyword}{const} \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke = spline-\/>\mbox{\hyperlink{class_t_stage_object_spline_a68345d3697e0c20003d9b497d8ccacda}{getStroke}}();}
\DoxyCodeLine{01014     \textcolor{keywordtype}{int} n                 = stroke ? stroke-\/>\mbox{\hyperlink{class_t_stroke_a45101afd31e40d08100fdf23c89fb49e}{getControlPointCount}}() : 0;}
\DoxyCodeLine{01015     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; i++) \{}
\DoxyCodeLine{01016       \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} p = stroke-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(i);}
\DoxyCodeLine{01017       os << p.x << p.y << p.thick;}
\DoxyCodeLine{01018     \}}
\DoxyCodeLine{01019   \} \textcolor{keywordflow}{catch} (...) \{}
\DoxyCodeLine{01020     DVGui::warning(QObject::tr(\textcolor{stringliteral}{"{}It is not possible to save the motion path."{}}));}
\DoxyCodeLine{01021   \}}
\DoxyCodeLine{01022 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a9f0f4254b5f4f24f2c0e2c813831bade}\label{class_stage_schematic_scene_a9f0f4254b5f4f24f2c0e2c813831bade}} 
\index{StageSchematicScene@{StageSchematicScene}!onSceneChanged@{onSceneChanged}}
\index{onSceneChanged@{onSceneChanged}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onSceneChanged}{onSceneChanged}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Scene\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01095                                          \{}
\DoxyCodeLine{01096   m\_sceneHandle-\/>notifySceneChanged();}
\DoxyCodeLine{01097 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a20a32e02938d1dcc81a820127c350036}\label{class_stage_schematic_scene_a20a32e02938d1dcc81a820127c350036}} 
\index{StageSchematicScene@{StageSchematicScene}!onSelectionChanged@{onSelectionChanged}}
\index{onSelectionChanged@{onSelectionChanged}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onSelectionChanged}{onSelectionChanged}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Selection\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01195                                              \{}
\DoxyCodeLine{01196   m\_selection-\/>selectNone();}
\DoxyCodeLine{01197   \textcolor{keywordtype}{int} i, size = m\_highlightedLinks.size();}
\DoxyCodeLine{01198   \textcolor{keywordflow}{for} (i = 0; i < size; i++) \{}
\DoxyCodeLine{01199     \mbox{\hyperlink{class_schematic_link}{SchematicLink}} *link = m\_highlightedLinks[i];}
\DoxyCodeLine{01200     link-\/>setHighlighted(\textcolor{keyword}{false});}
\DoxyCodeLine{01201     link-\/>update();}
\DoxyCodeLine{01202   \}}
\DoxyCodeLine{01203   m\_highlightedLinks.clear();}
\DoxyCodeLine{01204   QList<QGraphicsItem *> slcItems = selectedItems();}
\DoxyCodeLine{01205   QList<QGraphicsItem *>::iterator it;}
\DoxyCodeLine{01206   \textcolor{keywordflow}{for} (it = slcItems.begin(); it != slcItems.end(); it++) \{}
\DoxyCodeLine{01207     \mbox{\hyperlink{class_stage_schematic_group_node}{StageSchematicGroupNode}} *groupNode =}
\DoxyCodeLine{01208         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_stage_schematic_group_node}{StageSchematicGroupNode}} *\textcolor{keyword}{>}(*it);}
\DoxyCodeLine{01209     \mbox{\hyperlink{class_stage_schematic_node}{StageSchematicNode}} *node = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_stage_schematic_node}{StageSchematicNode}} *\textcolor{keyword}{>}(*it);}
\DoxyCodeLine{01210     \textcolor{keywordflow}{if} (groupNode) \{}
\DoxyCodeLine{01211       QList<TStageObject *> objs = groupNode-\/>getGroupedObjects();}
\DoxyCodeLine{01212       \textcolor{keywordflow}{for} (i = 0; i < objs.size(); i++) m\_selection-\/>select(objs[i]-\/>getId());}
\DoxyCodeLine{01213       highlightLinks(groupNode, \textcolor{keyword}{true});}
\DoxyCodeLine{01214     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (node) \{}
\DoxyCodeLine{01215       m\_selection-\/>select(node-\/>getStageObject()-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}());}
\DoxyCodeLine{01216       highlightLinks(node, \textcolor{keyword}{true});}
\DoxyCodeLine{01217     \}}
\DoxyCodeLine{01218     \mbox{\hyperlink{class_stage_schematic_spline_node}{StageSchematicSplineNode}} *spline =}
\DoxyCodeLine{01219         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_stage_schematic_spline_node}{StageSchematicSplineNode}} *\textcolor{keyword}{>}(*it);}
\DoxyCodeLine{01220     \textcolor{keywordflow}{if} (spline) \{}
\DoxyCodeLine{01221       m\_selection-\/>select(spline-\/>getSpline()-\/>getId());}
\DoxyCodeLine{01222       \mbox{\hyperlink{class_stage_schematic_spline_port}{StageSchematicSplinePort}} *port = spline-\/>getParentPort();}
\DoxyCodeLine{01223       \textcolor{keywordflow}{if} (port) \{}
\DoxyCodeLine{01224         \textcolor{keywordtype}{int} i, linkCount = port-\/>\mbox{\hyperlink{class_schematic_port_a3be2ddc4c657a92cb4b5a9f15123c515}{getLinkCount}}();}
\DoxyCodeLine{01225         \textcolor{keywordflow}{for} (i = 0; i < linkCount; i++) \{}
\DoxyCodeLine{01226           \mbox{\hyperlink{class_schematic_link}{SchematicLink}} *link = port-\/>\mbox{\hyperlink{class_schematic_port_a48b9692e98159adbd9adf772246d8363}{getLink}}(i);}
\DoxyCodeLine{01227           link-\/>setHighlighted(\textcolor{keyword}{true});}
\DoxyCodeLine{01228           m\_highlightedLinks.push\_back(link);}
\DoxyCodeLine{01229         \}}
\DoxyCodeLine{01230       \}}
\DoxyCodeLine{01231     \}}
\DoxyCodeLine{01232 }
\DoxyCodeLine{01233     \mbox{\hyperlink{class_schematic_link}{SchematicLink}} *link = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_schematic_link}{SchematicLink}} *\textcolor{keyword}{>}(*it);}
\DoxyCodeLine{01234     \textcolor{keywordflow}{if} (link) m\_selection-\/>select(link);}
\DoxyCodeLine{01235   \}}
\DoxyCodeLine{01236   \textcolor{keywordflow}{if} (!m\_selection-\/>isEmpty()) m\_selection-\/>makeCurrent();}
\DoxyCodeLine{01237 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a15b750ec16f3ab994755b8b1276474f1}\label{class_stage_schematic_scene_a15b750ec16f3ab994755b8b1276474f1}} 
\index{StageSchematicScene@{StageSchematicScene}!onSelectionSwitched@{onSelectionSwitched}}
\index{onSelectionSwitched@{onSelectionSwitched}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onSelectionSwitched}{onSelectionSwitched}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Selection\+Switched (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_selection}{TSelection}} $\ast$}]{old\+Sel,  }\item[{\mbox{\hyperlink{class_t_selection}{TSelection}} $\ast$}]{new\+Sel }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00192                                                                   \{}
\DoxyCodeLine{00193   \textcolor{keywordflow}{if} (m\_selection == oldSel \&\& m\_selection != newSel) clearSelection();}
\DoxyCodeLine{00194 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a6430be8da3267407a4c79a5387af7c93}\label{class_stage_schematic_scene_a6430be8da3267407a4c79a5387af7c93}} 
\index{StageSchematicScene@{StageSchematicScene}!onSplineAdded@{onSplineAdded}}
\index{onSplineAdded@{onSplineAdded}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onSplineAdded}{onSplineAdded}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Spline\+Added (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00943                                         \{}
\DoxyCodeLine{00944   \textcolor{comment}{// if this command called from the context menu, place the node at the}}
\DoxyCodeLine{00945   \textcolor{comment}{// cllicked position}}
\DoxyCodeLine{00946   \textcolor{comment}{// clickedPos will be null(0,0) if it called from the toolbar}}
\DoxyCodeLine{00947   QPointF clickedPos = qobject\_cast<QAction *>(sender())-\/>data().toPointF();}
\DoxyCodeLine{00948 }
\DoxyCodeLine{00949   TStageObjectCmd::addNewSpline(m\_xshHandle, m\_objHandle, m\_colHandle,}
\DoxyCodeLine{00950                                 clickedPos);}
\DoxyCodeLine{00951 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a030725eec5809b026a984412da77282f}\label{class_stage_schematic_scene_a030725eec5809b026a984412da77282f}} 
\index{StageSchematicScene@{StageSchematicScene}!onSwitchPortModeToggled@{onSwitchPortModeToggled}}
\index{onSwitchPortModeToggled@{onSwitchPortModeToggled}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onSwitchPortModeToggled}{onSwitchPortModeToggled}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Switch\+Port\+Mode\+Toggled (\begin{DoxyParamCaption}\item[{bool}]{with\+Letter }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00966                                                                  \{}
\DoxyCodeLine{00967   m\_showLetterOnPortFlag            = withLetter;}
\DoxyCodeLine{00968   ShowLetterOnOutputPortOfStageNode = (withLetter) ? 1 : 0;}
\DoxyCodeLine{00969   \mbox{\hyperlink{class_stage_schematic_scene_a6e3778c802f4b08489465b6e6479b68b}{updateScene}}();}
\DoxyCodeLine{00970 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a99169f6f1a1f25060a13718c5f6b352d}\label{class_stage_schematic_scene_a99169f6f1a1f25060a13718c5f6b352d}} 
\index{StageSchematicScene@{StageSchematicScene}!onXsheetChanged@{onXsheetChanged}}
\index{onXsheetChanged@{onXsheetChanged}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{onXsheetChanged}{onXsheetChanged}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::on\+Xsheet\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01089                                           \{}
\DoxyCodeLine{01090   m\_xshHandle-\/>notifyXsheetChanged();}
\DoxyCodeLine{01091 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_afe1eae02907240cb91687310b0dca5bc}\label{class_stage_schematic_scene_afe1eae02907240cb91687310b0dca5bc}} 
\index{StageSchematicScene@{StageSchematicScene}!reorderScene@{reorderScene}}
\index{reorderScene@{reorderScene}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{reorderScene()}{reorderScene()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::reorder\+Scene (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Replace all nodes in the scene. 



Implements \mbox{\hyperlink{class_schematic_scene}{Schematic\+Scene}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00673 \{ placeNodes(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a7a7a0dc1a46a39dd0a894707fa38c91d}\label{class_stage_schematic_scene_a7a7a0dc1a46a39dd0a894707fa38c91d}} 
\index{StageSchematicScene@{StageSchematicScene}!resizeNodes@{resizeNodes}}
\index{resizeNodes@{resizeNodes}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{resizeNodes()}{resizeNodes()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::resize\+Nodes (\begin{DoxyParamCaption}\item[{bool}]{maximized\+Node }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00547                                                         \{}
\DoxyCodeLine{00548   resizingNodes             = \textcolor{keyword}{true};}
\DoxyCodeLine{00549   m\_gridDimension           = maximizedNode ? eLarge : eSmall;}
\DoxyCodeLine{00550   \mbox{\hyperlink{class_t_stage_object_tree}{TStageObjectTree}} *pegTree = m\_xshHandle-\/>getXsheet()-\/>\mbox{\hyperlink{class_t_xsheet_a5dc925584e35e1678f5678b79c470959}{getStageObjectTree}}();}
\DoxyCodeLine{00551   pegTree-\/>setDagGridDimension(m\_gridDimension);}
\DoxyCodeLine{00552   \textcolor{keywordtype}{int} i, objCount = pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_ad0f2bb7d9ffc580ba20305d40566d2a8}{getStageObjectCount}}();}
\DoxyCodeLine{00553   \textcolor{keywordflow}{for} (i = 0; i < objCount; i++) \{}
\DoxyCodeLine{00554     \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *obj = pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_a688e5b4f2f5730afb0cb10264f13a113}{getStageObject}}(i);}
\DoxyCodeLine{00555     \textcolor{keywordflow}{if} (obj \&\& obj-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}().\mbox{\hyperlink{class_t_stage_object_id_af6d13fcf31e7e10eef28f085855f469c}{isColumn}}()) \{}
\DoxyCodeLine{00556       \textcolor{keywordflow}{if} (!m\_nodeTable.contains(obj-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}())) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00557       \mbox{\hyperlink{class_stage_schematic_column_node}{StageSchematicColumnNode}} *node =}
\DoxyCodeLine{00558           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_stage_schematic_column_node}{StageSchematicColumnNode}} *\textcolor{keyword}{>}(m\_nodeTable[obj-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}()]);}
\DoxyCodeLine{00559       assert(node);}
\DoxyCodeLine{00560       node-\/>resize(maximizedNode);}
\DoxyCodeLine{00561     \}}
\DoxyCodeLine{00562     \textcolor{keywordflow}{if} (obj \&\& !obj-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}().\mbox{\hyperlink{class_t_stage_object_id_ab597e1e86fc3b5e64d552bec77f86b4d}{isCamera}}())}
\DoxyCodeLine{00563       updatePositionOnResize(obj, maximizedNode);}
\DoxyCodeLine{00564   \}}
\DoxyCodeLine{00565   \textcolor{keywordtype}{int} splineCount = pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_ac7f231290ded1ea78306e949545c9f96}{getSplineCount}}();}
\DoxyCodeLine{00566   \textcolor{keywordflow}{for} (i = 0; i < splineCount; i++) \{}
\DoxyCodeLine{00567     \mbox{\hyperlink{class_t_stage_object_spline}{TStageObjectSpline}} *spl = pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_ac8a44eb78f07d5f7e662478b9c46b33e}{getSpline}}(i);}
\DoxyCodeLine{00568     \textcolor{keywordflow}{if} (spl) \{}
\DoxyCodeLine{00569       \textcolor{keywordflow}{if} (!m\_splineTable.contains(spl)) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00570       \mbox{\hyperlink{class_stage_schematic_spline_node}{StageSchematicSplineNode}} *node =}
\DoxyCodeLine{00571           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_stage_schematic_spline_node}{StageSchematicSplineNode}} *\textcolor{keyword}{>}(m\_splineTable[spl]);}
\DoxyCodeLine{00572       assert(node);}
\DoxyCodeLine{00573       node-\/>resize(maximizedNode);}
\DoxyCodeLine{00574       updateSplinePositionOnResize(spl, maximizedNode);}
\DoxyCodeLine{00575     \}}
\DoxyCodeLine{00576   \}}
\DoxyCodeLine{00577   QMap<int, StageSchematicGroupNode *>::iterator it;}
\DoxyCodeLine{00578   \textcolor{keywordflow}{for} (it = m\_GroupTable.begin(); it != m\_GroupTable.end(); it++) \{}
\DoxyCodeLine{00579     it.value()-\/>resize(maximizedNode);}
\DoxyCodeLine{00580     QList<TStageObject *> groupedObjs = it.value()-\/>getGroupedObjects();}
\DoxyCodeLine{00581     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < groupedObjs.size(); i++)}
\DoxyCodeLine{00582       updatePositionOnResize(groupedObjs[i], maximizedNode);}
\DoxyCodeLine{00583   \}}
\DoxyCodeLine{00584   QMap<int, StageSchematicGroupEditor *>::iterator it2;}
\DoxyCodeLine{00585   \textcolor{keywordflow}{for} (it2 = m\_groupEditorTable.begin(); it2 != m\_groupEditorTable.end(); it2++)}
\DoxyCodeLine{00586     it2.value()-\/>resizeNodes(maximizedNode);}
\DoxyCodeLine{00587   \mbox{\hyperlink{class_stage_schematic_scene_a6e3778c802f4b08489465b6e6479b68b}{updateScene}}();}
\DoxyCodeLine{00588   resizingNodes = \textcolor{keyword}{false};}
\DoxyCodeLine{00589 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a1f850acb49955bce922dbb44dd0f66c4}\label{class_stage_schematic_scene_a1f850acb49955bce922dbb44dd0f66c4}} 
\index{StageSchematicScene@{StageSchematicScene}!setColumnHandle@{setColumnHandle}}
\index{setColumnHandle@{setColumnHandle}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{setColumnHandle()}{setColumnHandle()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::set\+Column\+Handle (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_column_handle}{TColumn\+Handle}} $\ast$}]{col\+Handle }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00178                                                                   \{}
\DoxyCodeLine{00179   m\_colHandle = colHandle;}
\DoxyCodeLine{00180   m\_selection-\/>setColumnHandle(colHandle);}
\DoxyCodeLine{00181 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_aaf49cdda711d4d0fbbd417e497bd2e7d}\label{class_stage_schematic_scene_aaf49cdda711d4d0fbbd417e497bd2e7d}} 
\index{StageSchematicScene@{StageSchematicScene}!setFrameHandle@{setFrameHandle}}
\index{setFrameHandle@{setFrameHandle}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{setFrameHandle()}{setFrameHandle()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::set\+Frame\+Handle (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_frame_handle}{TFrame\+Handle}} $\ast$}]{frame\+Handle }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00128                                                  \{}
\DoxyCodeLine{00129     m\_frameHandle = frameHandle;}
\DoxyCodeLine{00130   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a1e3c2ddd2a0122d351aa1ff3407eadac}\label{class_stage_schematic_scene_a1e3c2ddd2a0122d351aa1ff3407eadac}} 
\index{StageSchematicScene@{StageSchematicScene}!setFxHandle@{setFxHandle}}
\index{setFxHandle@{setFxHandle}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{setFxHandle()}{setFxHandle()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::set\+Fx\+Handle (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_fx_handle}{TFx\+Handle}} $\ast$}]{fx\+Handle }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00185                                                          \{}
\DoxyCodeLine{00186   m\_selection-\/>setFxHandle(fxHandle);}
\DoxyCodeLine{00187 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a98fd41a2249eb3d5aa3f9d35ef5bb1e0}\label{class_stage_schematic_scene_a98fd41a2249eb3d5aa3f9d35ef5bb1e0}} 
\index{StageSchematicScene@{StageSchematicScene}!setObjectHandle@{setObjectHandle}}
\index{setObjectHandle@{setObjectHandle}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{setObjectHandle()}{setObjectHandle()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::set\+Object\+Handle (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_object_handle}{TObject\+Handle}} $\ast$}]{obj\+Handle }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00171                                                                   \{}
\DoxyCodeLine{00172   m\_objHandle = objHandle;}
\DoxyCodeLine{00173   m\_selection-\/>setObjectHandle(objHandle);}
\DoxyCodeLine{00174 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_ac2537e009a6faff1efd2cc81cb1c876a}\label{class_stage_schematic_scene_ac2537e009a6faff1efd2cc81cb1c876a}} 
\index{StageSchematicScene@{StageSchematicScene}!setSceneHandle@{setSceneHandle}}
\index{setSceneHandle@{setSceneHandle}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{setSceneHandle()}{setSceneHandle()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::set\+Scene\+Handle (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_scene_handle}{TScene\+Handle}} $\ast$}]{scene\+Handle }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00125                                                  \{}
\DoxyCodeLine{00126     m\_sceneHandle = sceneHandle;}
\DoxyCodeLine{00127   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a6d4c74a581f83fc1e28fe5ef7678eb69}\label{class_stage_schematic_scene_a6d4c74a581f83fc1e28fe5ef7678eb69}} 
\index{StageSchematicScene@{StageSchematicScene}!setXsheetHandle@{setXsheetHandle}}
\index{setXsheetHandle@{setXsheetHandle}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{setXsheetHandle()}{setXsheetHandle()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::set\+Xsheet\+Handle (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_xsheet_handle}{TXsheet\+Handle}} $\ast$}]{xsh\+Handle }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00164                                                                   \{}
\DoxyCodeLine{00165   m\_xshHandle = xshHandle;}
\DoxyCodeLine{00166   m\_selection-\/>setXsheetHandle(xshHandle);}
\DoxyCodeLine{00167 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a7941bbbf725e9bc4f4d77d158fa69248}\label{class_stage_schematic_scene_a7941bbbf725e9bc4f4d77d158fa69248}} 
\index{StageSchematicScene@{StageSchematicScene}!updateNestedGroupEditors@{updateNestedGroupEditors}}
\index{updateNestedGroupEditors@{updateNestedGroupEditors}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{updateNestedGroupEditors()}{updateNestedGroupEditors()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::update\+Nested\+Group\+Editors (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_stage_schematic_node}{Stage\+Schematic\+Node}} $\ast$}]{node,  }\item[{const QPointF \&}]{new\+Pos }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00510                                                                           \{}
\DoxyCodeLine{00511   \textcolor{keywordflow}{if} (!node) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00512   QStack<int> groupIdStack = node-\/>getStageObject()-\/>getGroupIdStack();}
\DoxyCodeLine{00513   \textcolor{keywordflow}{if} (groupIdStack.isEmpty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00514   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00515   QRectF rect;}
\DoxyCodeLine{00516   \textcolor{keywordflow}{for} (i = 0; i < groupIdStack.size(); i++) \{}
\DoxyCodeLine{00517     \textcolor{keywordflow}{if} (m\_groupEditorTable.contains(groupIdStack[i])) \{}
\DoxyCodeLine{00518       QRectF app = m\_groupEditorTable[groupIdStack[i]]-\/>sceneBoundingRect();}
\DoxyCodeLine{00519       \textcolor{keywordflow}{if} (rect.isEmpty())}
\DoxyCodeLine{00520         rect = app;}
\DoxyCodeLine{00521       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00522 \textcolor{preprocessor}{\#if QT\_VERSION >= 0x050000}}
\DoxyCodeLine{00523         rect = rect.united(app);}
\DoxyCodeLine{00524 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00525         rect = rect.unite(app);}
\DoxyCodeLine{00526 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00527     \}}
\DoxyCodeLine{00528   \}}
\DoxyCodeLine{00529   node-\/>setPos(newPos);}
\DoxyCodeLine{00530   \textcolor{keywordflow}{for} (i = 0; i < groupIdStack.size(); i++) \{}
\DoxyCodeLine{00531     \textcolor{keywordflow}{if} (!m\_groupEditorTable.contains(groupIdStack[i])) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00532 \textcolor{preprocessor}{\#if QT\_VERSION >= 0x050000}}
\DoxyCodeLine{00533     rect =}
\DoxyCodeLine{00534         rect.united(m\_groupEditorTable[groupIdStack[i]]-\/>sceneBoundingRect());}
\DoxyCodeLine{00535 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00536     rect = rect.unite(m\_groupEditorTable[groupIdStack[i]]-\/>sceneBoundingRect());}
\DoxyCodeLine{00537 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00538     QRectF app = m\_groupEditorTable[groupIdStack[i]]-\/>boundingSceneRect();}
\DoxyCodeLine{00539     \textcolor{keywordflow}{if} (m\_groupEditorTable[groupIdStack[i]]-\/>scenePos() != app.topLeft())}
\DoxyCodeLine{00540       m\_groupEditorTable[groupIdStack[i]]-\/>setPos(app.topLeft());}
\DoxyCodeLine{00541   \}}
\DoxyCodeLine{00542   update(rect);}
\DoxyCodeLine{00543 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_schematic_scene_a6e3778c802f4b08489465b6e6479b68b}\label{class_stage_schematic_scene_a6e3778c802f4b08489465b6e6479b68b}} 
\index{StageSchematicScene@{StageSchematicScene}!updateScene@{updateScene}}
\index{updateScene@{updateScene}!StageSchematicScene@{StageSchematicScene}}
\doxysubsubsection{\texorpdfstring{updateScene()}{updateScene()}}
{\footnotesize\ttfamily void Stage\+Schematic\+Scene\+::update\+Scene (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Clear all item an regenerate the \mbox{\hyperlink{namespace_stage}{Stage}} Schematic graph. 

note\+: not every stage object is represented in the scene (e.\+g. empty columns are not)

Implements \mbox{\hyperlink{class_schematic_scene}{Schematic\+Scene}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00198                                       \{}
\DoxyCodeLine{00199   \textcolor{keywordflow}{if} (updatingScene) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00200   updatingScene = \textcolor{keyword}{true};}
\DoxyCodeLine{00201   \mbox{\hyperlink{class_schematic_scene_a915e237d443b0312ccc2b46120d1a46b}{clearAllItems}}();}
\DoxyCodeLine{00202 }
\DoxyCodeLine{00203   QPointF firstPos = sceneRect().center();}
\DoxyCodeLine{00204   m\_nextNodePos    = \mbox{\hyperlink{class_t_point_t}{TPointD}}(firstPos.x(), firstPos.y());}
\DoxyCodeLine{00205 }
\DoxyCodeLine{00206   \mbox{\hyperlink{class_t_stage_object_tree}{TStageObjectTree}} *pegTree = m\_xshHandle-\/>getXsheet()-\/>\mbox{\hyperlink{class_t_xsheet_a5dc925584e35e1678f5678b79c470959}{getStageObjectTree}}();}
\DoxyCodeLine{00207 }
\DoxyCodeLine{00208   m\_nodeTable.clear();}
\DoxyCodeLine{00209   m\_GroupTable.clear();}
\DoxyCodeLine{00210   m\_groupEditorTable.clear();}
\DoxyCodeLine{00211   m\_gridDimension = pegTree-\/>getDagGridDimension();}
\DoxyCodeLine{00212 }
\DoxyCodeLine{00213   QMap<int, QList<TStageObject *>> groupedObj;}
\DoxyCodeLine{00214   QMap<int, QList<SchematicNode *>> editedGroup;}
\DoxyCodeLine{00215   \textcolor{comment}{// in order to draw the position-\/specified nodes first}}
\DoxyCodeLine{00216   QList<int> modifiedNodeIds;}
\DoxyCodeLine{00217   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_ad0f2bb7d9ffc580ba20305d40566d2a8}{getStageObjectCount}}(); i++) \{}
\DoxyCodeLine{00218     \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *pegbar = pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_a688e5b4f2f5730afb0cb10264f13a113}{getStageObject}}(i);}
\DoxyCodeLine{00219     \textcolor{keywordflow}{if} (pegbar-\/>\mbox{\hyperlink{class_t_stage_object_a4d0ba923b8e950e754d1ca45af0819fc}{getDagNodePos}}() == TConst::nowhere)}
\DoxyCodeLine{00220       modifiedNodeIds.push\_back(i);}
\DoxyCodeLine{00221     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00222       modifiedNodeIds.push\_front(i);}
\DoxyCodeLine{00223   \}}
\DoxyCodeLine{00224 }
\DoxyCodeLine{00225   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < modifiedNodeIds.size(); i++) \{}
\DoxyCodeLine{00226     \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *pegbar = pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_a688e5b4f2f5730afb0cb10264f13a113}{getStageObject}}(modifiedNodeIds.at(i));}
\DoxyCodeLine{00227     \textcolor{keywordflow}{if} (pegbar-\/>isGrouped() \&\& !pegbar-\/>isGroupEditing()) \{}
\DoxyCodeLine{00228       groupedObj[pegbar-\/>getGroupId()].push\_back(pegbar);}
\DoxyCodeLine{00229       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00230     \}}
\DoxyCodeLine{00231     \mbox{\hyperlink{class_stage_schematic_node}{StageSchematicNode}} *node = addStageSchematicNode(pegbar);}
\DoxyCodeLine{00232     \textcolor{keywordflow}{if} (node != 0) \{}
\DoxyCodeLine{00233       m\_nodeTable[pegbar-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}()] = node;}
\DoxyCodeLine{00234       \textcolor{keywordflow}{if} (pegbar-\/>isGrouped())}
\DoxyCodeLine{00235         editedGroup[pegbar-\/>getEditingGroupId()].append(node);}
\DoxyCodeLine{00236     \}}
\DoxyCodeLine{00237   \}}
\DoxyCodeLine{00238 }
\DoxyCodeLine{00239   \textcolor{comment}{// Motion Path}}
\DoxyCodeLine{00240   m\_splineTable.clear();}
\DoxyCodeLine{00241   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_ac7f231290ded1ea78306e949545c9f96}{getSplineCount}}(); i++) \{}
\DoxyCodeLine{00242     \mbox{\hyperlink{class_t_stage_object_spline}{TStageObjectSpline}} *spline     = pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_ac8a44eb78f07d5f7e662478b9c46b33e}{getSpline}}(i);}
\DoxyCodeLine{00243     \mbox{\hyperlink{class_stage_schematic_spline_node}{StageSchematicSplineNode}} *node = addSchematicSplineNode(spline);}
\DoxyCodeLine{00244     \textcolor{keywordflow}{if} (node != 0) \{}
\DoxyCodeLine{00245       m\_splineTable[spline] = node;}
\DoxyCodeLine{00246       connect(node, SIGNAL(currentObjectChanged(\textcolor{keyword}{const} \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} \&, \textcolor{keywordtype}{bool})),}
\DoxyCodeLine{00247               \textcolor{keyword}{this}, SLOT(onCurrentObjectChanged(\textcolor{keyword}{const} \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} \&, \textcolor{keywordtype}{bool})));}
\DoxyCodeLine{00248     \}}
\DoxyCodeLine{00249   \}}
\DoxyCodeLine{00250 }
\DoxyCodeLine{00251   QMap<int, QList<TStageObject *>>::iterator it;}
\DoxyCodeLine{00252   \textcolor{keywordflow}{for} (it = groupedObj.begin(); it != groupedObj.end(); it++) \{}
\DoxyCodeLine{00253     \mbox{\hyperlink{class_stage_schematic_group_node}{StageSchematicGroupNode}} *node = addStageGroupNode(it.value());}
\DoxyCodeLine{00254     m\_GroupTable[it.key()]        = node;}
\DoxyCodeLine{00255     \textcolor{keywordtype}{int} editingGroupId            = node-\/>getStageObject()-\/>getEditingGroupId();}
\DoxyCodeLine{00256     \textcolor{keywordflow}{if} (editingGroupId != -\/1) editedGroup[editingGroupId].append(node);}
\DoxyCodeLine{00257   \}}
\DoxyCodeLine{00258 }
\DoxyCodeLine{00259   keepSubgroup(editedGroup);}
\DoxyCodeLine{00260   updateEditedGroups(editedGroup);}
\DoxyCodeLine{00261 }
\DoxyCodeLine{00262   \textcolor{comment}{// update stage links}}
\DoxyCodeLine{00263   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_ad0f2bb7d9ffc580ba20305d40566d2a8}{getStageObjectCount}}(); i++)}
\DoxyCodeLine{00264 }
\DoxyCodeLine{00265   \{}
\DoxyCodeLine{00266     \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *pegbar    = pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_a688e5b4f2f5730afb0cb10264f13a113}{getStageObject}}(i);}
\DoxyCodeLine{00267     \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} parentId = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_afb4724a8cc2ef7eb2c6c7585834210f2}{getParent}}();}
\DoxyCodeLine{00268     \textcolor{comment}{// update link; find StageSchematicNode representing pegbar}}
\DoxyCodeLine{00269     QMap<TStageObjectId, StageSchematicNode *>::iterator it;}
\DoxyCodeLine{00270 }
\DoxyCodeLine{00271     \textcolor{keywordflow}{if} (!pegbar-\/>isGrouped() || pegbar-\/>isGroupEditing()) \{}
\DoxyCodeLine{00272       it = m\_nodeTable.find(pegbar-\/>\mbox{\hyperlink{class_t_stage_object_a7acac7f9d2b8aabae125a81cc4ac5b10}{getId}}());}
\DoxyCodeLine{00273 }
\DoxyCodeLine{00276       \textcolor{keywordflow}{if} (it == m\_nodeTable.end()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00277       \mbox{\hyperlink{class_stage_schematic_node}{StageSchematicNode}} *node = it.value();}
\DoxyCodeLine{00278       \textcolor{comment}{// get pegbar parent}}
\DoxyCodeLine{00279       \textcolor{keywordflow}{if} (parentId != TStageObjectId::NoneId) \{}
\DoxyCodeLine{00280         \textcolor{comment}{// find StageSchematicNode representing parentId}}
\DoxyCodeLine{00281         it = m\_nodeTable.find(parentId);}
\DoxyCodeLine{00282         \textcolor{keywordflow}{if} (it != m\_nodeTable.end())  \textcolor{comment}{// at least we avoid crash}}
\DoxyCodeLine{00283         \{}
\DoxyCodeLine{00284           \mbox{\hyperlink{class_stage_schematic_node}{StageSchematicNode}} *parentNode = it.value();}
\DoxyCodeLine{00285           \textcolor{keywordflow}{if} (parentNode) \{}
\DoxyCodeLine{00286             \mbox{\hyperlink{class_stage_schematic_node_port}{StageSchematicNodePort}} *port1 = parentNode-\/>makeChildPort(}
\DoxyCodeLine{00287                 QString::fromStdString(pegbar-\/>\mbox{\hyperlink{class_t_stage_object_a6025ddfaaae4ebe384894230d69f0b46}{getParentHandle}}()));}
\DoxyCodeLine{00288             \mbox{\hyperlink{class_stage_schematic_node_port}{StageSchematicNodePort}} *port2 = node-\/>makeParentPort(}
\DoxyCodeLine{00289                 QString::fromStdString(pegbar-\/>\mbox{\hyperlink{class_t_stage_object_aebee1ac99c0341fe053f272b93586ef2}{getHandle}}()));}
\DoxyCodeLine{00290             port2-\/>\mbox{\hyperlink{class_schematic_port_ac6dd135a204a0f18ab8d3632a725adba}{makeLink}}(port1);}
\DoxyCodeLine{00291           \}}
\DoxyCodeLine{00292         \}}
\DoxyCodeLine{00293         \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *parent = pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_a688e5b4f2f5730afb0cb10264f13a113}{getStageObject}}(parentId, \textcolor{keyword}{false});}
\DoxyCodeLine{00294         \textcolor{keywordflow}{if} (parent \&\& parent-\/>isGrouped()) \{}
\DoxyCodeLine{00295           \textcolor{keywordtype}{int} groupId = parent-\/>getGroupId();}
\DoxyCodeLine{00296           \textcolor{keywordflow}{if} (m\_GroupTable.contains(groupId)) \{}
\DoxyCodeLine{00297             \mbox{\hyperlink{class_stage_schematic_group_node}{StageSchematicGroupNode}} *groupeNode = m\_GroupTable[groupId];}
\DoxyCodeLine{00298             \mbox{\hyperlink{class_stage_schematic_node_port}{StageSchematicNodePort}} *port1       = groupeNode-\/>getChildPort(0);}
\DoxyCodeLine{00299             \mbox{\hyperlink{class_stage_schematic_node_port}{StageSchematicNodePort}} *port2       = node-\/>makeParentPort(}
\DoxyCodeLine{00300                 QString::fromStdString(pegbar-\/>\mbox{\hyperlink{class_t_stage_object_aebee1ac99c0341fe053f272b93586ef2}{getHandle}}()));}
\DoxyCodeLine{00301             port2-\/>\mbox{\hyperlink{class_schematic_port_ac6dd135a204a0f18ab8d3632a725adba}{makeLink}}(port1);}
\DoxyCodeLine{00302           \}}
\DoxyCodeLine{00303         \}}
\DoxyCodeLine{00304       \}}
\DoxyCodeLine{00305 }
\DoxyCodeLine{00306       \textcolor{comment}{// link to motion path}}
\DoxyCodeLine{00307       \mbox{\hyperlink{class_t_stage_object_spline}{TStageObjectSpline}} *spline = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_a425cb2dbcefe6ba4e288e1e8bdd16f72}{getSpline}}();}
\DoxyCodeLine{00308       \textcolor{keywordflow}{if} (spline) \{}
\DoxyCodeLine{00309         QMap<TStageObjectSpline *, StageSchematicSplineNode *>::iterator}
\DoxyCodeLine{00310             splineIt;}
\DoxyCodeLine{00311         splineIt = m\_splineTable.find(spline);}
\DoxyCodeLine{00312         \textcolor{keywordflow}{if} (splineIt != m\_splineTable.end()) \{}
\DoxyCodeLine{00313           \mbox{\hyperlink{class_schematic_port}{SchematicPort}} *port1 = splineIt.value()-\/>getPort(-\/1);}
\DoxyCodeLine{00314           \mbox{\hyperlink{class_schematic_port}{SchematicPort}} *port2 = node-\/>\mbox{\hyperlink{class_schematic_node_a36be6020194d5ce15323e0be2de6d71c}{getPort}}(-\/1);}
\DoxyCodeLine{00315           port2-\/>\mbox{\hyperlink{class_schematic_port_ac6dd135a204a0f18ab8d3632a725adba}{makeLink}}(port1);}
\DoxyCodeLine{00316         \}}
\DoxyCodeLine{00317       \}}
\DoxyCodeLine{00318     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00319       \textcolor{keywordtype}{int} groupId                         = pegbar-\/>getGroupId();}
\DoxyCodeLine{00320       \mbox{\hyperlink{class_stage_schematic_group_node}{StageSchematicGroupNode}} *groupeNode = m\_GroupTable[groupId];}
\DoxyCodeLine{00321       \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *parent = pegTree-\/>\mbox{\hyperlink{class_t_stage_object_tree_a688e5b4f2f5730afb0cb10264f13a113}{getStageObject}}(parentId, \textcolor{keyword}{false});}
\DoxyCodeLine{00322       \textcolor{keywordflow}{if} (parent \&\& (!parent-\/>isGrouped() || parent-\/>isGroupEditing())) \{}
\DoxyCodeLine{00323         it = m\_nodeTable.find(parentId);}
\DoxyCodeLine{00324         \textcolor{keywordflow}{if} (it == m\_nodeTable.end()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00325         \mbox{\hyperlink{class_stage_schematic_node}{StageSchematicNode}} *parentNode = it.value();}
\DoxyCodeLine{00326         \textcolor{keywordflow}{if} (parentNode) \{}
\DoxyCodeLine{00327           \mbox{\hyperlink{class_stage_schematic_node_port}{StageSchematicNodePort}} *port1 = parentNode-\/>makeChildPort(}
\DoxyCodeLine{00328               QString::fromStdString(pegbar-\/>\mbox{\hyperlink{class_t_stage_object_a6025ddfaaae4ebe384894230d69f0b46}{getParentHandle}}()));}
\DoxyCodeLine{00329           \mbox{\hyperlink{class_stage_schematic_node_port}{StageSchematicNodePort}} *port2 = groupeNode-\/>getParentPort();}
\DoxyCodeLine{00330           port2-\/>\mbox{\hyperlink{class_schematic_port_ac6dd135a204a0f18ab8d3632a725adba}{makeLink}}(port1);}
\DoxyCodeLine{00331         \}}
\DoxyCodeLine{00332       \}}
\DoxyCodeLine{00333       \textcolor{keywordflow}{if} (parent \&\& parent-\/>isGrouped()) \{}
\DoxyCodeLine{00334         \textcolor{keywordtype}{int} parentGroupId = parent-\/>getGroupId();}
\DoxyCodeLine{00335         \textcolor{keywordflow}{if} (m\_GroupTable.contains(parentGroupId)) \{}
\DoxyCodeLine{00336           \mbox{\hyperlink{class_stage_schematic_group_node}{StageSchematicGroupNode}} *groupeParentNode =}
\DoxyCodeLine{00337               m\_GroupTable[parentGroupId];}
\DoxyCodeLine{00338           \mbox{\hyperlink{class_stage_schematic_node_port}{StageSchematicNodePort}} *port1 = groupeParentNode-\/>getChildPort(0);}
\DoxyCodeLine{00339           \mbox{\hyperlink{class_stage_schematic_node_port}{StageSchematicNodePort}} *port2 = groupeNode-\/>getParentPort();}
\DoxyCodeLine{00340           \textcolor{keywordflow}{if} (!port1-\/>\mbox{\hyperlink{class_schematic_port_a152b6b87384f9efe1c027bfda17a5337}{isLinkedTo}}(port2) \&\& groupeParentNode != groupeNode)}
\DoxyCodeLine{00341             port2-\/>\mbox{\hyperlink{class_schematic_port_ac6dd135a204a0f18ab8d3632a725adba}{makeLink}}(port1);}
\DoxyCodeLine{00342         \}}
\DoxyCodeLine{00343       \}}
\DoxyCodeLine{00344       \mbox{\hyperlink{class_t_stage_object_spline}{TStageObjectSpline}} *spline = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_a425cb2dbcefe6ba4e288e1e8bdd16f72}{getSpline}}();}
\DoxyCodeLine{00345       \textcolor{keywordflow}{if} (spline) \{}
\DoxyCodeLine{00346         QMap<TStageObjectSpline *, StageSchematicSplineNode *>::iterator}
\DoxyCodeLine{00347             splineIt;}
\DoxyCodeLine{00348         splineIt = m\_splineTable.find(spline);}
\DoxyCodeLine{00349         \textcolor{keywordflow}{if} (splineIt != m\_splineTable.end()) \{}
\DoxyCodeLine{00350           \mbox{\hyperlink{class_schematic_port}{SchematicPort}} *port1 = splineIt.value()-\/>getPort(-\/1);}
\DoxyCodeLine{00351           \mbox{\hyperlink{class_schematic_port}{SchematicPort}} *port2 = groupeNode-\/>\mbox{\hyperlink{class_schematic_node_a36be6020194d5ce15323e0be2de6d71c}{getPort}}(-\/1);}
\DoxyCodeLine{00352           port2-\/>\mbox{\hyperlink{class_schematic_port_ac6dd135a204a0f18ab8d3632a725adba}{makeLink}}(port1);}
\DoxyCodeLine{00353         \}}
\DoxyCodeLine{00354       \}}
\DoxyCodeLine{00355     \}}
\DoxyCodeLine{00356   \}}
\DoxyCodeLine{00357   m\_nodesToPlace.clear();}
\DoxyCodeLine{00358   updatingScene = \textcolor{keyword}{false};}
\DoxyCodeLine{00359 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00117}{Schematic\+Scene\+::clear\+All\+Items()}}, \mbox{\hyperlink{l00251}{TStage\+Object\+::get\+Dag\+Node\+Pos()}}, \mbox{\hyperlink{l00271}{TStage\+Object\+::get\+Handle()}}, \mbox{\hyperlink{l00520}{TStage\+Object\+::get\+Id()}}, \mbox{\hyperlink{l00632}{TStage\+Object\+::get\+Parent()}}, \mbox{\hyperlink{l00277}{TStage\+Object\+::get\+Parent\+Handle()}}, \mbox{\hyperlink{l01032}{Schematic\+Node\+::get\+Port()}}, \mbox{\hyperlink{l00650}{TStage\+Object\+::get\+Spline()}}, \mbox{\hyperlink{l00564}{TStage\+Object\+Tree\+::get\+Spline()}}, \mbox{\hyperlink{l00560}{TStage\+Object\+Tree\+::get\+Spline\+Count()}}, \mbox{\hyperlink{l00164}{TStage\+Object\+Tree\+::get\+Stage\+Object()}}, \mbox{\hyperlink{l00481}{TStage\+Object\+Tree\+::get\+Stage\+Object\+Count()}}, \mbox{\hyperlink{l00549}{TXsheet\+::get\+Stage\+Object\+Tree()}}, \mbox{\hyperlink{l00837}{Schematic\+Port\+::is\+Linked\+To()}}, and \mbox{\hyperlink{l00822}{Schematic\+Port\+::make\+Link()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/toonzqt/stageschematicscene.\+h\item 
E\+:/opentoonz/toonz/sources/toonzqt/stageschematicscene.\+cpp\end{DoxyCompactItemize}
