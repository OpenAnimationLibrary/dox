\hypertarget{class_perspective_distorter}{}\doxysection{Perspective\+Distorter Class Reference}
\label{class_perspective_distorter}\index{PerspectiveDistorter@{PerspectiveDistorter}}


{\ttfamily \#include $<$tdistort.\+h$>$}

Inheritance diagram for Perspective\+Distorter\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_perspective_distorter}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{class_perspective_distorter_1_1_t_perspect}{TPerspect}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_perspective_distorter_a5837752acfbae2f36e08c3208907623e}{Perspective\+Distorter}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p00s, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p10s, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p01s, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p11s, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p00d, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p10d, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p01d, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p11d)
\item 
const \mbox{\hyperlink{class_perspective_distorter_1_1_t_perspect}{TPerspect}} \& \mbox{\hyperlink{class_perspective_distorter_ac2205b307557bf50109f2eb6b8d96d56}{get\+Matrix}} () const
\item 
\mbox{\hyperlink{class_t_point_t}{TPointD}} \mbox{\hyperlink{class_perspective_distorter_a8a465c31212e4c74184b269be356c934}{map}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p) const override
\begin{DoxyCompactList}\small\item\em Returns the distorted image of point {\bfseries{p}}. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_perspective_distorter_a477d6d0371a84b7a7f27eb941103efd8}{inv\+Map}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p, \mbox{\hyperlink{class_t_point_t}{TPointD}} $\ast$results) const override
\item 
int \mbox{\hyperlink{class_perspective_distorter_ad294e3a6fa24c9cb484f2ff47100a9ff}{max\+Inv\+Count}} () const override
\item 
\mbox{\hyperlink{class_t_rect_t}{TRectD}} \mbox{\hyperlink{class_perspective_distorter_a3f6c06a5708b5d2fa3db15ff00683813}{inv\+Map}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect) const override
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
The \mbox{\hyperlink{class_perspective_distorter}{Perspective\+Distorter}} class implements a quadrilateral distorter that makes the source quad bend into the destination one while keeping a perspectical resemblance. 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_perspective_distorter_a5837752acfbae2f36e08c3208907623e}\label{class_perspective_distorter_a5837752acfbae2f36e08c3208907623e}} 
\index{PerspectiveDistorter@{PerspectiveDistorter}!PerspectiveDistorter@{PerspectiveDistorter}}
\index{PerspectiveDistorter@{PerspectiveDistorter}!PerspectiveDistorter@{PerspectiveDistorter}}
\doxysubsubsection{\texorpdfstring{PerspectiveDistorter()}{PerspectiveDistorter()}}
{\footnotesize\ttfamily Perspective\+Distorter\+::\+Perspective\+Distorter (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p00s,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p10s,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p01s,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p11s,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p00d,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p10d,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p01d,  }\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p11d }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00837     : \mbox{\hyperlink{class_t_quad_distorter}{TQuadDistorter}}(p00s, p10s, p01s, p11s, p00d, p10d, p01d, p11d) \{}
\DoxyCodeLine{00838   computeMatrix();}
\DoxyCodeLine{00839 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_perspective_distorter_a6709e27159e1693e97c94a992fbaf761}\label{class_perspective_distorter_a6709e27159e1693e97c94a992fbaf761}} 
\index{PerspectiveDistorter@{PerspectiveDistorter}!````~PerspectiveDistorter@{$\sim$PerspectiveDistorter}}
\index{````~PerspectiveDistorter@{$\sim$PerspectiveDistorter}!PerspectiveDistorter@{PerspectiveDistorter}}
\doxysubsubsection{\texorpdfstring{$\sim$PerspectiveDistorter()}{~PerspectiveDistorter()}}
{\footnotesize\ttfamily Perspective\+Distorter\+::$\sim$\+Perspective\+Distorter (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00843 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_perspective_distorter_ac2205b307557bf50109f2eb6b8d96d56}\label{class_perspective_distorter_ac2205b307557bf50109f2eb6b8d96d56}} 
\index{PerspectiveDistorter@{PerspectiveDistorter}!getMatrix@{getMatrix}}
\index{getMatrix@{getMatrix}!PerspectiveDistorter@{PerspectiveDistorter}}
\doxysubsubsection{\texorpdfstring{getMatrix()}{getMatrix()}}
{\footnotesize\ttfamily const \mbox{\hyperlink{class_perspective_distorter_1_1_t_perspect}{TPerspect}} \& Perspective\+Distorter\+::get\+Matrix (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00215 \{ \textcolor{keywordflow}{return} m\_matrix; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_perspective_distorter_a477d6d0371a84b7a7f27eb941103efd8}\label{class_perspective_distorter_a477d6d0371a84b7a7f27eb941103efd8}} 
\index{PerspectiveDistorter@{PerspectiveDistorter}!invMap@{invMap}}
\index{invMap@{invMap}!PerspectiveDistorter@{PerspectiveDistorter}}
\doxysubsubsection{\texorpdfstring{invMap()}{invMap()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily int Perspective\+Distorter\+::inv\+Map (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p,  }\item[{\mbox{\hyperlink{class_t_point_t}{TPointD}} $\ast$}]{results }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Returns the pre-\/images of distorted point {\bfseries{p}}. The results are overed on the output image as they appear in the returned vector, so the user must be sure to sort them accordingly. {\bfseries{NOTE\+:}} The results array is already allocated with the number of entries specified by the max\+Inv\+Count() function in order to avoid allocation at this level; however, the number of effective inverses must be specified as a return value. 

Implements \mbox{\hyperlink{class_t_distorter_aa1f4e823ae575d0585407b08ed0881d5}{TDistorter}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00927                                                                          \{}
\DoxyCodeLine{00928   results[0] = m\_matrixInv * p;}
\DoxyCodeLine{00929   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{00930 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_perspective_distorter_a3f6c06a5708b5d2fa3db15ff00683813}\label{class_perspective_distorter_a3f6c06a5708b5d2fa3db15ff00683813}} 
\index{PerspectiveDistorter@{PerspectiveDistorter}!invMap@{invMap}}
\index{invMap@{invMap}!PerspectiveDistorter@{PerspectiveDistorter}}
\doxysubsubsection{\texorpdfstring{invMap()}{invMap()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_rect_t}{TRectD}} Perspective\+Distorter\+::inv\+Map (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

This function is reimplementable to provide a mean of bounding the source region that will be mapped to the passed rect, typically for fxs efficiency support. 

Reimplemented from \mbox{\hyperlink{class_t_quad_distorter_a5914f39e4378349802408d70b439e4fd}{TQuad\+Distorter}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01036                                                             \{}
\DoxyCodeLine{01037   \textcolor{comment}{// For each corner, find the jacobian. Then, decide by which side the rect's}}
\DoxyCodeLine{01038   \textcolor{comment}{// pre-\/image lie with respect to the partial derivatives.}}
\DoxyCodeLine{01039   \textcolor{comment}{// Observe that the two horizon-\/separated semiplanes do not compete -\/}}
\DoxyCodeLine{01040   \textcolor{comment}{// the requirement for each is added to the result.}}
\DoxyCodeLine{01041 }
\DoxyCodeLine{01042   \mbox{\hyperlink{class_t_point_t}{TPointD}} srcCorner, xDer, yDer;}
\DoxyCodeLine{01043 }
\DoxyCodeLine{01044   \textcolor{keywordtype}{double} maxD = (std::numeric\_limits<double>::max)();}
\DoxyCodeLine{01045   \mbox{\hyperlink{class_t_rect_t}{TRectD}} positiveResult(maxD, maxD, -\/maxD, -\/maxD);}
\DoxyCodeLine{01046   \mbox{\hyperlink{class_t_rect_t}{TRectD}} negativeResult(positiveResult);}
\DoxyCodeLine{01047   \textcolor{keywordtype}{bool} hasPositiveResults = \textcolor{keyword}{false}, hasNegativeResults = \textcolor{keyword}{false};}
\DoxyCodeLine{01048 }
\DoxyCodeLine{01049   getJacobian(rect.getP00(), srcCorner, xDer, yDer);}
\DoxyCodeLine{01050   updateResult(srcCorner, xDer, yDer, 1, 1, hasPositiveResults,}
\DoxyCodeLine{01051                hasNegativeResults, positiveResult, negativeResult);}
\DoxyCodeLine{01052 }
\DoxyCodeLine{01053   getJacobian(rect.getP10(), srcCorner, xDer, yDer);}
\DoxyCodeLine{01054   updateResult(srcCorner, xDer, yDer, -\/1, 1, hasPositiveResults,}
\DoxyCodeLine{01055                hasNegativeResults, positiveResult, negativeResult);}
\DoxyCodeLine{01056 }
\DoxyCodeLine{01057   getJacobian(rect.getP01(), srcCorner, xDer, yDer);}
\DoxyCodeLine{01058   updateResult(srcCorner, xDer, yDer, 1, -\/1, hasPositiveResults,}
\DoxyCodeLine{01059                hasNegativeResults, positiveResult, negativeResult);}
\DoxyCodeLine{01060 }
\DoxyCodeLine{01061   getJacobian(rect.getP11(), srcCorner, xDer, yDer);}
\DoxyCodeLine{01062   updateResult(srcCorner, xDer, yDer, -\/1, -\/1, hasPositiveResults,}
\DoxyCodeLine{01063                hasNegativeResults, positiveResult, negativeResult);}
\DoxyCodeLine{01064 }
\DoxyCodeLine{01065   \textcolor{comment}{// If some maxD remain, no bound on that side was found. So replace with}}
\DoxyCodeLine{01066   \textcolor{comment}{// the opposite (unlimited on that side) maxD.}}
\DoxyCodeLine{01067   \textcolor{keywordflow}{if} (positiveResult.x0 == maxD) positiveResult.x0  = -\/maxD;}
\DoxyCodeLine{01068   \textcolor{keywordflow}{if} (positiveResult.x1 == -\/maxD) positiveResult.x1 = maxD;}
\DoxyCodeLine{01069   \textcolor{keywordflow}{if} (positiveResult.y0 == maxD) positiveResult.y0  = -\/maxD;}
\DoxyCodeLine{01070   \textcolor{keywordflow}{if} (positiveResult.y1 == -\/maxD) positiveResult.y1 = maxD;}
\DoxyCodeLine{01071 }
\DoxyCodeLine{01072   \textcolor{keywordflow}{if} (negativeResult.x0 == maxD) negativeResult.x0  = -\/maxD;}
\DoxyCodeLine{01073   \textcolor{keywordflow}{if} (negativeResult.x1 == -\/maxD) negativeResult.x1 = maxD;}
\DoxyCodeLine{01074   \textcolor{keywordflow}{if} (negativeResult.y0 == maxD) negativeResult.y0  = -\/maxD;}
\DoxyCodeLine{01075   \textcolor{keywordflow}{if} (negativeResult.y1 == -\/maxD) negativeResult.y1 = maxD;}
\DoxyCodeLine{01076 }
\DoxyCodeLine{01077   \textcolor{keywordflow}{return} hasPositiveResults}
\DoxyCodeLine{01078              ? hasNegativeResults ? positiveResult + negativeResult}
\DoxyCodeLine{01079                                   : positiveResult}
\DoxyCodeLine{01080              : hasNegativeResults ? negativeResult : TConsts::infiniteRectD;}
\DoxyCodeLine{01081 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00557}{TRect\+T$<$ T $>$\+::x0}}.

\mbox{\Hypertarget{class_perspective_distorter_a8a465c31212e4c74184b269be356c934}\label{class_perspective_distorter_a8a465c31212e4c74184b269be356c934}} 
\index{PerspectiveDistorter@{PerspectiveDistorter}!map@{map}}
\index{map@{map}!PerspectiveDistorter@{PerspectiveDistorter}}
\doxysubsubsection{\texorpdfstring{map()}{map()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPointD}} Perspective\+Distorter\+::map (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Returns the distorted image of point {\bfseries{p}}. 



Implements \mbox{\hyperlink{class_t_distorter_a9e7047acf8cc0698ebc9b2041c15cc9d}{TDistorter}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00921                                                         \{}
\DoxyCodeLine{00922   \textcolor{keywordflow}{return} m\_matrix * p;}
\DoxyCodeLine{00923 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_perspective_distorter_ad294e3a6fa24c9cb484f2ff47100a9ff}\label{class_perspective_distorter_ad294e3a6fa24c9cb484f2ff47100a9ff}} 
\index{PerspectiveDistorter@{PerspectiveDistorter}!maxInvCount@{maxInvCount}}
\index{maxInvCount@{maxInvCount}!PerspectiveDistorter@{PerspectiveDistorter}}
\doxysubsubsection{\texorpdfstring{maxInvCount()}{maxInvCount()}}
{\footnotesize\ttfamily int Perspective\+Distorter\+::max\+Inv\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_distorter}{TDistorter}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00219 \{ \textcolor{keywordflow}{return} 1; \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/toonz/tdistort.\+h\item 
E\+:/opentoonz/toonz/sources/toonzlib/tdistort.\+cpp\end{DoxyCompactItemize}
