\hypertarget{class_full_color_eraser_tool}{}\doxysection{Full\+Color\+Eraser\+Tool Class Reference}
\label{class_full_color_eraser_tool}\index{FullColorEraserTool@{FullColorEraserTool}}
Inheritance diagram for Full\+Color\+Eraser\+Tool\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_full_color_eraser_tool}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_full_color_eraser_tool_abb36a4d49b93a92fe54a9c483ab6b6c8}{Full\+Color\+Eraser\+Tool}} (std\+::string name)
\item 
\mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296c}{Tool\+Type}} \mbox{\hyperlink{class_full_color_eraser_tool_a8986587dbca3f6a78a58f5aa234d37a6}{get\+Tool\+Type}} () const override
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_aa2d841a16c43bb24323d8ae60be77799}{update\+Translation}} () override
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_a71647c830495e2c8b49eb341b19f8c2a}{on\+Activate}} () override
\begin{DoxyCompactList}\small\item\em Callback invoked whenever the tool activates. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_add3ca2ba314d6a1cdbd4c0022e990d0c}{on\+Deactivate}} () override
\begin{DoxyCompactList}\small\item\em Callback for tool deactivation, includes tool switch. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_a8b98eb6c413ac6dfa42d87e35740bb8c}{left\+Button\+Down}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_ab2af0a528de5a50545c08c98d4bab7e6}{left\+Button\+Drag}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_aed377f8521d081f3194e50fc3beed2b6}{left\+Button\+Up}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_a254144b64287ec518187c999d92f5414}{left\+Button\+Double\+Click}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_a51676cdc5bc2108bf8c42a6019298ad3}{mouse\+Move}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&pos, const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&e) override
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_a595d6f72a8a88cc7a7f72604407baeac}{draw}} () override
\begin{DoxyCompactList}\small\item\em Draws the tool on the viewer. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_full_color_eraser_tool_a7f281b08529187952932472d29ec6e5d}{get\+Cursor\+Id}} () const override
\begin{DoxyCompactList}\small\item\em Returns the type of cursor used by the tool. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_t_property_group}{TProperty\+Group}} $\ast$ \mbox{\hyperlink{class_full_color_eraser_tool_a6a6ddd87a06fe34603141a9524510663}{get\+Properties}} (int target\+Type) override
\item 
bool \mbox{\hyperlink{class_full_color_eraser_tool_a79f7c576577750ad1476e77091fcc798}{on\+Property\+Changed}} (std\+::string property\+Name) override
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_aab1c1681b7d82a198d3fc393c173270f}{on\+Image\+Changed}} () override
\begin{DoxyCompactList}\small\item\em Notifies changes in the image in use. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_a4417638b3ee1db420a7abd9bcb46fc87}{on\+Enter}} () override
\begin{DoxyCompactList}\small\item\em Callback for the mouse entering the viewer area. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_a19375bc8d2353723898a0f5e39995563}{update}} (const \mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&ri, \mbox{\hyperlink{class_t_rect_t}{TRectD}} sel\+Area, const \mbox{\hyperlink{class_t_smart_pointer_t}{TXsh\+Simple\+LevelP}} \&level, bool multi=false, const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&frame\+Id=-\/1)
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_aae6b8cb6d73bf80bf7992257b68da8fa}{multi\+Update}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} first\+Rect, const \mbox{\hyperlink{class_t_rect_t}{TRectD}} last\+Rect)
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_a02fdf85bd450eb826124e5e2503d205d}{multi\+Area\+Eraser}} (\mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&first\+Fid, \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&last\+Fid, \mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$first\+Stroke, \mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$last\+Stroke)
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_a4b5fe341813ca9b130bbaba7846b0330}{do\+Multi\+Eraser}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \&img, double t, const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&fid, const \mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}} \&first\+Image, const \mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}} \&last\+Image)
\item 
void \mbox{\hyperlink{class_full_color_eraser_tool_af1c4ef9692d6550dd427166036c030eb}{reset\+Multi}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_full_color_eraser_tool_abb36a4d49b93a92fe54a9c483ab6b6c8}\label{class_full_color_eraser_tool_abb36a4d49b93a92fe54a9c483ab6b6c8}} 
\index{FullColorEraserTool@{FullColorEraserTool}!FullColorEraserTool@{FullColorEraserTool}}
\index{FullColorEraserTool@{FullColorEraserTool}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{FullColorEraserTool()}{FullColorEraserTool()}}
{\footnotesize\ttfamily Full\+Color\+Eraser\+Tool\+::\+Full\+Color\+Eraser\+Tool (\begin{DoxyParamCaption}\item[{std\+::string}]{name }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00370     : \mbox{\hyperlink{class_t_tool_a9c63ec35f606e755d0d036bf4fed62ab}{TTool}}(name)}
\DoxyCodeLine{00371     , m\_size(\textcolor{stringliteral}{"{}Size:"{}}, 1, 1000, 5, \textcolor{keyword}{false})}
\DoxyCodeLine{00372     , m\_opacity(\textcolor{stringliteral}{"{}Opacity:"{}}, 0, 100, 100)}
\DoxyCodeLine{00373     , m\_hardness(\textcolor{stringliteral}{"{}Hardness:"{}}, 0, 100, 100)}
\DoxyCodeLine{00374     , m\_eraseType(\textcolor{stringliteral}{"{}Type:"{}})}
\DoxyCodeLine{00375     , m\_invertOption(\textcolor{stringliteral}{"{}Invert"{}}, \textcolor{keyword}{false})}
\DoxyCodeLine{00376     , m\_multi(\textcolor{stringliteral}{"{}Frame Range"{}}, \textcolor{keyword}{false})}
\DoxyCodeLine{00377     , m\_currCell(-\/1, -\/1)}
\DoxyCodeLine{00378     , m\_brush(0)}
\DoxyCodeLine{00379     , m\_tileSet(0)}
\DoxyCodeLine{00380     , m\_tileSaver(0)}
\DoxyCodeLine{00381     , m\_thick(0.5)}
\DoxyCodeLine{00382     , m\_firstTime(\textcolor{keyword}{true})}
\DoxyCodeLine{00383     , m\_selecting(\textcolor{keyword}{false})}
\DoxyCodeLine{00384     , m\_firstFrameSelected(\textcolor{keyword}{false})}
\DoxyCodeLine{00385     , m\_isXsheetCell(\textcolor{keyword}{false}) \{}
\DoxyCodeLine{00386   bind(\mbox{\hyperlink{class_t_tool_adf0ea3a7f9d003f761fe57638dd6eff4a89c2e7968afae376f0be7abeff061859}{TTool::RasterImage}});}
\DoxyCodeLine{00387 }
\DoxyCodeLine{00388   m\_size.setNonLinearSlider();}
\DoxyCodeLine{00389 }
\DoxyCodeLine{00390   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_size);}
\DoxyCodeLine{00391   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_hardness);}
\DoxyCodeLine{00392   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_opacity);}
\DoxyCodeLine{00393   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_eraseType);}
\DoxyCodeLine{00394   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_invertOption);}
\DoxyCodeLine{00395   m\_prop.\mbox{\hyperlink{class_t_property_group_af135c807390f3d18237f4123e9d81d3d}{bind}}(m\_multi);}
\DoxyCodeLine{00396 }
\DoxyCodeLine{00397   m\_eraseType.addValue(NORMALERASE);}
\DoxyCodeLine{00398   m\_eraseType.addValue(RECTERASE);}
\DoxyCodeLine{00399   m\_eraseType.addValue(FREEHANDERASE);}
\DoxyCodeLine{00400   m\_eraseType.addValue(POLYLINEERASE);}
\DoxyCodeLine{00401 }
\DoxyCodeLine{00402   m\_eraseType.setId(\textcolor{stringliteral}{"{}Type"{}});}
\DoxyCodeLine{00403   m\_invertOption.setId(\textcolor{stringliteral}{"{}Invert"{}});}
\DoxyCodeLine{00404   m\_multi.setId(\textcolor{stringliteral}{"{}FrameRange"{}});}
\DoxyCodeLine{00405 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_a84b3fb5cc3af0c57cf27fb8bed40f2bb}\label{class_full_color_eraser_tool_a84b3fb5cc3af0c57cf27fb8bed40f2bb}} 
\index{FullColorEraserTool@{FullColorEraserTool}!````~FullColorEraserTool@{$\sim$FullColorEraserTool}}
\index{````~FullColorEraserTool@{$\sim$FullColorEraserTool}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{$\sim$FullColorEraserTool()}{~FullColorEraserTool()}}
{\footnotesize\ttfamily Full\+Color\+Eraser\+Tool\+::$\sim$\+Full\+Color\+Eraser\+Tool (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00409 \{ \textcolor{keyword}{delete} m\_firstStroke; \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_full_color_eraser_tool_a4b5fe341813ca9b130bbaba7846b0330}\label{class_full_color_eraser_tool_a4b5fe341813ca9b130bbaba7846b0330}} 
\index{FullColorEraserTool@{FullColorEraserTool}!doMultiEraser@{doMultiEraser}}
\index{doMultiEraser@{doMultiEraser}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{doMultiEraser()}{doMultiEraser()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::do\+Multi\+Eraser (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \&}]{img,  }\item[{double}]{t,  }\item[{const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{fid,  }\item[{const \mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}} \&}]{first\+Image,  }\item[{const \mbox{\hyperlink{class_t_vector_image_p}{TVector\+ImageP}} \&}]{last\+Image }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01158                                                                         \{}
\DoxyCodeLine{01159   \textcolor{keywordtype}{int} styleId = TTool::getApplication()-\/>getCurrentLevelStyleIndex();}
\DoxyCodeLine{01160   \textcolor{keywordflow}{if} (t == 0)}
\DoxyCodeLine{01161     eraseStroke(img, firstImage-\/>getStroke(0), m\_eraseType.getValue(),}
\DoxyCodeLine{01162                 m\_invertOption.getValue(), \textcolor{comment}{/*m\_multi.getValue(),*/} m\_level,}
\DoxyCodeLine{01163                 fid);}
\DoxyCodeLine{01164   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (t == 1)}
\DoxyCodeLine{01165     eraseStroke(img, lastImage-\/>getStroke(0), m\_eraseType.getValue(),}
\DoxyCodeLine{01166                 m\_invertOption.getValue(), \textcolor{comment}{/*m\_multi.getValue(),*/} m\_level,}
\DoxyCodeLine{01167                 fid);}
\DoxyCodeLine{01168   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01169     assert(firstImage-\/>getStrokeCount() == 1);}
\DoxyCodeLine{01170     assert(lastImage-\/>getStrokeCount() == 1);}
\DoxyCodeLine{01171     \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} vi = \mbox{\hyperlink{class_t_inbetween}{TInbetween}}(firstImage, lastImage).tween(t);}
\DoxyCodeLine{01172     assert(vi-\/>getStrokeCount() == 1);}
\DoxyCodeLine{01173     eraseStroke(img, vi-\/>getStroke(0), m\_eraseType.getValue(),}
\DoxyCodeLine{01174                 m\_invertOption.getValue(), \textcolor{comment}{/*m\_multi.getValue(),*/} m\_level,}
\DoxyCodeLine{01175                 fid);}
\DoxyCodeLine{01176   \}}
\DoxyCodeLine{01177 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_a595d6f72a8a88cc7a7f72604407baeac}\label{class_full_color_eraser_tool_a595d6f72a8a88cc7a7f72604407baeac}} 
\index{FullColorEraserTool@{FullColorEraserTool}!draw@{draw}}
\index{draw@{draw}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{draw()}{draw()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::draw (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Draws the tool on the viewer. 



Reimplemented from \mbox{\hyperlink{class_t_tool_a058bf656d73bf3cd63b9826cbaaf48e0}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00903                                \{}
\DoxyCodeLine{00904   \textcolor{keywordtype}{double} pixelSize2 = getPixelSize() * getPixelSize();}
\DoxyCodeLine{00905   m\_thick           = sqrt(pixelSize2) / 2.0;}
\DoxyCodeLine{00906   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} img = (\mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}})\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{false});}
\DoxyCodeLine{00907   \textcolor{keywordflow}{if} (!img) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00908   \textcolor{keywordflow}{if} (m\_eraseType.getValue() == NORMALERASE) \{}
\DoxyCodeLine{00909     \textcolor{comment}{// If toggled off, don't draw brush outline}}
\DoxyCodeLine{00910     \textcolor{keywordflow}{if} (!Preferences::instance()-\/>isCursorOutlineEnabled()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00911 }
\DoxyCodeLine{00912     glColor3d(1.0, 0.0, 0.0);}
\DoxyCodeLine{00913     tglDrawCircle(m\_brushPos, (m\_size.getValue() + 1) * 0.5);}
\DoxyCodeLine{00914   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == RECTERASE) \{}
\DoxyCodeLine{00915     TPixel color = ToonzCheck::instance()-\/>getChecks() \& \mbox{\hyperlink{class_toonz_check_add5b28b42f552cf90e3cfcde9e737876ab6d35869ac2f7cfc956d498b2089a1ff}{ToonzCheck::eBlackBg}}}
\DoxyCodeLine{00916                        ? TPixel32::White}
\DoxyCodeLine{00917                        : TPixel32::Black;}
\DoxyCodeLine{00918     \textcolor{keywordflow}{if} (m\_multi.getValue() \&\& m\_firstFrameSelected)}
\DoxyCodeLine{00919       drawRect(m\_firstRect, color, 0x3F33, \textcolor{keyword}{true});}
\DoxyCodeLine{00920 }
\DoxyCodeLine{00921     \textcolor{keywordflow}{if} (m\_selecting || (m\_multi.getValue() \&\& !m\_firstFrameSelected))}
\DoxyCodeLine{00922       drawRect(m\_selectingRect, color, 0x3F33, \textcolor{keyword}{true});}
\DoxyCodeLine{00923   \}}
\DoxyCodeLine{00924   \textcolor{keywordflow}{if} ((m\_eraseType.getValue() == FREEHANDERASE ||}
\DoxyCodeLine{00925        m\_eraseType.getValue() == POLYLINEERASE) \&\&}
\DoxyCodeLine{00926       m\_multi.getValue()) \{}
\DoxyCodeLine{00927     TPixel color = ToonzCheck::instance()-\/>getChecks() \& \mbox{\hyperlink{class_toonz_check_add5b28b42f552cf90e3cfcde9e737876ab6d35869ac2f7cfc956d498b2089a1ff}{ToonzCheck::eBlackBg}}}
\DoxyCodeLine{00928                        ? TPixel32::White}
\DoxyCodeLine{00929                        : TPixel32::Black;}
\DoxyCodeLine{00930     tglColor(color);}
\DoxyCodeLine{00931     \textcolor{keywordflow}{if} (m\_firstStroke) drawStrokeCenterline(*m\_firstStroke, 1);}
\DoxyCodeLine{00932   \}}
\DoxyCodeLine{00933   \textcolor{keywordflow}{if} (m\_eraseType.getValue() == POLYLINEERASE \&\& !m\_polyline.empty()) \{}
\DoxyCodeLine{00934     TPixel color = ToonzCheck::instance()-\/>getChecks() \& \mbox{\hyperlink{class_toonz_check_add5b28b42f552cf90e3cfcde9e737876ab6d35869ac2f7cfc956d498b2089a1ff}{ToonzCheck::eBlackBg}}}
\DoxyCodeLine{00935                        ? TPixel32::White}
\DoxyCodeLine{00936                        : TPixel32::Black;}
\DoxyCodeLine{00937     tglColor(color);}
\DoxyCodeLine{00938     tglDrawCircle(m\_polyline[0], 2 * m\_thick);}
\DoxyCodeLine{00939     glBegin(GL\_LINE\_STRIP);}
\DoxyCodeLine{00940     \textcolor{keywordflow}{for} (UINT i = 0; i < m\_polyline.size(); i++) tglVertex(m\_polyline[i]);}
\DoxyCodeLine{00941     tglVertex(m\_mousePos);}
\DoxyCodeLine{00942     glEnd();}
\DoxyCodeLine{00943   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == FREEHANDERASE \&\& !m\_track.\mbox{\hyperlink{class_stroke_generator_a85461eab47ef4791610974866efb61aa}{isEmpty}}()) \{}
\DoxyCodeLine{00944     TPixel color = ToonzCheck::instance()-\/>getChecks() \& \mbox{\hyperlink{class_toonz_check_add5b28b42f552cf90e3cfcde9e737876ab6d35869ac2f7cfc956d498b2089a1ff}{ToonzCheck::eBlackBg}}}
\DoxyCodeLine{00945                        ? TPixel32::White}
\DoxyCodeLine{00946                        : TPixel32::Black;}
\DoxyCodeLine{00947     tglColor(color);}
\DoxyCodeLine{00948     m\_track.\mbox{\hyperlink{class_stroke_generator_a36ec59cf8b18831d60760706068c9c8f}{drawAllFragments}}();}
\DoxyCodeLine{00949   \}}
\DoxyCodeLine{00950 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00224}{Stroke\+Generator\+::draw\+All\+Fragments()}}, \mbox{\hyperlink{l00044}{Toonz\+Check\+::e\+Black\+Bg}}, \mbox{\hyperlink{l00276}{TTool\+::get\+Image()}}, and \mbox{\hyperlink{l00025}{Stroke\+Generator\+::is\+Empty()}}.

\mbox{\Hypertarget{class_full_color_eraser_tool_a7f281b08529187952932472d29ec6e5d}\label{class_full_color_eraser_tool_a7f281b08529187952932472d29ec6e5d}} 
\index{FullColorEraserTool@{FullColorEraserTool}!getCursorId@{getCursorId}}
\index{getCursorId@{getCursorId}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{getCursorId()}{getCursorId()}}
{\footnotesize\ttfamily int Full\+Color\+Eraser\+Tool\+::get\+Cursor\+Id (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Returns the type of cursor used by the tool. 

\begin{DoxySeeAlso}{See also}
For a list of cursor ids \mbox{\hyperlink{}{cursor.\+h}} 
\end{DoxySeeAlso}


Reimplemented from \mbox{\hyperlink{class_t_tool_a1768a57b8b6d1480618fd923fad15f1d}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00304 \{ \textcolor{keywordflow}{return} ToolCursor::PenCursor; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_a6a6ddd87a06fe34603141a9524510663}\label{class_full_color_eraser_tool_a6a6ddd87a06fe34603141a9524510663}} 
\index{FullColorEraserTool@{FullColorEraserTool}!getProperties@{getProperties}}
\index{getProperties@{getProperties}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{getProperties()}{getProperties()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_property_group}{TProperty\+Group}} $\ast$ Full\+Color\+Eraser\+Tool\+::get\+Properties (\begin{DoxyParamCaption}\item[{int}]{target\+Type }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00306 \{ \textcolor{keywordflow}{return} \&m\_prop; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_a8986587dbca3f6a78a58f5aa234d37a6}\label{class_full_color_eraser_tool_a8986587dbca3f6a78a58f5aa234d37a6}} 
\index{FullColorEraserTool@{FullColorEraserTool}!getToolType@{getToolType}}
\index{getToolType@{getToolType}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{getToolType()}{getToolType()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296c}{Tool\+Type}} Full\+Color\+Eraser\+Tool\+::get\+Tool\+Type (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00289 \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_tool_a391f099e6530ea54c71d81c9ee39296ca01ffd66b00b05a88c02ce8ceb5da3b8b}{TTool::LevelWriteTool}}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_a254144b64287ec518187c999d92f5414}\label{class_full_color_eraser_tool_a254144b64287ec518187c999d92f5414}} 
\index{FullColorEraserTool@{FullColorEraserTool}!leftButtonDoubleClick@{leftButtonDoubleClick}}
\index{leftButtonDoubleClick@{leftButtonDoubleClick}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDoubleClick()}{leftButtonDoubleClick()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::left\+Button\+Double\+Click (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00792                                                                       \{}
\DoxyCodeLine{00793   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true}));}
\DoxyCodeLine{00794   \textcolor{keywordflow}{if} (!ri) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00795   \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke;}
\DoxyCodeLine{00796   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{00797   \textcolor{keywordflow}{if} (m\_polyline.size() <= 1) \{}
\DoxyCodeLine{00798     resetMulti();}
\DoxyCodeLine{00799     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00800   \}}
\DoxyCodeLine{00801   \textcolor{keywordflow}{if} (m\_polyline.back() != pos) m\_polyline.push\_back(pos);}
\DoxyCodeLine{00802   \textcolor{keywordflow}{if} (m\_polyline.back() != m\_polyline.front())}
\DoxyCodeLine{00803     m\_polyline.push\_back(m\_polyline.front());}
\DoxyCodeLine{00804   std::vector<TThickPoint> strokePoints;}
\DoxyCodeLine{00805   \textcolor{keywordflow}{for} (UINT i = 0; i < m\_polyline.size() -\/ 1; i++) \{}
\DoxyCodeLine{00806     strokePoints.push\_back(\mbox{\hyperlink{class_t_thick_point}{TThickPoint}}(m\_polyline[i], 1));}
\DoxyCodeLine{00807     strokePoints.push\_back(}
\DoxyCodeLine{00808         \mbox{\hyperlink{class_t_thick_point}{TThickPoint}}(0.5 * (m\_polyline[i] + m\_polyline[i + 1]), 1));}
\DoxyCodeLine{00809   \}}
\DoxyCodeLine{00810   strokePoints.push\_back(\mbox{\hyperlink{class_t_thick_point}{TThickPoint}}(m\_polyline.back(), 1));}
\DoxyCodeLine{00811   m\_polyline.clear();}
\DoxyCodeLine{00812   stroke = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}(strokePoints);}
\DoxyCodeLine{00813   assert(stroke-\/>\mbox{\hyperlink{class_t_stroke_ace861e064b925c5d41a6d7381ae6ada5}{getPoint}}(0) == stroke-\/>\mbox{\hyperlink{class_t_stroke_ace861e064b925c5d41a6d7381ae6ada5}{getPoint}}(1));}
\DoxyCodeLine{00814 }
\DoxyCodeLine{00815   \textcolor{keywordflow}{if} (m\_multi.getValue())  \textcolor{comment}{// stroke multi}}
\DoxyCodeLine{00816   \{}
\DoxyCodeLine{00817     \textcolor{keywordflow}{if} (m\_firstFrameSelected) \{}
\DoxyCodeLine{00818       \mbox{\hyperlink{class_t_frame_id}{TFrameId}} tmp = getFrameId();}
\DoxyCodeLine{00819       \textcolor{keywordflow}{if} (m\_firstStroke \&\& stroke)}
\DoxyCodeLine{00820         multiAreaEraser(m\_firstFrameId, tmp, m\_firstStroke, stroke);}
\DoxyCodeLine{00821       \textcolor{keywordflow}{if} (e.isShiftPressed()) \{}
\DoxyCodeLine{00822         \mbox{\hyperlink{class_t_rect_t}{TRectD}} invalidateRect = m\_firstStroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}();}
\DoxyCodeLine{00823         \textcolor{keyword}{delete} m\_firstStroke;}
\DoxyCodeLine{00824         m\_firstStroke = 0;}
\DoxyCodeLine{00825         \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(invalidateRect.enlarge(2));}
\DoxyCodeLine{00826         m\_firstStroke  = stroke;}
\DoxyCodeLine{00827         invalidateRect = m\_firstStroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}();}
\DoxyCodeLine{00828         \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(invalidateRect.enlarge(2));}
\DoxyCodeLine{00829         m\_firstFrameId = getFrameId();}
\DoxyCodeLine{00830       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00831         \textcolor{keywordflow}{if} (m\_isXsheetCell) \{}
\DoxyCodeLine{00832           app-\/>getCurrentColumn()-\/>setColumnIndex(m\_currCell.first);}
\DoxyCodeLine{00833           app-\/>getCurrentFrame()-\/>setFrame(m\_currCell.second);}
\DoxyCodeLine{00834         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00835           app-\/>getCurrentFrame()-\/>setFid(m\_veryFirstFrameId);}
\DoxyCodeLine{00836         resetMulti();}
\DoxyCodeLine{00837         \textcolor{keyword}{delete} stroke;}
\DoxyCodeLine{00838       \}}
\DoxyCodeLine{00839     \} \textcolor{keywordflow}{else}  \textcolor{comment}{// primo frame}}
\DoxyCodeLine{00840     \{}
\DoxyCodeLine{00841       m\_firstStroke  = stroke;}
\DoxyCodeLine{00842       m\_isXsheetCell = app-\/>getCurrentFrame()-\/>isEditingScene();}
\DoxyCodeLine{00843       m\_currCell     = std::pair<int, int>(\mbox{\hyperlink{class_t_tool_a7214525a3ae0cdcb0a0393e4dc4d3bf5}{getColumnIndex}}(), \mbox{\hyperlink{class_t_tool_a85025fe6544609814a1672ded5847874}{getFrame}}());}
\DoxyCodeLine{00844       \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(m\_firstStroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}().enlarge(2));}
\DoxyCodeLine{00845     \}}
\DoxyCodeLine{00846   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00847     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true})) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00848     \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *level          = app-\/>getCurrentLevel()-\/>getLevel();}
\DoxyCodeLine{00849     \mbox{\hyperlink{class_t_smart_pointer_t}{TXshSimpleLevelP}} simLevel = level-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{00850     \mbox{\hyperlink{class_t_frame_id}{TFrameId}} frameId          = getFrameId();}
\DoxyCodeLine{00851     eraseStroke(ri, stroke, m\_eraseType.getValue(), m\_invertOption.getValue(),}
\DoxyCodeLine{00852                 \textcolor{comment}{/*m\_multi.getValue(),*/} m\_level, frameId);}
\DoxyCodeLine{00853     \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{00854     \textcolor{keywordflow}{if} (m\_invertOption.getValue())}
\DoxyCodeLine{00855       \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00856     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00857       \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(stroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}().enlarge(2));}
\DoxyCodeLine{00858   \}}
\DoxyCodeLine{00859 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_a8b98eb6c413ac6dfa42d87e35740bb8c}\label{class_full_color_eraser_tool_a8b98eb6c413ac6dfa42d87e35740bb8c}} 
\index{FullColorEraserTool@{FullColorEraserTool}!leftButtonDown@{leftButtonDown}}
\index{leftButtonDown@{leftButtonDown}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDown()}{leftButtonDown()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::left\+Button\+Down (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00460                                                                \{}
\DoxyCodeLine{00461   m\_brushPos = m\_mousePos = pos;}
\DoxyCodeLine{00462   m\_mouseEvent            = e;}
\DoxyCodeLine{00463   m\_mousePressed          = \textcolor{keyword}{true};}
\DoxyCodeLine{00464   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri        = (\mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}})\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00465   \textcolor{keywordflow}{if} (!ri) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00466   \mbox{\hyperlink{class_t_rect_t}{TRectD}} invalidateRect;}
\DoxyCodeLine{00467   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} ras = ri-\/>getRaster();}
\DoxyCodeLine{00468   \textcolor{keywordflow}{if} (m\_eraseType.getValue() == NORMALERASE) \{}
\DoxyCodeLine{00469     \mbox{\hyperlink{class_t_dimension_t}{TDimension}} dim  = ras-\/>getSize();}
\DoxyCodeLine{00470     \textcolor{keywordtype}{double} opacity  = m\_opacity.getValue() * 0.01;}
\DoxyCodeLine{00471     \textcolor{keywordtype}{double} hardness = m\_hardness.getValue() * 0.01;}
\DoxyCodeLine{00472     m\_workRaster    = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}(dim);}
\DoxyCodeLine{00473     m\_workRaster-\/>clear();}
\DoxyCodeLine{00474     m\_backUpRas = ras-\/>clone();}
\DoxyCodeLine{00475 }
\DoxyCodeLine{00476     \textcolor{keywordtype}{int} maxThick      = m\_size.getValue();}
\DoxyCodeLine{00477     \mbox{\hyperlink{class_t_point_t}{TPointD}} rasCenter = ras-\/>getCenterD();}
\DoxyCodeLine{00478     \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} point(pos + rasCenter, maxThick);}
\DoxyCodeLine{00479     \mbox{\hyperlink{class_t_point_t}{TPointD}} halfThick(maxThick * 0.5, maxThick * 0.5);}
\DoxyCodeLine{00480     invalidateRect = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(pos -\/ halfThick, pos + halfThick);}
\DoxyCodeLine{00481 }
\DoxyCodeLine{00482     m\_points.clear();}
\DoxyCodeLine{00483     m\_points.push\_back(point);}
\DoxyCodeLine{00484 }
\DoxyCodeLine{00485     m\_tileSet   = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_tile_set_full_color}{TTileSetFullColor}}(ras-\/>getSize());}
\DoxyCodeLine{00486     m\_tileSaver = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_tile_saver_full_color}{TTileSaverFullColor}}(ras, m\_tileSet);}
\DoxyCodeLine{00487     m\_brush =}
\DoxyCodeLine{00488         \textcolor{keyword}{new} \mbox{\hyperlink{class_blured_brush}{BluredBrush}}(m\_workRaster, m\_size.getValue(), m\_brushPad, \textcolor{keyword}{false});}
\DoxyCodeLine{00489     \mbox{\hyperlink{class_t_rect_t}{TRect}} bbox = m\_brush-\/>getBoundFromPoints(m\_points);}
\DoxyCodeLine{00490     m\_tileSaver-\/>save(bbox);}
\DoxyCodeLine{00491     m\_brush-\/>addPoint(point, 1);}
\DoxyCodeLine{00492     m\_brush-\/>eraseDrawing(ras, m\_backUpRas, bbox, opacity);}
\DoxyCodeLine{00493   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == RECTERASE) \{}
\DoxyCodeLine{00494     \textcolor{keywordflow}{if} (m\_multi.getValue() \&\& m\_firstRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \{}
\DoxyCodeLine{00495       invalidateRect = m\_selectingRect;}
\DoxyCodeLine{00496       m\_selectingRect.empty();}
\DoxyCodeLine{00497       \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(invalidateRect.enlarge(2));}
\DoxyCodeLine{00498     \}}
\DoxyCodeLine{00499     m\_selecting        = \textcolor{keyword}{true};}
\DoxyCodeLine{00500     m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} = pos.x;}
\DoxyCodeLine{00501     m\_selectingRect.y0 = pos.y;}
\DoxyCodeLine{00502     m\_selectingRect.x1 = pos.x + 1;}
\DoxyCodeLine{00503     m\_selectingRect.y1 = pos.y + 1;}
\DoxyCodeLine{00504     invalidateRect     = m\_selectingRect;}
\DoxyCodeLine{00505   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == FREEHANDERASE ||}
\DoxyCodeLine{00506              m\_eraseType.getValue() == POLYLINEERASE) \{}
\DoxyCodeLine{00507     \textcolor{keywordflow}{if} (m\_multi.getValue() \&\& m\_firstStroke \&\& !m\_firstFrameSelected) \{}
\DoxyCodeLine{00508       invalidateRect = m\_firstStroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}();}
\DoxyCodeLine{00509       \textcolor{keyword}{delete} m\_firstStroke;}
\DoxyCodeLine{00510       m\_firstStroke = 0;}
\DoxyCodeLine{00511       \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(invalidateRect.enlarge(2));}
\DoxyCodeLine{00512     \}}
\DoxyCodeLine{00513 }
\DoxyCodeLine{00514     m\_track.\mbox{\hyperlink{class_stroke_generator_a4a78460714a37e461296d169715ba460}{clear}}();}
\DoxyCodeLine{00515     m\_firstPos        = pos;}
\DoxyCodeLine{00516     \textcolor{keywordtype}{double} pixelSize2 = getPixelSize() * getPixelSize();}
\DoxyCodeLine{00517     m\_track.\mbox{\hyperlink{class_stroke_generator_a6b8f7f919bde3cf7695c9c58980c9ba3}{add}}(\mbox{\hyperlink{class_t_thick_point}{TThickPoint}}(pos, m\_thick), pixelSize2);}
\DoxyCodeLine{00518 }
\DoxyCodeLine{00519     \textcolor{keywordflow}{if} (m\_eraseType.getValue() == POLYLINEERASE) \{}
\DoxyCodeLine{00520       \textcolor{keywordflow}{if} (m\_polyline.empty() || m\_polyline.back() != pos)}
\DoxyCodeLine{00521         m\_polyline.push\_back(pos);}
\DoxyCodeLine{00522     \}}
\DoxyCodeLine{00523 }
\DoxyCodeLine{00524     \textcolor{keywordtype}{int} maxThick = 2 * m\_thick;}
\DoxyCodeLine{00525     \mbox{\hyperlink{class_t_point_t}{TPointD}} halfThick(maxThick * 0.5, maxThick * 0.5);}
\DoxyCodeLine{00526     invalidateRect = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(pos -\/ halfThick, pos + halfThick);}
\DoxyCodeLine{00527   \}}
\DoxyCodeLine{00528   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(invalidateRect.enlarge(2));}
\DoxyCodeLine{00529 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_ab2af0a528de5a50545c08c98d4bab7e6}\label{class_full_color_eraser_tool_ab2af0a528de5a50545c08c98d4bab7e6}} 
\index{FullColorEraserTool@{FullColorEraserTool}!leftButtonDrag@{leftButtonDrag}}
\index{leftButtonDrag@{leftButtonDrag}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{leftButtonDrag()}{leftButtonDrag()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::left\+Button\+Drag (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00534                                                                \{}
\DoxyCodeLine{00535   \textcolor{keywordflow}{if} (!m\_mousePressed) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00536 }
\DoxyCodeLine{00537   m\_brushPos = m\_mousePos = pos;}
\DoxyCodeLine{00538   m\_mouseEvent            = e;}
\DoxyCodeLine{00539   \textcolor{keywordtype}{double} pixelSize2       = getPixelSize() * getPixelSize();}
\DoxyCodeLine{00540 }
\DoxyCodeLine{00541   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri = (\mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}})\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00542   \textcolor{keywordflow}{if} (!ri) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00543   \textcolor{keywordflow}{if} (m\_eraseType.getValue() == NORMALERASE) \{}
\DoxyCodeLine{00544     \textcolor{keywordtype}{double} thickness  = m\_size.getValue();}
\DoxyCodeLine{00545     \mbox{\hyperlink{class_t_dimension_t}{TDimension}} size   = m\_workRaster-\/>getSize();}
\DoxyCodeLine{00546     \mbox{\hyperlink{class_t_point_t}{TPointD}} rasCenter = ri-\/>getRaster()-\/>getCenterD();}
\DoxyCodeLine{00547     \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} point(pos + rasCenter, thickness);}
\DoxyCodeLine{00548 }
\DoxyCodeLine{00549     \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} old = m\_points.back();}
\DoxyCodeLine{00550     \textcolor{keywordflow}{if} (norm2(point -\/ old) < 4) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00551 }
\DoxyCodeLine{00552     \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} mid((old + point) * 0.5, (point.thick + old.thick) * 0.5);}
\DoxyCodeLine{00553     m\_points.push\_back(mid);}
\DoxyCodeLine{00554     m\_points.push\_back(point);}
\DoxyCodeLine{00555 }
\DoxyCodeLine{00556     \textcolor{keywordtype}{int} m          = m\_points.size();}
\DoxyCodeLine{00557     \textcolor{keywordtype}{double} opacity = m\_opacity.getValue() * 0.01;}
\DoxyCodeLine{00558 }
\DoxyCodeLine{00559     \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} pa = m\_points.front();}
\DoxyCodeLine{00560     std::vector<TThickPoint> points;}
\DoxyCodeLine{00561     points.push\_back(pa);}
\DoxyCodeLine{00562     points.push\_back(mid);}
\DoxyCodeLine{00563     \mbox{\hyperlink{class_t_rect_t}{TRect}} bbox;}
\DoxyCodeLine{00564     \mbox{\hyperlink{class_t_rect_t}{TRectD}} invalidateRect;}
\DoxyCodeLine{00565     \textcolor{keywordflow}{if} (m == 3) \{}
\DoxyCodeLine{00566       \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} pa = m\_points.front();}
\DoxyCodeLine{00567       std::vector<TThickPoint> points;}
\DoxyCodeLine{00568       points.push\_back(pa);}
\DoxyCodeLine{00569       points.push\_back(mid);}
\DoxyCodeLine{00570       invalidateRect = ToolUtils::getBounds(points, thickness);}
\DoxyCodeLine{00571       bbox           = m\_brush-\/>getBoundFromPoints(points);}
\DoxyCodeLine{00572       m\_tileSaver-\/>save(bbox);}
\DoxyCodeLine{00573       m\_brush-\/>addArc(pa, (mid + pa) * 0.5, mid, 1, 1);}
\DoxyCodeLine{00574     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00575       std::vector<TThickPoint> points;}
\DoxyCodeLine{00576       points.push\_back(m\_points[m -\/ 4]);}
\DoxyCodeLine{00577       points.push\_back(old);}
\DoxyCodeLine{00578       points.push\_back(mid);}
\DoxyCodeLine{00579       invalidateRect = ToolUtils::getBounds(points, thickness);}
\DoxyCodeLine{00580       bbox           = m\_brush-\/>getBoundFromPoints(points);}
\DoxyCodeLine{00581       m\_tileSaver-\/>save(bbox);}
\DoxyCodeLine{00582       m\_brush-\/>addArc(m\_points[m -\/ 4], old, mid, 1, 1);}
\DoxyCodeLine{00583     \}}
\DoxyCodeLine{00584     m\_brush-\/>eraseDrawing(ri-\/>getRaster(), m\_backUpRas, bbox, opacity);}
\DoxyCodeLine{00585     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(invalidateRect.enlarge(2) -\/ rasCenter);}
\DoxyCodeLine{00586   \}}
\DoxyCodeLine{00587   \textcolor{keywordflow}{if} (m\_eraseType.getValue() == RECTERASE) \{}
\DoxyCodeLine{00588     assert(m\_selecting);}
\DoxyCodeLine{00589     \mbox{\hyperlink{class_t_rect_t}{TRectD}} oldRect = m\_selectingRect;}
\DoxyCodeLine{00590     \textcolor{keywordflow}{if} (oldRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} > oldRect.x1) std::swap(oldRect.x1, oldRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}});}
\DoxyCodeLine{00591     \textcolor{keywordflow}{if} (oldRect.y0 > oldRect.y1) std::swap(oldRect.y1, oldRect.y0);}
\DoxyCodeLine{00592     m\_selectingRect.x1 = pos.x;}
\DoxyCodeLine{00593     m\_selectingRect.y1 = pos.y;}
\DoxyCodeLine{00594     \mbox{\hyperlink{class_t_rect_t}{TRectD}} invalidateRect(m\_selectingRect);}
\DoxyCodeLine{00595     \textcolor{keywordflow}{if} (invalidateRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} > invalidateRect.x1)}
\DoxyCodeLine{00596       std::swap(invalidateRect.x1, invalidateRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}});}
\DoxyCodeLine{00597     \textcolor{keywordflow}{if} (invalidateRect.y0 > invalidateRect.y1)}
\DoxyCodeLine{00598       std::swap(invalidateRect.y1, invalidateRect.y0);}
\DoxyCodeLine{00599     invalidateRect += oldRect;}
\DoxyCodeLine{00600     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(invalidateRect.enlarge(2));}
\DoxyCodeLine{00601   \}}
\DoxyCodeLine{00602   \textcolor{keywordflow}{if} (m\_eraseType.getValue() == FREEHANDERASE) \{}
\DoxyCodeLine{00603     m\_track.\mbox{\hyperlink{class_stroke_generator_a6b8f7f919bde3cf7695c9c58980c9ba3}{add}}(\mbox{\hyperlink{class_t_thick_point}{TThickPoint}}(pos, m\_thick), pixelSize2);}
\DoxyCodeLine{00604     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(m\_track.\mbox{\hyperlink{class_stroke_generator_a2ec49ab0cbc5653a09dcdefb04bca3bf}{getModifiedRegion}}());}
\DoxyCodeLine{00605   \}}
\DoxyCodeLine{00606 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_aed377f8521d081f3194e50fc3beed2b6}\label{class_full_color_eraser_tool_aed377f8521d081f3194e50fc3beed2b6}} 
\index{FullColorEraserTool@{FullColorEraserTool}!leftButtonUp@{leftButtonUp}}
\index{leftButtonUp@{leftButtonUp}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{leftButtonUp()}{leftButtonUp()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::left\+Button\+Up (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00611                                                              \{}
\DoxyCodeLine{00612   m\_brushPos = m\_mousePos = pos;}
\DoxyCodeLine{00613   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri        = (\mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}})\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00614   \textcolor{keywordflow}{if} (!ri) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00615   \textcolor{keywordflow}{if} (m\_eraseType.getValue() == NORMALERASE) \{}
\DoxyCodeLine{00616     \textcolor{keywordflow}{if} (m\_points.size() != 1) \{}
\DoxyCodeLine{00617       \mbox{\hyperlink{class_t_point_t}{TPointD}} rasCenter = ri-\/>getRaster()-\/>getCenterD();}
\DoxyCodeLine{00618       \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} point(pos + rasCenter, m\_size.getValue());}
\DoxyCodeLine{00619       m\_points.push\_back(point);}
\DoxyCodeLine{00620       \textcolor{keywordtype}{int} m = m\_points.size();}
\DoxyCodeLine{00621       std::vector<TThickPoint> points;}
\DoxyCodeLine{00622       points.push\_back(m\_points[m -\/ 3]);}
\DoxyCodeLine{00623       points.push\_back(m\_points[m -\/ 2]);}
\DoxyCodeLine{00624       points.push\_back(m\_points[m -\/ 1]);}
\DoxyCodeLine{00625       \mbox{\hyperlink{class_t_rect_t}{TRect}} bbox = m\_brush-\/>getBoundFromPoints(points);}
\DoxyCodeLine{00626       m\_tileSaver-\/>save(bbox);}
\DoxyCodeLine{00627       m\_brush-\/>addArc(points[0], points[1], points[2], 1, 1);}
\DoxyCodeLine{00628       \textcolor{keywordtype}{double} opacity = m\_opacity.getValue() * 0.01;}
\DoxyCodeLine{00629       m\_brush-\/>eraseDrawing(ri-\/>getRaster(), m\_backUpRas, bbox, opacity);}
\DoxyCodeLine{00630       \mbox{\hyperlink{class_t_rect_t}{TRectD}} invalidateRect = ToolUtils::getBounds(points, m\_size.getValue());}
\DoxyCodeLine{00631       \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(invalidateRect.enlarge(2) -\/ rasCenter);}
\DoxyCodeLine{00632     \}}
\DoxyCodeLine{00633 }
\DoxyCodeLine{00634     \textcolor{keywordflow}{if} (m\_brush) \{}
\DoxyCodeLine{00635       \textcolor{keyword}{delete} m\_brush;}
\DoxyCodeLine{00636       m\_brush = 0;}
\DoxyCodeLine{00637     \}}
\DoxyCodeLine{00638 }
\DoxyCodeLine{00639     m\_workRaster-\/>unlock();}
\DoxyCodeLine{00640     \textcolor{keywordtype}{double} opacity  = m\_opacity.getValue() * 0.01;}
\DoxyCodeLine{00641     \textcolor{keywordtype}{double} hardness = m\_hardness.getValue() * 0.01;}
\DoxyCodeLine{00642 }
\DoxyCodeLine{00643     m\_workRaster = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}();}
\DoxyCodeLine{00644     m\_backUpRas  = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}();}
\DoxyCodeLine{00645 }
\DoxyCodeLine{00646     \textcolor{keyword}{delete} m\_tileSaver;}
\DoxyCodeLine{00647     \mbox{\hyperlink{class_t_application}{TTool::Application}} *app   = TTool::getApplication();}
\DoxyCodeLine{00648     \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *level          = app-\/>getCurrentLevel()-\/>getLevel();}
\DoxyCodeLine{00649     \mbox{\hyperlink{class_t_smart_pointer_t}{TXshSimpleLevelP}} simLevel = level-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{00650     \mbox{\hyperlink{class_t_frame_id}{TFrameId}} frameId          = \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}();}
\DoxyCodeLine{00651     TUndoManager::manager()-\/>add(\textcolor{keyword}{new} FullColorEraserUndo(}
\DoxyCodeLine{00652         m\_tileSet, m\_points, simLevel.getPointer(), frameId, m\_size.getValue(),}
\DoxyCodeLine{00653         m\_hardness.getValue() * 0.01, opacity));}
\DoxyCodeLine{00654     \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{00655   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == RECTERASE) \{}
\DoxyCodeLine{00656     \textcolor{keywordflow}{if} (m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} > m\_selectingRect.x1)}
\DoxyCodeLine{00657       std::swap(m\_selectingRect.x1, m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}});}
\DoxyCodeLine{00658     \textcolor{keywordflow}{if} (m\_selectingRect.y0 > m\_selectingRect.y1)}
\DoxyCodeLine{00659       std::swap(m\_selectingRect.y1, m\_selectingRect.y0);}
\DoxyCodeLine{00660 }
\DoxyCodeLine{00661     \textcolor{keywordflow}{if} (m\_multi.getValue()) \{}
\DoxyCodeLine{00662       \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{00663       \textcolor{keywordflow}{if} (m\_firstFrameSelected) \{}
\DoxyCodeLine{00664         multiUpdate(m\_firstRect, m\_selectingRect);}
\DoxyCodeLine{00665         \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{00666         \textcolor{keywordflow}{if} (e.isShiftPressed()) \{}
\DoxyCodeLine{00667           m\_firstRect    = m\_selectingRect;}
\DoxyCodeLine{00668           m\_firstFrameId = getFrameId();}
\DoxyCodeLine{00669           \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00670         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00671           \textcolor{keywordflow}{if} (m\_isXsheetCell) \{}
\DoxyCodeLine{00672             app-\/>getCurrentColumn()-\/>setColumnIndex(m\_currCell.first);}
\DoxyCodeLine{00673             app-\/>getCurrentFrame()-\/>setFrame(m\_currCell.second);}
\DoxyCodeLine{00674           \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00675             app-\/>getCurrentFrame()-\/>setFid(m\_veryFirstFrameId);}
\DoxyCodeLine{00676           resetMulti();}
\DoxyCodeLine{00677         \}}
\DoxyCodeLine{00678       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00679         m\_isXsheetCell = app-\/>getCurrentFrame()-\/>isEditingScene();}
\DoxyCodeLine{00680         m\_currCell     = std::pair<int, int>(\mbox{\hyperlink{class_t_tool_a7214525a3ae0cdcb0a0393e4dc4d3bf5}{getColumnIndex}}(), \mbox{\hyperlink{class_t_tool_a85025fe6544609814a1672ded5847874}{getFrame}}());}
\DoxyCodeLine{00681       \}}
\DoxyCodeLine{00682     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00683       \mbox{\hyperlink{class_t_application}{TTool::Application}} *app   = TTool::getApplication();}
\DoxyCodeLine{00684       \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *level          = app-\/>getCurrentLevel()-\/>getLevel();}
\DoxyCodeLine{00685       \mbox{\hyperlink{class_t_smart_pointer_t}{TXshSimpleLevelP}} simLevel = level-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{00686       \mbox{\hyperlink{class_t_frame_id}{TFrameId}} frameId          = \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}();}
\DoxyCodeLine{00687       \textcolor{keywordflow}{if} (m\_invertOption.getValue()) \{}
\DoxyCodeLine{00688         TUndoManager::manager()-\/>beginBlock();}
\DoxyCodeLine{00689         \mbox{\hyperlink{class_t_rect_t}{TRect}} rect =}
\DoxyCodeLine{00690             TRasterImageUtils::convertWorldToRaster(m\_selectingRect, ri);}
\DoxyCodeLine{00691         rect *= ri-\/>getSavebox();}
\DoxyCodeLine{00692         \mbox{\hyperlink{class_t_dimension_t}{TDimension}} dim = ri-\/>getRaster()-\/>getSize();}
\DoxyCodeLine{00693         \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect01 =}
\DoxyCodeLine{00694             \mbox{\hyperlink{class_t_rect_t}{TRectD}}(\mbox{\hyperlink{class_t_point_t}{TPointD}}(0., 0.), \mbox{\hyperlink{class_t_point_t}{TPointD}}((\textcolor{keywordtype}{double})rect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, (\textcolor{keywordtype}{double})dim.ly));}
\DoxyCodeLine{00695         \textcolor{keywordflow}{if} (rect01.getLx() > 0 \&\& rect01.getLy() > 0) \{}
\DoxyCodeLine{00696           rect01 = TRasterImageUtils::convertRasterToWorld(convert(rect01), ri);}
\DoxyCodeLine{00697           update(ri, rect01, simLevel, \textcolor{keyword}{false}, frameId);}
\DoxyCodeLine{00698         \}}
\DoxyCodeLine{00699         \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect02 = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(convert(rect.getP01()),}
\DoxyCodeLine{00700                                \mbox{\hyperlink{class_t_point_t}{TPointD}}((\textcolor{keywordtype}{double})rect.x1, (\textcolor{keywordtype}{double})dim.ly));}
\DoxyCodeLine{00701         \textcolor{keywordflow}{if} (rect02.getLx() > 0 \&\& rect02.getLy() > 0) \{}
\DoxyCodeLine{00702           rect02 = TRasterImageUtils::convertRasterToWorld(convert(rect02), ri);}
\DoxyCodeLine{00703           update(ri, rect02, simLevel, \textcolor{keyword}{false}, frameId);}
\DoxyCodeLine{00704         \}}
\DoxyCodeLine{00705         \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect03 =}
\DoxyCodeLine{00706             \mbox{\hyperlink{class_t_rect_t}{TRectD}}(\mbox{\hyperlink{class_t_point_t}{TPointD}}((\textcolor{keywordtype}{double})rect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, 0.), convert(rect.getP10()));}
\DoxyCodeLine{00707         \textcolor{keywordflow}{if} (rect03.getLx() > 0 \&\& rect03.getLy() > 0) \{}
\DoxyCodeLine{00708           rect03 = TRasterImageUtils::convertRasterToWorld(convert(rect03), ri);}
\DoxyCodeLine{00709           update(ri, rect03, simLevel, \textcolor{keyword}{false}, frameId);}
\DoxyCodeLine{00710         \}}
\DoxyCodeLine{00711         \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect04 = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(\mbox{\hyperlink{class_t_point_t}{TPointD}}((\textcolor{keywordtype}{double})rect.x1, 0.),}
\DoxyCodeLine{00712                                \mbox{\hyperlink{class_t_point_t}{TPointD}}((\textcolor{keywordtype}{double})dim.lx, (\textcolor{keywordtype}{double})dim.ly));}
\DoxyCodeLine{00713         \textcolor{keywordflow}{if} (rect04.getLx() > 0 \&\& rect04.getLy() > 0) \{}
\DoxyCodeLine{00714           rect04 = TRasterImageUtils::convertRasterToWorld(convert(rect04), ri);}
\DoxyCodeLine{00715           update(ri, rect04, simLevel, \textcolor{keyword}{false}, frameId);}
\DoxyCodeLine{00716         \}}
\DoxyCodeLine{00717         TUndoManager::manager()-\/>endBlock();}
\DoxyCodeLine{00718         \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00719       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00720         update(ri, m\_selectingRect, simLevel, \textcolor{keyword}{false}, frameId);}
\DoxyCodeLine{00721         \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(m\_selectingRect.enlarge(2));}
\DoxyCodeLine{00722       \}}
\DoxyCodeLine{00723       m\_selectingRect.empty();}
\DoxyCodeLine{00724       TTool::getApplication()-\/>getCurrentXsheet()-\/>notifyXsheetChanged();}
\DoxyCodeLine{00725       m\_selecting = \textcolor{keyword}{false};}
\DoxyCodeLine{00726       \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{00727     \}}
\DoxyCodeLine{00728   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_eraseType.getValue() == FREEHANDERASE) \{}
\DoxyCodeLine{00729     \textcolor{keywordflow}{if} (m\_track.\mbox{\hyperlink{class_stroke_generator_a85461eab47ef4791610974866efb61aa}{isEmpty}}()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00730     \textcolor{keywordtype}{double} pixelSize2 = getPixelSize() * getPixelSize();}
\DoxyCodeLine{00731     m\_track.\mbox{\hyperlink{class_stroke_generator_a6b8f7f919bde3cf7695c9c58980c9ba3}{add}}(\mbox{\hyperlink{class_t_thick_point}{TThickPoint}}(pos, m\_thick), pixelSize2);}
\DoxyCodeLine{00732     m\_track.\mbox{\hyperlink{class_stroke_generator_a6b8f7f919bde3cf7695c9c58980c9ba3}{add}}(\mbox{\hyperlink{class_t_thick_point}{TThickPoint}}(m\_firstPos, m\_thick), pixelSize2);}
\DoxyCodeLine{00733     m\_track.\mbox{\hyperlink{class_stroke_generator_a493d7aac12911e5618057115dde42131}{filterPoints}}();}
\DoxyCodeLine{00734     \textcolor{keywordtype}{double} error    = (30.0 / 11) * sqrt(pixelSize2);}
\DoxyCodeLine{00735     \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke = m\_track.\mbox{\hyperlink{class_stroke_generator_a647b44a77222a0d8b4bc21db2fdb9f93}{makeStroke}}(error);}
\DoxyCodeLine{00736 }
\DoxyCodeLine{00737     stroke-\/>\mbox{\hyperlink{class_t_stroke_a33f59dfbed74b577700351eac8c2fc7b}{setStyle}}(1);}
\DoxyCodeLine{00738     m\_track.\mbox{\hyperlink{class_stroke_generator_a4a78460714a37e461296d169715ba460}{clear}}();}
\DoxyCodeLine{00739 }
\DoxyCodeLine{00740     \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{00741     \textcolor{keywordflow}{if} (m\_multi.getValue())  \textcolor{comment}{// stroke multi}}
\DoxyCodeLine{00742     \{}
\DoxyCodeLine{00743       \textcolor{keywordflow}{if} (m\_firstFrameSelected) \{}
\DoxyCodeLine{00744         \mbox{\hyperlink{class_t_frame_id}{TFrameId}} tmp = \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}();}
\DoxyCodeLine{00745         \textcolor{keywordflow}{if} (m\_firstStroke \&\& stroke)}
\DoxyCodeLine{00746           multiAreaEraser(m\_firstFrameId, tmp, m\_firstStroke, stroke);}
\DoxyCodeLine{00747         \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{00748         \textcolor{keywordflow}{if} (e.isShiftPressed()) \{}
\DoxyCodeLine{00749           \mbox{\hyperlink{class_t_rect_t}{TRectD}} invalidateRect = m\_firstStroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}();}
\DoxyCodeLine{00750           \textcolor{keyword}{delete} m\_firstStroke;}
\DoxyCodeLine{00751           m\_firstStroke = 0;}
\DoxyCodeLine{00752           \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(invalidateRect.enlarge(2));}
\DoxyCodeLine{00753           m\_firstStroke  = stroke;}
\DoxyCodeLine{00754           invalidateRect = m\_firstStroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}();}
\DoxyCodeLine{00755           \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(invalidateRect.enlarge(2));}
\DoxyCodeLine{00756           m\_firstFrameId = getFrameId();}
\DoxyCodeLine{00757         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00758           \textcolor{keywordflow}{if} (m\_isXsheetCell) \{}
\DoxyCodeLine{00759             app-\/>getCurrentColumn()-\/>setColumnIndex(m\_currCell.first);}
\DoxyCodeLine{00760             app-\/>getCurrentFrame()-\/>setFrame(m\_currCell.second);}
\DoxyCodeLine{00761           \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00762             app-\/>getCurrentFrame()-\/>setFid(m\_veryFirstFrameId);}
\DoxyCodeLine{00763           resetMulti();}
\DoxyCodeLine{00764           \textcolor{keyword}{delete} stroke;}
\DoxyCodeLine{00765         \}}
\DoxyCodeLine{00766       \} \textcolor{keywordflow}{else}  \textcolor{comment}{// primo frame}}
\DoxyCodeLine{00767       \{}
\DoxyCodeLine{00768         m\_firstStroke  = stroke;}
\DoxyCodeLine{00769         m\_isXsheetCell = app-\/>getCurrentFrame()-\/>isEditingScene();}
\DoxyCodeLine{00770         m\_currCell     = std::pair<int, int>(\mbox{\hyperlink{class_t_tool_a7214525a3ae0cdcb0a0393e4dc4d3bf5}{getColumnIndex}}(), \mbox{\hyperlink{class_t_tool_a85025fe6544609814a1672ded5847874}{getFrame}}());}
\DoxyCodeLine{00771         \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(m\_firstStroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}().enlarge(2));}
\DoxyCodeLine{00772       \}}
\DoxyCodeLine{00773     \} \textcolor{keywordflow}{else}  \textcolor{comment}{// stroke non multi}}
\DoxyCodeLine{00774     \{}
\DoxyCodeLine{00775       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{true})) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00776       \mbox{\hyperlink{class_t_frame_id}{TFrameId}} frameId = \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}();}
\DoxyCodeLine{00777       eraseStroke(ri, stroke, m\_eraseType.getValue(), m\_invertOption.getValue(),}
\DoxyCodeLine{00778                   \textcolor{comment}{/*m\_multi.getValue(),*/} m\_level, frameId);}
\DoxyCodeLine{00779       \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}();}
\DoxyCodeLine{00780       \textcolor{keywordflow}{if} (m\_invertOption.getValue())}
\DoxyCodeLine{00781         \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00782       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00783         \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(stroke-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}().enlarge(2));}
\DoxyCodeLine{00784     \}}
\DoxyCodeLine{00785   \}}
\DoxyCodeLine{00786   m\_mousePressed = \textcolor{keyword}{false};}
\DoxyCodeLine{00787 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_a51676cdc5bc2108bf8c42a6019298ad3}\label{class_full_color_eraser_tool_a51676cdc5bc2108bf8c42a6019298ad3}} 
\index{FullColorEraserTool@{FullColorEraserTool}!mouseMove@{mouseMove}}
\index{mouseMove@{mouseMove}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{mouseMove()}{mouseMove()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::mouse\+Move (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{pos,  }\item[{const \mbox{\hyperlink{class_t_mouse_event}{TMouse\+Event}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00863                                                                             \{}
\DoxyCodeLine{00864   \textcolor{keyword}{struct }Locals \{}
\DoxyCodeLine{00865     \mbox{\hyperlink{class_full_color_eraser_tool}{FullColorEraserTool}} *m\_this;}
\DoxyCodeLine{00866 }
\DoxyCodeLine{00867     \textcolor{keywordtype}{void} setValue(\mbox{\hyperlink{class_t_range_property}{TIntProperty}} \&prop, \textcolor{keywordtype}{int} value) \{}
\DoxyCodeLine{00868       prop.setValue(value);}
\DoxyCodeLine{00869 }
\DoxyCodeLine{00870       m\_this-\/>\mbox{\hyperlink{class_full_color_eraser_tool_a79f7c576577750ad1476e77091fcc798}{onPropertyChanged}}(prop.getName());}
\DoxyCodeLine{00871       TTool::getApplication()-\/>getCurrentTool()-\/>\mbox{\hyperlink{class_tool_handle_a39e34f1a30868bad11a629228b07bd40}{notifyToolChanged}}();}
\DoxyCodeLine{00872     \}}
\DoxyCodeLine{00873 }
\DoxyCodeLine{00874     \textcolor{keywordtype}{void} addValue(\mbox{\hyperlink{class_t_range_property}{TIntProperty}} \&prop, \textcolor{keywordtype}{double} add) \{}
\DoxyCodeLine{00875       \textcolor{keyword}{const} TIntProperty::Range \&range = prop.getRange();}
\DoxyCodeLine{00876       setValue(prop,}
\DoxyCodeLine{00877                tcrop<double>(prop.getValue() + add, range.first, range.second));}
\DoxyCodeLine{00878     \}}
\DoxyCodeLine{00879 }
\DoxyCodeLine{00880   \} locals = \{\textcolor{keyword}{this}\};}
\DoxyCodeLine{00881 }
\DoxyCodeLine{00882   \textcolor{keywordflow}{switch} (e.getModifiersMask()) \{}
\DoxyCodeLine{00883   \textcolor{keywordflow}{case} \mbox{\hyperlink{class_t_mouse_event_affce294e0ebf6961a40caf6d040f767fa27d3e5267c6700f12ac7dac4973c21da}{TMouseEvent::ALT\_KEY}}: \{}
\DoxyCodeLine{00884     \textcolor{comment}{// User wants to alter the maximum brush size}}
\DoxyCodeLine{00885     \textcolor{keyword}{const} \mbox{\hyperlink{class_t_point_t}{TPointD}} \&diff = pos -\/ m\_mousePos;}
\DoxyCodeLine{00886     \textcolor{keywordtype}{double} \mbox{\hyperlink{namespacetcg_1_1poly__ops_a2ce6c8bcbc58bd7f994a759686a09f87}{add}}          = (fabs(diff.x) > fabs(diff.y)) ? diff.x : diff.y;}
\DoxyCodeLine{00887 }
\DoxyCodeLine{00888     locals.addValue(m\_size, add);}
\DoxyCodeLine{00889     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00890   \}}
\DoxyCodeLine{00891 }
\DoxyCodeLine{00892   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00893     m\_brushPos = pos;}
\DoxyCodeLine{00894     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00895   \}}
\DoxyCodeLine{00896 }
\DoxyCodeLine{00897   m\_mousePos = pos;}
\DoxyCodeLine{00898   \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}();}
\DoxyCodeLine{00899 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_a02fdf85bd450eb826124e5e2503d205d}\label{class_full_color_eraser_tool_a02fdf85bd450eb826124e5e2503d205d}} 
\index{FullColorEraserTool@{FullColorEraserTool}!multiAreaEraser@{multiAreaEraser}}
\index{multiAreaEraser@{multiAreaEraser}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{multiAreaEraser()}{multiAreaEraser()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::multi\+Area\+Eraser (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{first\+Fid,  }\item[{\mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{last\+Fid,  }\item[{\mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$}]{first\+Stroke,  }\item[{\mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$}]{last\+Stroke }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01112                                                                \{}
\DoxyCodeLine{01113   \mbox{\hyperlink{class_t_stroke}{TStroke}} *first           = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}();}
\DoxyCodeLine{01114   \mbox{\hyperlink{class_t_stroke}{TStroke}} *last            = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}();}
\DoxyCodeLine{01115   *first                   = *firstStroke;}
\DoxyCodeLine{01116   *last                    = *lastStroke;}
\DoxyCodeLine{01117   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} firstImage = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_vector_image}{TVectorImage}}();}
\DoxyCodeLine{01118   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} lastImage  = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_vector_image}{TVectorImage}}();}
\DoxyCodeLine{01119   firstImage-\/>addStroke(first);}
\DoxyCodeLine{01120   lastImage-\/>addStroke(last);}
\DoxyCodeLine{01121 }
\DoxyCodeLine{01122   \textcolor{keywordtype}{bool} backward = \textcolor{keyword}{false};}
\DoxyCodeLine{01123   \textcolor{keywordflow}{if} (firstFid > lastFid) \{}
\DoxyCodeLine{01124     std::swap(firstFid, lastFid);}
\DoxyCodeLine{01125     backward = \textcolor{keyword}{true};}
\DoxyCodeLine{01126   \}}
\DoxyCodeLine{01127   assert(firstFid <= lastFid);}
\DoxyCodeLine{01128   std::vector<TFrameId> allFids;}
\DoxyCodeLine{01129   m\_level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_a567daee4ca12a0e92445bcf98a6541f1}{getFids}}(allFids);}
\DoxyCodeLine{01130 }
\DoxyCodeLine{01131   std::vector<TFrameId>::iterator i0 = allFids.begin();}
\DoxyCodeLine{01132   \textcolor{keywordflow}{while} (i0 != allFids.end() \&\& *i0 < firstFid) i0++;}
\DoxyCodeLine{01133   \textcolor{keywordflow}{if} (i0 == allFids.end()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01134   std::vector<TFrameId>::iterator i1 = i0;}
\DoxyCodeLine{01135   \textcolor{keywordflow}{while} (i1 != allFids.end() \&\& *i1 <= lastFid) i1++;}
\DoxyCodeLine{01136   assert(i0 < i1);}
\DoxyCodeLine{01137   std::vector<TFrameId> fids(i0, i1);}
\DoxyCodeLine{01138   \textcolor{keywordtype}{int} m = fids.size();}
\DoxyCodeLine{01139   assert(m > 0);}
\DoxyCodeLine{01140   TUndoManager::manager()-\/>beginBlock();}
\DoxyCodeLine{01141   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < m; ++i) \{}
\DoxyCodeLine{01142     \mbox{\hyperlink{class_t_frame_id}{TFrameId}} fid = fids[i];}
\DoxyCodeLine{01143     assert(firstFid <= fid \&\& fid <= lastFid);}
\DoxyCodeLine{01144     \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img = m\_level-\/>getFrame(fid, \textcolor{keyword}{true});}
\DoxyCodeLine{01145     \textcolor{keywordtype}{double} t    = m > 1 ? (double)i / (\textcolor{keywordtype}{double})(m -\/ 1) : 0.5;}
\DoxyCodeLine{01146     doMultiEraser(img, backward ? 1 -\/ t : t, fid, firstImage, lastImage);}
\DoxyCodeLine{01147     m\_level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_ad412dd5c3a6ae3ff20a480dc728b26d2}{getProperties}}()-\/>\mbox{\hyperlink{class_level_properties_a61fc160a558f50d75be87c6fae066d57}{setDirtyFlag}}(\textcolor{keyword}{true});}
\DoxyCodeLine{01148     \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}(fid);}
\DoxyCodeLine{01149   \}}
\DoxyCodeLine{01150   TUndoManager::manager()-\/>endBlock();}
\DoxyCodeLine{01151 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_aae6b8cb6d73bf80bf7992257b68da8fa}\label{class_full_color_eraser_tool_aae6b8cb6d73bf80bf7992257b68da8fa}} 
\index{FullColorEraserTool@{FullColorEraserTool}!multiUpdate@{multiUpdate}}
\index{multiUpdate@{multiUpdate}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{multiUpdate()}{multiUpdate()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::multi\+Update (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}}}]{first\+Rect,  }\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}}}]{last\+Rect }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01047                                                              \{}
\DoxyCodeLine{01048   \textcolor{keywordtype}{bool} backward     = \textcolor{keyword}{false};}
\DoxyCodeLine{01049   \mbox{\hyperlink{class_t_frame_id}{TFrameId}} firstFid = m\_firstFrameId;}
\DoxyCodeLine{01050   \mbox{\hyperlink{class_t_frame_id}{TFrameId}} lastFid  = \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}();}
\DoxyCodeLine{01051   \textcolor{keywordflow}{if} (firstFid > lastFid) \{}
\DoxyCodeLine{01052     std::swap(firstFid, lastFid);}
\DoxyCodeLine{01053     backward = \textcolor{keyword}{true};}
\DoxyCodeLine{01054   \}}
\DoxyCodeLine{01055   assert(firstFid <= lastFid);}
\DoxyCodeLine{01056   std::vector<TFrameId> allFids;}
\DoxyCodeLine{01057   m\_level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_a567daee4ca12a0e92445bcf98a6541f1}{getFids}}(allFids);}
\DoxyCodeLine{01058 }
\DoxyCodeLine{01059   std::vector<TFrameId>::iterator i0 = allFids.begin();}
\DoxyCodeLine{01060   \textcolor{keywordflow}{while} (i0 != allFids.end() \&\& *i0 < firstFid) i0++;}
\DoxyCodeLine{01061   \textcolor{keywordflow}{if} (i0 == allFids.end()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01062   std::vector<TFrameId>::iterator i1 = i0;}
\DoxyCodeLine{01063   \textcolor{keywordflow}{while} (i1 != allFids.end() \&\& *i1 <= lastFid) i1++;}
\DoxyCodeLine{01064   assert(i0 < i1);}
\DoxyCodeLine{01065   std::vector<TFrameId> fids(i0, i1);}
\DoxyCodeLine{01066   \textcolor{keywordtype}{int} m = fids.size();}
\DoxyCodeLine{01067   assert(m > 0);}
\DoxyCodeLine{01068 }
\DoxyCodeLine{01069   TUndoManager::manager()-\/>beginBlock();}
\DoxyCodeLine{01070   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < m; ++i) \{}
\DoxyCodeLine{01071     \mbox{\hyperlink{class_t_frame_id}{TFrameId}} fid = fids[i];}
\DoxyCodeLine{01072     assert(firstFid <= fid \&\& fid <= lastFid);}
\DoxyCodeLine{01073     \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri = m\_level-\/>getFrame(fid, \textcolor{keyword}{true});}
\DoxyCodeLine{01074     assert(ri);}
\DoxyCodeLine{01075     \textcolor{keywordtype}{double} t    = m > 1 ? (double)i / (\textcolor{keywordtype}{double})(m -\/ 1) : 0.5;}
\DoxyCodeLine{01076     \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect = interpolateRect(firstRect, lastRect, backward ? 1 -\/ t : t);}
\DoxyCodeLine{01077     \textcolor{keywordflow}{if} (m\_invertOption.getValue()) \{}
\DoxyCodeLine{01078       \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect01 =}
\DoxyCodeLine{01079           \mbox{\hyperlink{class_t_rect_t}{TRectD}}(\mbox{\hyperlink{class_t_point_t}{TPointD}}(-\/100000., -\/100000.), \mbox{\hyperlink{class_t_point_t}{TPointD}}(rect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, 100000.));}
\DoxyCodeLine{01080       update(ri, rect01, m\_level, \textcolor{keyword}{true}, fid);}
\DoxyCodeLine{01081       \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect02 = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(rect.getP01(), \mbox{\hyperlink{class_t_point_t}{TPointD}}(rect.x1, 100000.));}
\DoxyCodeLine{01082       update(ri, rect02, m\_level, \textcolor{keyword}{true}, fid);}
\DoxyCodeLine{01083       \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect03 = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(\mbox{\hyperlink{class_t_point_t}{TPointD}}(rect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, -\/100000.), rect.getP10());}
\DoxyCodeLine{01084       update(ri, rect03, m\_level, \textcolor{keyword}{true}, fid);}
\DoxyCodeLine{01085       \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect04 =}
\DoxyCodeLine{01086           \mbox{\hyperlink{class_t_rect_t}{TRectD}}(\mbox{\hyperlink{class_t_point_t}{TPointD}}(rect.x1, -\/100000.), \mbox{\hyperlink{class_t_point_t}{TPointD}}(100000., 100000.));}
\DoxyCodeLine{01087       update(ri, rect04, m\_level, \textcolor{keyword}{true}, fid);}
\DoxyCodeLine{01088     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{01089       update(ri, rect, m\_level, \textcolor{keyword}{true}, fid);}
\DoxyCodeLine{01090     m\_level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_ad412dd5c3a6ae3ff20a480dc728b26d2}{getProperties}}()-\/>\mbox{\hyperlink{class_level_properties_a61fc160a558f50d75be87c6fae066d57}{setDirtyFlag}}(\textcolor{keyword}{true});}
\DoxyCodeLine{01091     \mbox{\hyperlink{class_t_tool_abd1824e9b49705c534e0a773305294c4}{notifyImageChanged}}(fid);}
\DoxyCodeLine{01092   \}}
\DoxyCodeLine{01093   TUndoManager::manager()-\/>endBlock();}
\DoxyCodeLine{01094 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_a71647c830495e2c8b49eb341b19f8c2a}\label{class_full_color_eraser_tool_a71647c830495e2c8b49eb341b19f8c2a}} 
\index{FullColorEraserTool@{FullColorEraserTool}!onActivate@{onActivate}}
\index{onActivate@{onActivate}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{onActivate()}{onActivate()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::on\+Activate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback invoked whenever the tool activates. 



Reimplemented from \mbox{\hyperlink{class_t_tool_ac286a2681633b4db6106596b4f54e53b}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00430                                      \{}
\DoxyCodeLine{00431   \textcolor{keywordflow}{if} (m\_firstTime) \{}
\DoxyCodeLine{00432     m\_firstTime = \textcolor{keyword}{false};}
\DoxyCodeLine{00433     m\_size.setValue(FullcolorEraseSize);}
\DoxyCodeLine{00434     m\_opacity.setValue(FullcolorEraserOpacity);}
\DoxyCodeLine{00435     m\_hardness.setValue(FullcolorEraseHardness);}
\DoxyCodeLine{00436     m\_eraseType.setValue(::to\_wstring(FullcolorEraserType.getValue()));}
\DoxyCodeLine{00437     m\_invertOption.setValue((\textcolor{keywordtype}{bool})FullcolorEraserInvert);}
\DoxyCodeLine{00438     m\_multi.setValue((\textcolor{keywordtype}{bool})FullcolorEraserRange);}
\DoxyCodeLine{00439     m\_firstTime = \textcolor{keyword}{false};}
\DoxyCodeLine{00440   \}}
\DoxyCodeLine{00441 }
\DoxyCodeLine{00442   m\_brushPad = getBrushPad(m\_size.getValue(), m\_hardness.getValue() * 0.01);}
\DoxyCodeLine{00443 }
\DoxyCodeLine{00444   \textcolor{comment}{// setting m\_level in resetMulti() will take care when the tool is switched}}
\DoxyCodeLine{00445   \textcolor{comment}{// via shortcut ( i.e. the case skipping onEnter() )}}
\DoxyCodeLine{00446   resetMulti();}
\DoxyCodeLine{00447   \textcolor{comment}{// clear previous polyline when the tool is activated}}
\DoxyCodeLine{00448   m\_polyline.clear();}
\DoxyCodeLine{00449 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_add3ca2ba314d6a1cdbd4c0022e990d0c}\label{class_full_color_eraser_tool_add3ca2ba314d6a1cdbd4c0022e990d0c}} 
\index{FullColorEraserTool@{FullColorEraserTool}!onDeactivate@{onDeactivate}}
\index{onDeactivate@{onDeactivate}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{onDeactivate()}{onDeactivate()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::on\+Deactivate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback for tool deactivation, includes tool switch. 



Reimplemented from \mbox{\hyperlink{class_t_tool_a00fee58728c1e12fb50846f47d7e9f5e}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00453                                        \{}
\DoxyCodeLine{00454   \textcolor{keywordflow}{if} (m\_mousePressed) leftButtonUp(m\_mousePos, m\_mouseEvent);}
\DoxyCodeLine{00455 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_a4417638b3ee1db420a7abd9bcb46fc87}\label{class_full_color_eraser_tool_a4417638b3ee1db420a7abd9bcb46fc87}} 
\index{FullColorEraserTool@{FullColorEraserTool}!onEnter@{onEnter}}
\index{onEnter@{onEnter}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{onEnter()}{onEnter()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::on\+Enter (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Callback for the mouse entering the viewer area. 



Reimplemented from \mbox{\hyperlink{class_t_tool_a3e775cfcd05aa3c35048b11fa40ab3e4}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01098                                   \{}
\DoxyCodeLine{01099   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ti(\mbox{\hyperlink{class_t_tool_a947d2af39fd4df397577bbf8602abfd4}{getImage}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{01100   \textcolor{keywordflow}{if} (!ti) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01101 }
\DoxyCodeLine{01102   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{01103   m\_level                 = app-\/>getCurrentLevel()-\/>getLevel()}
\DoxyCodeLine{01104                 ? app-\/>getCurrentLevel()-\/>getSimpleLevel()}
\DoxyCodeLine{01105                 : 0;}
\DoxyCodeLine{01106 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00276}{TTool\+::get\+Image()}}.

\mbox{\Hypertarget{class_full_color_eraser_tool_aab1c1681b7d82a198d3fc393c173270f}\label{class_full_color_eraser_tool_aab1c1681b7d82a198d3fc393c173270f}} 
\index{FullColorEraserTool@{FullColorEraserTool}!onImageChanged@{onImageChanged}}
\index{onImageChanged@{onImageChanged}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{onImageChanged()}{onImageChanged()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::on\+Image\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Notifies changes in the image in use. 



Reimplemented from \mbox{\hyperlink{class_t_tool_aaf1e021290e74c1b085e4b095668e1ed}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01020                                          \{}
\DoxyCodeLine{01021   \textcolor{keywordflow}{if} (!m\_multi.getValue()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01022   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{01023   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *xshl   = 0;}
\DoxyCodeLine{01024   \textcolor{keywordflow}{if} (app-\/>getCurrentLevel()-\/>getLevel())}
\DoxyCodeLine{01025     xshl = app-\/>getCurrentLevel()-\/>getSimpleLevel();}
\DoxyCodeLine{01026 }
\DoxyCodeLine{01027   \textcolor{keywordflow}{if} (!xshl || m\_level.getPointer() != xshl ||}
\DoxyCodeLine{01028       (m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}() \&\& !m\_firstStroke))}
\DoxyCodeLine{01029     resetMulti();}
\DoxyCodeLine{01030   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_firstFrameId == \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}())}
\DoxyCodeLine{01031     m\_firstFrameSelected = \textcolor{keyword}{false};  \textcolor{comment}{// nel caso sono passato allo stato 1 e torno}}
\DoxyCodeLine{01032                                    \textcolor{comment}{// all'immagine iniziale, torno allo stato}}
\DoxyCodeLine{01033                                    \textcolor{comment}{// iniziale}}
\DoxyCodeLine{01034   \textcolor{keywordflow}{else} \{                           \textcolor{comment}{// cambio stato.}}
\DoxyCodeLine{01035     m\_firstFrameSelected = \textcolor{keyword}{true};}
\DoxyCodeLine{01036     \textcolor{keywordflow}{if} (m\_eraseType.getValue() != FREEHANDERASE \&\&}
\DoxyCodeLine{01037         m\_eraseType.getValue() != POLYLINEERASE) \{}
\DoxyCodeLine{01038       assert(!m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}());}
\DoxyCodeLine{01039       m\_firstRect = m\_selectingRect;}
\DoxyCodeLine{01040     \}}
\DoxyCodeLine{01041   \}}
\DoxyCodeLine{01042 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00688}{TTool\+::get\+Current\+Fid()}}, and \mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{TRect\+T$<$ T $>$\+::is\+Empty()}}.

\mbox{\Hypertarget{class_full_color_eraser_tool_a79f7c576577750ad1476e77091fcc798}\label{class_full_color_eraser_tool_a79f7c576577750ad1476e77091fcc798}} 
\index{FullColorEraserTool@{FullColorEraserTool}!onPropertyChanged@{onPropertyChanged}}
\index{onPropertyChanged@{onPropertyChanged}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{onPropertyChanged()}{onPropertyChanged()}}
{\footnotesize\ttfamily bool Full\+Color\+Eraser\+Tool\+::on\+Property\+Changed (\begin{DoxyParamCaption}\item[{std\+::string}]{property\+Name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

\begin{DoxyVerb} Does the tasks associated to changes in \p propertyName and returns \p
\end{DoxyVerb}
 true; Does the tasks associated to changes in {\ttfamily property\+Name} and returns {\ttfamily true}. 

Reimplemented from \mbox{\hyperlink{class_t_tool_a06694e0586f807c34b18e16341aa9ee2}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00954                                                                   \{}
\DoxyCodeLine{00955   FullcolorEraseSize     = m\_size.getValue();}
\DoxyCodeLine{00956   FullcolorEraseHardness = m\_hardness.getValue();}
\DoxyCodeLine{00957   FullcolorEraserOpacity = m\_opacity.getValue();}
\DoxyCodeLine{00958   FullcolorEraserType    = ::to\_string(m\_eraseType.getValue());}
\DoxyCodeLine{00959   FullcolorEraserInvert  = (int)m\_invertOption.getValue();}
\DoxyCodeLine{00960   FullcolorEraserRange   = (int)m\_multi.getValue();}
\DoxyCodeLine{00961   \textcolor{keywordflow}{if} (propertyName == \textcolor{stringliteral}{"{}Hardness:"{}} || propertyName == \textcolor{stringliteral}{"{}Size:"{}}) \{}
\DoxyCodeLine{00962     m\_brushPad = getBrushPad(m\_size.getValue(), m\_hardness.getValue() * 0.01);}
\DoxyCodeLine{00963     \mbox{\hyperlink{class_t_rect_t}{TRectD}} rect(}
\DoxyCodeLine{00964         m\_brushPos -\/ \mbox{\hyperlink{class_t_point_t}{TPointD}}(FullcolorEraseSize + 2, FullcolorEraseSize + 2),}
\DoxyCodeLine{00965         m\_brushPos + \mbox{\hyperlink{class_t_point_t}{TPointD}}(FullcolorEraseSize + 2, FullcolorEraseSize + 2));}
\DoxyCodeLine{00966     \mbox{\hyperlink{class_t_tool_a3e791336c642542c5648aa8ea86e2348}{invalidate}}(rect);}
\DoxyCodeLine{00967   \}}
\DoxyCodeLine{00968 }
\DoxyCodeLine{00969   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00970 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00540}{TTool\+::invalidate()}}.

\mbox{\Hypertarget{class_full_color_eraser_tool_af1c4ef9692d6550dd427166036c030eb}\label{class_full_color_eraser_tool_af1c4ef9692d6550dd427166036c030eb}} 
\index{FullColorEraserTool@{FullColorEraserTool}!resetMulti@{resetMulti}}
\index{resetMulti@{resetMulti}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{resetMulti()}{resetMulti()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::reset\+Multi (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01002                                      \{}
\DoxyCodeLine{01003   m\_isXsheetCell       = \textcolor{keyword}{false};}
\DoxyCodeLine{01004   m\_firstFrameSelected = \textcolor{keyword}{false};}
\DoxyCodeLine{01005   m\_firstRect.empty();}
\DoxyCodeLine{01006   m\_selectingRect.empty();}
\DoxyCodeLine{01007   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{01008   m\_level                 = app-\/>getCurrentLevel()-\/>getLevel()}
\DoxyCodeLine{01009                 ? app-\/>getCurrentLevel()-\/>getSimpleLevel()}
\DoxyCodeLine{01010                 : 0;}
\DoxyCodeLine{01011   m\_firstFrameId = m\_veryFirstFrameId = \mbox{\hyperlink{class_t_tool_ae7db6c4288b721fd95f283419883a4b2}{getCurrentFid}}();}
\DoxyCodeLine{01012   \textcolor{keywordflow}{if} (m\_firstStroke) \{}
\DoxyCodeLine{01013     \textcolor{keyword}{delete} m\_firstStroke;}
\DoxyCodeLine{01014     m\_firstStroke = 0;}
\DoxyCodeLine{01015   \}}
\DoxyCodeLine{01016 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_a19375bc8d2353723898a0f5e39995563}\label{class_full_color_eraser_tool_a19375bc8d2353723898a0f5e39995563}} 
\index{FullColorEraserTool@{FullColorEraserTool}!update@{update}}
\index{update@{update}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{update()}{update()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::update (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&}]{ri,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}}}]{sel\+Area,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TXsh\+Simple\+LevelP}} \&}]{level,  }\item[{bool}]{multi = {\ttfamily false},  }\item[{const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{frame\+Id = {\ttfamily -\/1} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00976                                                           \{}
\DoxyCodeLine{00977   \textcolor{keywordflow}{if} (m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} > m\_selectingRect.x1) \{}
\DoxyCodeLine{00978     selArea.x1 = m\_selectingRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}};}
\DoxyCodeLine{00979     selArea.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} = m\_selectingRect.x1;}
\DoxyCodeLine{00980   \}}
\DoxyCodeLine{00981   \textcolor{keywordflow}{if} (m\_selectingRect.y0 > m\_selectingRect.y1) \{}
\DoxyCodeLine{00982     selArea.y1 = m\_selectingRect.y0;}
\DoxyCodeLine{00983     selArea.y0 = m\_selectingRect.y1;}
\DoxyCodeLine{00984   \}}
\DoxyCodeLine{00985   \textcolor{keywordflow}{if} (selArea.getLx() < 1 || selArea.getLy() < 1) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00986 }
\DoxyCodeLine{00987   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} raster            = ri-\/>getRaster();}
\DoxyCodeLine{00988   \mbox{\hyperlink{class_t_tile_set_full_color}{TTileSetFullColor}} *tileSet = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_tile_set_full_color}{TTileSetFullColor}}(raster-\/>getSize());}
\DoxyCodeLine{00989   tileSet-\/>add(raster, TRasterImageUtils::convertWorldToRaster(selArea, ri));}
\DoxyCodeLine{00990   \mbox{\hyperlink{class_t_undo}{TUndo}} *undo;}
\DoxyCodeLine{00991 }
\DoxyCodeLine{00992   undo       = \textcolor{keyword}{new} RectFullColorUndo(tileSet, selArea, \mbox{\hyperlink{class_t_stroke}{TStroke}}(),}
\DoxyCodeLine{00993                                m\_eraseType.getValue(), level.getPointer(),}
\DoxyCodeLine{00994                                m\_invertOption.getValue(), frameId);}
\DoxyCodeLine{00995   \mbox{\hyperlink{class_t_rect_t}{TRect}} rect = TRasterImageUtils::eraseRect(ri, selArea);}
\DoxyCodeLine{00996 }
\DoxyCodeLine{00997   TUndoManager::manager()-\/>add(undo);}
\DoxyCodeLine{00998 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_full_color_eraser_tool_aa2d841a16c43bb24323d8ae60be77799}\label{class_full_color_eraser_tool_aa2d841a16c43bb24323d8ae60be77799}} 
\index{FullColorEraserTool@{FullColorEraserTool}!updateTranslation@{updateTranslation}}
\index{updateTranslation@{updateTranslation}!FullColorEraserTool@{FullColorEraserTool}}
\doxysubsubsection{\texorpdfstring{updateTranslation()}{updateTranslation()}}
{\footnotesize\ttfamily void Full\+Color\+Eraser\+Tool\+::update\+Translation (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_tool}{TTool}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00413                                             \{}
\DoxyCodeLine{00414   m\_size.setQStringName(tr(\textcolor{stringliteral}{"{}Size:"{}}));}
\DoxyCodeLine{00415   m\_opacity.setQStringName(tr(\textcolor{stringliteral}{"{}Opacity:"{}}));}
\DoxyCodeLine{00416   m\_hardness.setQStringName(tr(\textcolor{stringliteral}{"{}Hardness:"{}}));}
\DoxyCodeLine{00417 }
\DoxyCodeLine{00418   m\_eraseType.setQStringName(tr(\textcolor{stringliteral}{"{}Type:"{}}));}
\DoxyCodeLine{00419   m\_eraseType.setItemUIName(NORMALERASE, tr(\textcolor{stringliteral}{"{}Normal"{}}));}
\DoxyCodeLine{00420   m\_eraseType.setItemUIName(RECTERASE, tr(\textcolor{stringliteral}{"{}Rectangular"{}}));}
\DoxyCodeLine{00421   m\_eraseType.setItemUIName(FREEHANDERASE, tr(\textcolor{stringliteral}{"{}Freehand"{}}));}
\DoxyCodeLine{00422   m\_eraseType.setItemUIName(POLYLINEERASE, tr(\textcolor{stringliteral}{"{}Polyline"{}}));}
\DoxyCodeLine{00423 }
\DoxyCodeLine{00424   m\_invertOption.setQStringName(tr(\textcolor{stringliteral}{"{}Invert"{}}));}
\DoxyCodeLine{00425   m\_multi.setQStringName(tr(\textcolor{stringliteral}{"{}Frame Range"{}}));}
\DoxyCodeLine{00426 \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/tnztools/fullcolorerasertool.\+cpp\end{DoxyCompactItemize}
