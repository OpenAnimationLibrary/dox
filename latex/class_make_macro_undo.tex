\hypertarget{class_make_macro_undo}{}\doxysection{Make\+Macro\+Undo Class Reference}
\label{class_make_macro_undo}\index{MakeMacroUndo@{MakeMacroUndo}}
Inheritance diagram for Make\+Macro\+Undo\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=4.000000cm]{class_make_macro_undo}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_make_macro_undo_a91d46dfcf3d82c60ad4775384d7b5a2e}{Make\+Macro\+Undo}} (const std\+::vector$<$ \mbox{\hyperlink{class_t_smart_pointer_t}{TFxP}} $>$ \&fxs, \mbox{\hyperlink{class_t_application}{TApplication}} $\ast$app)
\item 
bool \mbox{\hyperlink{class_make_macro_undo_a5736c9c8fcdcbbd46d0c36d8391f43f8}{is\+Consistent}} () const override
\item 
void \mbox{\hyperlink{class_make_macro_undo_ad4420fe4f35b18b24a9bccbf8d5b7035}{redo}} () const override
\item 
void \mbox{\hyperlink{class_make_macro_undo_a40cb8495566f2ffe69963a69a684f118}{undo}} () const override
\item 
int \mbox{\hyperlink{class_make_macro_undo_addd41bced176bfefc5516d24aa42849d}{get\+Size}} () const override
\item 
QString \mbox{\hyperlink{class_make_macro_undo_a3207629220e84b4e7abbbf2bafa7ce29}{get\+History\+String}} () override
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_make_macro_undo_af08eaed9f54bf291815286a7e3328312}{Make\+Macro\+Undo}} (\mbox{\hyperlink{class_t_macro_fx}{TMacro\+Fx}} $\ast$macro\+Fx, \mbox{\hyperlink{class_t_application}{TApplication}} $\ast$app)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_smart_pointer_t}{TFxP}} \mbox{\hyperlink{class_make_macro_undo_ac09f2f47f20d2ec5a9a050fd40fd4414}{m\+\_\+macro\+Fx}}
\item 
\mbox{\hyperlink{class_t_application}{TApplication}} $\ast$ \mbox{\hyperlink{class_make_macro_undo_adafdc05cd93980b93c7bcb6c625306c7}{m\+\_\+app}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_make_macro_undo_a91d46dfcf3d82c60ad4775384d7b5a2e}\label{class_make_macro_undo_a91d46dfcf3d82c60ad4775384d7b5a2e}} 
\index{MakeMacroUndo@{MakeMacroUndo}!MakeMacroUndo@{MakeMacroUndo}}
\index{MakeMacroUndo@{MakeMacroUndo}!MakeMacroUndo@{MakeMacroUndo}}
\doxysubsubsection{\texorpdfstring{MakeMacroUndo()}{MakeMacroUndo()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Make\+Macro\+Undo\+::\+Make\+Macro\+Undo (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{class_t_smart_pointer_t}{TFxP}} $>$ \&}]{fxs,  }\item[{\mbox{\hyperlink{class_t_application}{TApplication}} $\ast$}]{app }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01388                                                                : m\_app(app) \{}
\DoxyCodeLine{01389     initialize(fxs);}
\DoxyCodeLine{01390   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_make_macro_undo_af08eaed9f54bf291815286a7e3328312}\label{class_make_macro_undo_af08eaed9f54bf291815286a7e3328312}} 
\index{MakeMacroUndo@{MakeMacroUndo}!MakeMacroUndo@{MakeMacroUndo}}
\index{MakeMacroUndo@{MakeMacroUndo}!MakeMacroUndo@{MakeMacroUndo}}
\doxysubsubsection{\texorpdfstring{MakeMacroUndo()}{MakeMacroUndo()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily Make\+Macro\+Undo\+::\+Make\+Macro\+Undo (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_macro_fx}{TMacro\+Fx}} $\ast$}]{macro\+Fx,  }\item[{\mbox{\hyperlink{class_t_application}{TApplication}} $\ast$}]{app }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{01409       : m\_macroFx(macroFx), m\_app(app) \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_make_macro_undo_a3207629220e84b4e7abbbf2bafa7ce29}\label{class_make_macro_undo_a3207629220e84b4e7abbbf2bafa7ce29}} 
\index{MakeMacroUndo@{MakeMacroUndo}!getHistoryString@{getHistoryString}}
\index{getHistoryString@{getHistoryString}!MakeMacroUndo@{MakeMacroUndo}}
\doxysubsubsection{\texorpdfstring{getHistoryString()}{getHistoryString()}}
{\footnotesize\ttfamily QString Make\+Macro\+Undo\+::get\+History\+String (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_undo}{TUndo}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01399                                       \{}
\DoxyCodeLine{01400     \textcolor{keywordflow}{return} QObject::tr(\textcolor{stringliteral}{"{}Make Macro Fx  : \%1"{}})}
\DoxyCodeLine{01401         .arg(QString::fromStdWString(m\_macroFx-\/>getFxId()));}
\DoxyCodeLine{01402   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_make_macro_undo_addd41bced176bfefc5516d24aa42849d}\label{class_make_macro_undo_addd41bced176bfefc5516d24aa42849d}} 
\index{MakeMacroUndo@{MakeMacroUndo}!getSize@{getSize}}
\index{getSize@{getSize}!MakeMacroUndo@{MakeMacroUndo}}
\doxysubsubsection{\texorpdfstring{getSize()}{getSize()}}
{\footnotesize\ttfamily int Make\+Macro\+Undo\+::get\+Size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_undo}{TUndo}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01397 \{ \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(*this); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_make_macro_undo_a5736c9c8fcdcbbd46d0c36d8391f43f8}\label{class_make_macro_undo_a5736c9c8fcdcbbd46d0c36d8391f43f8}} 
\index{MakeMacroUndo@{MakeMacroUndo}!isConsistent@{isConsistent}}
\index{isConsistent@{isConsistent}!MakeMacroUndo@{MakeMacroUndo}}
\doxysubsubsection{\texorpdfstring{isConsistent()}{isConsistent()}}
{\footnotesize\ttfamily bool Make\+Macro\+Undo\+::is\+Consistent (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_fx_command_undo}{Fx\+Command\+Undo}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01392 \{ \textcolor{keywordflow}{return} bool(m\_macroFx); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_make_macro_undo_ad4420fe4f35b18b24a9bccbf8d5b7035}\label{class_make_macro_undo_ad4420fe4f35b18b24a9bccbf8d5b7035}} 
\index{MakeMacroUndo@{MakeMacroUndo}!redo@{redo}}
\index{redo@{redo}!MakeMacroUndo@{MakeMacroUndo}}
\doxysubsubsection{\texorpdfstring{redo()}{redo()}}
{\footnotesize\ttfamily void Make\+Macro\+Undo\+::redo (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_undo}{TUndo}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01445                                \{}
\DoxyCodeLine{01446   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh        = m\_app-\/>getCurrentXsheet()-\/>getXsheet();}
\DoxyCodeLine{01447   \mbox{\hyperlink{class_fx_dag}{FxDag}} *fxDag        = xsh-\/>\mbox{\hyperlink{class_t_xsheet_adc7c74cce346abf3699bb250eb17a9c2}{getFxDag}}();}
\DoxyCodeLine{01448   \mbox{\hyperlink{class_t_fx_set}{TFxSet}} *terminalFxs = fxDag-\/>getTerminalFxs();}
\DoxyCodeLine{01449   \mbox{\hyperlink{class_t_macro_fx}{TMacroFx}} *macroFx   = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_t_macro_fx}{TMacroFx}} *\textcolor{keyword}{>}(m\_macroFx.getPointer());}
\DoxyCodeLine{01450 }
\DoxyCodeLine{01451   ::addFxToCurrentScene(macroFx, xsh, \textcolor{keyword}{false});}
\DoxyCodeLine{01452 }
\DoxyCodeLine{01453   \textcolor{comment}{// Replace the macro's root and deal with output links}}
\DoxyCodeLine{01454   \mbox{\hyperlink{class_t_fx}{TFx}} *rootFx = macroFx-\/>getRoot();}
\DoxyCodeLine{01455   \textcolor{keywordflow}{if} (terminalFxs-\/>containsFx(rootFx)) fxDag-\/>addToXsheet(macroFx);}
\DoxyCodeLine{01456 }
\DoxyCodeLine{01457   \textcolor{keywordtype}{int} p, opCount = rootFx-\/>getOutputConnectionCount();}
\DoxyCodeLine{01458   \textcolor{keywordflow}{for} (p = opCount -\/ 1; p >= 0; -\/-\/p)}
\DoxyCodeLine{01459     rootFx-\/>getOutputConnection(p)-\/>setFx(macroFx);}
\DoxyCodeLine{01460 }
\DoxyCodeLine{01461   \textcolor{comment}{// Remove the macro's internal fxs from the scene}}
\DoxyCodeLine{01462   \textcolor{keyword}{const} std::vector<TFxP> \&fxs = macroFx-\/>getFxs();}
\DoxyCodeLine{01463 }
\DoxyCodeLine{01464   \textcolor{keywordtype}{size\_t} f, fCount = fxs.size();}
\DoxyCodeLine{01465   \textcolor{keywordflow}{for} (f = 0; f != fCount; ++f)}
\DoxyCodeLine{01466     ::removeFxFromCurrentScene(fxs[f].getPointer(), xsh);}
\DoxyCodeLine{01467 }
\DoxyCodeLine{01468   \textcolor{comment}{// Hijack their ports (no actual redirection) -\/ resetting the port ownership.}}
\DoxyCodeLine{01469   \textcolor{comment}{// NOTE: Is this even legal? Not gonna touch it, but...   o\_o!}}
\DoxyCodeLine{01470   \textcolor{keywordtype}{int} ipCount = macroFx-\/>getInputPortCount();}
\DoxyCodeLine{01471   \textcolor{keywordflow}{for} (p = 0; p != ipCount; ++p) macroFx-\/>getInputPort(p)-\/>setOwnerFx(macroFx);}
\DoxyCodeLine{01472 }
\DoxyCodeLine{01473   m\_app-\/>getCurrentFx()-\/>setFx(macroFx);}
\DoxyCodeLine{01474   m\_app-\/>getCurrentXsheet()-\/>notifyXsheetChanged();}
\DoxyCodeLine{01475 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_make_macro_undo_a40cb8495566f2ffe69963a69a684f118}\label{class_make_macro_undo_a40cb8495566f2ffe69963a69a684f118}} 
\index{MakeMacroUndo@{MakeMacroUndo}!undo@{undo}}
\index{undo@{undo}!MakeMacroUndo@{MakeMacroUndo}}
\doxysubsubsection{\texorpdfstring{undo()}{undo()}}
{\footnotesize\ttfamily void Make\+Macro\+Undo\+::undo (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_undo}{TUndo}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01479                                \{}
\DoxyCodeLine{01480   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh        = m\_app-\/>getCurrentXsheet()-\/>getXsheet();}
\DoxyCodeLine{01481   \mbox{\hyperlink{class_fx_dag}{FxDag}} *fxDag        = xsh-\/>\mbox{\hyperlink{class_t_xsheet_adc7c74cce346abf3699bb250eb17a9c2}{getFxDag}}();}
\DoxyCodeLine{01482   \mbox{\hyperlink{class_t_fx_set}{TFxSet}} *terminalFxs = fxDag-\/>getTerminalFxs();}
\DoxyCodeLine{01483   \mbox{\hyperlink{class_t_macro_fx}{TMacroFx}} *macroFx   = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_t_macro_fx}{TMacroFx}} *\textcolor{keyword}{>}(m\_macroFx.getPointer());}
\DoxyCodeLine{01484 }
\DoxyCodeLine{01485   \textcolor{comment}{// Reattach the macro's root to the xsheet if necessary}}
\DoxyCodeLine{01486   \mbox{\hyperlink{class_t_fx}{TFx}} *rootFx = macroFx-\/>getRoot();}
\DoxyCodeLine{01487   \textcolor{keywordflow}{if} (terminalFxs-\/>containsFx(macroFx)) fxDag-\/>addToXsheet(rootFx);}
\DoxyCodeLine{01488 }
\DoxyCodeLine{01489   \textcolor{comment}{// Restore the root's output connections}}
\DoxyCodeLine{01490   \textcolor{keywordtype}{int} p, opCount = macroFx-\/>getOutputConnectionCount();}
\DoxyCodeLine{01491   \textcolor{keywordflow}{for} (p = opCount -\/ 1; p >= 0; -\/-\/p)}
\DoxyCodeLine{01492     macroFx-\/>getOutputConnection(p)-\/>setFx(rootFx);}
\DoxyCodeLine{01493 }
\DoxyCodeLine{01494   \textcolor{comment}{// Remove the macro}}
\DoxyCodeLine{01495   ::removeFxFromCurrentScene(macroFx, xsh);}
\DoxyCodeLine{01496 }
\DoxyCodeLine{01497   \textcolor{comment}{// Re-\/insert the macro's internal fxs and restore ports ownership}}
\DoxyCodeLine{01498   \textcolor{keyword}{const} std::vector<TFxP> \&fxs = macroFx-\/>getFxs();}
\DoxyCodeLine{01499 }
\DoxyCodeLine{01500   \textcolor{keywordtype}{size\_t} f, fCount = fxs.size();}
\DoxyCodeLine{01501   \textcolor{keywordflow}{for} (f = 0; f != fCount; ++f) \{}
\DoxyCodeLine{01502     \mbox{\hyperlink{class_t_fx}{TFx}} *fx = fxs[f].getPointer();}
\DoxyCodeLine{01503 }
\DoxyCodeLine{01504     ::addFxToCurrentScene(fx, xsh, \textcolor{keyword}{false});}
\DoxyCodeLine{01505 }
\DoxyCodeLine{01506     \textcolor{keywordtype}{int} p, ipCount = fx-\/>getInputPortCount();}
\DoxyCodeLine{01507     \textcolor{keywordflow}{for} (p = 0; p != ipCount; ++p) fx-\/>getInputPort(p)-\/>setOwnerFx(fx);}
\DoxyCodeLine{01508   \}}
\DoxyCodeLine{01509 }
\DoxyCodeLine{01510   m\_app-\/>getCurrentFx()-\/>setFx(0);}
\DoxyCodeLine{01511   m\_app-\/>getCurrentXsheet()-\/>notifyXsheetChanged();}
\DoxyCodeLine{01512 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_make_macro_undo_adafdc05cd93980b93c7bcb6c625306c7}\label{class_make_macro_undo_adafdc05cd93980b93c7bcb6c625306c7}} 
\index{MakeMacroUndo@{MakeMacroUndo}!m\_app@{m\_app}}
\index{m\_app@{m\_app}!MakeMacroUndo@{MakeMacroUndo}}
\doxysubsubsection{\texorpdfstring{m\_app}{m\_app}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_application}{TApplication}}$\ast$ Make\+Macro\+Undo\+::m\+\_\+app\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_make_macro_undo_ac09f2f47f20d2ec5a9a050fd40fd4414}\label{class_make_macro_undo_ac09f2f47f20d2ec5a9a050fd40fd4414}} 
\index{MakeMacroUndo@{MakeMacroUndo}!m\_macroFx@{m\_macroFx}}
\index{m\_macroFx@{m\_macroFx}!MakeMacroUndo@{MakeMacroUndo}}
\doxysubsubsection{\texorpdfstring{m\_macroFx}{m\_macroFx}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_smart_pointer_t}{TFxP}} Make\+Macro\+Undo\+::m\+\_\+macro\+Fx\hspace{0.3cm}{\ttfamily [protected]}}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonzlib/fxcommand.\+cpp\end{DoxyCompactItemize}
