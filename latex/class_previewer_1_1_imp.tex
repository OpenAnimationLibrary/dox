\hypertarget{class_previewer_1_1_imp}{}\doxysection{Previewer\+::Imp Class Reference}
\label{class_previewer_1_1_imp}\index{Previewer::Imp@{Previewer::Imp}}
Inheritance diagram for Previewer\+::Imp\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_previewer_1_1_imp}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct_previewer_1_1_imp_1_1_frame_info}{Frame\+Info}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_previewer_1_1_imp_aa2aead727987d886b08234652e4217c5}{Imp}} (\mbox{\hyperlink{class_previewer}{Previewer}} $\ast$owner)
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a9c2ac6c3b2b31a0b64cb35dfc2b1efb9}{notify\+Started}} (int frame)
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a23d89b493b83c6671e23e09ac45679bc}{notify\+Completed}} (int frame)
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a449f2e6043ca93781ba380aef9810b2c}{notify\+Failed}} (int frame)
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a2ffa6df0e477e58ea66eb9fdb3f79820}{notify\+Update}} ()
\item 
\mbox{\hyperlink{class_t_fx_pair}{TFx\+Pair}} \mbox{\hyperlink{class_previewer_1_1_imp_a3eabf6d4e02c2db83a410a343f97046a}{build\+Scene\+Fx}} (int frame)
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_af0de42749c61e8ce8e222f776ac9f858}{update\+Render\+Settings}} ()
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a18890c09ee8dea06bf8ecb8bdbcb3863}{update\+Aliases}} ()
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_acccfd81480c78134e4bd6091e57c0587}{update\+Alias\+Keyword}} (const std\+::string \&keyword)
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a5d26791946e7767b4793f79e8e388b77}{update\+Frame\+Range}} ()
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a157de049fdd3dad1ca733c288e5f5aec}{update\+Progress\+Bar\+Status}} ()
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_aea673dc57ce0256e1e393e4d7d4d9f89}{update\+Camera}} ()
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a3289be6c722e30a549f302cccfb11127}{update\+Preview\+Rect}} ()
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a95c145346197a5b83b50881e565deae6}{refresh\+Frame}} (int frame)
\begin{DoxyCompactList}\small\item\em Starts rendering the passed frame. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a09c99e5bd1abe0ec80eecef1f2cbb3b1}{on\+Render\+Raster\+Started}} (const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&render\+Data) override
\begin{DoxyCompactList}\small\item\em Adds the renderized image to \mbox{\hyperlink{class_t_image_cache}{TImage\+Cache}}; listeners are advised too. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a2cc9f97e7e343094c0833aed0929dea8}{on\+Render\+Raster\+Completed}} (const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&render\+Data) override
\begin{DoxyCompactList}\small\item\em Adds the renderized image to \mbox{\hyperlink{class_t_image_cache}{TImage\+Cache}}; listeners are advised too. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_ac74d8b72e298ac99a621cb1dc9d3dea6}{on\+Render\+Failure}} (const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&render\+Data, \mbox{\hyperlink{class_t_exception}{TException}} \&e) override
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a5468acd66aafaa0f50a17b9e5028e3ba}{do\+On\+Render\+Raster\+Started}} (const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&render\+Data)
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_af6a8067ce57e08aec79d3d4a449e3064}{do\+On\+Render\+Raster\+Completed}} (const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&render\+Data)
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_acff689f2f20082d787bced65984d3207}{do\+On\+Render\+Raster\+Failed}} (const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&render\+Data)
\begin{DoxyCompactList}\small\item\em Adds the renderized image to \mbox{\hyperlink{class_t_image_cache}{TImage\+Cache}}; listeners are advised too. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a17685497a10f773cb07dbd88bc5dd12f}{remove}} (int frame)
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a25ca7bfdc5c485ada1537a6da46b5697}{remove}} ()
\item 
void \mbox{\hyperlink{class_previewer_1_1_imp_a9a00e83efd869f240d44999f3578050a}{save\+Frame}} ()
\item 
bool \mbox{\hyperlink{class_previewer_1_1_imp_a815b668daa93baf4b2781d8228f8e4bc}{do\+Save\+Rendered\+Frames}} (const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} fp)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_previewer}{Previewer}} $\ast$ \mbox{\hyperlink{class_previewer_1_1_imp_a2f5bce20463d1a7c8b9b381adc814e3e}{m\+\_\+owner}}
\item 
\mbox{\hyperlink{class_t_thread_1_1_mutex}{TThread\+::\+Mutex}} \mbox{\hyperlink{class_previewer_1_1_imp_a3ed3ece322f9d80932c22602ddd68b24}{m\+\_\+mutex}}
\item 
std\+::set$<$ \mbox{\hyperlink{class_previewer_1_1_listener}{Previewer\+::\+Listener}} $\ast$ $>$ \mbox{\hyperlink{class_previewer_1_1_imp_aabb54619f83d70cda3d9e8163076e578}{m\+\_\+listeners}}
\item 
std\+::map$<$ int, \mbox{\hyperlink{struct_previewer_1_1_imp_1_1_frame_info}{Frame\+Info}} $>$ \mbox{\hyperlink{class_previewer_1_1_imp_a9723c0b3c252de2d439e5a021a4d9ed4}{m\+\_\+frames}}
\item 
std\+::vector$<$ UCHAR $>$ \mbox{\hyperlink{class_previewer_1_1_imp_ae2744fce84cc1f9152bf7b89b008becd}{m\+\_\+pb\+Status}}
\item 
int \mbox{\hyperlink{class_previewer_1_1_imp_a02e72d95cc9ceb115e691ae7fdcfff9c}{m\+\_\+computing\+Frame\+Count}}
\item 
\mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \mbox{\hyperlink{class_previewer_1_1_imp_a463d9d9789b2aecef24254b9c46053c6}{m\+\_\+render\+Settings}}
\item 
std\+::string \mbox{\hyperlink{class_previewer_1_1_imp_a34734121fc7deb3a1ca1c8248e68fed6}{m\+\_\+cache\+Prefix}}
\item 
\mbox{\hyperlink{class_t_dimension_t}{TDimension}} \mbox{\hyperlink{class_previewer_1_1_imp_a8aa27d993868a0ed60ca1815147e0c14}{m\+\_\+camera\+Res}}
\item 
\mbox{\hyperlink{class_t_rect_t}{TRectD}} \mbox{\hyperlink{class_previewer_1_1_imp_a50a4a78d063d11fd6a7f76aa55fa1e03}{m\+\_\+render\+Area}}
\item 
\mbox{\hyperlink{class_t_point_t}{TPointD}} \mbox{\hyperlink{class_previewer_1_1_imp_a113a6e96c22b646420955bbb4cbbbd0a}{m\+\_\+camera\+Pos}}
\item 
bool \mbox{\hyperlink{class_previewer_1_1_imp_abac8cc825071e7b8901fcf59b69ceffd}{m\+\_\+subcamera}}
\item 
\mbox{\hyperlink{class_t_rect_t}{TRect}} \mbox{\hyperlink{class_previewer_1_1_imp_a338039985084e08e2d3ffd8b0169be9f}{m\+\_\+preview\+Rect}}
\item 
\mbox{\hyperlink{class_t_renderer}{TRenderer}} \mbox{\hyperlink{class_previewer_1_1_imp_aa8c026c96de1931a6c289bfec0cd4fc2}{m\+\_\+renderer}}
\item 
\mbox{\hyperlink{class_t_level_writer_p}{TLevel\+WriterP}} \mbox{\hyperlink{class_previewer_1_1_imp_ab30be60487f91f8cfea3a46944cc253a}{m\+\_\+lw}}
\item 
int \mbox{\hyperlink{class_previewer_1_1_imp_a66e2f42034b2d83c4317a2d4b1664f22}{m\+\_\+current\+Frame\+To\+Save}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_previewer_1_1_imp_aa2aead727987d886b08234652e4217c5}\label{class_previewer_1_1_imp_aa2aead727987d886b08234652e4217c5}} 
\index{Previewer::Imp@{Previewer::Imp}!Imp@{Imp}}
\index{Imp@{Imp}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{Imp()}{Imp()}}
{\footnotesize\ttfamily Previewer\+::\+Imp\+::\+Imp (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_previewer}{Previewer}} $\ast$}]{owner }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00237     : m\_owner(owner)}
\DoxyCodeLine{00238     , m\_cameraRes(0, 0)}
\DoxyCodeLine{00239     , m\_renderer(TSystem::getProcessorCount())}
\DoxyCodeLine{00240     , m\_computingFrameCount(0)}
\DoxyCodeLine{00241     , m\_currentFrameToSave(0)}
\DoxyCodeLine{00242     , m\_subcamera(\textcolor{keyword}{false})}
\DoxyCodeLine{00243     , m\_lw() \{}
\DoxyCodeLine{00244   \textcolor{comment}{// Precomputing (ie predictive cache) is disabled in this case. This is due to}}
\DoxyCodeLine{00245   \textcolor{comment}{// current TFxCacheManager's}}
\DoxyCodeLine{00246   \textcolor{comment}{// implementation, which can't still handle multiple render processes from the}}
\DoxyCodeLine{00247   \textcolor{comment}{// same TRenderer. This should}}
\DoxyCodeLine{00248   \textcolor{comment}{// change in the near future...}}
\DoxyCodeLine{00249   m\_renderer.enablePrecomputing(\textcolor{keyword}{false});}
\DoxyCodeLine{00250   m\_renderer.addPort(\textcolor{keyword}{this});}
\DoxyCodeLine{00251 }
\DoxyCodeLine{00252   updateRenderSettings();}
\DoxyCodeLine{00253   updateCamera();}
\DoxyCodeLine{00254   updateFrameRange();}
\DoxyCodeLine{00255 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a1ab70660329d62375310c8a0c194db08}\label{class_previewer_1_1_imp_a1ab70660329d62375310c8a0c194db08}} 
\index{Previewer::Imp@{Previewer::Imp}!````~Imp@{$\sim$Imp}}
\index{````~Imp@{$\sim$Imp}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{$\sim$Imp()}{~Imp()}}
{\footnotesize\ttfamily Previewer\+::\+Imp\+::$\sim$\+Imp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00259                    \{}
\DoxyCodeLine{00260   m\_renderer.removePort(\textcolor{keyword}{this});}
\DoxyCodeLine{00261 }
\DoxyCodeLine{00262   \textcolor{comment}{// for(std::map<int, FrameInfo*>::iterator it=m\_frames.begin();}}
\DoxyCodeLine{00263   \textcolor{comment}{// it!=m\_frames.end(); ++it)}}
\DoxyCodeLine{00264   \textcolor{comment}{//  delete it-\/>second; //crash on exit! not a serious leak, Previewer is a}}
\DoxyCodeLine{00265   \textcolor{comment}{//  singleton}}
\DoxyCodeLine{00266 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_previewer_1_1_imp_a3eabf6d4e02c2db83a410a343f97046a}\label{class_previewer_1_1_imp_a3eabf6d4e02c2db83a410a343f97046a}} 
\index{Previewer::Imp@{Previewer::Imp}!buildSceneFx@{buildSceneFx}}
\index{buildSceneFx@{buildSceneFx}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{buildSceneFx()}{buildSceneFx()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_fx_pair}{TFx\+Pair}} Previewer\+::\+Imp\+::build\+Scene\+Fx (\begin{DoxyParamCaption}\item[{int}]{frame }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00270                                             \{}
\DoxyCodeLine{00271   \mbox{\hyperlink{class_t_fx_pair}{TFxPair}} fxPair;}
\DoxyCodeLine{00272 }
\DoxyCodeLine{00273   \mbox{\hyperlink{class_t_app}{TApp}} *app         = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{00274   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene = app-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{00275   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh      = scene-\/>\mbox{\hyperlink{class_toonz_scene_ae3c828e3223fd809fd59189233d0576a}{getXsheet}}();}
\DoxyCodeLine{00276   \textcolor{keywordflow}{if} (m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_aadbd5a3a50b242b366a93023d5f7da07}{m\_stereoscopic}}) \{}
\DoxyCodeLine{00277     scene-\/>shiftCameraX(-\/m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a8c9cade2391a50017b4ad623f653c82f}{m\_stereoscopicShift}} / 2.0);}
\DoxyCodeLine{00278     fxPair.m\_frameA = ::buildSceneFx(}
\DoxyCodeLine{00279         scene, xsh, frame, TOutputProperties::AllLevels,}
\DoxyCodeLine{00280         m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a64acc2c6ba75292c0a0f9d101ddacc3b}{m\_applyShrinkToViewer}} ? m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a52dd41881bbf6aaf953fe300be2e233e}{m\_shrinkX}} : 1,}
\DoxyCodeLine{00281         \textcolor{keyword}{false});}
\DoxyCodeLine{00282 }
\DoxyCodeLine{00283     scene-\/>shiftCameraX(m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a8c9cade2391a50017b4ad623f653c82f}{m\_stereoscopicShift}});}
\DoxyCodeLine{00284     fxPair.m\_frameB = ::buildSceneFx(}
\DoxyCodeLine{00285         scene, xsh, frame, TOutputProperties::AllLevels,}
\DoxyCodeLine{00286         m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a64acc2c6ba75292c0a0f9d101ddacc3b}{m\_applyShrinkToViewer}} ? m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a52dd41881bbf6aaf953fe300be2e233e}{m\_shrinkX}} : 1,}
\DoxyCodeLine{00287         \textcolor{keyword}{false});}
\DoxyCodeLine{00288 }
\DoxyCodeLine{00289     scene-\/>shiftCameraX(-\/m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a8c9cade2391a50017b4ad623f653c82f}{m\_stereoscopicShift}} / 2.0);}
\DoxyCodeLine{00290   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00291     fxPair.m\_frameA = ::buildSceneFx(}
\DoxyCodeLine{00292         scene, xsh, frame, TOutputProperties::AllLevels,}
\DoxyCodeLine{00293         m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a64acc2c6ba75292c0a0f9d101ddacc3b}{m\_applyShrinkToViewer}} ? m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a52dd41881bbf6aaf953fe300be2e233e}{m\_shrinkX}} : 1,}
\DoxyCodeLine{00294         \textcolor{keyword}{false});}
\DoxyCodeLine{00295 }
\DoxyCodeLine{00296   \textcolor{keywordflow}{return} fxPair;}
\DoxyCodeLine{00297 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_af6a8067ce57e08aec79d3d4a449e3064}\label{class_previewer_1_1_imp_af6a8067ce57e08aec79d3d4a449e3064}} 
\index{Previewer::Imp@{Previewer::Imp}!doOnRenderRasterCompleted@{doOnRenderRasterCompleted}}
\index{doOnRenderRasterCompleted@{doOnRenderRasterCompleted}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{doOnRenderRasterCompleted()}{doOnRenderRasterCompleted()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::do\+On\+Render\+Raster\+Completed (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&}]{render\+Data }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00667                                                                          \{}
\DoxyCodeLine{00668   \textcolor{keywordtype}{int} renderId = renderData.m\_renderId;}
\DoxyCodeLine{00669   \textcolor{keywordtype}{int} frame    = renderData.m\_frames[0];}
\DoxyCodeLine{00670 }
\DoxyCodeLine{00671   \textcolor{keywordflow}{if} (renderData.m\_rasB) \{}
\DoxyCodeLine{00672     assert(m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_aadbd5a3a50b242b366a93023d5f7da07}{m\_stereoscopic}});}
\DoxyCodeLine{00673     TRop::makeStereoRaster(renderData.m\_rasA, renderData.m\_rasB);}
\DoxyCodeLine{00674   \}}
\DoxyCodeLine{00675 }
\DoxyCodeLine{00676   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} ras(renderData.m\_rasA);}
\DoxyCodeLine{00677 }
\DoxyCodeLine{00678   m\_computingFrameCount-\/-\/;}
\DoxyCodeLine{00679 }
\DoxyCodeLine{00680   \textcolor{comment}{// Find the render infos in the Previewer}}
\DoxyCodeLine{00681   std::map<int, FrameInfo>::iterator it = m\_frames.find(frame);}
\DoxyCodeLine{00682   \textcolor{keywordflow}{if} (it == m\_frames.end()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00683 }
\DoxyCodeLine{00684   \textcolor{comment}{// Ensure that the render process id is the same}}
\DoxyCodeLine{00685   \textcolor{keywordflow}{if} (renderId != it-\/>second.m\_renderId) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00686 }
\DoxyCodeLine{00687   \textcolor{comment}{// Store the rendered image in the cache -\/ this is done in the MAIN thread due}}
\DoxyCodeLine{00688   \textcolor{comment}{// to the necessity of accessing it-\/>second.m\_rectUnderRender for raster}}
\DoxyCodeLine{00689   \textcolor{comment}{// extraction.}}
\DoxyCodeLine{00690   std::string str = m\_cachePrefix + std::to\_string(frame);}
\DoxyCodeLine{00691 }
\DoxyCodeLine{00692   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri(TImageCache::instance()-\/>get(str, \textcolor{keyword}{true}));}
\DoxyCodeLine{00693   \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} cachedRas(ri ? ri-\/>getRaster() : \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}());}
\DoxyCodeLine{00694 }
\DoxyCodeLine{00695   \textcolor{keywordflow}{if} (!cachedRas || (cachedRas-\/>getSize() != m\_cameraRes)) \{}
\DoxyCodeLine{00696     TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a57d63227dfe2532b0aed22c47113be66}{remove}}(str);}
\DoxyCodeLine{00697 }
\DoxyCodeLine{00698     \textcolor{comment}{// Create the raster at camera resolution}}
\DoxyCodeLine{00699     cachedRas = ras-\/>create(m\_cameraRes.lx, m\_cameraRes.ly);}
\DoxyCodeLine{00700     cachedRas-\/>clear();}
\DoxyCodeLine{00701     ri = \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}}(cachedRas);}
\DoxyCodeLine{00702   \}}
\DoxyCodeLine{00703 }
\DoxyCodeLine{00704   \textcolor{comment}{// Finally, copy the rendered raster over the cached one}}
\DoxyCodeLine{00705   \mbox{\hyperlink{class_t_rect_t}{TRect}} rectUnderRender(}
\DoxyCodeLine{00706       it-\/>second}
\DoxyCodeLine{00707           .m\_rectUnderRender);  \textcolor{comment}{// Extract may MODIFY IT! E.g. with shrinks..!}}
\DoxyCodeLine{00708   cachedRas = cachedRas-\/>extract(rectUnderRender);}
\DoxyCodeLine{00709   \textcolor{keywordflow}{if} (cachedRas) \{}
\DoxyCodeLine{00710     cachedRas-\/>copy(ras);}
\DoxyCodeLine{00711     TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a124eae4cf370288f42c22b3477cb5163}{add}}(str, ri);}
\DoxyCodeLine{00712   \}}
\DoxyCodeLine{00713 }
\DoxyCodeLine{00714   \textcolor{comment}{// Update the FrameInfo}}
\DoxyCodeLine{00715   it-\/>second.m\_renderedRegion += toQRect(it-\/>second.m\_rectUnderRender);}
\DoxyCodeLine{00716   it-\/>second.m\_rectUnderRender = \mbox{\hyperlink{class_t_rect_t}{TRect}}();}
\DoxyCodeLine{00717 }
\DoxyCodeLine{00718   \textcolor{comment}{// Update the progress bar status}}
\DoxyCodeLine{00719   \textcolor{keywordflow}{if} (frame < m\_pbStatus.size())}
\DoxyCodeLine{00720     m\_pbStatus[frame] = FlipSlider::PBFrameFinished;}
\DoxyCodeLine{00721 }
\DoxyCodeLine{00722   \textcolor{comment}{// Notify listeners}}
\DoxyCodeLine{00723   notifyCompleted(frame);}
\DoxyCodeLine{00724 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_acff689f2f20082d787bced65984d3207}\label{class_previewer_1_1_imp_acff689f2f20082d787bced65984d3207}} 
\index{Previewer::Imp@{Previewer::Imp}!doOnRenderRasterFailed@{doOnRenderRasterFailed}}
\index{doOnRenderRasterFailed@{doOnRenderRasterFailed}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{doOnRenderRasterFailed()}{doOnRenderRasterFailed()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::do\+On\+Render\+Raster\+Failed (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&}]{render\+Data }\end{DoxyParamCaption})}



Adds the renderized image to \mbox{\hyperlink{class_t_image_cache}{TImage\+Cache}}; listeners are advised too. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00738                                                                       \{}
\DoxyCodeLine{00739   m\_computingFrameCount-\/-\/;}
\DoxyCodeLine{00740 }
\DoxyCodeLine{00741   \textcolor{keywordtype}{int} frame = (int)renderData.m\_frames[0];}
\DoxyCodeLine{00742 }
\DoxyCodeLine{00743   std::map<int, FrameInfo>::iterator it = m\_frames.find(frame);}
\DoxyCodeLine{00744   \textcolor{keywordflow}{if} (it == m\_frames.end()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00745 }
\DoxyCodeLine{00746   \textcolor{keywordflow}{if} (renderData.m\_renderId != it-\/>second.m\_renderId) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00747 }
\DoxyCodeLine{00748   it-\/>second.m\_renderedRegion  = QRegion();}
\DoxyCodeLine{00749   it-\/>second.m\_rectUnderRender = \mbox{\hyperlink{class_t_rect_t}{TRect}}();}
\DoxyCodeLine{00750 }
\DoxyCodeLine{00751   \textcolor{comment}{// Update the progress bar status}}
\DoxyCodeLine{00752   \textcolor{keywordflow}{if} (frame < m\_pbStatus.size())}
\DoxyCodeLine{00753     m\_pbStatus[frame] = FlipSlider::PBFrameNotStarted;}
\DoxyCodeLine{00754 }
\DoxyCodeLine{00755   notifyCompleted(frame);  \textcolor{comment}{// Completed!?}}
\DoxyCodeLine{00756 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00092}{TRender\+Port\+::\+Render\+Data\+::m\+\_\+frames}}, and \mbox{\hyperlink{l00096}{TRender\+Port\+::\+Render\+Data\+::m\+\_\+render\+Id}}.

\mbox{\Hypertarget{class_previewer_1_1_imp_a5468acd66aafaa0f50a17b9e5028e3ba}\label{class_previewer_1_1_imp_a5468acd66aafaa0f50a17b9e5028e3ba}} 
\index{Previewer::Imp@{Previewer::Imp}!doOnRenderRasterStarted@{doOnRenderRasterStarted}}
\index{doOnRenderRasterStarted@{doOnRenderRasterStarted}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{doOnRenderRasterStarted()}{doOnRenderRasterStarted()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::do\+On\+Render\+Raster\+Started (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&}]{render\+Data }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00629                                                                        \{}
\DoxyCodeLine{00630   \textcolor{keywordtype}{int} frame = renderData.m\_frames[0];}
\DoxyCodeLine{00631 }
\DoxyCodeLine{00632   m\_computingFrameCount++;}
\DoxyCodeLine{00633 }
\DoxyCodeLine{00634   \textcolor{comment}{// Update the progress bar status}}
\DoxyCodeLine{00635   \textcolor{keywordflow}{if} (frame < m\_pbStatus.size()) m\_pbStatus[frame] = FlipSlider::PBFrameStarted;}
\DoxyCodeLine{00636 }
\DoxyCodeLine{00637   \textcolor{comment}{// Notify listeners}}
\DoxyCodeLine{00638   notifyStarted(frame);}
\DoxyCodeLine{00639 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a815b668daa93baf4b2781d8228f8e4bc}\label{class_previewer_1_1_imp_a815b668daa93baf4b2781d8228f8e4bc}} 
\index{Previewer::Imp@{Previewer::Imp}!doSaveRenderedFrames@{doSaveRenderedFrames}}
\index{doSaveRenderedFrames@{doSaveRenderedFrames}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{doSaveRenderedFrames()}{doSaveRenderedFrames()}}
{\footnotesize\ttfamily bool Previewer\+::\+Imp\+::do\+Save\+Rendered\+Frames (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}}}]{fp }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00841                                                     \{}
\DoxyCodeLine{00842   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{00843   \mbox{\hyperlink{class_t_output_properties}{TOutputProperties}} *outputSettings =}
\DoxyCodeLine{00844       scene-\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}()-\/>\mbox{\hyperlink{class_t_scene_properties_abea7b4b8e4f0cedbf753b26ec30b5331}{getOutputProperties}}();}
\DoxyCodeLine{00845 }
\DoxyCodeLine{00846   QStringList formats;}
\DoxyCodeLine{00847   TLevelWriter::getSupportedFormats(formats, \textcolor{keyword}{true});}
\DoxyCodeLine{00848   Tiio::Writer::getSupportedFormats(formats, \textcolor{keyword}{true});}
\DoxyCodeLine{00849 }
\DoxyCodeLine{00850   std::string ext = fp.\mbox{\hyperlink{class_t_file_path_aefca624df1a5468a4c78ec6d5dbfae26}{getType}}();}
\DoxyCodeLine{00851   \textcolor{keywordflow}{if} (ext == \textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{00852     ext = outputSettings-\/>\mbox{\hyperlink{class_t_output_properties_ab082a7e84177a558484d648215e4b4f7}{getPath}}().\mbox{\hyperlink{class_t_file_path_aefca624df1a5468a4c78ec6d5dbfae26}{getType}}();}
\DoxyCodeLine{00853     fp  = fp.\mbox{\hyperlink{class_t_file_path_a1437b0e0720e9258b622f68b6858e95d}{withType}}(ext);}
\DoxyCodeLine{00854   \}}
\DoxyCodeLine{00855   \textcolor{keywordflow}{if} (fp.\mbox{\hyperlink{class_t_file_path_af94f9b0aeceb6cdb980fa1789473503a}{getName}}() == \textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{00856     DVGui::warning(QObject::tr(}
\DoxyCodeLine{00857         \textcolor{stringliteral}{"{}The file name cannot be empty or contain any of the following "{}}}
\DoxyCodeLine{00858         \textcolor{stringliteral}{"{}characters:(new line)  \(\backslash\)\(\backslash\) / : * ? \(\backslash\)"{}  |"{}}));}
\DoxyCodeLine{00859     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00860   \}}
\DoxyCodeLine{00861 }
\DoxyCodeLine{00862   \textcolor{keywordflow}{if} (!formats.contains(QString::fromStdString(ext))) \{}
\DoxyCodeLine{00863     DVGui::warning(QObject::tr(\textcolor{stringliteral}{"{}Unsopporter raster format, cannot save"{}}));}
\DoxyCodeLine{00864     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00865   \}}
\DoxyCodeLine{00866 }
\DoxyCodeLine{00867   \textcolor{keywordflow}{if} (fp.getWideName() == L\textcolor{stringliteral}{"{}"{}}) fp = fp.\mbox{\hyperlink{class_t_file_path_a3ebf9ced558cfef97a60bba536b23c6f}{withName}}(scene-\/>\mbox{\hyperlink{class_toonz_scene_a1fa0a1cbf9eb6360d980392acc99924b}{getSceneName}}());}
\DoxyCodeLine{00868   \textcolor{keywordflow}{if} (TFileType::getInfo(fp) == TFileType::RASTER\_IMAGE || ext == \textcolor{stringliteral}{"{}pct"{}} ||}
\DoxyCodeLine{00869       fp.\mbox{\hyperlink{class_t_file_path_aefca624df1a5468a4c78ec6d5dbfae26}{getType}}() == \textcolor{stringliteral}{"{}pic"{}} || ext == \textcolor{stringliteral}{"{}pict"{}})  \textcolor{comment}{// pct e' un formato"{}livello"{} (ha}}
\DoxyCodeLine{00870                                                \textcolor{comment}{// i settings di quicktime) ma}}
\DoxyCodeLine{00871                                                \textcolor{comment}{// fatto di diversi frames}}
\DoxyCodeLine{00872     fp = fp.\mbox{\hyperlink{class_t_file_path_a12f35b225e1882372ad7e02ad7fce543}{withFrame}}(TFrameId::EMPTY\_FRAME);}
\DoxyCodeLine{00873 }
\DoxyCodeLine{00874   fp          = scene-\/>\mbox{\hyperlink{class_toonz_scene_aa2ed57dfbae7f8cf02a4abe47ed533c6}{decodeFilePath}}(fp);}
\DoxyCodeLine{00875   \textcolor{keywordtype}{bool} exists = \mbox{\hyperlink{class_t_file_status}{TFileStatus}}(fp.\mbox{\hyperlink{class_t_file_path_a1f5014e9c396bc2268820c19bc15657d}{getParentDir}}()).doesExist();}
\DoxyCodeLine{00876   \textcolor{keywordflow}{if} (!exists) \{}
\DoxyCodeLine{00877     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{00878       \mbox{\hyperlink{class_t_file_path}{TFilePath}} parent = fp.\mbox{\hyperlink{class_t_file_path_a1f5014e9c396bc2268820c19bc15657d}{getParentDir}}();}
\DoxyCodeLine{00879       TSystem::mkDir(parent);}
\DoxyCodeLine{00880       DvDirModel::instance()-\/>refreshFolder(parent.\mbox{\hyperlink{class_t_file_path_a1f5014e9c396bc2268820c19bc15657d}{getParentDir}}());}
\DoxyCodeLine{00881     \} \textcolor{keywordflow}{catch} (\mbox{\hyperlink{class_t_exception}{TException}} \&e) \{}
\DoxyCodeLine{00882       error(QObject::tr(\textcolor{stringliteral}{"{}Cannot create \%1 : \%2"{}},}
\DoxyCodeLine{00883                         \textcolor{stringliteral}{"{}Previewer warning \%1:path \%2:message"{}})}
\DoxyCodeLine{00884                 .arg(toQString(fp.\mbox{\hyperlink{class_t_file_path_a1f5014e9c396bc2268820c19bc15657d}{getParentDir}}()))}
\DoxyCodeLine{00885                 .arg(QString(::to\_string(e.getMessage()).c\_str())));}
\DoxyCodeLine{00886       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00887     \} \textcolor{keywordflow}{catch} (...) \{}
\DoxyCodeLine{00888       error(QObject::tr(\textcolor{stringliteral}{"{}Cannot create \%1"{}}, \textcolor{stringliteral}{"{}Previewer warning \%1:path"{}})}
\DoxyCodeLine{00889                 .arg(toQString(fp.\mbox{\hyperlink{class_t_file_path_a1f5014e9c396bc2268820c19bc15657d}{getParentDir}}())));}
\DoxyCodeLine{00890       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00891     \}}
\DoxyCodeLine{00892   \}}
\DoxyCodeLine{00893 }
\DoxyCodeLine{00894   \textcolor{keywordflow}{if} (TSystem::doesExistFileOrLevel(fp)) \{}
\DoxyCodeLine{00895     QString question(}
\DoxyCodeLine{00896         QObject::tr(\textcolor{stringliteral}{"{}File \%1 already exists.\(\backslash\)nDo you want to overwrite it?"{}})}
\DoxyCodeLine{00897             .arg(toQString(fp)));}
\DoxyCodeLine{00898     \textcolor{keywordtype}{int} ret = DVGui::MsgBox(question, QObject::tr(\textcolor{stringliteral}{"{}Overwrite"{}}),}
\DoxyCodeLine{00899                             QObject::tr(\textcolor{stringliteral}{"{}Cancel"{}}), 0);}
\DoxyCodeLine{00900     \textcolor{keywordflow}{if} (ret == 2) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00901   \}}
\DoxyCodeLine{00902 }
\DoxyCodeLine{00903   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{00904     m\_lw = \mbox{\hyperlink{class_t_level_writer_p}{TLevelWriterP}}(fp,}
\DoxyCodeLine{00905                          outputSettings-\/>\mbox{\hyperlink{class_t_output_properties_a9ef174e6f6239219fa563b037246c8d4}{getFileFormatProperties}}(fp.\mbox{\hyperlink{class_t_file_path_aefca624df1a5468a4c78ec6d5dbfae26}{getType}}()));}
\DoxyCodeLine{00906   \} \textcolor{keywordflow}{catch} (\mbox{\hyperlink{class_t_image_exception}{TImageException}} \&e) \{}
\DoxyCodeLine{00907     error(QString::fromStdString(::to\_string(e.getMessage())));}
\DoxyCodeLine{00908     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00909   \}}
\DoxyCodeLine{00910 }
\DoxyCodeLine{00911   m\_lw-\/>setFrameRate(outputSettings-\/>\mbox{\hyperlink{class_t_output_properties_a0d9662971bc33097aa1b55111965b967}{getFrameRate}}());}
\DoxyCodeLine{00912 }
\DoxyCodeLine{00913   m\_currentFrameToSave = 1;}
\DoxyCodeLine{00914 }
\DoxyCodeLine{00915   ProgressBarMessager(}
\DoxyCodeLine{00916       eBegin,}
\DoxyCodeLine{00917       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getCurrentXsheet()-\/>getXsheet()-\/>getFrameCount())}
\DoxyCodeLine{00918       .sendBlocking();}
\DoxyCodeLine{00919 }
\DoxyCodeLine{00920   QTimer::singleShot(50, m\_owner, SLOT(saveFrame()));}
\DoxyCodeLine{00921   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00922 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a23d89b493b83c6671e23e09ac45679bc}\label{class_previewer_1_1_imp_a23d89b493b83c6671e23e09ac45679bc}} 
\index{Previewer::Imp@{Previewer::Imp}!notifyCompleted@{notifyCompleted}}
\index{notifyCompleted@{notifyCompleted}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{notifyCompleted()}{notifyCompleted()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::notify\+Completed (\begin{DoxyParamCaption}\item[{int}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00597                                                    \{}
\DoxyCodeLine{00598   std::set<Previewer::Listener *>::iterator it;}
\DoxyCodeLine{00599   \textcolor{keywordflow}{for} (it = m\_listeners.begin(); it != m\_listeners.end(); ++it)}
\DoxyCodeLine{00600     (*it)-\/>onRenderCompleted(frame);}
\DoxyCodeLine{00601 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a449f2e6043ca93781ba380aef9810b2c}\label{class_previewer_1_1_imp_a449f2e6043ca93781ba380aef9810b2c}} 
\index{Previewer::Imp@{Previewer::Imp}!notifyFailed@{notifyFailed}}
\index{notifyFailed@{notifyFailed}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{notifyFailed()}{notifyFailed()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::notify\+Failed (\begin{DoxyParamCaption}\item[{int}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00605                                                 \{}
\DoxyCodeLine{00606   std::set<Previewer::Listener *>::iterator it;}
\DoxyCodeLine{00607   \textcolor{keywordflow}{for} (it = m\_listeners.begin(); it != m\_listeners.end(); ++it)}
\DoxyCodeLine{00608     (*it)-\/>onRenderFailed(frame);}
\DoxyCodeLine{00609 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a9c2ac6c3b2b31a0b64cb35dfc2b1efb9}\label{class_previewer_1_1_imp_a9c2ac6c3b2b31a0b64cb35dfc2b1efb9}} 
\index{Previewer::Imp@{Previewer::Imp}!notifyStarted@{notifyStarted}}
\index{notifyStarted@{notifyStarted}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{notifyStarted()}{notifyStarted()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::notify\+Started (\begin{DoxyParamCaption}\item[{int}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00589                                                  \{}
\DoxyCodeLine{00590   std::set<Previewer::Listener *>::iterator it;}
\DoxyCodeLine{00591   \textcolor{keywordflow}{for} (it = m\_listeners.begin(); it != m\_listeners.end(); ++it)}
\DoxyCodeLine{00592     (*it)-\/>onRenderStarted(frame);}
\DoxyCodeLine{00593 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a2ffa6df0e477e58ea66eb9fdb3f79820}\label{class_previewer_1_1_imp_a2ffa6df0e477e58ea66eb9fdb3f79820}} 
\index{Previewer::Imp@{Previewer::Imp}!notifyUpdate@{notifyUpdate}}
\index{notifyUpdate@{notifyUpdate}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{notifyUpdate()}{notifyUpdate()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::notify\+Update (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00613                                        \{}
\DoxyCodeLine{00614   std::set<Previewer::Listener *>::iterator it;}
\DoxyCodeLine{00615   \textcolor{keywordflow}{for} (it = m\_listeners.begin(); it != m\_listeners.end(); ++it)}
\DoxyCodeLine{00616     (*it)-\/>onPreviewUpdate();}
\DoxyCodeLine{00617 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_ac74d8b72e298ac99a621cb1dc9d3dea6}\label{class_previewer_1_1_imp_ac74d8b72e298ac99a621cb1dc9d3dea6}} 
\index{Previewer::Imp@{Previewer::Imp}!onRenderFailure@{onRenderFailure}}
\index{onRenderFailure@{onRenderFailure}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{onRenderFailure()}{onRenderFailure()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::on\+Render\+Failure (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&}]{render\+Data,  }\item[{\mbox{\hyperlink{class_t_exception}{TException}} \&}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Removes the associated raster from \mbox{\hyperlink{class_t_image_cache}{TImage\+Cache}}, and listeners are made aware. 

Reimplemented from \mbox{\hyperlink{class_t_render_port}{TRender\+Port}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00731                                                     \{}
\DoxyCodeLine{00732   m\_owner-\/>emitFailedFrame(renderData);}
\DoxyCodeLine{00733 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a2cc9f97e7e343094c0833aed0929dea8}\label{class_previewer_1_1_imp_a2cc9f97e7e343094c0833aed0929dea8}} 
\index{Previewer::Imp@{Previewer::Imp}!onRenderRasterCompleted@{onRenderRasterCompleted}}
\index{onRenderRasterCompleted@{onRenderRasterCompleted}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{onRenderRasterCompleted()}{onRenderRasterCompleted()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::on\+Render\+Raster\+Completed (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&}]{render\+Data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Adds the renderized image to \mbox{\hyperlink{class_t_image_cache}{TImage\+Cache}}; listeners are advised too. 



Reimplemented from \mbox{\hyperlink{class_t_render_port}{TRender\+Port}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00644                                                                        \{}
\DoxyCodeLine{00645   \textcolor{keywordflow}{if} (renderData.m\_rasB) \{}
\DoxyCodeLine{00646     RenderData \_renderData = renderData;}
\DoxyCodeLine{00647     assert(m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_aadbd5a3a50b242b366a93023d5f7da07}{m\_stereoscopic}});}
\DoxyCodeLine{00648     TRop::makeStereoRaster(\_renderData.m\_rasA, \_renderData.m\_rasB);}
\DoxyCodeLine{00649     \textcolor{keywordflow}{if} (\_renderData.m\_info.m\_gamma != 1.0)}
\DoxyCodeLine{00650       \mbox{\hyperlink{namespace_t_rop_ad4babe6813c171b27ede85b106642bf2}{TRop::gammaCorrect}}(\_renderData.m\_rasA, \_renderData.m\_info.m\_gamma);}
\DoxyCodeLine{00651 }
\DoxyCodeLine{00652     \_renderData.m\_rasB = \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}}();}
\DoxyCodeLine{00653     m\_owner-\/>emitRenderedFrame(\_renderData);}
\DoxyCodeLine{00654     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00655   \}}
\DoxyCodeLine{00656 }
\DoxyCodeLine{00657   \textcolor{comment}{// If required, correct gamma}}
\DoxyCodeLine{00658   \textcolor{keywordflow}{if} (renderData.m\_info.m\_gamma != 1.0)}
\DoxyCodeLine{00659     \mbox{\hyperlink{namespace_t_rop_ad4babe6813c171b27ede85b106642bf2}{TRop::gammaCorrect}}(renderData.m\_rasA, renderData.m\_info.m\_gamma);}
\DoxyCodeLine{00660 }
\DoxyCodeLine{00661   \textcolor{comment}{// Emit the started signal to execute code in the main thread}}
\DoxyCodeLine{00662   m\_owner-\/>emitRenderedFrame(renderData);}
\DoxyCodeLine{00663 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00173}{TRop\+::gamma\+Correct()}}, \mbox{\hyperlink{l00106}{TRender\+Settings\+::m\+\_\+gamma}}, \mbox{\hyperlink{l00093}{TRender\+Port\+::\+Render\+Data\+::m\+\_\+info}}, \mbox{\hyperlink{l00094}{TRender\+Port\+::\+Render\+Data\+::m\+\_\+rasB}}, and \mbox{\hyperlink{l00133}{TRender\+Settings\+::m\+\_\+stereoscopic}}.

\mbox{\Hypertarget{class_previewer_1_1_imp_a09c99e5bd1abe0ec80eecef1f2cbb3b1}\label{class_previewer_1_1_imp_a09c99e5bd1abe0ec80eecef1f2cbb3b1}} 
\index{Previewer::Imp@{Previewer::Imp}!onRenderRasterStarted@{onRenderRasterStarted}}
\index{onRenderRasterStarted@{onRenderRasterStarted}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{onRenderRasterStarted()}{onRenderRasterStarted()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::on\+Render\+Raster\+Started (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_t_render_port_1_1_render_data}{Render\+Data}} \&}]{render\+Data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Adds the renderized image to \mbox{\hyperlink{class_t_image_cache}{TImage\+Cache}}; listeners are advised too. 



Reimplemented from \mbox{\hyperlink{class_t_render_port}{TRender\+Port}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00622                                                                      \{}
\DoxyCodeLine{00623   \textcolor{comment}{// Emit the started signal to execute code in the main thread}}
\DoxyCodeLine{00624   m\_owner-\/>emitStartedFrame(renderData);}
\DoxyCodeLine{00625 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a95c145346197a5b83b50881e565deae6}\label{class_previewer_1_1_imp_a95c145346197a5b83b50881e565deae6}} 
\index{Previewer::Imp@{Previewer::Imp}!refreshFrame@{refreshFrame}}
\index{refreshFrame@{refreshFrame}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{refreshFrame()}{refreshFrame()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::refresh\+Frame (\begin{DoxyParamCaption}\item[{int}]{frame }\end{DoxyParamCaption})}



Starts rendering the passed frame. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00508                                          \{}
\DoxyCodeLine{00509   \textcolor{keywordflow}{if} (suspendedRendering) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00510 }
\DoxyCodeLine{00511   \textcolor{comment}{// Build the region to render}}
\DoxyCodeLine{00512   updatePreviewRect();}
\DoxyCodeLine{00513 }
\DoxyCodeLine{00514   \textcolor{keywordflow}{if} (m\_previewRect.getLx() <= 0 || m\_previewRect.getLy() <= 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00515 }
\DoxyCodeLine{00516   \textcolor{comment}{// Retrieve the FrameInfo for passed frame}}
\DoxyCodeLine{00517   std::map<int, FrameInfo>::iterator it = m\_frames.find(frame);}
\DoxyCodeLine{00518   \textcolor{keywordflow}{if} (it != m\_frames.end()) \{}
\DoxyCodeLine{00519     \textcolor{comment}{// In case the rect we would render is contained in the frame's rendered}}
\DoxyCodeLine{00520     \textcolor{comment}{// region, quit}}
\DoxyCodeLine{00521     \textcolor{keywordflow}{if} (::contains(it-\/>second.m\_renderedRegion, m\_previewRect)) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00522 }
\DoxyCodeLine{00523     \textcolor{comment}{// Then, check the m\_previewRect against the frame's m\_rectUnderRendering.}}
\DoxyCodeLine{00524     \textcolor{comment}{// Ensure that we're not re-\/launching the very same render.}}
\DoxyCodeLine{00525     \textcolor{keywordflow}{if} (it-\/>second.m\_rectUnderRender == m\_previewRect) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00526 }
\DoxyCodeLine{00527     \textcolor{comment}{// Stop any frame's previously running render process}}
\DoxyCodeLine{00528     m\_renderer.abortRendering(it-\/>second.m\_renderId);}
\DoxyCodeLine{00529   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00530     it = m\_frames.insert(std::make\_pair(frame, FrameInfo())).first;}
\DoxyCodeLine{00531 }
\DoxyCodeLine{00532     \textcolor{comment}{// In case the frame is not in the frame range, we add a temporary}}
\DoxyCodeLine{00533     \textcolor{comment}{// supplement}}
\DoxyCodeLine{00534     \textcolor{comment}{// to the progress bar.}}
\DoxyCodeLine{00535     \textcolor{keywordflow}{if} (frame >= (\textcolor{keywordtype}{int})m\_pbStatus.size()) m\_pbStatus.resize(frame + 1);}
\DoxyCodeLine{00536   \}}
\DoxyCodeLine{00537 }
\DoxyCodeLine{00538   \textcolor{comment}{// Build the TFxPair to be passed to TRenderer}}
\DoxyCodeLine{00539   \mbox{\hyperlink{class_t_fx_pair}{TFxPair}} fxPair = buildSceneFx(frame);}
\DoxyCodeLine{00540 }
\DoxyCodeLine{00541   \textcolor{comment}{// Update the RenderInfos associated with frame}}
\DoxyCodeLine{00542   it-\/>second.m\_rectUnderRender = m\_previewRect;}
\DoxyCodeLine{00543   it-\/>second.m\_alias = fxPair.m\_frameA-\/>getAlias(frame, m\_renderSettings);}
\DoxyCodeLine{00544   \textcolor{keywordflow}{if} (fxPair.m\_frameB)}
\DoxyCodeLine{00545     it-\/>second.m\_alias =}
\DoxyCodeLine{00546         it-\/>second.m\_alias + fxPair.m\_frameB-\/>getAlias(frame, m\_renderSettings);}
\DoxyCodeLine{00547 }
\DoxyCodeLine{00548   \textcolor{comment}{// Retrieve the renderId of the rendering instance}}
\DoxyCodeLine{00549   it-\/>second.m\_renderId = m\_renderer.\mbox{\hyperlink{class_t_renderer_ac1b42ae5657a273ae50ba451768363f6}{nextRenderId}}();}
\DoxyCodeLine{00550   std::string contextName(\textcolor{stringliteral}{"{}P"{}});}
\DoxyCodeLine{00551   contextName += m\_subcamera ? \textcolor{stringliteral}{"{}SC"{}} : \textcolor{stringliteral}{"{}FU"{}};}
\DoxyCodeLine{00552   contextName += std::to\_string(frame);}
\DoxyCodeLine{00553   TPassiveCacheManager::instance()-\/>setContextName(it-\/>second.m\_renderId,}
\DoxyCodeLine{00554                                                    contextName);}
\DoxyCodeLine{00555 }
\DoxyCodeLine{00556   \textcolor{comment}{// Start the render}}
\DoxyCodeLine{00557   m\_renderer.\mbox{\hyperlink{class_t_renderer_a478735dc2935569993603911e116e0f5}{startRendering}}(frame, m\_renderSettings, fxPair);}
\DoxyCodeLine{00558 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00503}{TRenderer\+::next\+Render\+Id()}}, and \mbox{\hyperlink{l00638}{TRenderer\+::start\+Rendering()}}.

\mbox{\Hypertarget{class_previewer_1_1_imp_a25ca7bfdc5c485ada1537a6da46b5697}\label{class_previewer_1_1_imp_a25ca7bfdc5c485ada1537a6da46b5697}} 
\index{Previewer::Imp@{Previewer::Imp}!remove@{remove}}
\index{remove@{remove}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{remove()}{remove()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::remove (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00576                           \{}
\DoxyCodeLine{00577   m\_renderer.stopRendering(\textcolor{keyword}{false});}
\DoxyCodeLine{00578 }
\DoxyCodeLine{00579   \textcolor{comment}{// Remove all cached images}}
\DoxyCodeLine{00580   std::map<int, FrameInfo>::iterator it;}
\DoxyCodeLine{00581   \textcolor{keywordflow}{for} (it = m\_frames.begin(); it != m\_frames.end(); ++it)}
\DoxyCodeLine{00582     TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a57d63227dfe2532b0aed22c47113be66}{remove}}(m\_cachePrefix + std::to\_string(it-\/>first));}
\DoxyCodeLine{00583 }
\DoxyCodeLine{00584   m\_frames.clear();}
\DoxyCodeLine{00585 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a17685497a10f773cb07dbd88bc5dd12f}\label{class_previewer_1_1_imp_a17685497a10f773cb07dbd88bc5dd12f}} 
\index{Previewer::Imp@{Previewer::Imp}!remove@{remove}}
\index{remove@{remove}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{remove()}{remove()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::remove (\begin{DoxyParamCaption}\item[{int}]{frame }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00562                                    \{}
\DoxyCodeLine{00563   \textcolor{comment}{// Search the frame among rendered ones}}
\DoxyCodeLine{00564   std::map<int, FrameInfo>::iterator it = m\_frames.find(frame);}
\DoxyCodeLine{00565   \textcolor{keywordflow}{if} (it != m\_frames.end()) \{}
\DoxyCodeLine{00566     m\_renderer.abortRendering(it-\/>second.m\_renderId);}
\DoxyCodeLine{00567     m\_frames.erase(frame);}
\DoxyCodeLine{00568   \}}
\DoxyCodeLine{00569 }
\DoxyCodeLine{00570   \textcolor{comment}{// Remove the associated image from cache}}
\DoxyCodeLine{00571   TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a57d63227dfe2532b0aed22c47113be66}{remove}}(m\_cachePrefix + std::to\_string(frame));}
\DoxyCodeLine{00572 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a9a00e83efd869f240d44999f3578050a}\label{class_previewer_1_1_imp_a9a00e83efd869f240d44999f3578050a}} 
\index{Previewer::Imp@{Previewer::Imp}!saveFrame@{saveFrame}}
\index{saveFrame@{saveFrame}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{saveFrame()}{saveFrame()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::save\+Frame (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00926                              \{}
\DoxyCodeLine{00927   \textcolor{keyword}{static} \textcolor{keywordtype}{int} savedFrames = 0;}
\DoxyCodeLine{00928 }
\DoxyCodeLine{00929   \textcolor{keywordtype}{int} frameCount =}
\DoxyCodeLine{00930       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet()-\/>\mbox{\hyperlink{class_t_xsheet_a12a62da7dc04395088112e492d73374f}{getFrameCount}}();}
\DoxyCodeLine{00931 }
\DoxyCodeLine{00932   assert(Pd);}
\DoxyCodeLine{00933 }
\DoxyCodeLine{00934   \textcolor{keywordflow}{for} (; m\_currentFrameToSave <= frameCount; m\_currentFrameToSave++) \{}
\DoxyCodeLine{00935     ProgressBarMessager(eIncrement, m\_currentFrameToSave).sendBlocking();}
\DoxyCodeLine{00936     \textcolor{keywordflow}{if} (!Pd) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00937 }
\DoxyCodeLine{00938     \textcolor{comment}{// Ensure that current frame actually have to be saved}}
\DoxyCodeLine{00939     \textcolor{keywordtype}{int} currFrameToSave                   = m\_currentFrameToSave -\/ 1;}
\DoxyCodeLine{00940     std::map<int, FrameInfo>::iterator it = m\_frames.find(currFrameToSave);}
\DoxyCodeLine{00941     \textcolor{keywordflow}{if} (it == m\_frames.end()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00942 }
\DoxyCodeLine{00943     \textcolor{keywordflow}{if} (m\_pbStatus.size() < currFrameToSave ||}
\DoxyCodeLine{00944         m\_pbStatus[currFrameToSave] != FlipSlider::PBFrameFinished)}
\DoxyCodeLine{00945       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00946 }
\DoxyCodeLine{00947     \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img = TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_aea3ac2752efd6fa9689f5a7c1e895e41}{get}}(}
\DoxyCodeLine{00948         m\_cachePrefix + std::to\_string(currFrameToSave), \textcolor{keyword}{false});}
\DoxyCodeLine{00949     \textcolor{keywordflow}{if} (!img) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00950 }
\DoxyCodeLine{00951     \textcolor{comment}{// Save the frame}}
\DoxyCodeLine{00952     \mbox{\hyperlink{class_t_image_writer_p}{TImageWriterP}} writer = m\_lw-\/>getFrameWriter(\mbox{\hyperlink{class_t_frame_id}{TFrameId}}(m\_currentFrameToSave));}
\DoxyCodeLine{00953     \textcolor{keywordtype}{bool} failureOnSaving = \textcolor{keyword}{false};}
\DoxyCodeLine{00954     \textcolor{keywordflow}{if} (!writer) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00955 }
\DoxyCodeLine{00956     writer-\/>save(img);}
\DoxyCodeLine{00957     savedFrames++;}
\DoxyCodeLine{00958     m\_currentFrameToSave++;}
\DoxyCodeLine{00959     QTimer::singleShot(50, m\_owner, SLOT(saveFrame()));}
\DoxyCodeLine{00960     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00961   \}}
\DoxyCodeLine{00962 }
\DoxyCodeLine{00963   \textcolor{comment}{// Output the save result}}
\DoxyCodeLine{00964   QString str =}
\DoxyCodeLine{00965       QObject::tr(\textcolor{stringliteral}{"{}Saved \%1 frames out of \%2 in \%3"{}},}
\DoxyCodeLine{00966                   \textcolor{stringliteral}{"{}Previewer \%1:savedframes \%2:framecount \%3:filepath"{}})}
\DoxyCodeLine{00967           .arg(QString(std::to\_string(savedFrames).c\_str()))}
\DoxyCodeLine{00968           .arg(QString(std::to\_string(frameCount).c\_str()))}
\DoxyCodeLine{00969           .arg(QString(::to\_string(m\_lw-\/>getFilePath()).c\_str()));}
\DoxyCodeLine{00970 }
\DoxyCodeLine{00971   \textcolor{keywordflow}{if} (!Pd) str = QObject::tr(\textcolor{stringliteral}{"{}Canceled! "{}}, \textcolor{stringliteral}{"{}Previewer"{}}) + str;}
\DoxyCodeLine{00972 }
\DoxyCodeLine{00973   ProgressBarMessager(eEnd, 0, str).send();}
\DoxyCodeLine{00974 }
\DoxyCodeLine{00975   m\_currentFrameToSave = 0;}
\DoxyCodeLine{00976   m\_lw                 = \mbox{\hyperlink{class_t_level_writer_p}{TLevelWriterP}}();}
\DoxyCodeLine{00977   savedFrames          = 0;}
\DoxyCodeLine{00978 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a18890c09ee8dea06bf8ecb8bdbcb3863}\label{class_previewer_1_1_imp_a18890c09ee8dea06bf8ecb8bdbcb3863}} 
\index{Previewer::Imp@{Previewer::Imp}!updateAliases@{updateAliases}}
\index{updateAliases@{updateAliases}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{updateAliases()}{updateAliases()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::update\+Aliases (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00460                                  \{}
\DoxyCodeLine{00461   std::map<int, FrameInfo>::iterator it;}
\DoxyCodeLine{00462   \textcolor{keywordflow}{for} (it = m\_frames.begin(); it != m\_frames.end(); ++it) \{}
\DoxyCodeLine{00463     \mbox{\hyperlink{class_t_fx_pair}{TFxPair}} fxPair = buildSceneFx(it-\/>first);}
\DoxyCodeLine{00464 }
\DoxyCodeLine{00465     std::string newAlias =}
\DoxyCodeLine{00466         fxPair.m\_frameA ? fxPair.m\_frameA-\/>getAlias(it-\/>first, m\_renderSettings)}
\DoxyCodeLine{00467                         : \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00468     newAlias = newAlias + (fxPair.m\_frameB ? fxPair.m\_frameB-\/>getAlias(}
\DoxyCodeLine{00469                                                  it-\/>first, m\_renderSettings)}
\DoxyCodeLine{00470                                            : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00471 }
\DoxyCodeLine{00472     \textcolor{keywordflow}{if} (newAlias != it-\/>second.m\_alias) \{}
\DoxyCodeLine{00473       \textcolor{comment}{// Clear the remaining frame infos}}
\DoxyCodeLine{00474       it-\/>second.m\_renderedRegion = QRegion();}
\DoxyCodeLine{00475     \}}
\DoxyCodeLine{00476   \}}
\DoxyCodeLine{00477 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_acccfd81480c78134e4bd6091e57c0587}\label{class_previewer_1_1_imp_acccfd81480c78134e4bd6091e57c0587}} 
\index{Previewer::Imp@{Previewer::Imp}!updateAliasKeyword@{updateAliasKeyword}}
\index{updateAliasKeyword@{updateAliasKeyword}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{updateAliasKeyword()}{updateAliasKeyword()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::update\+Alias\+Keyword (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{keyword }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00481                                                               \{}
\DoxyCodeLine{00482   std::map<int, FrameInfo>::iterator it;}
\DoxyCodeLine{00483   \textcolor{keywordflow}{for} (it = m\_frames.begin(); it != m\_frames.end(); ++it) \{}
\DoxyCodeLine{00484     \textcolor{keywordflow}{if} (it-\/>second.m\_alias.find(keyword) != std::string::npos) \{}
\DoxyCodeLine{00485       \mbox{\hyperlink{class_t_fx_pair}{TFxPair}} fxPair     = buildSceneFx(it-\/>first);}
\DoxyCodeLine{00486       it-\/>second.m\_alias = fxPair.m\_frameA ? fxPair.m\_frameA-\/>getAlias(}
\DoxyCodeLine{00487                                                  it-\/>first, m\_renderSettings)}
\DoxyCodeLine{00488                                            : \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00489       it-\/>second.m\_alias = it-\/>second.m\_alias +}
\DoxyCodeLine{00490                            (fxPair.m\_frameB ? fxPair.m\_frameB-\/>getAlias(}
\DoxyCodeLine{00491                                                   it-\/>first, m\_renderSettings)}
\DoxyCodeLine{00492                                             : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00493 }
\DoxyCodeLine{00494       \textcolor{comment}{// Clear the remaining frame infos}}
\DoxyCodeLine{00495       it-\/>second.m\_renderedRegion = QRegion();}
\DoxyCodeLine{00496 }
\DoxyCodeLine{00497       \textcolor{comment}{// No need to release the cached image... eventually, clear it}}
\DoxyCodeLine{00498       \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri = TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_aea3ac2752efd6fa9689f5a7c1e895e41}{get}}(}
\DoxyCodeLine{00499           m\_cachePrefix + std::to\_string(it-\/>first), \textcolor{keyword}{true});}
\DoxyCodeLine{00500       \textcolor{keywordflow}{if} (ri) ri-\/>getRaster()-\/>clear();}
\DoxyCodeLine{00501     \}}
\DoxyCodeLine{00502   \}}
\DoxyCodeLine{00503 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_aea673dc57ce0256e1e393e4d7d4d9f89}\label{class_previewer_1_1_imp_aea673dc57ce0256e1e393e4d7d4d9f89}} 
\index{Previewer::Imp@{Previewer::Imp}!updateCamera@{updateCamera}}
\index{updateCamera@{updateCamera}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{updateCamera()}{updateCamera()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::update\+Camera (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00301                                 \{}
\DoxyCodeLine{00302   \textcolor{comment}{// Retrieve current camera}}
\DoxyCodeLine{00303   \mbox{\hyperlink{class_t_camera}{TCamera}} *currCamera =}
\DoxyCodeLine{00304       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_a750b5ab623ccec744013b0c83bf20abc}{getCurrentCamera}}();}
\DoxyCodeLine{00305   \mbox{\hyperlink{class_t_rect_t}{TRect}} subCameraRect = currCamera-\/>\mbox{\hyperlink{class_t_camera_ad95e2b9f128939f1ce9777623643c69c}{getInterestRect}}();}
\DoxyCodeLine{00306   \mbox{\hyperlink{class_t_point_t}{TPointD}} cameraPos(-\/0.5 * currCamera-\/>\mbox{\hyperlink{class_t_camera_a9a7c573e7a2c397ffae4b747809ea2a5}{getRes}}().lx,}
\DoxyCodeLine{00307                     -\/0.5 * currCamera-\/>\mbox{\hyperlink{class_t_camera_a9a7c573e7a2c397ffae4b747809ea2a5}{getRes}}().ly);}
\DoxyCodeLine{00308 }
\DoxyCodeLine{00309   \textcolor{comment}{// Update the camera region and camera stage area}}
\DoxyCodeLine{00310   \mbox{\hyperlink{class_t_dimension_t}{TDimension}} cameraRes(0, 0);}
\DoxyCodeLine{00311   \mbox{\hyperlink{class_t_rect_t}{TRectD}} renderArea;}
\DoxyCodeLine{00312 }
\DoxyCodeLine{00313   \textcolor{keywordflow}{if} (m\_subcamera \&\& subCameraRect.getLx() > 0 \&\& subCameraRect.getLy() > 0) \{}
\DoxyCodeLine{00314     cameraRes  = \mbox{\hyperlink{class_t_dimension_t}{TDimension}}(subCameraRect.getLx(), subCameraRect.getLy());}
\DoxyCodeLine{00315     renderArea = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(subCameraRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, subCameraRect.y0,}
\DoxyCodeLine{00316                         subCameraRect.x1 + 1, subCameraRect.y1 + 1) +}
\DoxyCodeLine{00317                  cameraPos;}
\DoxyCodeLine{00318   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00319     cameraRes  = currCamera-\/>\mbox{\hyperlink{class_t_camera_a9a7c573e7a2c397ffae4b747809ea2a5}{getRes}}();}
\DoxyCodeLine{00320     renderArea = \mbox{\hyperlink{class_t_rect_t}{TRectD}}(cameraPos, \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}}(cameraRes.lx, cameraRes.ly));}
\DoxyCodeLine{00321   \}}
\DoxyCodeLine{00322 }
\DoxyCodeLine{00323   \textcolor{comment}{// Add the shrink to camera res}}
\DoxyCodeLine{00324   cameraRes.lx /= m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a52dd41881bbf6aaf953fe300be2e233e}{m\_shrinkX}};}
\DoxyCodeLine{00325   cameraRes.ly /= m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_ae1882f584ce9ffad12ce6bf9ff23814c}{m\_shrinkY}};}
\DoxyCodeLine{00326 }
\DoxyCodeLine{00327   \textcolor{comment}{// Invalidate the old camera size}}
\DoxyCodeLine{00328   \textcolor{keywordflow}{if} (m\_cameraRes != cameraRes || m\_renderArea != renderArea) \{}
\DoxyCodeLine{00329     m\_cameraRes  = cameraRes;}
\DoxyCodeLine{00330     m\_renderArea = renderArea;}
\DoxyCodeLine{00331     m\_cameraPos  = cameraPos;}
\DoxyCodeLine{00332 }
\DoxyCodeLine{00333     \textcolor{comment}{// All previously rendered frames must be erased}}
\DoxyCodeLine{00334     std::map<int, FrameInfo>::iterator it;}
\DoxyCodeLine{00335     \textcolor{keywordflow}{for} (it = m\_frames.begin(); it != m\_frames.end(); ++it)}
\DoxyCodeLine{00336       TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a57d63227dfe2532b0aed22c47113be66}{remove}}(m\_cachePrefix +}
\DoxyCodeLine{00337                                       std::to\_string(it-\/>first));}
\DoxyCodeLine{00338 }
\DoxyCodeLine{00339     m\_frames.clear();}
\DoxyCodeLine{00340   \}}
\DoxyCodeLine{00341 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a5d26791946e7767b4793f79e8e388b77}\label{class_previewer_1_1_imp_a5d26791946e7767b4793f79e8e388b77}} 
\index{Previewer::Imp@{Previewer::Imp}!updateFrameRange@{updateFrameRange}}
\index{updateFrameRange@{updateFrameRange}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{updateFrameRange()}{updateFrameRange()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::update\+Frame\+Range (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00370                                     \{}
\DoxyCodeLine{00371   \textcolor{comment}{// Erase all rendered frames outside the new frame range}}
\DoxyCodeLine{00372   \textcolor{keywordtype}{int} newFrameCount =}
\DoxyCodeLine{00373       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_ab5cd3ad6f894b1acc5656ca747a80627}{getFrameCount}}();}
\DoxyCodeLine{00374 }
\DoxyCodeLine{00375   std::map<int, FrameInfo>::iterator it,}
\DoxyCodeLine{00376       jt = m\_frames.lower\_bound(newFrameCount);}
\DoxyCodeLine{00377   \textcolor{keywordflow}{for} (it = jt; it != m\_frames.end(); ++it)}
\DoxyCodeLine{00378     \textcolor{comment}{// Release all associated cached images}}
\DoxyCodeLine{00379     TImageCache::instance()-\/>remove(m\_cachePrefix + std::to\_string(it-\/>first));}
\DoxyCodeLine{00380 }
\DoxyCodeLine{00381   m\_frames.erase(jt, m\_frames.end());}
\DoxyCodeLine{00382 }
\DoxyCodeLine{00383   \textcolor{comment}{// Resize the progress bar status}}
\DoxyCodeLine{00384   \textcolor{keywordtype}{int} i, oldSize = m\_pbStatus.size();}
\DoxyCodeLine{00385   m\_pbStatus.resize(newFrameCount);}
\DoxyCodeLine{00386   \textcolor{keywordflow}{for} (i = oldSize; i < newFrameCount; ++i)}
\DoxyCodeLine{00387     m\_pbStatus[i] = FlipSlider::PBFrameNotStarted;}
\DoxyCodeLine{00388 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a3289be6c722e30a549f302cccfb11127}\label{class_previewer_1_1_imp_a3289be6c722e30a549f302cccfb11127}} 
\index{Previewer::Imp@{Previewer::Imp}!updatePreviewRect@{updatePreviewRect}}
\index{updatePreviewRect@{updatePreviewRect}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{updatePreviewRect()}{updatePreviewRect()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::update\+Preview\+Rect (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00410                                      \{}
\DoxyCodeLine{00411   \mbox{\hyperlink{class_t_rect_t}{TRectD}} previewRectD;}
\DoxyCodeLine{00412 }
\DoxyCodeLine{00413   \textcolor{comment}{/*-\/-\/}}
\DoxyCodeLine{00414 \textcolor{comment}{   * SubCameraPreviewViewer}}
\DoxyCodeLine{00415 \textcolor{comment}{   * -\/-\/*/}}
\DoxyCodeLine{00416   \textcolor{keywordflow}{if} (!m\_subcamera)}
\DoxyCodeLine{00417     previewRectD = m\_renderArea;}
\DoxyCodeLine{00418   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00419     \textcolor{comment}{// Retrieve the view rects from each listener. Their union will form the}}
\DoxyCodeLine{00420     \textcolor{comment}{// rect to be rendered.}}
\DoxyCodeLine{00421     std::set<Previewer::Listener *>::iterator it;}
\DoxyCodeLine{00422     \textcolor{keywordflow}{for} (it = m\_listeners.begin(); it != m\_listeners.end(); ++it) \{}
\DoxyCodeLine{00423       \textcolor{comment}{// Retrieve the listener's viewRect and add it to the preview rect}}
\DoxyCodeLine{00424       previewRectD += (*it)-\/>getPreviewRect();}
\DoxyCodeLine{00425     \}}
\DoxyCodeLine{00426   \}}
\DoxyCodeLine{00427 }
\DoxyCodeLine{00428   previewRectD *= m\_renderArea;}
\DoxyCodeLine{00429 }
\DoxyCodeLine{00430   \textcolor{keywordtype}{int} shrinkX = m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_a52dd41881bbf6aaf953fe300be2e233e}{m\_shrinkX}};}
\DoxyCodeLine{00431   \textcolor{keywordtype}{int} shrinkY = m\_renderSettings.\mbox{\hyperlink{class_t_render_settings_ae1882f584ce9ffad12ce6bf9ff23814c}{m\_shrinkY}};}
\DoxyCodeLine{00432 }
\DoxyCodeLine{00433   \textcolor{comment}{// Ensure that rect has the same pixel geometry as the preview camera}}
\DoxyCodeLine{00434   previewRectD -\/= m\_cameraPos;}
\DoxyCodeLine{00435   previewRectD.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} = previewRectD.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} / shrinkX;}
\DoxyCodeLine{00436   previewRectD.y0 = previewRectD.y0 / shrinkY;}
\DoxyCodeLine{00437   previewRectD.x1 = previewRectD.x1 / shrinkX;}
\DoxyCodeLine{00438   previewRectD.y1 = previewRectD.y1 / shrinkY;}
\DoxyCodeLine{00439 }
\DoxyCodeLine{00440   \textcolor{comment}{// Now, pass to m\_cameraRes-\/relative coordinates}}
\DoxyCodeLine{00441   \mbox{\hyperlink{class_t_point_t}{TPointD}} shrinkedRelPos((m\_renderArea.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} -\/ m\_cameraPos.x) / shrinkX,}
\DoxyCodeLine{00442                          (m\_renderArea.y0 -\/ m\_cameraPos.y) / shrinkY);}
\DoxyCodeLine{00443   previewRectD -\/= shrinkedRelPos;}
\DoxyCodeLine{00444 }
\DoxyCodeLine{00445   previewRectD.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} = tfloor(previewRectD.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}});}
\DoxyCodeLine{00446   previewRectD.y0 = tfloor(previewRectD.y0);}
\DoxyCodeLine{00447   previewRectD.x1 = tceil(previewRectD.x1);}
\DoxyCodeLine{00448   previewRectD.y1 = tceil(previewRectD.y1);}
\DoxyCodeLine{00449 }
\DoxyCodeLine{00450   m\_previewRect = \mbox{\hyperlink{class_t_rect_t}{TRect}}(previewRectD.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, previewRectD.y0, previewRectD.x1 -\/ 1,}
\DoxyCodeLine{00451                         previewRectD.y1 -\/ 1);}
\DoxyCodeLine{00452 }
\DoxyCodeLine{00453   previewRectD += m\_cameraPos + shrinkedRelPos;}
\DoxyCodeLine{00454 }
\DoxyCodeLine{00455   \mbox{\hyperlink{class_t_render_port_a743d79f021d27a9f8017ef468839cadb}{setRenderArea}}(previewRectD);}
\DoxyCodeLine{00456 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_a157de049fdd3dad1ca733c288e5f5aec}\label{class_previewer_1_1_imp_a157de049fdd3dad1ca733c288e5f5aec}} 
\index{Previewer::Imp@{Previewer::Imp}!updateProgressBarStatus@{updateProgressBarStatus}}
\index{updateProgressBarStatus@{updateProgressBarStatus}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{updateProgressBarStatus()}{updateProgressBarStatus()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::update\+Progress\+Bar\+Status (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00392                                            \{}
\DoxyCodeLine{00393   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i, pbSize = m\_pbStatus.size();}
\DoxyCodeLine{00394   std::map<int, FrameInfo>::iterator it;}
\DoxyCodeLine{00395   \textcolor{keywordflow}{for} (i = 0; i < pbSize; ++i) \{}
\DoxyCodeLine{00396     it = m\_frames.find(i);}
\DoxyCodeLine{00397     m\_pbStatus[i] =}
\DoxyCodeLine{00398         (it == m\_frames.end())}
\DoxyCodeLine{00399             ? FlipSlider::PBFrameNotStarted}
\DoxyCodeLine{00400             : ::contains(it-\/>second.m\_renderedRegion, m\_previewRect)}
\DoxyCodeLine{00401                   ? FlipSlider::PBFrameFinished}
\DoxyCodeLine{00402                   : it-\/>second.m\_rectUnderRender.contains(m\_previewRect)}
\DoxyCodeLine{00403                         ? FlipSlider::PBFrameStarted}
\DoxyCodeLine{00404                         : FlipSlider::PBFrameNotStarted;}
\DoxyCodeLine{00405   \}}
\DoxyCodeLine{00406 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_previewer_1_1_imp_af0de42749c61e8ce8e222f776ac9f858}\label{class_previewer_1_1_imp_af0de42749c61e8ce8e222f776ac9f858}} 
\index{Previewer::Imp@{Previewer::Imp}!updateRenderSettings@{updateRenderSettings}}
\index{updateRenderSettings@{updateRenderSettings}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{updateRenderSettings()}{updateRenderSettings()}}
{\footnotesize\ttfamily void Previewer\+::\+Imp\+::update\+Render\+Settings (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00345                                         \{}
\DoxyCodeLine{00346   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{00347   \mbox{\hyperlink{class_t_render_settings}{TRenderSettings}} renderSettings =}
\DoxyCodeLine{00348       scene-\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}()-\/>\mbox{\hyperlink{class_t_scene_properties_a0b905e0ea16e27aa5e67da31e469026e}{getPreviewProperties}}()-\/>\mbox{\hyperlink{class_t_output_properties_afa7c771452b57b50047aa4afc6032cad}{getRenderSettings}}();}
\DoxyCodeLine{00349 }
\DoxyCodeLine{00350   \textcolor{keywordflow}{if} (renderSettings.\mbox{\hyperlink{class_t_render_settings_a64acc2c6ba75292c0a0f9d101ddacc3b}{m\_applyShrinkToViewer}})}
\DoxyCodeLine{00351     renderSettings.\mbox{\hyperlink{class_t_render_settings_ae1882f584ce9ffad12ce6bf9ff23814c}{m\_shrinkY}} = renderSettings.\mbox{\hyperlink{class_t_render_settings_a52dd41881bbf6aaf953fe300be2e233e}{m\_shrinkX}};}
\DoxyCodeLine{00352   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00353     renderSettings.\mbox{\hyperlink{class_t_render_settings_ae1882f584ce9ffad12ce6bf9ff23814c}{m\_shrinkY}} = renderSettings.\mbox{\hyperlink{class_t_render_settings_a52dd41881bbf6aaf953fe300be2e233e}{m\_shrinkX}} = 1;}
\DoxyCodeLine{00354 }
\DoxyCodeLine{00355   \textcolor{comment}{// In case the settings changed, erase all previously cached images}}
\DoxyCodeLine{00356   \textcolor{keywordflow}{if} (renderSettings != m\_renderSettings) \{}
\DoxyCodeLine{00357     m\_renderSettings = renderSettings;}
\DoxyCodeLine{00358 }
\DoxyCodeLine{00359     std::map<int, FrameInfo>::iterator it;}
\DoxyCodeLine{00360     \textcolor{keywordflow}{for} (it = m\_frames.begin(); it != m\_frames.end(); ++it)}
\DoxyCodeLine{00361       TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a57d63227dfe2532b0aed22c47113be66}{remove}}(m\_cachePrefix +}
\DoxyCodeLine{00362                                       std::to\_string(it-\/>first));}
\DoxyCodeLine{00363 }
\DoxyCodeLine{00364     m\_frames.clear();}
\DoxyCodeLine{00365   \}}
\DoxyCodeLine{00366 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_previewer_1_1_imp_a34734121fc7deb3a1ca1c8248e68fed6}\label{class_previewer_1_1_imp_a34734121fc7deb3a1ca1c8248e68fed6}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_cachePrefix@{m\_cachePrefix}}
\index{m\_cachePrefix@{m\_cachePrefix}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_cachePrefix}{m\_cachePrefix}}
{\footnotesize\ttfamily std\+::string Previewer\+::\+Imp\+::m\+\_\+cache\+Prefix}

\mbox{\Hypertarget{class_previewer_1_1_imp_a113a6e96c22b646420955bbb4cbbbd0a}\label{class_previewer_1_1_imp_a113a6e96c22b646420955bbb4cbbbd0a}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_cameraPos@{m\_cameraPos}}
\index{m\_cameraPos@{m\_cameraPos}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_cameraPos}{m\_cameraPos}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPointD}} Previewer\+::\+Imp\+::m\+\_\+camera\+Pos}

\mbox{\Hypertarget{class_previewer_1_1_imp_a8aa27d993868a0ed60ca1815147e0c14}\label{class_previewer_1_1_imp_a8aa27d993868a0ed60ca1815147e0c14}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_cameraRes@{m\_cameraRes}}
\index{m\_cameraRes@{m\_cameraRes}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_cameraRes}{m\_cameraRes}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_dimension_t}{TDimension}} Previewer\+::\+Imp\+::m\+\_\+camera\+Res}

\mbox{\Hypertarget{class_previewer_1_1_imp_a02e72d95cc9ceb115e691ae7fdcfff9c}\label{class_previewer_1_1_imp_a02e72d95cc9ceb115e691ae7fdcfff9c}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_computingFrameCount@{m\_computingFrameCount}}
\index{m\_computingFrameCount@{m\_computingFrameCount}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_computingFrameCount}{m\_computingFrameCount}}
{\footnotesize\ttfamily int Previewer\+::\+Imp\+::m\+\_\+computing\+Frame\+Count}

\mbox{\Hypertarget{class_previewer_1_1_imp_a66e2f42034b2d83c4317a2d4b1664f22}\label{class_previewer_1_1_imp_a66e2f42034b2d83c4317a2d4b1664f22}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_currentFrameToSave@{m\_currentFrameToSave}}
\index{m\_currentFrameToSave@{m\_currentFrameToSave}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_currentFrameToSave}{m\_currentFrameToSave}}
{\footnotesize\ttfamily int Previewer\+::\+Imp\+::m\+\_\+current\+Frame\+To\+Save}

\mbox{\Hypertarget{class_previewer_1_1_imp_a9723c0b3c252de2d439e5a021a4d9ed4}\label{class_previewer_1_1_imp_a9723c0b3c252de2d439e5a021a4d9ed4}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_frames@{m\_frames}}
\index{m\_frames@{m\_frames}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_frames}{m\_frames}}
{\footnotesize\ttfamily std\+::map$<$int, \mbox{\hyperlink{struct_previewer_1_1_imp_1_1_frame_info}{Frame\+Info}}$>$ Previewer\+::\+Imp\+::m\+\_\+frames}

\mbox{\Hypertarget{class_previewer_1_1_imp_aabb54619f83d70cda3d9e8163076e578}\label{class_previewer_1_1_imp_aabb54619f83d70cda3d9e8163076e578}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_listeners@{m\_listeners}}
\index{m\_listeners@{m\_listeners}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_listeners}{m\_listeners}}
{\footnotesize\ttfamily std\+::set$<$\mbox{\hyperlink{class_previewer_1_1_listener}{Previewer\+::\+Listener}} $\ast$$>$ Previewer\+::\+Imp\+::m\+\_\+listeners}

\mbox{\Hypertarget{class_previewer_1_1_imp_ab30be60487f91f8cfea3a46944cc253a}\label{class_previewer_1_1_imp_ab30be60487f91f8cfea3a46944cc253a}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_lw@{m\_lw}}
\index{m\_lw@{m\_lw}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_lw}{m\_lw}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_level_writer_p}{TLevel\+WriterP}} Previewer\+::\+Imp\+::m\+\_\+lw}

\mbox{\Hypertarget{class_previewer_1_1_imp_a3ed3ece322f9d80932c22602ddd68b24}\label{class_previewer_1_1_imp_a3ed3ece322f9d80932c22602ddd68b24}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_mutex@{m\_mutex}}
\index{m\_mutex@{m\_mutex}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_mutex}{m\_mutex}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_thread_1_1_mutex}{TThread\+::\+Mutex}} Previewer\+::\+Imp\+::m\+\_\+mutex}

\mbox{\Hypertarget{class_previewer_1_1_imp_a2f5bce20463d1a7c8b9b381adc814e3e}\label{class_previewer_1_1_imp_a2f5bce20463d1a7c8b9b381adc814e3e}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_owner@{m\_owner}}
\index{m\_owner@{m\_owner}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_owner}{m\_owner}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_previewer}{Previewer}}$\ast$ Previewer\+::\+Imp\+::m\+\_\+owner}

\mbox{\Hypertarget{class_previewer_1_1_imp_ae2744fce84cc1f9152bf7b89b008becd}\label{class_previewer_1_1_imp_ae2744fce84cc1f9152bf7b89b008becd}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_pbStatus@{m\_pbStatus}}
\index{m\_pbStatus@{m\_pbStatus}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_pbStatus}{m\_pbStatus}}
{\footnotesize\ttfamily std\+::vector$<$UCHAR$>$ Previewer\+::\+Imp\+::m\+\_\+pb\+Status}

\mbox{\Hypertarget{class_previewer_1_1_imp_a338039985084e08e2d3ffd8b0169be9f}\label{class_previewer_1_1_imp_a338039985084e08e2d3ffd8b0169be9f}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_previewRect@{m\_previewRect}}
\index{m\_previewRect@{m\_previewRect}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_previewRect}{m\_previewRect}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_rect_t}{TRect}} Previewer\+::\+Imp\+::m\+\_\+preview\+Rect}

\mbox{\Hypertarget{class_previewer_1_1_imp_a50a4a78d063d11fd6a7f76aa55fa1e03}\label{class_previewer_1_1_imp_a50a4a78d063d11fd6a7f76aa55fa1e03}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_renderArea@{m\_renderArea}}
\index{m\_renderArea@{m\_renderArea}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_renderArea}{m\_renderArea}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_rect_t}{TRectD}} Previewer\+::\+Imp\+::m\+\_\+render\+Area}

\mbox{\Hypertarget{class_previewer_1_1_imp_aa8c026c96de1931a6c289bfec0cd4fc2}\label{class_previewer_1_1_imp_aa8c026c96de1931a6c289bfec0cd4fc2}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_renderer@{m\_renderer}}
\index{m\_renderer@{m\_renderer}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_renderer}{m\_renderer}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_renderer}{TRenderer}} Previewer\+::\+Imp\+::m\+\_\+renderer}

\mbox{\Hypertarget{class_previewer_1_1_imp_a463d9d9789b2aecef24254b9c46053c6}\label{class_previewer_1_1_imp_a463d9d9789b2aecef24254b9c46053c6}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_renderSettings@{m\_renderSettings}}
\index{m\_renderSettings@{m\_renderSettings}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_renderSettings}{m\_renderSettings}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} Previewer\+::\+Imp\+::m\+\_\+render\+Settings}

\mbox{\Hypertarget{class_previewer_1_1_imp_abac8cc825071e7b8901fcf59b69ceffd}\label{class_previewer_1_1_imp_abac8cc825071e7b8901fcf59b69ceffd}} 
\index{Previewer::Imp@{Previewer::Imp}!m\_subcamera@{m\_subcamera}}
\index{m\_subcamera@{m\_subcamera}!Previewer::Imp@{Previewer::Imp}}
\doxysubsubsection{\texorpdfstring{m\_subcamera}{m\_subcamera}}
{\footnotesize\ttfamily bool Previewer\+::\+Imp\+::m\+\_\+subcamera}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonz/previewer.\+cpp\end{DoxyCompactItemize}
