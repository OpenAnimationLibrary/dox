\hypertarget{class_stage_builder}{}\doxysection{Stage\+Builder Class Reference}
\label{class_stage_builder}\index{StageBuilder@{StageBuilder}}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct_stage_builder_1_1_sub_x_sheet}{Sub\+XSheet}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum {\bfseries Shift\+Trace\+Ghost\+Id} \{ {\bfseries NO\+\_\+\+GHOST}
, {\bfseries FIRST\+\_\+\+GHOST}
, {\bfseries SECOND\+\_\+\+GHOST}
, {\bfseries TRACED}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{add\+Cell}} (Player\+Set \&players, \mbox{\hyperlink{class_toonz_scene}{Toonz\+Scene}} $\ast$scene, \mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$xsh, int row, int col, int level, int sub\+Sheet\+Col\+Index=-\/1)
\item 
void \mbox{\hyperlink{class_stage_builder_a4c1c9a8ab1830b4848e663d1d66c7d27}{add\+Cell\+With\+Onion\+Skin}} (Player\+Set \&players, \mbox{\hyperlink{class_toonz_scene}{Toonz\+Scene}} $\ast$scene, \mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$xsh, int row, int col, int level, int sub\+Sheet\+Col\+Index=-\/1)
\item 
void \mbox{\hyperlink{class_stage_builder_aece86e937e6a719d64cbf75d4dc03e5e}{add\+Frame}} (Player\+Set \&players, \mbox{\hyperlink{class_toonz_scene}{Toonz\+Scene}} $\ast$scene, \mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$xsh, int row, int level, bool include\+Unvisible, bool check\+Preview\+Visibility, int sub\+Sheet\+Col\+Index=-\/1)
\item 
void \mbox{\hyperlink{class_stage_builder_acfa9ec0326e2d6aff34e4d94a1c12f03}{add\+Simple\+Level\+Frame}} (Player\+Set \&players, \mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$level, const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&fid)
\item 
void \mbox{\hyperlink{class_stage_builder_a4c5d29002a29453763337c7f6a32b4aa}{visit}} (Player\+Set \&players, \mbox{\hyperlink{class_stage_1_1_visitor}{Visitor}} \&visitor, bool is\+Playing=false)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
Player\+Set \mbox{\hyperlink{class_stage_builder_a29690cb79fcdc47365573678cfd8c238}{m\+\_\+players}}
\item 
std\+::vector$<$ Player\+Set $\ast$ $>$ \mbox{\hyperlink{class_stage_builder_a1335bb8e496143277ffef8066fa15c5e}{m\+\_\+mask\+Pool}}
\item 
std\+::vector$<$ \mbox{\hyperlink{class_z_placement}{ZPlacement}} $>$ \mbox{\hyperlink{class_stage_builder_aa1740ffd9aec53133b88ff7ad04d893e}{m\+\_\+placement\+Stack}}
\item 
\mbox{\hyperlink{class_z_placement}{ZPlacement}} \mbox{\hyperlink{class_stage_builder_a2cb3d97d88ef502d767e619d7ad4e7ef}{m\+\_\+camera\+Placement}}
\item 
std\+::vector$<$ \mbox{\hyperlink{struct_stage_builder_1_1_sub_x_sheet}{Sub\+XSheet}} $>$ \mbox{\hyperlink{class_stage_builder_a1eb221fb6d49134f1e8a0254f39332cd}{m\+\_\+sub\+XSheet\+Stack}}
\item 
std\+::vector$<$ int $>$ \mbox{\hyperlink{class_stage_builder_a5e17a6dbe026d2e10604e7e2b83d399d}{m\+\_\+masks}}
\item 
int \mbox{\hyperlink{class_stage_builder_a6ee60374e2f5f4d915793cd503a7bdaf}{m\+\_\+onion\+Skin\+Distance}}
\item 
double \mbox{\hyperlink{class_stage_builder_a0464c80c751ac882d18cb8fc6aafcf21}{m\+\_\+fade}}
\item 
Shift\+Trace\+Ghost\+Id \mbox{\hyperlink{class_stage_builder_a3005326426895889a3f801efb998174d}{m\+\_\+shift\+Trace\+Ghost\+Id}}
\item 
bool \mbox{\hyperlink{class_stage_builder_afc794dfbc4a98780a91a7f024cec2ee4}{m\+\_\+camera3d}}
\item 
\mbox{\hyperlink{class_onion_skin_mask}{Onion\+Skin\+Mask}} \mbox{\hyperlink{class_stage_builder_abb78f63ffe6a93c9e1f78bff0c330f71}{m\+\_\+onion\+Skin\+Mask}}
\item 
int \mbox{\hyperlink{class_stage_builder_a399a33c8cf38bb96c8769b57440f12a8}{m\+\_\+current\+Column\+Index}}
\item 
int \mbox{\hyperlink{class_stage_builder_a6280867b1af1dd143f20d97bc517b6c4}{m\+\_\+ancestor\+Column\+Index}}
\item 
int \mbox{\hyperlink{class_stage_builder_afbea32a889325bbd8e72644a174d5193}{m\+\_\+current\+Xsheet\+Level}}
\item 
int \mbox{\hyperlink{class_stage_builder_a1821428a800e68dcaa32c825bac33c9a}{m\+\_\+xsheet\+Level}}
\item 
\mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \mbox{\hyperlink{class_stage_builder_a637b384da6847085e9d5d90846cc5f52}{m\+\_\+current\+Frame\+Id}}
\item 
int \mbox{\hyperlink{class_stage_builder_a91d13b870eea5f0d2b4831470f86394a}{m\+\_\+is\+Guided\+Drawing\+Enabled}}
\item 
int \mbox{\hyperlink{class_stage_builder_a7354ca81fdb2151131e9f399d2783498}{m\+\_\+guided\+Front\+Stroke}} = -\/1
\item 
int \mbox{\hyperlink{class_stage_builder_a4d58ffedfaea24f2b262333b4075d472}{m\+\_\+guided\+Back\+Stroke}} = -\/1
\item 
std\+::vector$<$ \mbox{\hyperlink{class_t_xsh_column}{TXsh\+Column}} $\ast$ $>$ \mbox{\hyperlink{class_stage_builder_a3589395e6aca83cbb0d55d0386392f16}{m\+\_\+ancestors}}
\item 
const \mbox{\hyperlink{class_image_painter_1_1_visual_settings}{Image\+Painter\+::\+Visual\+Settings}} $\ast$ \mbox{\hyperlink{class_stage_builder_a098288a79a7dd1c808c5005cf5b517bb}{m\+\_\+vs}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The \mbox{\hyperlink{class_stage_builder}{Stage\+Builder}} class finds and provides data for frame visualization. ~\newline
 The class contains a {\bfseries{Player\+Set}}, a vector of player, of all necessary information. 

\doxysubsection{Member Enumeration Documentation}
\mbox{\Hypertarget{class_stage_builder_a51495f271352c5cdd526ebcd3f1f9363}\label{class_stage_builder_a51495f271352c5cdd526ebcd3f1f9363}} 
\index{StageBuilder@{StageBuilder}!ShiftTraceGhostId@{ShiftTraceGhostId}}
\index{ShiftTraceGhostId@{ShiftTraceGhostId}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{ShiftTraceGhostId}{ShiftTraceGhostId}}
{\footnotesize\ttfamily enum Stage\+Builder\+::\+Shift\+Trace\+Ghost\+Id}


\begin{DoxyCode}{0}
\DoxyCodeLine{00180 \{ NO\_GHOST, FIRST\_GHOST, SECOND\_GHOST, TRACED \};}

\end{DoxyCode}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_stage_builder_a99b8dcb57bab53409592baf2f8da3e1b}\label{class_stage_builder_a99b8dcb57bab53409592baf2f8da3e1b}} 
\index{StageBuilder@{StageBuilder}!StageBuilder@{StageBuilder}}
\index{StageBuilder@{StageBuilder}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{StageBuilder()}{StageBuilder()}}
{\footnotesize\ttfamily Stage\+Builder\+::\+Stage\+Builder (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00281     : m\_onionSkinDistance(c\_noOnionSkin)}
\DoxyCodeLine{00282     , m\_camera3d(\textcolor{keyword}{false})}
\DoxyCodeLine{00283     , m\_currentColumnIndex(-\/1)}
\DoxyCodeLine{00284     , m\_ancestorColumnIndex(-\/1)}
\DoxyCodeLine{00285     , m\_fade(0)}
\DoxyCodeLine{00286     , m\_shiftTraceGhostId(NO\_GHOST)}
\DoxyCodeLine{00287     , m\_currentXsheetLevel(0)}
\DoxyCodeLine{00288     , m\_xsheetLevel(0) \{}
\DoxyCodeLine{00289   m\_placementStack.push\_back(\mbox{\hyperlink{class_z_placement}{ZPlacement}}());}
\DoxyCodeLine{00290 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_stage_builder_abd3a25baa811fb300343baa92f9fbb13}\label{class_stage_builder_abd3a25baa811fb300343baa92f9fbb13}} 
\index{StageBuilder@{StageBuilder}!````~StageBuilder@{$\sim$StageBuilder}}
\index{````~StageBuilder@{$\sim$StageBuilder}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{$\sim$StageBuilder()}{~StageBuilder()}}
{\footnotesize\ttfamily Stage\+Builder\+::$\sim$\+Stage\+Builder (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00294 \{ clearPointerContainer(m\_maskPool); \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}\label{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}} 
\index{StageBuilder@{StageBuilder}!addCell@{addCell}}
\index{addCell@{addCell}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{addCell()}{addCell()}}
{\footnotesize\ttfamily void Stage\+Builder\+::add\+Cell (\begin{DoxyParamCaption}\item[{Player\+Set \&}]{players,  }\item[{\mbox{\hyperlink{class_toonz_scene}{Toonz\+Scene}} $\ast$}]{scene,  }\item[{\mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$}]{xsh,  }\item[{int}]{row,  }\item[{int}]{col,  }\item[{int}]{level,  }\item[{int}]{sub\+Sheet\+Col\+Index = {\ttfamily -\/1} }\end{DoxyParamCaption})}

Add in {\bfseries{players}} vector information about specify cell. ~\newline
 Analyze cell in row {\bfseries{row}} and column {\bfseries{col}} of xsheet {\bfseries{xsh}}. If level containing this cell is a simple level, {\bfseries{\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}}}}, create a Pleyer object with information of the cell. Else if level is a child level, {\bfseries{\mbox{\hyperlink{class_t_xsh_child_level}{TXsh\+Child\+Level}}}}, recall {\bfseries{\mbox{\hyperlink{class_stage_builder_aece86e937e6a719d64cbf75d4dc03e5e}{add\+Frame()}}}}. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00331                                                                               \{}
\DoxyCodeLine{00332   \textcolor{comment}{// Local functions}}
\DoxyCodeLine{00333   \textcolor{keyword}{struct }locals \{}
\DoxyCodeLine{00334     \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} isMeshDeformed(\mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh, \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *obj,}
\DoxyCodeLine{00335                                       \textcolor{keyword}{const} \mbox{\hyperlink{class_image_painter_1_1_visual_settings}{ImagePainter::VisualSettings}} *vs) \{}
\DoxyCodeLine{00336       \textcolor{keyword}{const} \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} \&parentId = obj-\/>\mbox{\hyperlink{class_t_stage_object_afb4724a8cc2ef7eb2c6c7585834210f2}{getParent}}();}
\DoxyCodeLine{00337       \textcolor{keywordflow}{if} (parentId.\mbox{\hyperlink{class_t_stage_object_id_af6d13fcf31e7e10eef28f085855f469c}{isColumn}}() \&\& obj-\/>\mbox{\hyperlink{class_t_stage_object_a6025ddfaaae4ebe384894230d69f0b46}{getParentHandle}}()[0] != \textcolor{charliteral}{'H'}) \{}
\DoxyCodeLine{00338         \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *parentObj = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(parentId);}
\DoxyCodeLine{00339         \textcolor{keywordflow}{if} (!parentObj-\/>\mbox{\hyperlink{class_t_stage_object_af2c5d9f172e73e4cb09b769700df3acb}{getPlasticSkeletonDeformation}}()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00340 }
\DoxyCodeLine{00341         \mbox{\hyperlink{class_t_xsh_column}{TXshColumn}} *parentCol = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(parentId.getIndex());}
\DoxyCodeLine{00342         \textcolor{keywordflow}{return} (parentCol-\/>getColumnType() == TXshColumn::eMeshType) \&\&}
\DoxyCodeLine{00343                (parentCol != vs-\/>\mbox{\hyperlink{class_image_painter_1_1_visual_settings_aafe14ec520424843ecd9aca4abf02bf0}{m\_plasticVisualSettings}}.\mbox{\hyperlink{struct_plastic_visual_settings_adff7a25870734f8d9e0d56ba0dd7486e}{m\_showOriginalColumn}});}
\DoxyCodeLine{00344       \}}
\DoxyCodeLine{00345 }
\DoxyCodeLine{00346       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00347     \}}
\DoxyCodeLine{00348 }
\DoxyCodeLine{00349     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00350 }
\DoxyCodeLine{00351     \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} applyPlasticDeform(}
\DoxyCodeLine{00352         \mbox{\hyperlink{class_t_xsh_column}{TXshColumn}} *col, \textcolor{keyword}{const} \mbox{\hyperlink{class_image_painter_1_1_visual_settings}{ImagePainter::VisualSettings}} *vs) \{}
\DoxyCodeLine{00353       \textcolor{keyword}{const} \mbox{\hyperlink{struct_plastic_visual_settings}{PlasticVisualSettings}} \&pvs = vs-\/>\mbox{\hyperlink{class_image_painter_1_1_visual_settings_aafe14ec520424843ecd9aca4abf02bf0}{m\_plasticVisualSettings}};}
\DoxyCodeLine{00354       \textcolor{keywordflow}{return} pvs.\mbox{\hyperlink{struct_plastic_visual_settings_a59b9745ab0c48c32043c3742a4fc3c69}{m\_applyPlasticDeformation}} \&\& (col != pvs.\mbox{\hyperlink{struct_plastic_visual_settings_adff7a25870734f8d9e0d56ba0dd7486e}{m\_showOriginalColumn}});}
\DoxyCodeLine{00355     \}}
\DoxyCodeLine{00356   \};  \textcolor{comment}{// locals}}
\DoxyCodeLine{00357 }
\DoxyCodeLine{00358   \mbox{\hyperlink{class_t_smart_pointer_t}{TXshColumnP}} column = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(col);}
\DoxyCodeLine{00359   assert(column);}
\DoxyCodeLine{00360 }
\DoxyCodeLine{00361   \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *pegbar = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(TStageObjectId::ColumnId(col));}
\DoxyCodeLine{00362 }
\DoxyCodeLine{00363   \textcolor{comment}{// Build affine placements}}
\DoxyCodeLine{00364 }
\DoxyCodeLine{00365   \mbox{\hyperlink{class_t_affine}{TAffine}} columnAff     = pegbar-\/>getPlacement(row);}
\DoxyCodeLine{00366   \textcolor{keywordtype}{double} columnZ        = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_a52b1a3ec50ed35fbc07c9a3b64ecc21c}{getZ}}(row);}
\DoxyCodeLine{00367   \textcolor{keywordtype}{double} columnNoScaleZ = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_a5d01b3f25af51c058e46982ca047312d}{getGlobalNoScaleZ}}();}
\DoxyCodeLine{00368 }
\DoxyCodeLine{00369   \mbox{\hyperlink{class_t_xsh_cell}{TXshCell}} cell = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(row, col);}
\DoxyCodeLine{00370   \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *xl = cell.m\_level.getPointer();}
\DoxyCodeLine{00371 }
\DoxyCodeLine{00372 \textcolor{preprocessor}{\#if defined(x64)}}
\DoxyCodeLine{00373   \textcolor{comment}{// check the previous row for a stop motion layer}}
\DoxyCodeLine{00374   \textcolor{keywordflow}{if} (!xl) \{}
\DoxyCodeLine{00375     \textcolor{keywordflow}{if} (!m\_liveViewImage) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00376     cell = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(row -\/ 1, col);}
\DoxyCodeLine{00377     xl   = cell.m\_level.getPointer();}
\DoxyCodeLine{00378     \textcolor{keywordflow}{if} (!xl) \{}
\DoxyCodeLine{00379       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00380     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00381       xl                  = cell.m\_level.getPointer();}
\DoxyCodeLine{00382       \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl = xl-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{00383       \textcolor{keywordflow}{if} (sl \&\& sl == m\_liveViewPlayer.m\_sl) \{}
\DoxyCodeLine{00384         row -\/= 1;}
\DoxyCodeLine{00385       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00386         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00387     \}}
\DoxyCodeLine{00388   \}}
\DoxyCodeLine{00389 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00390   \textcolor{keywordflow}{if} (!xl) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00391 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00392 }
\DoxyCodeLine{00393   \mbox{\hyperlink{class_z_placement}{ZPlacement}} cameraPlacement;}
\DoxyCodeLine{00394   \textcolor{keywordflow}{if} (m\_subXSheetStack.empty())}
\DoxyCodeLine{00395     cameraPlacement = m\_cameraPlacement;}
\DoxyCodeLine{00396   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00397     cameraPlacement = m\_subXSheetStack.back().m\_camera;}
\DoxyCodeLine{00398   \mbox{\hyperlink{class_t_affine}{TAffine}} columnZaff;}
\DoxyCodeLine{00399   \textcolor{keywordtype}{bool} columnBehindCamera = \mbox{\hyperlink{class_t_stage_object_a0f219cbc4e42269c0fbd073a62253218}{TStageObject::perspective}}(}
\DoxyCodeLine{00400       columnZaff, cameraPlacement.m\_aff, cameraPlacement.m\_z, columnAff,}
\DoxyCodeLine{00401       columnZ, columnNoScaleZ);}
\DoxyCodeLine{00402 }
\DoxyCodeLine{00403   \textcolor{keywordflow}{if} (!columnBehindCamera) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00404 }
\DoxyCodeLine{00405   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl = xl-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{00406 }
\DoxyCodeLine{00407   \textcolor{keywordtype}{bool} storePlayer =}
\DoxyCodeLine{00408       sl || (xl-\/>\mbox{\hyperlink{class_t_xsh_level_a6ef7d48e41f4f214b414e959512e6377}{getChildLevel}}() \&\&}
\DoxyCodeLine{00409              locals::applyPlasticDeform(column.getPointer(), m\_vs) \&\&}
\DoxyCodeLine{00410              locals::isMeshDeformed(xsh, pegbar, m\_vs));}
\DoxyCodeLine{00411 }
\DoxyCodeLine{00412   \textcolor{keywordflow}{if} (storePlayer) \{}
\DoxyCodeLine{00413     \textcolor{comment}{// Build and store a player}}
\DoxyCodeLine{00414 }
\DoxyCodeLine{00415     \mbox{\hyperlink{class_stage_1_1_player}{Player}} player;}
\DoxyCodeLine{00416     player.\mbox{\hyperlink{class_stage_1_1_player_a6230d77933caf93b9699bd5e2de0d2b0}{m\_sl}}                     = sl;}
\DoxyCodeLine{00417     player.\mbox{\hyperlink{class_stage_1_1_player_aba5bf8d012d1017e5fe66d5c4b1e27df}{m\_fid}}                    = cell.m\_frameId;}
\DoxyCodeLine{00418     player.\mbox{\hyperlink{class_stage_1_1_player_a7c4c0ed3570aba38a036023360724606}{m\_xsh}}                    = xsh;}
\DoxyCodeLine{00419     player.\mbox{\hyperlink{class_stage_1_1_player_ac79a243d283085682ddcdb75f8a6e185}{m\_column}}                 = col;}
\DoxyCodeLine{00420     player.\mbox{\hyperlink{class_stage_1_1_player_af88189b51ebf5b86f87f77281aba0ce1}{m\_frame}}                  = row;}
\DoxyCodeLine{00421     player.m\_currentFrameId         = m\_currentFrameId;}
\DoxyCodeLine{00422     player.m\_isGuidedDrawingEnabled = m\_isGuidedDrawingEnabled;}
\DoxyCodeLine{00423     player.m\_guidedFrontStroke      = m\_guidedFrontStroke;}
\DoxyCodeLine{00424     player.m\_guidedBackStroke       = m\_guidedBackStroke;}
\DoxyCodeLine{00425     player.\mbox{\hyperlink{class_stage_1_1_player_a0495491ce47344daba1cd55e1b64905a}{m\_dpiAff}} = sl ? getDpiAffine(sl, cell.m\_frameId) : \mbox{\hyperlink{class_t_affine}{TAffine}}();}
\DoxyCodeLine{00426     player.\mbox{\hyperlink{class_stage_1_1_player_ae9146f2fdcb1837482abf535fc5622ef}{m\_onionSkinDistance}} = m\_onionSkinDistance;}
\DoxyCodeLine{00427     \textcolor{comment}{// when visiting the subxsheet, valuate the subxsheet column index}}
\DoxyCodeLine{00428     \textcolor{keywordtype}{bool} isCurrent = (subSheetColIndex >= 0)}
\DoxyCodeLine{00429                          ? (subSheetColIndex == m\_currentColumnIndex)}
\DoxyCodeLine{00430                          : (col == m\_currentColumnIndex);}
\DoxyCodeLine{00431     player.\mbox{\hyperlink{class_stage_1_1_player_aba32c099fd49a4343580c28ade32e144}{m\_isCurrentColumn}}     = isCurrent;}
\DoxyCodeLine{00432     player.\mbox{\hyperlink{class_stage_1_1_player_affd2dfe55cdffea6d55be757f502df72}{m\_ancestorColumnIndex}} = m\_ancestorColumnIndex;}
\DoxyCodeLine{00433     player.m\_masks               = m\_masks;}
\DoxyCodeLine{00434     player.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}}             = column-\/>getOpacity();}
\DoxyCodeLine{00435     player.m\_filterColor         = column-\/>getFilterColor();}
\DoxyCodeLine{00436 }
\DoxyCodeLine{00437     \textcolor{keywordflow}{if} (m\_subXSheetStack.empty()) \{}
\DoxyCodeLine{00438       player.\mbox{\hyperlink{class_stage_1_1_player_a547b8839d602f6998a4b61a819478e6a}{m\_z}}         = columnZ;}
\DoxyCodeLine{00439       player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}} = m\_camera3d ? columnAff : columnZaff;}
\DoxyCodeLine{00440     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00441       \textcolor{keyword}{const} SubXSheet \&parent = m\_subXSheetStack.back();}
\DoxyCodeLine{00442 }
\DoxyCodeLine{00443       player.\mbox{\hyperlink{class_stage_1_1_player_a547b8839d602f6998a4b61a819478e6a}{m\_z}} = parent.m\_z;}
\DoxyCodeLine{00444       player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}} =}
\DoxyCodeLine{00445           (m\_camera3d ? parent.m\_aff : parent.m\_zaff) * columnZaff;}
\DoxyCodeLine{00446     \}}
\DoxyCodeLine{00447 }
\DoxyCodeLine{00448     \textcolor{keywordflow}{if} (m\_shiftTraceGhostId != NO\_GHOST) \{}
\DoxyCodeLine{00449       \textcolor{comment}{// if F1, F2 or F3 key is pressed, then draw only the corresponding ghost}}
\DoxyCodeLine{00450       \textcolor{keywordtype}{int} flipKey = m\_onionSkinMask.getGhostFlipKey();}
\DoxyCodeLine{00451       \textcolor{keywordflow}{if} (Qt::Key\_F1 <= flipKey \&\& flipKey <= Qt::Key\_F3) \{}
\DoxyCodeLine{00452         \textcolor{keywordflow}{if} (m\_shiftTraceGhostId == TRACED \&\& flipKey == Qt::Key\_F2) \{}
\DoxyCodeLine{00453           players.push\_back(player);}
\DoxyCodeLine{00454         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_shiftTraceGhostId == FIRST\_GHOST \&\&}
\DoxyCodeLine{00455                    flipKey == Qt::Key\_F1) \{}
\DoxyCodeLine{00456           player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}} =}
\DoxyCodeLine{00457               m\_onionSkinMask.getShiftTraceGhostAff(0) * player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}};}
\DoxyCodeLine{00458           players.push\_back(player);}
\DoxyCodeLine{00459         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_shiftTraceGhostId == SECOND\_GHOST \&\&}
\DoxyCodeLine{00460                    flipKey == Qt::Key\_F3) \{}
\DoxyCodeLine{00461           player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}} =}
\DoxyCodeLine{00462               m\_onionSkinMask.getShiftTraceGhostAff(1) * player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}};}
\DoxyCodeLine{00463           players.push\_back(player);}
\DoxyCodeLine{00464         \}}
\DoxyCodeLine{00465         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00466       \}}
\DoxyCodeLine{00467 }
\DoxyCodeLine{00468       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00469         \textcolor{keywordtype}{int} opacity         = player.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}};}
\DoxyCodeLine{00470         player.\mbox{\hyperlink{class_stage_1_1_player_aab56aced982252aafc6c06f1b66dbdac}{m\_bingoOrder}} = 10;}
\DoxyCodeLine{00471         \textcolor{keywordflow}{if} (m\_onionSkinMask.getShiftTraceStatus() !=}
\DoxyCodeLine{00472             OnionSkinMask::ENABLED\_WITHOUT\_GHOST\_MOVEMENTS) \{}
\DoxyCodeLine{00473           \textcolor{keywordflow}{if} (m\_shiftTraceGhostId == FIRST\_GHOST) \{}
\DoxyCodeLine{00474             player.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}} = 30;}
\DoxyCodeLine{00475             players.push\_back(player);}
\DoxyCodeLine{00476             player.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}}           = opacity;}
\DoxyCodeLine{00477             player.\mbox{\hyperlink{class_stage_1_1_player_ae9146f2fdcb1837482abf535fc5622ef}{m\_onionSkinDistance}} = -\/1;}
\DoxyCodeLine{00478             player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}} =}
\DoxyCodeLine{00479                 m\_onionSkinMask.getShiftTraceGhostAff(0) * player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}};}
\DoxyCodeLine{00480           \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_shiftTraceGhostId == SECOND\_GHOST) \{}
\DoxyCodeLine{00481             player.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}} = 30;}
\DoxyCodeLine{00482             players.push\_back(player);}
\DoxyCodeLine{00483             player.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}}           = opacity;}
\DoxyCodeLine{00484             player.\mbox{\hyperlink{class_stage_1_1_player_ae9146f2fdcb1837482abf535fc5622ef}{m\_onionSkinDistance}} = 1;}
\DoxyCodeLine{00485             player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}} =}
\DoxyCodeLine{00486                 m\_onionSkinMask.getShiftTraceGhostAff(1) * player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}};}
\DoxyCodeLine{00487           \}}
\DoxyCodeLine{00488         \}}
\DoxyCodeLine{00489       \}}
\DoxyCodeLine{00490     \}}
\DoxyCodeLine{00491 }
\DoxyCodeLine{00492     players.push\_back(player);}
\DoxyCodeLine{00493   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_xsh_child_level}{TXshChildLevel}} *cl = xl-\/>\mbox{\hyperlink{class_t_xsh_level_a6ef7d48e41f4f214b414e959512e6377}{getChildLevel}}()) \{}
\DoxyCodeLine{00494     \textcolor{keywordtype}{int} childRow         = cell.m\_frameId.getNumber() -\/ 1;}
\DoxyCodeLine{00495     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *childXsheet = cl-\/>getXsheet();}
\DoxyCodeLine{00496     \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} childCameraId =}
\DoxyCodeLine{00497         childXsheet-\/>\mbox{\hyperlink{class_t_xsheet_a5dc925584e35e1678f5678b79c470959}{getStageObjectTree}}()-\/>\mbox{\hyperlink{class_t_stage_object_tree_a7d63ae5d60c3a3aacf5da58c108ac167}{getCurrentCameraId}}();}
\DoxyCodeLine{00498     \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *childCamera = childXsheet-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(childCameraId);}
\DoxyCodeLine{00499     \mbox{\hyperlink{class_t_affine}{TAffine}} childCameraAff    = childCamera-\/>getPlacement(childRow);}
\DoxyCodeLine{00500     \textcolor{keywordtype}{double} childCameraZ       = childCamera-\/>\mbox{\hyperlink{class_t_stage_object_a52b1a3ec50ed35fbc07c9a3b64ecc21c}{getZ}}(childRow);}
\DoxyCodeLine{00501 }
\DoxyCodeLine{00502     std::vector<UCHAR> originalOpacity(childXsheet-\/>\mbox{\hyperlink{class_t_xsheet_a17464dc5617cf87a46f03e1a52d36cc1}{getColumnCount}}());}
\DoxyCodeLine{00503 }
\DoxyCodeLine{00504     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} c = 0; c < childXsheet-\/>\mbox{\hyperlink{class_t_xsheet_a17464dc5617cf87a46f03e1a52d36cc1}{getColumnCount}}(); c++) \{}
\DoxyCodeLine{00505       originalOpacity[c] = childXsheet-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(c)-\/>\mbox{\hyperlink{class_t_xsh_column_a265aebf0e35c7b434949c67076084cb8}{getOpacity}}();}
\DoxyCodeLine{00506       childXsheet-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(c)-\/>\mbox{\hyperlink{class_t_xsh_column_a603f665f9a11b08798a839cca4e0c8b3}{setOpacity}}(column-\/>getOpacity());}
\DoxyCodeLine{00507     \}}
\DoxyCodeLine{00508 }
\DoxyCodeLine{00509     SubXSheet subXSheet;}
\DoxyCodeLine{00510     subXSheet.m\_camera = \mbox{\hyperlink{class_z_placement}{ZPlacement}}(childCameraAff, childCameraZ);}
\DoxyCodeLine{00511     subXSheet.m\_z      = columnZ;}
\DoxyCodeLine{00512 }
\DoxyCodeLine{00513     \mbox{\hyperlink{class_t_affine}{TAffine}} childCameraZaff =}
\DoxyCodeLine{00514         childCameraAff *}
\DoxyCodeLine{00515         \mbox{\hyperlink{class_t_scale}{TScale}}((1000 + childCameraZ) / 1000);  \textcolor{comment}{// TODO: put in some lib}}
\DoxyCodeLine{00516     \mbox{\hyperlink{class_t_affine}{TAffine}} invChildCameraZaff = childCameraZaff.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}();}
\DoxyCodeLine{00517 }
\DoxyCodeLine{00518     subXSheet.m\_aff  = columnAff * invChildCameraZaff;}
\DoxyCodeLine{00519     subXSheet.m\_zaff = columnZaff * invChildCameraZaff;}
\DoxyCodeLine{00520 }
\DoxyCodeLine{00521     \textcolor{keywordflow}{if} (!m\_subXSheetStack.empty()) \{}
\DoxyCodeLine{00522       \textcolor{keyword}{const} SubXSheet \&parentXSheet = m\_subXSheetStack.back();}
\DoxyCodeLine{00523 }
\DoxyCodeLine{00524       subXSheet.m\_z =}
\DoxyCodeLine{00525           m\_subXSheetStack.front().m\_z;  \textcolor{comment}{// Top-\/level xsheet cell's z}}
\DoxyCodeLine{00526       subXSheet.m\_aff  = parentXSheet.m\_aff * subXSheet.m\_aff;}
\DoxyCodeLine{00527       subXSheet.m\_zaff = parentXSheet.m\_zaff * subXSheet.m\_zaff;}
\DoxyCodeLine{00528     \}}
\DoxyCodeLine{00529 }
\DoxyCodeLine{00530     m\_subXSheetStack.push\_back(subXSheet);}
\DoxyCodeLine{00531 }
\DoxyCodeLine{00532     ++m\_currentXsheetLevel;}
\DoxyCodeLine{00533     \textcolor{comment}{// inherit the column index when visiting grandchild (sub-\/sub) sheet}}
\DoxyCodeLine{00534     \textcolor{keywordtype}{int} subCol = (subSheetColIndex >= 0) ? subSheetColIndex : col;}
\DoxyCodeLine{00535     \mbox{\hyperlink{class_stage_builder_aece86e937e6a719d64cbf75d4dc03e5e}{addFrame}}(players, scene, childXsheet, childRow, level + 1, \textcolor{keyword}{false}, \textcolor{keyword}{false},}
\DoxyCodeLine{00536              subCol);}
\DoxyCodeLine{00537     -\/-\/m\_currentXsheetLevel;}
\DoxyCodeLine{00538 }
\DoxyCodeLine{00539     m\_subXSheetStack.pop\_back();}
\DoxyCodeLine{00540 }
\DoxyCodeLine{00541     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} c = 0; c < childXsheet-\/>\mbox{\hyperlink{class_t_xsheet_a17464dc5617cf87a46f03e1a52d36cc1}{getColumnCount}}(); c++)}
\DoxyCodeLine{00542       childXsheet-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(c)-\/>\mbox{\hyperlink{class_t_xsh_column_a603f665f9a11b08798a839cca4e0c8b3}{setOpacity}}(originalOpacity[c]);}
\DoxyCodeLine{00543   \}}
\DoxyCodeLine{00544 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00662}{add\+Frame()}}, \mbox{\hyperlink{l00233}{TXsheet\+::get\+Cell()}}, \mbox{\hyperlink{l00098}{TXsh\+Level\+::get\+Child\+Level()}}, \mbox{\hyperlink{l01418}{TXsheet\+::get\+Column()}}, \mbox{\hyperlink{l01425}{TXsheet\+::get\+Column\+Count()}}, \mbox{\hyperlink{l00508}{TStage\+Object\+Tree\+::get\+Current\+Camera\+Id()}}, \mbox{\hyperlink{l01443}{TStage\+Object\+::get\+Global\+No\+Scale\+Z()}}, \mbox{\hyperlink{l00164}{TXsh\+Column\+::get\+Opacity()}}, \mbox{\hyperlink{l00632}{TStage\+Object\+::get\+Parent()}}, \mbox{\hyperlink{l00277}{TStage\+Object\+::get\+Parent\+Handle()}}, \mbox{\hyperlink{l01144}{TStage\+Object\+::get\+Plastic\+Skeleton\+Deformation()}}, \mbox{\hyperlink{l00095}{TXsh\+Level\+::get\+Simple\+Level()}}, \mbox{\hyperlink{l00542}{TXsheet\+::get\+Stage\+Object()}}, \mbox{\hyperlink{l00549}{TXsheet\+::get\+Stage\+Object\+Tree()}}, \mbox{\hyperlink{l01423}{TStage\+Object\+::get\+Z()}}, \mbox{\hyperlink{l00055}{TAffine\+::inv()}}, \mbox{\hyperlink{l00180}{TStage\+Object\+Id\+::is\+Column()}}, \mbox{\hyperlink{l00080}{Stage\+::\+Player\+::m\+\_\+ancestor\+Column\+Index}}, \mbox{\hyperlink{l00023}{Plastic\+Visual\+Settings\+::m\+\_\+apply\+Plastic\+Deformation}}, \mbox{\hyperlink{l00105}{Stage\+::\+Player\+::m\+\_\+bingo\+Order}}, \mbox{\hyperlink{l00096}{Stage\+::\+Player\+::m\+\_\+column}}, \mbox{\hyperlink{l00072}{Stage\+::\+Player\+::m\+\_\+dpi\+Aff}}, \mbox{\hyperlink{l00092}{Stage\+::\+Player\+::m\+\_\+fid}}, \mbox{\hyperlink{l00097}{Stage\+::\+Player\+::m\+\_\+frame}}, \mbox{\hyperlink{l00082}{Stage\+::\+Player\+::m\+\_\+is\+Current\+Column}}, \mbox{\hyperlink{l00077}{Stage\+::\+Player\+::m\+\_\+onion\+Skin\+Distance}}, \mbox{\hyperlink{l00104}{Stage\+::\+Player\+::m\+\_\+opacity}}, \mbox{\hyperlink{l00071}{Stage\+::\+Player\+::m\+\_\+placement}}, \mbox{\hyperlink{l00053}{Image\+Painter\+::\+Visual\+Settings\+::m\+\_\+plastic\+Visual\+Settings}}, \mbox{\hyperlink{l00026}{Plastic\+Visual\+Settings\+::m\+\_\+show\+Original\+Column}}, \mbox{\hyperlink{l00091}{Stage\+::\+Player\+::m\+\_\+sl}}, \mbox{\hyperlink{l00095}{Stage\+::\+Player\+::m\+\_\+xsh}}, \mbox{\hyperlink{l00074}{Stage\+::\+Player\+::m\+\_\+z}}, \mbox{\hyperlink{l01945}{TStage\+Object\+::perspective()}}, and \mbox{\hyperlink{l00170}{TXsh\+Column\+::set\+Opacity()}}.



Referenced by \mbox{\hyperlink{l00560}{add\+Cell\+With\+Onion\+Skin()}}.

\mbox{\Hypertarget{class_stage_builder_a4c1c9a8ab1830b4848e663d1d66c7d27}\label{class_stage_builder_a4c1c9a8ab1830b4848e663d1d66c7d27}} 
\index{StageBuilder@{StageBuilder}!addCellWithOnionSkin@{addCellWithOnionSkin}}
\index{addCellWithOnionSkin@{addCellWithOnionSkin}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{addCellWithOnionSkin()}{addCellWithOnionSkin()}}
{\footnotesize\ttfamily void Stage\+Builder\+::add\+Cell\+With\+Onion\+Skin (\begin{DoxyParamCaption}\item[{Player\+Set \&}]{players,  }\item[{\mbox{\hyperlink{class_toonz_scene}{Toonz\+Scene}} $\ast$}]{scene,  }\item[{\mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$}]{xsh,  }\item[{int}]{row,  }\item[{int}]{col,  }\item[{int}]{level,  }\item[{int}]{sub\+Sheet\+Col\+Index = {\ttfamily -\/1} }\end{DoxyParamCaption})}

Verify if onion-\/skin is active and recall {\bfseries{\mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{add\+Cell()}}}}. ~\newline
 Compute the distance between each cell with active onion-\/skin and current cell and recall {\bfseries{\mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{add\+Cell()}}}}. If onion-\/skin is not active recall {\bfseries{\mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{add\+Cell()}}}} with argument current cell. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00562                                                                          \{}
\DoxyCodeLine{00563   \textcolor{keyword}{struct }locals \{}
\DoxyCodeLine{00564     \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} hasOnionSkinnedMeshParent(\mbox{\hyperlink{class_stage_builder}{StageBuilder}} *sb, \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh,}
\DoxyCodeLine{00565                                                  \textcolor{keywordtype}{int} col) \{}
\DoxyCodeLine{00566       \textcolor{keyword}{const} \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} \&parentId =}
\DoxyCodeLine{00567           xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(TStageObjectId::ColumnId(col))-\/>\mbox{\hyperlink{class_t_stage_object_afb4724a8cc2ef7eb2c6c7585834210f2}{getParent}}();}
\DoxyCodeLine{00568 }
\DoxyCodeLine{00569       \textcolor{keywordflow}{return} parentId.\mbox{\hyperlink{class_t_stage_object_id_af6d13fcf31e7e10eef28f085855f469c}{isColumn}}() \&\&}
\DoxyCodeLine{00570              (parentId.getIndex() == sb-\/>m\_currentColumnIndex);}
\DoxyCodeLine{00571     \}}
\DoxyCodeLine{00572 }
\DoxyCodeLine{00573     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00574 }
\DoxyCodeLine{00575     \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} doStandardOnionSkin(\mbox{\hyperlink{class_stage_builder}{StageBuilder}} *sb, \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh,}
\DoxyCodeLine{00576                                            \textcolor{keywordtype}{int} level, \textcolor{keywordtype}{int} col) \{}
\DoxyCodeLine{00577       \textcolor{keyword}{const} \mbox{\hyperlink{class_onion_skin_mask}{OnionSkinMask}} \&osm = sb-\/>m\_onionSkinMask;}
\DoxyCodeLine{00578 }
\DoxyCodeLine{00579       \textcolor{keywordflow}{return} level == sb-\/>m\_xsheetLevel \&\& osm.isEnabled() \&\& !osm.isEmpty() \&\&}
\DoxyCodeLine{00580              (osm.isWholeScene() || col == sb-\/>m\_currentColumnIndex ||}
\DoxyCodeLine{00581               locals::hasOnionSkinnedMeshParent(sb, xsh, col));}
\DoxyCodeLine{00582     \}}
\DoxyCodeLine{00583   \};  \textcolor{comment}{// locals}}
\DoxyCodeLine{00584 }
\DoxyCodeLine{00585   \textcolor{keywordflow}{if} (m\_onionSkinMask.isShiftTraceEnabled()) \{}
\DoxyCodeLine{00586     \textcolor{comment}{// when visiting the subxsheet, valuate the subxsheet column index}}
\DoxyCodeLine{00587     \textcolor{keywordtype}{bool} isCurrent = (subSheetColIndex >= 0)}
\DoxyCodeLine{00588                          ? (subSheetColIndex == m\_currentColumnIndex)}
\DoxyCodeLine{00589                          : (col == m\_currentColumnIndex);}
\DoxyCodeLine{00590     \textcolor{keywordflow}{if} (isCurrent) \{}
\DoxyCodeLine{00591       \mbox{\hyperlink{class_t_xsh_cell}{TXshCell}} cell = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(row, col);}
\DoxyCodeLine{00592 }
\DoxyCodeLine{00593       \textcolor{comment}{// First Ghost}}
\DoxyCodeLine{00594       \textcolor{keywordtype}{int} r;}
\DoxyCodeLine{00595       r = row + m\_onionSkinMask.getShiftTraceGhostFrameOffset(0);}
\DoxyCodeLine{00596       \textcolor{keywordflow}{if} (r >= 0 \&\& xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(r, col) != cell \&\&}
\DoxyCodeLine{00597           (cell.\mbox{\hyperlink{class_t_xsh_cell_a8898cc47eba24e59477bfba8e2511f1d}{getSimpleLevel}}() == 0 ||}
\DoxyCodeLine{00598            xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(r, col).\mbox{\hyperlink{class_t_xsh_cell_a8898cc47eba24e59477bfba8e2511f1d}{getSimpleLevel}}() == cell.\mbox{\hyperlink{class_t_xsh_cell_a8898cc47eba24e59477bfba8e2511f1d}{getSimpleLevel}}())) \{}
\DoxyCodeLine{00599         m\_shiftTraceGhostId = FIRST\_GHOST;}
\DoxyCodeLine{00600         \mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{addCell}}(players, scene, xsh, r, col, level, subSheetColIndex);}
\DoxyCodeLine{00601       \}}
\DoxyCodeLine{00602 }
\DoxyCodeLine{00603       r = row + m\_onionSkinMask.getShiftTraceGhostFrameOffset(1);}
\DoxyCodeLine{00604       \textcolor{keywordflow}{if} (r >= 0 \&\& xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(r, col) != cell \&\&}
\DoxyCodeLine{00605           (cell.\mbox{\hyperlink{class_t_xsh_cell_a8898cc47eba24e59477bfba8e2511f1d}{getSimpleLevel}}() == 0 ||}
\DoxyCodeLine{00606            xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(r, col).\mbox{\hyperlink{class_t_xsh_cell_a8898cc47eba24e59477bfba8e2511f1d}{getSimpleLevel}}() == cell.\mbox{\hyperlink{class_t_xsh_cell_a8898cc47eba24e59477bfba8e2511f1d}{getSimpleLevel}}())) \{}
\DoxyCodeLine{00607         m\_shiftTraceGhostId = SECOND\_GHOST;}
\DoxyCodeLine{00608         \mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{addCell}}(players, scene, xsh, r, col, level, subSheetColIndex);}
\DoxyCodeLine{00609       \}}
\DoxyCodeLine{00610 }
\DoxyCodeLine{00611       \textcolor{comment}{// draw current working frame}}
\DoxyCodeLine{00612       \textcolor{keywordflow}{if} (!cell.\mbox{\hyperlink{class_t_xsh_cell_a5d20229e7bcd19957b123959e58a833e}{isEmpty}}()) \{}
\DoxyCodeLine{00613         m\_shiftTraceGhostId = TRACED;}
\DoxyCodeLine{00614         \mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{addCell}}(players, scene, xsh, row, col, level, subSheetColIndex);}
\DoxyCodeLine{00615         m\_shiftTraceGhostId = NO\_GHOST;}
\DoxyCodeLine{00616       \}}
\DoxyCodeLine{00617     \}}
\DoxyCodeLine{00618     \textcolor{comment}{// flip non-\/current columns as well}}
\DoxyCodeLine{00619     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00620       \textcolor{keywordtype}{int} flipKey = m\_onionSkinMask.getGhostFlipKey();}
\DoxyCodeLine{00621       \textcolor{keywordflow}{if} (flipKey == Qt::Key\_F1) \{}
\DoxyCodeLine{00622         \textcolor{keywordtype}{int} r = row + m\_onionSkinMask.getShiftTraceGhostFrameOffset(0);}
\DoxyCodeLine{00623         \mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{addCell}}(players, scene, xsh, r, col, level, subSheetColIndex);}
\DoxyCodeLine{00624       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (flipKey == Qt::Key\_F3) \{}
\DoxyCodeLine{00625         \textcolor{keywordtype}{int} r = row + m\_onionSkinMask.getShiftTraceGhostFrameOffset(1);}
\DoxyCodeLine{00626         \mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{addCell}}(players, scene, xsh, r, col, level, subSheetColIndex);}
\DoxyCodeLine{00627       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00628         \mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{addCell}}(players, scene, xsh, row, col, level, subSheetColIndex);}
\DoxyCodeLine{00629     \}}
\DoxyCodeLine{00630   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (locals::doStandardOnionSkin(\textcolor{keyword}{this}, xsh, level, col)) \{}
\DoxyCodeLine{00631     std::vector<int> rows;}
\DoxyCodeLine{00632     m\_onionSkinMask.\mbox{\hyperlink{class_onion_skin_mask_a9e64f221d9750268f449668afb614c11}{getAll}}(row, rows);}
\DoxyCodeLine{00633     std::vector<int>::iterator it = rows.begin();}
\DoxyCodeLine{00634     \textcolor{keywordflow}{while} (it != rows.end() \&\& *it < row) it++;}
\DoxyCodeLine{00635     std::sort(rows.begin(), it, descending);}
\DoxyCodeLine{00636 }
\DoxyCodeLine{00637     \textcolor{keywordtype}{int} frontPos = 0, backPos = 0;}
\DoxyCodeLine{00638     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (int)rows.size(); i++) \{}
\DoxyCodeLine{00639       \textcolor{keywordflow}{if} (rows[i] == row) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00640 }
\DoxyCodeLine{00641 \textcolor{preprocessor}{\#ifdef NUOVO\_ONION}}
\DoxyCodeLine{00642       m\_onionSkinDistance = rows[i] -\/ row;}
\DoxyCodeLine{00643 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00644       \textcolor{keywordflow}{if} (!Preferences::instance()-\/>isAnimationSheetEnabled() ||}
\DoxyCodeLine{00645           !alreadyAdded(xsh, row, i, rows, col)) \{}
\DoxyCodeLine{00646         m\_onionSkinDistance = (rows[i] -\/ row) < 0 ? -\/-\/backPos : ++frontPos;}
\DoxyCodeLine{00647         \mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{addCell}}(players, scene, xsh, rows[i], col, level, subSheetColIndex);}
\DoxyCodeLine{00648       \}}
\DoxyCodeLine{00649 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00650     \}}
\DoxyCodeLine{00651 }
\DoxyCodeLine{00652     m\_onionSkinDistance = 0;}
\DoxyCodeLine{00653     \mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{addCell}}(players, scene, xsh, row, col, level, subSheetColIndex);}
\DoxyCodeLine{00654 }
\DoxyCodeLine{00655     m\_onionSkinDistance = c\_noOnionSkin;}
\DoxyCodeLine{00656   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00657     \mbox{\hyperlink{class_stage_builder_a2aa20a61ca250dab7f1c780602aef2da}{addCell}}(players, scene, xsh, row, col, level, subSheetColIndex);}
\DoxyCodeLine{00658 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00330}{add\+Cell()}}, \mbox{\hyperlink{l00073}{Onion\+Skin\+Mask\+::get\+All()}}, \mbox{\hyperlink{l00233}{TXsheet\+::get\+Cell()}}, \mbox{\hyperlink{l00632}{TStage\+Object\+::get\+Parent()}}, \mbox{\hyperlink{l00019}{TXsh\+Cell\+::get\+Simple\+Level()}}, \mbox{\hyperlink{l00542}{TXsheet\+::get\+Stage\+Object()}}, \mbox{\hyperlink{l00180}{TStage\+Object\+Id\+::is\+Column()}}, and \mbox{\hyperlink{l00078}{TXsh\+Cell\+::is\+Empty()}}.



Referenced by \mbox{\hyperlink{l00662}{add\+Frame()}}.

\mbox{\Hypertarget{class_stage_builder_aece86e937e6a719d64cbf75d4dc03e5e}\label{class_stage_builder_aece86e937e6a719d64cbf75d4dc03e5e}} 
\index{StageBuilder@{StageBuilder}!addFrame@{addFrame}}
\index{addFrame@{addFrame}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{addFrame()}{addFrame()}}
{\footnotesize\ttfamily void Stage\+Builder\+::add\+Frame (\begin{DoxyParamCaption}\item[{Player\+Set \&}]{players,  }\item[{\mbox{\hyperlink{class_toonz_scene}{Toonz\+Scene}} $\ast$}]{scene,  }\item[{\mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$}]{xsh,  }\item[{int}]{row,  }\item[{int}]{level,  }\item[{bool}]{include\+Unvisible,  }\item[{bool}]{check\+Preview\+Visibility,  }\item[{int}]{sub\+Sheet\+Col\+Index = {\ttfamily -\/1} }\end{DoxyParamCaption})}

Recall {\bfseries{\mbox{\hyperlink{class_stage_builder_a4c1c9a8ab1830b4848e663d1d66c7d27}{add\+Cell\+With\+Onion\+Skin()}}}} for each cell of row {\bfseries{row}}. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00664                                                                                \{}
\DoxyCodeLine{00665   \textcolor{keywordtype}{int} columnCount        = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a17464dc5617cf87a46f03e1a52d36cc1}{getColumnCount}}();}
\DoxyCodeLine{00666   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} maskCount = m\_masks.size();}
\DoxyCodeLine{00667 }
\DoxyCodeLine{00668   std::vector<std::pair<double, int>> shuffle;}
\DoxyCodeLine{00669   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} c = 0; c < columnCount; c++) \{}
\DoxyCodeLine{00670     \mbox{\hyperlink{class_t_smart_pointer_t}{TXshColumnP}} column = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(c);}
\DoxyCodeLine{00671     assert(column);}
\DoxyCodeLine{00672     \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *pegbar = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(TStageObjectId::ColumnId(c));}
\DoxyCodeLine{00673     \textcolor{keywordtype}{double} columnSO      = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_a2e5f4f8ee682964cbc769aeaeee24291}{getSO}}(row);}
\DoxyCodeLine{00674     shuffle.push\_back(std::make\_pair(columnSO, c));}
\DoxyCodeLine{00675   \}}
\DoxyCodeLine{00676   std::stable\_sort(shuffle.begin(), shuffle.end(), \mbox{\hyperlink{class_stacking_order}{StackingOrder}}());}
\DoxyCodeLine{00677 }
\DoxyCodeLine{00678   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < columnCount; i++) \{}
\DoxyCodeLine{00679     \textcolor{keywordtype}{int} c = shuffle[i].second;}
\DoxyCodeLine{00680     \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_camera_test_check_adc1033b93dea95f49db36d8fb668e16d}{CameraTestCheck::instance}}()-\/>isEnabled() \&\& c != m\_currentColumnIndex)}
\DoxyCodeLine{00681       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00682     \textcolor{keywordflow}{if} (level == 0) \{}
\DoxyCodeLine{00683       \textcolor{comment}{// m\_isCurrentColumn = (c == m\_currentColumnIndex);}}
\DoxyCodeLine{00684       m\_ancestorColumnIndex = c;}
\DoxyCodeLine{00685     \}}
\DoxyCodeLine{00686     \mbox{\hyperlink{class_t_xsh_column}{TXshColumn}} *column = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(c);}
\DoxyCodeLine{00687     \textcolor{keywordtype}{bool} isMask        = \textcolor{keyword}{false};}
\DoxyCodeLine{00688     \textcolor{keywordflow}{if} (column \&\& !column-\/>isEmpty() \&\& !column-\/>getSoundColumn()) \{}
\DoxyCodeLine{00689       \textcolor{keywordflow}{if} (!column-\/>isPreviewVisible() \&\& checkPreviewVisibility) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00690       \textcolor{keywordflow}{if} (column-\/>isCamstandVisible() ||}
\DoxyCodeLine{00691           includeUnvisible)  \textcolor{comment}{// se l'"{}occhietto"{} non e' chiuso}}
\DoxyCodeLine{00692       \{}
\DoxyCodeLine{00693         \textcolor{keywordflow}{if} (column-\/>isMask())  \textcolor{comment}{// se e' una maschera (usate solo in tab pro)}}
\DoxyCodeLine{00694         \{}
\DoxyCodeLine{00695           isMask = \textcolor{keyword}{true};}
\DoxyCodeLine{00696           std::vector<int> saveMasks;}
\DoxyCodeLine{00697           saveMasks.swap(m\_masks);}
\DoxyCodeLine{00698           \textcolor{keywordtype}{int} maskIndex   = m\_maskPool.size();}
\DoxyCodeLine{00699           PlayerSet *mask = \textcolor{keyword}{new} PlayerSet();}
\DoxyCodeLine{00700           m\_maskPool.push\_back(mask);}
\DoxyCodeLine{00701           \mbox{\hyperlink{class_stage_builder_a4c1c9a8ab1830b4848e663d1d66c7d27}{addCellWithOnionSkin}}(*mask, scene, xsh, row, c, level);}
\DoxyCodeLine{00702           std::stable\_sort(mask-\/>begin(), mask-\/>end(), \mbox{\hyperlink{class_player_lt}{PlayerLt}}());}
\DoxyCodeLine{00703           saveMasks.swap(m\_masks);}
\DoxyCodeLine{00704           m\_masks.push\_back(maskIndex);}
\DoxyCodeLine{00705         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00706           \mbox{\hyperlink{class_stage_builder_a4c1c9a8ab1830b4848e663d1d66c7d27}{addCellWithOnionSkin}}(players, scene, xsh, row, c, level,}
\DoxyCodeLine{00707                                subSheetColIndex);}
\DoxyCodeLine{00708       \}}
\DoxyCodeLine{00709     \}}
\DoxyCodeLine{00710     \textcolor{keywordflow}{if} (!isMask) \{}
\DoxyCodeLine{00711       \textcolor{keywordflow}{while} (m\_masks.size() > maskCount) m\_masks.pop\_back();}
\DoxyCodeLine{00712     \}}
\DoxyCodeLine{00713   \}}
\DoxyCodeLine{00714   \textcolor{keywordflow}{if} (level == 0) std::stable\_sort(players.begin(), players.end(), \mbox{\hyperlink{class_player_lt}{PlayerLt}}());}
\DoxyCodeLine{00715 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00560}{add\+Cell\+With\+Onion\+Skin()}}, \mbox{\hyperlink{l01418}{TXsheet\+::get\+Column()}}, \mbox{\hyperlink{l01425}{TXsheet\+::get\+Column\+Count()}}, \mbox{\hyperlink{l01433}{TStage\+Object\+::get\+SO()}}, \mbox{\hyperlink{l00542}{TXsheet\+::get\+Stage\+Object()}}, and \mbox{\hyperlink{l00052}{Camera\+Test\+Check\+::instance()}}.



Referenced by \mbox{\hyperlink{l00330}{add\+Cell()}}, and \mbox{\hyperlink{l00911}{Stage\+::visit()}}.

\mbox{\Hypertarget{class_stage_builder_acfa9ec0326e2d6aff34e4d94a1c12f03}\label{class_stage_builder_acfa9ec0326e2d6aff34e4d94a1c12f03}} 
\index{StageBuilder@{StageBuilder}!addSimpleLevelFrame@{addSimpleLevelFrame}}
\index{addSimpleLevelFrame@{addSimpleLevelFrame}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{addSimpleLevelFrame()}{addSimpleLevelFrame()}}
{\footnotesize\ttfamily void Stage\+Builder\+::add\+Simple\+Level\+Frame (\begin{DoxyParamCaption}\item[{Player\+Set \&}]{players,  }\item[{\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$}]{level,  }\item[{const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{fid }\end{DoxyParamCaption})}

Add in {\bfseries{players}} vector information about {\bfseries{level}} cell with {\bfseries{\mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}}}} {\bfseries{fid}}. ~\newline
 Compute information for all cell with active onion-\/skin, if onion-\/skin is not active compute information only for current cell. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00721                                                             \{}
\DoxyCodeLine{00722   \textcolor{keyword}{auto} addGhost = [\&](\textcolor{keywordtype}{int} ghostIndex, \textcolor{keywordtype}{int} ghostRow, \textcolor{keywordtype}{bool} fullOpac = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{00723     \textcolor{keyword}{const} \mbox{\hyperlink{class_t_frame_id}{TFrameId}} \&ghostFid = level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_a07279a40ffad2c6ccc597c0a418f78fb}{index2fid}}(ghostRow);}
\DoxyCodeLine{00724 }
\DoxyCodeLine{00725     \mbox{\hyperlink{class_stage_1_1_player}{Player}} player;}
\DoxyCodeLine{00726     player.\mbox{\hyperlink{class_stage_1_1_player_a6230d77933caf93b9699bd5e2de0d2b0}{m\_sl}}                     = level;}
\DoxyCodeLine{00727     player.\mbox{\hyperlink{class_stage_1_1_player_af88189b51ebf5b86f87f77281aba0ce1}{m\_frame}}                  = level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_af30a02239ef0900c095a0af366dea26a}{guessIndex}}(ghostFid);}
\DoxyCodeLine{00728     player.\mbox{\hyperlink{class_stage_1_1_player_aba5bf8d012d1017e5fe66d5c4b1e27df}{m\_fid}}                    = ghostFid;}
\DoxyCodeLine{00729     player.\mbox{\hyperlink{class_stage_1_1_player_aba32c099fd49a4343580c28ade32e144}{m\_isCurrentColumn}}        = \textcolor{keyword}{true};}
\DoxyCodeLine{00730     player.\mbox{\hyperlink{class_stage_1_1_player_af5564bb7e4d82fec3c47554161bf2c91}{m\_isCurrentXsheetLevel}}   = \textcolor{keyword}{true};}
\DoxyCodeLine{00731     player.m\_isEditingLevel         = \textcolor{keyword}{true};}
\DoxyCodeLine{00732     player.m\_currentFrameId         = m\_currentFrameId;}
\DoxyCodeLine{00733     player.m\_isGuidedDrawingEnabled = m\_isGuidedDrawingEnabled;}
\DoxyCodeLine{00734     player.m\_guidedFrontStroke      = m\_guidedFrontStroke;}
\DoxyCodeLine{00735     player.m\_guidedBackStroke       = m\_guidedBackStroke;}
\DoxyCodeLine{00736     player.m\_isVisibleinOSM         = ghostRow >= 0;}
\DoxyCodeLine{00737     player.\mbox{\hyperlink{class_stage_1_1_player_ae9146f2fdcb1837482abf535fc5622ef}{m\_onionSkinDistance}}      = m\_onionSkinDistance;}
\DoxyCodeLine{00738     player.\mbox{\hyperlink{class_stage_1_1_player_a0495491ce47344daba1cd55e1b64905a}{m\_dpiAff}}                 = getDpiAffine(level, ghostFid);}
\DoxyCodeLine{00739     player.\mbox{\hyperlink{class_stage_1_1_player_affd2dfe55cdffea6d55be757f502df72}{m\_ancestorColumnIndex}}    = -\/1;}
\DoxyCodeLine{00740 }
\DoxyCodeLine{00741     \textcolor{keywordflow}{if} (fullOpac) \{}
\DoxyCodeLine{00742       player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}} = m\_onionSkinMask.getShiftTraceGhostAff(ghostIndex) *}
\DoxyCodeLine{00743                            player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}};}
\DoxyCodeLine{00744       players.push\_back(player);}
\DoxyCodeLine{00745       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00746     \}}
\DoxyCodeLine{00747 }
\DoxyCodeLine{00748     \textcolor{keywordtype}{int} opacity         = player.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}};}
\DoxyCodeLine{00749     player.\mbox{\hyperlink{class_stage_1_1_player_aab56aced982252aafc6c06f1b66dbdac}{m\_bingoOrder}} = 10;}
\DoxyCodeLine{00750     \textcolor{keywordflow}{if} (m\_onionSkinMask.getShiftTraceStatus() !=}
\DoxyCodeLine{00751         OnionSkinMask::ENABLED\_WITHOUT\_GHOST\_MOVEMENTS) \{}
\DoxyCodeLine{00752       player.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}} = 30;}
\DoxyCodeLine{00753       players.push\_back(player);}
\DoxyCodeLine{00754       player.\mbox{\hyperlink{class_stage_1_1_player_a2b05fa8fdc95ac04a532fc2d227a3a81}{m\_opacity}}           = opacity;}
\DoxyCodeLine{00755       player.\mbox{\hyperlink{class_stage_1_1_player_ae9146f2fdcb1837482abf535fc5622ef}{m\_onionSkinDistance}} = (ghostIndex == 0) ? -\/1 : 1;}
\DoxyCodeLine{00756       player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}} = m\_onionSkinMask.getShiftTraceGhostAff(ghostIndex) *}
\DoxyCodeLine{00757                            player.\mbox{\hyperlink{class_stage_1_1_player_a99c9004772f5575fb627dcfb29137459}{m\_placement}};}
\DoxyCodeLine{00758     \}}
\DoxyCodeLine{00759     players.push\_back(player);}
\DoxyCodeLine{00760   \};}
\DoxyCodeLine{00761 }
\DoxyCodeLine{00762   \textcolor{keywordtype}{int} index = -\/1;}
\DoxyCodeLine{00763 }
\DoxyCodeLine{00764   \textcolor{keywordtype}{int} row = level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_af30a02239ef0900c095a0af366dea26a}{guessIndex}}(fid);}
\DoxyCodeLine{00765 }
\DoxyCodeLine{00766   \textcolor{comment}{// Shift \& Trace}}
\DoxyCodeLine{00767   \textcolor{keywordflow}{if} (m\_onionSkinMask.isShiftTraceEnabled()) \{}
\DoxyCodeLine{00768     \textcolor{keywordtype}{int} previousOffset = m\_onionSkinMask.getShiftTraceGhostFrameOffset(0);}
\DoxyCodeLine{00769     \textcolor{keywordtype}{int} forwardOffset  = m\_onionSkinMask.getShiftTraceGhostFrameOffset(1);}
\DoxyCodeLine{00770 }
\DoxyCodeLine{00771     \textcolor{comment}{// If F1, F2 or F3 key is pressed, then only}}
\DoxyCodeLine{00772     \textcolor{comment}{// display the corresponding ghost}}
\DoxyCodeLine{00773     \textcolor{keywordtype}{int} flipKey = m\_onionSkinMask.getGhostFlipKey();}
\DoxyCodeLine{00774     \textcolor{keywordflow}{if} (Qt::Key\_F1 <= flipKey \&\& flipKey <= Qt::Key\_F3) \{}
\DoxyCodeLine{00775       \textcolor{keywordflow}{if} (flipKey == Qt::Key\_F1 \&\& previousOffset != 0) \{}
\DoxyCodeLine{00776         addGhost(0, row + previousOffset, \textcolor{keyword}{true});}
\DoxyCodeLine{00777         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00778       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (flipKey == Qt::Key\_F3 \&\& forwardOffset != 0) \{}
\DoxyCodeLine{00779         addGhost(1, row + forwardOffset, \textcolor{keyword}{true});}
\DoxyCodeLine{00780         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00781       \}}
\DoxyCodeLine{00782     \}}
\DoxyCodeLine{00783 }
\DoxyCodeLine{00784     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00785       \textcolor{comment}{// draw the first ghost}}
\DoxyCodeLine{00786       \textcolor{keywordflow}{if} (previousOffset != 0) addGhost(0, row + previousOffset);}
\DoxyCodeLine{00787       \textcolor{keywordflow}{if} (forwardOffset != 0) addGhost(1, row + forwardOffset);}
\DoxyCodeLine{00788     \}}
\DoxyCodeLine{00789   \}}
\DoxyCodeLine{00790   \textcolor{comment}{// Onion Skin}}
\DoxyCodeLine{00791   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!m\_onionSkinMask.isEmpty() \&\& m\_onionSkinMask.isEnabled()) \{}
\DoxyCodeLine{00792     std::vector<int> rows;}
\DoxyCodeLine{00793     m\_onionSkinMask.\mbox{\hyperlink{class_onion_skin_mask_a9e64f221d9750268f449668afb614c11}{getAll}}(row, rows);}
\DoxyCodeLine{00794 }
\DoxyCodeLine{00795     std::vector<int>::iterator it = rows.begin();}
\DoxyCodeLine{00796     \textcolor{keywordflow}{while} (it != rows.end() \&\& *it < row) ++it;}
\DoxyCodeLine{00797     std::sort(rows.begin(), it, descending);}
\DoxyCodeLine{00798     m\_onionSkinDistance = 0;}
\DoxyCodeLine{00799     \textcolor{keywordtype}{int} frontPos = 0, backPos = 0;}
\DoxyCodeLine{00800 }
\DoxyCodeLine{00801     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (int)rows.size(); i++) \{}
\DoxyCodeLine{00802       \textcolor{keyword}{const} \mbox{\hyperlink{class_t_frame_id}{TFrameId}} \&fid2 = level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_a07279a40ffad2c6ccc597c0a418f78fb}{index2fid}}(rows[i]);}
\DoxyCodeLine{00803       \textcolor{keywordflow}{if} (fid2 == fid) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00804       players.push\_back(\mbox{\hyperlink{class_stage_1_1_player}{Player}}());}
\DoxyCodeLine{00805       \mbox{\hyperlink{class_stage_1_1_player}{Player}} \&player                  = players.back();}
\DoxyCodeLine{00806       player.\mbox{\hyperlink{class_stage_1_1_player_a6230d77933caf93b9699bd5e2de0d2b0}{m\_sl}}                     = level;}
\DoxyCodeLine{00807       player.\mbox{\hyperlink{class_stage_1_1_player_af88189b51ebf5b86f87f77281aba0ce1}{m\_frame}}                  = level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_af30a02239ef0900c095a0af366dea26a}{guessIndex}}(fid);}
\DoxyCodeLine{00808       player.\mbox{\hyperlink{class_stage_1_1_player_aba5bf8d012d1017e5fe66d5c4b1e27df}{m\_fid}}                    = fid2;}
\DoxyCodeLine{00809       player.\mbox{\hyperlink{class_stage_1_1_player_aba32c099fd49a4343580c28ade32e144}{m\_isCurrentColumn}}        = \textcolor{keyword}{true};}
\DoxyCodeLine{00810       player.\mbox{\hyperlink{class_stage_1_1_player_af5564bb7e4d82fec3c47554161bf2c91}{m\_isCurrentXsheetLevel}}   = \textcolor{keyword}{true};}
\DoxyCodeLine{00811       player.m\_isEditingLevel         = \textcolor{keyword}{true};}
\DoxyCodeLine{00812       player.m\_currentFrameId         = m\_currentFrameId;}
\DoxyCodeLine{00813       player.m\_isGuidedDrawingEnabled = m\_isGuidedDrawingEnabled;}
\DoxyCodeLine{00814       player.m\_guidedFrontStroke      = m\_guidedFrontStroke;}
\DoxyCodeLine{00815       player.m\_guidedBackStroke       = m\_guidedBackStroke;}
\DoxyCodeLine{00816       player.m\_isVisibleinOSM         = rows[i] >= 0;}
\DoxyCodeLine{00817 \textcolor{preprocessor}{\#ifdef NUOVO\_ONION}}
\DoxyCodeLine{00818       player.\mbox{\hyperlink{class_stage_1_1_player_ae9146f2fdcb1837482abf535fc5622ef}{m\_onionSkinDistance}} = rows[i] -\/ row;}
\DoxyCodeLine{00819 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00820       player.\mbox{\hyperlink{class_stage_1_1_player_ae9146f2fdcb1837482abf535fc5622ef}{m\_onionSkinDistance}} = rows[i] -\/ row < 0 ? -\/-\/backPos : ++frontPos;}
\DoxyCodeLine{00821 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00822       player.\mbox{\hyperlink{class_stage_1_1_player_a0495491ce47344daba1cd55e1b64905a}{m\_dpiAff}} = getDpiAffine(level, fid2);}
\DoxyCodeLine{00823     \}}
\DoxyCodeLine{00824   \}}
\DoxyCodeLine{00825   players.push\_back(\mbox{\hyperlink{class_stage_1_1_player}{Player}}());}
\DoxyCodeLine{00826   \mbox{\hyperlink{class_stage_1_1_player}{Player}} \&player = players.back();}
\DoxyCodeLine{00827   player.\mbox{\hyperlink{class_stage_1_1_player_a6230d77933caf93b9699bd5e2de0d2b0}{m\_sl}}    = level;}
\DoxyCodeLine{00828   player.\mbox{\hyperlink{class_stage_1_1_player_af88189b51ebf5b86f87f77281aba0ce1}{m\_frame}} = level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_af30a02239ef0900c095a0af366dea26a}{guessIndex}}(fid);}
\DoxyCodeLine{00829   player.\mbox{\hyperlink{class_stage_1_1_player_aba5bf8d012d1017e5fe66d5c4b1e27df}{m\_fid}}   = fid;}
\DoxyCodeLine{00830   \textcolor{keywordflow}{if} (!m\_onionSkinMask.isEmpty() \&\& m\_onionSkinMask.isEnabled())}
\DoxyCodeLine{00831     player.\mbox{\hyperlink{class_stage_1_1_player_ae9146f2fdcb1837482abf535fc5622ef}{m\_onionSkinDistance}} = 0;}
\DoxyCodeLine{00832   player.\mbox{\hyperlink{class_stage_1_1_player_aba32c099fd49a4343580c28ade32e144}{m\_isCurrentColumn}}      = \textcolor{keyword}{true};}
\DoxyCodeLine{00833   player.\mbox{\hyperlink{class_stage_1_1_player_af5564bb7e4d82fec3c47554161bf2c91}{m\_isCurrentXsheetLevel}} = \textcolor{keyword}{true};}
\DoxyCodeLine{00834   player.m\_isEditingLevel       = \textcolor{keyword}{true};}
\DoxyCodeLine{00835   player.\mbox{\hyperlink{class_stage_1_1_player_affd2dfe55cdffea6d55be757f502df72}{m\_ancestorColumnIndex}}  = -\/1;}
\DoxyCodeLine{00836   player.\mbox{\hyperlink{class_stage_1_1_player_a0495491ce47344daba1cd55e1b64905a}{m\_dpiAff}}               = getDpiAffine(level, fid);}
\DoxyCodeLine{00837 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00073}{Onion\+Skin\+Mask\+::get\+All()}}, \mbox{\hyperlink{l00524}{TXsh\+Simple\+Level\+::guess\+Index()}}, \mbox{\hyperlink{l00544}{TXsh\+Simple\+Level\+::index2fid()}}, \mbox{\hyperlink{l00080}{Stage\+::\+Player\+::m\+\_\+ancestor\+Column\+Index}}, \mbox{\hyperlink{l00105}{Stage\+::\+Player\+::m\+\_\+bingo\+Order}}, \mbox{\hyperlink{l00072}{Stage\+::\+Player\+::m\+\_\+dpi\+Aff}}, \mbox{\hyperlink{l00092}{Stage\+::\+Player\+::m\+\_\+fid}}, \mbox{\hyperlink{l00097}{Stage\+::\+Player\+::m\+\_\+frame}}, \mbox{\hyperlink{l00082}{Stage\+::\+Player\+::m\+\_\+is\+Current\+Column}}, \mbox{\hyperlink{l00084}{Stage\+::\+Player\+::m\+\_\+is\+Current\+Xsheet\+Level}}, \mbox{\hyperlink{l00077}{Stage\+::\+Player\+::m\+\_\+onion\+Skin\+Distance}}, \mbox{\hyperlink{l00104}{Stage\+::\+Player\+::m\+\_\+opacity}}, \mbox{\hyperlink{l00071}{Stage\+::\+Player\+::m\+\_\+placement}}, and \mbox{\hyperlink{l00091}{Stage\+::\+Player\+::m\+\_\+sl}}.



Referenced by \mbox{\hyperlink{l00979}{Stage\+::visit()}}.

\mbox{\Hypertarget{class_stage_builder_a4c5d29002a29453763337c7f6a32b4aa}\label{class_stage_builder_a4c5d29002a29453763337c7f6a32b4aa}} 
\index{StageBuilder@{StageBuilder}!visit@{visit}}
\index{visit@{visit}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{visit()}{visit()}}
{\footnotesize\ttfamily void Stage\+Builder\+::visit (\begin{DoxyParamCaption}\item[{Player\+Set \&}]{players,  }\item[{\mbox{\hyperlink{class_stage_1_1_visitor}{Visitor}} \&}]{visitor,  }\item[{bool}]{is\+Playing = {\ttfamily false} }\end{DoxyParamCaption})}

Recall {\bfseries{visitor.\+on\+Image(player)}} for each {\bfseries{player}} contained in {\bfseries{players}} vector. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00841                                                                              \{}
\DoxyCodeLine{00842   std::vector<int> masks;}
\DoxyCodeLine{00843   \textcolor{keywordtype}{int} m                = players.size();}
\DoxyCodeLine{00844   \textcolor{keywordtype}{int} h                = 0;}
\DoxyCodeLine{00845   \textcolor{keywordtype}{bool} stopMotionShown = \textcolor{keyword}{false};}
\DoxyCodeLine{00846   \textcolor{keywordflow}{for} (; h < m; h++) \{}
\DoxyCodeLine{00847     \mbox{\hyperlink{class_stage_1_1_player}{Player}} \&player = players[h];}
\DoxyCodeLine{00848     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{00849     \textcolor{comment}{// vale solo per TAB pro}}
\DoxyCodeLine{00850     \textcolor{keywordflow}{for} (; i < masks.size() \&\& i < player.m\_masks.size(); i++)}
\DoxyCodeLine{00851       \textcolor{keywordflow}{if} (masks[i] != player.m\_masks[i]) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00852     \textcolor{comment}{// vale solo per TAB pro}}
\DoxyCodeLine{00853     \textcolor{keywordflow}{if} (i < masks.size() || i < player.m\_masks.size()) \{}
\DoxyCodeLine{00854       \textcolor{keywordflow}{while} (i < masks.size()) \{}
\DoxyCodeLine{00855         masks.pop\_back();}
\DoxyCodeLine{00856         visitor.disableMask();}
\DoxyCodeLine{00857       \}}
\DoxyCodeLine{00858       \textcolor{keywordflow}{while} (i < player.m\_masks.size()) \{}
\DoxyCodeLine{00859         \textcolor{keywordtype}{int} maskIndex = player.m\_masks[i];}
\DoxyCodeLine{00860         visitor.beginMask();}
\DoxyCodeLine{00861         \mbox{\hyperlink{class_stage_builder_a4c5d29002a29453763337c7f6a32b4aa}{visit}}(*m\_maskPool[maskIndex], visitor, isPlaying);}
\DoxyCodeLine{00862         visitor.endMask();}
\DoxyCodeLine{00863         masks.push\_back(maskIndex);}
\DoxyCodeLine{00864         visitor.enableMask();}
\DoxyCodeLine{00865         i++;}
\DoxyCodeLine{00866       \}}
\DoxyCodeLine{00867     \}}
\DoxyCodeLine{00868     player.\mbox{\hyperlink{class_stage_1_1_player_a2a22d160f4fa74226fbbbf7e677da4b3}{m\_isPlaying}} = isPlaying;}
\DoxyCodeLine{00869 }
\DoxyCodeLine{00870 \textcolor{preprocessor}{\#if defined(x64)}}
\DoxyCodeLine{00871     \textcolor{keywordflow}{if} (m\_liveViewImage \&\& player.\mbox{\hyperlink{class_stage_1_1_player_a6230d77933caf93b9699bd5e2de0d2b0}{m\_sl}} == m\_liveViewPlayer.m\_sl) \{}
\DoxyCodeLine{00872       \textcolor{keywordflow}{if} (m\_lineupImage) \{}
\DoxyCodeLine{00873         m\_lineupPlayer.m\_sl = NULL;}
\DoxyCodeLine{00874         visitor.onRasterImage(m\_lineupImage.getPointer(), m\_lineupPlayer);}
\DoxyCodeLine{00875         stopMotionShown = \textcolor{keyword}{true};}
\DoxyCodeLine{00876       \}}
\DoxyCodeLine{00877       \textcolor{keywordflow}{if} (m\_liveViewImage) \{}
\DoxyCodeLine{00878         m\_liveViewPlayer.m\_sl = NULL;}
\DoxyCodeLine{00879         visitor.onRasterImage(m\_liveViewImage.getPointer(), m\_liveViewPlayer);}
\DoxyCodeLine{00880         stopMotionShown = \textcolor{keyword}{true};}
\DoxyCodeLine{00881       \}}
\DoxyCodeLine{00882     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00883       visitor.\mbox{\hyperlink{class_stage_1_1_visitor_a4f6fa9bc6e68aaf2d1a2f5a69a0f8c53}{onImage}}(player);}
\DoxyCodeLine{00884     \}}
\DoxyCodeLine{00885   \}}
\DoxyCodeLine{00886   \textcolor{keywordflow}{if} (!stopMotionShown \&\& (m\_liveViewImage || m\_lineupImage)) \{}
\DoxyCodeLine{00887     \textcolor{keywordflow}{if} (m\_lineupImage) \{}
\DoxyCodeLine{00888       m\_lineupPlayer.m\_sl = NULL;}
\DoxyCodeLine{00889       visitor.onRasterImage(m\_lineupImage.getPointer(), m\_lineupPlayer);}
\DoxyCodeLine{00890     \}}
\DoxyCodeLine{00891     \textcolor{keywordflow}{if} (m\_liveViewImage) \{}
\DoxyCodeLine{00892       m\_liveViewPlayer.m\_sl = NULL;}
\DoxyCodeLine{00893       visitor.onRasterImage(m\_liveViewImage.getPointer(), m\_liveViewPlayer);}
\DoxyCodeLine{00894     \}}
\DoxyCodeLine{00895 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00896     visitor.\mbox{\hyperlink{class_stage_1_1_visitor_a4f6fa9bc6e68aaf2d1a2f5a69a0f8c53}{onImage}}(player);}
\DoxyCodeLine{00897 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00898   \}}
\DoxyCodeLine{00899   \textcolor{comment}{// vale solo per TAB pro}}
\DoxyCodeLine{00900   \textcolor{keywordflow}{for} (h = 0; h < (int)masks.size(); h++) visitor.disableMask();}
\DoxyCodeLine{00901 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00100}{Stage\+::\+Player\+::m\+\_\+is\+Playing}}, \mbox{\hyperlink{l00091}{Stage\+::\+Player\+::m\+\_\+sl}}, \mbox{\hyperlink{class_stage_1_1_visitor_a4f6fa9bc6e68aaf2d1a2f5a69a0f8c53}{Stage\+::\+Visitor\+::on\+Image()}}, and \mbox{\hyperlink{l00841}{visit()}}.



Referenced by \mbox{\hyperlink{l00841}{visit()}}, and \mbox{\hyperlink{l00911}{Stage\+::visit()}}.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_stage_builder_a6280867b1af1dd143f20d97bc517b6c4}\label{class_stage_builder_a6280867b1af1dd143f20d97bc517b6c4}} 
\index{StageBuilder@{StageBuilder}!m\_ancestorColumnIndex@{m\_ancestorColumnIndex}}
\index{m\_ancestorColumnIndex@{m\_ancestorColumnIndex}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_ancestorColumnIndex}{m\_ancestorColumnIndex}}
{\footnotesize\ttfamily int Stage\+Builder\+::m\+\_\+ancestor\+Column\+Index}

\mbox{\Hypertarget{class_stage_builder_a3589395e6aca83cbb0d55d0386392f16}\label{class_stage_builder_a3589395e6aca83cbb0d55d0386392f16}} 
\index{StageBuilder@{StageBuilder}!m\_ancestors@{m\_ancestors}}
\index{m\_ancestors@{m\_ancestors}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_ancestors}{m\_ancestors}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{class_t_xsh_column}{TXsh\+Column}} $\ast$$>$ Stage\+Builder\+::m\+\_\+ancestors}

\mbox{\Hypertarget{class_stage_builder_afc794dfbc4a98780a91a7f024cec2ee4}\label{class_stage_builder_afc794dfbc4a98780a91a7f024cec2ee4}} 
\index{StageBuilder@{StageBuilder}!m\_camera3d@{m\_camera3d}}
\index{m\_camera3d@{m\_camera3d}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_camera3d}{m\_camera3d}}
{\footnotesize\ttfamily bool Stage\+Builder\+::m\+\_\+camera3d}

\mbox{\Hypertarget{class_stage_builder_a2cb3d97d88ef502d767e619d7ad4e7ef}\label{class_stage_builder_a2cb3d97d88ef502d767e619d7ad4e7ef}} 
\index{StageBuilder@{StageBuilder}!m\_cameraPlacement@{m\_cameraPlacement}}
\index{m\_cameraPlacement@{m\_cameraPlacement}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_cameraPlacement}{m\_cameraPlacement}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_z_placement}{ZPlacement}} Stage\+Builder\+::m\+\_\+camera\+Placement}

\mbox{\Hypertarget{class_stage_builder_a399a33c8cf38bb96c8769b57440f12a8}\label{class_stage_builder_a399a33c8cf38bb96c8769b57440f12a8}} 
\index{StageBuilder@{StageBuilder}!m\_currentColumnIndex@{m\_currentColumnIndex}}
\index{m\_currentColumnIndex@{m\_currentColumnIndex}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_currentColumnIndex}{m\_currentColumnIndex}}
{\footnotesize\ttfamily int Stage\+Builder\+::m\+\_\+current\+Column\+Index}

\mbox{\Hypertarget{class_stage_builder_a637b384da6847085e9d5d90846cc5f52}\label{class_stage_builder_a637b384da6847085e9d5d90846cc5f52}} 
\index{StageBuilder@{StageBuilder}!m\_currentFrameId@{m\_currentFrameId}}
\index{m\_currentFrameId@{m\_currentFrameId}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_currentFrameId}{m\_currentFrameId}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} Stage\+Builder\+::m\+\_\+current\+Frame\+Id}

\mbox{\Hypertarget{class_stage_builder_afbea32a889325bbd8e72644a174d5193}\label{class_stage_builder_afbea32a889325bbd8e72644a174d5193}} 
\index{StageBuilder@{StageBuilder}!m\_currentXsheetLevel@{m\_currentXsheetLevel}}
\index{m\_currentXsheetLevel@{m\_currentXsheetLevel}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_currentXsheetLevel}{m\_currentXsheetLevel}}
{\footnotesize\ttfamily int Stage\+Builder\+::m\+\_\+current\+Xsheet\+Level}

\mbox{\Hypertarget{class_stage_builder_a0464c80c751ac882d18cb8fc6aafcf21}\label{class_stage_builder_a0464c80c751ac882d18cb8fc6aafcf21}} 
\index{StageBuilder@{StageBuilder}!m\_fade@{m\_fade}}
\index{m\_fade@{m\_fade}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_fade}{m\_fade}}
{\footnotesize\ttfamily double Stage\+Builder\+::m\+\_\+fade}

\mbox{\Hypertarget{class_stage_builder_a4d58ffedfaea24f2b262333b4075d472}\label{class_stage_builder_a4d58ffedfaea24f2b262333b4075d472}} 
\index{StageBuilder@{StageBuilder}!m\_guidedBackStroke@{m\_guidedBackStroke}}
\index{m\_guidedBackStroke@{m\_guidedBackStroke}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_guidedBackStroke}{m\_guidedBackStroke}}
{\footnotesize\ttfamily int Stage\+Builder\+::m\+\_\+guided\+Back\+Stroke = -\/1}

\mbox{\Hypertarget{class_stage_builder_a7354ca81fdb2151131e9f399d2783498}\label{class_stage_builder_a7354ca81fdb2151131e9f399d2783498}} 
\index{StageBuilder@{StageBuilder}!m\_guidedFrontStroke@{m\_guidedFrontStroke}}
\index{m\_guidedFrontStroke@{m\_guidedFrontStroke}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_guidedFrontStroke}{m\_guidedFrontStroke}}
{\footnotesize\ttfamily int Stage\+Builder\+::m\+\_\+guided\+Front\+Stroke = -\/1}

\mbox{\Hypertarget{class_stage_builder_a91d13b870eea5f0d2b4831470f86394a}\label{class_stage_builder_a91d13b870eea5f0d2b4831470f86394a}} 
\index{StageBuilder@{StageBuilder}!m\_isGuidedDrawingEnabled@{m\_isGuidedDrawingEnabled}}
\index{m\_isGuidedDrawingEnabled@{m\_isGuidedDrawingEnabled}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_isGuidedDrawingEnabled}{m\_isGuidedDrawingEnabled}}
{\footnotesize\ttfamily int Stage\+Builder\+::m\+\_\+is\+Guided\+Drawing\+Enabled}

\mbox{\Hypertarget{class_stage_builder_a1335bb8e496143277ffef8066fa15c5e}\label{class_stage_builder_a1335bb8e496143277ffef8066fa15c5e}} 
\index{StageBuilder@{StageBuilder}!m\_maskPool@{m\_maskPool}}
\index{m\_maskPool@{m\_maskPool}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_maskPool}{m\_maskPool}}
{\footnotesize\ttfamily std\+::vector$<$Player\+Set $\ast$$>$ Stage\+Builder\+::m\+\_\+mask\+Pool}

\mbox{\Hypertarget{class_stage_builder_a5e17a6dbe026d2e10604e7e2b83d399d}\label{class_stage_builder_a5e17a6dbe026d2e10604e7e2b83d399d}} 
\index{StageBuilder@{StageBuilder}!m\_masks@{m\_masks}}
\index{m\_masks@{m\_masks}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_masks}{m\_masks}}
{\footnotesize\ttfamily std\+::vector$<$int$>$ Stage\+Builder\+::m\+\_\+masks}

\mbox{\Hypertarget{class_stage_builder_a6ee60374e2f5f4d915793cd503a7bdaf}\label{class_stage_builder_a6ee60374e2f5f4d915793cd503a7bdaf}} 
\index{StageBuilder@{StageBuilder}!m\_onionSkinDistance@{m\_onionSkinDistance}}
\index{m\_onionSkinDistance@{m\_onionSkinDistance}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_onionSkinDistance}{m\_onionSkinDistance}}
{\footnotesize\ttfamily int Stage\+Builder\+::m\+\_\+onion\+Skin\+Distance}

\mbox{\Hypertarget{class_stage_builder_abb78f63ffe6a93c9e1f78bff0c330f71}\label{class_stage_builder_abb78f63ffe6a93c9e1f78bff0c330f71}} 
\index{StageBuilder@{StageBuilder}!m\_onionSkinMask@{m\_onionSkinMask}}
\index{m\_onionSkinMask@{m\_onionSkinMask}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_onionSkinMask}{m\_onionSkinMask}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_onion_skin_mask}{Onion\+Skin\+Mask}} Stage\+Builder\+::m\+\_\+onion\+Skin\+Mask}

\mbox{\Hypertarget{class_stage_builder_aa1740ffd9aec53133b88ff7ad04d893e}\label{class_stage_builder_aa1740ffd9aec53133b88ff7ad04d893e}} 
\index{StageBuilder@{StageBuilder}!m\_placementStack@{m\_placementStack}}
\index{m\_placementStack@{m\_placementStack}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_placementStack}{m\_placementStack}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{class_z_placement}{ZPlacement}}$>$ Stage\+Builder\+::m\+\_\+placement\+Stack}

\mbox{\Hypertarget{class_stage_builder_a29690cb79fcdc47365573678cfd8c238}\label{class_stage_builder_a29690cb79fcdc47365573678cfd8c238}} 
\index{StageBuilder@{StageBuilder}!m\_players@{m\_players}}
\index{m\_players@{m\_players}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_players}{m\_players}}
{\footnotesize\ttfamily Player\+Set Stage\+Builder\+::m\+\_\+players}

\mbox{\Hypertarget{class_stage_builder_a3005326426895889a3f801efb998174d}\label{class_stage_builder_a3005326426895889a3f801efb998174d}} 
\index{StageBuilder@{StageBuilder}!m\_shiftTraceGhostId@{m\_shiftTraceGhostId}}
\index{m\_shiftTraceGhostId@{m\_shiftTraceGhostId}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_shiftTraceGhostId}{m\_shiftTraceGhostId}}
{\footnotesize\ttfamily Shift\+Trace\+Ghost\+Id Stage\+Builder\+::m\+\_\+shift\+Trace\+Ghost\+Id}

\mbox{\Hypertarget{class_stage_builder_a1eb221fb6d49134f1e8a0254f39332cd}\label{class_stage_builder_a1eb221fb6d49134f1e8a0254f39332cd}} 
\index{StageBuilder@{StageBuilder}!m\_subXSheetStack@{m\_subXSheetStack}}
\index{m\_subXSheetStack@{m\_subXSheetStack}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_subXSheetStack}{m\_subXSheetStack}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{struct_stage_builder_1_1_sub_x_sheet}{Sub\+XSheet}}$>$ Stage\+Builder\+::m\+\_\+sub\+XSheet\+Stack}

\mbox{\Hypertarget{class_stage_builder_a098288a79a7dd1c808c5005cf5b517bb}\label{class_stage_builder_a098288a79a7dd1c808c5005cf5b517bb}} 
\index{StageBuilder@{StageBuilder}!m\_vs@{m\_vs}}
\index{m\_vs@{m\_vs}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_vs}{m\_vs}}
{\footnotesize\ttfamily const \mbox{\hyperlink{class_image_painter_1_1_visual_settings}{Image\+Painter\+::\+Visual\+Settings}}$\ast$ Stage\+Builder\+::m\+\_\+vs}

\mbox{\Hypertarget{class_stage_builder_a1821428a800e68dcaa32c825bac33c9a}\label{class_stage_builder_a1821428a800e68dcaa32c825bac33c9a}} 
\index{StageBuilder@{StageBuilder}!m\_xsheetLevel@{m\_xsheetLevel}}
\index{m\_xsheetLevel@{m\_xsheetLevel}!StageBuilder@{StageBuilder}}
\doxysubsubsection{\texorpdfstring{m\_xsheetLevel}{m\_xsheetLevel}}
{\footnotesize\ttfamily int Stage\+Builder\+::m\+\_\+xsheet\+Level}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonzlib/stage.\+cpp\end{DoxyCompactItemize}
