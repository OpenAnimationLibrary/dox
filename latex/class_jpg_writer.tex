\hypertarget{class_jpg_writer}{}\doxysection{Jpg\+Writer Class Reference}
\label{class_jpg_writer}\index{JpgWriter@{JpgWriter}}
Inheritance diagram for Jpg\+Writer\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_jpg_writer}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_jpg_writer_ab60d5e89ce02471a21e762cfc9d8a8a9}{open}} (FILE $\ast$file, const \mbox{\hyperlink{class_t_image_info}{TImage\+Info}} \&info) override
\item 
void \mbox{\hyperlink{class_jpg_writer_a32872aa9f963fed6418e6d11fbe1599b}{flush}} () override
\item 
Tiio\+::\+Row\+Order \mbox{\hyperlink{class_jpg_writer_a6e7b67b56436d3d90076c53103b4e367}{get\+Row\+Order}} () const override
\item 
void \mbox{\hyperlink{class_jpg_writer_a215bd2078648510eeb9445eea4cf3ed3}{write\+Line}} (char $\ast$buffer) override
\item 
bool \mbox{\hyperlink{class_jpg_writer_aa45d8a03a474c50886a957169f3a24bd}{write\+Alpha\+Supported}} () const override
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_jpg_writer_ac6254a031234d0a351f6f202d5a63d0a}\label{class_jpg_writer_ac6254a031234d0a351f6f202d5a63d0a}} 
\index{JpgWriter@{JpgWriter}!JpgWriter@{JpgWriter}}
\index{JpgWriter@{JpgWriter}!JpgWriter@{JpgWriter}}
\doxysubsubsection{\texorpdfstring{JpgWriter()}{JpgWriter()}}
{\footnotesize\ttfamily Jpg\+Writer\+::\+Jpg\+Writer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00193 : m\_chan(0), m\_headerWritten(\textcolor{keyword}{false}) \{\}}

\end{DoxyCode}
\mbox{\Hypertarget{class_jpg_writer_a3f29d41e7783a33f2b783538ad94e679}\label{class_jpg_writer_a3f29d41e7783a33f2b783538ad94e679}} 
\index{JpgWriter@{JpgWriter}!````~JpgWriter@{$\sim$JpgWriter}}
\index{````~JpgWriter@{$\sim$JpgWriter}!JpgWriter@{JpgWriter}}
\doxysubsubsection{\texorpdfstring{$\sim$JpgWriter()}{~JpgWriter()}}
{\footnotesize\ttfamily Jpg\+Writer\+::$\sim$\+Jpg\+Writer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00249                \{}
\DoxyCodeLine{00250     jpeg\_finish\_compress(\&m\_cinfo);}
\DoxyCodeLine{00251     jpeg\_destroy\_compress(\&m\_cinfo);}
\DoxyCodeLine{00252     \textcolor{keyword}{delete} m\_properties;}
\DoxyCodeLine{00253   \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_jpg_writer_a32872aa9f963fed6418e6d11fbe1599b}\label{class_jpg_writer_a32872aa9f963fed6418e6d11fbe1599b}} 
\index{JpgWriter@{JpgWriter}!flush@{flush}}
\index{flush@{flush}!JpgWriter@{JpgWriter}}
\doxysubsubsection{\texorpdfstring{flush()}{flush()}}
{\footnotesize\ttfamily void Jpg\+Writer\+::flush (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_tiio_1_1_writer}{Tiio\+::\+Writer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00255 \{ fflush(m\_chan); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_jpg_writer_a6e7b67b56436d3d90076c53103b4e367}\label{class_jpg_writer_a6e7b67b56436d3d90076c53103b4e367}} 
\index{JpgWriter@{JpgWriter}!getRowOrder@{getRowOrder}}
\index{getRowOrder@{getRowOrder}!JpgWriter@{JpgWriter}}
\doxysubsubsection{\texorpdfstring{getRowOrder()}{getRowOrder()}}
{\footnotesize\ttfamily Tiio\+::\+Row\+Order Jpg\+Writer\+::get\+Row\+Order (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_tiio_1_1_writer}{Tiio\+::\+Writer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00257 \{ \textcolor{keywordflow}{return} Tiio::TOP2BOTTOM; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_jpg_writer_ab60d5e89ce02471a21e762cfc9d8a8a9}\label{class_jpg_writer_ab60d5e89ce02471a21e762cfc9d8a8a9}} 
\index{JpgWriter@{JpgWriter}!open@{open}}
\index{open@{open}!JpgWriter@{JpgWriter}}
\doxysubsubsection{\texorpdfstring{open()}{open()}}
{\footnotesize\ttfamily void Jpg\+Writer\+::open (\begin{DoxyParamCaption}\item[{FILE $\ast$}]{file,  }\item[{const \mbox{\hyperlink{class_t_image_info}{TImage\+Info}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_tiio_1_1_writer}{Tiio\+::\+Writer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00195                                                          \{}
\DoxyCodeLine{00196     m\_cinfo.err = jpeg\_std\_error(\&m\_jerr);}
\DoxyCodeLine{00197     jpeg\_create\_compress(\&m\_cinfo);}
\DoxyCodeLine{00198 }
\DoxyCodeLine{00199     m\_cinfo.image\_width      = info.m\_lx;}
\DoxyCodeLine{00200     m\_cinfo.image\_height     = info.m\_ly;}
\DoxyCodeLine{00201     m\_cinfo.input\_components = 3;}
\DoxyCodeLine{00202     m\_cinfo.in\_color\_space   = JCS\_RGB;}
\DoxyCodeLine{00203 }
\DoxyCodeLine{00204     jpeg\_set\_defaults(\&m\_cinfo);}
\DoxyCodeLine{00205 }
\DoxyCodeLine{00206     \textcolor{comment}{// save dpi always in JFIF header, instead of EXIF}}
\DoxyCodeLine{00207     m\_cinfo.write\_JFIF\_header  = 1;}
\DoxyCodeLine{00208     m\_cinfo.JFIF\_major\_version = 1;}
\DoxyCodeLine{00209     m\_cinfo.JFIF\_minor\_version = 2;}
\DoxyCodeLine{00210     m\_cinfo.X\_density          = (UINT16)info.m\_dpix;}
\DoxyCodeLine{00211     m\_cinfo.Y\_density          = (UINT16)info.m\_dpiy;}
\DoxyCodeLine{00212     m\_cinfo.density\_unit       = 1;  \textcolor{comment}{// dot per inch}}
\DoxyCodeLine{00213     m\_cinfo.write\_Adobe\_marker = 0;}
\DoxyCodeLine{00214 }
\DoxyCodeLine{00215     \textcolor{keywordflow}{if} (!m\_properties) m\_properties = \textcolor{keyword}{new} \mbox{\hyperlink{class_tiio_1_1_jpg_writer_properties}{Tiio::JpgWriterProperties}}();}
\DoxyCodeLine{00216 }
\DoxyCodeLine{00217     \textcolor{keywordtype}{int} quality =}
\DoxyCodeLine{00218         ((\mbox{\hyperlink{class_t_range_property}{TIntProperty}} *)(m\_properties-\/>\mbox{\hyperlink{class_t_property_group_afb08f3145e5f77da6f163cdc9decad2f}{getProperty}}(\textcolor{stringliteral}{"{}Quality"{}})))-\/>getValue();}
\DoxyCodeLine{00219 }
\DoxyCodeLine{00220     jpeg\_set\_quality(\&m\_cinfo, quality, TRUE);}
\DoxyCodeLine{00221     m\_cinfo.smoothing\_factor =}
\DoxyCodeLine{00222         ((\mbox{\hyperlink{class_t_range_property}{TIntProperty}} *)(m\_properties-\/>\mbox{\hyperlink{class_t_property_group_afb08f3145e5f77da6f163cdc9decad2f}{getProperty}}(\textcolor{stringliteral}{"{}Smoothing"{}})))-\/>getValue();}
\DoxyCodeLine{00223 }
\DoxyCodeLine{00224     \textcolor{comment}{// set horizontal and vertical chroma subsampling factor to encoder}}
\DoxyCodeLine{00225     \textcolor{comment}{// according to the quality value.}}
\DoxyCodeLine{00226     \textcolor{keywordflow}{if} (quality >= 70) \{  \textcolor{comment}{// none chroma-\/subsampling (4:4:4)}}
\DoxyCodeLine{00227       m\_cinfo.comp\_info[0].h\_samp\_factor = 1;}
\DoxyCodeLine{00228       m\_cinfo.comp\_info[0].v\_samp\_factor = 1;}
\DoxyCodeLine{00229     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (quality >= 30) \{  \textcolor{comment}{// medium chroma-\/subsampling (4:2:2)}}
\DoxyCodeLine{00230       m\_cinfo.comp\_info[0].h\_samp\_factor = 2;}
\DoxyCodeLine{00231       m\_cinfo.comp\_info[0].v\_samp\_factor = 1;}
\DoxyCodeLine{00232     \} \textcolor{keywordflow}{else} \{  \textcolor{comment}{// quality < 30, high chroma-\/subsampling (4:1:1)}}
\DoxyCodeLine{00233       m\_cinfo.comp\_info[0].h\_samp\_factor = 2;}
\DoxyCodeLine{00234       m\_cinfo.comp\_info[0].v\_samp\_factor = 2;}
\DoxyCodeLine{00235     \}}
\DoxyCodeLine{00236     m\_cinfo.comp\_info[1].h\_samp\_factor = 1;}
\DoxyCodeLine{00237     m\_cinfo.comp\_info[1].v\_samp\_factor = 1;}
\DoxyCodeLine{00238     m\_cinfo.comp\_info[2].h\_samp\_factor = 1;}
\DoxyCodeLine{00239     m\_cinfo.comp\_info[2].v\_samp\_factor = 1;}
\DoxyCodeLine{00240 }
\DoxyCodeLine{00241     \textcolor{keywordtype}{int} row\_stride = m\_cinfo.image\_width * m\_cinfo.input\_components;}
\DoxyCodeLine{00242     m\_buffer = (*m\_cinfo.mem-\/>alloc\_sarray)((j\_common\_ptr)\&m\_cinfo, JPOOL\_IMAGE,}
\DoxyCodeLine{00243                                             row\_stride, 1);}
\DoxyCodeLine{00244 }
\DoxyCodeLine{00245     m\_chan = file;}
\DoxyCodeLine{00246     jpeg\_stdio\_dest(\&m\_cinfo, m\_chan);}
\DoxyCodeLine{00247   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_jpg_writer_aa45d8a03a474c50886a957169f3a24bd}\label{class_jpg_writer_aa45d8a03a474c50886a957169f3a24bd}} 
\index{JpgWriter@{JpgWriter}!writeAlphaSupported@{writeAlphaSupported}}
\index{writeAlphaSupported@{writeAlphaSupported}!JpgWriter@{JpgWriter}}
\doxysubsubsection{\texorpdfstring{writeAlphaSupported()}{writeAlphaSupported()}}
{\footnotesize\ttfamily bool Jpg\+Writer\+::write\+Alpha\+Supported (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_tiio_1_1_writer}{Tiio\+::\+Writer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00278 \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_jpg_writer_a215bd2078648510eeb9445eea4cf3ed3}\label{class_jpg_writer_a215bd2078648510eeb9445eea4cf3ed3}} 
\index{JpgWriter@{JpgWriter}!writeLine@{writeLine}}
\index{writeLine@{writeLine}!JpgWriter@{JpgWriter}}
\doxysubsubsection{\texorpdfstring{writeLine()}{writeLine()}}
{\footnotesize\ttfamily void Jpg\+Writer\+::write\+Line (\begin{DoxyParamCaption}\item[{char $\ast$}]{buffer }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_tiio_1_1_writer}{Tiio\+::\+Writer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00259                                         \{}
\DoxyCodeLine{00260     \textcolor{keywordflow}{if} (!m\_headerWritten) \{}
\DoxyCodeLine{00261       m\_headerWritten = \textcolor{keyword}{true};}
\DoxyCodeLine{00262       jpeg\_start\_compress(\&m\_cinfo, TRUE);}
\DoxyCodeLine{00263     \}}
\DoxyCodeLine{00264     TPixel32 *src      = (TPixel32 *)buffer;}
\DoxyCodeLine{00265     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *dst = m\_buffer[0];}
\DoxyCodeLine{00266     \textcolor{keywordtype}{int} lx             = m\_cinfo.image\_width;}
\DoxyCodeLine{00267     \textcolor{keywordflow}{while} (-\/-\/lx >= 0) \{}
\DoxyCodeLine{00268       dst[0] = src-\/>r;}
\DoxyCodeLine{00269       dst[1] = src-\/>g;}
\DoxyCodeLine{00270       dst[2] = src-\/>b;}
\DoxyCodeLine{00271       dst += 3;}
\DoxyCodeLine{00272       ++src;}
\DoxyCodeLine{00273     \}}
\DoxyCodeLine{00274     jpeg\_write\_scanlines(\&m\_cinfo, m\_buffer, 1);}
\DoxyCodeLine{00275   \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/common/tiio/tiio\+\_\+jpg.\+cpp\end{DoxyCompactItemize}
