\hypertarget{class_t_vector_image_1_1_imp}{}\doxysection{TVector\+Image\+::Imp Class Reference}
\label{class_t_vector_image_1_1_imp}\index{TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_afd263ed3719be735d8db47c562b0a2bc}\label{class_t_vector_image_1_1_imp_afd263ed3719be735d8db47c562b0a2bc}} 
{\bfseries Imp} (\mbox{\hyperlink{class_t_vector_image}{TVector\+Image}} $\ast$vi)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_a23267a686d0b4f742da663b2ffb98758}{init\+Regions\+Data}} ()
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_a9e85881b1d8eb8baaefcb80c15ffe66b}{delete\+Regions\+Data}} ()
\item 
\mbox{\hyperlink{class_t_region}{TRegion}} $\ast$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_a4d7f3cd1c1fb93f344d95ee8c0f6839a}{get\+Region}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p)
\item 
int \mbox{\hyperlink{class_t_vector_image_1_1_imp_afad890d2eaa34b2a0b4b415a459c646e}{fill}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p, int style\+Id)
\item 
bool \mbox{\hyperlink{class_t_vector_image_1_1_imp_a3cd0d107cd90a0467e895addabb1bc01}{select\+Fill}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&select\+Area, \mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$s, int style\+Id, bool only\+Unfilled, bool fill\+Areas, bool fill\+Lines)
\item 
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a06c2679377f89c825da6f2e6b80a2a1d}\label{class_t_vector_image_1_1_imp_a06c2679377f89c825da6f2e6b80a2a1d}} 
void {\bfseries add\+Stroke\+Region\+Ref} (UINT stroke\+Index, \mbox{\hyperlink{class_t_region}{TRegion}} $\ast$region)
\item 
int \mbox{\hyperlink{class_t_vector_image_1_1_imp_a525d4236fd2a42b231f9261b9675e341}{compute\+Regions}} ()
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_a4829fdbb3351e0eb297a7c31da90ba19}{reindex\+Edges}} (UINT stroke\+Index)
\item 
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a452fcf2529157f3f8270f7cbee5228ae}\label{class_t_vector_image_1_1_imp_a452fcf2529157f3f8270f7cbee5228ae}} 
void {\bfseries reindex\+Edges} (const std\+::vector$<$ int $>$ \&indexes, bool are\+Added)
\item 
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a0ff19b1dfca8dfb1b2b70cf7af963c5a}\label{class_t_vector_image_1_1_imp_a0ff19b1dfca8dfb1b2b70cf7af963c5a}} 
void {\bfseries check\+Region\+Db\+Consistency} ()
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_a84dee46054e528e47089dbfa20c38df2}{clone\+Regions}} (\mbox{\hyperlink{class_t_vector_image_1_1_imp}{TVector\+Image\+::\+Imp}} \&out, bool do\+Compute\+Regions=true)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_a55cca929bf384a5314f19a0f9926b508}{erase\+Intersection}} (int index)
\item 
UINT \mbox{\hyperlink{class_t_vector_image_1_1_imp_ad82ebd62d47c0b644d0c76797882e4d8}{get\+Fill\+Data}} (std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{struct_t_vector_image_1_1_intersection_branch}{TVector\+Image\+::\+Intersection\+Branch}}\mbox{[}$\,$\mbox{]}$>$ \&v)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_ac702cfa245303bb9b92b1ac84ab99af3}{set\+Fill\+Data}} (std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{struct_t_vector_image_1_1_intersection_branch}{TVector\+Image\+::\+Intersection\+Branch}}\mbox{[}$\,$\mbox{]}$>$ const \&v, UINT branch\+Count, bool do\+Compute\+Regions=true)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_ae646c51451b57d05b1b83008da092ec8}{notify\+Changed\+Strokes}} (const std\+::vector$<$ int $>$ \&stroke\+Index\+Array, const std\+::vector$<$ \mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$ $>$ \&old\+Vector\+Stroke\+Array, bool are\+Flipped)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_a45218676a6e1d80bacb0c44a5f8d5927}{insert\+Stroke\+At}} (\mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$stroke, int stroke\+Index, bool recompute\+Regions=true)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_a18ca500d2a57d78b520e9182993225b3}{move\+Stroke}} (int from\+Index, int to\+Index)
\item 
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a2b0edca4d910ad657f6083c412196387}\label{class_t_vector_image_1_1_imp_a2b0edca4d910ad657f6083c412196387}} 
void {\bfseries auto\+Fill} (int style\+Id, bool odd\+Level)
\item 
\mbox{\hyperlink{class_t_region}{TRegion}} $\ast$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_a5271a36f574f950f694378e890e9021f}{get\+Region}} (\mbox{\hyperlink{class_t_region_id}{TRegion\+Id}} reg\+Id, int index) const
\item 
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a6b7a24bbd5e652e5c9e5a51923275ee5}\label{class_t_vector_image_1_1_imp_a6b7a24bbd5e652e5c9e5a51923275ee5}} 
\mbox{\hyperlink{class_t_region}{TRegion}} $\ast$ {\bfseries get\+Region\+From\+Loop\+Stroke} (int stroke\+Index) const
\item 
\mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_a27137f1c5fce6b647a69872012976cee}{join\+Stroke}} (int index1, int index2, int cp\+Index1, int cp\+Index2)
\item 
\mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_a810ed176fc93d184f35732e9f3dd79ad}{join\+Stroke\+Smoothly}} (int index1, int index2, int cp\+Index1, int cp\+Index2)
\item 
\mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_a7d765eb4ec5100223e6b7095988334be}{extend\+Stroke}} (int index, const \mbox{\hyperlink{class_t_thick_point}{TThick\+Point}} \&p, int cp\+Index)
\item 
\mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_a3bd1155a5158a88d03221930a2e8b6bb}{extend\+Stroke\+Smoothly}} (int index, const \mbox{\hyperlink{class_t_thick_point}{TThick\+Point}} \&p, int cp\+Index)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_a2f71ab28f8477f967bcd609843f78fef}{remove\+Strokes}} (const std\+::vector$<$ int $>$ \&to\+Be\+Removed, bool delete\+Them, bool recompute\+Regions)
\item 
\mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_aa9231d6b7c3aa554334c2f84cbd4f5c3}{remove\+Stroke}} (int index, bool do\+Compute\+Regions)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_aa03d226c5158976ad4d598d6d5fa7e0b}{split\+Stroke}} (int stroke\+Index, const std\+::vector$<$ Double\+Pair $>$ \&sorted\+WRanges)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_ac5eaba9d36bcddbd71faee9359ef09cb}{move\+Strokes}} (int from\+Index, int count, int move\+Before, bool regroup)
\item 
\mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_aeb442c649c268dffd20450182fce3ea8}{remove\+Endpoints}} (int stroke\+Index)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_a5e0b6903ee7f35d32f84358bf1e7f66d}{restore\+Endpoints}} (int index, \mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$old\+Stroke)
\item 
int \mbox{\hyperlink{class_t_vector_image_1_1_imp_a77af772c689a159ce2a556fef722de94}{are\+Different\+Group}} (UINT index1, bool is\+Region1, UINT index2, bool is\+Region2) const
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_af7d0ae22e880661d817c4c1090851e3d}{rearrange\+Multi\+Group}} ()
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_abdab177e97e33f78e34525b5ca71bfdc}{reindex\+Groups}} (\mbox{\hyperlink{class_t_vector_image_1_1_imp}{Imp}} \&img)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_aa55e6cb8e77096ca882cb18257c3621c}{add\+Region}} (\mbox{\hyperlink{class_t_region}{TRegion}} $\ast$region)
\item 
void \mbox{\hyperlink{class_t_vector_image_1_1_imp_a304af0b088d77d802f9f6a5cd7460517}{regroup\+Ghosts}} (std\+::vector$<$ int $>$ \&changed\+Strokes)
\item 
bool \mbox{\hyperlink{class_t_vector_image_1_1_imp_a2809838a5671ad44b3a39d7208319e7f}{in\+Current\+Group}} (int stroke\+Index) const
\item 
bool \mbox{\hyperlink{class_t_vector_image_1_1_imp_a3751120b0a103b27a7c23c35c23574c5}{can\+Move\+Strokes}} (int stroke\+Index, int count, int move\+Before) const
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{class_t_vector_image_1_1_imp_ae3f93c3346e715bfca2cafc359c0888b}{m\+\_\+max\+Group\+Id}}
\item 
int \mbox{\hyperlink{class_t_vector_image_1_1_imp_a0b4f803443f111f625920a9ccf47162e}{m\+\_\+max\+Ghost\+Group\+Id}}
\item 
bool \mbox{\hyperlink{class_t_vector_image_1_1_imp_a742868a839f75b422655de612f6c597e}{m\+\_\+are\+Valid\+Regions}}
\item 
bool \mbox{\hyperlink{class_t_vector_image_1_1_imp_ab1fdfd9937798da377f1b29df6619664}{m\+\_\+computed\+Almost\+Once}}
\item 
bool \mbox{\hyperlink{class_t_vector_image_1_1_imp_ae0fa34e04a16955f809e473d2ef01a65}{m\+\_\+just\+Loaded}}
\item 
bool \mbox{\hyperlink{class_t_vector_image_1_1_imp_acd573df1bc0bc9033722228a1a883c1f}{m\+\_\+minimize\+Edges}}
\item 
bool \mbox{\hyperlink{class_t_vector_image_1_1_imp_ae690c344676e934fdb1ae446efc91ca6}{m\+\_\+not\+Intersecting\+Strokes}}
\item 
bool \mbox{\hyperlink{class_t_vector_image_1_1_imp_a4d5ec8a8cfabacef13f200ae37701bd6}{m\+\_\+compute\+Regions}}
\item 
\mbox{\hyperlink{class_t_group_id}{TGroup\+Id}} \mbox{\hyperlink{class_t_vector_image_1_1_imp_acb0ace23b059125042f4da1b303f6289}{m\+\_\+inside\+Group}}
\item 
std\+::vector$<$ \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$ $>$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_a59e2791fe265b9c1be689a0db4f414b2}{m\+\_\+strokes}}
\item 
double \mbox{\hyperlink{class_t_vector_image_1_1_imp_a591f49ca31b9b38435c77dc02258437b}{m\+\_\+autoclose\+Tolerance}}
\item 
\mbox{\hyperlink{class_intersection_data}{Intersection\+Data}} $\ast$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_a292c02b9a9d1a3953660fc703a55704e}{m\+\_\+intersection\+Data}}
\item 
std\+::vector$<$ \mbox{\hyperlink{class_t_region}{TRegion}} $\ast$ $>$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_a0533ef826126028ce3ccc89b8c1b9eca}{m\+\_\+regions}}
\item 
\mbox{\hyperlink{class_t_thread_1_1_mutex}{TThread\+::\+Mutex}} $\ast$ \mbox{\hyperlink{class_t_vector_image_1_1_imp_a2b1b2ec6f2e33abb0cabf186cd9db2b0}{m\+\_\+mutex}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a5fd8107fe1dcb26273d5026ac9d8aeb3}\label{class_t_vector_image_1_1_imp_a5fd8107fe1dcb26273d5026ac9d8aeb3}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!````~Imp@{$\sim$Imp}}
\index{````~Imp@{$\sim$Imp}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{$\sim$Imp()}{~Imp()}}
{\footnotesize\ttfamily TVector\+Image\+::\+Imp\+::$\sim$\+Imp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00110                       \{}
\DoxyCodeLine{00111   \textcolor{comment}{// delete m\_regionFinder;}}
\DoxyCodeLine{00112   deleteRegionsData();}
\DoxyCodeLine{00113   \textcolor{keyword}{delete} m\_mutex;}
\DoxyCodeLine{00114 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_aa55e6cb8e77096ca882cb18257c3621c}\label{class_t_vector_image_1_1_imp_aa55e6cb8e77096ca882cb18257c3621c}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!addRegion@{addRegion}}
\index{addRegion@{addRegion}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{addRegion()}{addRegion()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::add\+Region (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_region}{TRegion}} $\ast$}]{region }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{03027                                                \{}
\DoxyCodeLine{03028   \textcolor{keywordflow}{for} (std::vector<TRegion *>::iterator it = m\_regions.begin();}
\DoxyCodeLine{03029        it != m\_regions.end(); ++it) \{}
\DoxyCodeLine{03030     \textcolor{keywordflow}{if} (getGroupId(region, m\_strokes) != getGroupId(*it, m\_strokes)) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03031 }
\DoxyCodeLine{03032     \textcolor{keywordflow}{if} (region-\/>contains(**it)) \{}
\DoxyCodeLine{03033       \textcolor{comment}{// region-\/>addSubregion(*it);}}
\DoxyCodeLine{03034       region-\/>addSubregion(*it);}
\DoxyCodeLine{03035       it = m\_regions.erase(it);}
\DoxyCodeLine{03036       \textcolor{keywordflow}{while} (it != m\_regions.end()) \{}
\DoxyCodeLine{03037         \textcolor{keywordflow}{if} (region-\/>contains(**it)) \{}
\DoxyCodeLine{03038           region-\/>addSubregion(*it);}
\DoxyCodeLine{03039           \textcolor{comment}{// region-\/>addSubregion(*it);}}
\DoxyCodeLine{03040           it = m\_regions.erase(it);}
\DoxyCodeLine{03041         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{03042           it++;}
\DoxyCodeLine{03043       \}}
\DoxyCodeLine{03044 }
\DoxyCodeLine{03045       m\_regions.push\_back(region);}
\DoxyCodeLine{03046       \textcolor{keywordflow}{return};}
\DoxyCodeLine{03047     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((*it)-\/>contains(*region)) \{}
\DoxyCodeLine{03048       (*it)-\/>addSubregion(region);}
\DoxyCodeLine{03049       \textcolor{comment}{//(*it)-\/>addSubregion(region);}}
\DoxyCodeLine{03050       \textcolor{keywordflow}{return};}
\DoxyCodeLine{03051     \}}
\DoxyCodeLine{03052   \}}
\DoxyCodeLine{03053   m\_regions.push\_back(region);}
\DoxyCodeLine{03054 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a77af772c689a159ce2a556fef722de94}\label{class_t_vector_image_1_1_imp_a77af772c689a159ce2a556fef722de94}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!areDifferentGroup@{areDifferentGroup}}
\index{areDifferentGroup@{areDifferentGroup}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{areDifferentGroup()}{areDifferentGroup()}}
{\footnotesize\ttfamily int TVector\+Image\+::\+Imp\+::are\+Different\+Group (\begin{DoxyParamCaption}\item[{UINT}]{index1,  }\item[{bool}]{is\+Region1,  }\item[{UINT}]{index2,  }\item[{bool}]{is\+Region2 }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{02650                                                                             \{}
\DoxyCodeLine{02651   \mbox{\hyperlink{class_t_group_id}{TGroupId}} group1, group2;}
\DoxyCodeLine{02652 }
\DoxyCodeLine{02653   \textcolor{keywordflow}{if} (isRegion1) \{}
\DoxyCodeLine{02654     \mbox{\hyperlink{class_t_region}{TRegion}} *r = m\_regions[index1];}
\DoxyCodeLine{02655     \textcolor{keywordflow}{for} (UINT i = 0; i < r-\/>getEdgeCount(); i++)}
\DoxyCodeLine{02656       \textcolor{keywordflow}{if} (r-\/>getEdge(i)-\/>m\_index >= 0) \{}
\DoxyCodeLine{02657         group1 = m\_strokes[r-\/>getEdge(i)-\/>m\_index]-\/>m\_groupId;}
\DoxyCodeLine{02658         \textcolor{keywordflow}{break};}
\DoxyCodeLine{02659       \}}
\DoxyCodeLine{02660   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{02661     group1 = m\_strokes[index1]-\/>m\_groupId;}
\DoxyCodeLine{02662   \textcolor{keywordflow}{if} (isRegion2) \{}
\DoxyCodeLine{02663     \mbox{\hyperlink{class_t_region}{TRegion}} *r = m\_regions[index2];}
\DoxyCodeLine{02664     \textcolor{keywordflow}{for} (UINT i = 0; i < r-\/>getEdgeCount(); i++)}
\DoxyCodeLine{02665       \textcolor{keywordflow}{if} (r-\/>getEdge(i)-\/>m\_index >= 0) \{}
\DoxyCodeLine{02666         group2 = m\_strokes[r-\/>getEdge(i)-\/>m\_index]-\/>m\_groupId;}
\DoxyCodeLine{02667         \textcolor{keywordflow}{break};}
\DoxyCodeLine{02668       \}}
\DoxyCodeLine{02669   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{02670     group2 = m\_strokes[index2]-\/>m\_groupId;}
\DoxyCodeLine{02671 }
\DoxyCodeLine{02672   \textcolor{keywordflow}{if} (!group1 \&\& !group2) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{02673 }
\DoxyCodeLine{02674   \textcolor{keywordflow}{if} (group1 == group2)}
\DoxyCodeLine{02675     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{02676   \textcolor{keywordflow}{else}}
\DoxyCodeLine{02677     \textcolor{keywordflow}{return} group1.getCommonParentDepth(group2);}
\DoxyCodeLine{02678 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a3751120b0a103b27a7c23c35c23574c5}\label{class_t_vector_image_1_1_imp_a3751120b0a103b27a7c23c35c23574c5}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!canMoveStrokes@{canMoveStrokes}}
\index{canMoveStrokes@{canMoveStrokes}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{canMoveStrokes()}{canMoveStrokes()}}
{\footnotesize\ttfamily bool TVector\+Image\+::\+Imp\+::can\+Move\+Strokes (\begin{DoxyParamCaption}\item[{int}]{stroke\+Index,  }\item[{int}]{count,  }\item[{int}]{move\+Before }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{02817                                                              \{}
\DoxyCodeLine{02818   \textcolor{keywordflow}{if} (m\_maxGroupId <= 1)  \textcolor{comment}{// non ci sono gruppi!}}
\DoxyCodeLine{02819     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{02820 }
\DoxyCodeLine{02821   \textcolor{keywordtype}{int} i, j = 0;}
\DoxyCodeLine{02822 }
\DoxyCodeLine{02823   std::vector<TGroupId> groupsAfterMoving(m\_strokes.size());}
\DoxyCodeLine{02824   \textcolor{keywordflow}{if} (strokeIndex < moveBefore) \{}
\DoxyCodeLine{02825     \textcolor{keywordflow}{for} (i = 0; i < strokeIndex; i++)}
\DoxyCodeLine{02826       groupsAfterMoving[j++] = m\_strokes[i]-\/>m\_groupId;}
\DoxyCodeLine{02827 }
\DoxyCodeLine{02828     \textcolor{keywordflow}{for} (i = strokeIndex + count; i < moveBefore; i++)}
\DoxyCodeLine{02829       groupsAfterMoving[j++] = m\_strokes[i]-\/>m\_groupId;}
\DoxyCodeLine{02830 }
\DoxyCodeLine{02831     \textcolor{keywordflow}{for} (i = strokeIndex; i < strokeIndex + count; i++)}
\DoxyCodeLine{02832       groupsAfterMoving[j++] = m\_strokes[i]-\/>m\_groupId;}
\DoxyCodeLine{02833 }
\DoxyCodeLine{02834     \textcolor{keywordflow}{for} (i = moveBefore; i < (int)m\_strokes.size(); i++)}
\DoxyCodeLine{02835       groupsAfterMoving[j++] = m\_strokes[i]-\/>m\_groupId;}
\DoxyCodeLine{02836   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02837     \textcolor{keywordflow}{for} (i = 0; i < moveBefore; i++)}
\DoxyCodeLine{02838       groupsAfterMoving[j++] = m\_strokes[i]-\/>m\_groupId;}
\DoxyCodeLine{02839 }
\DoxyCodeLine{02840     \textcolor{keywordflow}{for} (i = strokeIndex; i < strokeIndex + count; i++)}
\DoxyCodeLine{02841       groupsAfterMoving[j++] = m\_strokes[i]-\/>m\_groupId;}
\DoxyCodeLine{02842 }
\DoxyCodeLine{02843     \textcolor{keywordflow}{for} (i = moveBefore; i < strokeIndex; i++)}
\DoxyCodeLine{02844       groupsAfterMoving[j++] = m\_strokes[i]-\/>m\_groupId;}
\DoxyCodeLine{02845 }
\DoxyCodeLine{02846     \textcolor{keywordflow}{for} (i = strokeIndex + count; i < (int)m\_strokes.size(); i++)}
\DoxyCodeLine{02847       groupsAfterMoving[j++] = m\_strokes[i]-\/>m\_groupId;}
\DoxyCodeLine{02848   \}}
\DoxyCodeLine{02849 }
\DoxyCodeLine{02850   assert(j == (\textcolor{keywordtype}{int})m\_strokes.size());}
\DoxyCodeLine{02851 }
\DoxyCodeLine{02852   i = 0;}
\DoxyCodeLine{02853   \mbox{\hyperlink{class_t_group_id}{TGroupId}} currGroupId;}
\DoxyCodeLine{02854   std::set<TGroupId> groupSet;}
\DoxyCodeLine{02855 }
\DoxyCodeLine{02856   \textcolor{keywordflow}{while} (i < (\textcolor{keywordtype}{int})groupsAfterMoving.size()) \{}
\DoxyCodeLine{02857     currGroupId = groupsAfterMoving[i];}
\DoxyCodeLine{02858     \textcolor{keywordflow}{if} (groupSet.find(currGroupId) !=}
\DoxyCodeLine{02859         groupSet.end())  \textcolor{comment}{// esisteva gia un gruppo con questo id!}}
\DoxyCodeLine{02860     \{}
\DoxyCodeLine{02861       \textcolor{keywordflow}{if} (!currGroupId.isGrouped(\textcolor{keyword}{true}))  \textcolor{comment}{// i gruppi impliciti non contano}}
\DoxyCodeLine{02862         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{02863     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{02864       groupSet.insert(currGroupId);}
\DoxyCodeLine{02865 }
\DoxyCodeLine{02866     \textcolor{keywordflow}{while} (i < (\textcolor{keywordtype}{int})groupsAfterMoving.size() \&\&}
\DoxyCodeLine{02867            groupsAfterMoving[i] == currGroupId)}
\DoxyCodeLine{02868       i++;}
\DoxyCodeLine{02869   \}}
\DoxyCodeLine{02870 }
\DoxyCodeLine{02871   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{02872 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a84dee46054e528e47089dbfa20c38df2}\label{class_t_vector_image_1_1_imp_a84dee46054e528e47089dbfa20c38df2}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!cloneRegions@{cloneRegions}}
\index{cloneRegions@{cloneRegions}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{cloneRegions()}{cloneRegions()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::clone\+Regions (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_vector_image_1_1_imp}{TVector\+Image\+::\+Imp}} \&}]{out,  }\item[{bool}]{do\+Compute\+Regions = {\ttfamily true} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01143                                                             \{}
\DoxyCodeLine{01144   std::unique\_ptr<IntersectionBranch[]> v;}
\DoxyCodeLine{01145   UINT size = getFillData(v);}
\DoxyCodeLine{01146   out.setFillData(v, size, doComputeRegions);}
\DoxyCodeLine{01147 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a525d4236fd2a42b231f9261b9675e341}\label{class_t_vector_image_1_1_imp_a525d4236fd2a42b231f9261b9675e341}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!computeRegions@{computeRegions}}
\index{computeRegions@{computeRegions}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{computeRegions()}{computeRegions()}}
{\footnotesize\ttfamily int TVector\+Image\+::\+Imp\+::compute\+Regions (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02807                                     \{}
\DoxyCodeLine{02808 \textcolor{preprocessor}{\#ifdef NEW\_REGION\_FILL}}
\DoxyCodeLine{02809   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{02810 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02811 }
\DoxyCodeLine{02812 \textcolor{preprocessor}{\#if defined(\_DEBUG) \&\& !defined(MACOSX)}}
\DoxyCodeLine{02813   \mbox{\hyperlink{class_t_stop_watch}{TStopWatch}} stopWatch;}
\DoxyCodeLine{02814   stopWatch.\mbox{\hyperlink{class_t_stop_watch_a81eefb8cd2dc776cc31799973be063a8}{start}}(\textcolor{keyword}{true});}
\DoxyCodeLine{02815 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02816 }
\DoxyCodeLine{02817   \textcolor{comment}{// testHistory();}}
\DoxyCodeLine{02818 }
\DoxyCodeLine{02819   \textcolor{keywordflow}{if} (!m\_computeRegions) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{02820 }
\DoxyCodeLine{02821   QMutexLocker sl(m\_mutex);}
\DoxyCodeLine{02822 }
\DoxyCodeLine{02823   \textcolor{comment}{/*if (m\_intersectionData-\/>m\_computedAlmostOnce)}}
\DoxyCodeLine{02824 \textcolor{comment}{\{}}
\DoxyCodeLine{02825 \textcolor{comment}{UINT i,n=m\_strokes.size();}}
\DoxyCodeLine{02826 \textcolor{comment}{  vector<int> vv(n);}}
\DoxyCodeLine{02827 \textcolor{comment}{for( i=0; i<n;++i) vv[i] = i;}}
\DoxyCodeLine{02828 \textcolor{comment}{m\_intersectionData-\/>m\_computedAlmostOnce = true;}}
\DoxyCodeLine{02829 \textcolor{comment}{notifyChangedStrokes(vv,vector<TStroke*>(), false);}}
\DoxyCodeLine{02830 \textcolor{comment}{}}
\DoxyCodeLine{02831 \textcolor{comment}{return true;}}
\DoxyCodeLine{02832 \textcolor{comment}{\}*/}}
\DoxyCodeLine{02833 }
\DoxyCodeLine{02834   \textcolor{comment}{// g\_autocloseTolerance = m\_autocloseTolerance;}}
\DoxyCodeLine{02835 }
\DoxyCodeLine{02836   \textcolor{comment}{// Cancella le regioni gia' esistenti per ricalcolarle}}
\DoxyCodeLine{02837   clearPointerContainer(m\_regions);}
\DoxyCodeLine{02838   m\_regions.clear();}
\DoxyCodeLine{02839 }
\DoxyCodeLine{02840   \textcolor{comment}{// Controlla che ci siano degli stroke}}
\DoxyCodeLine{02841   \textcolor{keywordflow}{if} (m\_strokes.empty()) \{}
\DoxyCodeLine{02842 \textcolor{preprocessor}{\#if defined(\_DEBUG) \&\& !defined(MACOSX)}}
\DoxyCodeLine{02843     stopWatch.stop();}
\DoxyCodeLine{02844 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02845     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{02846   \}}
\DoxyCodeLine{02847 }
\DoxyCodeLine{02848   \textcolor{comment}{// Inizializza la lista di intersezioni intList}}
\DoxyCodeLine{02849   m\_computedAlmostOnce          = \textcolor{keyword}{true};}
\DoxyCodeLine{02850   \mbox{\hyperlink{class_v_i_list}{VIList<Intersection>}} \&intList = m\_intersectionData-\/>m\_intList;}
\DoxyCodeLine{02851   cleanIntersectionMarks(intList);}
\DoxyCodeLine{02852 }
\DoxyCodeLine{02853   \textcolor{comment}{// calcolo struttura delle intersezioni}}
\DoxyCodeLine{02854   \textcolor{keywordtype}{int} added = 0, notAdded = 0;}
\DoxyCodeLine{02855   \textcolor{keywordtype}{int} strokeSize;}
\DoxyCodeLine{02856   strokeSize = computeIntersections();}
\DoxyCodeLine{02857 }
\DoxyCodeLine{02858   \mbox{\hyperlink{class_intersection}{Intersection}} *p1;}
\DoxyCodeLine{02859   \mbox{\hyperlink{class_intersected_stroke}{IntersectedStroke}} *p2;}
\DoxyCodeLine{02860 }
\DoxyCodeLine{02861   \textcolor{keywordflow}{for} (p1 = intList.first(); p1; p1 = p1-\/>next())}
\DoxyCodeLine{02862     \textcolor{keywordflow}{for} (p2 = p1-\/>m\_strokeList.first(); p2; p2 = p2-\/>next()) p2-\/>m\_edge.m\_r = 0;}
\DoxyCodeLine{02863 }
\DoxyCodeLine{02864   \textcolor{keywordflow}{for} (p1 = intList.first(); p1; p1 = p1-\/>next()) \{}
\DoxyCodeLine{02865     \textcolor{comment}{// Controlla che il punto in questione non sia isolato}}
\DoxyCodeLine{02866     \textcolor{keywordflow}{if} (p1-\/>m\_numInter == 0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02867 }
\DoxyCodeLine{02868     \textcolor{keywordflow}{for} (p2 = p1-\/>m\_strokeList.first(); p2; p2 = p2-\/>next()) \{}
\DoxyCodeLine{02869       \mbox{\hyperlink{class_t_region}{TRegion}} *region;}
\DoxyCodeLine{02870 }
\DoxyCodeLine{02871       \textcolor{comment}{// se lo stroke non unisce due punti di intersezione}}
\DoxyCodeLine{02872       \textcolor{comment}{// non lo considero e vado avanti con un altro stroke}}
\DoxyCodeLine{02873       \textcolor{keywordflow}{if} (!p2-\/>m\_nextIntersection) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02874 }
\DoxyCodeLine{02875       \textcolor{comment}{// Se lo stroke puntato da t2 non e' stato ancora visitato, trova una}}
\DoxyCodeLine{02876       \textcolor{comment}{// regione}}
\DoxyCodeLine{02877       \textcolor{keywordflow}{if} (!p2-\/>m\_visited \&\&}
\DoxyCodeLine{02878           (region = \mbox{\hyperlink{class_t_vector_image_aa720fd18b1fd94d3121fdd533392d9e8}{::findRegion}}(intList, p1, p2, m\_minimizeEdges))) \{}
\DoxyCodeLine{02879         \textcolor{comment}{// Se la regione e' valida la aggiunge al vettore delle regioni}}
\DoxyCodeLine{02880         \textcolor{keywordflow}{if} (isValidArea(*region)) \{}
\DoxyCodeLine{02881           added++;}
\DoxyCodeLine{02882 }
\DoxyCodeLine{02883           addRegion(region);}
\DoxyCodeLine{02884 }
\DoxyCodeLine{02885           \textcolor{comment}{// Lega ogni ramo della regione alla regione di appartenenza}}
\DoxyCodeLine{02886           \textcolor{keywordflow}{for} (UINT i = 0; i < region-\/>getEdgeCount(); i++) \{}
\DoxyCodeLine{02887             \mbox{\hyperlink{class_t_edge}{TEdge}} *e = region-\/>getEdge(i);}
\DoxyCodeLine{02888             e-\/>m\_r   = region;}
\DoxyCodeLine{02889             \textcolor{keywordflow}{if} (e-\/>m\_index >= 0) m\_strokes[e-\/>m\_index]-\/>addEdge(e);}
\DoxyCodeLine{02890           \}}
\DoxyCodeLine{02891         \} \textcolor{keywordflow}{else}  \textcolor{comment}{// Se la regione non e' valida viene scartata}}
\DoxyCodeLine{02892         \{}
\DoxyCodeLine{02893           notAdded++;}
\DoxyCodeLine{02894           \textcolor{keyword}{delete} region;}
\DoxyCodeLine{02895         \}}
\DoxyCodeLine{02896       \}}
\DoxyCodeLine{02897     \}}
\DoxyCodeLine{02898   \}}
\DoxyCodeLine{02899 }
\DoxyCodeLine{02900   \textcolor{keywordflow}{if} (!m\_notIntersectingStrokes) \{}
\DoxyCodeLine{02901     UINT i;}
\DoxyCodeLine{02902     \textcolor{keywordflow}{for} (i = 0; i < m\_intersectionData-\/>m\_intersectedStrokeArray.size(); i++) \{}
\DoxyCodeLine{02903       \textcolor{keywordflow}{if} (!m\_strokes[m\_intersectionData-\/>m\_intersectedStrokeArray[i].m\_index]}
\DoxyCodeLine{02904                -\/>m\_edgeList.empty())}
\DoxyCodeLine{02905         transferColors(}
\DoxyCodeLine{02906             m\_intersectionData-\/>m\_intersectedStrokeArray[i].m\_edgeList,}
\DoxyCodeLine{02907             m\_strokes[m\_intersectionData-\/>m\_intersectedStrokeArray[i].m\_index]}
\DoxyCodeLine{02908                 -\/>m\_edgeList,}
\DoxyCodeLine{02909             \textcolor{keyword}{false}, \textcolor{keyword}{false}, \textcolor{keyword}{true});}
\DoxyCodeLine{02910       clearPointerContainer(}
\DoxyCodeLine{02911           m\_intersectionData-\/>m\_intersectedStrokeArray[i].m\_edgeList);}
\DoxyCodeLine{02912       m\_intersectionData-\/>m\_intersectedStrokeArray[i].m\_edgeList.clear();}
\DoxyCodeLine{02913     \}}
\DoxyCodeLine{02914     m\_intersectionData-\/>m\_intersectedStrokeArray.clear();}
\DoxyCodeLine{02915   \}}
\DoxyCodeLine{02916 }
\DoxyCodeLine{02917   assert(m\_intersectionData-\/>m\_intersectedStrokeArray.empty());}
\DoxyCodeLine{02918 }
\DoxyCodeLine{02919   \textcolor{comment}{// tolgo i segmenti aggiunti con l'autoclose}}
\DoxyCodeLine{02920   vector<VIStroke *>::iterator it = m\_strokes.begin();}
\DoxyCodeLine{02921   advance(it, strokeSize);}
\DoxyCodeLine{02922   m\_strokes.erase(it, m\_strokes.end());}
\DoxyCodeLine{02923 }
\DoxyCodeLine{02924   m\_areValidRegions = \textcolor{keyword}{true};}
\DoxyCodeLine{02925 }
\DoxyCodeLine{02926 \textcolor{preprocessor}{\#if defined(\_DEBUG)}}
\DoxyCodeLine{02927   checkRegions(m\_regions);}
\DoxyCodeLine{02928 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02929 }
\DoxyCodeLine{02930   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{02931 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a9e85881b1d8eb8baaefcb80c15ffe66b}\label{class_t_vector_image_1_1_imp_a9e85881b1d8eb8baaefcb80c15ffe66b}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!deleteRegionsData@{deleteRegionsData}}
\index{deleteRegionsData@{deleteRegionsData}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{deleteRegionsData()}{deleteRegionsData()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::delete\+Regions\+Data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02393                                         \{}
\DoxyCodeLine{02394   clearPointerContainer(m\_strokes);}
\DoxyCodeLine{02395   clearPointerContainer(m\_regions);}
\DoxyCodeLine{02396 }
\DoxyCodeLine{02397   \mbox{\hyperlink{class_intersection}{Intersection}} *p1;}
\DoxyCodeLine{02398   \textcolor{keywordflow}{for} (p1 = m\_intersectionData-\/>m\_intList.first(); p1; p1 = p1-\/>next())}
\DoxyCodeLine{02399     p1-\/>m\_strokeList.clear();}
\DoxyCodeLine{02400   m\_intersectionData-\/>m\_intList.clear();}
\DoxyCodeLine{02401   \textcolor{keyword}{delete} m\_intersectionData;}
\DoxyCodeLine{02402   m\_intersectionData = 0;}
\DoxyCodeLine{02403 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a55cca929bf384a5314f19a0f9926b508}\label{class_t_vector_image_1_1_imp_a55cca929bf384a5314f19a0f9926b508}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!eraseIntersection@{eraseIntersection}}
\index{eraseIntersection@{eraseIntersection}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{eraseIntersection()}{eraseIntersection()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::erase\+Intersection (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00899                                                  \{}
\DoxyCodeLine{00900   \mbox{\hyperlink{classvector}{vector<int>}} autocloseStrokes;}
\DoxyCodeLine{00901   doEraseIntersection(index, \&autocloseStrokes);}
\DoxyCodeLine{00902 }
\DoxyCodeLine{00903   \textcolor{keywordflow}{for} (UINT i = 0; i < autocloseStrokes.size(); i++) \{}
\DoxyCodeLine{00904     doEraseIntersection(autocloseStrokes[i]);}
\DoxyCodeLine{00905     assert(autocloseStrokes[i] < 0);}
\DoxyCodeLine{00906     m\_intersectionData-\/>m\_autocloseMap.erase(autocloseStrokes[i]);}
\DoxyCodeLine{00907   \}}
\DoxyCodeLine{00908 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a7d765eb4ec5100223e6b7095988334be}\label{class_t_vector_image_1_1_imp_a7d765eb4ec5100223e6b7095988334be}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!extendStroke@{extendStroke}}
\index{extendStroke@{extendStroke}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{extendStroke()}{extendStroke()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$ TVector\+Image\+::\+Imp\+::extend\+Stroke (\begin{DoxyParamCaption}\item[{int}]{index,  }\item[{const \mbox{\hyperlink{class_t_thick_point}{TThick\+Point}} \&}]{p,  }\item[{int}]{cp\+Index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02100                                                        \{}
\DoxyCodeLine{02101   \mbox{\hyperlink{class_t_group_id}{TGroupId}} groupId = m\_strokes[index]-\/>m\_groupId;}
\DoxyCodeLine{02102 }
\DoxyCodeLine{02103   \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke = m\_strokes[index]-\/>m\_s;}
\DoxyCodeLine{02104 }
\DoxyCodeLine{02105   \mbox{\hyperlink{class_t_stroke}{TStroke}} *ret;}
\DoxyCodeLine{02106   \textcolor{keywordtype}{int} cpCount = stroke-\/>\mbox{\hyperlink{class_t_stroke_a45101afd31e40d08100fdf23c89fb49e}{getControlPointCount}}();}
\DoxyCodeLine{02107   \textcolor{keywordtype}{int} count   = 0;}
\DoxyCodeLine{02108   std::vector<TThickPoint> points(cpCount + 2);}
\DoxyCodeLine{02109   \textcolor{keywordtype}{int} i, incr = (cpIndex == 0) ? -\/1 : 1;}
\DoxyCodeLine{02110   \textcolor{keywordflow}{for} (i = ((cpIndex == 0) ? cpCount -\/ 1 : 0); i != cpIndex + incr; i += incr)}
\DoxyCodeLine{02111     points[count++] = stroke-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(i);}
\DoxyCodeLine{02112   \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} tp(p, points[count -\/ 1].thick);}
\DoxyCodeLine{02113   points[count++] = 0.5 * (stroke-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(cpIndex) + tp);}
\DoxyCodeLine{02114   points[count++] = tp;}
\DoxyCodeLine{02115 }
\DoxyCodeLine{02116   \mbox{\hyperlink{class_t_stroke}{TStroke}} *newStroke = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}(points);}
\DoxyCodeLine{02117   newStroke-\/>\mbox{\hyperlink{class_t_stroke_a33f59dfbed74b577700351eac8c2fc7b}{setStyle}}(stroke-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}());}
\DoxyCodeLine{02118   newStroke-\/>outlineOptions() = stroke-\/>outlineOptions();}
\DoxyCodeLine{02119   ret                         = newStroke;}
\DoxyCodeLine{02120   std::list<TEdge *> oldEdgeList, emptyList;}
\DoxyCodeLine{02121 }
\DoxyCodeLine{02122   \textcolor{keywordflow}{if} (m\_computedAlmostOnce)}
\DoxyCodeLine{02123     computeEdgeList(newStroke, m\_strokes[index]-\/>m\_edgeList, cpIndex == 0,}
\DoxyCodeLine{02124                     emptyList, \textcolor{keyword}{false}, oldEdgeList);}
\DoxyCodeLine{02125 }
\DoxyCodeLine{02126   std::vector<int> toBeDeleted;}
\DoxyCodeLine{02127   toBeDeleted.push\_back(index);}
\DoxyCodeLine{02128   removeStrokes(toBeDeleted, \textcolor{keyword}{true}, \textcolor{keyword}{false});}
\DoxyCodeLine{02129 }
\DoxyCodeLine{02130   \textcolor{comment}{// removeStroke(index, false);}}
\DoxyCodeLine{02131 }
\DoxyCodeLine{02132   insertStrokeAt(\textcolor{keyword}{new} \mbox{\hyperlink{class_v_i_stroke}{VIStroke}}(newStroke, groupId), index, \textcolor{keyword}{false});}
\DoxyCodeLine{02133 }
\DoxyCodeLine{02134   \textcolor{keywordflow}{if} (m\_computedAlmostOnce) \{}
\DoxyCodeLine{02135     computeRegions();}
\DoxyCodeLine{02136     transferColors(oldEdgeList, m\_strokes[index]-\/>m\_edgeList, \textcolor{keyword}{true}, \textcolor{keyword}{false},}
\DoxyCodeLine{02137                    \textcolor{keyword}{true});}
\DoxyCodeLine{02138   \}}
\DoxyCodeLine{02139   \textcolor{keywordflow}{return} m\_strokes[index];}
\DoxyCodeLine{02140 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a3bd1155a5158a88d03221930a2e8b6bb}\label{class_t_vector_image_1_1_imp_a3bd1155a5158a88d03221930a2e8b6bb}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!extendStrokeSmoothly@{extendStrokeSmoothly}}
\index{extendStrokeSmoothly@{extendStrokeSmoothly}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{extendStrokeSmoothly()}{extendStrokeSmoothly()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$ TVector\+Image\+::\+Imp\+::extend\+Stroke\+Smoothly (\begin{DoxyParamCaption}\item[{int}]{index,  }\item[{const \mbox{\hyperlink{class_t_thick_point}{TThick\+Point}} \&}]{p,  }\item[{int}]{cp\+Index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02043                                                                \{}
\DoxyCodeLine{02044   \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke  = m\_strokes[index]-\/>m\_s;}
\DoxyCodeLine{02045   \mbox{\hyperlink{class_t_group_id}{TGroupId}} groupId = m\_strokes[index]-\/>m\_groupId;}
\DoxyCodeLine{02046 }
\DoxyCodeLine{02047   \textcolor{keywordtype}{int} cpCount = stroke-\/>\mbox{\hyperlink{class_t_stroke_a45101afd31e40d08100fdf23c89fb49e}{getControlPointCount}}();}
\DoxyCodeLine{02048   \textcolor{keywordtype}{int} styleId = stroke-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}();}
\DoxyCodeLine{02049   \textcolor{keyword}{const} \mbox{\hyperlink{class_t_thick_quadratic}{TThickQuadratic}} *q =}
\DoxyCodeLine{02050       stroke-\/>\mbox{\hyperlink{class_t_stroke_a06b18ffed330411aad73ef1748a3f263}{getChunk}}(cpIndex == 0 ? 0 : stroke-\/>\mbox{\hyperlink{class_t_stroke_a81b63663a798724333d8de692fdbcac0}{getChunkCount}}() -\/ 1);}
\DoxyCodeLine{02051 }
\DoxyCodeLine{02052   \textcolor{keywordtype}{double} len    = q-\/>\mbox{\hyperlink{class_t_quadratic_ac1db69c69cbf52b1becf396cc8006ca1}{getLength}}();}
\DoxyCodeLine{02053   \textcolor{keywordtype}{double} w      = exp(-\/len * 0.01);}
\DoxyCodeLine{02054   \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} m = q-\/>\mbox{\hyperlink{class_t_thick_quadratic_a77408faf6a40d919069ca5ce7733169a}{getThickP1}}();}
\DoxyCodeLine{02055 }
\DoxyCodeLine{02056   \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} p1 =}
\DoxyCodeLine{02057       (cpIndex == 0 ? q-\/>\mbox{\hyperlink{class_t_thick_quadratic_abf58f97664876561f84fa68a90f33d8b}{getThickP0}}() : q-\/>\mbox{\hyperlink{class_t_thick_quadratic_aa33c22ffd048565884c957888a677f83}{getThickP2}}()) * (1 -\/ w) + m * w;}
\DoxyCodeLine{02058   \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} middleP = (p1 + pos) * 0.5;}
\DoxyCodeLine{02059 }
\DoxyCodeLine{02060   \textcolor{keywordtype}{double} angle = fabs(cross(normalize(m -\/ middleP), normalize(pos -\/ middleP)));}
\DoxyCodeLine{02061   \textcolor{keywordflow}{if} (angle < 0.05) middleP = (m + pos) * 0.5;}
\DoxyCodeLine{02062 }
\DoxyCodeLine{02063   stroke-\/>\mbox{\hyperlink{class_t_stroke_abc4f174af1e2712c400ae63e005aac18}{setControlPoint}}(cpIndex, middleP);}
\DoxyCodeLine{02064   \textcolor{keywordflow}{if} (isAlmostZero(len)) \{}
\DoxyCodeLine{02065     \textcolor{keywordflow}{if} (cpIndex == 0)}
\DoxyCodeLine{02066       stroke-\/>\mbox{\hyperlink{class_t_stroke_abc4f174af1e2712c400ae63e005aac18}{setControlPoint}}(1,}
\DoxyCodeLine{02067                               middleP * 0.1 + stroke-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(2) * 0.9);}
\DoxyCodeLine{02068     \textcolor{keywordflow}{else}}
\DoxyCodeLine{02069       stroke-\/>\mbox{\hyperlink{class_t_stroke_abc4f174af1e2712c400ae63e005aac18}{setControlPoint}}(}
\DoxyCodeLine{02070           cpCount -\/ 2,}
\DoxyCodeLine{02071           middleP * 0.1 + stroke-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(cpCount -\/ 3) * 0.9);}
\DoxyCodeLine{02072   \}}
\DoxyCodeLine{02073 }
\DoxyCodeLine{02074   std::vector<TThickPoint> points(cpCount);}
\DoxyCodeLine{02075   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < cpCount -\/ 1; i++)}
\DoxyCodeLine{02076     points[i] = stroke-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}((cpIndex == 0) ? cpCount -\/ i -\/ 1 : i);}
\DoxyCodeLine{02077   points[cpCount -\/ 1] = pos;}
\DoxyCodeLine{02078 }
\DoxyCodeLine{02079   \mbox{\hyperlink{class_t_stroke}{TStroke}} *newStroke = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}(points);}
\DoxyCodeLine{02080   newStroke-\/>\mbox{\hyperlink{class_t_stroke_a33f59dfbed74b577700351eac8c2fc7b}{setStyle}}(styleId);}
\DoxyCodeLine{02081   newStroke-\/>outlineOptions() = stroke-\/>outlineOptions();}
\DoxyCodeLine{02082   std::list<TEdge *> oldEdgeList, emptyList;}
\DoxyCodeLine{02083   computeEdgeList(newStroke, m\_strokes[index]-\/>m\_edgeList, cpIndex == 0,}
\DoxyCodeLine{02084                   emptyList, 0, oldEdgeList);}
\DoxyCodeLine{02085 }
\DoxyCodeLine{02086   std::vector<int> toBeDeleted;}
\DoxyCodeLine{02087   toBeDeleted.push\_back(index);}
\DoxyCodeLine{02088   removeStrokes(toBeDeleted, \textcolor{keyword}{true}, \textcolor{keyword}{false});}
\DoxyCodeLine{02089 }
\DoxyCodeLine{02090   insertStrokeAt(\textcolor{keyword}{new} \mbox{\hyperlink{class_v_i_stroke}{VIStroke}}(newStroke, groupId), index, \textcolor{keyword}{false});}
\DoxyCodeLine{02091   computeRegions();}
\DoxyCodeLine{02092   transferColors(oldEdgeList, m\_strokes[index]-\/>m\_edgeList, \textcolor{keyword}{true}, \textcolor{keyword}{false}, \textcolor{keyword}{true});}
\DoxyCodeLine{02093 }
\DoxyCodeLine{02094   \textcolor{keywordflow}{return} m\_strokes[index];}
\DoxyCodeLine{02095 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_afad890d2eaa34b2a0b4b415a459c646e}\label{class_t_vector_image_1_1_imp_afad890d2eaa34b2a0b4b415a459c646e}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!fill@{fill}}
\index{fill@{fill}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{fill()}{fill()}}
{\footnotesize\ttfamily int TVector\+Image\+::\+Imp\+::fill (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p,  }\item[{int}]{style\+Id }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00749                                                        \{}
\DoxyCodeLine{00750   \textcolor{keywordtype}{int} strokeIndex = (int)m\_strokes.size() -\/ 1;}
\DoxyCodeLine{00751 }
\DoxyCodeLine{00752   \textcolor{keywordflow}{while} (strokeIndex >= 0) \{}
\DoxyCodeLine{00753     \textcolor{keywordflow}{if} (!inCurrentGroup(strokeIndex)) \{}
\DoxyCodeLine{00754       strokeIndex-\/-\/;}
\DoxyCodeLine{00755       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00756     \}}
\DoxyCodeLine{00757     \textcolor{keywordflow}{for} (UINT regionIndex = 0; regionIndex < m\_regions.size(); regionIndex++)}
\DoxyCodeLine{00758       \textcolor{keywordflow}{if} (areDifferentGroup(strokeIndex, \textcolor{keyword}{false}, regionIndex, \textcolor{keyword}{true}) == -\/1 \&\&}
\DoxyCodeLine{00759           m\_regions[regionIndex]-\/>contains(p))}
\DoxyCodeLine{00760         \textcolor{keywordflow}{return} m\_regions[regionIndex]-\/>fill(p, styleId);}
\DoxyCodeLine{00761     \textcolor{keywordtype}{int} curr = strokeIndex;}
\DoxyCodeLine{00762     \textcolor{keywordflow}{while} (strokeIndex >= 0 \&\&}
\DoxyCodeLine{00763            areDifferentGroup(curr, \textcolor{keyword}{false}, strokeIndex, \textcolor{keyword}{false}) == -\/1)}
\DoxyCodeLine{00764       strokeIndex-\/-\/;}
\DoxyCodeLine{00765   \}}
\DoxyCodeLine{00766 }
\DoxyCodeLine{00767   \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00768 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_ad82ebd62d47c0b644d0c76797882e4d8}\label{class_t_vector_image_1_1_imp_ad82ebd62d47c0b644d0c76797882e4d8}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!getFillData@{getFillData}}
\index{getFillData@{getFillData}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{getFillData()}{getFillData()}}
{\footnotesize\ttfamily UINT TVector\+Image\+::\+Imp\+::get\+Fill\+Data (\begin{DoxyParamCaption}\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{struct_t_vector_image_1_1_intersection_branch}{TVector\+Image\+::\+Intersection\+Branch}}\mbox{[}$\,$\mbox{]}$>$ \&}]{v }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00614                                                                         \{}
\DoxyCodeLine{00615   \textcolor{comment}{// print(m\_intersectionData-\/>m\_intList,}}
\DoxyCodeLine{00616   \textcolor{comment}{// "{}C:\(\backslash\)\(\backslash\)temp\(\backslash\)\(\backslash\)intersectionPrimaSave.txt"{});}}
\DoxyCodeLine{00617 }
\DoxyCodeLine{00618   \textcolor{comment}{// Intersection* intList = m\_intersectionData-\/>m\_intList;}}
\DoxyCodeLine{00619   \textcolor{keywordflow}{if} (m\_intersectionData-\/>m\_intList.empty()) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00620 }
\DoxyCodeLine{00621   \mbox{\hyperlink{class_intersection}{Intersection}} *p1;}
\DoxyCodeLine{00622   \mbox{\hyperlink{class_intersected_stroke}{IntersectedStroke}} *p2;}
\DoxyCodeLine{00623   UINT currInt = 0;}
\DoxyCodeLine{00624   vector<UINT> branchesBefore(m\_intersectionData-\/>m\_intList.size() + 1);}
\DoxyCodeLine{00625 }
\DoxyCodeLine{00626   branchesBefore[0] = 0;}
\DoxyCodeLine{00627   UINT count = 0, size = 0;}
\DoxyCodeLine{00628 }
\DoxyCodeLine{00629   p1 = m\_intersectionData-\/>m\_intList.first();}
\DoxyCodeLine{00630 }
\DoxyCodeLine{00631   \textcolor{keywordflow}{for} (; p1; p1 = p1-\/>next(), currInt++) \{}
\DoxyCodeLine{00632     UINT strokeListSize = p1-\/>m\_strokeList.size();}
\DoxyCodeLine{00633     size += strokeListSize;}
\DoxyCodeLine{00634     branchesBefore[currInt + 1] = branchesBefore[currInt] + strokeListSize;}
\DoxyCodeLine{00635   \}}
\DoxyCodeLine{00636 }
\DoxyCodeLine{00637   v.reset(\textcolor{keyword}{new} \mbox{\hyperlink{struct_t_vector_image_1_1_intersection_branch}{IntersectionBranch}}[size]);}
\DoxyCodeLine{00638   currInt = 0;}
\DoxyCodeLine{00639   p1      = m\_intersectionData-\/>m\_intList.first();}
\DoxyCodeLine{00640   \textcolor{keywordflow}{for} (; p1; p1 = p1-\/>next(), currInt++) \{}
\DoxyCodeLine{00641     UINT currBranch = 0;}
\DoxyCodeLine{00642     \textcolor{keywordflow}{for} (p2 = p1-\/>m\_strokeList.first(); p2; p2 = p2-\/>next(), currBranch++) \{}
\DoxyCodeLine{00643       \mbox{\hyperlink{struct_t_vector_image_1_1_intersection_branch}{IntersectionBranch}} \&b = v[count];}
\DoxyCodeLine{00644       b.m\_currInter         = currInt;}
\DoxyCodeLine{00645       b.m\_strokeIndex       = p2-\/>m\_edge.m\_index;}
\DoxyCodeLine{00646       b.m\_w                 = p2-\/>m\_edge.m\_w0;}
\DoxyCodeLine{00647       b.m\_style             = p2-\/>m\_edge.m\_styleId;}
\DoxyCodeLine{00648       \textcolor{comment}{// assert(b.m\_style<100);}}
\DoxyCodeLine{00649       b.m\_gettingOut = p2-\/>m\_gettingOut;}
\DoxyCodeLine{00650       \textcolor{keywordflow}{if} (!p2-\/>m\_nextIntersection)}
\DoxyCodeLine{00651         b.m\_nextBranch = count;}
\DoxyCodeLine{00652       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00653         UINT distInt =}
\DoxyCodeLine{00654             m\_intersectionData-\/>m\_intList.getPosOf(p2-\/>m\_nextIntersection);}
\DoxyCodeLine{00655         UINT distBranch =}
\DoxyCodeLine{00656             p2-\/>m\_nextIntersection-\/>m\_strokeList.getPosOf(p2-\/>m\_nextStroke);}
\DoxyCodeLine{00657 }
\DoxyCodeLine{00658         \textcolor{keywordflow}{if} ((distInt < currInt) ||}
\DoxyCodeLine{00659             (distInt == currInt \&\& distBranch < currBranch)) \{}
\DoxyCodeLine{00660           UINT posNext = branchesBefore[distInt] + distBranch;}
\DoxyCodeLine{00661           assert(posNext < count);}
\DoxyCodeLine{00662           b.m\_nextBranch = posNext;}
\DoxyCodeLine{00663           assert(v[posNext].m\_nextBranch == (std::numeric\_limits<UINT>::max)());}
\DoxyCodeLine{00664           v[posNext].m\_nextBranch = count;}
\DoxyCodeLine{00665         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00666           b.m\_nextBranch = (std::numeric\_limits<UINT>::max)();}
\DoxyCodeLine{00667       \}}
\DoxyCodeLine{00668       count++;}
\DoxyCodeLine{00669     \}}
\DoxyCodeLine{00670   \}}
\DoxyCodeLine{00671 }
\DoxyCodeLine{00672 \textcolor{comment}{// for (UINT i=0; i<count; i++)}}
\DoxyCodeLine{00673 \textcolor{comment}{//  assert(v[i].m\_nextBranch != std::numeric\_limits<UINT>::max());}}
\DoxyCodeLine{00674 }
\DoxyCodeLine{00675 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{00676 \textcolor{comment}{/*ofstream of("{}C:\(\backslash\)\(\backslash\)temp\(\backslash\)\(\backslash\)fillDataOut.txt"{});}}
\DoxyCodeLine{00677 \textcolor{comment}{}}
\DoxyCodeLine{00678 \textcolor{comment}{for (UINT ii=0; ii<size; ii++)}}
\DoxyCodeLine{00679 \textcolor{comment}{  \{}}
\DoxyCodeLine{00680 \textcolor{comment}{  of<<ii<<"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}<<endl;}}
\DoxyCodeLine{00681 \textcolor{comment}{  of<<"{}index:"{}<<v[ii].m\_strokeIndex<<endl;}}
\DoxyCodeLine{00682 \textcolor{comment}{  of<<"{}w:"{}<<v[ii].m\_w<<endl;}}
\DoxyCodeLine{00683 \textcolor{comment}{  of<<"{}curr inter:"{}<<v[ii].m\_currInter<<endl;}}
\DoxyCodeLine{00684 \textcolor{comment}{  of<<"{}next inter:"{}<<v[ii].m\_nextBranch<<endl;}}
\DoxyCodeLine{00685 \textcolor{comment}{  of<<"{}gettingOut:"{}<<((v[ii].m\_gettingOut)?"{}TRUE"{}:"{}FALSE"{})<<endl;}}
\DoxyCodeLine{00686 \textcolor{comment}{  of<<"{}colorId:"{}<<v[ii].m\_style<<endl;}}
\DoxyCodeLine{00687 \textcolor{comment}{  \}*/}}
\DoxyCodeLine{00688 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00689 }
\DoxyCodeLine{00690   \textcolor{keywordflow}{return} size;}
\DoxyCodeLine{00691 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a4d7f3cd1c1fb93f344d95ee8c0f6839a}\label{class_t_vector_image_1_1_imp_a4d7f3cd1c1fb93f344d95ee8c0f6839a}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!getRegion@{getRegion}}
\index{getRegion@{getRegion}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{getRegion()}{getRegion()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_region}{TRegion}} $\ast$ TVector\+Image\+::\+Imp\+::get\+Region (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00660                                                     \{}
\DoxyCodeLine{00661   \textcolor{keywordtype}{int} strokeIndex = (int)m\_strokes.size() -\/ 1;}
\DoxyCodeLine{00662 }
\DoxyCodeLine{00663   \textcolor{keywordflow}{while} (strokeIndex >= 0) \{}
\DoxyCodeLine{00664     \textcolor{keywordflow}{for} (UINT regionIndex = 0; regionIndex < m\_regions.size(); regionIndex++)}
\DoxyCodeLine{00665       \textcolor{keywordflow}{if} (areDifferentGroup(strokeIndex, \textcolor{keyword}{false}, regionIndex, \textcolor{keyword}{true}) == -\/1 \&\&}
\DoxyCodeLine{00666           m\_regions[regionIndex]-\/>contains(p))}
\DoxyCodeLine{00667         \textcolor{keywordflow}{return} m\_regions[regionIndex]-\/>getRegion(p);}
\DoxyCodeLine{00668     \textcolor{keywordtype}{int} curr = strokeIndex;}
\DoxyCodeLine{00669     \textcolor{keywordflow}{while} (strokeIndex >= 0 \&\&}
\DoxyCodeLine{00670            areDifferentGroup(curr, \textcolor{keyword}{false}, strokeIndex, \textcolor{keyword}{false}) == -\/1)}
\DoxyCodeLine{00671       strokeIndex-\/-\/;}
\DoxyCodeLine{00672   \}}
\DoxyCodeLine{00673 }
\DoxyCodeLine{00674   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00675 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a5271a36f574f950f694378e890e9021f}\label{class_t_vector_image_1_1_imp_a5271a36f574f950f694378e890e9021f}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!getRegion@{getRegion}}
\index{getRegion@{getRegion}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{getRegion()}{getRegion()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_region}{TRegion}} $\ast$ TVector\+Image\+::\+Imp\+::get\+Region (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_region_id}{TRegion\+Id}}}]{reg\+Id,  }\item[{int}]{index }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00426                                                                     \{}
\DoxyCodeLine{00427   assert(index != -\/1);}
\DoxyCodeLine{00428   \textcolor{keywordflow}{if} (index == -\/1) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00429 }
\DoxyCodeLine{00430   assert(index < (\textcolor{keywordtype}{int})m\_strokes.size());}
\DoxyCodeLine{00431   \textcolor{keywordflow}{if} (index >= (\textcolor{keywordtype}{int})m\_strokes.size()) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00432 }
\DoxyCodeLine{00433   std::list<TEdge *> \&edgeList = m\_strokes[index]-\/>m\_edgeList;}
\DoxyCodeLine{00434 }
\DoxyCodeLine{00435   std::list<TEdge *>::iterator endList = edgeList.end();}
\DoxyCodeLine{00436   \textcolor{keywordtype}{double} w0;}
\DoxyCodeLine{00437   \textcolor{keywordtype}{double} w1;}
\DoxyCodeLine{00438   \textcolor{keywordflow}{for} (std::list<TEdge *>::iterator it = edgeList.begin(); it != endList;}
\DoxyCodeLine{00439        ++it) \{}
\DoxyCodeLine{00440     w0 = (*it)-\/>m\_w0;}
\DoxyCodeLine{00441     w1 = (*it)-\/>m\_w1;}
\DoxyCodeLine{00442 }
\DoxyCodeLine{00443     \textcolor{keywordflow}{if} (w0 < w1) \{}
\DoxyCodeLine{00444       \textcolor{keywordflow}{if} (w0 < regId.m\_midW \&\& regId.m\_midW < w1 \&\& regId.m\_direction)}
\DoxyCodeLine{00445         \textcolor{keywordflow}{return} (*it)-\/>m\_r;}
\DoxyCodeLine{00446     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00447       \textcolor{keywordflow}{if} (w1 < regId.m\_midW \&\& regId.m\_midW < w0 \&\& !regId.m\_direction)}
\DoxyCodeLine{00448         \textcolor{keywordflow}{return} (*it)-\/>m\_r;}
\DoxyCodeLine{00449     \}}
\DoxyCodeLine{00450   \}}
\DoxyCodeLine{00451 }
\DoxyCodeLine{00452 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{00453   \mbox{\hyperlink{class_t_point_t}{TPointD}} cp1 = m\_strokes[index]-\/>m\_s-\/>getControlPoint(0);}
\DoxyCodeLine{00454   \mbox{\hyperlink{class_t_point_t}{TPointD}} cp2 = m\_strokes[index]-\/>m\_s-\/>getControlPoint(}
\DoxyCodeLine{00455       m\_strokes[index]-\/>m\_s-\/>getControlPointCount() -\/ 1);}
\DoxyCodeLine{00456 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00457 }
\DoxyCodeLine{00458   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00459 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a2809838a5671ad44b3a39d7208319e7f}\label{class_t_vector_image_1_1_imp_a2809838a5671ad44b3a39d7208319e7f}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!inCurrentGroup@{inCurrentGroup}}
\index{inCurrentGroup@{inCurrentGroup}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{inCurrentGroup()}{inCurrentGroup()}}
{\footnotesize\ttfamily bool TVector\+Image\+::\+Imp\+::in\+Current\+Group (\begin{DoxyParamCaption}\item[{int}]{stroke\+Index }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{02943                                                           \{}
\DoxyCodeLine{02944   \textcolor{keywordflow}{return} m\_insideGroup == \mbox{\hyperlink{class_t_group_id}{TGroupId}}() ||}
\DoxyCodeLine{02945          m\_insideGroup.isParentOf(m\_strokes[strokeIndex]-\/>m\_groupId);}
\DoxyCodeLine{02946 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a23267a686d0b4f742da663b2ffb98758}\label{class_t_vector_image_1_1_imp_a23267a686d0b4f742da663b2ffb98758}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!initRegionsData@{initRegionsData}}
\index{initRegionsData@{initRegionsData}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{initRegionsData()}{initRegionsData()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::init\+Regions\+Data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02405                                       \{}
\DoxyCodeLine{02406   m\_intersectionData = \textcolor{keyword}{new} \mbox{\hyperlink{class_intersection_data}{IntersectionData}}();}
\DoxyCodeLine{02407 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a45218676a6e1d80bacb0c44a5f8d5927}\label{class_t_vector_image_1_1_imp_a45218676a6e1d80bacb0c44a5f8d5927}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!insertStrokeAt@{insertStrokeAt}}
\index{insertStrokeAt@{insertStrokeAt}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{insertStrokeAt()}{insertStrokeAt()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::insert\+Stroke\+At (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$}]{stroke,  }\item[{int}]{stroke\+Index,  }\item[{bool}]{recompute\+Regions = {\ttfamily true} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{03181                                                               \{}
\DoxyCodeLine{03182   list<TEdge *> oldEdgeList, emptyList;}
\DoxyCodeLine{03183 }
\DoxyCodeLine{03184   \textcolor{keywordflow}{if} (m\_computedAlmostOnce \&\& recomputeRegions) \{}
\DoxyCodeLine{03185     oldEdgeList = vs-\/>m\_edgeList;}
\DoxyCodeLine{03186     vs-\/>m\_edgeList.clear();}
\DoxyCodeLine{03187   \}}
\DoxyCodeLine{03188 }
\DoxyCodeLine{03189   assert(strokeIndex >= 0 \&\& strokeIndex <= (\textcolor{keywordtype}{int})m\_strokes.size());}
\DoxyCodeLine{03190 }
\DoxyCodeLine{03191   vector<VIStroke *>::iterator it = m\_strokes.begin();}
\DoxyCodeLine{03192   advance(it, strokeIndex);}
\DoxyCodeLine{03193 }
\DoxyCodeLine{03194   vs-\/>m\_isNewForFill = \textcolor{keyword}{true};}
\DoxyCodeLine{03195   m\_strokes.insert(it, vs);}
\DoxyCodeLine{03196 }
\DoxyCodeLine{03197   \textcolor{keywordflow}{if} (!m\_computedAlmostOnce) \textcolor{keywordflow}{return};}
\DoxyCodeLine{03198 }
\DoxyCodeLine{03199   \mbox{\hyperlink{class_intersection}{Intersection}} *p1;}
\DoxyCodeLine{03200   \mbox{\hyperlink{class_intersected_stroke}{IntersectedStroke}} *p2;}
\DoxyCodeLine{03201 }
\DoxyCodeLine{03202   \textcolor{keywordflow}{for} (p1 = m\_intersectionData-\/>m\_intList.first(); p1; p1 = p1-\/>next())}
\DoxyCodeLine{03203     \textcolor{keywordflow}{for} (p2 = (*p1).m\_strokeList.first(); p2; p2 = p2-\/>next())}
\DoxyCodeLine{03204       \textcolor{keywordflow}{if} (p2-\/>m\_edge.m\_index >= (\textcolor{keywordtype}{int})strokeIndex) p2-\/>m\_edge.m\_index++;}
\DoxyCodeLine{03205 }
\DoxyCodeLine{03206   \textcolor{keywordflow}{if} (!recomputeRegions) \textcolor{keywordflow}{return};}
\DoxyCodeLine{03207 }
\DoxyCodeLine{03208   computeRegions();}
\DoxyCodeLine{03209   transferColors(oldEdgeList, m\_strokes[strokeIndex]-\/>m\_edgeList, \textcolor{keyword}{true}, \textcolor{keyword}{false},}
\DoxyCodeLine{03210                  \textcolor{keyword}{true});}
\DoxyCodeLine{03211 }
\DoxyCodeLine{03212   \textcolor{comment}{/*}}
\DoxyCodeLine{03213 \textcolor{comment}{\#ifdef \_DEBUG}}
\DoxyCodeLine{03214 \textcolor{comment}{checkIntersections();}}
\DoxyCodeLine{03215 \textcolor{comment}{\#endif}}
\DoxyCodeLine{03216 \textcolor{comment}{*/}}
\DoxyCodeLine{03217 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a27137f1c5fce6b647a69872012976cee}\label{class_t_vector_image_1_1_imp_a27137f1c5fce6b647a69872012976cee}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!joinStroke@{joinStroke}}
\index{joinStroke@{joinStroke}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{joinStroke()}{joinStroke()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$ TVector\+Image\+::\+Imp\+::join\+Stroke (\begin{DoxyParamCaption}\item[{int}]{index1,  }\item[{int}]{index2,  }\item[{int}]{cp\+Index1,  }\item[{int}]{cp\+Index2 }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02145                                                       \{}
\DoxyCodeLine{02146   assert(m\_strokes[index1]-\/>m\_groupId == m\_strokes[index2]-\/>m\_groupId);}
\DoxyCodeLine{02147 }
\DoxyCodeLine{02148   \mbox{\hyperlink{class_t_group_id}{TGroupId}} groupId = m\_strokes[index1]-\/>m\_groupId;}
\DoxyCodeLine{02149 }
\DoxyCodeLine{02150   \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke1 = m\_strokes[index1]-\/>m\_s;}
\DoxyCodeLine{02151   \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke2 = m\_strokes[index2]-\/>m\_s;}
\DoxyCodeLine{02152   \textcolor{comment}{// TStroke* ret;}}
\DoxyCodeLine{02153   \textcolor{keywordtype}{int} cpCount1 = stroke1-\/>\mbox{\hyperlink{class_t_stroke_a45101afd31e40d08100fdf23c89fb49e}{getControlPointCount}}();}
\DoxyCodeLine{02154   \textcolor{keywordtype}{int} cpCount2 = stroke2-\/>\mbox{\hyperlink{class_t_stroke_a45101afd31e40d08100fdf23c89fb49e}{getControlPointCount}}();}
\DoxyCodeLine{02155   \textcolor{keywordtype}{int} styleId  = stroke1-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}();}
\DoxyCodeLine{02156 }
\DoxyCodeLine{02157   \textcolor{comment}{// check if the both ends are at the same position}}
\DoxyCodeLine{02158   \textcolor{keywordtype}{bool} isSamePos = isAlmostZero(tdistance2(stroke1-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(cpIndex1),}
\DoxyCodeLine{02159                                            stroke2-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(cpIndex2)));}
\DoxyCodeLine{02160   \textcolor{comment}{// connecting the ends in the same shape at the same position}}
\DoxyCodeLine{02161   \textcolor{comment}{// means just making the shape self-\/looped}}
\DoxyCodeLine{02162   \textcolor{keywordflow}{if} (isSamePos \&\& index1 == index2) \{}
\DoxyCodeLine{02163     stroke1-\/>\mbox{\hyperlink{class_t_stroke_afa2c66ae11a70e68b3de3ce0b4cfb049}{setSelfLoop}}();}
\DoxyCodeLine{02164     \textcolor{keywordflow}{return} m\_strokes[index1];}
\DoxyCodeLine{02165   \}}
\DoxyCodeLine{02166 }
\DoxyCodeLine{02167   std::vector<TThickPoint> points;}
\DoxyCodeLine{02168   \textcolor{keywordtype}{int} i, incr = (cpIndex1 == 0) ? -\/1 : 1;}
\DoxyCodeLine{02169   \textcolor{keywordtype}{int} start = ((cpIndex1 == 0) ? cpCount1 -\/ 1 : 0);}
\DoxyCodeLine{02170   \textcolor{keywordtype}{int} end   = (isSamePos) ? cpIndex1 : cpIndex1 + incr;}
\DoxyCodeLine{02171   \textcolor{keywordflow}{for} (i = start; i != end; i += incr)}
\DoxyCodeLine{02172     points.push\_back(stroke1-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(i));}
\DoxyCodeLine{02173   points.push\_back(0.5 * (stroke1-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(cpIndex1) +}
\DoxyCodeLine{02174                           stroke2-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(cpIndex2)));}
\DoxyCodeLine{02175   \textcolor{keywordflow}{if} (index1 != index2) \{}
\DoxyCodeLine{02176     incr  = (cpIndex2 == 0) ? 1 : -\/1;}
\DoxyCodeLine{02177     start = (isSamePos) ? cpIndex2 + incr : cpIndex2;}
\DoxyCodeLine{02178     end   = ((cpIndex2 == 0) ? cpCount2 -\/ 1 : 0) + incr;}
\DoxyCodeLine{02179     \textcolor{keywordflow}{for} (i = start; i != end; i += incr)}
\DoxyCodeLine{02180       points.push\_back(stroke2-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(i));}
\DoxyCodeLine{02181   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{02182     points.push\_back(stroke2-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(cpIndex2));}
\DoxyCodeLine{02183 }
\DoxyCodeLine{02184   \mbox{\hyperlink{class_t_stroke}{TStroke}} *newStroke = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}(points);}
\DoxyCodeLine{02185   newStroke-\/>\mbox{\hyperlink{class_t_stroke_a33f59dfbed74b577700351eac8c2fc7b}{setStyle}}(styleId);}
\DoxyCodeLine{02186   newStroke-\/>outlineOptions() = stroke1-\/>outlineOptions();}
\DoxyCodeLine{02187   \textcolor{comment}{// ret = newStroke;}}
\DoxyCodeLine{02188   \textcolor{keywordflow}{if} (index1 == index2) newStroke-\/>\mbox{\hyperlink{class_t_stroke_afa2c66ae11a70e68b3de3ce0b4cfb049}{setSelfLoop}}();}
\DoxyCodeLine{02189   std::list<TEdge *> oldEdgeList, emptyList;}
\DoxyCodeLine{02190 }
\DoxyCodeLine{02191   computeEdgeList(}
\DoxyCodeLine{02192       newStroke, m\_strokes[index1]-\/>m\_edgeList, cpIndex1 == 0,}
\DoxyCodeLine{02193       (index1 != index2) ? m\_strokes[index2]-\/>m\_edgeList : emptyList,}
\DoxyCodeLine{02194       cpIndex2 == 0, oldEdgeList);}
\DoxyCodeLine{02195 }
\DoxyCodeLine{02196   std::vector<int> toBeDeleted;}
\DoxyCodeLine{02197   toBeDeleted.push\_back(index1);}
\DoxyCodeLine{02198   \textcolor{keywordflow}{if} (index1 != index2) toBeDeleted.push\_back(index2);}
\DoxyCodeLine{02199   removeStrokes(toBeDeleted, \textcolor{keyword}{true}, \textcolor{keyword}{false});}
\DoxyCodeLine{02200 }
\DoxyCodeLine{02201   insertStrokeAt(\textcolor{keyword}{new} \mbox{\hyperlink{class_v_i_stroke}{VIStroke}}(newStroke, groupId), index1, \textcolor{keyword}{false});}
\DoxyCodeLine{02202   computeRegions();}
\DoxyCodeLine{02203   transferColors(oldEdgeList, m\_strokes[index1]-\/>m\_edgeList, \textcolor{keyword}{true}, \textcolor{keyword}{false}, \textcolor{keyword}{true});}
\DoxyCodeLine{02204   \textcolor{keywordflow}{return} m\_strokes[index1];}
\DoxyCodeLine{02205 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a810ed176fc93d184f35732e9f3dd79ad}\label{class_t_vector_image_1_1_imp_a810ed176fc93d184f35732e9f3dd79ad}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!joinStrokeSmoothly@{joinStrokeSmoothly}}
\index{joinStrokeSmoothly@{joinStrokeSmoothly}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{joinStrokeSmoothly()}{joinStrokeSmoothly()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$ TVector\+Image\+::\+Imp\+::join\+Stroke\+Smoothly (\begin{DoxyParamCaption}\item[{int}]{index1,  }\item[{int}]{index2,  }\item[{int}]{cp\+Index1,  }\item[{int}]{cp\+Index2 }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02210                                                                             \{}
\DoxyCodeLine{02211   assert(m\_strokes[index1]-\/>m\_groupId == m\_strokes[index2]-\/>m\_groupId);}
\DoxyCodeLine{02212 }
\DoxyCodeLine{02213   \mbox{\hyperlink{class_t_group_id}{TGroupId}} groupId = m\_strokes[index1]-\/>m\_groupId;}
\DoxyCodeLine{02214 }
\DoxyCodeLine{02215   \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke1 = m\_strokes[index1]-\/>m\_s;}
\DoxyCodeLine{02216   \mbox{\hyperlink{class_t_stroke}{TStroke}} *stroke2 = m\_strokes[index2]-\/>m\_s;}
\DoxyCodeLine{02217   \mbox{\hyperlink{class_t_stroke}{TStroke}} *ret;}
\DoxyCodeLine{02218   \textcolor{keywordtype}{int} cpCount1 = stroke1-\/>\mbox{\hyperlink{class_t_stroke_a45101afd31e40d08100fdf23c89fb49e}{getControlPointCount}}();}
\DoxyCodeLine{02219   \textcolor{keywordtype}{int} cpCount2 = stroke2-\/>\mbox{\hyperlink{class_t_stroke_a45101afd31e40d08100fdf23c89fb49e}{getControlPointCount}}();}
\DoxyCodeLine{02220   \textcolor{keywordtype}{int} styleId  = stroke1-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}();}
\DoxyCodeLine{02221 }
\DoxyCodeLine{02222   \textcolor{keywordtype}{int} qCount1 = stroke1-\/>\mbox{\hyperlink{class_t_stroke_a81b63663a798724333d8de692fdbcac0}{getChunkCount}}();}
\DoxyCodeLine{02223   \textcolor{keywordtype}{int} qCount2 = stroke2-\/>\mbox{\hyperlink{class_t_stroke_a81b63663a798724333d8de692fdbcac0}{getChunkCount}}();}
\DoxyCodeLine{02224   \textcolor{keyword}{const} \mbox{\hyperlink{class_t_thick_quadratic}{TThickQuadratic}} *q1 =}
\DoxyCodeLine{02225       stroke1-\/>\mbox{\hyperlink{class_t_stroke_a06b18ffed330411aad73ef1748a3f263}{getChunk}}(cpIndex1 == 0 ? 0 : qCount1 -\/ 1);}
\DoxyCodeLine{02226   \textcolor{keyword}{const} \mbox{\hyperlink{class_t_thick_quadratic}{TThickQuadratic}} *q2 =}
\DoxyCodeLine{02227       stroke2-\/>\mbox{\hyperlink{class_t_stroke_a06b18ffed330411aad73ef1748a3f263}{getChunk}}(cpIndex2 == 0 ? 0 : qCount2 -\/ 1);}
\DoxyCodeLine{02228 }
\DoxyCodeLine{02229   \textcolor{keywordtype}{double} len1 = q1-\/>\mbox{\hyperlink{class_t_quadratic_ac1db69c69cbf52b1becf396cc8006ca1}{getLength}}();}
\DoxyCodeLine{02230   assert(len1 >= 0);}
\DoxyCodeLine{02231   \textcolor{keywordflow}{if} (len1 <= 0) len1 = 0;}
\DoxyCodeLine{02232   \textcolor{keywordtype}{double} w1 = exp(-\/len1 * 0.01);}
\DoxyCodeLine{02233 }
\DoxyCodeLine{02234   \textcolor{keywordtype}{double} len2 = q2-\/>\mbox{\hyperlink{class_t_quadratic_ac1db69c69cbf52b1becf396cc8006ca1}{getLength}}();}
\DoxyCodeLine{02235   assert(len2 >= 0);}
\DoxyCodeLine{02236   \textcolor{keywordflow}{if} (len2 <= 0) len2 = 0;}
\DoxyCodeLine{02237   \textcolor{keywordtype}{double} w2 = exp(-\/len2 * 0.01);}
\DoxyCodeLine{02238 }
\DoxyCodeLine{02239   \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} extreme1 = cpIndex1 == 0 ? q1-\/>\mbox{\hyperlink{class_t_thick_quadratic_abf58f97664876561f84fa68a90f33d8b}{getThickP0}}() : q1-\/>\mbox{\hyperlink{class_t_thick_quadratic_aa33c22ffd048565884c957888a677f83}{getThickP2}}();}
\DoxyCodeLine{02240   \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} extreme2 = cpIndex2 == 0 ? q2-\/>\mbox{\hyperlink{class_t_thick_quadratic_abf58f97664876561f84fa68a90f33d8b}{getThickP0}}() : q2-\/>\mbox{\hyperlink{class_t_thick_quadratic_aa33c22ffd048565884c957888a677f83}{getThickP2}}();}
\DoxyCodeLine{02241 }
\DoxyCodeLine{02242   \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} m1 = q1-\/>\mbox{\hyperlink{class_t_thick_quadratic_a77408faf6a40d919069ca5ce7733169a}{getThickP1}}();}
\DoxyCodeLine{02243   \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} m2 = q2-\/>\mbox{\hyperlink{class_t_thick_quadratic_a77408faf6a40d919069ca5ce7733169a}{getThickP1}}();}
\DoxyCodeLine{02244 }
\DoxyCodeLine{02245   \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} p1 = extreme1 * (1 -\/ w1) + m1 * w1;}
\DoxyCodeLine{02246   \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} p2 = extreme2 * (1 -\/ w2) + m2 * w2;}
\DoxyCodeLine{02247 }
\DoxyCodeLine{02248   \mbox{\hyperlink{class_t_thick_point}{TThickPoint}} middleP = (p1 + p2) * 0.5;}
\DoxyCodeLine{02249 }
\DoxyCodeLine{02250   \textcolor{keywordtype}{double} angle = fabs(cross(normalize(m1 -\/ middleP), normalize(m2 -\/ middleP)));}
\DoxyCodeLine{02251   \textcolor{keywordflow}{if} (angle < 0.05) middleP = (m1 + m2) * 0.5;}
\DoxyCodeLine{02252 }
\DoxyCodeLine{02253   stroke1-\/>\mbox{\hyperlink{class_t_stroke_abc4f174af1e2712c400ae63e005aac18}{setControlPoint}}(cpIndex1, middleP);}
\DoxyCodeLine{02254   \textcolor{keywordflow}{if} (isAlmostZero(len1)) \{}
\DoxyCodeLine{02255     \textcolor{keywordflow}{if} (cpIndex1 == 0)}
\DoxyCodeLine{02256       stroke1-\/>\mbox{\hyperlink{class_t_stroke_abc4f174af1e2712c400ae63e005aac18}{setControlPoint}}(}
\DoxyCodeLine{02257           1, middleP * 0.1 + stroke1-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(2) * 0.9);}
\DoxyCodeLine{02258     \textcolor{keywordflow}{else}}
\DoxyCodeLine{02259       stroke1-\/>\mbox{\hyperlink{class_t_stroke_abc4f174af1e2712c400ae63e005aac18}{setControlPoint}}(}
\DoxyCodeLine{02260           cpCount1 -\/ 2,}
\DoxyCodeLine{02261           middleP * 0.1 + stroke1-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(cpCount1 -\/ 3) * 0.9);}
\DoxyCodeLine{02262   \}}
\DoxyCodeLine{02263 }
\DoxyCodeLine{02264   stroke2-\/>\mbox{\hyperlink{class_t_stroke_abc4f174af1e2712c400ae63e005aac18}{setControlPoint}}(cpIndex2, middleP);}
\DoxyCodeLine{02265   \textcolor{keywordflow}{if} (isAlmostZero(len2)) \{}
\DoxyCodeLine{02266     \textcolor{keywordflow}{if} (cpIndex2 == 0)}
\DoxyCodeLine{02267       stroke2-\/>\mbox{\hyperlink{class_t_stroke_abc4f174af1e2712c400ae63e005aac18}{setControlPoint}}(}
\DoxyCodeLine{02268           1, middleP * 0.1 + stroke2-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(2) * 0.9);}
\DoxyCodeLine{02269     \textcolor{keywordflow}{else}}
\DoxyCodeLine{02270       stroke2-\/>\mbox{\hyperlink{class_t_stroke_abc4f174af1e2712c400ae63e005aac18}{setControlPoint}}(}
\DoxyCodeLine{02271           cpCount2 -\/ 2,}
\DoxyCodeLine{02272           middleP * 0.1 + stroke2-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(cpCount2 -\/ 3) * 0.9);}
\DoxyCodeLine{02273   \}}
\DoxyCodeLine{02274 }
\DoxyCodeLine{02275   \textcolor{keywordflow}{if} (stroke1 == stroke2) \{}
\DoxyCodeLine{02276     std::list<TEdge *> oldEdgeList, emptyList;}
\DoxyCodeLine{02277     computeEdgeList(stroke1, m\_strokes[index1]-\/>m\_edgeList, cpIndex1 == 0,}
\DoxyCodeLine{02278                     emptyList, \textcolor{keyword}{false}, oldEdgeList);}
\DoxyCodeLine{02279     eraseIntersection(index1);}
\DoxyCodeLine{02280     m\_strokes[index1]-\/>m\_isNewForFill = \textcolor{keyword}{true};}
\DoxyCodeLine{02281     stroke1-\/>\mbox{\hyperlink{class_t_stroke_afa2c66ae11a70e68b3de3ce0b4cfb049}{setSelfLoop}}();}
\DoxyCodeLine{02282     computeRegions();}
\DoxyCodeLine{02283     transferColors(oldEdgeList, m\_strokes[index1]-\/>m\_edgeList, \textcolor{keyword}{true}, \textcolor{keyword}{false},}
\DoxyCodeLine{02284                    \textcolor{keyword}{true});}
\DoxyCodeLine{02285     \textcolor{keywordflow}{return} m\_strokes[index1];}
\DoxyCodeLine{02286     \textcolor{comment}{// nundo-\/>m\_newStroke=new TStroke(*stroke1);}}
\DoxyCodeLine{02287     \textcolor{comment}{// nundo-\/>m\_newStrokeId=stroke1-\/>getId();}}
\DoxyCodeLine{02288   \}}
\DoxyCodeLine{02289 }
\DoxyCodeLine{02290   std::vector<TThickPoint> points;}
\DoxyCodeLine{02291   points.reserve(cpCount1 + cpCount2 -\/ 1);}
\DoxyCodeLine{02292 }
\DoxyCodeLine{02293   \textcolor{keywordtype}{int} incr = (cpIndex1) ? 1 : -\/1;}
\DoxyCodeLine{02294   \textcolor{keywordtype}{int} stop = cpIndex1;}
\DoxyCodeLine{02295 }
\DoxyCodeLine{02296   \textcolor{keywordtype}{int} i = cpCount1 -\/ 1 -\/ cpIndex1;}
\DoxyCodeLine{02297   \textcolor{keywordflow}{for} (; i != stop; i += incr) points.push\_back(stroke1-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(i));}
\DoxyCodeLine{02298 }
\DoxyCodeLine{02299   incr = (cpIndex2) ? -\/1 : 1;}
\DoxyCodeLine{02300   stop = cpCount2 -\/ 1 -\/ cpIndex2;}
\DoxyCodeLine{02301 }
\DoxyCodeLine{02302   \textcolor{keywordflow}{for} (i = cpIndex2; i != stop; i += incr)}
\DoxyCodeLine{02303     points.push\_back(stroke2-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(i));}
\DoxyCodeLine{02304 }
\DoxyCodeLine{02305   points.push\_back(stroke2-\/>\mbox{\hyperlink{class_t_stroke_a9b60f87075b703360efe4b38097d923f}{getControlPoint}}(stop));}
\DoxyCodeLine{02306 }
\DoxyCodeLine{02307   \mbox{\hyperlink{class_t_stroke}{TStroke}} *newStroke = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}(points);}
\DoxyCodeLine{02308   newStroke-\/>\mbox{\hyperlink{class_t_stroke_a33f59dfbed74b577700351eac8c2fc7b}{setStyle}}(styleId);}
\DoxyCodeLine{02309   newStroke-\/>outlineOptions() = stroke1-\/>outlineOptions();}
\DoxyCodeLine{02310   ret                         = newStroke;}
\DoxyCodeLine{02311   \textcolor{comment}{// nundo-\/>m\_newStroke=new TStroke(*newStroke);}}
\DoxyCodeLine{02312   \textcolor{comment}{// nundo-\/>m\_newStrokeId=newStroke-\/>getId();}}
\DoxyCodeLine{02313   std::list<TEdge *> oldEdgeList;}
\DoxyCodeLine{02314   \textcolor{comment}{// ofstream os("{}c:\(\backslash\)\(\backslash\)temp\(\backslash\)\(\backslash\)edges.txt"{});}}
\DoxyCodeLine{02315 }
\DoxyCodeLine{02316   \textcolor{comment}{// printEdges(os, "{}****edgelist1"{}, getPalette(),}}
\DoxyCodeLine{02317   \textcolor{comment}{// m\_imp-\/>m\_strokes[index1]-\/>m\_edgeList);}}
\DoxyCodeLine{02318   \textcolor{comment}{// printEdges(os, "{}****edgelist2"{}, getPalette(),}}
\DoxyCodeLine{02319   \textcolor{comment}{// m\_imp-\/>m\_strokes[index2]-\/>m\_edgeList);}}
\DoxyCodeLine{02320 }
\DoxyCodeLine{02321   computeEdgeList(newStroke, m\_strokes[index1]-\/>m\_edgeList, cpIndex1 == 0,}
\DoxyCodeLine{02322                   m\_strokes[index2]-\/>m\_edgeList, cpIndex2 == 0, oldEdgeList);}
\DoxyCodeLine{02323   \textcolor{comment}{// printEdges(os, "{}****edgelist"{}, getPalette(), oldEdgeList);}}
\DoxyCodeLine{02324 }
\DoxyCodeLine{02325   std::vector<int> toBeDeleted;}
\DoxyCodeLine{02326   toBeDeleted.push\_back(index1);}
\DoxyCodeLine{02327   toBeDeleted.push\_back(index2);}
\DoxyCodeLine{02328   removeStrokes(toBeDeleted, \textcolor{keyword}{true}, \textcolor{keyword}{false});}
\DoxyCodeLine{02329 }
\DoxyCodeLine{02330   insertStrokeAt(\textcolor{keyword}{new} \mbox{\hyperlink{class_v_i_stroke}{VIStroke}}(newStroke, groupId), index1);}
\DoxyCodeLine{02331   computeRegions();}
\DoxyCodeLine{02332   transferColors(oldEdgeList, m\_strokes[index1]-\/>m\_edgeList, \textcolor{keyword}{true}, \textcolor{keyword}{false}, \textcolor{keyword}{true});}
\DoxyCodeLine{02333 }
\DoxyCodeLine{02334   \textcolor{keywordflow}{return} m\_strokes[index1];}
\DoxyCodeLine{02335 }
\DoxyCodeLine{02336   \textcolor{comment}{//  TUndoManager::manager()-\/>add(nundo);}}
\DoxyCodeLine{02337 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a18ca500d2a57d78b520e9182993225b3}\label{class_t_vector_image_1_1_imp_a18ca500d2a57d78b520e9182993225b3}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!moveStroke@{moveStroke}}
\index{moveStroke@{moveStroke}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{moveStroke()}{moveStroke()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::move\+Stroke (\begin{DoxyParamCaption}\item[{int}]{from\+Index,  }\item[{int}]{to\+Index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{03076                                                               \{}
\DoxyCodeLine{03077   assert((\textcolor{keywordtype}{int})m\_strokes.size() > fromIndex);}
\DoxyCodeLine{03078   assert((\textcolor{keywordtype}{int})m\_strokes.size() >= moveBefore);}
\DoxyCodeLine{03079 }
\DoxyCodeLine{03080 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{03081   checkIntersections();}
\DoxyCodeLine{03082 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03083 }
\DoxyCodeLine{03084   \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *vi = m\_strokes[fromIndex];}
\DoxyCodeLine{03085 }
\DoxyCodeLine{03086   m\_strokes.erase(m\_strokes.begin() + fromIndex);}
\DoxyCodeLine{03087 }
\DoxyCodeLine{03088   std::vector<VIStroke *>::iterator it = m\_strokes.begin();}
\DoxyCodeLine{03089   \textcolor{keywordflow}{if} (fromIndex < moveBefore)}
\DoxyCodeLine{03090     advance(it, moveBefore -\/ 1);}
\DoxyCodeLine{03091   \textcolor{keywordflow}{else}}
\DoxyCodeLine{03092     advance(it, moveBefore);}
\DoxyCodeLine{03093 }
\DoxyCodeLine{03094   m\_strokes.insert(it, vi);}
\DoxyCodeLine{03095 }
\DoxyCodeLine{03096   \mbox{\hyperlink{class_intersection}{Intersection}} *p1;}
\DoxyCodeLine{03097   \mbox{\hyperlink{class_intersected_stroke}{IntersectedStroke}} *p2;}
\DoxyCodeLine{03098 }
\DoxyCodeLine{03099   \textcolor{keywordflow}{for} (p1 = m\_intersectionData-\/>m\_intList.first(); p1; p1 = p1-\/>next())}
\DoxyCodeLine{03100     \textcolor{keywordflow}{for} (p2 = p1-\/>m\_strokeList.first(); p2; p2 = p2-\/>next()) \{}
\DoxyCodeLine{03101       \textcolor{keywordflow}{if} (fromIndex < moveBefore) \{}
\DoxyCodeLine{03102         \textcolor{keywordflow}{if} (p2-\/>m\_edge.m\_index == fromIndex)}
\DoxyCodeLine{03103           p2-\/>m\_edge.m\_index = moveBefore -\/ 1;}
\DoxyCodeLine{03104         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (p2-\/>m\_edge.m\_index > fromIndex \&\&}
\DoxyCodeLine{03105                  p2-\/>m\_edge.m\_index < moveBefore)}
\DoxyCodeLine{03106           p2-\/>m\_edge.m\_index-\/-\/;}
\DoxyCodeLine{03107       \} \textcolor{keywordflow}{else}  \textcolor{comment}{//(fromIndex>moveBefore)}}
\DoxyCodeLine{03108       \{}
\DoxyCodeLine{03109         \textcolor{keywordflow}{if} (p2-\/>m\_edge.m\_index == fromIndex)}
\DoxyCodeLine{03110           p2-\/>m\_edge.m\_index = moveBefore;}
\DoxyCodeLine{03111         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (p2-\/>m\_edge.m\_index >= moveBefore \&\&}
\DoxyCodeLine{03112                  p2-\/>m\_edge.m\_index < fromIndex)}
\DoxyCodeLine{03113           p2-\/>m\_edge.m\_index++;}
\DoxyCodeLine{03114       \}}
\DoxyCodeLine{03115     \}}
\DoxyCodeLine{03116 }
\DoxyCodeLine{03117 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{03118   checkIntersections();}
\DoxyCodeLine{03119 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03120 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_ac5eaba9d36bcddbd71faee9359ef09cb}\label{class_t_vector_image_1_1_imp_ac5eaba9d36bcddbd71faee9359ef09cb}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!moveStrokes@{moveStrokes}}
\index{moveStrokes@{moveStrokes}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{moveStrokes()}{moveStrokes()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::move\+Strokes (\begin{DoxyParamCaption}\item[{int}]{from\+Index,  }\item[{int}]{count,  }\item[{int}]{move\+Before,  }\item[{bool}]{regroup }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00194                                                   \{}
\DoxyCodeLine{00195   assert(fromIndex >= 0 \&\& fromIndex < (\textcolor{keywordtype}{int})m\_strokes.size());}
\DoxyCodeLine{00196   assert(moveBefore >= 0 \&\& moveBefore <= (\textcolor{keywordtype}{int})m\_strokes.size());}
\DoxyCodeLine{00197   assert(count > 0);}
\DoxyCodeLine{00198 }
\DoxyCodeLine{00199   assert(fromIndex != moveBefore);}
\DoxyCodeLine{00200 }
\DoxyCodeLine{00201   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < count; i++)}
\DoxyCodeLine{00202     \textcolor{keywordflow}{if} (fromIndex < moveBefore)}
\DoxyCodeLine{00203       moveStroke(fromIndex, moveBefore);}
\DoxyCodeLine{00204     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00205       moveStroke(fromIndex + i, moveBefore + i);}
\DoxyCodeLine{00206 }
\DoxyCodeLine{00207   std::vector<int> changedStrokes;}
\DoxyCodeLine{00208   \textcolor{keywordflow}{if} (regroup) regroupGhosts(changedStrokes);}
\DoxyCodeLine{00209   \textcolor{keywordflow}{if} (!changedStrokes.empty())}
\DoxyCodeLine{00210     notifyChangedStrokes(changedStrokes, std::vector<TStroke *>(), \textcolor{keyword}{false});}
\DoxyCodeLine{00211 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_ae646c51451b57d05b1b83008da092ec8}\label{class_t_vector_image_1_1_imp_ae646c51451b57d05b1b83008da092ec8}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!notifyChangedStrokes@{notifyChangedStrokes}}
\index{notifyChangedStrokes@{notifyChangedStrokes}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{notifyChangedStrokes()}{notifyChangedStrokes()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::notify\+Changed\+Strokes (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ int $>$ \&}]{stroke\+Index\+Array,  }\item[{const std\+::vector$<$ \mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$ $>$ \&}]{old\+Vector\+Stroke\+Array,  }\item[{bool}]{are\+Flipped }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01051                                                                  \{}
\DoxyCodeLine{01052 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{01053   checkIntersections();}
\DoxyCodeLine{01054 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01055 }
\DoxyCodeLine{01056   assert(oldStrokeArray.empty() ||}
\DoxyCodeLine{01057          strokeIndexArray.size() == oldStrokeArray.size());}
\DoxyCodeLine{01058 }
\DoxyCodeLine{01059   \textcolor{keywordflow}{if} (!m\_computedAlmostOnce \&\& !m\_notIntersectingStrokes) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01060 }
\DoxyCodeLine{01061   \textcolor{keyword}{typedef} std::list<TEdge *> EdgeList;}
\DoxyCodeLine{01062   std::vector<EdgeList> oldEdgeListArray(strokeIndexArray.size());}
\DoxyCodeLine{01063   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{01064 }
\DoxyCodeLine{01065   \textcolor{comment}{// se si sono trasformati  interi gruppi (senza deformare le stroke) non c'e'}}
\DoxyCodeLine{01066   \textcolor{comment}{// bisogno di ricalcolare le regioni!}}
\DoxyCodeLine{01067   \textcolor{keywordflow}{if} (oldStrokeArray.empty() \&\& areWholeGroups(strokeIndexArray)) \{}
\DoxyCodeLine{01068     m\_areValidRegions = \textcolor{keyword}{true};}
\DoxyCodeLine{01069     \textcolor{keywordflow}{for} (i = 0; i < (int)m\_regions.size(); i++)}
\DoxyCodeLine{01070       invalidateRegionPropAndBBox(m\_regions[i]);}
\DoxyCodeLine{01071     \textcolor{keywordflow}{return};}
\DoxyCodeLine{01072   \}}
\DoxyCodeLine{01073 }
\DoxyCodeLine{01074   QMutexLocker sl(m\_mutex);}
\DoxyCodeLine{01075   \textcolor{keywordflow}{for} (i = 0; i < (int)strokeIndexArray.size(); i++)  \textcolor{comment}{// ATTENZIONE! non si puo'}}
\DoxyCodeLine{01076                                                       \textcolor{comment}{// fare eraseIntersection}}
\DoxyCodeLine{01077                                                       \textcolor{comment}{// in questo stesso ciclo}}
\DoxyCodeLine{01078   \{}
\DoxyCodeLine{01079     \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *s = m\_strokes[strokeIndexArray[i]];}
\DoxyCodeLine{01080     \textcolor{comment}{// if (s-\/>m\_s-\/>isSelfLoop())}}
\DoxyCodeLine{01081     \textcolor{comment}{//  assert(s-\/>m\_edgeList.size()<=1);}}
\DoxyCodeLine{01082 }
\DoxyCodeLine{01083     std::list<TEdge *>::iterator it = s-\/>m\_edgeList.begin();}
\DoxyCodeLine{01084     \textcolor{keywordflow}{for} (; it != s-\/>m\_edgeList.end(); it++) \{}
\DoxyCodeLine{01085       \mbox{\hyperlink{class_t_edge}{TEdge}} *e = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_edge}{TEdge}}(**it, \textcolor{keyword}{false});}
\DoxyCodeLine{01086       \textcolor{keywordflow}{if} (!oldStrokeArray.empty()) e-\/>m\_s = oldStrokeArray[i];}
\DoxyCodeLine{01087       oldEdgeListArray[i].push\_back(e);  \textcolor{comment}{// bisogna allocare nuovo edge,}}
\DoxyCodeLine{01088                                          \textcolor{comment}{// perche'la eraseIntersection poi lo}}
\DoxyCodeLine{01089                                          \textcolor{comment}{// cancella....}}
\DoxyCodeLine{01090       \textcolor{keywordflow}{if} ((*it)-\/>m\_toBeDeleted) \textcolor{keyword}{delete} *it;}
\DoxyCodeLine{01091     \}}
\DoxyCodeLine{01092     s-\/>m\_edgeList.clear();}
\DoxyCodeLine{01093   \}}
\DoxyCodeLine{01094 }
\DoxyCodeLine{01095   \textcolor{keywordflow}{for} (i = 0; i < (int)strokeIndexArray.size(); i++) \{}
\DoxyCodeLine{01096     eraseIntersection(strokeIndexArray[i]);}
\DoxyCodeLine{01097     \textcolor{keywordflow}{if} (!m\_notIntersectingStrokes)}
\DoxyCodeLine{01098       m\_strokes[strokeIndexArray[i]]-\/>m\_isNewForFill = \textcolor{keyword}{true};}
\DoxyCodeLine{01099   \}}
\DoxyCodeLine{01100 }
\DoxyCodeLine{01101   computeRegions();  \textcolor{comment}{// m\_imp-\/>m\_strokes, m\_imp-\/>m\_regions);}}
\DoxyCodeLine{01102 }
\DoxyCodeLine{01103   \textcolor{keywordflow}{for} (i = 0; i < (int)strokeIndexArray.size(); i++) \{}
\DoxyCodeLine{01104     transferColors(oldEdgeListArray[i],}
\DoxyCodeLine{01105                    m\_strokes[strokeIndexArray[i]]-\/>m\_edgeList, \textcolor{keyword}{true}, areFlipped,}
\DoxyCodeLine{01106                    \textcolor{keyword}{false});}
\DoxyCodeLine{01107     clearPointerContainer(oldEdgeListArray[i]);}
\DoxyCodeLine{01108   \}}
\DoxyCodeLine{01109 }
\DoxyCodeLine{01110 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{01111   checkIntersections();}
\DoxyCodeLine{01112 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01113 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_af7d0ae22e880661d817c4c1090851e3d}\label{class_t_vector_image_1_1_imp_af7d0ae22e880661d817c4c1090851e3d}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!rearrangeMultiGroup@{rearrangeMultiGroup}}
\index{rearrangeMultiGroup@{rearrangeMultiGroup}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{rearrangeMultiGroup()}{rearrangeMultiGroup()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::rearrange\+Multi\+Group (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02617                                           \{}
\DoxyCodeLine{02618   UINT i, j, k;}
\DoxyCodeLine{02619   \textcolor{keywordflow}{if} (m\_strokes.size() <= 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{02620   \textcolor{keywordflow}{for} (i = 0; i < m\_strokes.size() -\/ 1; i++) \{}
\DoxyCodeLine{02621     \textcolor{keywordflow}{if} (m\_strokes[i]-\/>m\_groupId.isGrouped() \&\&}
\DoxyCodeLine{02622         m\_strokes[i + 1]-\/>m\_groupId.isGrouped() \&\&}
\DoxyCodeLine{02623         m\_strokes[i]-\/>m\_groupId != m\_strokes[i + 1]-\/>m\_groupId) \{}
\DoxyCodeLine{02624       \mbox{\hyperlink{class_t_group_id}{TGroupId}} \&prevId   = m\_strokes[i]-\/>m\_groupId;}
\DoxyCodeLine{02625       \mbox{\hyperlink{class_t_group_id}{TGroupId}} \&idToMove = m\_strokes[i + 1]-\/>m\_groupId;}
\DoxyCodeLine{02626       \textcolor{keywordflow}{for} (j = i + 1;}
\DoxyCodeLine{02627            j < m\_strokes.size() \&\& m\_strokes[j]-\/>m\_groupId == idToMove; j++)}
\DoxyCodeLine{02628         ;}
\DoxyCodeLine{02629       \textcolor{keywordflow}{if} (j != m\_strokes.size()) \{}
\DoxyCodeLine{02630         j-\/-\/;  \textcolor{comment}{// now range i+1-\/j contains the strokes to be moved.}}
\DoxyCodeLine{02631         \textcolor{comment}{// let's compute where to move them (after last}}
\DoxyCodeLine{02632         \textcolor{keywordflow}{for} (k = j; k < m\_strokes.size() \&\& m\_strokes[k]-\/>m\_groupId != prevId;}
\DoxyCodeLine{02633              k++)}
\DoxyCodeLine{02634           ;}
\DoxyCodeLine{02635         \textcolor{keywordflow}{if} (k < m\_strokes.size()) \{}
\DoxyCodeLine{02636           \textcolor{keywordflow}{for} (; k < m\_strokes.size() \&\& m\_strokes[k]-\/>m\_groupId == prevId; k++)}
\DoxyCodeLine{02637             ;}
\DoxyCodeLine{02638           moveStrokes(i + 1, j -\/ i, k, \textcolor{keyword}{false});}
\DoxyCodeLine{02639           rearrangeMultiGroup();}
\DoxyCodeLine{02640           \textcolor{keywordflow}{return};}
\DoxyCodeLine{02641         \}}
\DoxyCodeLine{02642       \}}
\DoxyCodeLine{02643     \}}
\DoxyCodeLine{02644   \}}
\DoxyCodeLine{02645 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a304af0b088d77d802f9f6a5cd7460517}\label{class_t_vector_image_1_1_imp_a304af0b088d77d802f9f6a5cd7460517}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!regroupGhosts@{regroupGhosts}}
\index{regroupGhosts@{regroupGhosts}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{regroupGhosts()}{regroupGhosts()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::regroup\+Ghosts (\begin{DoxyParamCaption}\item[{std\+::vector$<$ int $>$ \&}]{changed\+Strokes }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{02876                                                                   \{}
\DoxyCodeLine{02877   \mbox{\hyperlink{class_t_group_id}{TGroupId}} currGroupId;}
\DoxyCodeLine{02878   std::set<TGroupId> groupMap;}
\DoxyCodeLine{02879   std::set<TGroupId>::iterator it;}
\DoxyCodeLine{02880   UINT i = 0;}
\DoxyCodeLine{02881 }
\DoxyCodeLine{02882   \textcolor{keywordflow}{while} (i < m\_strokes.size()) \{}
\DoxyCodeLine{02883     assert(m\_strokes[i]-\/>m\_groupId != currGroupId);}
\DoxyCodeLine{02884     assert(i == 0 ||}
\DoxyCodeLine{02885            m\_strokes[i -\/ 1]-\/>m\_groupId.isGrouped() !=}
\DoxyCodeLine{02886                m\_strokes[i]-\/>m\_groupId.isGrouped() != 0 ||}
\DoxyCodeLine{02887            (m\_strokes[i]-\/>m\_groupId.isGrouped() != 0 \&\&}
\DoxyCodeLine{02888             m\_strokes[i -\/ 1]-\/>m\_groupId != m\_strokes[i]-\/>m\_groupId));}
\DoxyCodeLine{02889 }
\DoxyCodeLine{02890     currGroupId = m\_strokes[i]-\/>m\_groupId;}
\DoxyCodeLine{02891     it          = groupMap.find(currGroupId);}
\DoxyCodeLine{02892     \textcolor{keywordflow}{if} (it != groupMap.end())  \textcolor{comment}{// esisteva gia un gruppo con questo id!}}
\DoxyCodeLine{02893     \{}
\DoxyCodeLine{02894       \textcolor{keywordflow}{if} (currGroupId.isGrouped() != 0)}
\DoxyCodeLine{02895         assert(!\textcolor{stringliteral}{"{}errore: due gruppi con lo stesso id!"{}});}
\DoxyCodeLine{02896       \textcolor{keywordflow}{else}  \textcolor{comment}{// gruppo ghost; gli do un nuovo id}}
\DoxyCodeLine{02897       \{}
\DoxyCodeLine{02898         \mbox{\hyperlink{class_t_group_id}{TGroupId}} newGroup(m\_vi, \textcolor{keyword}{true});}
\DoxyCodeLine{02899 }
\DoxyCodeLine{02900         \textcolor{keywordflow}{while} (i < m\_strokes.size() \&\&}
\DoxyCodeLine{02901                m\_strokes[i]-\/>m\_groupId.isGrouped(\textcolor{keyword}{true}) != 0) \{}
\DoxyCodeLine{02902           m\_strokes[i]-\/>m\_groupId = newGroup;}
\DoxyCodeLine{02903           changedStrokes.push\_back(i);}
\DoxyCodeLine{02904           i++;}
\DoxyCodeLine{02905         \}}
\DoxyCodeLine{02906       \}}
\DoxyCodeLine{02907     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{02908       groupMap.insert(currGroupId);}
\DoxyCodeLine{02909       \textcolor{keywordflow}{while} (i < m\_strokes.size() \&\&}
\DoxyCodeLine{02910              ((currGroupId.isGrouped(\textcolor{keyword}{false}) != 0 \&\&}
\DoxyCodeLine{02911                m\_strokes[i]-\/>m\_groupId == currGroupId) ||}
\DoxyCodeLine{02912               (currGroupId.isGrouped(\textcolor{keyword}{true}) != 0 \&\&}
\DoxyCodeLine{02913                m\_strokes[i]-\/>m\_groupId.isGrouped(\textcolor{keyword}{true}) != 0))) \{}
\DoxyCodeLine{02914         \textcolor{keywordflow}{if} (m\_strokes[i]-\/>m\_groupId != currGroupId) \{}
\DoxyCodeLine{02915           m\_strokes[i]-\/>m\_groupId = currGroupId;}
\DoxyCodeLine{02916           changedStrokes.push\_back(i);}
\DoxyCodeLine{02917         \}}
\DoxyCodeLine{02918         i++;}
\DoxyCodeLine{02919       \}}
\DoxyCodeLine{02920     \}}
\DoxyCodeLine{02921   \}}
\DoxyCodeLine{02922 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a4829fdbb3351e0eb297a7c31da90ba19}\label{class_t_vector_image_1_1_imp_a4829fdbb3351e0eb297a7c31da90ba19}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!reindexEdges@{reindexEdges}}
\index{reindexEdges@{reindexEdges}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{reindexEdges()}{reindexEdges()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::reindex\+Edges (\begin{DoxyParamCaption}\item[{UINT}]{stroke\+Index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{03124                                                    \{}
\DoxyCodeLine{03125   \mbox{\hyperlink{class_intersection}{Intersection}} *p1;}
\DoxyCodeLine{03126   \mbox{\hyperlink{class_intersected_stroke}{IntersectedStroke}} *p2;}
\DoxyCodeLine{03127 }
\DoxyCodeLine{03128   \textcolor{keywordflow}{for} (p1 = m\_intersectionData-\/>m\_intList.first(); p1; p1 = p1-\/>next())}
\DoxyCodeLine{03129     \textcolor{keywordflow}{for} (p2 = (*p1).m\_strokeList.first(); p2; p2 = p2-\/>next()) \{}
\DoxyCodeLine{03130       assert(p2-\/>m\_edge.m\_index != (\textcolor{keywordtype}{int})strokeIndex || p2-\/>m\_edge.m\_index < 0);}
\DoxyCodeLine{03131       \textcolor{keywordflow}{if} (p2-\/>m\_edge.m\_index > (\textcolor{keywordtype}{int})strokeIndex) p2-\/>m\_edge.m\_index-\/-\/;}
\DoxyCodeLine{03132     \}}
\DoxyCodeLine{03133 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_abdab177e97e33f78e34525b5ca71bfdc}\label{class_t_vector_image_1_1_imp_abdab177e97e33f78e34525b5ca71bfdc}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!reindexGroups@{reindexGroups}}
\index{reindexGroups@{reindexGroups}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{reindexGroups()}{reindexGroups()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::reindex\+Groups (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_vector_image_1_1_imp}{TVector\+Image\+::\+Imp}} \&}]{img }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01360                                                         \{}
\DoxyCodeLine{01361   UINT i, j;}
\DoxyCodeLine{01362   \textcolor{keywordtype}{int} newMax      = img.m\_maxGroupId;}
\DoxyCodeLine{01363   \textcolor{keywordtype}{int} newMaxGhost = img.m\_maxGhostGroupId;}
\DoxyCodeLine{01364   \textcolor{keywordflow}{for} (i = 0; i < m\_strokes.size(); i++) \{}
\DoxyCodeLine{01365     \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *s = m\_strokes[i];}
\DoxyCodeLine{01366     \textcolor{keywordflow}{if} (s-\/>m\_groupId.m\_id.empty()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01367     \textcolor{keywordflow}{if} (s-\/>m\_groupId.m\_id[0] > 0)}
\DoxyCodeLine{01368       \textcolor{keywordflow}{for} (j = 0; j < s-\/>m\_groupId.m\_id.size(); j++) \{}
\DoxyCodeLine{01369         s-\/>m\_groupId.m\_id[j] += img.m\_maxGroupId;}
\DoxyCodeLine{01370         newMax = std::max(newMax, s-\/>m\_groupId.m\_id[j]);}
\DoxyCodeLine{01371       \}}
\DoxyCodeLine{01372     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01373       \textcolor{keywordflow}{for} (j = 0; j < s-\/>m\_groupId.m\_id.size(); j++) \{}
\DoxyCodeLine{01374         s-\/>m\_groupId.m\_id[j] -\/= img.m\_maxGhostGroupId;}
\DoxyCodeLine{01375         newMaxGhost = std::max(newMaxGhost, -\/s-\/>m\_groupId.m\_id[j]);}
\DoxyCodeLine{01376       \}}
\DoxyCodeLine{01377   \}}
\DoxyCodeLine{01378   m\_maxGroupId = img.m\_maxGroupId = newMax;}
\DoxyCodeLine{01379   m\_maxGhostGroupId = img.m\_maxGhostGroupId = newMaxGhost;}
\DoxyCodeLine{01380 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_aeb442c649c268dffd20450182fce3ea8}\label{class_t_vector_image_1_1_imp_aeb442c649c268dffd20450182fce3ea8}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!removeEndpoints@{removeEndpoints}}
\index{removeEndpoints@{removeEndpoints}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{removeEndpoints()}{removeEndpoints()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$ TVector\+Image\+::\+Imp\+::remove\+Endpoints (\begin{DoxyParamCaption}\item[{int}]{stroke\+Index }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{03374                                                          \{}
\DoxyCodeLine{03375 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{03376   checkIntersections();}
\DoxyCodeLine{03377 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03378 }
\DoxyCodeLine{03379   \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *vs = m\_strokes[strokeIndex];}
\DoxyCodeLine{03380 }
\DoxyCodeLine{03381   \textcolor{keywordflow}{if} (vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a3565d6c34d3eb02fb1a6993ca626425c}{isSelfLoop}}()) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{03382   \textcolor{keywordflow}{if} (vs-\/>m\_edgeList.empty()) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{03383 }
\DoxyCodeLine{03384   list<TEdge *>::iterator it = vs-\/>m\_edgeList.begin();}
\DoxyCodeLine{03385 }
\DoxyCodeLine{03386   \textcolor{keywordtype}{double} minW = 1.0;}
\DoxyCodeLine{03387   \textcolor{keywordtype}{double} maxW = 0.0;}
\DoxyCodeLine{03388   \textcolor{keywordflow}{for} (; it != vs-\/>m\_edgeList.end(); ++it) \{}
\DoxyCodeLine{03389     minW = std::min(\{minW -\/ 0.00002, (*it)-\/>m\_w0, (*it)-\/>m\_w1\});}
\DoxyCodeLine{03390     maxW = std::max(\{maxW + 0.00002, (*it)-\/>m\_w0, (*it)-\/>m\_w1\});}
\DoxyCodeLine{03391   \}}
\DoxyCodeLine{03392 }
\DoxyCodeLine{03393   \textcolor{keywordflow}{if} (areAlmostEqual(minW, 0.0, 0.001) \&\& areAlmostEqual(maxW, 1.0, 0.001))}
\DoxyCodeLine{03394     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{03395 }
\DoxyCodeLine{03396   \mbox{\hyperlink{class_t_stroke}{TStroke}} *oldS = vs-\/>m\_s;}
\DoxyCodeLine{03397 }
\DoxyCodeLine{03398   \mbox{\hyperlink{class_t_stroke}{TStroke}} *s = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}(*(vs-\/>m\_s));}
\DoxyCodeLine{03399 }
\DoxyCodeLine{03400   \textcolor{keywordtype}{double} offs = s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}(minW);}
\DoxyCodeLine{03401 }
\DoxyCodeLine{03402   \mbox{\hyperlink{class_t_stroke}{TStroke}} s0, s1, \textcolor{keyword}{final};}
\DoxyCodeLine{03403 }
\DoxyCodeLine{03404   \textcolor{keywordflow}{if} (!areAlmostEqual(maxW, 1.0, 0.001)) \{}
\DoxyCodeLine{03405     s-\/>\mbox{\hyperlink{class_t_stroke_a3de435d73bc9063b8667b590032e9eaa}{split}}(maxW, s0, s1);}
\DoxyCodeLine{03406   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{03407     s0 = *s;}
\DoxyCodeLine{03408 }
\DoxyCodeLine{03409   \textcolor{keywordflow}{if} (!areAlmostEqual(minW, 0.0, 0.001)) \{}
\DoxyCodeLine{03410     \textcolor{keywordtype}{double} newW = (maxW == 1.0) ? minW : s0.\mbox{\hyperlink{class_t_stroke_a45226c432c0d643e9985823abccdeda2}{getParameterAtLength}}(offs);}
\DoxyCodeLine{03411     s0.\mbox{\hyperlink{class_t_stroke_a3de435d73bc9063b8667b590032e9eaa}{split}}(newW, s1, \textcolor{keyword}{final});}
\DoxyCodeLine{03412   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{03413     \textcolor{keyword}{final} = s0;}
\DoxyCodeLine{03414 }
\DoxyCodeLine{03415   vs-\/>m\_s = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}(\textcolor{keyword}{final});}
\DoxyCodeLine{03416   vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a33f59dfbed74b577700351eac8c2fc7b}{setStyle}}(oldS-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}());}
\DoxyCodeLine{03417 }
\DoxyCodeLine{03418   \textcolor{keywordflow}{for} (it = vs-\/>m\_edgeList.begin(); it != vs-\/>m\_edgeList.end(); ++it) \{}
\DoxyCodeLine{03419     (*it)-\/>m\_w0 =}
\DoxyCodeLine{03420         vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a45226c432c0d643e9985823abccdeda2}{getParameterAtLength}}(s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}((*it)-\/>m\_w0) -\/ offs);}
\DoxyCodeLine{03421     (*it)-\/>m\_w1 =}
\DoxyCodeLine{03422         vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a45226c432c0d643e9985823abccdeda2}{getParameterAtLength}}(s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}((*it)-\/>m\_w1) -\/ offs);}
\DoxyCodeLine{03423     (*it)-\/>m\_s = vs-\/>m\_s;}
\DoxyCodeLine{03424   \}}
\DoxyCodeLine{03425 }
\DoxyCodeLine{03426   \mbox{\hyperlink{class_intersection}{Intersection}} *p1;}
\DoxyCodeLine{03427   \mbox{\hyperlink{class_intersected_stroke}{IntersectedStroke}} *p2;}
\DoxyCodeLine{03428 }
\DoxyCodeLine{03429   \textcolor{keywordflow}{for} (p1 = m\_intersectionData-\/>m\_intList.first(); p1; p1 = p1-\/>next())}
\DoxyCodeLine{03430     \textcolor{keywordflow}{for} (p2 = (*p1).m\_strokeList.first(); p2; p2 = p2-\/>next()) \{}
\DoxyCodeLine{03431       \textcolor{keywordflow}{if} (p2-\/>m\_edge.m\_s == oldS) \{}
\DoxyCodeLine{03432         p2-\/>m\_edge.m\_w0 =}
\DoxyCodeLine{03433             vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a45226c432c0d643e9985823abccdeda2}{getParameterAtLength}}(s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}(p2-\/>m\_edge.m\_w0) -\/ offs);}
\DoxyCodeLine{03434         p2-\/>m\_edge.m\_w1 =}
\DoxyCodeLine{03435             vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a45226c432c0d643e9985823abccdeda2}{getParameterAtLength}}(s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}(p2-\/>m\_edge.m\_w1) -\/ offs);}
\DoxyCodeLine{03436         p2-\/>m\_edge.m\_s = vs-\/>m\_s;}
\DoxyCodeLine{03437       \}}
\DoxyCodeLine{03438     \}}
\DoxyCodeLine{03439 }
\DoxyCodeLine{03440 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{03441   checkIntersections();}
\DoxyCodeLine{03442 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03443 }
\DoxyCodeLine{03444   \textcolor{keywordflow}{return} oldS;}
\DoxyCodeLine{03445 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_aa9231d6b7c3aa554334c2f84cbd4f5c3}\label{class_t_vector_image_1_1_imp_aa9231d6b7c3aa554334c2f84cbd4f5c3}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!removeStroke@{removeStroke}}
\index{removeStroke@{removeStroke}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{removeStroke()}{removeStroke()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$ TVector\+Image\+::\+Imp\+::remove\+Stroke (\begin{DoxyParamCaption}\item[{int}]{index,  }\item[{bool}]{do\+Compute\+Regions }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00278                                                                        \{}
\DoxyCodeLine{00279   assert(index >= 0 \&\& index < (\textcolor{keywordtype}{int})m\_strokes.size());}
\DoxyCodeLine{00280   QMutexLocker sl(m\_mutex);}
\DoxyCodeLine{00281 }
\DoxyCodeLine{00282   \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *stroke = m\_strokes[index];}
\DoxyCodeLine{00283 }
\DoxyCodeLine{00284   eraseIntersection(index);}
\DoxyCodeLine{00285 }
\DoxyCodeLine{00286   m\_strokes.erase(m\_strokes.begin() + index);}
\DoxyCodeLine{00287 }
\DoxyCodeLine{00288   \textcolor{keywordflow}{if} (m\_computedAlmostOnce) \{}
\DoxyCodeLine{00289     reindexEdges(index);}
\DoxyCodeLine{00290     \textcolor{keywordflow}{if} (doComputeRegions) computeRegions();}
\DoxyCodeLine{00291   \}}
\DoxyCodeLine{00292 }
\DoxyCodeLine{00293   \textcolor{keywordflow}{return} stroke-\/>m\_s;}
\DoxyCodeLine{00294 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a2f71ab28f8477f967bcd609843f78fef}\label{class_t_vector_image_1_1_imp_a2f71ab28f8477f967bcd609843f78fef}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!removeStrokes@{removeStrokes}}
\index{removeStrokes@{removeStrokes}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{removeStrokes()}{removeStrokes()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::remove\+Strokes (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ int $>$ \&}]{to\+Be\+Removed,  }\item[{bool}]{delete\+Them,  }\item[{bool}]{recompute\+Regions }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00306                                                                               \{}
\DoxyCodeLine{00307   QMutexLocker sl(m\_mutex);}
\DoxyCodeLine{00308 }
\DoxyCodeLine{00309   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = toBeRemoved.size() -\/ 1; i >= 0; i-\/-\/) \{}
\DoxyCodeLine{00310     assert(i == 0 || toBeRemoved[i -\/ 1] < toBeRemoved[i]);}
\DoxyCodeLine{00311     UINT index = toBeRemoved[i];}
\DoxyCodeLine{00312 }
\DoxyCodeLine{00313     eraseIntersection(index);}
\DoxyCodeLine{00314     \textcolor{keywordflow}{if} (deleteThem) \textcolor{keyword}{delete} m\_strokes[index];}
\DoxyCodeLine{00315     m\_strokes.erase(m\_strokes.begin() + index);}
\DoxyCodeLine{00316   \}}
\DoxyCodeLine{00317 }
\DoxyCodeLine{00318   \textcolor{keywordflow}{if} (m\_computedAlmostOnce \&\& !toBeRemoved.empty()) \{}
\DoxyCodeLine{00319     reindexEdges(toBeRemoved, \textcolor{keyword}{false});}
\DoxyCodeLine{00320 }
\DoxyCodeLine{00321     \textcolor{keywordflow}{if} (recomputeRegions)}
\DoxyCodeLine{00322       computeRegions();}
\DoxyCodeLine{00323     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00324       m\_areValidRegions = \textcolor{keyword}{false};}
\DoxyCodeLine{00325   \}}
\DoxyCodeLine{00326 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a5e0b6903ee7f35d32f84358bf1e7f66d}\label{class_t_vector_image_1_1_imp_a5e0b6903ee7f35d32f84358bf1e7f66d}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!restoreEndpoints@{restoreEndpoints}}
\index{restoreEndpoints@{restoreEndpoints}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{restoreEndpoints()}{restoreEndpoints()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::restore\+Endpoints (\begin{DoxyParamCaption}\item[{int}]{index,  }\item[{\mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$}]{old\+Stroke }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{03449                                                                     \{}
\DoxyCodeLine{03450 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{03451   checkIntersections();}
\DoxyCodeLine{03452 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03453 }
\DoxyCodeLine{03454   \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *vs = m\_strokes[index];}
\DoxyCodeLine{03455 }
\DoxyCodeLine{03456   \mbox{\hyperlink{class_t_stroke}{TStroke}} *s = vs-\/>m\_s;}
\DoxyCodeLine{03457   \mbox{\hyperlink{class_t_point_t}{TPointD}} p  = s-\/>\mbox{\hyperlink{class_t_stroke_ace861e064b925c5d41a6d7381ae6ada5}{getPoint}}(0.0);}
\DoxyCodeLine{03458 }
\DoxyCodeLine{03459   \textcolor{keywordtype}{double} offs = oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}(oldStroke-\/>\mbox{\hyperlink{class_t_stroke_a38326dc317f9ff3828940996f41376a6}{getW}}(p));}
\DoxyCodeLine{03460 }
\DoxyCodeLine{03461   vs-\/>m\_s = oldStroke;}
\DoxyCodeLine{03462 }
\DoxyCodeLine{03463   list<TEdge *>::iterator it = vs-\/>m\_edgeList.begin();}
\DoxyCodeLine{03464   \textcolor{keywordflow}{for} (; it != vs-\/>m\_edgeList.end(); ++it) \{}
\DoxyCodeLine{03465     (*it)-\/>m\_w0 =}
\DoxyCodeLine{03466         vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a45226c432c0d643e9985823abccdeda2}{getParameterAtLength}}(s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}((*it)-\/>m\_w0) + offs);}
\DoxyCodeLine{03467     (*it)-\/>m\_w1 =}
\DoxyCodeLine{03468         vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a45226c432c0d643e9985823abccdeda2}{getParameterAtLength}}(s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}((*it)-\/>m\_w1) + offs);}
\DoxyCodeLine{03469     (*it)-\/>m\_s = vs-\/>m\_s;}
\DoxyCodeLine{03470   \}}
\DoxyCodeLine{03471 }
\DoxyCodeLine{03472   \mbox{\hyperlink{class_intersection}{Intersection}} *p1;}
\DoxyCodeLine{03473   \mbox{\hyperlink{class_intersected_stroke}{IntersectedStroke}} *p2;}
\DoxyCodeLine{03474 }
\DoxyCodeLine{03475   \textcolor{keywordflow}{for} (p1 = m\_intersectionData-\/>m\_intList.first(); p1; p1 = p1-\/>next())}
\DoxyCodeLine{03476     \textcolor{keywordflow}{for} (p2 = (*p1).m\_strokeList.first(); p2; p2 = p2-\/>next()) \{}
\DoxyCodeLine{03477       \textcolor{keywordflow}{if} (p2-\/>m\_edge.m\_s == s) \{}
\DoxyCodeLine{03478         p2-\/>m\_edge.m\_w0 =}
\DoxyCodeLine{03479             vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a45226c432c0d643e9985823abccdeda2}{getParameterAtLength}}(s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}(p2-\/>m\_edge.m\_w0) + offs);}
\DoxyCodeLine{03480         p2-\/>m\_edge.m\_w1 =}
\DoxyCodeLine{03481             vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a45226c432c0d643e9985823abccdeda2}{getParameterAtLength}}(s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}(p2-\/>m\_edge.m\_w1) + offs);}
\DoxyCodeLine{03482         p2-\/>m\_edge.m\_s = vs-\/>m\_s;}
\DoxyCodeLine{03483       \}}
\DoxyCodeLine{03484     \}}
\DoxyCodeLine{03485 }
\DoxyCodeLine{03486   \textcolor{keyword}{delete} s;}
\DoxyCodeLine{03487 }
\DoxyCodeLine{03488 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{03489   checkIntersections();}
\DoxyCodeLine{03490 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03491 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a3cd0d107cd90a0467e895addabb1bc01}\label{class_t_vector_image_1_1_imp_a3cd0d107cd90a0467e895addabb1bc01}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!selectFill@{selectFill}}
\index{selectFill@{selectFill}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{selectFill()}{selectFill()}}
{\footnotesize\ttfamily bool TVector\+Image\+::\+Imp\+::select\+Fill (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{select\+Area,  }\item[{\mbox{\hyperlink{class_t_stroke}{TStroke}} $\ast$}]{s,  }\item[{int}]{style\+Id,  }\item[{bool}]{only\+Unfilled,  }\item[{bool}]{fill\+Areas,  }\item[{bool}]{fill\+Lines }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00784                                                                    \{}
\DoxyCodeLine{00785   \textcolor{keywordtype}{bool} hitSome = \textcolor{keyword}{false};}
\DoxyCodeLine{00786 }
\DoxyCodeLine{00787   \textcolor{keywordflow}{if} (s) \{}
\DoxyCodeLine{00788     \mbox{\hyperlink{class_t_vector_image}{TVectorImage}} aux;}
\DoxyCodeLine{00789     aux.\mbox{\hyperlink{class_t_vector_image_ae79fbf2aec0f00876382f920227bfa05}{addStroke}}(s);}
\DoxyCodeLine{00790     aux.findRegions();}
\DoxyCodeLine{00791     \textcolor{keywordflow}{for} (UINT j = 0; j < aux.\mbox{\hyperlink{class_t_vector_image_a12e56e674828c172749d5bc1855bc977}{getRegionCount}}(); j++) \{}
\DoxyCodeLine{00792       \mbox{\hyperlink{class_t_region}{TRegion}} *r0 = aux.\mbox{\hyperlink{class_t_vector_image_a17f9e44c72c82c54d0cf9fefed85e12f}{getRegion}}(j);}
\DoxyCodeLine{00793       \textcolor{keywordflow}{if} (fillAreas)}
\DoxyCodeLine{00794         \textcolor{keywordflow}{for} (UINT i = 0; i < m\_regions.size(); i++) \{}
\DoxyCodeLine{00795           \mbox{\hyperlink{class_t_region}{TRegion}} *r1 = m\_regions[i];}
\DoxyCodeLine{00796 }
\DoxyCodeLine{00797           \textcolor{keywordflow}{if} (m\_insideGroup != \mbox{\hyperlink{class_t_group_id}{TGroupId}}() \&\&}
\DoxyCodeLine{00798               !m\_insideGroup.isParentOf(}
\DoxyCodeLine{00799                   m\_strokes[r1-\/>getEdge(0)-\/>m\_index]-\/>m\_groupId))}
\DoxyCodeLine{00800             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00801 }
\DoxyCodeLine{00802           \textcolor{keywordflow}{if} ((!onlyUnfilled || r1-\/>getStyle() == 0) \&\& r0-\/>contains(*r1)) \{}
\DoxyCodeLine{00803             r1-\/>setStyle(newStyleId);}
\DoxyCodeLine{00804             hitSome = \textcolor{keyword}{true};}
\DoxyCodeLine{00805           \}}
\DoxyCodeLine{00806         \}}
\DoxyCodeLine{00807       \textcolor{keywordflow}{if} (fillLines)}
\DoxyCodeLine{00808         \textcolor{keywordflow}{for} (UINT i = 0; i < m\_strokes.size(); i++) \{}
\DoxyCodeLine{00809           \textcolor{keywordflow}{if} (!inCurrentGroup(i)) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00810 }
\DoxyCodeLine{00811           \mbox{\hyperlink{class_t_stroke}{TStroke}} *s1 = m\_strokes[i]-\/>m\_s;}
\DoxyCodeLine{00812           \textcolor{keywordflow}{if} ((!onlyUnfilled || s1-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}() == 0) \&\& r0-\/>contains(*s1)) \{}
\DoxyCodeLine{00813             s1-\/>\mbox{\hyperlink{class_t_stroke_a33f59dfbed74b577700351eac8c2fc7b}{setStyle}}(newStyleId);}
\DoxyCodeLine{00814             hitSome = \textcolor{keyword}{true};}
\DoxyCodeLine{00815           \}}
\DoxyCodeLine{00816         \}}
\DoxyCodeLine{00817     \}}
\DoxyCodeLine{00818     aux.\mbox{\hyperlink{class_t_vector_image_a33a9f3cddc17630c35c8bf62e9989cc2}{removeStroke}}(0);}
\DoxyCodeLine{00819     \textcolor{keywordflow}{return} hitSome;}
\DoxyCodeLine{00820   \}}
\DoxyCodeLine{00821 }
\DoxyCodeLine{00822   \textcolor{comment}{// rect fill}}
\DoxyCodeLine{00823 }
\DoxyCodeLine{00824   \textcolor{keywordflow}{if} (fillAreas)}
\DoxyCodeLine{00825 \textcolor{preprocessor}{\#ifndef NEW\_REGION\_FILL}}
\DoxyCodeLine{00826     \textcolor{keywordflow}{for} (UINT i = 0; i < m\_regions.size(); i++) \{}
\DoxyCodeLine{00827       \textcolor{keywordtype}{int} index, j = 0;}
\DoxyCodeLine{00828 }
\DoxyCodeLine{00829       \textcolor{keywordflow}{do}}
\DoxyCodeLine{00830         index = m\_regions[i]-\/>getEdge(j++)-\/>m\_index;}
\DoxyCodeLine{00831       \textcolor{keywordflow}{while} (index < 0 \&\& j < (\textcolor{keywordtype}{int})m\_regions[i]-\/>getEdgeCount());}
\DoxyCodeLine{00832       \textcolor{comment}{// if index<0, means that the region is purely of autoclose strokes!}}
\DoxyCodeLine{00833       \textcolor{keywordflow}{if} (m\_insideGroup != \mbox{\hyperlink{class_t_group_id}{TGroupId}}() \&\& index >= 0 \&\&}
\DoxyCodeLine{00834           !m\_insideGroup.isParentOf(m\_strokes[index]-\/>m\_groupId))}
\DoxyCodeLine{00835         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00836       \textcolor{keywordflow}{if} (!onlyUnfilled || m\_regions[i]-\/>getStyle() == 0)}
\DoxyCodeLine{00837         hitSome |= m\_regions[i]-\/>selectFill(selArea, newStyleId);}
\DoxyCodeLine{00838     \}}
\DoxyCodeLine{00839 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00840 }
\DoxyCodeLine{00841     findRegions(selArea);}
\DoxyCodeLine{00842 }
\DoxyCodeLine{00843   \textcolor{keywordflow}{for} (UINT i = 0; i < m\_regions.size(); i++) \{}
\DoxyCodeLine{00844     \textcolor{keywordflow}{if} (m\_insideGroup != \mbox{\hyperlink{class_t_group_id}{TGroupId}}() \&\&}
\DoxyCodeLine{00845         !m\_insideGroup.isParentOf(}
\DoxyCodeLine{00846             m\_strokes[m\_regions[i]-\/>getEdge(0)-\/>m\_index]-\/>m\_groupId))}
\DoxyCodeLine{00847       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00848     \textcolor{keywordflow}{if} (!onlyUnfilled || m\_regions[i]-\/>getStyle() == 0)}
\DoxyCodeLine{00849       hitSome |= m\_regions[i]-\/>selectFill(selArea, newStyleId);}
\DoxyCodeLine{00850   \}}
\DoxyCodeLine{00851 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00852 }
\DoxyCodeLine{00853   \textcolor{keywordflow}{if} (fillLines)}
\DoxyCodeLine{00854     \textcolor{keywordflow}{for} (UINT i = 0; i < m\_strokes.size(); i++) \{}
\DoxyCodeLine{00855       \textcolor{keywordflow}{if} (!inCurrentGroup(i)) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00856 }
\DoxyCodeLine{00857       \mbox{\hyperlink{class_t_stroke}{TStroke}} *s = m\_strokes[i]-\/>m\_s;}
\DoxyCodeLine{00858 }
\DoxyCodeLine{00859       \textcolor{keywordflow}{if} ((!onlyUnfilled || s-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}() == 0) \&\&}
\DoxyCodeLine{00860           selArea.contains(s-\/>\mbox{\hyperlink{class_t_stroke_a456bedcae5e8af3a84823cb251584957}{getBBox}}())) \{}
\DoxyCodeLine{00861         s-\/>\mbox{\hyperlink{class_t_stroke_a33f59dfbed74b577700351eac8c2fc7b}{setStyle}}(newStyleId);}
\DoxyCodeLine{00862         hitSome = \textcolor{keyword}{true};}
\DoxyCodeLine{00863       \}}
\DoxyCodeLine{00864     \}}
\DoxyCodeLine{00865   \textcolor{keywordflow}{return} hitSome;}
\DoxyCodeLine{00866 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_ac702cfa245303bb9b92b1ac84ab99af3}\label{class_t_vector_image_1_1_imp_ac702cfa245303bb9b92b1ac84ab99af3}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!setFillData@{setFillData}}
\index{setFillData@{setFillData}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{setFillData()}{setFillData()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::set\+Fill\+Data (\begin{DoxyParamCaption}\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{struct_t_vector_image_1_1_intersection_branch}{TVector\+Image\+::\+Intersection\+Branch}}\mbox{[}$\,$\mbox{]}$>$ const \&}]{v,  }\item[{UINT}]{branch\+Count,  }\item[{bool}]{do\+Compute\+Regions = {\ttfamily true} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00739                            \{}
\DoxyCodeLine{00740 \textcolor{preprocessor}{\#ifdef \_DEBUG}}
\DoxyCodeLine{00741 \textcolor{comment}{/*ofstream of("{}C:\(\backslash\)\(\backslash\)temp\(\backslash\)\(\backslash\)fillDataIn.txt"{});}}
\DoxyCodeLine{00742 \textcolor{comment}{}}
\DoxyCodeLine{00743 \textcolor{comment}{for (UINT ii=0; ii<branchCount; ii++)}}
\DoxyCodeLine{00744 \textcolor{comment}{  \{}}
\DoxyCodeLine{00745 \textcolor{comment}{  of<<ii<<"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}<<endl;}}
\DoxyCodeLine{00746 \textcolor{comment}{  of<<"{}index:"{}<<v[ii].m\_strokeIndex<<endl;}}
\DoxyCodeLine{00747 \textcolor{comment}{  of<<"{}w:"{}<<v[ii].m\_w<<endl;}}
\DoxyCodeLine{00748 \textcolor{comment}{  of<<"{}curr inter:"{}<<v[ii].m\_currInter<<endl;}}
\DoxyCodeLine{00749 \textcolor{comment}{  of<<"{}next inter:"{}<<v[ii].m\_nextBranch<<endl;}}
\DoxyCodeLine{00750 \textcolor{comment}{  of<<"{}gettingOut:"{}<<((v[ii].m\_gettingOut)?"{}TRUE"{}:"{}FALSE"{})<<endl;}}
\DoxyCodeLine{00751 \textcolor{comment}{  of<<"{}colorId:"{}<<v[ii].m\_style<<endl;}}
\DoxyCodeLine{00752 \textcolor{comment}{  \}*/}}
\DoxyCodeLine{00753 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00754 }
\DoxyCodeLine{00755   \textcolor{keywordflow}{if} (branchCount == 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00756 }
\DoxyCodeLine{00757   \textcolor{comment}{//\{}}
\DoxyCodeLine{00758   \textcolor{comment}{// QMutexLocker sl(m\_mutex);}}
\DoxyCodeLine{00759 }
\DoxyCodeLine{00760   \mbox{\hyperlink{class_v_i_list}{VIList<Intersection>}} \&intList = m\_intersectionData-\/>m\_intList;}
\DoxyCodeLine{00761 }
\DoxyCodeLine{00762   clearPointerContainer(m\_regions);}
\DoxyCodeLine{00763   m\_regions.clear();}
\DoxyCodeLine{00764   intList.clear();}
\DoxyCodeLine{00765   \mbox{\hyperlink{class_intersection}{Intersection}} *currInt;}
\DoxyCodeLine{00766   \mbox{\hyperlink{class_intersected_stroke}{IntersectedStroke}} *currBranch;}
\DoxyCodeLine{00767 }
\DoxyCodeLine{00768   UINT size = v[branchCount -\/ 1].m\_currInter + 1;}
\DoxyCodeLine{00769   vector<UINT> branchesBefore(size);}
\DoxyCodeLine{00770 }
\DoxyCodeLine{00771   UINT i = 0;}
\DoxyCodeLine{00772   \textcolor{keywordflow}{for} (; i < branchCount; i++) \{}
\DoxyCodeLine{00773     \textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector_image_1_1_intersection_branch}{IntersectionBranch}} \&b = v[i];}
\DoxyCodeLine{00774     \textcolor{keywordflow}{if} (i == 0 || v[i].m\_currInter != v[i -\/ 1].m\_currInter) \{}
\DoxyCodeLine{00775       \textcolor{keywordflow}{if} (v[i].m\_currInter >=}
\DoxyCodeLine{00776           size)  \textcolor{comment}{// pezza per immagine corrotte...evito crash}}
\DoxyCodeLine{00777       \{}
\DoxyCodeLine{00778         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00779       \}}
\DoxyCodeLine{00780 }
\DoxyCodeLine{00781       branchesBefore[v[i].m\_currInter] = i;}
\DoxyCodeLine{00782 }
\DoxyCodeLine{00783       currInt = \textcolor{keyword}{new} \mbox{\hyperlink{class_intersection}{Intersection}}();}
\DoxyCodeLine{00784       intList.pushBack(currInt);}
\DoxyCodeLine{00785     \}}
\DoxyCodeLine{00786 }
\DoxyCodeLine{00787     currBranch = \textcolor{keyword}{new} \mbox{\hyperlink{class_intersected_stroke}{IntersectedStroke}}();}
\DoxyCodeLine{00788     currInt-\/>m\_strokeList.pushBack(currBranch);}
\DoxyCodeLine{00789 }
\DoxyCodeLine{00790     currBranch-\/>m\_edge.m\_styleId = b.m\_style;}
\DoxyCodeLine{00791     \textcolor{comment}{// assert(b.m\_style<100);}}
\DoxyCodeLine{00792     currBranch-\/>m\_edge.m\_index = b.m\_strokeIndex;}
\DoxyCodeLine{00793     \textcolor{keywordflow}{if} (b.m\_strokeIndex >= 0 \&\& b.m\_strokeIndex < m\_strokes.size())}
\DoxyCodeLine{00794       currBranch-\/>m\_edge.m\_s = m\_strokes[b.m\_strokeIndex]-\/>m\_s;}
\DoxyCodeLine{00795     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00796       currBranch-\/>m\_edge.m\_s = 0;}
\DoxyCodeLine{00797     currBranch-\/>m\_gettingOut = b.m\_gettingOut;}
\DoxyCodeLine{00798     currBranch-\/>m\_edge.m\_w0  = b.m\_w;}
\DoxyCodeLine{00799     \textcolor{keywordflow}{if} (b.m\_nextBranch < branchCount)}
\DoxyCodeLine{00800       currBranch-\/>m\_edge.m\_w1 = v[b.m\_nextBranch].m\_w;}
\DoxyCodeLine{00801     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00802       currBranch-\/>m\_edge.m\_w1 = 1.0;}
\DoxyCodeLine{00803     assert(currBranch-\/>m\_edge.m\_w0 >= -\/1e-\/8 \&\&}
\DoxyCodeLine{00804            currBranch-\/>m\_edge.m\_w0 <= 1 + 1e-\/8);}
\DoxyCodeLine{00805     assert(currBranch-\/>m\_edge.m\_w1 >= -\/1e-\/8 \&\&}
\DoxyCodeLine{00806            currBranch-\/>m\_edge.m\_w1 <= 1 + 1e-\/8);}
\DoxyCodeLine{00807 }
\DoxyCodeLine{00808     \textcolor{keywordflow}{if} (b.m\_nextBranch < i) \{}
\DoxyCodeLine{00809       \mbox{\hyperlink{class_intersection}{Intersection}} *p1;}
\DoxyCodeLine{00810       \mbox{\hyperlink{class_intersected_stroke}{IntersectedStroke}} *p2;}
\DoxyCodeLine{00811       p1 = intList.getElemAt(v[b.m\_nextBranch].m\_currInter);}
\DoxyCodeLine{00812 }
\DoxyCodeLine{00813       assert(b.m\_nextBranch -\/ branchesBefore[v[b.m\_nextBranch].m\_currInter] >=}
\DoxyCodeLine{00814              0);}
\DoxyCodeLine{00815       p2 = p1-\/>m\_strokeList.getElemAt(}
\DoxyCodeLine{00816           b.m\_nextBranch -\/ branchesBefore[v[b.m\_nextBranch].m\_currInter]);}
\DoxyCodeLine{00817 }
\DoxyCodeLine{00818       currBranch-\/>m\_nextIntersection = p1;}
\DoxyCodeLine{00819       currBranch-\/>m\_nextStroke       = p2;}
\DoxyCodeLine{00820       p2-\/>m\_nextIntersection         = currInt;}
\DoxyCodeLine{00821       p2-\/>m\_nextStroke               = currBranch;}
\DoxyCodeLine{00822 }
\DoxyCodeLine{00823       \textcolor{comment}{// if (currBranch == currInt-\/>m\_strokeList.begin())}}
\DoxyCodeLine{00824       \textcolor{comment}{//  currInt-\/>m\_intersection =}}
\DoxyCodeLine{00825       \textcolor{comment}{//  currBranch-\/>m\_edge.m\_s-\/>getPoint(currBranch-\/>m\_edge.m\_w0);}}
\DoxyCodeLine{00826 }
\DoxyCodeLine{00827       currInt-\/>m\_numInter++;}
\DoxyCodeLine{00828       p1-\/>m\_numInter++;}
\DoxyCodeLine{00829     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (b.m\_nextBranch == i)}
\DoxyCodeLine{00830       currBranch-\/>m\_nextIntersection = 0;}
\DoxyCodeLine{00831     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (b.m\_nextBranch == (std::numeric\_limits<UINT>::max)()) \{}
\DoxyCodeLine{00832       currBranch-\/>m\_nextIntersection = 0;}
\DoxyCodeLine{00833       currBranch-\/>m\_nextStroke       = 0;}
\DoxyCodeLine{00834     \}}
\DoxyCodeLine{00835 }
\DoxyCodeLine{00836     \textcolor{comment}{/* \{}}
\DoxyCodeLine{00837 \textcolor{comment}{assert(b.m\_nextBranch<branchCount);}}
\DoxyCodeLine{00838 \textcolor{comment}{assert(v[b.m\_nextBranch].m\_nextBranch==i);}}
\DoxyCodeLine{00839 \textcolor{comment}{\}*/}}
\DoxyCodeLine{00840 }
\DoxyCodeLine{00841     \textcolor{keywordflow}{if} (i == branchCount -\/ 1 || v[i].m\_currInter != v[i + 1].m\_currInter) \{}
\DoxyCodeLine{00842       \textcolor{keywordtype}{int} j = i;}
\DoxyCodeLine{00843       \textcolor{keywordflow}{while} (v[j].m\_strokeIndex < 0 \&\&}
\DoxyCodeLine{00844              ((j > 0 \&\& v[j].m\_currInter == v[j -\/ 1].m\_currInter) || j == 0))}
\DoxyCodeLine{00845         j-\/-\/;}
\DoxyCodeLine{00846       \textcolor{keywordflow}{if} (v[j].m\_strokeIndex >= 0 \&\& v[j].m\_strokeIndex < m\_strokes.size())}
\DoxyCodeLine{00847         currInt-\/>m\_intersection =}
\DoxyCodeLine{00848             m\_strokes[v[j].m\_strokeIndex]-\/>m\_s-\/>getPoint(v[j].m\_w);}
\DoxyCodeLine{00849     \}}
\DoxyCodeLine{00850   \}}
\DoxyCodeLine{00851 }
\DoxyCodeLine{00852   \textcolor{keywordflow}{for} (i = 0; i < m\_strokes.size(); i++) m\_strokes[i]-\/>m\_isNewForFill = \textcolor{keyword}{false};}
\DoxyCodeLine{00853 }
\DoxyCodeLine{00854   \textcolor{comment}{// computeRegions();}}
\DoxyCodeLine{00855 }
\DoxyCodeLine{00856   \mbox{\hyperlink{class_intersection}{Intersection}} *p1;}
\DoxyCodeLine{00857   \mbox{\hyperlink{class_intersected_stroke}{IntersectedStroke}} *p2;}
\DoxyCodeLine{00858 }
\DoxyCodeLine{00859   vector<UINT> toBeDeleted;}
\DoxyCodeLine{00860 }
\DoxyCodeLine{00861   \textcolor{keywordflow}{for} (p1 = intList.first(); p1; p1 = p1-\/>next())}
\DoxyCodeLine{00862     \textcolor{keywordflow}{for} (p2 = p1-\/>m\_strokeList.first(); p2; p2 = p2-\/>next()) \{}
\DoxyCodeLine{00863       \textcolor{keywordflow}{if} (p2-\/>m\_edge.m\_index < 0 \&\& !p2-\/>m\_edge.m\_s \&\&}
\DoxyCodeLine{00864           (p2-\/>m\_edge.m\_w0 == 0 || p2-\/>m\_edge.m\_w0 == 1)) \{}
\DoxyCodeLine{00865         p2-\/>m\_edge.m\_s = reconstructAutocloseStroke(p1, p2);}
\DoxyCodeLine{00866         \textcolor{keywordflow}{if} (p2-\/>m\_edge.m\_s)}
\DoxyCodeLine{00867           m\_intersectionData-\/>m\_autocloseMap[p2-\/>m\_edge.m\_index] =}
\DoxyCodeLine{00868               \textcolor{keyword}{new} \mbox{\hyperlink{class_v_i_stroke}{VIStroke}}(p2-\/>m\_edge.m\_s, \mbox{\hyperlink{class_t_group_id}{TGroupId}}());}
\DoxyCodeLine{00869         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00870           toBeDeleted.push\_back(p2-\/>m\_edge.m\_index);}
\DoxyCodeLine{00871       \}}
\DoxyCodeLine{00872     \}}
\DoxyCodeLine{00873 }
\DoxyCodeLine{00874   \textcolor{keywordflow}{for} (p1 = intList.first(); p1; p1 = p1-\/>next())}
\DoxyCodeLine{00875     \textcolor{keywordflow}{for} (p2 = p1-\/>m\_strokeList.first(); p2; p2 = p2-\/>next()) \{}
\DoxyCodeLine{00876       \textcolor{keywordflow}{if} (!p2-\/>m\_edge.m\_s \&\& p2-\/>m\_edge.m\_index < 0) \{}
\DoxyCodeLine{00877         \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *vs = m\_intersectionData-\/>m\_autocloseMap[p2-\/>m\_edge.m\_index];}
\DoxyCodeLine{00878         \textcolor{keywordflow}{if} (vs) \{}
\DoxyCodeLine{00879             p2-\/>m\_edge.m\_s =}
\DoxyCodeLine{00880               m\_intersectionData-\/>m\_autocloseMap[p2-\/>m\_edge.m\_index]-\/>m\_s;}
\DoxyCodeLine{00881 }
\DoxyCodeLine{00882           \textcolor{comment}{// TEdge\& e = it2-\/>m\_edge;}}
\DoxyCodeLine{00883           \textcolor{keywordflow}{if} (!p2-\/>m\_edge.m\_s) toBeDeleted.push\_back(p2-\/>m\_edge.m\_index);}
\DoxyCodeLine{00884         \}}
\DoxyCodeLine{00885       \}}
\DoxyCodeLine{00886     \}}
\DoxyCodeLine{00887 }
\DoxyCodeLine{00888   \textcolor{keywordflow}{for} (i = 0; i < toBeDeleted.size(); i++) eraseIntersection(toBeDeleted[i]);}
\DoxyCodeLine{00889 }
\DoxyCodeLine{00890   m\_areValidRegions = \textcolor{keyword}{false};}
\DoxyCodeLine{00891   \textcolor{comment}{//\}}}
\DoxyCodeLine{00892 }
\DoxyCodeLine{00893   \textcolor{keywordflow}{if} (doComputeRegions) computeRegions();}
\DoxyCodeLine{00894   \textcolor{comment}{// print(m\_intersectionData-\/>m\_intList, "{}C:\(\backslash\)\(\backslash\)temp\(\backslash\)\(\backslash\)intersectionDopoLoad.txt"{});}}
\DoxyCodeLine{00895 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_aa03d226c5158976ad4d598d6d5fa7e0b}\label{class_t_vector_image_1_1_imp_aa03d226c5158976ad4d598d6d5fa7e0b}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!splitStroke@{splitStroke}}
\index{splitStroke@{splitStroke}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{splitStroke()}{splitStroke()}}
{\footnotesize\ttfamily void TVector\+Image\+::\+Imp\+::split\+Stroke (\begin{DoxyParamCaption}\item[{int}]{stroke\+Index,  }\item[{const std\+::vector$<$ Double\+Pair $>$ \&}]{sorted\+WRanges }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01748                                                                  \{}
\DoxyCodeLine{01749   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{01750   \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *subV = 0;}
\DoxyCodeLine{01751 }
\DoxyCodeLine{01752   \textcolor{keywordflow}{if} (strokeIndex >= (\textcolor{keywordtype}{int})m\_strokes.size() || sortedWRanges.empty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01753 }
\DoxyCodeLine{01754   \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *vs     = m\_strokes[strokeIndex];}
\DoxyCodeLine{01755   \mbox{\hyperlink{class_t_group_id}{TGroupId}} groupId = vs-\/>m\_groupId;}
\DoxyCodeLine{01756 }
\DoxyCodeLine{01757   \textcolor{comment}{// se e' un self loop, alla fine non lo sara', e deve stare insieme}}
\DoxyCodeLine{01758   \textcolor{comment}{// alle stroke non loopate. sposto lo stroke se serve}}
\DoxyCodeLine{01759   \textcolor{comment}{/*}}
\DoxyCodeLine{01760 \textcolor{comment}{\{}}
\DoxyCodeLine{01761 \textcolor{comment}{if (vs-\/>m\_s-\/>isSelfLoop())}}
\DoxyCodeLine{01762 \textcolor{comment}{int up = strokeIndex+1;}}
\DoxyCodeLine{01763 \textcolor{comment}{while (up<(int)m\_strokes.size() \&\& m\_strokes[up]-\/>m\_s-\/>isSelfLoop())}}
\DoxyCodeLine{01764 \textcolor{comment}{up++;}}
\DoxyCodeLine{01765 \textcolor{comment}{int dn = strokeIndex-\/1;}}
\DoxyCodeLine{01766 \textcolor{comment}{while (dn>=0 \&\& m\_strokes[dn]-\/>m\_s-\/>isSelfLoop())}}
\DoxyCodeLine{01767 \textcolor{comment}{dn-\/-\/;}}
\DoxyCodeLine{01768 \textcolor{comment}{if ((up == m\_strokes.size() || up!=strokeIndex+1) \&\& (dn<0 ||}}
\DoxyCodeLine{01769 \textcolor{comment}{dn!=strokeIndex-\/1))}}
\DoxyCodeLine{01770 \textcolor{comment}{\{}}
\DoxyCodeLine{01771 \textcolor{comment}{if (up>=(int)m\_strokes.size())}}
\DoxyCodeLine{01772 \textcolor{comment}{\{}}
\DoxyCodeLine{01773 \textcolor{comment}{assert(dn>=0);}}
\DoxyCodeLine{01774 \textcolor{comment}{moveStroke(strokeIndex, dn+1);}}
\DoxyCodeLine{01775 \textcolor{comment}{strokeIndex = dn+1;}}
\DoxyCodeLine{01776 \textcolor{comment}{\}}}
\DoxyCodeLine{01777 \textcolor{comment}{else}}
\DoxyCodeLine{01778 \textcolor{comment}{\{}}
\DoxyCodeLine{01779 \textcolor{comment}{moveStroke(strokeIndex, up-\/1);}}
\DoxyCodeLine{01780 \textcolor{comment}{strokeIndex = up-\/1;}}
\DoxyCodeLine{01781 \textcolor{comment}{\}}}
\DoxyCodeLine{01782 \textcolor{comment}{\}}}
\DoxyCodeLine{01783 \textcolor{comment}{\}}}
\DoxyCodeLine{01784 \textcolor{comment}{*/}}
\DoxyCodeLine{01785   assert(vs == m\_strokes[strokeIndex]);}
\DoxyCodeLine{01786 }
\DoxyCodeLine{01787   \textcolor{keywordtype}{bool} toBeJoined =}
\DoxyCodeLine{01788       (vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a3565d6c34d3eb02fb1a6993ca626425c}{isSelfLoop}}() \&\& sortedWRanges.front().first == 0.0 \&\&}
\DoxyCodeLine{01789        sortedWRanges.back().second == 1.0);}
\DoxyCodeLine{01790 }
\DoxyCodeLine{01791   \textcolor{keywordtype}{int} styleId = vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_ab77068d7894a29cc1878e173f46ed785}{getStyle}}();}
\DoxyCodeLine{01792   TStroke::OutlineOptions oOptions(vs-\/>m\_s-\/>outlineOptions());}
\DoxyCodeLine{01793 }
\DoxyCodeLine{01794   m\_regions.clear();}
\DoxyCodeLine{01795 }
\DoxyCodeLine{01796   std::list<TEdge *> origEdgeList;  \textcolor{comment}{// metto al pizzo la edge std::list della}}
\DoxyCodeLine{01797                                     \textcolor{comment}{// stroke, perche' la erase intersection ne}}
\DoxyCodeLine{01798                                     \textcolor{comment}{// fara' scempio}}
\DoxyCodeLine{01799   std::list<TEdge *>::iterator it   = vs-\/>m\_edgeList.begin(),}
\DoxyCodeLine{01800                                it\_e = vs-\/>m\_edgeList.end();}
\DoxyCodeLine{01801   \textcolor{keywordflow}{for} (; it != it\_e; ++it) origEdgeList.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_t_edge}{TEdge}}(**it, \textcolor{keyword}{false}));}
\DoxyCodeLine{01802 }
\DoxyCodeLine{01803   removeStroke(strokeIndex, \textcolor{keyword}{false});}
\DoxyCodeLine{01804 }
\DoxyCodeLine{01805   std::vector<std::list<TEdge *>> edgeList(sortedWRanges.size());}
\DoxyCodeLine{01806   strokeIndex-\/-\/;}
\DoxyCodeLine{01807 }
\DoxyCodeLine{01808   \textcolor{keywordtype}{int} wSize = (int)sortedWRanges.size();}
\DoxyCodeLine{01809 }
\DoxyCodeLine{01810   \textcolor{keywordflow}{for} (i = 0; i < wSize; i++) \{}
\DoxyCodeLine{01811     assert(sortedWRanges[i].first < sortedWRanges[i].second);}
\DoxyCodeLine{01812     assert(i == wSize -\/ 1 ||}
\DoxyCodeLine{01813            sortedWRanges[i].second <= sortedWRanges[i + 1].first);}
\DoxyCodeLine{01814     assert(sortedWRanges[i].first >= 0 \&\& sortedWRanges[i].first <= 1);}
\DoxyCodeLine{01815     assert(sortedWRanges[i].second >= 0 \&\& sortedWRanges[i].second <= 1);}
\DoxyCodeLine{01816 }
\DoxyCodeLine{01817     subV = \textcolor{keyword}{new} \mbox{\hyperlink{class_v_i_stroke}{VIStroke}}(\textcolor{keyword}{new} \mbox{\hyperlink{class_t_stroke}{TStroke}}(), groupId);}
\DoxyCodeLine{01818     \mbox{\hyperlink{class_t_stroke}{TStroke}} s, dummy;}
\DoxyCodeLine{01819 }
\DoxyCodeLine{01820     \textcolor{keywordflow}{if} (areAlmostEqual(sortedWRanges[i].first, 0, 1e-\/4))}
\DoxyCodeLine{01821       s = *vs-\/>m\_s;}
\DoxyCodeLine{01822     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01823       vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a3de435d73bc9063b8667b590032e9eaa}{split}}(sortedWRanges[i].first, dummy, s);}
\DoxyCodeLine{01824 }
\DoxyCodeLine{01825     \textcolor{keywordtype}{double} lenAtW0 = vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}(sortedWRanges[i].first);}
\DoxyCodeLine{01826     \textcolor{keywordtype}{double} lenAtW1 = vs-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}(sortedWRanges[i].second);}
\DoxyCodeLine{01827     \textcolor{keywordtype}{double} newW1   = s.\mbox{\hyperlink{class_t_stroke_a45226c432c0d643e9985823abccdeda2}{getParameterAtLength}}(lenAtW1 -\/ lenAtW0);}
\DoxyCodeLine{01828 }
\DoxyCodeLine{01829     \textcolor{keywordflow}{if} (areAlmostEqual(newW1, 1.0, 1e-\/4))}
\DoxyCodeLine{01830       *(subV-\/>m\_s) = s;}
\DoxyCodeLine{01831     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01832       s.\mbox{\hyperlink{class_t_stroke_a3de435d73bc9063b8667b590032e9eaa}{split}}(newW1, *(subV-\/>m\_s), dummy);}
\DoxyCodeLine{01833 }
\DoxyCodeLine{01834     strokeIndex++;}
\DoxyCodeLine{01835     \textcolor{comment}{/*assert(m\_strokes[strokeIndex]-\/>m\_edgeList.empty());}}
\DoxyCodeLine{01836 \textcolor{comment}{assert(m\_strokes[strokeIndex-\/wSize+1]-\/>m\_edgeList.empty());*/}}
\DoxyCodeLine{01837 }
\DoxyCodeLine{01838     std::list<TEdge *>::const\_iterator it   = origEdgeList.begin(),}
\DoxyCodeLine{01839                                        it\_e = origEdgeList.end();}
\DoxyCodeLine{01840     \textcolor{keywordflow}{for} (; it != it\_e; ++it) \{}
\DoxyCodeLine{01841       \textcolor{keywordtype}{double} wMin = std::min((*it)-\/>m\_w0, (*it)-\/>m\_w1);}
\DoxyCodeLine{01842       \textcolor{keywordtype}{double} wMax = std::max((*it)-\/>m\_w0, (*it)-\/>m\_w1);}
\DoxyCodeLine{01843 }
\DoxyCodeLine{01844       \textcolor{keywordflow}{if} (wMin >= sortedWRanges[i].second || wMax <= sortedWRanges[i].first)}
\DoxyCodeLine{01845         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01846 }
\DoxyCodeLine{01847       \mbox{\hyperlink{class_t_edge}{TEdge}} *e = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_edge}{TEdge}}(**it, \textcolor{keyword}{false});}
\DoxyCodeLine{01848       \textcolor{keywordflow}{if} (wMin < sortedWRanges[i].first)}
\DoxyCodeLine{01849         wMin = 0.0;}
\DoxyCodeLine{01850       \textcolor{keywordflow}{else}}
\DoxyCodeLine{01851         wMin =}
\DoxyCodeLine{01852             recomputeW1(wMin, *(vs-\/>m\_s), *(subV-\/>m\_s), sortedWRanges[i].first);}
\DoxyCodeLine{01853 }
\DoxyCodeLine{01854       \textcolor{keywordflow}{if} (wMax > sortedWRanges[i].second)}
\DoxyCodeLine{01855         wMax = 1.0;}
\DoxyCodeLine{01856       \textcolor{keywordflow}{else}}
\DoxyCodeLine{01857         wMax =}
\DoxyCodeLine{01858             recomputeW1(wMax, *(vs-\/>m\_s), *(subV-\/>m\_s), sortedWRanges[i].first);}
\DoxyCodeLine{01859 }
\DoxyCodeLine{01860       \textcolor{keywordflow}{if} (e-\/>m\_w0 < e-\/>m\_w1)}
\DoxyCodeLine{01861         e-\/>m\_w0 = wMin, e-\/>m\_w1 = wMax;}
\DoxyCodeLine{01862       \textcolor{keywordflow}{else}}
\DoxyCodeLine{01863         e-\/>m\_w1 = wMin, e-\/>m\_w0 = wMax;}
\DoxyCodeLine{01864       e-\/>m\_r     = 0;}
\DoxyCodeLine{01865       e-\/>m\_s     = subV-\/>m\_s;}
\DoxyCodeLine{01866       e-\/>m\_index = strokeIndex;}
\DoxyCodeLine{01867       edgeList[i].push\_back(e);}
\DoxyCodeLine{01868     \}}
\DoxyCodeLine{01869     subV-\/>m\_edgeList.clear();}
\DoxyCodeLine{01870     insertStrokeAt(subV, strokeIndex);}
\DoxyCodeLine{01871     subV-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a33f59dfbed74b577700351eac8c2fc7b}{setStyle}}(styleId);}
\DoxyCodeLine{01872     subV-\/>m\_s-\/>outlineOptions() = oOptions;}
\DoxyCodeLine{01873   \}}
\DoxyCodeLine{01874 }
\DoxyCodeLine{01875   clearPointerContainer(origEdgeList);}
\DoxyCodeLine{01876 }
\DoxyCodeLine{01877   \textcolor{keywordflow}{if} (toBeJoined)  \textcolor{comment}{// la stroke e' un loop, quindi i due choncketti iniziali e}}
\DoxyCodeLine{01878                    \textcolor{comment}{// finali vanno joinati}}
\DoxyCodeLine{01879   \{}
\DoxyCodeLine{01880     \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *s0           = m\_strokes[strokeIndex];}
\DoxyCodeLine{01881     \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *s1           = m\_strokes[strokeIndex -\/ wSize + 1];}
\DoxyCodeLine{01882     std::list<TEdge *> \&l0 = edgeList.back();}
\DoxyCodeLine{01883     std::list<TEdge *> \&l1 = edgeList.front();}
\DoxyCodeLine{01884 }
\DoxyCodeLine{01885     \textcolor{comment}{// assert(s0-\/>m\_edgeList.empty());}}
\DoxyCodeLine{01886     \textcolor{comment}{// assert(s1-\/>m\_edgeList.empty());}}
\DoxyCodeLine{01887     removeStroke(strokeIndex -\/ wSize + 1, \textcolor{keyword}{false});}
\DoxyCodeLine{01888 }
\DoxyCodeLine{01889     strokeIndex-\/-\/;}
\DoxyCodeLine{01890     removeStroke(strokeIndex, \textcolor{keyword}{false});}
\DoxyCodeLine{01891 }
\DoxyCodeLine{01892     \mbox{\hyperlink{class_v_i_stroke}{VIStroke}} *s = \textcolor{keyword}{new} \mbox{\hyperlink{class_v_i_stroke}{VIStroke}}(joinStrokes(s0-\/>m\_s, s1-\/>m\_s), groupId);}
\DoxyCodeLine{01893     insertStrokeAt(s, strokeIndex);}
\DoxyCodeLine{01894 }
\DoxyCodeLine{01895     std::list<TEdge *>::iterator it = l0.begin(), it\_e = l0.end();}
\DoxyCodeLine{01896     \textcolor{keywordflow}{for} (; it != it\_e; ++it) \{}
\DoxyCodeLine{01897       (*it)-\/>m\_s     = s-\/>m\_s;}
\DoxyCodeLine{01898       (*it)-\/>m\_index = strokeIndex;}
\DoxyCodeLine{01899       (*it)-\/>m\_w0    = recomputeW2((*it)-\/>m\_w0, *(s0-\/>m\_s), *(s-\/>m\_s), 0);}
\DoxyCodeLine{01900       (*it)-\/>m\_w1    = recomputeW2((*it)-\/>m\_w1, *(s0-\/>m\_s), *(s-\/>m\_s), 0);}
\DoxyCodeLine{01901     \}}
\DoxyCodeLine{01902     it            = l1.begin();}
\DoxyCodeLine{01903     \textcolor{keywordtype}{double} length = s0-\/>m\_s-\/>\mbox{\hyperlink{class_t_stroke_a079a513cb8a60d9a759b4f0c8211eab4}{getLength}}();}
\DoxyCodeLine{01904     \textcolor{keywordflow}{while} (it != l1.end()) \{}
\DoxyCodeLine{01905       (*it)-\/>m\_s     = s-\/>m\_s;}
\DoxyCodeLine{01906       (*it)-\/>m\_index = strokeIndex;}
\DoxyCodeLine{01907       (*it)-\/>m\_w0    = recomputeW2((*it)-\/>m\_w0, *(s1-\/>m\_s), *(s-\/>m\_s), length);}
\DoxyCodeLine{01908       (*it)-\/>m\_w1    = recomputeW2((*it)-\/>m\_w1, *(s1-\/>m\_s), *(s-\/>m\_s), length);}
\DoxyCodeLine{01909       l0.push\_back(*it);}
\DoxyCodeLine{01910       it = l1.erase(it);}
\DoxyCodeLine{01911     \}}
\DoxyCodeLine{01912     assert(l1.empty());}
\DoxyCodeLine{01913     edgeList.erase(edgeList.begin());}
\DoxyCodeLine{01914 }
\DoxyCodeLine{01915     std::vector<DoublePair> appSortedWRanges;}
\DoxyCodeLine{01916 }
\DoxyCodeLine{01917     wSize-\/-\/;}
\DoxyCodeLine{01918 }
\DoxyCodeLine{01919     \textcolor{keyword}{delete} s0;}
\DoxyCodeLine{01920     \textcolor{keyword}{delete} s1;}
\DoxyCodeLine{01921   \}}
\DoxyCodeLine{01922 }
\DoxyCodeLine{01923   \textcolor{comment}{// checkIntersections();}}
\DoxyCodeLine{01924 }
\DoxyCodeLine{01925   \textcolor{comment}{// double len  = e-\/>m\_s-\/>getLength();}}
\DoxyCodeLine{01926   \textcolor{comment}{// if (recomputeRegions)}}
\DoxyCodeLine{01927 }
\DoxyCodeLine{01928   \textcolor{keywordflow}{if} (m\_computedAlmostOnce) \{}
\DoxyCodeLine{01929     computeRegions();}
\DoxyCodeLine{01930     assert((\textcolor{keywordtype}{int})edgeList.size() == wSize);}
\DoxyCodeLine{01931     assert((\textcolor{keywordtype}{int})m\_strokes.size() > strokeIndex);}
\DoxyCodeLine{01932 }
\DoxyCodeLine{01933     \textcolor{keywordflow}{for} (i = 0; i < wSize; i++)}
\DoxyCodeLine{01934       transferColors(edgeList[i],}
\DoxyCodeLine{01935                      m\_strokes[strokeIndex -\/ wSize + i + 1]-\/>m\_edgeList, \textcolor{keyword}{false},}
\DoxyCodeLine{01936                      \textcolor{keyword}{false}, \textcolor{keyword}{false});}
\DoxyCodeLine{01937   \}}
\DoxyCodeLine{01938 }
\DoxyCodeLine{01939   \textcolor{keywordflow}{for} (i = 0; i < wSize; i++) clearPointerContainer(edgeList[i]);}
\DoxyCodeLine{01940 }
\DoxyCodeLine{01941   \textcolor{keyword}{delete} vs;}
\DoxyCodeLine{01942 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a742868a839f75b422655de612f6c597e}\label{class_t_vector_image_1_1_imp_a742868a839f75b422655de612f6c597e}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_areValidRegions@{m\_areValidRegions}}
\index{m\_areValidRegions@{m\_areValidRegions}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_areValidRegions}{m\_areValidRegions}}
{\footnotesize\ttfamily bool TVector\+Image\+::\+Imp\+::m\+\_\+are\+Valid\+Regions}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a591f49ca31b9b38435c77dc02258437b}\label{class_t_vector_image_1_1_imp_a591f49ca31b9b38435c77dc02258437b}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_autocloseTolerance@{m\_autocloseTolerance}}
\index{m\_autocloseTolerance@{m\_autocloseTolerance}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_autocloseTolerance}{m\_autocloseTolerance}}
{\footnotesize\ttfamily double TVector\+Image\+::\+Imp\+::m\+\_\+autoclose\+Tolerance}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_ab1fdfd9937798da377f1b29df6619664}\label{class_t_vector_image_1_1_imp_ab1fdfd9937798da377f1b29df6619664}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_computedAlmostOnce@{m\_computedAlmostOnce}}
\index{m\_computedAlmostOnce@{m\_computedAlmostOnce}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_computedAlmostOnce}{m\_computedAlmostOnce}}
{\footnotesize\ttfamily bool TVector\+Image\+::\+Imp\+::m\+\_\+computed\+Almost\+Once}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a4d5ec8a8cfabacef13f200ae37701bd6}\label{class_t_vector_image_1_1_imp_a4d5ec8a8cfabacef13f200ae37701bd6}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_computeRegions@{m\_computeRegions}}
\index{m\_computeRegions@{m\_computeRegions}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_computeRegions}{m\_computeRegions}}
{\footnotesize\ttfamily bool TVector\+Image\+::\+Imp\+::m\+\_\+compute\+Regions}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_acb0ace23b059125042f4da1b303f6289}\label{class_t_vector_image_1_1_imp_acb0ace23b059125042f4da1b303f6289}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_insideGroup@{m\_insideGroup}}
\index{m\_insideGroup@{m\_insideGroup}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_insideGroup}{m\_insideGroup}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_group_id}{TGroup\+Id}} TVector\+Image\+::\+Imp\+::m\+\_\+inside\+Group}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a292c02b9a9d1a3953660fc703a55704e}\label{class_t_vector_image_1_1_imp_a292c02b9a9d1a3953660fc703a55704e}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_intersectionData@{m\_intersectionData}}
\index{m\_intersectionData@{m\_intersectionData}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_intersectionData}{m\_intersectionData}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_intersection_data}{Intersection\+Data}}$\ast$ TVector\+Image\+::\+Imp\+::m\+\_\+intersection\+Data}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_ae0fa34e04a16955f809e473d2ef01a65}\label{class_t_vector_image_1_1_imp_ae0fa34e04a16955f809e473d2ef01a65}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_justLoaded@{m\_justLoaded}}
\index{m\_justLoaded@{m\_justLoaded}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_justLoaded}{m\_justLoaded}}
{\footnotesize\ttfamily bool TVector\+Image\+::\+Imp\+::m\+\_\+just\+Loaded}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a0b4f803443f111f625920a9ccf47162e}\label{class_t_vector_image_1_1_imp_a0b4f803443f111f625920a9ccf47162e}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_maxGhostGroupId@{m\_maxGhostGroupId}}
\index{m\_maxGhostGroupId@{m\_maxGhostGroupId}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_maxGhostGroupId}{m\_maxGhostGroupId}}
{\footnotesize\ttfamily int TVector\+Image\+::\+Imp\+::m\+\_\+max\+Ghost\+Group\+Id}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_ae3f93c3346e715bfca2cafc359c0888b}\label{class_t_vector_image_1_1_imp_ae3f93c3346e715bfca2cafc359c0888b}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_maxGroupId@{m\_maxGroupId}}
\index{m\_maxGroupId@{m\_maxGroupId}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_maxGroupId}{m\_maxGroupId}}
{\footnotesize\ttfamily int TVector\+Image\+::\+Imp\+::m\+\_\+max\+Group\+Id}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_acd573df1bc0bc9033722228a1a883c1f}\label{class_t_vector_image_1_1_imp_acd573df1bc0bc9033722228a1a883c1f}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_minimizeEdges@{m\_minimizeEdges}}
\index{m\_minimizeEdges@{m\_minimizeEdges}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_minimizeEdges}{m\_minimizeEdges}}
{\footnotesize\ttfamily bool TVector\+Image\+::\+Imp\+::m\+\_\+minimize\+Edges}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a2b1b2ec6f2e33abb0cabf186cd9db2b0}\label{class_t_vector_image_1_1_imp_a2b1b2ec6f2e33abb0cabf186cd9db2b0}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_mutex@{m\_mutex}}
\index{m\_mutex@{m\_mutex}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_mutex}{m\_mutex}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_thread_1_1_mutex}{TThread\+::\+Mutex}}$\ast$ TVector\+Image\+::\+Imp\+::m\+\_\+mutex}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_ae690c344676e934fdb1ae446efc91ca6}\label{class_t_vector_image_1_1_imp_ae690c344676e934fdb1ae446efc91ca6}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_notIntersectingStrokes@{m\_notIntersectingStrokes}}
\index{m\_notIntersectingStrokes@{m\_notIntersectingStrokes}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_notIntersectingStrokes}{m\_notIntersectingStrokes}}
{\footnotesize\ttfamily bool TVector\+Image\+::\+Imp\+::m\+\_\+not\+Intersecting\+Strokes}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a0533ef826126028ce3ccc89b8c1b9eca}\label{class_t_vector_image_1_1_imp_a0533ef826126028ce3ccc89b8c1b9eca}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_regions@{m\_regions}}
\index{m\_regions@{m\_regions}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_regions}{m\_regions}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{class_t_region}{TRegion}} $\ast$$>$ TVector\+Image\+::\+Imp\+::m\+\_\+regions}

\mbox{\Hypertarget{class_t_vector_image_1_1_imp_a59e2791fe265b9c1be689a0db4f414b2}\label{class_t_vector_image_1_1_imp_a59e2791fe265b9c1be689a0db4f414b2}} 
\index{TVectorImage::Imp@{TVectorImage::Imp}!m\_strokes@{m\_strokes}}
\index{m\_strokes@{m\_strokes}!TVectorImage::Imp@{TVectorImage::Imp}}
\doxysubsubsection{\texorpdfstring{m\_strokes}{m\_strokes}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{class_v_i_stroke}{VIStroke}} $\ast$$>$ TVector\+Image\+::\+Imp\+::m\+\_\+strokes}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/common/tvectorimage/tvectorimage\+P.\+h\item 
E\+:/opentoonz/toonz/sources/common/tvectorimage/tcomputeregions.\+cpp\item 
E\+:/opentoonz/toonz/sources/common/tvectorimage/tregionutil.\+cpp\item 
E\+:/opentoonz/toonz/sources/common/tvectorimage/tvectorimage.\+cpp\end{DoxyCompactItemize}
