\hypertarget{class_c_pattern}{}\doxysection{CPattern Class Reference}
\label{class_c_pattern}\index{CPattern@{CPattern}}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_c_pattern_a7cc244bda75af4aa608e34d7d06fd19f}{CPattern}} (\mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} $\ast$img\+Contour)
\item 
void \mbox{\hyperlink{class_c_pattern_ab3575418f53e804d26ec6134ee5f317d}{rotate}} (const double angle)
\item 
void \mbox{\hyperlink{class_c_pattern_a773e2517fb266b4ce5380aef12df2960}{optimalize\+Size}} ()
\item 
{\footnotesize template$<$class P $>$ }\\void \mbox{\hyperlink{class_c_pattern_a89d3b352456b45017b1a5bb7916946ad}{test}} (\mbox{\hyperlink{class_c_s_t_col_sel_pic}{CSTCol\+Sel\+Pic}}$<$ P $>$ \&pic, \mbox{\hyperlink{struct___i___p_i_x_e_l}{I\+\_\+\+PIXEL}} \&e\+Col, int ox, int oy)
\item 
{\footnotesize template$<$class P $>$ }\\void \mbox{\hyperlink{class_c_pattern_a59ab56bd829d8608c926c56d92c9305c}{map\+It}} (\mbox{\hyperlink{class_c_s_t_col_sel_pic}{CSTCol\+Sel\+Pic}}$<$ P $>$ \&pic, const \mbox{\hyperlink{class_c_s_t_col_sel_pic}{CSTCol\+Sel\+Pic}}$<$ P $>$ \&ori\+Pic, const int xx, const int yy, const double scale, const double rot, const bool is\+Use\+Ori\+Color, const bool is\+Include\+Alpha)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_c_pattern_ab16262759a5112f29138fc1fe4acaa25}\label{class_c_pattern_ab16262759a5112f29138fc1fe4acaa25}} 
\index{CPattern@{CPattern}!CPattern@{CPattern}}
\index{CPattern@{CPattern}!CPattern@{CPattern}}
\doxysubsubsection{\texorpdfstring{CPattern()}{CPattern()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily CPattern\+::\+CPattern (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00035 : m\_lX(0), m\_lY(0) \{ m\_fn[0] = \textcolor{charliteral}{'\(\backslash\)0'}; \};}

\end{DoxyCode}
\mbox{\Hypertarget{class_c_pattern_a7cc244bda75af4aa608e34d7d06fd19f}\label{class_c_pattern_a7cc244bda75af4aa608e34d7d06fd19f}} 
\index{CPattern@{CPattern}!CPattern@{CPattern}}
\index{CPattern@{CPattern}!CPattern@{CPattern}}
\doxysubsubsection{\texorpdfstring{CPattern()}{CPattern()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily CPattern\+::\+CPattern (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct___r_a_s_t_e_r}{RASTER}} $\ast$}]{img\+Contour }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00033                                      : m\_lX(0), m\_lY(0) \{}
\DoxyCodeLine{00034   \textcolor{keywordflow}{if} (!readPattern(imgContour)) \{}
\DoxyCodeLine{00035     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_s_file_read_error}{SFileReadError}}();}
\DoxyCodeLine{00036   \}}
\DoxyCodeLine{00037   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{00038     optimalizeSize();}
\DoxyCodeLine{00039   \} \textcolor{keywordflow}{catch} (\mbox{\hyperlink{class_s_mem_alloc_error}{SMemAllocError}}) \{}
\DoxyCodeLine{00040     \textcolor{keywordflow}{throw};}
\DoxyCodeLine{00041   \}}
\DoxyCodeLine{00042 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_c_pattern_afe550cd86aadd1cca54b6bb763209b9a}\label{class_c_pattern_afe550cd86aadd1cca54b6bb763209b9a}} 
\index{CPattern@{CPattern}!````~CPattern@{$\sim$CPattern}}
\index{````~CPattern@{$\sim$CPattern}!CPattern@{CPattern}}
\doxysubsubsection{\texorpdfstring{$\sim$CPattern()}{~CPattern()}}
{\footnotesize\ttfamily CPattern\+::$\sim$\+CPattern (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00044 \{ null(); \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_c_pattern_a59ab56bd829d8608c926c56d92c9305c}\label{class_c_pattern_a59ab56bd829d8608c926c56d92c9305c}} 
\index{CPattern@{CPattern}!mapIt@{mapIt}}
\index{mapIt@{mapIt}!CPattern@{CPattern}}
\doxysubsubsection{\texorpdfstring{mapIt()}{mapIt()}}
{\footnotesize\ttfamily template$<$class P $>$ \\
void CPattern\+::map\+It (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_c_s_t_col_sel_pic}{CSTCol\+Sel\+Pic}}$<$ P $>$ \&}]{pic,  }\item[{const \mbox{\hyperlink{class_c_s_t_col_sel_pic}{CSTCol\+Sel\+Pic}}$<$ P $>$ \&}]{ori\+Pic,  }\item[{const int}]{xx,  }\item[{const int}]{yy,  }\item[{const double}]{scale,  }\item[{const double}]{rot,  }\item[{const bool}]{is\+Use\+Ori\+Color,  }\item[{const bool}]{is\+Include\+Alpha }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00071                                                                   \{}
\DoxyCodeLine{00072     \textcolor{keywordflow}{if} (scale < 0.01) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00073     \textcolor{keywordflow}{if} (xx < 0 || yy < 0 || xx >= pic.m\_lX || yy >= pic.m\_lY) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00074 }
\DoxyCodeLine{00075     \textcolor{keywordtype}{double} sDiag = scale * sqrt(\textcolor{keywordtype}{double}(m\_lX * m\_lX + m\_lY * m\_lY));}
\DoxyCodeLine{00076     \textcolor{keywordtype}{int} iSDiag   = (int)sDiag + 1;}
\DoxyCodeLine{00077     \textcolor{keywordtype}{int} iSDiag2  = iSDiag / 2 + 1;}
\DoxyCodeLine{00078     \textcolor{keywordflow}{if} (iSDiag <= 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00079 }
\DoxyCodeLine{00080     \textcolor{keywordtype}{double} invScale  = 1.0 / scale;}
\DoxyCodeLine{00081     \textcolor{keywordtype}{double} co        = cos(-\/DEG2RAD(rot));}
\DoxyCodeLine{00082     \textcolor{keywordtype}{double} si        = sin(-\/DEG2RAD(rot));}
\DoxyCodeLine{00083     \textcolor{keywordtype}{bool} isUC        = pic.getType() == ST\_RGBM ? true : \textcolor{keyword}{false};}
\DoxyCodeLine{00084     \textcolor{keywordtype}{double} maxPixVal = isUC ? 255.0 : 65535.0;}
\DoxyCodeLine{00085     \textcolor{keywordtype}{double} ddiv      = 1.0 / (maxPixVal * 255.0);}
\DoxyCodeLine{00086     \textcolor{keywordtype}{int} yBeg         = std::max(yy -\/ iSDiag2, 0);}
\DoxyCodeLine{00087     \textcolor{keywordtype}{int} yEnd         = std::min(yy + iSDiag2, pic.m\_lY -\/ 1);}
\DoxyCodeLine{00088     \textcolor{keywordtype}{int} xBeg         = std::max(xx -\/ iSDiag2, 0);}
\DoxyCodeLine{00089     \textcolor{keywordtype}{int} xEnd         = std::min(xx + iSDiag2, pic.m\_lX -\/ 1);}
\DoxyCodeLine{00090     \textcolor{keywordtype}{double} lxm105    = (double)(m\_lX -\/ 1) * 0.5;}
\DoxyCodeLine{00091     \textcolor{keywordtype}{double} lym105    = (double)(m\_lY -\/ 1) * 0.5;}
\DoxyCodeLine{00092 }
\DoxyCodeLine{00093     \mbox{\hyperlink{struct___i___p_i_x_e_l}{I\_PIXEL}} eCol;}
\DoxyCodeLine{00094     memset(\&eCol, 0, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct___i___p_i_x_e_l}{I\_PIXEL}}));}
\DoxyCodeLine{00095     \textcolor{keywordflow}{if} (isUseOriColor) \{}
\DoxyCodeLine{00096       P *pOriPic = oriPic.m\_pic + yy * oriPic.m\_lX + xx;}
\DoxyCodeLine{00097       eCol.r     = (int)pOriPic-\/>r;}
\DoxyCodeLine{00098       eCol.g     = (\textcolor{keywordtype}{int})pOriPic-\/>g;}
\DoxyCodeLine{00099       eCol.b     = (int)pOriPic-\/>b;}
\DoxyCodeLine{00100       if (isIncludeAlpha)}
\DoxyCodeLine{00101         eCol.m = (int)pOriPic-\/>m;}
\DoxyCodeLine{00102       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00103         if ((\textcolor{keywordtype}{int})pOriPic-\/>m != 255)}
\DoxyCodeLine{00104           eCol.m = 0;}
\DoxyCodeLine{00105         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00106           eCol.m = 255;}
\DoxyCodeLine{00107       \}}
\DoxyCodeLine{00108     \}}
\DoxyCodeLine{00109     \textcolor{keywordtype}{int} oriMatte = (int)((oriPic.m\_pic + yy * oriPic.m\_lX + xx)-\/>m);}
\DoxyCodeLine{00110     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = yBeg; y <= yEnd; y++)}
\DoxyCodeLine{00111       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = xBeg; x <= xEnd; x++)}
\DoxyCodeLine{00112         \textcolor{keywordflow}{if} (x >= 0 \&\& x < pic.m\_lX \&\& y >= 0 \&\& y < pic.m\_lY) \{}
\DoxyCodeLine{00113           \textcolor{comment}{// -\/-\/-\/-\/-\/ Calculates the pattern pixel coordinates -\/-\/-\/-\/-\/}}
\DoxyCodeLine{00114           \mbox{\hyperlink{struct___u_c___p_i_x_e_l}{UC\_PIXEL}} *pucp = 0;}
\DoxyCodeLine{00115           \textcolor{comment}{//                    getMapPixel(x-\/xx,y-\/yy,invScale,si,co,pucp);}}
\DoxyCodeLine{00116           \textcolor{keywordtype}{double} dxx  = (double)(x -\/ xx) * invScale;}
\DoxyCodeLine{00117           \textcolor{keywordtype}{double} dyy  = (double)(y -\/ yy) * invScale;}
\DoxyCodeLine{00118           \textcolor{keywordtype}{double} d2xx = (dxx * co -\/ dyy * si) + lxm105;}
\DoxyCodeLine{00119           \textcolor{keywordtype}{double} d2yy = (dxx * si + dyy * co) + lym105;}
\DoxyCodeLine{00120           \textcolor{keywordtype}{int} x1      = I\_ROUND(d2xx);}
\DoxyCodeLine{00121           \textcolor{keywordtype}{int} y1      = I\_ROUND(d2yy);}
\DoxyCodeLine{00122           \textcolor{keywordflow}{if} (x1 >= 0 \&\& x1 < m\_lX \&\& y1 >= 0 \&\& y1 < m\_lY) \{}
\DoxyCodeLine{00123             pucp = m\_pat.get() + y1 * m\_lX + x1;}
\DoxyCodeLine{00124             pucp = (pucp-\/>m) == (UCHAR)0 ? 0 : pucp;}
\DoxyCodeLine{00125           \}}
\DoxyCodeLine{00126           \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00127           \textcolor{keywordflow}{if} (pucp) \{}
\DoxyCodeLine{00128             \textcolor{keywordtype}{int} xy  = y * pic.m\_lX + x;}
\DoxyCodeLine{00129             P *pPic = pic.m\_pic + xy;}
\DoxyCodeLine{00130             \textcolor{keywordflow}{if} (!isUseOriColor) \{}
\DoxyCodeLine{00131               eCol.r = (int)pucp-\/>r;}
\DoxyCodeLine{00132               eCol.g = (\textcolor{keywordtype}{int})pucp-\/>g;}
\DoxyCodeLine{00133               eCol.b = (int)pucp-\/>b;}
\DoxyCodeLine{00134               if (isIncludeAlpha)}
\DoxyCodeLine{00135                 eCol.m = oriMatte;}
\DoxyCodeLine{00136               \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00137                 \textcolor{keywordflow}{if} (oriMatte != 255)}
\DoxyCodeLine{00138                   eCol.m = 0;}
\DoxyCodeLine{00139                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{00140                   eCol.m = 255;}
\DoxyCodeLine{00141               \}}
\DoxyCodeLine{00142 }
\DoxyCodeLine{00143               \textcolor{keywordflow}{if} (!isUC) \{}
\DoxyCodeLine{00144                 eCol.r = PIX\_USHORT\_FROM\_BYTE((UCHAR)eCol.r);}
\DoxyCodeLine{00145                 eCol.g = PIX\_USHORT\_FROM\_BYTE((UCHAR)eCol.g);}
\DoxyCodeLine{00146                 eCol.b = PIX\_USHORT\_FROM\_BYTE((UCHAR)eCol.b);}
\DoxyCodeLine{00147               \}}
\DoxyCodeLine{00148             \}}
\DoxyCodeLine{00149             \textcolor{keywordtype}{double} q  = ((double)pucp-\/>m) * ((double)eCol.m) * ddiv;}
\DoxyCodeLine{00150             \textcolor{keywordtype}{double} qq = 1.0 -\/ q;}
\DoxyCodeLine{00151             \textcolor{keywordtype}{double} r  = qq * (double)pPic-\/>r + q * (\textcolor{keywordtype}{double})eCol.r;}
\DoxyCodeLine{00152             \textcolor{keywordtype}{double} g  = qq * (double)pPic-\/>g + q * (\textcolor{keywordtype}{double})eCol.g;}
\DoxyCodeLine{00153             \textcolor{keywordtype}{double} b  = qq * (double)pPic-\/>b + q * (\textcolor{keywordtype}{double})eCol.b;}
\DoxyCodeLine{00154             \textcolor{keywordtype}{double} m  = qq * (double)pPic-\/>m + q * (\textcolor{keywordtype}{double})eCol.m;}
\DoxyCodeLine{00155             r         = D\_CUT(r, 0.0, maxPixVal);}
\DoxyCodeLine{00156             g         = D\_CUT(g, 0.0, maxPixVal);}
\DoxyCodeLine{00157             b         = D\_CUT(b, 0.0, maxPixVal);}
\DoxyCodeLine{00158             m         = D\_CUT(m, 0.0, maxPixVal);}
\DoxyCodeLine{00159             \textcolor{keywordflow}{if} (isUC) \{}
\DoxyCodeLine{00160               pPic-\/>r = UC\_ROUND(r);}
\DoxyCodeLine{00161               pPic-\/>g = UC\_ROUND(g);}
\DoxyCodeLine{00162               pPic-\/>b = UC\_ROUND(b);}
\DoxyCodeLine{00163               pPic-\/>m = UC\_ROUND(m);}
\DoxyCodeLine{00164             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00165               pPic-\/>r = (UCHAR)US\_ROUND(r);}
\DoxyCodeLine{00166               pPic-\/>g = (UCHAR)US\_ROUND(g);}
\DoxyCodeLine{00167               pPic-\/>b = (UCHAR)US\_ROUND(b);}
\DoxyCodeLine{00168               pPic-\/>m = (UCHAR)US\_ROUND(m);}
\DoxyCodeLine{00169             \}}
\DoxyCodeLine{00170           \}}
\DoxyCodeLine{00171         \}}
\DoxyCodeLine{00172   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_c_pattern_a773e2517fb266b4ce5380aef12df2960}\label{class_c_pattern_a773e2517fb266b4ce5380aef12df2960}} 
\index{CPattern@{CPattern}!optimalizeSize@{optimalizeSize}}
\index{optimalizeSize@{optimalizeSize}!CPattern@{CPattern}}
\doxysubsubsection{\texorpdfstring{optimalizeSize()}{optimalizeSize()}}
{\footnotesize\ttfamily void CPattern\+::optimalize\+Size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00195                               \{}
\DoxyCodeLine{00196   \mbox{\hyperlink{struct_s_r_e_c_t}{SRECT}} bb;}
\DoxyCodeLine{00197 }
\DoxyCodeLine{00198   getBBox(bb);}
\DoxyCodeLine{00199   \textcolor{keywordflow}{if} (bb.x0 <= bb.x1 \&\& bb.y0 <= bb.y1) \{}
\DoxyCodeLine{00200     \textcolor{keywordtype}{int} nLX = bb.x1 -\/ bb.x0 + 1;}
\DoxyCodeLine{00201     \textcolor{keywordtype}{int} nLY = bb.y1 -\/ bb.y0 + 1;}
\DoxyCodeLine{00202     std::unique\_ptr<UC\_PIXEL[]> nPat(\textcolor{keyword}{new} \mbox{\hyperlink{struct___u_c___p_i_x_e_l}{UC\_PIXEL}}[nLX * nLY]);}
\DoxyCodeLine{00203     \textcolor{keywordflow}{if} (!nPat) \{}
\DoxyCodeLine{00204       \textcolor{keywordtype}{char} s[200];}
\DoxyCodeLine{00205       snprintf(s, \textcolor{keyword}{sizeof}(s), \textcolor{stringliteral}{"{}in Pattern Optimalization \(\backslash\)n"{}});}
\DoxyCodeLine{00206       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_s_mem_alloc_error}{SMemAllocError}}(s);}
\DoxyCodeLine{00207     \}}
\DoxyCodeLine{00208     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = bb.y0; y <= bb.y1; y++)}
\DoxyCodeLine{00209       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = bb.x0; x <= bb.x1; x++) \{}
\DoxyCodeLine{00210         \mbox{\hyperlink{struct___u_c___p_i_x_e_l}{UC\_PIXEL}} *pPat  = m\_pat.get() + y * m\_lX + x;}
\DoxyCodeLine{00211         \mbox{\hyperlink{struct___u_c___p_i_x_e_l}{UC\_PIXEL}} *pNPat = nPat.get() + (y -\/ bb.y0) * nLX + x -\/ bb.x0;}
\DoxyCodeLine{00212         pNPat-\/>r        = pPat-\/>r;}
\DoxyCodeLine{00213         pNPat-\/>g        = pPat-\/>g;}
\DoxyCodeLine{00214         pNPat-\/>b        = pPat-\/>b;}
\DoxyCodeLine{00215         pNPat-\/>m        = pPat-\/>m;}
\DoxyCodeLine{00216       \}}
\DoxyCodeLine{00217     m\_lX  = nLX;}
\DoxyCodeLine{00218     m\_lY  = nLY;}
\DoxyCodeLine{00219     m\_pat = std::move(nPat);}
\DoxyCodeLine{00220   \}}
\DoxyCodeLine{00221 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_c_pattern_ab3575418f53e804d26ec6134ee5f317d}\label{class_c_pattern_ab3575418f53e804d26ec6134ee5f317d}} 
\index{CPattern@{CPattern}!rotate@{rotate}}
\index{rotate@{rotate}!CPattern@{CPattern}}
\doxysubsubsection{\texorpdfstring{rotate()}{rotate()}}
{\footnotesize\ttfamily void CPattern\+::rotate (\begin{DoxyParamCaption}\item[{const double}]{angle }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00229                                         \{}
\DoxyCodeLine{00230   \textcolor{keywordflow}{if} (m\_lX <= 0 || m\_lY <= 0 || !m\_pat) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00231 }
\DoxyCodeLine{00232   \textcolor{keywordtype}{double} sDiag = sqrt(\textcolor{keywordtype}{double}(m\_lX * m\_lX + m\_lY * m\_lY));}
\DoxyCodeLine{00233   \textcolor{keywordtype}{int} nLXY     = (int)sDiag + 5;}
\DoxyCodeLine{00234   \textcolor{keywordtype}{int} xx       = nLXY / 2;}
\DoxyCodeLine{00235   \textcolor{keywordtype}{int} yy       = xx;}
\DoxyCodeLine{00236   \textcolor{keywordtype}{double} co    = cos(-\/DEG2RAD(angle));}
\DoxyCodeLine{00237   \textcolor{keywordtype}{double} si    = sin(-\/DEG2RAD(angle));}
\DoxyCodeLine{00238 }
\DoxyCodeLine{00239   std::unique\_ptr<UC\_PIXEL[]> nPat(\textcolor{keyword}{new} \mbox{\hyperlink{struct___u_c___p_i_x_e_l}{UC\_PIXEL}}[nLXY * nLXY]);}
\DoxyCodeLine{00240   \textcolor{keywordflow}{if} (!nPat) \{}
\DoxyCodeLine{00241     \textcolor{keywordtype}{char} s[200];}
\DoxyCodeLine{00242     snprintf(s, \textcolor{keyword}{sizeof}(s), \textcolor{stringliteral}{"{}in Pattern Rotation \(\backslash\)n"{}});}
\DoxyCodeLine{00243     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_s_mem_alloc_error}{SMemAllocError}}(s);}
\DoxyCodeLine{00244   \}}
\DoxyCodeLine{00245   eraseBuffer(nLXY, nLXY, nPat.get());}
\DoxyCodeLine{00246 }
\DoxyCodeLine{00247   \mbox{\hyperlink{struct___u_c___p_i_x_e_l}{UC\_PIXEL}} *pNPat = nPat.get();}
\DoxyCodeLine{00248   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < nLXY; y++)}
\DoxyCodeLine{00249     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = 0; x < nLXY; x++, pNPat++) \{}
\DoxyCodeLine{00250       \mbox{\hyperlink{struct___u_c___p_i_x_e_l}{UC\_PIXEL}} *pucp = 0;}
\DoxyCodeLine{00251       getMapPixel(x -\/ xx, y -\/ yy, 1.0, si, co, pucp);}
\DoxyCodeLine{00252       \textcolor{keywordflow}{if} (pucp) \{}
\DoxyCodeLine{00253         pNPat-\/>r = pucp-\/>r;}
\DoxyCodeLine{00254         pNPat-\/>g = pucp-\/>g;}
\DoxyCodeLine{00255         pNPat-\/>b = pucp-\/>b;}
\DoxyCodeLine{00256         pNPat-\/>m = pucp-\/>m;}
\DoxyCodeLine{00257       \}}
\DoxyCodeLine{00258     \}}
\DoxyCodeLine{00259   m\_lX = m\_lY = nLXY;}
\DoxyCodeLine{00260   m\_pat       = std::move(nPat);}
\DoxyCodeLine{00261 }
\DoxyCodeLine{00262   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{00263     optimalizeSize();}
\DoxyCodeLine{00264   \} \textcolor{keywordflow}{catch} (\mbox{\hyperlink{class_s_mem_alloc_error}{SMemAllocError}}) \{}
\DoxyCodeLine{00265     \textcolor{keywordflow}{throw};}
\DoxyCodeLine{00266   \}}
\DoxyCodeLine{00267 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_c_pattern_a89d3b352456b45017b1a5bb7916946ad}\label{class_c_pattern_a89d3b352456b45017b1a5bb7916946ad}} 
\index{CPattern@{CPattern}!test@{test}}
\index{test@{test}!CPattern@{CPattern}}
\doxysubsubsection{\texorpdfstring{test()}{test()}}
{\footnotesize\ttfamily template$<$class P $>$ \\
void CPattern\+::test (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_c_s_t_col_sel_pic}{CSTCol\+Sel\+Pic}}$<$ P $>$ \&}]{pic,  }\item[{\mbox{\hyperlink{struct___i___p_i_x_e_l}{I\+\_\+\+PIXEL}} \&}]{e\+Col,  }\item[{int}]{ox,  }\item[{int}]{oy }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00042                                                                  \{}
\DoxyCodeLine{00043     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < m\_lY; y++)}
\DoxyCodeLine{00044       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = 0; x < m\_lX; x++)}
\DoxyCodeLine{00045         \textcolor{keywordflow}{if} ((x + ox) < pic.m\_lX \&\& (y + oy) < pic.m\_lY) \{}
\DoxyCodeLine{00046           P *p         = pic.m\_pic + (y + oy) * pic.m\_lX + x + ox;}
\DoxyCodeLine{00047           \mbox{\hyperlink{struct___u_c___p_i_x_e_l}{UC\_PIXEL}} *pP = m\_pat.get() + y * m\_lX + x;}
\DoxyCodeLine{00048 }
\DoxyCodeLine{00049           \textcolor{keywordflow}{if} (pP-\/>m > (UCHAR)0) \{}
\DoxyCodeLine{00050             \textcolor{keywordtype}{double} q = ((double)(pP-\/>m) / 255.0) * ((\textcolor{keywordtype}{double})eCol.m / 255.0);}
\DoxyCodeLine{00051             \textcolor{keywordtype}{double} r = (1.0 -\/ q) * (\textcolor{keywordtype}{double})p-\/>r + q * (double)eCol.r;}
\DoxyCodeLine{00052             \textcolor{keywordtype}{double} g = (1.0 -\/ q) * (double)p-\/>g + q * (\textcolor{keywordtype}{double})eCol.g;}
\DoxyCodeLine{00053             \textcolor{keywordtype}{double} b = (1.0 -\/ q) * (\textcolor{keywordtype}{double})p-\/>b + q * (double)eCol.b;}
\DoxyCodeLine{00054 }
\DoxyCodeLine{00055             r = D\_CUT\_0\_255(r);}
\DoxyCodeLine{00056             g = D\_CUT\_0\_255(g);}
\DoxyCodeLine{00057             b = D\_CUT\_0\_255(b);}
\DoxyCodeLine{00058 }
\DoxyCodeLine{00059             p-\/>r = UC\_ROUND(r);}
\DoxyCodeLine{00060             p-\/>g = UC\_ROUND(g);}
\DoxyCodeLine{00061             p-\/>b = UC\_ROUND(b);}
\DoxyCodeLine{00062             p-\/>m = pP-\/>m;}
\DoxyCodeLine{00063           \}}
\DoxyCodeLine{00064         \}}
\DoxyCodeLine{00065   \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonzlib/sandor\+\_\+fxs/Pattern.\+h\item 
E\+:/opentoonz/toonz/sources/toonzlib/sandor\+\_\+fxs/Pattern.\+cpp\end{DoxyCompactItemize}
