\hypertarget{class_raster_edge_evaluator}{}\doxysection{Raster\+Edge\+Evaluator\texorpdfstring{$<$}{<} Ran\+It \texorpdfstring{$>$}{>} Class Template Reference}
\label{class_raster_edge_evaluator}\index{RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}}


This class implements an evaluator for tcg\textquotesingle{}s sequential reduction algorithm that can be used to simplify the borders extracted from a raster image under a specified tolerance factor. This is typically used as a step in polygonal-\/based image vectorization processes.  




{\ttfamily \#include $<$raster\+\_\+edge\+\_\+evaluator.\+h$>$}

Inheritance diagram for Raster\+Edge\+Evaluator\texorpdfstring{$<$}{<} Ran\+It \texorpdfstring{$>$}{>}\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_raster_edge_evaluator}
\end{center}
\end{figure}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1_standard_deviation_evaluator}{tcg\+::polyline\+\_\+ops\+::\+Standard\+Deviation\+Evaluator}}$<$ Ran\+It $>$\+::iterator\+\_\+type \mbox{\hyperlink{class_raster_edge_evaluator_a1457ee05cc3a8e2e48fde143b6fbbd58}{iterator\+\_\+type}}
\item 
typedef \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1_standard_deviation_evaluator}{tcg\+::polyline\+\_\+ops\+::\+Standard\+Deviation\+Evaluator}}$<$ Ran\+It $>$\+::point\+\_\+type \mbox{\hyperlink{class_raster_edge_evaluator_a9c429633e95bc7a0c558838d8657640e}{point\+\_\+type}}
\item 
typedef \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1_standard_deviation_evaluator}{tcg\+::polyline\+\_\+ops\+::\+Standard\+Deviation\+Evaluator}}$<$ Ran\+It $>$\+::penalty\+\_\+type \mbox{\hyperlink{class_raster_edge_evaluator_a98f60cf36ad9e0fad858358b1249a34f}{penalty\+\_\+type}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_raster_edge_evaluator_a7cd8c6c6717301a964e11dfcb4a5ff02}{Raster\+Edge\+Evaluator}} (const iterator\+\_\+type \&begin, const iterator\+\_\+type \&end, double tolerance, double max\+Length)
\item 
iterator\+\_\+type \mbox{\hyperlink{class_raster_edge_evaluator_a1d1d8971a8525d210b4b6e2d1767bbe1}{furthest\+From}} (const iterator\+\_\+type \&it)
\item 
penalty\+\_\+type \mbox{\hyperlink{class_raster_edge_evaluator_a08c9bb8716283e0dd000864dbd932043}{penalty}} (const iterator\+\_\+type \&a, const iterator\+\_\+type \&b)
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename Ran\+It$>$\newline
class Raster\+Edge\+Evaluator$<$ Ran\+It $>$}
This class implements an evaluator for tcg\textquotesingle{}s sequential reduction algorithm that can be used to simplify the borders extracted from a raster image under a specified tolerance factor. This is typically used as a step in polygonal-\/based image vectorization processes. 

\begin{DoxySeeAlso}{See also}
The tcg\+::sequence\+\_\+ops\+::minimal\+Path() function. 
\end{DoxySeeAlso}


\doxysubsection{Member Typedef Documentation}
\mbox{\Hypertarget{class_raster_edge_evaluator_a1457ee05cc3a8e2e48fde143b6fbbd58}\label{class_raster_edge_evaluator_a1457ee05cc3a8e2e48fde143b6fbbd58}} 
\index{RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}!iterator\_type@{iterator\_type}}
\index{iterator\_type@{iterator\_type}!RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}}
\doxysubsubsection{\texorpdfstring{iterator\_type}{iterator\_type}}
{\footnotesize\ttfamily template$<$typename Ran\+It $>$ \\
typedef \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1_standard_deviation_evaluator}{tcg\+::polyline\+\_\+ops\+::\+Standard\+Deviation\+Evaluator}}$<$Ran\+It$>$\+::iterator\+\_\+type \mbox{\hyperlink{class_raster_edge_evaluator}{Raster\+Edge\+Evaluator}}$<$ Ran\+It $>$\+::iterator\+\_\+type}

\mbox{\Hypertarget{class_raster_edge_evaluator_a98f60cf36ad9e0fad858358b1249a34f}\label{class_raster_edge_evaluator_a98f60cf36ad9e0fad858358b1249a34f}} 
\index{RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}!penalty\_type@{penalty\_type}}
\index{penalty\_type@{penalty\_type}!RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}}
\doxysubsubsection{\texorpdfstring{penalty\_type}{penalty\_type}}
{\footnotesize\ttfamily template$<$typename Ran\+It $>$ \\
typedef \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1_standard_deviation_evaluator}{tcg\+::polyline\+\_\+ops\+::\+Standard\+Deviation\+Evaluator}}$<$Ran\+It$>$\+::penalty\+\_\+type \mbox{\hyperlink{class_raster_edge_evaluator}{Raster\+Edge\+Evaluator}}$<$ Ran\+It $>$\+::penalty\+\_\+type}

\mbox{\Hypertarget{class_raster_edge_evaluator_a9c429633e95bc7a0c558838d8657640e}\label{class_raster_edge_evaluator_a9c429633e95bc7a0c558838d8657640e}} 
\index{RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}!point\_type@{point\_type}}
\index{point\_type@{point\_type}!RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}}
\doxysubsubsection{\texorpdfstring{point\_type}{point\_type}}
{\footnotesize\ttfamily template$<$typename Ran\+It $>$ \\
typedef \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1_standard_deviation_evaluator}{tcg\+::polyline\+\_\+ops\+::\+Standard\+Deviation\+Evaluator}}$<$Ran\+It$>$\+::point\+\_\+type \mbox{\hyperlink{class_raster_edge_evaluator}{Raster\+Edge\+Evaluator}}$<$ Ran\+It $>$\+::point\+\_\+type}



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_raster_edge_evaluator_a7cd8c6c6717301a964e11dfcb4a5ff02}\label{class_raster_edge_evaluator_a7cd8c6c6717301a964e11dfcb4a5ff02}} 
\index{RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}!RasterEdgeEvaluator@{RasterEdgeEvaluator}}
\index{RasterEdgeEvaluator@{RasterEdgeEvaluator}!RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}}
\doxysubsubsection{\texorpdfstring{RasterEdgeEvaluator()}{RasterEdgeEvaluator()}}
{\footnotesize\ttfamily template$<$typename Ran\+It $>$ \\
\mbox{\hyperlink{class_raster_edge_evaluator}{Raster\+Edge\+Evaluator}}$<$ Ran\+It $>$\mbox{\hyperlink{class_raster_edge_evaluator}{\+::\+Raster\+Edge\+Evaluator}} (\begin{DoxyParamCaption}\item[{const iterator\+\_\+type \&}]{begin,  }\item[{const iterator\+\_\+type \&}]{end,  }\item[{double}]{tolerance,  }\item[{double}]{max\+Length }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00017     : \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1_standard_deviation_evaluator}{tcg::polyline\_ops::StandardDeviationEvaluator<RanIt>}}(begin, end)}
\DoxyCodeLine{00018     , m\_tolerance(tolerance)}
\DoxyCodeLine{00019     , m\_maxLength(maxLength) \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_raster_edge_evaluator_a1d1d8971a8525d210b4b6e2d1767bbe1}\label{class_raster_edge_evaluator_a1d1d8971a8525d210b4b6e2d1767bbe1}} 
\index{RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}!furthestFrom@{furthestFrom}}
\index{furthestFrom@{furthestFrom}!RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}}
\doxysubsubsection{\texorpdfstring{furthestFrom()}{furthestFrom()}}
{\footnotesize\ttfamily template$<$typename Ran\+It $>$ \\
\mbox{\hyperlink{class_raster_edge_evaluator}{Raster\+Edge\+Evaluator}}$<$ Ran\+It $>$\+::iterator\+\_\+type \mbox{\hyperlink{class_raster_edge_evaluator}{Raster\+Edge\+Evaluator}}$<$ Ran\+It $>$\+::furthest\+From (\begin{DoxyParamCaption}\item[{const iterator\+\_\+type \&}]{it }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00035                                                                    \{}
\DoxyCodeLine{00036   \textcolor{comment}{// Build the furthest possible forward difference for every vertex between}}
\DoxyCodeLine{00037   \textcolor{comment}{// begin and end.}}
\DoxyCodeLine{00038   point\_type displace, oldDisplace;}
\DoxyCodeLine{00039   point\_type leftConstraint, rightConstraint;}
\DoxyCodeLine{00040   point\_type newLeftConstraint, newRightConstraint;}
\DoxyCodeLine{00041   point\_type leftDirConstr, rightDirConstr, dir, oldDir;}
\DoxyCodeLine{00042   iterator\_type it = start, jt;}
\DoxyCodeLine{00043 }
\DoxyCodeLine{00044   \textcolor{keyword}{const} \textcolor{keywordtype}{double} sqMaxLength = sq(m\_maxLength);}
\DoxyCodeLine{00045 }
\DoxyCodeLine{00046   \textcolor{comment}{// Initialize search}}
\DoxyCodeLine{00047   leftConstraint = rightConstraint = point\_type();}
\DoxyCodeLine{00048   leftDirConstr = rightDirConstr = point\_type();}
\DoxyCodeLine{00049   oldDir = oldDisplace = point\_type();}
\DoxyCodeLine{00050 }
\DoxyCodeLine{00051   \textcolor{keywordflow}{if} (it != this-\/>m\_begin) -\/-\/it;  \textcolor{comment}{// Chop left}}
\DoxyCodeLine{00052 }
\DoxyCodeLine{00053   jt = it;}
\DoxyCodeLine{00054   \textcolor{keywordflow}{for} (++jt; jt != this-\/>m\_end; ++jt) \{}
\DoxyCodeLine{00055     \textcolor{comment}{// Retrieve displacement from *it}}
\DoxyCodeLine{00056     displace = point\_type(jt-\/>x -\/ it-\/>x, jt-\/>y -\/ it-\/>y);}
\DoxyCodeLine{00057     dir = point\_type(displace.x -\/ oldDisplace.x, displace.y -\/ oldDisplace.y);}
\DoxyCodeLine{00058 }
\DoxyCodeLine{00059     \textcolor{comment}{// Max length}}
\DoxyCodeLine{00060     \textcolor{keywordflow}{if} (oldDir.x != 0 || oldDir.y != 0) \{}
\DoxyCodeLine{00061       \textcolor{keywordflow}{if} (sq(displace.x) + sq(displace.y) > sqMaxLength) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00062     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00063       leftDirConstr = rightDirConstr = dir;}
\DoxyCodeLine{00064 }
\DoxyCodeLine{00065     \textcolor{comment}{// Test displacement against the oldDisplacement. If it's reversing the}}
\DoxyCodeLine{00066     \textcolor{comment}{// direction, make it invalid.}}
\DoxyCodeLine{00067 }
\DoxyCodeLine{00068     \textcolor{keywordflow}{if} (cross(oldDir, dir) > 0) leftDirConstr = dir;}
\DoxyCodeLine{00069 }
\DoxyCodeLine{00070     \textcolor{keywordflow}{if} (cross(oldDir, dir) < 0) rightDirConstr = dir;}
\DoxyCodeLine{00071 }
\DoxyCodeLine{00072     \textcolor{comment}{// Test constraints}}
\DoxyCodeLine{00073 }
\DoxyCodeLine{00074     \textcolor{comment}{/*if(cross(rightDirConstr, leftDirConstr) <= 0 \&\&}}
\DoxyCodeLine{00075 \textcolor{comment}{leftDirConstr * rightDirConstr < 0)}}
\DoxyCodeLine{00076 \textcolor{comment}{break;*/}}
\DoxyCodeLine{00077     \textcolor{keywordflow}{if} (cross(rightDirConstr, leftDirConstr) < 0) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00078 }
\DoxyCodeLine{00079     \textcolor{keywordflow}{if} (cross(displace, leftConstraint) < 0) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00080     \textcolor{keywordflow}{if} (cross(displace, rightConstraint) > 0) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00081 }
\DoxyCodeLine{00082     \textcolor{keywordflow}{if} (std::max(\{displace.x, -\/displace.x, displace.y, -\/displace.y\}) >}
\DoxyCodeLine{00083         m\_tolerance) \{}
\DoxyCodeLine{00084       \textcolor{comment}{// Update m\_tolerance constraints}}
\DoxyCodeLine{00085       newLeftConstraint.x =}
\DoxyCodeLine{00086           displace.x + (displace.y < 0 || (displace.y == 0 \&\& displace.x < 0)}
\DoxyCodeLine{00087                             ? m\_tolerance}
\DoxyCodeLine{00088                             : -\/m\_tolerance);}
\DoxyCodeLine{00089       newLeftConstraint.y =}
\DoxyCodeLine{00090           displace.y + (displace.x > 0 || (displace.x == 0 \&\& displace.y < 0)}
\DoxyCodeLine{00091                             ? m\_tolerance}
\DoxyCodeLine{00092                             : -\/m\_tolerance);}
\DoxyCodeLine{00093 }
\DoxyCodeLine{00094       \textcolor{keywordflow}{if} (cross(newLeftConstraint, leftConstraint) >= 0)}
\DoxyCodeLine{00095         leftConstraint = newLeftConstraint;}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097       newRightConstraint.x =}
\DoxyCodeLine{00098           displace.x + (displace.y > 0 || (displace.y == 0 \&\& displace.x < 0)}
\DoxyCodeLine{00099                             ? m\_tolerance}
\DoxyCodeLine{00100                             : -\/m\_tolerance);}
\DoxyCodeLine{00101 }
\DoxyCodeLine{00102       newRightConstraint.y =}
\DoxyCodeLine{00103           displace.y + (displace.x < 0 || (displace.x == 0 \&\& displace.y < 0)}
\DoxyCodeLine{00104                             ? m\_tolerance}
\DoxyCodeLine{00105                             : -\/m\_tolerance);}
\DoxyCodeLine{00106 }
\DoxyCodeLine{00107       \textcolor{keywordflow}{if} (cross(newRightConstraint, rightConstraint) <= 0)}
\DoxyCodeLine{00108         rightConstraint = newRightConstraint;}
\DoxyCodeLine{00109     \}}
\DoxyCodeLine{00110 }
\DoxyCodeLine{00111     oldDisplace = displace;}
\DoxyCodeLine{00112     oldDir      = dir;}
\DoxyCodeLine{00113   \}}
\DoxyCodeLine{00114 }
\DoxyCodeLine{00115   \textcolor{keywordflow}{if} (jt != this-\/>m\_end) -\/-\/jt;  \textcolor{comment}{// Chop Right}}
\DoxyCodeLine{00116 }
\DoxyCodeLine{00117   \textcolor{keywordflow}{return} start +}
\DoxyCodeLine{00118          std::max(}
\DoxyCodeLine{00119              (\textcolor{keywordtype}{int})std::min(jt -\/ start -\/ 1, this-\/>m\_end -\/ this-\/>m\_begin -\/ 2), 1);}
\DoxyCodeLine{00120 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_raster_edge_evaluator_a08c9bb8716283e0dd000864dbd932043}\label{class_raster_edge_evaluator_a08c9bb8716283e0dd000864dbd932043}} 
\index{RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}!penalty@{penalty}}
\index{penalty@{penalty}!RasterEdgeEvaluator$<$ RanIt $>$@{RasterEdgeEvaluator$<$ RanIt $>$}}
\doxysubsubsection{\texorpdfstring{penalty()}{penalty()}}
{\footnotesize\ttfamily template$<$typename Ran\+It $>$ \\
\mbox{\hyperlink{class_raster_edge_evaluator}{Raster\+Edge\+Evaluator}}$<$ Ran\+It $>$\+::penalty\+\_\+type \mbox{\hyperlink{class_raster_edge_evaluator}{Raster\+Edge\+Evaluator}}$<$ Ran\+It $>$\+::penalty (\begin{DoxyParamCaption}\item[{const iterator\+\_\+type \&}]{a,  }\item[{const iterator\+\_\+type \&}]{b }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00026                                                             \{}
\DoxyCodeLine{00027   \textcolor{keywordflow}{return} tcg::point\_ops::norm(*b -\/ *a) *}
\DoxyCodeLine{00028          \mbox{\hyperlink{classtcg_1_1polyline__ops_1_1_standard_deviation_evaluator}{tcg::polyline\_ops::StandardDeviationEvaluator<RanIt>::penalty}}(a, b);}
\DoxyCodeLine{00029 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/common/trop/raster\+\_\+edge\+\_\+evaluator.\+h\item 
E\+:/opentoonz/toonz/sources/common/trop/raster\+\_\+edge\+\_\+evaluator.\+hpp\end{DoxyCompactItemize}
