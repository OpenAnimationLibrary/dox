\hypertarget{class_linear_wave_fx}{}\doxysection{Linear\+Wave\+Fx Class Reference}
\label{class_linear_wave_fx}\index{LinearWaveFx@{LinearWaveFx}}
Inheritance diagram for Linear\+Wave\+Fx\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=5.000000cm]{class_linear_wave_fx}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{class_linear_wave_fx_aaf2e6d922f93618f7ea0b28a2a018576}{can\+Handle}} (const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info, double frame) override
\item 
bool \mbox{\hyperlink{class_linear_wave_fx_a95f491760d78cb7c5cfb6e7bda4d4528}{do\+Get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&b\+Box, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
void \mbox{\hyperlink{class_linear_wave_fx_a79e2e86e7daa5931fef7d91c4195386c}{do\+Dry\+Compute}} (\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
void \mbox{\hyperlink{class_linear_wave_fx_aa0a770e001c61172dd6ce08c98773594}{do\+Compute}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
int \mbox{\hyperlink{class_linear_wave_fx_a36ae809ad2f281e42ccc789bc292cca7}{get\+Memory\+Requirement}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} \mbox{\hyperlink{class_linear_wave_fx_ab376c7c7c4161aeaa130f87b66c10c38}{m\+\_\+warped}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_linear_wave_fx_accf7fabfd144ab17480f845620539ba1}{m\+\_\+intensity}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_linear_wave_fx_ae04725ff240c2da075c9b9caa1dc0426}{m\+\_\+grid\+Step}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_linear_wave_fx_a32d18c6e4f8a2c0feca705716183d723}{m\+\_\+count}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_linear_wave_fx_ac7002b281ed044bb3ab1b54dd2f377fe}{m\+\_\+period}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_linear_wave_fx_a4776f93a28f2393132c9be8e6db3c1db}{m\+\_\+cycle}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_linear_wave_fx_a89cc5f5591dea200ac1291d01c12d06d}{m\+\_\+amplitude}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_linear_wave_fx_aefb7cf69055122b89c0b3400f9848211}{m\+\_\+frequency}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_linear_wave_fx_a9f05e0a666338fe00ab3efb26978225c}{m\+\_\+phase}}
\item 
TDouble\+ParamP \mbox{\hyperlink{class_linear_wave_fx_aa0d04e9b370b8a6e536693b0b3dfc027}{m\+\_\+angle}}
\item 
TBool\+ParamP \mbox{\hyperlink{class_linear_wave_fx_ad862fe60832a0fcd529e7fe685b19137}{m\+\_\+sharpen}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_linear_wave_fx_a22cfdbe97f71fc0d244a7a1e343462cd}\label{class_linear_wave_fx_a22cfdbe97f71fc0d244a7a1e343462cd}} 
\index{LinearWaveFx@{LinearWaveFx}!LinearWaveFx@{LinearWaveFx}}
\index{LinearWaveFx@{LinearWaveFx}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{LinearWaveFx()}{LinearWaveFx()}}
{\footnotesize\ttfamily Linear\+Wave\+Fx\+::\+Linear\+Wave\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00030       : m\_intensity(20)}
\DoxyCodeLine{00031       , m\_gridStep(2)}
\DoxyCodeLine{00032       , m\_period(100)}
\DoxyCodeLine{00033       , m\_count(20)}
\DoxyCodeLine{00034       , m\_cycle(0.0)}
\DoxyCodeLine{00035       , m\_amplitude(50.0)}
\DoxyCodeLine{00036       , m\_frequency(200.0)}
\DoxyCodeLine{00037       , m\_phase(0.0)}
\DoxyCodeLine{00038       , m\_angle(0.0)}
\DoxyCodeLine{00039       , m\_sharpen(\textcolor{keyword}{false}) \{}
\DoxyCodeLine{00040     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Source"{}}, m\_warped);}
\DoxyCodeLine{00041     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}intensity"{}}, m\_intensity);}
\DoxyCodeLine{00042     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}sensitivity"{}}, m\_gridStep);}
\DoxyCodeLine{00043     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}period"{}}, m\_period);}
\DoxyCodeLine{00044     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}count"{}}, m\_count);}
\DoxyCodeLine{00045     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}cycle"{}}, m\_cycle);}
\DoxyCodeLine{00046     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}amplitude"{}}, m\_amplitude);}
\DoxyCodeLine{00047     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}frequency"{}}, m\_frequency);}
\DoxyCodeLine{00048     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}phase"{}}, m\_phase);}
\DoxyCodeLine{00049     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}angle"{}}, m\_angle);}
\DoxyCodeLine{00050     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}sharpen"{}}, m\_sharpen);}
\DoxyCodeLine{00051     m\_intensity-\/>setValueRange(-\/1000, 1000);}
\DoxyCodeLine{00052     m\_gridStep-\/>setValueRange(2, 20);}
\DoxyCodeLine{00053     m\_period-\/>setValueRange(0, (std::numeric\_limits<double>::max)());}
\DoxyCodeLine{00054     m\_cycle-\/>setValueRange(0, (std::numeric\_limits<double>::max)());}
\DoxyCodeLine{00055     m\_count-\/>setValueRange(0, (std::numeric\_limits<double>::max)());}
\DoxyCodeLine{00056     m\_period-\/>setMeasureName(\textcolor{stringliteral}{"{}fxLength"{}});}
\DoxyCodeLine{00057     m\_amplitude-\/>setMeasureName(\textcolor{stringliteral}{"{}fxLength"{}});}
\DoxyCodeLine{00058   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_linear_wave_fx_aae998326f1fb332570e6674a5fb306a7}\label{class_linear_wave_fx_aae998326f1fb332570e6674a5fb306a7}} 
\index{LinearWaveFx@{LinearWaveFx}!````~LinearWaveFx@{$\sim$LinearWaveFx}}
\index{````~LinearWaveFx@{$\sim$LinearWaveFx}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{$\sim$LinearWaveFx()}{~LinearWaveFx()}}
{\footnotesize\ttfamily virtual Linear\+Wave\+Fx\+::$\sim$\+Linear\+Wave\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00060 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_linear_wave_fx_aaf2e6d922f93618f7ea0b28a2a018576}\label{class_linear_wave_fx_aaf2e6d922f93618f7ea0b28a2a018576}} 
\index{LinearWaveFx@{LinearWaveFx}!canHandle@{canHandle}}
\index{canHandle@{canHandle}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{canHandle()}{canHandle()}}
{\footnotesize\ttfamily bool Linear\+Wave\+Fx\+::can\+Handle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info,  }\item[{double}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00064                                                                      \{}
\DoxyCodeLine{00065     \textcolor{keywordflow}{return} isAlmostIsotropic(info.m\_affine);}
\DoxyCodeLine{00066   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_linear_wave_fx_aa0a770e001c61172dd6ce08c98773594}\label{class_linear_wave_fx_aa0a770e001c61172dd6ce08c98773594}} 
\index{LinearWaveFx@{LinearWaveFx}!doCompute@{doCompute}}
\index{doCompute@{doCompute}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{doCompute()}{doCompute()}}
{\footnotesize\ttfamily void Linear\+Wave\+Fx\+::do\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00125                                                        \{}
\DoxyCodeLine{00126     \textcolor{keywordtype}{bool} isWarped = m\_warped.isConnected();}
\DoxyCodeLine{00127 }
\DoxyCodeLine{00128     \textcolor{keywordflow}{if} (!isWarped) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130     \textcolor{keywordflow}{if} (fabs(m\_intensity-\/>getValue(frame)) < 0.01) \{}
\DoxyCodeLine{00131       m\_warped-\/>compute(tile, frame, info);}
\DoxyCodeLine{00132       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00133     \}}
\DoxyCodeLine{00134 }
\DoxyCodeLine{00135     \textcolor{keywordtype}{int} shrink      = (info.m\_shrinkX + info.m\_shrinkY) / 2;}
\DoxyCodeLine{00136     \textcolor{keywordtype}{double} scale    = sqrt(fabs(info.m\_affine.det()));}
\DoxyCodeLine{00137     \textcolor{keywordtype}{double} gridStep = 1.5 * m\_gridStep-\/>getValue(frame);}
\DoxyCodeLine{00138 }
\DoxyCodeLine{00139     \mbox{\hyperlink{struct_warp_params}{WarpParams}} params;}
\DoxyCodeLine{00140     params.m\_intensity   = m\_intensity-\/>getValue(frame) / gridStep;}
\DoxyCodeLine{00141     params.m\_warperScale = scale * gridStep;}
\DoxyCodeLine{00142     params.m\_sharpen     = m\_sharpen-\/>getValue();}
\DoxyCodeLine{00143     params.m\_shrink      = shrink;}
\DoxyCodeLine{00144     \textcolor{keywordtype}{double} period        = m\_period-\/>getValue(frame) / info.m\_shrinkX;}
\DoxyCodeLine{00145     \textcolor{keywordtype}{double} count         = m\_count-\/>getValue(frame);}
\DoxyCodeLine{00146     \textcolor{keywordtype}{double} cycle         = m\_cycle-\/>getValue(frame) / info.m\_shrinkX;}
\DoxyCodeLine{00147 }
\DoxyCodeLine{00148     \textcolor{keywordtype}{double} w\_amplitude = m\_amplitude-\/>getValue(frame) / info.m\_shrinkX;}
\DoxyCodeLine{00149     \textcolor{keywordtype}{double} w\_freq      = m\_frequency-\/>getValue(frame) * info.m\_shrinkX;}
\DoxyCodeLine{00150     \textcolor{keywordtype}{double} w\_phase     = m\_phase-\/>getValue(frame);}
\DoxyCodeLine{00151     w\_freq *= 0.01 * M\_PI\_180;}
\DoxyCodeLine{00152     \textcolor{keywordtype}{double} angle = -\/m\_angle-\/>getValue(frame);}
\DoxyCodeLine{00153 }
\DoxyCodeLine{00154     \textcolor{comment}{// The warper is calculated on a standard reference, with fixed dpi. This}}
\DoxyCodeLine{00155     \textcolor{comment}{// makes sure}}
\DoxyCodeLine{00156     \textcolor{comment}{// that the lattice created for the warp does not depend on camera}}
\DoxyCodeLine{00157     \textcolor{comment}{// transforms and resolution.}}
\DoxyCodeLine{00158     \mbox{\hyperlink{class_t_render_settings}{TRenderSettings}} warperInfo(info);}
\DoxyCodeLine{00159     \textcolor{keywordtype}{double} warperScaleFactor = 1.0 / params.m\_warperScale;}
\DoxyCodeLine{00160     warperInfo.m\_affine      = \mbox{\hyperlink{class_t_scale}{TScale}}(warperScaleFactor) * info.m\_affine;}
\DoxyCodeLine{00161 }
\DoxyCodeLine{00162     \textcolor{comment}{// Retrieve tile's geometry}}
\DoxyCodeLine{00163     \mbox{\hyperlink{class_t_rect_t}{TRectD}} tileRect;}
\DoxyCodeLine{00164     \{}
\DoxyCodeLine{00165       \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} tileRas = tile.getRaster();}
\DoxyCodeLine{00166       tileRect =}
\DoxyCodeLine{00167           \mbox{\hyperlink{class_t_rect_t}{TRectD}}(tile.m\_pos, \mbox{\hyperlink{class_t_dimension_t}{TDimensionD}}(tileRas-\/>getLx(), tileRas-\/>getLy()));}
\DoxyCodeLine{00168     \}}
\DoxyCodeLine{00169 }
\DoxyCodeLine{00170     \textcolor{comment}{// Build the compute rect}}
\DoxyCodeLine{00171     \mbox{\hyperlink{class_t_rect_t}{TRectD}} warpedBox, warpedComputeRect, tileComputeRect;}
\DoxyCodeLine{00172     m\_warped-\/>getBBox(frame, warpedBox, info);}
\DoxyCodeLine{00173 }
\DoxyCodeLine{00174     getWarpComputeRects(tileComputeRect, warpedComputeRect, warpedBox, tileRect,}
\DoxyCodeLine{00175                         params);}
\DoxyCodeLine{00176 }
\DoxyCodeLine{00177     \textcolor{keywordflow}{if} (tileComputeRect.getLx() <= 0 || tileComputeRect.getLy() <= 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00178     \textcolor{keywordflow}{if} (warpedComputeRect.getLx() <= 0 || warpedComputeRect.getLy() <= 0)}
\DoxyCodeLine{00179       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00180 }
\DoxyCodeLine{00181     \mbox{\hyperlink{class_t_rect_t}{TRectD}} warperComputeRect(\mbox{\hyperlink{class_t_scale}{TScale}}(warperScaleFactor) * tileComputeRect);}
\DoxyCodeLine{00182     \textcolor{keywordtype}{double} warperEnlargement = getWarperEnlargement(params);}
\DoxyCodeLine{00183     warperComputeRect        = warperComputeRect.enlarge(warperEnlargement);}
\DoxyCodeLine{00184     warperComputeRect.x0     = tfloor(warperComputeRect.x0);}
\DoxyCodeLine{00185     warperComputeRect.y0     = tfloor(warperComputeRect.y0);}
\DoxyCodeLine{00186     warperComputeRect.x1     = tceil(warperComputeRect.x1);}
\DoxyCodeLine{00187     warperComputeRect.y1     = tceil(warperComputeRect.y1);}
\DoxyCodeLine{00188 }
\DoxyCodeLine{00189     \textcolor{comment}{// Compute the warped tile}}
\DoxyCodeLine{00190     \mbox{\hyperlink{class_t_tile}{TTile}} tileIn;}
\DoxyCodeLine{00191     m\_warped-\/>allocateAndCompute(}
\DoxyCodeLine{00192         tileIn, warpedComputeRect.getP00(),}
\DoxyCodeLine{00193         \mbox{\hyperlink{class_t_dimension_t}{TDimension}}(warpedComputeRect.getLx(), warpedComputeRect.getLy()),}
\DoxyCodeLine{00194         tile.getRaster(), frame, info);}
\DoxyCodeLine{00195     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rasIn = tileIn.getRaster();}
\DoxyCodeLine{00196 }
\DoxyCodeLine{00197     \textcolor{comment}{// Compute the warper tile}}
\DoxyCodeLine{00198     std::vector<TSpectrum::ColorKey> colors = \{}
\DoxyCodeLine{00199         TSpectrum::ColorKey(0, TPixel32::White),}
\DoxyCodeLine{00200         TSpectrum::ColorKey(0.5, TPixel32::Black),}
\DoxyCodeLine{00201         TSpectrum::ColorKey(1, TPixel32::White)\};}
\DoxyCodeLine{00202     \mbox{\hyperlink{class_t_spectrum_param_p}{TSpectrumParamP}} wavecolors = \mbox{\hyperlink{class_t_spectrum_param_p}{TSpectrumParamP}}(colors);}
\DoxyCodeLine{00203 }
\DoxyCodeLine{00204     \textcolor{comment}{// Build the multiradial}}
\DoxyCodeLine{00205     warperInfo.m\_affine = warperInfo.m\_affine * \mbox{\hyperlink{class_t_rotation}{TRotation}}(angle);}
\DoxyCodeLine{00206     \mbox{\hyperlink{class_t_affine}{TAffine}} aff         = warperInfo.m\_affine.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}();}
\DoxyCodeLine{00207     \mbox{\hyperlink{class_t_point_t}{TPointD}} posTrasf    = aff * warperComputeRect.getP00();}
\DoxyCodeLine{00208     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} rasWarper =}
\DoxyCodeLine{00209         rasIn-\/>create(warperComputeRect.getLx(), warperComputeRect.getLy());}
\DoxyCodeLine{00210     multiLinear(rasWarper, posTrasf, wavecolors, period, count, w\_amplitude,}
\DoxyCodeLine{00211                 w\_freq, w\_phase, cycle, aff, frame);}
\DoxyCodeLine{00212 }
\DoxyCodeLine{00213     \textcolor{comment}{// Warp}}
\DoxyCodeLine{00214     \mbox{\hyperlink{class_t_point_t}{TPointD}} db;}
\DoxyCodeLine{00215     \mbox{\hyperlink{class_t_rect_t}{TRect}} rasComputeRectI(convert(tileComputeRect -\/ tileRect.getP00(), db));}
\DoxyCodeLine{00216     \mbox{\hyperlink{class_t_smart_pointer_t}{TRasterP}} tileRas = tile.getRaster()-\/>extract(rasComputeRectI);}
\DoxyCodeLine{00217 }
\DoxyCodeLine{00218     \mbox{\hyperlink{class_t_point_t}{TPointD}} rasInPos(warpedComputeRect.getP00() -\/ tileComputeRect.getP00());}
\DoxyCodeLine{00219     \mbox{\hyperlink{class_t_point_t}{TPointD}} warperPos(}
\DoxyCodeLine{00220         (\mbox{\hyperlink{class_t_scale}{TScale}}(params.m\_warperScale) * warperComputeRect.getP00()) -\/}
\DoxyCodeLine{00221         tileComputeRect.getP00());}
\DoxyCodeLine{00222     warp(tileRas, rasIn, rasWarper, rasInPos, warperPos, params);}
\DoxyCodeLine{00223   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_linear_wave_fx_a79e2e86e7daa5931fef7d91c4195386c}\label{class_linear_wave_fx_a79e2e86e7daa5931fef7d91c4195386c}} 
\index{LinearWaveFx@{LinearWaveFx}!doDryCompute@{doDryCompute}}
\index{doDryCompute@{doDryCompute}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{doDryCompute()}{doDryCompute()}}
{\footnotesize\ttfamily void Linear\+Wave\+Fx\+::do\+Dry\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Declares the computation scheme of this fx for rendering optimization purposes. This is an important function of the Toonz rendering API, and should be reimplemented with the necessary care. The Toonz rendering process makes use of this function to enact most of the optimization steps about the fx computation, in particular fx caching. A correct implementation of this method should follow these rules\+:  The invocation of child node computations should be faithfully reproduced.  TRaster\+Fx\+::compute and TRaster\+Fx\+::allocate\+And\+Compute calls have to be translated to TRaster\+Fx\+::dry\+Compute calls.  This fx is intended for precomputation stage, so the hard rendering code should be skipped here. By default, this method raises a dry\+Compute call to each input port in increasing order, using the TRaster\+Fx\+::transform method to identify the tiles to be passed on input precomputation. 

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_a47ec31d2d4c3a066cd6744fb8c80edf2}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00093                                                           \{}
\DoxyCodeLine{00094     \textcolor{keywordtype}{bool} isWarped = m\_warped.isConnected();}
\DoxyCodeLine{00095     \textcolor{keywordflow}{if} (!isWarped) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00096     \textcolor{keywordflow}{if} (fabs(m\_intensity-\/>getValue(frame)) < 0.01) \{}
\DoxyCodeLine{00097       m\_warped-\/>dryCompute(rect, frame, info);}
\DoxyCodeLine{00098       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00099     \}}
\DoxyCodeLine{00100 }
\DoxyCodeLine{00101     \textcolor{keywordtype}{double} scale    = sqrt(fabs(info.m\_affine.det()));}
\DoxyCodeLine{00102     \textcolor{keywordtype}{double} gridStep = 1.5 * m\_gridStep-\/>getValue(frame);}
\DoxyCodeLine{00103 }
\DoxyCodeLine{00104     \mbox{\hyperlink{struct_warp_params}{WarpParams}} params;}
\DoxyCodeLine{00105     params.m\_intensity   = m\_intensity-\/>getValue(frame) / gridStep;}
\DoxyCodeLine{00106     params.m\_warperScale = scale * gridStep;}
\DoxyCodeLine{00107     params.m\_sharpen     = m\_sharpen-\/>getValue();}
\DoxyCodeLine{00108 }
\DoxyCodeLine{00109     \mbox{\hyperlink{class_t_rect_t}{TRectD}} warpedBox, warpedComputeRect, tileComputeRect;}
\DoxyCodeLine{00110     m\_warped-\/>getBBox(frame, warpedBox, info);}
\DoxyCodeLine{00111 }
\DoxyCodeLine{00112     getWarpComputeRects(tileComputeRect, warpedComputeRect, warpedBox, rect,}
\DoxyCodeLine{00113                         params);}
\DoxyCodeLine{00114 }
\DoxyCodeLine{00115     \textcolor{keywordflow}{if} (tileComputeRect.getLx() <= 0 || tileComputeRect.getLy() <= 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00116     \textcolor{keywordflow}{if} (warpedComputeRect.getLx() <= 0 || warpedComputeRect.getLy() <= 0)}
\DoxyCodeLine{00117       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00118 }
\DoxyCodeLine{00119     m\_warped-\/>dryCompute(warpedComputeRect, frame, info);}
\DoxyCodeLine{00120   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_linear_wave_fx_a95f491760d78cb7c5cfb6e7bda4d4528}\label{class_linear_wave_fx_a95f491760d78cb7c5cfb6e7bda4d4528}} 
\index{LinearWaveFx@{LinearWaveFx}!doGetBBox@{doGetBBox}}
\index{doGetBBox@{doGetBBox}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{doGetBBox()}{doGetBBox()}}
{\footnotesize\ttfamily bool Linear\+Wave\+Fx\+::do\+Get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{b\+Box,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00071                                                        \{}
\DoxyCodeLine{00072     \textcolor{keywordflow}{if} (m\_warped.isConnected()) \{}
\DoxyCodeLine{00073       \textcolor{keywordtype}{int} ret = m\_warped-\/>doGetBBox(frame, bBox, info);}
\DoxyCodeLine{00074 }
\DoxyCodeLine{00075       \textcolor{keywordflow}{if} (ret \&\& !bBox.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \{}
\DoxyCodeLine{00076         \textcolor{keywordflow}{if} (bBox != TConsts::infiniteRectD) \{}
\DoxyCodeLine{00077           \mbox{\hyperlink{struct_warp_params}{WarpParams}} params;}
\DoxyCodeLine{00078           params.m\_intensity = m\_intensity-\/>getValue(frame);}
\DoxyCodeLine{00079 }
\DoxyCodeLine{00080           bBox = bBox.enlarge(getWarpRadius(params));}
\DoxyCodeLine{00081         \}}
\DoxyCodeLine{00082         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00083       \}}
\DoxyCodeLine{00084     \}}
\DoxyCodeLine{00085 }
\DoxyCodeLine{00086     bBox = \mbox{\hyperlink{class_t_rect_t}{TRectD}}();}
\DoxyCodeLine{00087     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00088   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_linear_wave_fx_a36ae809ad2f281e42ccc789bc292cca7}\label{class_linear_wave_fx_a36ae809ad2f281e42ccc789bc292cca7}} 
\index{LinearWaveFx@{LinearWaveFx}!getMemoryRequirement@{getMemoryRequirement}}
\index{getMemoryRequirement@{getMemoryRequirement}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{getMemoryRequirement()}{getMemoryRequirement()}}
{\footnotesize\ttfamily int Linear\+Wave\+Fx\+::get\+Memory\+Requirement (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Specifies the approximate size (in Mega\+Bytes) of the maximum allocation instance that this fx will need to perform in order to render the passed input. This method should be reimplemented in order to make the Toonz rendering process aware of the use of big raster memory chunks, at least. Observe that the passed tile geometry is implicitly {\itshape  already allocated \texorpdfstring{$<$}{<}\textbackslash{}i\texorpdfstring{$>$}{>} for the fx output. ~\newline
The default implementation returns 0, assuming that the passed implicit memory size is passed below in node computation without further allocation of resources. Fxs can reimplement this to -\/1 to explicitly disable the Toonz\textquotesingle{}s smart memory handling. ~\newline
 ~\newline
\begin{DoxyNote}{Note}
The rendering process ensures that the passed render settings are {\itshape handled} by the fx before this function is invoked -\/ do not waste code for it. 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRaster\+Fx\+::memory\+Size}} and TRaster\+Fx\+::can\+Handle methods. 
\end{DoxySeeAlso}
}

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_af8eb991c9756f4fb2e48d9f96cbacfba}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00226                                                                  \{}
\DoxyCodeLine{00227     \textcolor{comment}{// return -\/1;   //Deactivated. This fx is currently very inefficient if}}
\DoxyCodeLine{00228     \textcolor{comment}{// subdivided!}}
\DoxyCodeLine{00229 }
\DoxyCodeLine{00230     \textcolor{keywordtype}{int} shrink      = (info.m\_shrinkX + info.m\_shrinkY) / 2;}
\DoxyCodeLine{00231     \textcolor{keywordtype}{double} scale    = sqrt(fabs(info.m\_affine.det()));}
\DoxyCodeLine{00232     \textcolor{keywordtype}{double} gridStep = 1.5 * m\_gridStep-\/>getValue(frame);}
\DoxyCodeLine{00233 }
\DoxyCodeLine{00234     \mbox{\hyperlink{struct_warp_params}{WarpParams}} params;}
\DoxyCodeLine{00235     params.m\_intensity   = m\_intensity-\/>getValue(frame) / gridStep;}
\DoxyCodeLine{00236     params.m\_warperScale = scale * gridStep;}
\DoxyCodeLine{00237     params.m\_sharpen     = m\_sharpen-\/>getValue();}
\DoxyCodeLine{00238     params.m\_shrink      = shrink;}
\DoxyCodeLine{00239 }
\DoxyCodeLine{00240     \textcolor{keywordtype}{double} warperScaleFactor = 1.0 / params.m\_warperScale;}
\DoxyCodeLine{00241 }
\DoxyCodeLine{00242     \mbox{\hyperlink{class_t_rect_t}{TRectD}} warpedBox, warpedComputeRect, tileComputeRect;}
\DoxyCodeLine{00243     m\_warped-\/>getBBox(frame, warpedBox, info);}
\DoxyCodeLine{00244 }
\DoxyCodeLine{00245     getWarpComputeRects(tileComputeRect, warpedComputeRect, warpedBox, rect,}
\DoxyCodeLine{00246                         params);}
\DoxyCodeLine{00247 }
\DoxyCodeLine{00248     \mbox{\hyperlink{class_t_rect_t}{TRectD}} warperComputeRect(\mbox{\hyperlink{class_t_scale}{TScale}}(warperScaleFactor) * tileComputeRect);}
\DoxyCodeLine{00249     \textcolor{keywordtype}{double} warperEnlargement = getWarperEnlargement(params);}
\DoxyCodeLine{00250     warperComputeRect        = warperComputeRect.enlarge(warperEnlargement);}
\DoxyCodeLine{00251 }
\DoxyCodeLine{00252     \textcolor{keywordflow}{return} std::max(\mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRasterFx::memorySize}}(warpedComputeRect, info.m\_bpp),}
\DoxyCodeLine{00253                     \mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRasterFx::memorySize}}(warperComputeRect, info.m\_bpp));}
\DoxyCodeLine{00254   \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00560}{TRaster\+Fx\+::memory\+Size()}}.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_linear_wave_fx_a89cc5f5591dea200ac1291d01c12d06d}\label{class_linear_wave_fx_a89cc5f5591dea200ac1291d01c12d06d}} 
\index{LinearWaveFx@{LinearWaveFx}!m\_amplitude@{m\_amplitude}}
\index{m\_amplitude@{m\_amplitude}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_amplitude}{m\_amplitude}}
{\footnotesize\ttfamily TDouble\+ParamP Linear\+Wave\+Fx\+::m\+\_\+amplitude\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_linear_wave_fx_aa0d04e9b370b8a6e536693b0b3dfc027}\label{class_linear_wave_fx_aa0d04e9b370b8a6e536693b0b3dfc027}} 
\index{LinearWaveFx@{LinearWaveFx}!m\_angle@{m\_angle}}
\index{m\_angle@{m\_angle}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_angle}{m\_angle}}
{\footnotesize\ttfamily TDouble\+ParamP Linear\+Wave\+Fx\+::m\+\_\+angle\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_linear_wave_fx_a32d18c6e4f8a2c0feca705716183d723}\label{class_linear_wave_fx_a32d18c6e4f8a2c0feca705716183d723}} 
\index{LinearWaveFx@{LinearWaveFx}!m\_count@{m\_count}}
\index{m\_count@{m\_count}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_count}{m\_count}}
{\footnotesize\ttfamily TDouble\+ParamP Linear\+Wave\+Fx\+::m\+\_\+count\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_linear_wave_fx_a4776f93a28f2393132c9be8e6db3c1db}\label{class_linear_wave_fx_a4776f93a28f2393132c9be8e6db3c1db}} 
\index{LinearWaveFx@{LinearWaveFx}!m\_cycle@{m\_cycle}}
\index{m\_cycle@{m\_cycle}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_cycle}{m\_cycle}}
{\footnotesize\ttfamily TDouble\+ParamP Linear\+Wave\+Fx\+::m\+\_\+cycle\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_linear_wave_fx_aefb7cf69055122b89c0b3400f9848211}\label{class_linear_wave_fx_aefb7cf69055122b89c0b3400f9848211}} 
\index{LinearWaveFx@{LinearWaveFx}!m\_frequency@{m\_frequency}}
\index{m\_frequency@{m\_frequency}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_frequency}{m\_frequency}}
{\footnotesize\ttfamily TDouble\+ParamP Linear\+Wave\+Fx\+::m\+\_\+frequency\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_linear_wave_fx_ae04725ff240c2da075c9b9caa1dc0426}\label{class_linear_wave_fx_ae04725ff240c2da075c9b9caa1dc0426}} 
\index{LinearWaveFx@{LinearWaveFx}!m\_gridStep@{m\_gridStep}}
\index{m\_gridStep@{m\_gridStep}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_gridStep}{m\_gridStep}}
{\footnotesize\ttfamily TDouble\+ParamP Linear\+Wave\+Fx\+::m\+\_\+grid\+Step\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_linear_wave_fx_accf7fabfd144ab17480f845620539ba1}\label{class_linear_wave_fx_accf7fabfd144ab17480f845620539ba1}} 
\index{LinearWaveFx@{LinearWaveFx}!m\_intensity@{m\_intensity}}
\index{m\_intensity@{m\_intensity}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_intensity}{m\_intensity}}
{\footnotesize\ttfamily TDouble\+ParamP Linear\+Wave\+Fx\+::m\+\_\+intensity\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_linear_wave_fx_ac7002b281ed044bb3ab1b54dd2f377fe}\label{class_linear_wave_fx_ac7002b281ed044bb3ab1b54dd2f377fe}} 
\index{LinearWaveFx@{LinearWaveFx}!m\_period@{m\_period}}
\index{m\_period@{m\_period}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_period}{m\_period}}
{\footnotesize\ttfamily TDouble\+ParamP Linear\+Wave\+Fx\+::m\+\_\+period\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_linear_wave_fx_a9f05e0a666338fe00ab3efb26978225c}\label{class_linear_wave_fx_a9f05e0a666338fe00ab3efb26978225c}} 
\index{LinearWaveFx@{LinearWaveFx}!m\_phase@{m\_phase}}
\index{m\_phase@{m\_phase}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_phase}{m\_phase}}
{\footnotesize\ttfamily TDouble\+ParamP Linear\+Wave\+Fx\+::m\+\_\+phase\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_linear_wave_fx_ad862fe60832a0fcd529e7fe685b19137}\label{class_linear_wave_fx_ad862fe60832a0fcd529e7fe685b19137}} 
\index{LinearWaveFx@{LinearWaveFx}!m\_sharpen@{m\_sharpen}}
\index{m\_sharpen@{m\_sharpen}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_sharpen}{m\_sharpen}}
{\footnotesize\ttfamily TBool\+ParamP Linear\+Wave\+Fx\+::m\+\_\+sharpen\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_linear_wave_fx_ab376c7c7c4161aeaa130f87b66c10c38}\label{class_linear_wave_fx_ab376c7c7c4161aeaa130f87b66c10c38}} 
\index{LinearWaveFx@{LinearWaveFx}!m\_warped@{m\_warped}}
\index{m\_warped@{m\_warped}!LinearWaveFx@{LinearWaveFx}}
\doxysubsubsection{\texorpdfstring{m\_warped}{m\_warped}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_raster_fx_port}{TRaster\+Fx\+Port}} Linear\+Wave\+Fx\+::m\+\_\+warped\hspace{0.3cm}{\ttfamily [protected]}}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/stdfx/linearwavefx.\+cpp\end{DoxyCompactItemize}
