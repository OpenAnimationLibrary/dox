\hypertarget{class_t_image_writer_pli}{}\doxysection{TImage\+Writer\+Pli Class Reference}
\label{class_t_image_writer_pli}\index{TImageWriterPli@{TImageWriterPli}}
Inheritance diagram for TImage\+Writer\+Pli\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_t_image_writer_pli}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_image_writer_pli_aedea94a5cb61bf000c4de7f2aadd6d93}{TImage\+Writer\+Pli}} (const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&, const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&frame\+Id, \mbox{\hyperlink{class_t_level_writer_pli}{TLevel\+Writer\+Pli}} $\ast$)
\item 
void \mbox{\hyperlink{class_t_image_writer_pli_ab513e8e3229aa06caab1883bb5a539d3}{save}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \&) override
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \mbox{\hyperlink{class_t_image_writer_pli_ac922faaa3d0d6d17bcf42e9f3098f4e7}{m\+\_\+frame\+Id}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_t_image_writer_pli_aedea94a5cb61bf000c4de7f2aadd6d93}\label{class_t_image_writer_pli_aedea94a5cb61bf000c4de7f2aadd6d93}} 
\index{TImageWriterPli@{TImageWriterPli}!TImageWriterPli@{TImageWriterPli}}
\index{TImageWriterPli@{TImageWriterPli}!TImageWriterPli@{TImageWriterPli}}
\doxysubsubsection{\texorpdfstring{TImageWriterPli()}{TImageWriterPli()}}
{\footnotesize\ttfamily TImage\+Writer\+Pli\+::\+TImage\+Writer\+Pli (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{f,  }\item[{const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{frame\+Id,  }\item[{\mbox{\hyperlink{class_t_level_writer_pli}{TLevel\+Writer\+Pli}} $\ast$}]{pli }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00451     : \mbox{\hyperlink{class_t_image_writer}{TImageWriter}}(f)}
\DoxyCodeLine{00452     , m\_frameId(frameId)}
\DoxyCodeLine{00453     , m\_lwp(pli)}
\DoxyCodeLine{00454     , m\_precision(2)}
\DoxyCodeLine{00455 \textcolor{comment}{//, m\_maxThickness(0)}}
\DoxyCodeLine{00456 \{\}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_image_writer_pli_a241bd679b13e40b25f9ab5f11d68130f}\label{class_t_image_writer_pli_a241bd679b13e40b25f9ab5f11d68130f}} 
\index{TImageWriterPli@{TImageWriterPli}!````~TImageWriterPli@{$\sim$TImageWriterPli}}
\index{````~TImageWriterPli@{$\sim$TImageWriterPli}!TImageWriterPli@{TImageWriterPli}}
\doxysubsubsection{\texorpdfstring{$\sim$TImageWriterPli()}{~TImageWriterPli()}}
{\footnotesize\ttfamily TImage\+Writer\+Pli\+::$\sim$\+TImage\+Writer\+Pli (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00247 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_t_image_writer_pli_ab513e8e3229aa06caab1883bb5a539d3}\label{class_t_image_writer_pli_ab513e8e3229aa06caab1883bb5a539d3}} 
\index{TImageWriterPli@{TImageWriterPli}!save@{save}}
\index{save@{save}!TImageWriterPli@{TImageWriterPli}}
\doxysubsubsection{\texorpdfstring{save()}{save()}}
{\footnotesize\ttfamily void TImage\+Writer\+Pli\+::save (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \&}]{img }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_image_writer}{TImage\+Writer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00524                                              \{}
\DoxyCodeLine{00525   \textcolor{comment}{// Allocate an image}}
\DoxyCodeLine{00526   \mbox{\hyperlink{class_t_vector_image_p}{TVectorImageP}} tempVecImg = img;}
\DoxyCodeLine{00527   \textcolor{keywordtype}{int} currStyleId          = -\/1;}
\DoxyCodeLine{00528   \textcolor{keywordflow}{if} (!tempVecImg) \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_image_exception}{TImageException}}(m\_path, \textcolor{stringliteral}{"{}No data to save"{}});}
\DoxyCodeLine{00529 }
\DoxyCodeLine{00530   \textcolor{comment}{//  Check that the frame about to insert is not already present}}
\DoxyCodeLine{00531   \textcolor{comment}{//   So you do not increase the number of current frames}}
\DoxyCodeLine{00532   ++m\_lwp-\/>m\_frameNumber;}
\DoxyCodeLine{00533 }
\DoxyCodeLine{00534   std::unique\_ptr<IntersectionBranch[]> v;}
\DoxyCodeLine{00535   UINT intersectionSize = tempVecImg-\/>getFillData(v);}
\DoxyCodeLine{00536 }
\DoxyCodeLine{00537   \textcolor{comment}{// alloco l'oggetto m\_lwp-\/>m\_pli ( di tipo ParsedPli ) che si occupa di}}
\DoxyCodeLine{00538   \textcolor{comment}{// costruire la struttura}}
\DoxyCodeLine{00539   \textcolor{keywordflow}{if} (!m\_lwp-\/>m\_pli) \{}
\DoxyCodeLine{00540     m\_lwp-\/>m\_pli.reset(\textcolor{keyword}{new} \mbox{\hyperlink{class_parsed_pli}{ParsedPli}}(m\_lwp-\/>m\_frameNumber, m\_precision, 40,}
\DoxyCodeLine{00541                                      tempVecImg-\/>getAutocloseTolerance()));}
\DoxyCodeLine{00542     m\_lwp-\/>m\_pli-\/>setCreator(m\_lwp-\/>m\_creator);}
\DoxyCodeLine{00543   \}}
\DoxyCodeLine{00544 }
\DoxyCodeLine{00545   buildPalette(m\_lwp-\/>m\_pli.get(), img);}
\DoxyCodeLine{00546 }
\DoxyCodeLine{00547   \mbox{\hyperlink{class_parsed_pli}{ParsedPli}} *pli = m\_lwp-\/>m\_pli.get();}
\DoxyCodeLine{00548 }
\DoxyCodeLine{00549   \textcolor{comment}{/*}}
\DoxyCodeLine{00550 \textcolor{comment}{comunico che il numero di frame e' aumentato (il parsed lo riceve nel}}
\DoxyCodeLine{00551 \textcolor{comment}{solo nel costruttore)}}
\DoxyCodeLine{00552 \textcolor{comment}{*/}}
\DoxyCodeLine{00553   pli-\/>setFrameCount(m\_lwp-\/>m\_frameNumber);}
\DoxyCodeLine{00554 }
\DoxyCodeLine{00555   \textcolor{comment}{// alloco la struttura che conterra' i tag per la vector image corrente}}
\DoxyCodeLine{00556   std::vector<PliObjectTag *> tags;}
\DoxyCodeLine{00557   \textcolor{comment}{// tags = new   std::vector<PliObjectTag *>;}}
\DoxyCodeLine{00558 }
\DoxyCodeLine{00559   \textcolor{comment}{// Store the precision scale to be used in saving the quadratics}}
\DoxyCodeLine{00560   \{}
\DoxyCodeLine{00561     \textcolor{keywordtype}{int} precisionScale    = sq(128);}
\DoxyCodeLine{00562     pli-\/>precisionScale() = precisionScale;}
\DoxyCodeLine{00563 }
\DoxyCodeLine{00564     \mbox{\hyperlink{class_pli_tag}{PliTag}} *tag = \textcolor{keyword}{new} \mbox{\hyperlink{class_precision_scale_tag}{PrecisionScaleTag}}(precisionScale);}
\DoxyCodeLine{00565     tags.push\_back((\mbox{\hyperlink{class_pli_object_tag}{PliObjectTag}} *)tag);}
\DoxyCodeLine{00566   \}}
\DoxyCodeLine{00567 }
\DoxyCodeLine{00568   \textcolor{comment}{// update the format version if multiple suffixes is supported0}}
\DoxyCodeLine{00569   \textcolor{keywordflow}{if} (!TFilePath::useStandard()) pli-\/>setVersion(150, 0);}
\DoxyCodeLine{00570   \textcolor{comment}{// Store the auto close tolerance}}
\DoxyCodeLine{00571   \textcolor{keywordtype}{double} pliTolerance = m\_lwp-\/>m\_pli-\/>getAutocloseTolerance();}
\DoxyCodeLine{00572   \textcolor{comment}{// write the tag if the frame's tolerance has been changed or}}
\DoxyCodeLine{00573   \textcolor{comment}{// if the first frame's tolerance (and therefore the level's tolerance)}}
\DoxyCodeLine{00574   \textcolor{comment}{// has been changed.}}
\DoxyCodeLine{00575   \textcolor{keywordflow}{if} (!areAlmostEqual(tempVecImg-\/>getAutocloseTolerance(), 1.15, 0.001) ||}
\DoxyCodeLine{00576       !areAlmostEqual(pliTolerance, 1.15, 0.001)) \{}
\DoxyCodeLine{00577     \textcolor{keywordtype}{int} tolerance =}
\DoxyCodeLine{00578         (int)((roundf(tempVecImg-\/>getAutocloseTolerance() * 100) / 100) * 1000);}
\DoxyCodeLine{00579     \mbox{\hyperlink{class_pli_tag}{PliTag}} *tag = \textcolor{keyword}{new} \mbox{\hyperlink{class_auto_close_tolerance_tag}{AutoCloseToleranceTag}}(tolerance);}
\DoxyCodeLine{00580     tags.push\_back((\mbox{\hyperlink{class_pli_object_tag}{PliObjectTag}} *)tag);}
\DoxyCodeLine{00581     pli-\/>setVersion(120, 0);}
\DoxyCodeLine{00582   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00583     pli-\/>setVersion(71, 0);}
\DoxyCodeLine{00584   \}}
\DoxyCodeLine{00585   \textcolor{comment}{// recupero il numero di stroke dall'immagine}}
\DoxyCodeLine{00586   \textcolor{keywordtype}{int} numStrokes = tempVecImg-\/>getStrokeCount();}
\DoxyCodeLine{00587 }
\DoxyCodeLine{00588   \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{00589   \textcolor{keywordflow}{while} (i < (UINT)numStrokes) \{}
\DoxyCodeLine{00590     \textcolor{keywordflow}{if} (tempVecImg-\/>isStrokeGrouped(i))}
\DoxyCodeLine{00591       tags.push\_back(makeGroup(tempVecImg, currStyleId, i, 1));}
\DoxyCodeLine{00592     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00593       putStroke(tempVecImg-\/>getStroke(i++), currStyleId, tags);}
\DoxyCodeLine{00594   \}}
\DoxyCodeLine{00595 }
\DoxyCodeLine{00596   \textcolor{keywordflow}{if} (intersectionSize > 0) \{}
\DoxyCodeLine{00597     \mbox{\hyperlink{class_pli_tag}{PliTag}} *tag = \textcolor{keyword}{new} \mbox{\hyperlink{class_intersection_data_tag}{IntersectionDataTag}}(intersectionSize, std::move(v));}
\DoxyCodeLine{00598     tags.push\_back((\mbox{\hyperlink{class_pli_object_tag}{PliObjectTag}} *)tag);}
\DoxyCodeLine{00599   \}}
\DoxyCodeLine{00600 }
\DoxyCodeLine{00601   \textcolor{keywordtype}{int} tagsSize = tags.size();}
\DoxyCodeLine{00602   std::unique\_ptr<ImageTag> imageTagPtr(\textcolor{keyword}{new} \mbox{\hyperlink{class_image_tag}{ImageTag}}(}
\DoxyCodeLine{00603       m\_frameId, tagsSize, (tagsSize > 0) ? tags.data() : \textcolor{keyword}{nullptr}));}
\DoxyCodeLine{00604 }
\DoxyCodeLine{00605   pli-\/>addTag(imageTagPtr.release());}
\DoxyCodeLine{00606 }
\DoxyCodeLine{00607   \textcolor{comment}{// il ritorno e' fissato a false in quanto la}}
\DoxyCodeLine{00608   \textcolor{comment}{//  scrittura avviene alla distruzione dello scrittore di livelli}}
\DoxyCodeLine{00609   \textcolor{keywordflow}{return};  \textcolor{comment}{// davedere false;}}
\DoxyCodeLine{00610 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_t_image_writer_pli_ac922faaa3d0d6d17bcf42e9f3098f4e7}\label{class_t_image_writer_pli_ac922faaa3d0d6d17bcf42e9f3098f4e7}} 
\index{TImageWriterPli@{TImageWriterPli}!m\_frameId@{m\_frameId}}
\index{m\_frameId@{m\_frameId}!TImageWriterPli@{TImageWriterPli}}
\doxysubsubsection{\texorpdfstring{m\_frameId}{m\_frameId}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} TImage\+Writer\+Pli\+::m\+\_\+frame\+Id}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/image/pli/tiio\+\_\+pli.\+cpp\end{DoxyCompactItemize}
