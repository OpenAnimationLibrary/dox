\hypertarget{class_flip_book_pool}{}\doxysection{Flip\+Book\+Pool Class Reference}
\label{class_flip_book_pool}\index{FlipBookPool@{FlipBookPool}}


The \mbox{\hyperlink{class_flip_book_pool}{Flip\+Book\+Pool}} class is used to store used flipbook viewers.  


\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_flip_book_pool_a52a619f7fa4db67b6dd7a6872e0de4ce}{load}} (const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&history\+Path)
\begin{DoxyCompactList}\small\item\em Loads the pool from input history. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_flip_book_pool_ac3a7623ffdc98e25fffb088ac2149fb6}{save}} () const
\begin{DoxyCompactList}\small\item\em Saves the content of this flipbook pool. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_flip_book}{Flip\+Book}} $\ast$ \mbox{\hyperlink{class_flip_book_pool_aa110af5e7e2650be4540744f53de314b}{pop}} ()
\item 
void \mbox{\hyperlink{class_flip_book_pool_ae9ff10cf6270ec4840393354c581ee7a}{push}} (\mbox{\hyperlink{class_flip_book}{Flip\+Book}} $\ast$flipbook)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{class_flip_book_pool}{Flip\+Book\+Pool}} $\ast$ \mbox{\hyperlink{class_flip_book_pool_a583029577ff36391dac319c2634c931c}{instance}} ()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The \mbox{\hyperlink{class_flip_book_pool}{Flip\+Book\+Pool}} class is used to store used flipbook viewers. 

Flipbooks are generally intended as temporary but friendly floating widgets, that gets displayed when a rendered scene or image needs to be shown. Since a user may require that the geometry of a flipbook is to be remembered between rendering tasks -\/ perhaps even between different Toonz sessions -\/ flipbooks are always stored for later use in a {\bfseries{\mbox{\hyperlink{class_flip_book_pool}{Flip\+Book\+Pool}}}} class.

This class implements the basical features to {\bfseries{pop}} a flipbook from the pool or {\bfseries{push}} a used one; plus, it provides the {\bfseries{save}} and {\bfseries{load}} functions for persistent storage between Toonz sessions.

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_flip_book}{Flip\+Book}} class. 
\end{DoxySeeAlso}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_flip_book_pool_abce761d412f1e823720274b32a3e598c}\label{class_flip_book_pool_abce761d412f1e823720274b32a3e598c}} 
\index{FlipBookPool@{FlipBookPool}!FlipBookPool@{FlipBookPool}}
\index{FlipBookPool@{FlipBookPool}!FlipBookPool@{FlipBookPool}}
\doxysubsubsection{\texorpdfstring{FlipBookPool()}{FlipBookPool()}}
{\footnotesize\ttfamily Flip\+Book\+Pool\+::\+Flip\+Book\+Pool (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00846                            : m\_overallFlipCount(0) \{}
\DoxyCodeLine{00847   qRegisterMetaType<ImagePainter::VisualSettings>(}
\DoxyCodeLine{00848       \textcolor{stringliteral}{"{}ImagePainter::VisualSettings"{}});}
\DoxyCodeLine{00849 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_flip_book_pool_a6cc4ae49fe6dc67940e74856889feabb}\label{class_flip_book_pool_a6cc4ae49fe6dc67940e74856889feabb}} 
\index{FlipBookPool@{FlipBookPool}!````~FlipBookPool@{$\sim$FlipBookPool}}
\index{````~FlipBookPool@{$\sim$FlipBookPool}!FlipBookPool@{FlipBookPool}}
\doxysubsubsection{\texorpdfstring{$\sim$FlipBookPool()}{~FlipBookPool()}}
{\footnotesize\ttfamily Flip\+Book\+Pool\+::$\sim$\+Flip\+Book\+Pool (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00853 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_flip_book_pool_a583029577ff36391dac319c2634c931c}\label{class_flip_book_pool_a583029577ff36391dac319c2634c931c}} 
\index{FlipBookPool@{FlipBookPool}!instance@{instance}}
\index{instance@{instance}!FlipBookPool@{FlipBookPool}}
\doxysubsubsection{\texorpdfstring{instance()}{instance()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_flip_book_pool}{Flip\+Book\+Pool}} $\ast$ Flip\+Book\+Pool\+::instance (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00857                                      \{}
\DoxyCodeLine{00858   \textcolor{keyword}{static} \mbox{\hyperlink{class_flip_book_pool}{FlipBookPool}} poolInstance;}
\DoxyCodeLine{00859   \textcolor{keywordflow}{return} \&poolInstance;}
\DoxyCodeLine{00860 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_flip_book_pool_a52a619f7fa4db67b6dd7a6872e0de4ce}\label{class_flip_book_pool_a52a619f7fa4db67b6dd7a6872e0de4ce}} 
\index{FlipBookPool@{FlipBookPool}!load@{load}}
\index{load@{load}!FlipBookPool@{FlipBookPool}}
\doxysubsubsection{\texorpdfstring{load()}{load()}}
{\footnotesize\ttfamily void Flip\+Book\+Pool\+::load (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{history\+Path }\end{DoxyParamCaption})}



Loads the pool from input history. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00948                                                     \{}
\DoxyCodeLine{00949   QSettings history(toQString(historyPath), QSettings::IniFormat);}
\DoxyCodeLine{00950   m\_historyPath = historyPath;}
\DoxyCodeLine{00951 }
\DoxyCodeLine{00952   m\_pool.clear();}
\DoxyCodeLine{00953   m\_geometryPool.clear();}
\DoxyCodeLine{00954 }
\DoxyCodeLine{00955   m\_overallFlipCount = history.value(\textcolor{stringliteral}{"{}count"{}}).toInt();}
\DoxyCodeLine{00956 }
\DoxyCodeLine{00957   history.beginGroup(\textcolor{stringliteral}{"{}flipbooks"{}});}
\DoxyCodeLine{00958 }
\DoxyCodeLine{00959   QStringList flipBooks(history.childGroups());}
\DoxyCodeLine{00960   QStringList::iterator it;}
\DoxyCodeLine{00961   \textcolor{keywordflow}{for} (it = flipBooks.begin(); it != flipBooks.end(); ++it) \{}
\DoxyCodeLine{00962     history.beginGroup(*it);}
\DoxyCodeLine{00963 }
\DoxyCodeLine{00964     \textcolor{comment}{// Retrieve flipbook geometry}}
\DoxyCodeLine{00965     QVariant geom = history.value(\textcolor{stringliteral}{"{}geometry"{}});}
\DoxyCodeLine{00966 }
\DoxyCodeLine{00967     \textcolor{comment}{// Insert geometry}}
\DoxyCodeLine{00968     m\_geometryPool.insert(pair<int, QRect>(it-\/>toInt(), geom.toRect()));}
\DoxyCodeLine{00969 }
\DoxyCodeLine{00970     history.endGroup();}
\DoxyCodeLine{00971   \}}
\DoxyCodeLine{00972 }
\DoxyCodeLine{00973   history.endGroup();}
\DoxyCodeLine{00974 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_flip_book_pool_aa110af5e7e2650be4540744f53de314b}\label{class_flip_book_pool_aa110af5e7e2650be4540744f53de314b}} 
\index{FlipBookPool@{FlipBookPool}!pop@{pop}}
\index{pop@{pop}!FlipBookPool@{FlipBookPool}}
\doxysubsubsection{\texorpdfstring{pop()}{pop()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_flip_book}{Flip\+Book}} $\ast$ Flip\+Book\+Pool\+::pop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Extracts the first unused flipbook from the flipbook pool. If all known flipbooks are shown, allocates a new flipbook with the first unused flipbook geometry in a geometry pool. Again, if all recorded geometry are used by some existing flipbook, a default geometry is used. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00875                             \{}
\DoxyCodeLine{00876   \mbox{\hyperlink{class_flip_book}{FlipBook}} *flipbook;}
\DoxyCodeLine{00877   \mbox{\hyperlink{class_t_panel}{TPanel}} *panel;}
\DoxyCodeLine{00878 }
\DoxyCodeLine{00879   \mbox{\hyperlink{class_t_main_window}{TMainWindow}} *currentRoom = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a2e2e36211e0221b0f58694b169fc7904}{getCurrentRoom}}();}
\DoxyCodeLine{00880 }
\DoxyCodeLine{00881   \textcolor{keywordflow}{if} (m\_pool.empty()) \{}
\DoxyCodeLine{00882     panel = TPanelFactory::createPanel(currentRoom, \textcolor{stringliteral}{"{}FlipBook"{}});}
\DoxyCodeLine{00883     panel-\/>\mbox{\hyperlink{class_t_dock_widget_a82cb9128c0aafa45faa75ac25cfd062b}{setFloating}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00884 }
\DoxyCodeLine{00885     flipbook = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_flip_book}{FlipBook}} *\textcolor{keyword}{>}(panel-\/>widget());}
\DoxyCodeLine{00886 }
\DoxyCodeLine{00887     \textcolor{comment}{// Set geometry}}
\DoxyCodeLine{00888     \textcolor{keyword}{static} \textcolor{keywordtype}{int} x = 0, y = 0;}
\DoxyCodeLine{00889     \textcolor{keywordflow}{if} (m\_geometryPool.empty()) \{}
\DoxyCodeLine{00890       panel-\/>setGeometry(x += 50, y += 50, 400, 300);}
\DoxyCodeLine{00891       flipbook-\/>setPoolIndex(m\_overallFlipCount);}
\DoxyCodeLine{00892       m\_overallFlipCount++;}
\DoxyCodeLine{00893     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00894       flipbook-\/>setPoolIndex(m\_geometryPool.begin()-\/>first);}
\DoxyCodeLine{00895       QRect geometry(m\_geometryPool.begin()-\/>second);}
\DoxyCodeLine{00896       panel-\/>setGeometry(geometry);}
\DoxyCodeLine{00897       \textcolor{keywordflow}{if} ((geometry \& QApplication::desktop()-\/>availableGeometry(panel))}
\DoxyCodeLine{00898               .isEmpty())}
\DoxyCodeLine{00899         panel-\/>move(x += 50, y += 50);}
\DoxyCodeLine{00900       m\_geometryPool.erase(m\_geometryPool.begin());}
\DoxyCodeLine{00901     \}}
\DoxyCodeLine{00902   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00903     flipbook = m\_pool.begin()-\/>second;}
\DoxyCodeLine{00904     panel    = (\mbox{\hyperlink{class_t_panel}{TPanel}} *)flipbook-\/>parent();}
\DoxyCodeLine{00905     m\_pool.erase(m\_pool.begin());}
\DoxyCodeLine{00906   \}}
\DoxyCodeLine{00907 }
\DoxyCodeLine{00908   \textcolor{comment}{// The panel need to be added to currentRoom's layout control.}}
\DoxyCodeLine{00909   currentRoom-\/>\mbox{\hyperlink{class_t_main_window_a5bd7a251e7bca80111d0d9bd90943015}{addDockWidget}}(panel);}
\DoxyCodeLine{00910   panel-\/>raise();}
\DoxyCodeLine{00911   panel-\/>show();}
\DoxyCodeLine{00912 }
\DoxyCodeLine{00913   \textcolor{keywordflow}{return} flipbook;}
\DoxyCodeLine{00914 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00066}{TMain\+Window\+::add\+Dock\+Widget()}}, \mbox{\hyperlink{l00236}{TApp\+::get\+Current\+Room()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, and \mbox{\hyperlink{l00262}{TDock\+Widget\+::set\+Floating()}}.

\mbox{\Hypertarget{class_flip_book_pool_ae9ff10cf6270ec4840393354c581ee7a}\label{class_flip_book_pool_ae9ff10cf6270ec4840393354c581ee7a}} 
\index{FlipBookPool@{FlipBookPool}!push@{push}}
\index{push@{push}!FlipBookPool@{FlipBookPool}}
\doxysubsubsection{\texorpdfstring{push()}{push()}}
{\footnotesize\ttfamily void Flip\+Book\+Pool\+::push (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_flip_book}{Flip\+Book}} $\ast$}]{flipbook }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00864                                           \{}
\DoxyCodeLine{00865   m\_pool.insert(pair<int, FlipBook *>(flipbook-\/>getPoolIndex(), flipbook));}
\DoxyCodeLine{00866 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_flip_book_pool_ac3a7623ffdc98e25fffb088ac2149fb6}\label{class_flip_book_pool_ac3a7623ffdc98e25fffb088ac2149fb6}} 
\index{FlipBookPool@{FlipBookPool}!save@{save}}
\index{save@{save}!FlipBookPool@{FlipBookPool}}
\doxysubsubsection{\texorpdfstring{save()}{save()}}
{\footnotesize\ttfamily void Flip\+Book\+Pool\+::save (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Saves the content of this flipbook pool. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00919                               \{}
\DoxyCodeLine{00920   QSettings history(toQString(m\_historyPath), QSettings::IniFormat);}
\DoxyCodeLine{00921   history.clear();}
\DoxyCodeLine{00922 }
\DoxyCodeLine{00923   history.setValue(\textcolor{stringliteral}{"{}count"{}}, m\_overallFlipCount);}
\DoxyCodeLine{00924 }
\DoxyCodeLine{00925   history.beginGroup(\textcolor{stringliteral}{"{}flipbooks"{}});}
\DoxyCodeLine{00926 }
\DoxyCodeLine{00927   std::map<int, FlipBook *>::const\_iterator it;}
\DoxyCodeLine{00928   \textcolor{keywordflow}{for} (it = m\_pool.begin(); it != m\_pool.end(); ++it) \{}
\DoxyCodeLine{00929     history.beginGroup(QString::number(it-\/>first));}
\DoxyCodeLine{00930     \mbox{\hyperlink{class_t_panel}{TPanel}} *panel = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_t_panel}{TPanel}} *\textcolor{keyword}{>}(it-\/>second-\/>parent());}
\DoxyCodeLine{00931     history.setValue(\textcolor{stringliteral}{"{}geometry"{}}, panel-\/>geometry());}
\DoxyCodeLine{00932     history.endGroup();}
\DoxyCodeLine{00933   \}}
\DoxyCodeLine{00934 }
\DoxyCodeLine{00935   std::map<int, QRect>::const\_iterator jt;}
\DoxyCodeLine{00936   \textcolor{keywordflow}{for} (jt = m\_geometryPool.begin(); jt != m\_geometryPool.end(); ++jt) \{}
\DoxyCodeLine{00937     history.beginGroup(QString::number(jt-\/>first));}
\DoxyCodeLine{00938     history.setValue(\textcolor{stringliteral}{"{}geometry"{}}, jt-\/>second);}
\DoxyCodeLine{00939     history.endGroup();}
\DoxyCodeLine{00940   \}}
\DoxyCodeLine{00941 }
\DoxyCodeLine{00942   history.endGroup();}
\DoxyCodeLine{00943 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonz/flipbook.\+h\item 
E\+:/opentoonz/toonz/sources/toonz/flipbook.\+cpp\end{DoxyCompactItemize}
