\hypertarget{class_change_color_fx}{}\doxysection{Change\+Color\+Fx Class Reference}
\label{class_change_color_fx}\index{ChangeColorFx@{ChangeColorFx}}
Inheritance diagram for Change\+Color\+Fx\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.645833cm]{class_change_color_fx}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{class_change_color_fx_a203fd4e0dbe7d900aa11acdac6a503c7}{do\+Get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&b\+Box, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
void \mbox{\hyperlink{class_change_color_fx_a7299510bf00ffdc53756fc5773c420c0}{do\+Compute}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&ri) override
\item 
bool \mbox{\hyperlink{class_change_color_fx_a2e979e0eaaac93fdbe124b075c2cf14a}{get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&b\+Box, TPixel32 \&bg\+Color)
\item 
\mbox{\Hypertarget{class_change_color_fx_a2cad635d45158312d21050c536d01bb3}\label{class_change_color_fx_a2cad635d45158312d21050c536d01bb3}} 
void {\bfseries compute} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const TRaster\+Fx\+Render\+Info $\ast$ri)
\item 
\mbox{\hyperlink{class_t_rect_t}{TRect}} \mbox{\hyperlink{class_change_color_fx_a3e54035639e227924e11b70b38300c27}{get\+Invalid\+Rect}} (const \mbox{\hyperlink{class_t_rect_t}{TRect}} \&max)
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_change_color_fx_a022263b4e505ea9a64bba357bab5a4cc}\label{class_change_color_fx_a022263b4e505ea9a64bba357bab5a4cc}} 
\index{ChangeColorFx@{ChangeColorFx}!ChangeColorFx@{ChangeColorFx}}
\index{ChangeColorFx@{ChangeColorFx}!ChangeColorFx@{ChangeColorFx}}
\doxysubsubsection{\texorpdfstring{ChangeColorFx()}{ChangeColorFx()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Change\+Color\+Fx\+::\+Change\+Color\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00112       : m\_from\_color(TPixel32::Red)}
\DoxyCodeLine{00113       , m\_to\_color(TPixel32::Blue)}
\DoxyCodeLine{00114       , m\_range(0.0)}
\DoxyCodeLine{00115       , m\_falloff(0.0) \{}
\DoxyCodeLine{00116     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Source"{}}, m\_input);}
\DoxyCodeLine{00117     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}range"{}}, m\_range);}
\DoxyCodeLine{00118     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}falloff"{}}, m\_falloff);}
\DoxyCodeLine{00119     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}from\_color"{}}, m\_from\_color);}
\DoxyCodeLine{00120     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}to\_color"{}}, m\_to\_color);}
\DoxyCodeLine{00121     m\_range-\/>setValueRange(0, 100);}
\DoxyCodeLine{00122     m\_falloff-\/>setValueRange(0, 100);}
\DoxyCodeLine{00123   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_change_color_fx_a07d5b7f17c43c8f4b28b21dd45f42239}\label{class_change_color_fx_a07d5b7f17c43c8f4b28b21dd45f42239}} 
\index{ChangeColorFx@{ChangeColorFx}!````~ChangeColorFx@{$\sim$ChangeColorFx}}
\index{````~ChangeColorFx@{$\sim$ChangeColorFx}!ChangeColorFx@{ChangeColorFx}}
\doxysubsubsection{\texorpdfstring{$\sim$ChangeColorFx()}{~ChangeColorFx()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Change\+Color\+Fx\+::$\sim$\+Change\+Color\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00124 \{\};}

\end{DoxyCode}
\mbox{\Hypertarget{class_change_color_fx_a022263b4e505ea9a64bba357bab5a4cc}\label{class_change_color_fx_a022263b4e505ea9a64bba357bab5a4cc}} 
\index{ChangeColorFx@{ChangeColorFx}!ChangeColorFx@{ChangeColorFx}}
\index{ChangeColorFx@{ChangeColorFx}!ChangeColorFx@{ChangeColorFx}}
\doxysubsubsection{\texorpdfstring{ChangeColorFx()}{ChangeColorFx()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily Change\+Color\+Fx\+::\+Change\+Color\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00018       : m\_from\_color(TPixel32::Red)}
\DoxyCodeLine{00019       , m\_to\_color(TPixel32::Blue)}
\DoxyCodeLine{00020       , m\_range(0.0)}
\DoxyCodeLine{00021       , m\_falloff(0.0) \{}
\DoxyCodeLine{00022     addPort(\textcolor{stringliteral}{"{}Source"{}}, m\_input);}
\DoxyCodeLine{00023     addParam(\textcolor{stringliteral}{"{}range"{}}, m\_range);}
\DoxyCodeLine{00024     addParam(\textcolor{stringliteral}{"{}falloff"{}}, m\_falloff);}
\DoxyCodeLine{00025     addParam(\textcolor{stringliteral}{"{}from\_color"{}}, m\_from\_color);}
\DoxyCodeLine{00026     addParam(\textcolor{stringliteral}{"{}to\_color"{}}, m\_to\_color);}
\DoxyCodeLine{00027     m\_range-\/>setValueRange(0, 1);}
\DoxyCodeLine{00028     m\_falloff-\/>setValueRange(0, 1);}
\DoxyCodeLine{00029   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_change_color_fx_a07d5b7f17c43c8f4b28b21dd45f42239}\label{class_change_color_fx_a07d5b7f17c43c8f4b28b21dd45f42239}} 
\index{ChangeColorFx@{ChangeColorFx}!````~ChangeColorFx@{$\sim$ChangeColorFx}}
\index{````~ChangeColorFx@{$\sim$ChangeColorFx}!ChangeColorFx@{ChangeColorFx}}
\doxysubsubsection{\texorpdfstring{$\sim$ChangeColorFx()}{~ChangeColorFx()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily Change\+Color\+Fx\+::$\sim$\+Change\+Color\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00030 \{\};}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_change_color_fx_a7299510bf00ffdc53756fc5773c420c0}\label{class_change_color_fx_a7299510bf00ffdc53756fc5773c420c0}} 
\index{ChangeColorFx@{ChangeColorFx}!doCompute@{doCompute}}
\index{doCompute@{doCompute}!ChangeColorFx@{ChangeColorFx}}
\doxysubsubsection{\texorpdfstring{doCompute()}{doCompute()}}
{\footnotesize\ttfamily void Change\+Color\+Fx\+::do\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{ri }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00146                                                          \{}
\DoxyCodeLine{00147   \textcolor{keywordflow}{if} (!m\_input.isConnected()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00148 }
\DoxyCodeLine{00149   m\_input-\/>compute(tile, frame, ri);}
\DoxyCodeLine{00150 }
\DoxyCodeLine{00151   \textcolor{keywordtype}{double} from\_h, from\_s, from\_v, to\_h, to\_s, to\_v;}
\DoxyCodeLine{00152   \textcolor{keywordtype}{bool} swaprange = \textcolor{keyword}{false}, swapfallmin = \textcolor{keyword}{false}, swapfallmax;}
\DoxyCodeLine{00153   TPixel32 from\_color = m\_from\_color-\/>getPremultipliedValue(frame);}
\DoxyCodeLine{00154   TPixel32 to\_color   = m\_to\_color-\/>getPremultipliedValue(frame);}
\DoxyCodeLine{00155   \textcolor{keywordtype}{double} range        = m\_range-\/>getValue(frame) / 100;}
\DoxyCodeLine{00156   \textcolor{keywordtype}{double} falloff      = m\_falloff-\/>getValue(frame) / 100;}
\DoxyCodeLine{00157 }
\DoxyCodeLine{00158   OLDRGB2HSV(from\_color.r / 255.0, from\_color.g / 255.0, from\_color.b / 255.0,}
\DoxyCodeLine{00159              \&from\_h, \&from\_s, \&from\_v);}
\DoxyCodeLine{00160   OLDRGB2HSV(to\_color.r / 255.0, to\_color.g / 255.0, to\_color.b / 255.0, \&to\_h,}
\DoxyCodeLine{00161              \&to\_s, \&to\_v);}
\DoxyCodeLine{00162   \textcolor{comment}{/*}}
\DoxyCodeLine{00163 \textcolor{comment}{int from\_hsv[3];}}
\DoxyCodeLine{00164 \textcolor{comment}{int to\_hsv[3];}}
\DoxyCodeLine{00165 \textcolor{comment}{rgb2hsv(from\_hsv, from\_color);}}
\DoxyCodeLine{00166 \textcolor{comment}{rgb2hsv(to\_hsv, to\_color);}}
\DoxyCodeLine{00167 \textcolor{comment}{}}
\DoxyCodeLine{00169 \textcolor{comment}{from\_h =((double)from\_hsv[0]/255.)*360.;}}
\DoxyCodeLine{00170 \textcolor{comment}{from\_s =from\_hsv[1]/255.;}}
\DoxyCodeLine{00171 \textcolor{comment}{from\_v =from\_hsv[2]/255.;}}
\DoxyCodeLine{00172 \textcolor{comment}{to\_h =((double)to\_hsv[0]/255.)*360.;}}
\DoxyCodeLine{00173 \textcolor{comment}{to\_s =to\_hsv[1]/255.;}}
\DoxyCodeLine{00174 \textcolor{comment}{to\_v =to\_hsv[2]/255.;}}
\DoxyCodeLine{00175 \textcolor{comment}{*/}}
\DoxyCodeLine{00177   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} raster32 = tile.getRaster();}
\DoxyCodeLine{00178   assert(raster32);  \textcolor{comment}{// per ora gestisco solo i Raster32}}
\DoxyCodeLine{00179 }
\DoxyCodeLine{00180   \textcolor{keywordtype}{double} hmin = from\_h -\/ range * 180;}
\DoxyCodeLine{00181   hmin        = normalize\_h(hmin);}
\DoxyCodeLine{00182   \textcolor{keywordtype}{double} hmax = from\_h + range * 180;}
\DoxyCodeLine{00183   hmax        = normalize\_h(hmax);}
\DoxyCodeLine{00184   \textcolor{keywordflow}{if} (hmax <= hmin) \{}
\DoxyCodeLine{00185     std::swap(hmin, hmax);}
\DoxyCodeLine{00186     swaprange = \textcolor{keyword}{true};}
\DoxyCodeLine{00187   \}}
\DoxyCodeLine{00188   \textcolor{keywordtype}{double} smin     = from\_s -\/ range;}
\DoxyCodeLine{00189   \textcolor{keywordtype}{double} smax     = from\_s + range;}
\DoxyCodeLine{00190   \textcolor{keywordtype}{double} vmin     = from\_v -\/ range;}
\DoxyCodeLine{00191   \textcolor{keywordtype}{double} vmax     = from\_v + range;}
\DoxyCodeLine{00192   \textcolor{keywordtype}{double} hfallmin = hmin -\/ falloff * 180;}
\DoxyCodeLine{00193   \textcolor{keywordtype}{double} hfallmax = hmax + falloff * 180;}
\DoxyCodeLine{00194   hfallmin        = normalize\_h(hfallmin);}
\DoxyCodeLine{00195   hfallmax        = normalize\_h(hfallmax);}
\DoxyCodeLine{00196   \textcolor{keywordflow}{if} (hfallmin > hmin) \{}
\DoxyCodeLine{00197     swapfallmin = \textcolor{keyword}{true};}
\DoxyCodeLine{00198   \}}
\DoxyCodeLine{00199   \textcolor{keywordflow}{if} (hfallmax < hmax) \{}
\DoxyCodeLine{00200     swapfallmax = \textcolor{keyword}{true};}
\DoxyCodeLine{00201   \}}
\DoxyCodeLine{00202   \textcolor{keywordtype}{double} sfallmin = smin -\/ falloff;}
\DoxyCodeLine{00203   \textcolor{keywordtype}{double} sfallmax = smax + falloff;}
\DoxyCodeLine{00204   \textcolor{keywordtype}{double} vfallmin = vmin -\/ falloff;}
\DoxyCodeLine{00205   \textcolor{keywordtype}{double} vfallmax = vmax + falloff;}
\DoxyCodeLine{00206 }
\DoxyCodeLine{00207   \textcolor{keywordtype}{int} j;}
\DoxyCodeLine{00208   raster32-\/>lock();}
\DoxyCodeLine{00209   \textcolor{keywordflow}{for} (j = 0; j < raster32-\/>getLy(); j++) \{}
\DoxyCodeLine{00210     TPixel32 *pix    = raster32-\/>pixels(j);}
\DoxyCodeLine{00211     TPixel32 *endPix = pix + raster32-\/>getLx();}
\DoxyCodeLine{00212     \textcolor{keywordflow}{while} (pix < endPix) \{}
\DoxyCodeLine{00213       \textcolor{keywordtype}{double} r, g, b, h, s, v;}
\DoxyCodeLine{00214       r = pix-\/>r / 255.0;}
\DoxyCodeLine{00215       g = pix-\/>g / 255.0;}
\DoxyCodeLine{00216       b = pix-\/>b / 255.0;}
\DoxyCodeLine{00217       \textcolor{comment}{// int hsv[3];}}
\DoxyCodeLine{00218       OLDRGB2HSV(r, g, b, \&h, \&s, \&v);}
\DoxyCodeLine{00219       \textcolor{keywordtype}{int} hflag            = (h <= hmax \&\& h >= hmin);}
\DoxyCodeLine{00220       \textcolor{keywordflow}{if} (swaprange) hflag = !hflag;}
\DoxyCodeLine{00221       \textcolor{keywordflow}{if} (hflag \&\& s <= smax \&\& s >= smin \&\& v <= vmax \&\& v >= vmin)}
\DoxyCodeLine{00222         *pix = to\_color;}
\DoxyCodeLine{00223       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00224         \textcolor{keywordtype}{double} hcorr            = 0;}
\DoxyCodeLine{00225         \textcolor{keywordtype}{double} scorr            = 0;}
\DoxyCodeLine{00226         \textcolor{keywordtype}{double} vcorr            = 0;}
\DoxyCodeLine{00227         \textcolor{keywordtype}{int} hfallminflag        = (h <= hmin \&\& h >= hfallmin);}
\DoxyCodeLine{00228         \textcolor{keywordflow}{if} (hfallminflag) hcorr = h -\/ hmin;}
\DoxyCodeLine{00229         \textcolor{keywordtype}{int} hfallmaxflag        = (h >= hmax \&\& h <= hfallmax);}
\DoxyCodeLine{00230         \textcolor{keywordflow}{if} (hfallmaxflag) hcorr = h -\/ hmax;}
\DoxyCodeLine{00231         \textcolor{keywordflow}{if} (hcorr) \{}
\DoxyCodeLine{00232           \textcolor{keywordflow}{if} (s <= smin \&\& s >= sfallmin) scorr = s -\/ smin;}
\DoxyCodeLine{00233           \textcolor{keywordflow}{if} (s >= smax \&\& s <= sfallmax) scorr = s -\/ smax;}
\DoxyCodeLine{00234           \textcolor{keywordflow}{if} (v <= vmin \&\& v >= vfallmin) vcorr = v -\/ vmin;}
\DoxyCodeLine{00235           \textcolor{keywordflow}{if} (v >= vmax \&\& v <= vfallmax) vcorr = v -\/ vmax;}
\DoxyCodeLine{00236           \textcolor{keywordflow}{if} (s < smin \&\& s > sfallmin) scorr   = s -\/ smin;}
\DoxyCodeLine{00237           \textcolor{keywordflow}{if} (s > smax \&\& s < sfallmax) scorr   = s -\/ smax;}
\DoxyCodeLine{00238           h                                     = to\_h + hcorr;}
\DoxyCodeLine{00239           \textcolor{keywordflow}{if} (h < 0) h += 360;}
\DoxyCodeLine{00240           \textcolor{keywordflow}{if} (h > 360) h -\/= 360;}
\DoxyCodeLine{00241           OLDHSV2RGB(h, s, v, \&r, \&g, \&b);}
\DoxyCodeLine{00242 }
\DoxyCodeLine{00243           pix-\/>r = (UCHAR)(r * 255);}
\DoxyCodeLine{00244           pix-\/>g = (UCHAR)(g * 255);}
\DoxyCodeLine{00245           pix-\/>b = (UCHAR)(b * 255);}
\DoxyCodeLine{00246         \}}
\DoxyCodeLine{00247       \}}
\DoxyCodeLine{00248       \textcolor{comment}{// premultiply(*pix);}}
\DoxyCodeLine{00249       pix++;}
\DoxyCodeLine{00250     \}}
\DoxyCodeLine{00251   \}}
\DoxyCodeLine{00252   raster32-\/>unlock();}
\DoxyCodeLine{00253 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_change_color_fx_a203fd4e0dbe7d900aa11acdac6a503c7}\label{class_change_color_fx_a203fd4e0dbe7d900aa11acdac6a503c7}} 
\index{ChangeColorFx@{ChangeColorFx}!doGetBBox@{doGetBBox}}
\index{doGetBBox@{doGetBBox}!ChangeColorFx@{ChangeColorFx}}
\doxysubsubsection{\texorpdfstring{doGetBBox()}{doGetBBox()}}
{\footnotesize\ttfamily bool Change\+Color\+Fx\+::do\+Get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{b\+Box,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00127                                                        \{}
\DoxyCodeLine{00128     \textcolor{keywordflow}{if} (m\_input.isConnected()) \textcolor{keywordflow}{return} m\_input-\/>doGetBBox(frame, bBox, info);}
\DoxyCodeLine{00129     \{}
\DoxyCodeLine{00130       bBox = \mbox{\hyperlink{class_t_rect_t}{TRectD}}();}
\DoxyCodeLine{00131       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00132     \}}
\DoxyCodeLine{00133   \};}

\end{DoxyCode}
\mbox{\Hypertarget{class_change_color_fx_a2e979e0eaaac93fdbe124b075c2cf14a}\label{class_change_color_fx_a2e979e0eaaac93fdbe124b075c2cf14a}} 
\index{ChangeColorFx@{ChangeColorFx}!getBBox@{getBBox}}
\index{getBBox@{getBBox}!ChangeColorFx@{ChangeColorFx}}
\doxysubsubsection{\texorpdfstring{getBBox()}{getBBox()}}
{\footnotesize\ttfamily bool Change\+Color\+Fx\+::get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{b\+Box,  }\item[{TPixel32 \&}]{bg\+Color }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00032                                                               \{}
\DoxyCodeLine{00033     \textcolor{keywordflow}{return} m\_input-\/>getBBox(frame, bBox, bgColor);}
\DoxyCodeLine{00034   \};}

\end{DoxyCode}
\mbox{\Hypertarget{class_change_color_fx_a3e54035639e227924e11b70b38300c27}\label{class_change_color_fx_a3e54035639e227924e11b70b38300c27}} 
\index{ChangeColorFx@{ChangeColorFx}!getInvalidRect@{getInvalidRect}}
\index{getInvalidRect@{getInvalidRect}!ChangeColorFx@{ChangeColorFx}}
\doxysubsubsection{\texorpdfstring{getInvalidRect()}{getInvalidRect()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_rect_t}{TRect}} Change\+Color\+Fx\+::get\+Invalid\+Rect (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRect}} \&}]{max }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/stdfx/changecolorfx.\+cpp\item 
E\+:/opentoonz/toonz/sources/stdfx/changecolorfx.\+h\end{DoxyCompactItemize}
