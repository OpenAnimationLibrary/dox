\hypertarget{class_function_expression_segment_page}{}\doxysection{Function\+Expression\+Segment\+Page Class Reference}
\label{class_function_expression_segment_page}\index{FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}}
Inheritance diagram for Function\+Expression\+Segment\+Page\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_function_expression_segment_page}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_function_expression_segment_page_a48dabc005f7459b6e975a2c925ac18a3}{Function\+Expression\+Segment\+Page}} (\mbox{\hyperlink{class_function_segment_viewer}{Function\+Segment\+Viewer}} $\ast$parent=0)
\item 
void \mbox{\hyperlink{class_function_expression_segment_page_aa6688db798e5df29407b88ae5fb4b05d}{refresh}} () override
\item 
void \mbox{\hyperlink{class_function_expression_segment_page_a64ea3815869cda6b1aea7054f9f0a854}{apply}} () override
\item 
bool \mbox{\hyperlink{class_function_expression_segment_page_ac0c74a02f3b47dbaa70c417271d4a5c6}{get\+Gui\+Values}} (std\+::string \&expression\+Text, std\+::string \&unit\+Name)
\item 
void \mbox{\hyperlink{class_function_expression_segment_page_a38b075fa9285204f0ef628210f6174d1}{init}} (int segment\+Length) override
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_function_expression_segment_page_a48dabc005f7459b6e975a2c925ac18a3}\label{class_function_expression_segment_page_a48dabc005f7459b6e975a2c925ac18a3}} 
\index{FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}!FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}}
\index{FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}!FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}}
\doxysubsubsection{\texorpdfstring{FunctionExpressionSegmentPage()}{FunctionExpressionSegmentPage()}}
{\footnotesize\ttfamily Function\+Expression\+Segment\+Page\+::\+Function\+Expression\+Segment\+Page (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_function_segment_viewer}{Function\+Segment\+Viewer}} $\ast$}]{parent = {\ttfamily 0} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00485     : \mbox{\hyperlink{class_function_segment_page}{FunctionSegmentPage}}(parent) \{}
\DoxyCodeLine{00486   m\_expressionFld = \textcolor{keyword}{new} \mbox{\hyperlink{class_d_v_gui_1_1_expression_field}{DVGui::ExpressionField}}();}
\DoxyCodeLine{00487   m\_expressionFld-\/>setFixedHeight(21);}
\DoxyCodeLine{00488 }
\DoxyCodeLine{00489   QLabel *unitLabel = \textcolor{keyword}{new} QLabel(tr(\textcolor{stringliteral}{"{}Unit:"{}}));}
\DoxyCodeLine{00490   unitLabel-\/>setAlignment(Qt::AlignRight | Qt::AlignVCenter);}
\DoxyCodeLine{00491 }
\DoxyCodeLine{00492   m\_unitFld = createField();}
\DoxyCodeLine{00493   m\_unitFld-\/>setFixedWidth(40);}
\DoxyCodeLine{00494   m\_unitFld-\/>setText(\textcolor{stringliteral}{"{}inch"{}});}
\DoxyCodeLine{00495 }
\DoxyCodeLine{00496   \textcolor{comment}{//-\/-\/-\/-\/ layout}}
\DoxyCodeLine{00497   QVBoxLayout *mainLayout = \textcolor{keyword}{new} QVBoxLayout();}
\DoxyCodeLine{00498   mainLayout-\/>setSpacing(2);}
\DoxyCodeLine{00499   mainLayout-\/>setMargin(2);}
\DoxyCodeLine{00500   \{}
\DoxyCodeLine{00501     mainLayout-\/>addSpacing(3);}
\DoxyCodeLine{00502     mainLayout-\/>addWidget(\textcolor{keyword}{new} QLabel(tr(\textcolor{stringliteral}{"{}Expression:"{}})));}
\DoxyCodeLine{00503     mainLayout-\/>addWidget(m\_expressionFld);}
\DoxyCodeLine{00504 }
\DoxyCodeLine{00505     mainLayout-\/>addSpacing(3);}
\DoxyCodeLine{00506     QHBoxLayout *unitLay = \textcolor{keyword}{new} QHBoxLayout();}
\DoxyCodeLine{00507     \{}
\DoxyCodeLine{00508       unitLay-\/>addWidget(unitLabel);}
\DoxyCodeLine{00509       unitLay-\/>addWidget(m\_unitFld);}
\DoxyCodeLine{00510       unitLay-\/>addStretch();}
\DoxyCodeLine{00511     \}}
\DoxyCodeLine{00512     mainLayout-\/>addLayout(unitLay);}
\DoxyCodeLine{00513   \}}
\DoxyCodeLine{00514 }
\DoxyCodeLine{00515   setLayout(mainLayout);}
\DoxyCodeLine{00516 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_function_expression_segment_page_a64ea3815869cda6b1aea7054f9f0a854}\label{class_function_expression_segment_page_a64ea3815869cda6b1aea7054f9f0a854}} 
\index{FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}!apply@{apply}}
\index{apply@{apply}!FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}}
\doxysubsubsection{\texorpdfstring{apply()}{apply()}}
{\footnotesize\ttfamily void Function\+Expression\+Segment\+Page\+::apply (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_function_segment_page}{Function\+Segment\+Page}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00583                                           \{}
\DoxyCodeLine{00584   \mbox{\hyperlink{class_t_double_param}{TDoubleParam}} *curve = getCurve();}
\DoxyCodeLine{00585   \textcolor{keywordflow}{if} (!curve) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00586 }
\DoxyCodeLine{00587   \textcolor{keywordtype}{int} kIndex = getViewer()-\/>getSegmentIndex();}
\DoxyCodeLine{00588   \textcolor{keywordflow}{if} (kIndex < 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00589 }
\DoxyCodeLine{00590   std::string expressionText = m\_expressionFld-\/>getExpression();}
\DoxyCodeLine{00591   \mbox{\hyperlink{class_t_expression}{TExpression}} expr;}
\DoxyCodeLine{00592   expr.\mbox{\hyperlink{class_t_expression_a0ffb229c1e08a4a894bf03cf56464da9}{setGrammar}}(curve-\/>getGrammar());}
\DoxyCodeLine{00593   expr.\mbox{\hyperlink{class_t_expression_af9aa579c14ed806cb7829137b4e699bc}{setText}}(expressionText);}
\DoxyCodeLine{00594   \textcolor{keywordflow}{if} (dependsOn(expr, curve)) \{}
\DoxyCodeLine{00595     DVGui::warning(}
\DoxyCodeLine{00596         tr(\textcolor{stringliteral}{"{}There is a circular reference in the definition of the "{}}}
\DoxyCodeLine{00597            \textcolor{stringliteral}{"{}interpolation."{}}));}
\DoxyCodeLine{00598     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00599   \}}
\DoxyCodeLine{00600 }
\DoxyCodeLine{00601   std::string unitName = m\_unitFld-\/>text().toStdString();}
\DoxyCodeLine{00602 }
\DoxyCodeLine{00603   \mbox{\hyperlink{class_keyframe_setter}{KeyframeSetter}} setter(curve, kIndex);}
\DoxyCodeLine{00604   setter.setExpression(m\_expressionFld-\/>getExpression());}
\DoxyCodeLine{00605   setter.setUnitName(unitName);}
\DoxyCodeLine{00606 }
\DoxyCodeLine{00607   \textcolor{comment}{/*}}
\DoxyCodeLine{00608 \textcolor{comment}{}}
\DoxyCodeLine{00609 \textcolor{comment}{TDoubleKeyframe kf0 = curve-\/>getKeyframeAt(getR0());}}
\DoxyCodeLine{00610 \textcolor{comment}{kf0.m\_expressionText = m\_expressionFld-\/>getExpression();}}
\DoxyCodeLine{00611 \textcolor{comment}{kf0.m\_unitName = m\_unitFld-\/>text().toStdString();}}
\DoxyCodeLine{00612 \textcolor{comment}{curve-\/>setKeyframe(kf0);}}
\DoxyCodeLine{00613 \textcolor{comment}{}}
\DoxyCodeLine{00614 \textcolor{comment}{wstring unitExtension = m\_unitFld-\/>text().toStdWString();}}
\DoxyCodeLine{00615 \textcolor{comment}{TMeasure *curveMeasure = curve-\/>getMeasure();}}
\DoxyCodeLine{00616 \textcolor{comment}{if(curveMeasure)}}
\DoxyCodeLine{00617 \textcolor{comment}{\{}}
\DoxyCodeLine{00618 \textcolor{comment}{TUnit *unit = curveMeasure-\/>getUnit(unitExtension);}}
\DoxyCodeLine{00619 \textcolor{comment}{if(unit)}}
\DoxyCodeLine{00620 \textcolor{comment}{curveMeasure-\/>setCurrentUnit(unit);}}
\DoxyCodeLine{00621 \textcolor{comment}{else}}
\DoxyCodeLine{00622 \textcolor{comment}{\{}}
\DoxyCodeLine{00623 \textcolor{comment}{unitExtension = curveMeasure-\/>getCurrentUnit()-\/>getDefaultExtension();}}
\DoxyCodeLine{00624 \textcolor{comment}{m\_unitFld-\/>setText(QString::fromStdWString(unitExtension));}}
\DoxyCodeLine{00625 \textcolor{comment}{\}}}
\DoxyCodeLine{00626 \textcolor{comment}{\}}}
\DoxyCodeLine{00627 \textcolor{comment}{else}}
\DoxyCodeLine{00628 \textcolor{comment}{m\_unitFld-\/>setText("{}"{});}}
\DoxyCodeLine{00629 \textcolor{comment}{*/}}
\DoxyCodeLine{00630 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_function_expression_segment_page_ac0c74a02f3b47dbaa70c417271d4a5c6}\label{class_function_expression_segment_page_ac0c74a02f3b47dbaa70c417271d4a5c6}} 
\index{FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}!getGuiValues@{getGuiValues}}
\index{getGuiValues@{getGuiValues}!FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}}
\doxysubsubsection{\texorpdfstring{getGuiValues()}{getGuiValues()}}
{\footnotesize\ttfamily bool Function\+Expression\+Segment\+Page\+::get\+Gui\+Values (\begin{DoxyParamCaption}\item[{std\+::string \&}]{expression\+Text,  }\item[{std\+::string \&}]{unit\+Name }\end{DoxyParamCaption})}

return false if a circular reference is occurred 
\begin{DoxyCode}{0}
\DoxyCodeLine{00636                                                                       \{}
\DoxyCodeLine{00637   expressionText = m\_expressionFld-\/>getExpression();}
\DoxyCodeLine{00638 }
\DoxyCodeLine{00639   \textcolor{comment}{// checking a circular reference}}
\DoxyCodeLine{00640   \mbox{\hyperlink{class_t_double_param}{TDoubleParam}} *curve = getCurve();}
\DoxyCodeLine{00641   \mbox{\hyperlink{class_t_expression}{TExpression}} expr;}
\DoxyCodeLine{00642   expr.\mbox{\hyperlink{class_t_expression_a0ffb229c1e08a4a894bf03cf56464da9}{setGrammar}}(curve-\/>getGrammar());}
\DoxyCodeLine{00643   expr.\mbox{\hyperlink{class_t_expression_af9aa579c14ed806cb7829137b4e699bc}{setText}}(expressionText);}
\DoxyCodeLine{00644   \textcolor{keywordflow}{if} (dependsOn(expr, curve)) \{}
\DoxyCodeLine{00645     DVGui::warning(}
\DoxyCodeLine{00646         tr(\textcolor{stringliteral}{"{}There is a circular reference in the definition of the "{}}}
\DoxyCodeLine{00647            \textcolor{stringliteral}{"{}interpolation."{}}));}
\DoxyCodeLine{00648     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00649   \}}
\DoxyCodeLine{00650 }
\DoxyCodeLine{00651   unitName = m\_unitFld-\/>text().toStdString();}
\DoxyCodeLine{00652 }
\DoxyCodeLine{00653   \textcolor{keywordflow}{if} (m\_expressionFld-\/>hasFocus()) m\_expressionFld-\/>clearFocus();}
\DoxyCodeLine{00654 }
\DoxyCodeLine{00655   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00656 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00077}{TExpression\+::set\+Grammar()}}, and \mbox{\hyperlink{l00090}{TExpression\+::set\+Text()}}.

\mbox{\Hypertarget{class_function_expression_segment_page_a38b075fa9285204f0ef628210f6174d1}\label{class_function_expression_segment_page_a38b075fa9285204f0ef628210f6174d1}} 
\index{FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}!init@{init}}
\index{init@{init}!FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}}
\doxysubsubsection{\texorpdfstring{init()}{init()}}
{\footnotesize\ttfamily void Function\+Expression\+Segment\+Page\+::init (\begin{DoxyParamCaption}\item[{int}]{segment\+Length }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_function_segment_page}{Function\+Segment\+Page}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00545                                                           \{}
\DoxyCodeLine{00546   \mbox{\hyperlink{class_t_double_param}{TDoubleParam}} *curve = getCurve();}
\DoxyCodeLine{00547   \textcolor{keywordflow}{if} (!curve) \{}
\DoxyCodeLine{00548     m\_expressionFld-\/>setGrammar(0);}
\DoxyCodeLine{00549     m\_expressionFld-\/>setEnabled(\textcolor{keyword}{false});}
\DoxyCodeLine{00550     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00551   \}}
\DoxyCodeLine{00552 }
\DoxyCodeLine{00553   m\_expressionFld-\/>setEnabled(\textcolor{keyword}{true});}
\DoxyCodeLine{00554   m\_expressionFld-\/>setGrammar(curve-\/>getGrammar());}
\DoxyCodeLine{00555 }
\DoxyCodeLine{00556   \textcolor{keywordtype}{int} kIndex = getViewer()-\/>getSegmentIndex();}
\DoxyCodeLine{00557 }
\DoxyCodeLine{00558   \textcolor{comment}{/*-\/-\/-\/ すでにあるカーブをExpressionに切り替えた場合 -\/-\/-\/*/}}
\DoxyCodeLine{00559   \textcolor{keywordflow}{if} (kIndex >= 0) \{}
\DoxyCodeLine{00560     \mbox{\hyperlink{class_t_double_keyframe}{TDoubleKeyframe}} keyFrame = curve-\/>getKeyframe(kIndex);}
\DoxyCodeLine{00561     \textcolor{keywordtype}{double} value             = curve-\/>getValue(keyFrame.m\_frame);}
\DoxyCodeLine{00562     \textcolor{keyword}{const} \mbox{\hyperlink{class_t_unit}{TUnit}} *unit        = 0;}
\DoxyCodeLine{00563     \textcolor{keywordflow}{if} (curve-\/>getMeasure()) unit = curve-\/>getMeasure()-\/>getCurrentUnit();}
\DoxyCodeLine{00564     \textcolor{keywordflow}{if} (unit) value = unit-\/>convertTo(value);}
\DoxyCodeLine{00565     m\_expressionFld-\/>setExpression(QString::number(value).toStdString());}
\DoxyCodeLine{00566     \textcolor{comment}{/*-\/-\/-\/ unitがある場合だけUnitを表示 -\/-\/-\/*/}}
\DoxyCodeLine{00567     \textcolor{keywordflow}{if} (unit)}
\DoxyCodeLine{00568       m\_unitFld-\/>setText(QString::fromStdWString(unit-\/>getDefaultExtension()));}
\DoxyCodeLine{00569     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00570       m\_unitFld-\/>setText(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00571   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00572     m\_expressionFld-\/>setExpression(\textcolor{stringliteral}{"{}0"{}});}
\DoxyCodeLine{00573 }
\DoxyCodeLine{00574     std::wstring unitName = L\textcolor{stringliteral}{"{}inch"{}};}
\DoxyCodeLine{00575     \textcolor{keywordflow}{if} (curve-\/>getMeasure())}
\DoxyCodeLine{00576       unitName = curve-\/>getMeasure()-\/>getCurrentUnit()-\/>getDefaultExtension();}
\DoxyCodeLine{00577     m\_unitFld-\/>setText(QString::fromStdWString(unitName));}
\DoxyCodeLine{00578   \}}
\DoxyCodeLine{00579 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_function_expression_segment_page_aa6688db798e5df29407b88ae5fb4b05d}\label{class_function_expression_segment_page_aa6688db798e5df29407b88ae5fb4b05d}} 
\index{FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}!refresh@{refresh}}
\index{refresh@{refresh}!FunctionExpressionSegmentPage@{FunctionExpressionSegmentPage}}
\doxysubsubsection{\texorpdfstring{refresh()}{refresh()}}
{\footnotesize\ttfamily void Function\+Expression\+Segment\+Page\+::refresh (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_function_segment_page}{Function\+Segment\+Page}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00520                                             \{}
\DoxyCodeLine{00521   \mbox{\hyperlink{class_t_double_param}{TDoubleParam}} *curve = getCurve();}
\DoxyCodeLine{00522   \textcolor{keywordflow}{if} (!curve) \{}
\DoxyCodeLine{00523     m\_expressionFld-\/>setGrammar(0);}
\DoxyCodeLine{00524     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00525   \}}
\DoxyCodeLine{00526 }
\DoxyCodeLine{00527   \mbox{\hyperlink{class_t_double_keyframe}{TDoubleKeyframe}} kf0        = curve-\/>getKeyframeAt(getR0());}
\DoxyCodeLine{00528   std::string expression     = kf0.m\_expressionText;}
\DoxyCodeLine{00529   \textcolor{keywordtype}{bool} oldBlockSignalsStatus = m\_expressionFld-\/>blockSignals(\textcolor{keyword}{true});}
\DoxyCodeLine{00530   m\_expressionFld-\/>setGrammar(curve-\/>getGrammar());}
\DoxyCodeLine{00531   m\_expressionFld-\/>setExpression(expression);}
\DoxyCodeLine{00532   m\_expressionFld-\/>blockSignals(oldBlockSignalsStatus);}
\DoxyCodeLine{00533 }
\DoxyCodeLine{00534   std::wstring unitName = ::to\_wstring(kf0.m\_unitName);}
\DoxyCodeLine{00535   \textcolor{keywordflow}{if} (unitName == L\textcolor{stringliteral}{"{}"{}} \&\& curve-\/>getMeasure())}
\DoxyCodeLine{00536     unitName = curve-\/>getMeasure()-\/>getCurrentUnit()-\/>getDefaultExtension();}
\DoxyCodeLine{00537 }
\DoxyCodeLine{00538   oldBlockSignalsStatus = m\_unitFld-\/>blockSignals(\textcolor{keyword}{true});}
\DoxyCodeLine{00539   m\_unitFld-\/>setText(QString::fromStdWString(unitName));}
\DoxyCodeLine{00540   m\_unitFld-\/>blockSignals(oldBlockSignalsStatus);}
\DoxyCodeLine{00541 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/toonzqt/functionsegmentviewer.\+h\item 
E\+:/opentoonz/toonz/sources/toonzqt/functionsegmentviewer.\+cpp\end{DoxyCompactItemize}
