\hypertarget{class_swatch_viewer}{}\doxysection{Swatch\+Viewer Class Reference}
\label{class_swatch_viewer}\index{SwatchViewer@{SwatchViewer}}


\mbox{\hyperlink{class_swatch_viewer}{Swatch\+Viewer}}.  




{\ttfamily \#include $<$swatchviewer.\+h$>$}

Inheritance diagram for Swatch\+Viewer\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_swatch_viewer}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{class_swatch_viewer_1_1_content_render}{Content\+Render}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Slots}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_swatch_viewer_a107e8e8843b357c7566c0792b28a17ad}{set\+Enable}} (bool enabled)
\item 
void \mbox{\hyperlink{class_swatch_viewer_a26cd42dbe8dd9379ec783542bd64dc08}{update\+Size}} (const QSize \&size)
\item 
void \mbox{\hyperlink{class_swatch_viewer_a5fb9370bbb99147564e479482f9c2644}{set\+Bg\+Painter}} (TPixel32 color1, TPixel32 color2=TPixel32())
\item 
void \mbox{\hyperlink{class_swatch_viewer_a094b900a04ca53730b4d53e00bc6d117}{reset\+View}} ()
\item 
void \mbox{\hyperlink{class_swatch_viewer_aefa56fb908b8a9e08a724d47d2a13eed}{fit\+View}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Signals}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_swatch_viewer_aaa71b71cbdd1eac38b9693d874e3ff2b}\label{class_swatch_viewer_aaa71b71cbdd1eac38b9693d874e3ff2b}} 
void {\bfseries point\+Position\+Changed} (int index, const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p)
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_swatch_viewer_a1100de80e408015206c802f0f29324aa}{Swatch\+Viewer}} (QWidget $\ast$parent=0, Qt\+::\+WFlags flags=0)
\item 
void \mbox{\hyperlink{class_swatch_viewer_ab8628345566c06dbf91c6b1c336e690f}{set\+Camera\+Mode}} (bool enabled)
\item 
bool \mbox{\hyperlink{class_swatch_viewer_a9a616b0e5c5e34aa0ec8000323e6a70f}{get\+Camera\+Mode}} () const
\item 
void \mbox{\hyperlink{class_swatch_viewer_a6cb0cc1eb92c94f1b9550aebc75b8427}{set\+Camera\+Size}} (const \mbox{\hyperlink{class_t_dimension_t}{TDimension}} \&camera\+Size)
\item 
\mbox{\hyperlink{class_t_dimension_t}{TDimension}} \mbox{\hyperlink{class_swatch_viewer_a8dbd2952f064a9438140da8861a96c4e}{get\+Camera\+Size}} () const
\item 
void \mbox{\hyperlink{class_swatch_viewer_a4c4fdb58b79bdd09087bcfc19bd6dad8}{set\+Fx}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TFxP}} \&fx, const \mbox{\hyperlink{class_t_smart_pointer_t}{TFxP}} \&actual\+Fx, int frame)
\item 
void \mbox{\hyperlink{class_swatch_viewer_a0d0cc24f3d4b71fe6cd733dc43397a23}{update\+Frame}} (int frame)
\item 
bool \mbox{\hyperlink{class_swatch_viewer_a7de0cf835f2a40a4a85097b623fd5849}{is\+Enabled}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{class_swatch_viewer_a194e96e43dd523173b6c9f447817b62f}{suspend\+Rendering}} (bool suspend, bool blocking=true)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_swatch_viewer_a67ba376dd9f396ebe1b13eb4500274e0}{compute\+Content}} ()
\item 
\mbox{\hyperlink{class_t_point_t}{TPoint}} \mbox{\hyperlink{class_swatch_viewer_aaaa6fd61362dbe6cea404e5e4fe391f4}{world2win}} (const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&p) const
\item 
\mbox{\hyperlink{class_t_point_t}{TPointD}} \mbox{\hyperlink{class_swatch_viewer_a0203c47fc5165fe7937c28866bbf7932}{win2world}} (const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&p) const
\item 
void \mbox{\hyperlink{class_swatch_viewer_aae94bedfb14c3cf65b76ee148c5e5c12}{zoom}} (const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&pos, double factor)
\item 
void \mbox{\hyperlink{class_swatch_viewer_a6975a5489c08803c67a05021c30f910e}{zoom}} (bool forward, bool reset)
\item 
void \mbox{\hyperlink{class_swatch_viewer_a7ef2ed6ee4b3b5be4e0a64eb6f718915}{pan}} (const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&delta)
\item 
void \mbox{\hyperlink{class_swatch_viewer_a255e7fd57934b07b54ca51c0b479abec}{update\+Raster}} ()
\item 
const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \& \mbox{\hyperlink{class_swatch_viewer_aa194ad204353b62d07c41e0d7d19187f}{get\+Content}} () const
\item 
void \mbox{\hyperlink{class_swatch_viewer_a9783e5d28a77eed3e1eab43e3df1e15e}{set\+Content}} (const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \&content, const \mbox{\hyperlink{class_t_affine}{TAffine}} \&content\+Aff)
\item 
void \mbox{\hyperlink{class_swatch_viewer_ad0b2e16ff3738e7572a1f5db4468545c}{set\+Aff}} (const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff)
\item 
void \mbox{\hyperlink{class_swatch_viewer_a12600b58e04ba219f3a6f66eb92fab48}{context\+Menu\+Event}} (QContext\+Menu\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_swatch_viewer_a896d9a6b80c313b75444960a89a46d55}{paint\+Event}} (QPaint\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_swatch_viewer_a7a06c0e587717246e45b412fb0eb97e3}{mouse\+Press\+Event}} (QMouse\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_swatch_viewer_a56df7d2a1b88da430566825b431d0fce}{mouse\+Move\+Event}} (QMouse\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_swatch_viewer_a895b20d90b250825ea408c6694e8ee85}{mouse\+Release\+Event}} (QMouse\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_swatch_viewer_a4ff74d0579f49d45583ae6bc31e06c8b}{wheel\+Event}} (QWheel\+Event $\ast$) override
\item 
void \mbox{\hyperlink{class_swatch_viewer_a5af373d5f3858a29ebb982bfef858472}{key\+Press\+Event}} (QKey\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_swatch_viewer_a787019cc33ab85d128566bcbaa492dd2}{resize\+Event}} (QResize\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_swatch_viewer_adfdc88b5a119c6987eb543fcbc274146}{hide\+Event}} (QHide\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_swatch_viewer_afefde0414c91bfb776b10935a4b0a76f}{mouse\+Double\+Click\+Event}} (QMouse\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_swatch_viewer_a7b835dd1571c5d49825c0096c58c48f8}{tablet\+Event}} (QTablet\+Event $\ast$e) override
\item 
void \mbox{\hyperlink{class_swatch_viewer_a220ea66c6f7c5baf87f17bdcb12eb11b}{touch\+Event}} (QTouch\+Event $\ast$e, int type)
\item 
void \mbox{\hyperlink{class_swatch_viewer_a9704796b9a752b80eef736a72caf693c}{gesture\+Event}} (QGesture\+Event $\ast$e)
\item 
bool \mbox{\hyperlink{class_swatch_viewer_acfdd35fd4a3d97454ad9b476456efc0f}{event}} (QEvent $\ast$e) override
\end{DoxyCompactItemize}
\doxysubsection*{Friends}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{class_swatch_viewer_aa113bd47178f9539d0ed8eb474e24b6f}{Content\+Render}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{class_swatch_viewer}{Swatch\+Viewer}}. 

\begin{DoxyVerb}        Inherits \b QWidget.
\end{DoxyVerb}
 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_swatch_viewer_a1100de80e408015206c802f0f29324aa}\label{class_swatch_viewer_a1100de80e408015206c802f0f29324aa}} 
\index{SwatchViewer@{SwatchViewer}!SwatchViewer@{SwatchViewer}}
\index{SwatchViewer@{SwatchViewer}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{SwatchViewer()}{SwatchViewer()}}
{\footnotesize\ttfamily Swatch\+Viewer\+::\+Swatch\+Viewer (\begin{DoxyParamCaption}\item[{QWidget $\ast$}]{parent = {\ttfamily 0},  }\item[{Qt\+::\+WFlags}]{flags = {\ttfamily 0} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00249     : QWidget(parent, flags)}
\DoxyCodeLine{00250     , m\_fx(0)}
\DoxyCodeLine{00251     , m\_actualFxClone(0)}
\DoxyCodeLine{00252     , m\_mouseButton(Qt::NoButton)}
\DoxyCodeLine{00253     , m\_selectedPoint(0)}
\DoxyCodeLine{00254     , m\_pointPosDelta(\mbox{\hyperlink{class_t_point_t}{TPointD}}())}
\DoxyCodeLine{00255     , m\_enabled(\textcolor{keyword}{false})}
\DoxyCodeLine{00256     , m\_content()}
\DoxyCodeLine{00257     , m\_aff(\mbox{\hyperlink{class_t_affine}{TAffine}}())}
\DoxyCodeLine{00258     , m\_fxAff(\mbox{\hyperlink{class_t_affine}{TAffine}}())}
\DoxyCodeLine{00259     , m\_cameraRect()}
\DoxyCodeLine{00260     , m\_bgPainter(0)}
\DoxyCodeLine{00261     , m\_pos(\mbox{\hyperlink{class_t_point_t}{TPoint}}())}
\DoxyCodeLine{00262     , m\_firstPos(\mbox{\hyperlink{class_t_point_t}{TPoint}}())}
\DoxyCodeLine{00263     , m\_oldContent()}
\DoxyCodeLine{00264     , m\_curContent()}
\DoxyCodeLine{00265     , m\_executor()}
\DoxyCodeLine{00266     , m\_firstEnabled(\textcolor{keyword}{true}) \{}
\DoxyCodeLine{00267   \textcolor{comment}{// setMinimumSize(150,150);}}
\DoxyCodeLine{00268   setMinimumHeight(150);}
\DoxyCodeLine{00269   setFixedWidth(150);}
\DoxyCodeLine{00270   setSizePolicy(QSizePolicy::MinimumExpanding, QSizePolicy::MinimumExpanding);}
\DoxyCodeLine{00271 }
\DoxyCodeLine{00272   m\_raster    = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}(width(), height());}
\DoxyCodeLine{00273   m\_crossIcon = createCrossIcon();}
\DoxyCodeLine{00274   setFocusPolicy(Qt::StrongFocus);}
\DoxyCodeLine{00275   m\_executor.\mbox{\hyperlink{class_t_thread_1_1_executor_a02c4c637864647ce22be391919049d3a}{setDedicatedThreads}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00276   m\_executor.\mbox{\hyperlink{class_t_thread_1_1_executor_a85231531a2fa273db401f090c9aba4ea}{setMaxActiveTasks}}(1);}
\DoxyCodeLine{00277 }
\DoxyCodeLine{00278   m\_renderer.enablePrecomputing(\textcolor{keyword}{false});}
\DoxyCodeLine{00279 }
\DoxyCodeLine{00280   setAttribute(Qt::WA\_AcceptTouchEvents);}
\DoxyCodeLine{00281   grabGesture(Qt::SwipeGesture);}
\DoxyCodeLine{00282   grabGesture(Qt::PanGesture);}
\DoxyCodeLine{00283   grabGesture(Qt::PinchGesture);}
\DoxyCodeLine{00284 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_af044913b38a95c836c00826342383a04}\label{class_swatch_viewer_af044913b38a95c836c00826342383a04}} 
\index{SwatchViewer@{SwatchViewer}!````~SwatchViewer@{$\sim$SwatchViewer}}
\index{````~SwatchViewer@{$\sim$SwatchViewer}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{$\sim$SwatchViewer()}{~SwatchViewer()}}
{\footnotesize\ttfamily Swatch\+Viewer\+::$\sim$\+Swatch\+Viewer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00288 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_swatch_viewer_a67ba376dd9f396ebe1b13eb4500274e0}\label{class_swatch_viewer_a67ba376dd9f396ebe1b13eb4500274e0}} 
\index{SwatchViewer@{SwatchViewer}!computeContent@{computeContent}}
\index{computeContent@{computeContent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{computeContent()}{computeContent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::compute\+Content (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00484                                   \{}
\DoxyCodeLine{00485   \textcolor{keywordflow}{if} (suspendedRendering) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00486   \textcolor{keywordflow}{if} (!m\_enabled) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00487   \textcolor{keywordflow}{if} (!m\_raster) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00488 }
\DoxyCodeLine{00489   \textcolor{comment}{// Clear the swatch cache when the zoom scale has changed (cache results are}}
\DoxyCodeLine{00490   \textcolor{comment}{// not compatible}}
\DoxyCodeLine{00491   \textcolor{comment}{// between different scale levels)}}
\DoxyCodeLine{00492   \textcolor{keywordflow}{if} (m\_aff.a11 != m\_contentAff.a11 || m\_panning)}
\DoxyCodeLine{00493     SwatchCacheManager::instance()-\/>clearSwatchResults();}
\DoxyCodeLine{00494 }
\DoxyCodeLine{00495   \mbox{\hyperlink{class_t_rect_t}{TRect}} rect(0, 0, width() -\/ 1, height() -\/ 1);}
\DoxyCodeLine{00496   \mbox{\hyperlink{class_t_dimension_t}{TDimension}} size = rect.getSize();}
\DoxyCodeLine{00497   assert(m\_raster-\/>getSize() == size);}
\DoxyCodeLine{00498   \textcolor{keywordflow}{if} (m\_fx) \{}
\DoxyCodeLine{00499     \textcolor{comment}{// TFxP fx = makeAffine(m\_fx, m\_aff);}}
\DoxyCodeLine{00500     \textcolor{comment}{// TRasterFxP rasterFx = fx;}}
\DoxyCodeLine{00501     \mbox{\hyperlink{class_t_raster_fx_p}{TRasterFxP}} rasterFx = m\_fx;}
\DoxyCodeLine{00502     \textcolor{keywordflow}{if} (rasterFx) \{}
\DoxyCodeLine{00503       m\_executor.\mbox{\hyperlink{class_t_thread_1_1_executor_a3ebba69410a233ff1e5774d7e4d1246f}{cancelAll}}();}
\DoxyCodeLine{00504       m\_executor.\mbox{\hyperlink{class_t_thread_1_1_executor_af31c8db8ac72df4c342e7769e95e2135}{addTask}}(}
\DoxyCodeLine{00505           \textcolor{keyword}{new} ContentRender(rasterFx.getPointer(), m\_frame, size, \textcolor{keyword}{this}));}
\DoxyCodeLine{00506 }
\DoxyCodeLine{00507       submittedTasks++;}
\DoxyCodeLine{00508       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00509     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00510       m\_content = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}(size);}
\DoxyCodeLine{00511       m\_content-\/>fill(TPixel32::Red);}
\DoxyCodeLine{00512     \}}
\DoxyCodeLine{00513   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00514     m\_content = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}(size);}
\DoxyCodeLine{00515     m\_content-\/>fill(TPixel32::Transparent);}
\DoxyCodeLine{00516   \}}
\DoxyCodeLine{00517   updateRaster();}
\DoxyCodeLine{00518 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a12600b58e04ba219f3a6f66eb92fab48}\label{class_swatch_viewer_a12600b58e04ba219f3a6f66eb92fab48}} 
\index{SwatchViewer@{SwatchViewer}!contextMenuEvent@{contextMenuEvent}}
\index{contextMenuEvent@{contextMenuEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{contextMenuEvent()}{contextMenuEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::context\+Menu\+Event (\begin{DoxyParamCaption}\item[{QContext\+Menu\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00841                                                             \{}
\DoxyCodeLine{00842   QMenu *menu = \textcolor{keyword}{new} QMenu(\textcolor{keyword}{this});}
\DoxyCodeLine{00843 }
\DoxyCodeLine{00844   QAction *reset = menu-\/>addAction(tr(\textcolor{stringliteral}{"{}Reset View"{}}));}
\DoxyCodeLine{00845   reset-\/>setShortcut(}
\DoxyCodeLine{00846       QKeySequence(CommandManager::instance()-\/>getKeyFromId(V\_ZoomReset)));}
\DoxyCodeLine{00847   connect(reset, SIGNAL(triggered()), SLOT(resetView()));}
\DoxyCodeLine{00848 }
\DoxyCodeLine{00849   QAction *fit = menu-\/>addAction(tr(\textcolor{stringliteral}{"{}Fit To Window"{}}));}
\DoxyCodeLine{00850   fit-\/>setShortcut(}
\DoxyCodeLine{00851       QKeySequence(CommandManager::instance()-\/>getKeyFromId(V\_ZoomFit)));}
\DoxyCodeLine{00852   connect(fit, SIGNAL(triggered()), SLOT(fitView()));}
\DoxyCodeLine{00853 }
\DoxyCodeLine{00854   menu-\/>exec(event-\/>globalPos());}
\DoxyCodeLine{00855 }
\DoxyCodeLine{00856   \textcolor{keyword}{delete} menu;}
\DoxyCodeLine{00857   update();}
\DoxyCodeLine{00858 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_acfdd35fd4a3d97454ad9b476456efc0f}\label{class_swatch_viewer_acfdd35fd4a3d97454ad9b476456efc0f}} 
\index{SwatchViewer@{SwatchViewer}!event@{event}}
\index{event@{event}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{event()}{event()}}
{\footnotesize\ttfamily bool Swatch\+Viewer\+::event (\begin{DoxyParamCaption}\item[{QEvent $\ast$}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00978                                   \{}
\DoxyCodeLine{00979   \textcolor{comment}{/*}}
\DoxyCodeLine{00980 \textcolor{comment}{  switch (e-\/>type()) \{}}
\DoxyCodeLine{00981 \textcolor{comment}{  case QEvent::TabletPress: \{}}
\DoxyCodeLine{00982 \textcolor{comment}{  QTabletEvent *te = static\_cast<QTabletEvent *>(e);}}
\DoxyCodeLine{00983 \textcolor{comment}{  qDebug() << "{}[event] TabletPress: pointerType("{} << te-\/>pointerType()}}
\DoxyCodeLine{00984 \textcolor{comment}{  << "{}) device("{} << te-\/>device() << "{})"{};}}
\DoxyCodeLine{00985 \textcolor{comment}{  \} break;}}
\DoxyCodeLine{00986 \textcolor{comment}{  case QEvent::TabletRelease:}}
\DoxyCodeLine{00987 \textcolor{comment}{  qDebug() << "{}[event] TabletRelease"{};}}
\DoxyCodeLine{00988 \textcolor{comment}{  break;}}
\DoxyCodeLine{00989 \textcolor{comment}{  case QEvent::TouchBegin:}}
\DoxyCodeLine{00990 \textcolor{comment}{  qDebug() << "{}[event] TouchBegin"{};}}
\DoxyCodeLine{00991 \textcolor{comment}{  break;}}
\DoxyCodeLine{00992 \textcolor{comment}{  case QEvent::TouchEnd:}}
\DoxyCodeLine{00993 \textcolor{comment}{  qDebug() << "{}[event] TouchEnd"{};}}
\DoxyCodeLine{00994 \textcolor{comment}{  break;}}
\DoxyCodeLine{00995 \textcolor{comment}{  case QEvent::TouchCancel:}}
\DoxyCodeLine{00996 \textcolor{comment}{  qDebug() << "{}[event] TouchCancel"{};}}
\DoxyCodeLine{00997 \textcolor{comment}{  break;}}
\DoxyCodeLine{00998 \textcolor{comment}{  case QEvent::MouseButtonPress:}}
\DoxyCodeLine{00999 \textcolor{comment}{  qDebug() << "{}[event] MouseButtonPress"{};}}
\DoxyCodeLine{01000 \textcolor{comment}{  break;}}
\DoxyCodeLine{01001 \textcolor{comment}{  case QEvent::MouseButtonDblClick:}}
\DoxyCodeLine{01002 \textcolor{comment}{  qDebug() << "{}[event] MouseButtonDblClick"{};}}
\DoxyCodeLine{01003 \textcolor{comment}{  break;}}
\DoxyCodeLine{01004 \textcolor{comment}{  case QEvent::MouseButtonRelease:}}
\DoxyCodeLine{01005 \textcolor{comment}{  qDebug() << "{}[event] MouseButtonRelease"{};}}
\DoxyCodeLine{01006 \textcolor{comment}{  break;}}
\DoxyCodeLine{01007 \textcolor{comment}{  case QEvent::Gesture:}}
\DoxyCodeLine{01008 \textcolor{comment}{  qDebug() << "{}[event] Gesture"{};}}
\DoxyCodeLine{01009 \textcolor{comment}{  break;}}
\DoxyCodeLine{01010 \textcolor{comment}{  default:}}
\DoxyCodeLine{01011 \textcolor{comment}{  break;}}
\DoxyCodeLine{01012 \textcolor{comment}{  \}}}
\DoxyCodeLine{01013 \textcolor{comment}{  */}}
\DoxyCodeLine{01014 }
\DoxyCodeLine{01015   \textcolor{keywordflow}{if} (e-\/>type() == QEvent::Gesture \&\&}
\DoxyCodeLine{01016       CommandManager::instance()}
\DoxyCodeLine{01017           -\/>getAction(MI\_TouchGestureControl)}
\DoxyCodeLine{01018           -\/>isChecked()) \{}
\DoxyCodeLine{01019     gestureEvent(\textcolor{keyword}{static\_cast<}QGestureEvent *\textcolor{keyword}{>}(e));}
\DoxyCodeLine{01020     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01021   \}}
\DoxyCodeLine{01022   \textcolor{keywordflow}{if} ((e-\/>type() == QEvent::TouchBegin || e-\/>type() == QEvent::TouchEnd ||}
\DoxyCodeLine{01023        e-\/>type() == QEvent::TouchCancel || e-\/>type() == QEvent::TouchUpdate) \&\&}
\DoxyCodeLine{01024       CommandManager::instance()}
\DoxyCodeLine{01025           -\/>getAction(MI\_TouchGestureControl)}
\DoxyCodeLine{01026           -\/>isChecked()) \{}
\DoxyCodeLine{01027     touchEvent(\textcolor{keyword}{static\_cast<}QTouchEvent *\textcolor{keyword}{>}(e), e-\/>type());}
\DoxyCodeLine{01028     m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{01029     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01030   \}}
\DoxyCodeLine{01031   \textcolor{keywordflow}{return} QWidget::event(e);}
\DoxyCodeLine{01032 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_aefa56fb908b8a9e08a724d47d2a13eed}\label{class_swatch_viewer_aefa56fb908b8a9e08a724d47d2a13eed}} 
\index{SwatchViewer@{SwatchViewer}!fitView@{fitView}}
\index{fitView@{fitView}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{fitView}{fitView}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::fit\+View (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00449                            \{}
\DoxyCodeLine{00450   \textcolor{keywordflow}{if} (m\_cameraRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00451 }
\DoxyCodeLine{00452   \textcolor{keywordtype}{double} imageScale = std::min(}
\DoxyCodeLine{00453       width() / ((\textcolor{keywordtype}{double})getCameraSize().lx * (m\_cameraMode ? 1 : 0.44)),}
\DoxyCodeLine{00454       height() / ((\textcolor{keywordtype}{double})getCameraSize().ly * (m\_cameraMode ? 1 : 0.44)));}
\DoxyCodeLine{00455 }
\DoxyCodeLine{00456   \mbox{\hyperlink{class_t_affine}{TAffine}} fitAffine = \mbox{\hyperlink{class_t_scale}{TScale}}(imageScale, imageScale);}
\DoxyCodeLine{00457   fitAffine.a13     = 0;}
\DoxyCodeLine{00458   fitAffine.a23     = 0;}
\DoxyCodeLine{00459 }
\DoxyCodeLine{00460   setAff(fitAffine);}
\DoxyCodeLine{00461 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a9704796b9a752b80eef736a72caf693c}\label{class_swatch_viewer_a9704796b9a752b80eef736a72caf693c}} 
\index{SwatchViewer@{SwatchViewer}!gestureEvent@{gestureEvent}}
\index{gestureEvent@{gestureEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{gestureEvent()}{gestureEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::gesture\+Event (\begin{DoxyParamCaption}\item[{QGesture\+Event $\ast$}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00875                                                 \{}
\DoxyCodeLine{00876   \textcolor{comment}{// qDebug() << "{}[gestureEvent]"{};}}
\DoxyCodeLine{00877   m\_gestureActive = \textcolor{keyword}{false};}
\DoxyCodeLine{00878   \textcolor{keywordflow}{if} (QGesture *swipe = e-\/>gesture(Qt::SwipeGesture)) \{}
\DoxyCodeLine{00879     m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{00880   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (QGesture *pan = e-\/>gesture(Qt::PanGesture)) \{}
\DoxyCodeLine{00881     m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{00882   \}}
\DoxyCodeLine{00883   \textcolor{keywordflow}{if} (QGesture *pinch = e-\/>gesture(Qt::PinchGesture)) \{}
\DoxyCodeLine{00884     QPinchGesture *gesture = \textcolor{keyword}{static\_cast<}QPinchGesture *\textcolor{keyword}{>}(pinch);}
\DoxyCodeLine{00885     QPinchGesture::ChangeFlags changeFlags = gesture-\/>changeFlags();}
\DoxyCodeLine{00886     QPoint firstCenter                     = gesture-\/>centerPoint().toPoint();}
\DoxyCodeLine{00887     \textcolor{keywordflow}{if} (m\_touchDevice == QTouchDevice::TouchScreen)}
\DoxyCodeLine{00888       firstCenter = mapFromGlobal(firstCenter);}
\DoxyCodeLine{00889 }
\DoxyCodeLine{00890     \textcolor{keywordflow}{if} (gesture-\/>state() == Qt::GestureStarted) \{}
\DoxyCodeLine{00891       m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{00892     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (gesture-\/>state() == Qt::GestureFinished) \{}
\DoxyCodeLine{00893       m\_gestureActive = \textcolor{keyword}{false};}
\DoxyCodeLine{00894       m\_zooming       = \textcolor{keyword}{false};}
\DoxyCodeLine{00895       m\_scaleFactor   = 0.0;}
\DoxyCodeLine{00896     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00897       \textcolor{keywordflow}{if} (changeFlags \& QPinchGesture::ScaleFactorChanged) \{}
\DoxyCodeLine{00898         \textcolor{keywordtype}{double} scaleFactor = gesture-\/>scaleFactor();}
\DoxyCodeLine{00899         \textcolor{comment}{// the scale factor makes for too sensitive scaling}}
\DoxyCodeLine{00900         \textcolor{comment}{// divide the change in half}}
\DoxyCodeLine{00901         \textcolor{keywordflow}{if} (scaleFactor > 1) \{}
\DoxyCodeLine{00902           \textcolor{keywordtype}{double} decimalValue = scaleFactor -\/ 1;}
\DoxyCodeLine{00903           decimalValue /= 1.5;}
\DoxyCodeLine{00904           scaleFactor = 1 + decimalValue;}
\DoxyCodeLine{00905         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (scaleFactor < 1) \{}
\DoxyCodeLine{00906           \textcolor{keywordtype}{double} decimalValue = 1 -\/ scaleFactor;}
\DoxyCodeLine{00907           decimalValue /= 1.5;}
\DoxyCodeLine{00908           scaleFactor = 1 -\/ decimalValue;}
\DoxyCodeLine{00909         \}}
\DoxyCodeLine{00910         \textcolor{keywordflow}{if} (!m\_zooming) \{}
\DoxyCodeLine{00911           \textcolor{keywordtype}{double} delta = scaleFactor -\/ 1;}
\DoxyCodeLine{00912           m\_scaleFactor += delta;}
\DoxyCodeLine{00913           \textcolor{keywordflow}{if} (m\_scaleFactor > .2 || m\_scaleFactor < -\/.2) \{}
\DoxyCodeLine{00914             m\_zooming = \textcolor{keyword}{true};}
\DoxyCodeLine{00915           \}}
\DoxyCodeLine{00916         \}}
\DoxyCodeLine{00917         \textcolor{keywordflow}{if} (m\_zooming) \{}
\DoxyCodeLine{00918           \mbox{\hyperlink{class_t_point_t}{TPoint}} center(firstCenter.x() -\/ width() / 2,}
\DoxyCodeLine{00919                         -\/firstCenter.y() + height() / 2);}
\DoxyCodeLine{00920           zoom(center, scaleFactor);}
\DoxyCodeLine{00921           m\_panning = \textcolor{keyword}{false};}
\DoxyCodeLine{00922         \}}
\DoxyCodeLine{00923         m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{00924       \}}
\DoxyCodeLine{00925 }
\DoxyCodeLine{00926       \textcolor{keywordflow}{if} (changeFlags \& QPinchGesture::CenterPointChanged) \{}
\DoxyCodeLine{00927         QPointF centerDelta =}
\DoxyCodeLine{00928             (gesture-\/>centerPoint()) -\/ (gesture-\/>lastCenterPoint());}
\DoxyCodeLine{00929         \textcolor{keywordflow}{if} (centerDelta.manhattanLength() > 1) \{}
\DoxyCodeLine{00930           \textcolor{comment}{// panQt(centerDelta.toPoint());}}
\DoxyCodeLine{00931         \}}
\DoxyCodeLine{00932         m\_gestureActive = \textcolor{keyword}{true};}
\DoxyCodeLine{00933       \}}
\DoxyCodeLine{00934     \}}
\DoxyCodeLine{00935   \}}
\DoxyCodeLine{00936   e-\/>accept();}
\DoxyCodeLine{00937 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a9a616b0e5c5e34aa0ec8000323e6a70f}\label{class_swatch_viewer_a9a616b0e5c5e34aa0ec8000323e6a70f}} 
\index{SwatchViewer@{SwatchViewer}!getCameraMode@{getCameraMode}}
\index{getCameraMode@{getCameraMode}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{getCameraMode()}{getCameraMode()}}
{\footnotesize\ttfamily bool Swatch\+Viewer\+::get\+Camera\+Mode (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00186 \{ \textcolor{keywordflow}{return} m\_cameraMode; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a8dbd2952f064a9438140da8861a96c4e}\label{class_swatch_viewer_a8dbd2952f064a9438140da8861a96c4e}} 
\index{SwatchViewer@{SwatchViewer}!getCameraSize@{getCameraSize}}
\index{getCameraSize@{getCameraSize}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{getCameraSize()}{getCameraSize()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_dimension_t}{TDimension}} Swatch\+Viewer\+::get\+Camera\+Size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00189 \{ \textcolor{keywordflow}{return} m\_cameraRect.getSize(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_aa194ad204353b62d07c41e0d7d19187f}\label{class_swatch_viewer_aa194ad204353b62d07c41e0d7d19187f}} 
\index{SwatchViewer@{SwatchViewer}!getContent@{getContent}}
\index{getContent@{getContent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{getContent()}{getContent()}}
{\footnotesize\ttfamily const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \& Swatch\+Viewer\+::get\+Content (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00214 \{ \textcolor{keywordflow}{return} m\_content; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_adfdc88b5a119c6987eb543fcbc274146}\label{class_swatch_viewer_adfdc88b5a119c6987eb543fcbc274146}} 
\index{SwatchViewer@{SwatchViewer}!hideEvent@{hideEvent}}
\index{hideEvent@{hideEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{hideEvent()}{hideEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::hide\+Event (\begin{DoxyParamCaption}\item[{QHide\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00823                                               \{}
\DoxyCodeLine{00824   \textcolor{comment}{// Clear the swatch cache}}
\DoxyCodeLine{00825   ::setFxForCaching(0);}
\DoxyCodeLine{00826 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a7de0cf835f2a40a4a85097b623fd5849}\label{class_swatch_viewer_a7de0cf835f2a40a4a85097b623fd5849}} 
\index{SwatchViewer@{SwatchViewer}!isEnabled@{isEnabled}}
\index{isEnabled@{isEnabled}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{isEnabled()}{isEnabled()}}
{\footnotesize\ttfamily bool Swatch\+Viewer\+::is\+Enabled (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00195 \{ \textcolor{keywordflow}{return} m\_enabled; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a5af373d5f3858a29ebb982bfef858472}\label{class_swatch_viewer_a5af373d5f3858a29ebb982bfef858472}} 
\index{SwatchViewer@{SwatchViewer}!keyPressEvent@{keyPressEvent}}
\index{keyPressEvent@{keyPressEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{keyPressEvent()}{keyPressEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::key\+Press\+Event (\begin{DoxyParamCaption}\item[{QKey\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00800                                                  \{}
\DoxyCodeLine{00801   \textcolor{keywordtype}{int} key = \textcolor{keyword}{event}-\/>key();}
\DoxyCodeLine{00802   std::string keyStr =}
\DoxyCodeLine{00803       QKeySequence(key + event-\/>modifiers()).toString().toStdString();}
\DoxyCodeLine{00804   QAction *action = CommandManager::instance()-\/>getActionFromShortcut(keyStr);}
\DoxyCodeLine{00805   \textcolor{keywordflow}{if} (action) \{}
\DoxyCodeLine{00806     std::string actionId = CommandManager::instance()-\/>getIdFromAction(action);}
\DoxyCodeLine{00807     \textcolor{keywordflow}{if} (actionId == V\_ZoomFit) \{}
\DoxyCodeLine{00808       fitView();}
\DoxyCodeLine{00809       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00810     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (actionId == V\_ZoomReset) \{}
\DoxyCodeLine{00811       resetView();}
\DoxyCodeLine{00812       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00813     \}}
\DoxyCodeLine{00814   \}}
\DoxyCodeLine{00815 }
\DoxyCodeLine{00816   \textcolor{keywordflow}{if} (key == \textcolor{charliteral}{'+'} || key == \textcolor{charliteral}{'-\/'} || key == \textcolor{charliteral}{'0'}) \{}
\DoxyCodeLine{00817     zoom(key == \textcolor{charliteral}{'+'}, key == \textcolor{charliteral}{'0'});}
\DoxyCodeLine{00818   \}}
\DoxyCodeLine{00819 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_afefde0414c91bfb776b10935a4b0a76f}\label{class_swatch_viewer_afefde0414c91bfb776b10935a4b0a76f}} 
\index{SwatchViewer@{SwatchViewer}!mouseDoubleClickEvent@{mouseDoubleClickEvent}}
\index{mouseDoubleClickEvent@{mouseDoubleClickEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{mouseDoubleClickEvent()}{mouseDoubleClickEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::mouse\+Double\+Click\+Event (\begin{DoxyParamCaption}\item[{QMouse\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00830                                                            \{}
\DoxyCodeLine{00831   \textcolor{comment}{// qDebug() << "{}[mouseDoubleClickEvent]"{};}}
\DoxyCodeLine{00832   \textcolor{keywordflow}{if} (m\_gestureActive \&\& !m\_stylusUsed) \{}
\DoxyCodeLine{00833     m\_gestureActive = \textcolor{keyword}{false};}
\DoxyCodeLine{00834     fitView();}
\DoxyCodeLine{00835     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00836   \}}
\DoxyCodeLine{00837 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a56df7d2a1b88da430566825b431d0fce}\label{class_swatch_viewer_a56df7d2a1b88da430566825b431d0fce}} 
\index{SwatchViewer@{SwatchViewer}!mouseMoveEvent@{mouseMoveEvent}}
\index{mouseMoveEvent@{mouseMoveEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{mouseMoveEvent()}{mouseMoveEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::mouse\+Move\+Event (\begin{DoxyParamCaption}\item[{QMouse\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00701                                                     \{}
\DoxyCodeLine{00702   \textcolor{keywordflow}{if} (m\_gestureActive \&\& m\_touchDevice == QTouchDevice::TouchScreen \&\&}
\DoxyCodeLine{00703       !m\_stylusUsed) \{}
\DoxyCodeLine{00704     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00705   \}}
\DoxyCodeLine{00706 }
\DoxyCodeLine{00707   \mbox{\hyperlink{class_t_point_t}{TPoint}} pos = \mbox{\hyperlink{class_t_point_t}{TPoint}}(event-\/>pos().x(), event-\/>pos().y());}
\DoxyCodeLine{00708   \textcolor{keywordflow}{if} (m\_mouseButton == Qt::LeftButton) \{}
\DoxyCodeLine{00709     \textcolor{keywordflow}{if} (m\_selectedPoint < 0 || m\_selectedPoint >= (\textcolor{keywordtype}{int})m\_points.size()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00710     \mbox{\hyperlink{class_t_point_t}{TPointD}} p = win2world(pos) + m\_pointPosDelta;}
\DoxyCodeLine{00711     \textcolor{keywordtype}{int} index = m\_points[m\_selectedPoint].m\_index;}
\DoxyCodeLine{00712     emit pointPositionChanged(index, p);}
\DoxyCodeLine{00713 }
\DoxyCodeLine{00714     \textcolor{comment}{// It seems that mouse move events may jeopardize our rendering notification}}
\DoxyCodeLine{00715     \textcolor{comment}{// deliveries}}
\DoxyCodeLine{00716     \textcolor{comment}{// -\/ probably because Qt considers them 'higher priority stuff' with respect}}
\DoxyCodeLine{00717     \textcolor{comment}{// to common queued signal-\/slot connections.}}
\DoxyCodeLine{00718 }
\DoxyCodeLine{00719     \textcolor{comment}{// In order to allow processing of the ContentRender::started() and}}
\DoxyCodeLine{00720     \textcolor{comment}{// ContentRender::finished()}}
\DoxyCodeLine{00721     \textcolor{comment}{// signals, we need to process events. We will exclude user input events (ie}}
\DoxyCodeLine{00722     \textcolor{comment}{// other mouse events)}}
\DoxyCodeLine{00723     \textcolor{comment}{// to avoid unnecessary recursions.}}
\DoxyCodeLine{00724 }
\DoxyCodeLine{00725     QCoreApplication::processEvents(QEventLoop::ExcludeUserInputEvents);}
\DoxyCodeLine{00726   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_mouseButton == Qt::MidButton) \{}
\DoxyCodeLine{00727     pan(pos -\/ m\_pos);}
\DoxyCodeLine{00728     m\_pos = pos;}
\DoxyCodeLine{00729   \}}
\DoxyCodeLine{00730 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a7a06c0e587717246e45b412fb0eb97e3}\label{class_swatch_viewer_a7a06c0e587717246e45b412fb0eb97e3}} 
\index{SwatchViewer@{SwatchViewer}!mousePressEvent@{mousePressEvent}}
\index{mousePressEvent@{mousePressEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{mousePressEvent()}{mousePressEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::mouse\+Press\+Event (\begin{DoxyParamCaption}\item[{QMouse\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00637                                                      \{}
\DoxyCodeLine{00638   \textcolor{comment}{// qDebug() << "{}[mousePressEvent]"{};}}
\DoxyCodeLine{00639   \textcolor{keywordflow}{if} (m\_gestureActive \&\& m\_touchDevice == QTouchDevice::TouchScreen \&\&}
\DoxyCodeLine{00640       !m\_stylusUsed) \{}
\DoxyCodeLine{00641     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00642   \}}
\DoxyCodeLine{00643 }
\DoxyCodeLine{00644   \mbox{\hyperlink{class_t_point_t}{TPoint}} pos    = \mbox{\hyperlink{class_t_point_t}{TPoint}}(event-\/>pos().x(), event-\/>pos().y());}
\DoxyCodeLine{00645   m\_mouseButton = \textcolor{keyword}{event}-\/>button();}
\DoxyCodeLine{00646   \textcolor{keywordflow}{if} (m\_mouseButton == Qt::LeftButton) \{}
\DoxyCodeLine{00647     m\_selectedPoint = -\/1;}
\DoxyCodeLine{00648     \textcolor{keywordflow}{if} (m\_points.empty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00649     \mbox{\hyperlink{class_t_point_t}{TPointD}} p = win2world(pos);}
\DoxyCodeLine{00650     \mbox{\hyperlink{class_t_point_t}{TPointD}} q;}
\DoxyCodeLine{00651     \textcolor{keywordtype}{double} minDist2 = 1e6;}
\DoxyCodeLine{00652     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00653     \textcolor{keywordflow}{for} (i = 0; i < (int)m\_points.size(); i++) \{}
\DoxyCodeLine{00654       \mbox{\hyperlink{class_t_point_t}{TPointD}} paramPoint = m\_points[i].m\_param-\/>getValue(m\_frame);}
\DoxyCodeLine{00655       \textcolor{keywordtype}{double} d2          = tdistance2(p, paramPoint);}
\DoxyCodeLine{00656       \textcolor{keywordflow}{if} (m\_selectedPoint < 0 || d2 < minDist2) \{}
\DoxyCodeLine{00657         m\_selectedPoint = i;}
\DoxyCodeLine{00658         minDist2        = d2;}
\DoxyCodeLine{00659         q               = paramPoint;}
\DoxyCodeLine{00660       \}}
\DoxyCodeLine{00661     \}}
\DoxyCodeLine{00662     \textcolor{keywordflow}{if} (m\_selectedPoint >= 0) \{}
\DoxyCodeLine{00663       m\_pointPosDelta = q -\/ p;}
\DoxyCodeLine{00664       \mbox{\hyperlink{class_t_point_t}{TPoint}} d        = world2win(p) -\/ world2win(q);}
\DoxyCodeLine{00665       \textcolor{keywordtype}{int} dd2         = d.x * d.x + d.y * d.y;}
\DoxyCodeLine{00666       \textcolor{keywordflow}{if} (dd2 > 400)}
\DoxyCodeLine{00667         m\_selectedPoint = -\/1;}
\DoxyCodeLine{00668       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00669         std::string name   = m\_points[m\_selectedPoint].m\_param-\/>getName();}
\DoxyCodeLine{00670         std::string prefix = matchSuffix(name, \textcolor{stringliteral}{"{}\_b"{}});}
\DoxyCodeLine{00671         \textcolor{keywordflow}{if} (prefix != \textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{00672           std::string otherName = prefix + \textcolor{stringliteral}{"{}\_a"{}};}
\DoxyCodeLine{00673           \textcolor{keywordtype}{int} n                 = (int)m\_points.size();}
\DoxyCodeLine{00674           \textcolor{keywordtype}{int} j;}
\DoxyCodeLine{00675           \textcolor{keywordflow}{for} (j = 0; j < n; j++)}
\DoxyCodeLine{00676             \textcolor{keywordflow}{if} (i != j \&\& m\_points[j].m\_param-\/>getName() == otherName) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00677           \textcolor{keywordflow}{if} (j < n) \{}
\DoxyCodeLine{00678             \mbox{\hyperlink{class_t_point_t}{TPoint}} dist = world2win(m\_points[m\_selectedPoint].m\_param-\/>getValue(}
\DoxyCodeLine{00679                               m\_frame)) -\/}
\DoxyCodeLine{00680                           world2win(m\_points[j].m\_param-\/>getValue(m\_frame));}
\DoxyCodeLine{00681             \textcolor{keywordtype}{int} ddist2 = dist.x * dist.x + dist.y * dist.y;}
\DoxyCodeLine{00682             \textcolor{keywordflow}{if} (ddist2 < 100) m\_selectedPoint = j;}
\DoxyCodeLine{00683           \}}
\DoxyCodeLine{00684         \}}
\DoxyCodeLine{00685       \}}
\DoxyCodeLine{00686     \}}
\DoxyCodeLine{00687     update();}
\DoxyCodeLine{00688   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_mouseButton == Qt::MidButton) \{}
\DoxyCodeLine{00689     m\_pos        = pos;}
\DoxyCodeLine{00690     m\_firstPos   = pos;}
\DoxyCodeLine{00691     m\_oldContent = getContent();}
\DoxyCodeLine{00692     \textcolor{keywordflow}{if} (m\_oldContent)}
\DoxyCodeLine{00693       m\_curContent = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}(m\_oldContent-\/>getSize());}
\DoxyCodeLine{00694     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00695       m\_curContent = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}();}
\DoxyCodeLine{00696   \}}
\DoxyCodeLine{00697 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a895b20d90b250825ea408c6694e8ee85}\label{class_swatch_viewer_a895b20d90b250825ea408c6694e8ee85}} 
\index{SwatchViewer@{SwatchViewer}!mouseReleaseEvent@{mouseReleaseEvent}}
\index{mouseReleaseEvent@{mouseReleaseEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{mouseReleaseEvent()}{mouseReleaseEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::mouse\+Release\+Event (\begin{DoxyParamCaption}\item[{QMouse\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00734                                                        \{}
\DoxyCodeLine{00735   m\_mouseButton   = Qt::NoButton;}
\DoxyCodeLine{00736   m\_selectedPoint = -\/1;}
\DoxyCodeLine{00737   \mbox{\hyperlink{class_t_point_t}{TPoint}} pos      = \mbox{\hyperlink{class_t_point_t}{TPoint}}(event-\/>pos().x(), event-\/>pos().y());}
\DoxyCodeLine{00738   \textcolor{keywordflow}{if} (event-\/>button() == Qt::MidButton) \{}
\DoxyCodeLine{00739     \textcolor{keywordflow}{if} (!m\_oldContent || !m\_curContent) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00740     \mbox{\hyperlink{class_t_point_t}{TPointD}} p = convert(pos -\/ m\_pos);}
\DoxyCodeLine{00741     setAff(\mbox{\hyperlink{class_t_translation}{TTranslation}}(p.x, -\/p.y) * m\_aff);}
\DoxyCodeLine{00742     update();}
\DoxyCodeLine{00743   \}}
\DoxyCodeLine{00744   m\_gestureActive = \textcolor{keyword}{false};}
\DoxyCodeLine{00745   m\_zooming       = \textcolor{keyword}{false};}
\DoxyCodeLine{00746   m\_panning       = \textcolor{keyword}{false};}
\DoxyCodeLine{00747   m\_stylusUsed    = \textcolor{keyword}{false};}
\DoxyCodeLine{00748 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a896d9a6b80c313b75444960a89a46d55}\label{class_swatch_viewer_a896d9a6b80c313b75444960a89a46d55}} 
\index{SwatchViewer@{SwatchViewer}!paintEvent@{paintEvent}}
\index{paintEvent@{paintEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{paintEvent()}{paintEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::paint\+Event (\begin{DoxyParamCaption}\item[{QPaint\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00604                                                 \{}
\DoxyCodeLine{00605   QPainter p(\textcolor{keyword}{this});}
\DoxyCodeLine{00606   QRect rectBox = rect();}
\DoxyCodeLine{00607 }
\DoxyCodeLine{00608   \textcolor{keywordflow}{if} (!m\_enabled)}
\DoxyCodeLine{00609     p.fillRect(rectBox, QBrush(QColor(120, 120, 120)));}
\DoxyCodeLine{00610   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00611     \textcolor{keywordflow}{if} (!m\_raster) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00612     QImage image = rasterToQImage(m\_raster);}
\DoxyCodeLine{00613     p.drawImage(rectBox, image);}
\DoxyCodeLine{00614     \textcolor{keywordflow}{if} (m\_computing) \{}
\DoxyCodeLine{00615       QPen pen;}
\DoxyCodeLine{00616       pen.setColor(Qt::red);}
\DoxyCodeLine{00617       pen.setWidth(3);}
\DoxyCodeLine{00618       p.setPen(pen);}
\DoxyCodeLine{00619       p.drawRect(rectBox.adjusted(0, 0, -\/1, -\/1));}
\DoxyCodeLine{00620     \}}
\DoxyCodeLine{00621   \}}
\DoxyCodeLine{00622 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a7ef2ed6ee4b3b5be4e0a64eb6f718915}\label{class_swatch_viewer_a7ef2ed6ee4b3b5be4e0a64eb6f718915}} 
\index{SwatchViewer@{SwatchViewer}!pan@{pan}}
\index{pan@{pan}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{pan()}{pan()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::pan (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&}]{delta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00477                                           \{}
\DoxyCodeLine{00478   \mbox{\hyperlink{class_t_point_t}{TPointD}} step = convert(delta);}
\DoxyCodeLine{00479   setAff(\mbox{\hyperlink{class_t_translation}{TTranslation}}(step.x, -\/step.y) * m\_aff);}
\DoxyCodeLine{00480 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a094b900a04ca53730b4d53e00bc6d117}\label{class_swatch_viewer_a094b900a04ca53730b4d53e00bc6d117}} 
\index{SwatchViewer@{SwatchViewer}!resetView@{resetView}}
\index{resetView@{resetView}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{resetView}{resetView}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::reset\+View (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00445 \{ setAff(\mbox{\hyperlink{class_t_affine}{TAffine}}()); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a787019cc33ab85d128566bcbaa492dd2}\label{class_swatch_viewer_a787019cc33ab85d128566bcbaa492dd2}} 
\index{SwatchViewer@{SwatchViewer}!resizeEvent@{resizeEvent}}
\index{resizeEvent@{resizeEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{resizeEvent()}{resizeEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::resize\+Event (\begin{DoxyParamCaption}\item[{QResize\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00626                                                \{}
\DoxyCodeLine{00627   \textcolor{keywordtype}{int} oldHeight = re-\/>oldSize().height();}
\DoxyCodeLine{00628   \textcolor{keywordtype}{int} newHeight = re-\/>size().height();}
\DoxyCodeLine{00629   \textcolor{keywordflow}{if} (oldHeight != newHeight) \{}
\DoxyCodeLine{00630     updateSize(QSize(newHeight, newHeight));}
\DoxyCodeLine{00631     computeContent();}
\DoxyCodeLine{00632   \}}
\DoxyCodeLine{00633 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_ad0b2e16ff3738e7572a1f5db4468545c}\label{class_swatch_viewer_ad0b2e16ff3738e7572a1f5db4468545c}} 
\index{SwatchViewer@{SwatchViewer}!setAff@{setAff}}
\index{setAff@{setAff}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{setAff()}{setAff()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::set\+Aff (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00597                                             \{}
\DoxyCodeLine{00598   m\_aff = aff;}
\DoxyCodeLine{00599   computeContent();}
\DoxyCodeLine{00600 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a5fb9370bbb99147564e479482f9c2644}\label{class_swatch_viewer_a5fb9370bbb99147564e479482f9c2644}} 
\index{SwatchViewer@{SwatchViewer}!setBgPainter@{setBgPainter}}
\index{setBgPainter@{setBgPainter}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{setBgPainter}{setBgPainter}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::set\+Bg\+Painter (\begin{DoxyParamCaption}\item[{TPixel32}]{color1,  }\item[{TPixel32}]{color2 = {\ttfamily TPixel32()} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00406                                                                 \{}
\DoxyCodeLine{00407   \textcolor{keywordflow}{if} (color2 == TPixel32())}
\DoxyCodeLine{00408     m\_bgPainter = \textcolor{keyword}{new} \mbox{\hyperlink{class_solid_color_bg_painter}{SolidColorBgPainter}}(\textcolor{stringliteral}{"{}"{}}, color1);}
\DoxyCodeLine{00409   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00410     m\_bgPainter = \textcolor{keyword}{new} \mbox{\hyperlink{class_checkboard_bg_painter}{CheckboardBgPainter}}(\textcolor{stringliteral}{"{}"{}}, color1, color2);}
\DoxyCodeLine{00411   updateRaster();}
\DoxyCodeLine{00412 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_ab8628345566c06dbf91c6b1c336e690f}\label{class_swatch_viewer_ab8628345566c06dbf91c6b1c336e690f}} 
\index{SwatchViewer@{SwatchViewer}!setCameraMode@{setCameraMode}}
\index{setCameraMode@{setCameraMode}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{setCameraMode()}{setCameraMode()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::set\+Camera\+Mode (\begin{DoxyParamCaption}\item[{bool}]{enabled }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00185 \{ m\_cameraMode = enabled; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a6cb0cc1eb92c94f1b9550aebc75b8427}\label{class_swatch_viewer_a6cb0cc1eb92c94f1b9550aebc75b8427}} 
\index{SwatchViewer@{SwatchViewer}!setCameraSize@{setCameraSize}}
\index{setCameraSize@{setCameraSize}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{setCameraSize()}{setCameraSize()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::set\+Camera\+Size (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_dimension_t}{TDimension}} \&}]{camera\+Size }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00312                                                              \{}
\DoxyCodeLine{00313   \mbox{\hyperlink{class_t_rect_t}{TRect}} cameraRect(cameraSize);}
\DoxyCodeLine{00314   \textcolor{keywordflow}{if} (cameraRect != m\_cameraRect) \{}
\DoxyCodeLine{00315     m\_cameraRect = cameraRect;}
\DoxyCodeLine{00316     updateSize(size());  \textcolor{comment}{// Invoke a size update to adapt the widget to the new}}
\DoxyCodeLine{00317                          \textcolor{comment}{// camera ratio}}
\DoxyCodeLine{00318   \}}
\DoxyCodeLine{00319 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a9783e5d28a77eed3e1eab43e3df1e15e}\label{class_swatch_viewer_a9783e5d28a77eed3e1eab43e3df1e15e}} 
\index{SwatchViewer@{SwatchViewer}!setContent@{setContent}}
\index{setContent@{setContent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{setContent()}{setContent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::set\+Content (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} \&}]{content,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{content\+Aff }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00587                                                          \{}
\DoxyCodeLine{00588   m\_content    = content;}
\DoxyCodeLine{00589   m\_contentAff = contentAff;}
\DoxyCodeLine{00590 }
\DoxyCodeLine{00591   updateRaster();}
\DoxyCodeLine{00592   update();}
\DoxyCodeLine{00593 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a107e8e8843b357c7566c0792b28a17ad}\label{class_swatch_viewer_a107e8e8843b357c7566c0792b28a17ad}} 
\index{SwatchViewer@{SwatchViewer}!setEnable@{setEnable}}
\index{setEnable@{setEnable}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{setEnable}{setEnable}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::set\+Enable (\begin{DoxyParamCaption}\item[{bool}]{enabled }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00376                                          \{}
\DoxyCodeLine{00377   \textcolor{keywordflow}{if} (m\_enabled == enabled) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00378   m\_enabled = enabled;}
\DoxyCodeLine{00379   \textcolor{keywordflow}{if} (m\_enabled) \{}
\DoxyCodeLine{00380     \textcolor{keywordflow}{if} (m\_firstEnabled) \{}
\DoxyCodeLine{00381       m\_firstEnabled = \textcolor{keyword}{false};}
\DoxyCodeLine{00382       fitView();}
\DoxyCodeLine{00383     \}}
\DoxyCodeLine{00384     computeContent();}
\DoxyCodeLine{00385   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00386     update();}
\DoxyCodeLine{00387 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a4c4fdb58b79bdd09087bcfc19bd6dad8}\label{class_swatch_viewer_a4c4fdb58b79bdd09087bcfc19bd6dad8}} 
\index{SwatchViewer@{SwatchViewer}!setFx@{setFx}}
\index{setFx@{setFx}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{setFx()}{setFx()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::set\+Fx (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TFxP}} \&}]{fx,  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TFxP}} \&}]{actual\+Fx,  }\item[{int}]{frame }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00323                                                                         \{}
\DoxyCodeLine{00324   m\_fx = m\_actualFxClone = fx;}
\DoxyCodeLine{00325   m\_frame                = frame;}
\DoxyCodeLine{00326   m\_points.clear();}
\DoxyCodeLine{00327   m\_pointPairs.clear();}
\DoxyCodeLine{00328 }
\DoxyCodeLine{00329   \textcolor{keywordflow}{if} (!fx) \{}
\DoxyCodeLine{00330     ::setFxForCaching(0);}
\DoxyCodeLine{00331     computeContent();}
\DoxyCodeLine{00332     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00333   \}}
\DoxyCodeLine{00334 }
\DoxyCodeLine{00335   \textcolor{comment}{// abilita la cache nel nuovo effetto corrente}}
\DoxyCodeLine{00336   ::setFxForCaching(actualFx.getPointer());}
\DoxyCodeLine{00337 }
\DoxyCodeLine{00338   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_na_affine_fx}{NaAffineFx}} *affFx = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_na_affine_fx}{NaAffineFx}} *\textcolor{keyword}{>}(m\_fx.getPointer()))}
\DoxyCodeLine{00339     m\_fxAff = affFx-\/>getPlacement(m\_frame);}
\DoxyCodeLine{00340   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00341     m\_fxAff = \mbox{\hyperlink{class_t_affine}{TAffine}}();}
\DoxyCodeLine{00342   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00343   \textcolor{keywordflow}{for} (i = 0; i < actualFx-\/>getParams()-\/>getParamCount(); i++) \{}
\DoxyCodeLine{00344     \mbox{\hyperlink{class_t_point_param}{TPointParam}} *pointParam =}
\DoxyCodeLine{00345         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_t_point_param}{TPointParam}} *\textcolor{keyword}{>}(actualFx-\/>getParams()-\/>getParam(i));}
\DoxyCodeLine{00346     \textcolor{keywordflow}{if} (pointParam) m\_points.push\_back(Point(i, pointParam));}
\DoxyCodeLine{00347   \}}
\DoxyCodeLine{00348   \textcolor{comment}{// cerco i segmenti}}
\DoxyCodeLine{00349   \textcolor{keywordtype}{int} n = m\_points.size();}
\DoxyCodeLine{00350   \textcolor{keywordflow}{for} (i = 0; i < n; i++) \{}
\DoxyCodeLine{00351     std::string name   = m\_points[i].m\_param-\/>getName();}
\DoxyCodeLine{00352     std::string prefix = matchSuffix(name, \textcolor{stringliteral}{"{}\_a"{}});}
\DoxyCodeLine{00353     \textcolor{keywordflow}{if} (prefix == \textcolor{stringliteral}{"{}"{}}) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00354     std::string otherName = prefix + \textcolor{stringliteral}{"{}\_b"{}};}
\DoxyCodeLine{00355     \textcolor{keywordtype}{int} j;}
\DoxyCodeLine{00356     \textcolor{keywordflow}{for} (j = 0; j < n; j++)}
\DoxyCodeLine{00357       \textcolor{keywordflow}{if} (i != j \&\& m\_points[j].m\_param-\/>getName() == otherName) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00358     \textcolor{keywordflow}{if} (j < n) \{}
\DoxyCodeLine{00359       m\_pointPairs.push\_back(std::make\_pair(i, j));}
\DoxyCodeLine{00360       m\_points[i].m\_pairFlag = m\_points[j].m\_pairFlag = \textcolor{keyword}{true};}
\DoxyCodeLine{00361     \}}
\DoxyCodeLine{00362   \}}
\DoxyCodeLine{00363   computeContent();}
\DoxyCodeLine{00364 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a194e96e43dd523173b6c9f447817b62f}\label{class_swatch_viewer_a194e96e43dd523173b6c9f447817b62f}} 
\index{SwatchViewer@{SwatchViewer}!suspendRendering@{suspendRendering}}
\index{suspendRendering@{suspendRendering}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{suspendRendering()}{suspendRendering()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::suspend\+Rendering (\begin{DoxyParamCaption}\item[{bool}]{suspend,  }\item[{bool}]{blocking = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

This static method is used to temporarily suspend all swatch-\/related render processing, typically because the rendering scene is being deleted. When a suspension is invoked, all further rendering requests made to swatch viewers are silently rejected, while currently active or scheduled ones are canceled and waited for completion. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00298                                                                \{}
\DoxyCodeLine{00299   suspendedRendering = suspend;}
\DoxyCodeLine{00300 }
\DoxyCodeLine{00301   \textcolor{keywordflow}{if} (suspend \&\& submittedTasks > 0 \&\& blocking) \{}
\DoxyCodeLine{00302     QEventLoop loop;}
\DoxyCodeLine{00303 }
\DoxyCodeLine{00304     waitingLoop = \&loop;}
\DoxyCodeLine{00305     loop.exec();}
\DoxyCodeLine{00306     waitingLoop = 0;}
\DoxyCodeLine{00307   \}}
\DoxyCodeLine{00308 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a7b835dd1571c5d49825c0096c58c48f8}\label{class_swatch_viewer_a7b835dd1571c5d49825c0096c58c48f8}} 
\index{SwatchViewer@{SwatchViewer}!tabletEvent@{tabletEvent}}
\index{tabletEvent@{tabletEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{tabletEvent()}{tabletEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::tablet\+Event (\begin{DoxyParamCaption}\item[{QTablet\+Event $\ast$}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00862                                               \{}
\DoxyCodeLine{00863   \textcolor{comment}{// qDebug() << "{}[tabletEvent]"{};}}
\DoxyCodeLine{00864   \textcolor{keywordflow}{if} (e-\/>type() == QTabletEvent::TabletPress) \{}
\DoxyCodeLine{00865     m\_stylusUsed = e-\/>pointerType() ? true : \textcolor{keyword}{false};}
\DoxyCodeLine{00866   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (e-\/>type() == QTabletEvent::TabletRelease) \{}
\DoxyCodeLine{00867     m\_stylusUsed = \textcolor{keyword}{false};}
\DoxyCodeLine{00868   \}}
\DoxyCodeLine{00869 }
\DoxyCodeLine{00870   e-\/>accept();}
\DoxyCodeLine{00871 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a220ea66c6f7c5baf87f17bdcb12eb11b}\label{class_swatch_viewer_a220ea66c6f7c5baf87f17bdcb12eb11b}} 
\index{SwatchViewer@{SwatchViewer}!touchEvent@{touchEvent}}
\index{touchEvent@{touchEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{touchEvent()}{touchEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::touch\+Event (\begin{DoxyParamCaption}\item[{QTouch\+Event $\ast$}]{e,  }\item[{int}]{type }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00939                                                       \{}
\DoxyCodeLine{00940   \textcolor{comment}{// qDebug() << "{}[touchEvent]"{};}}
\DoxyCodeLine{00941   \textcolor{keywordflow}{if} (type == QEvent::TouchBegin) \{}
\DoxyCodeLine{00942     m\_touchActive   = \textcolor{keyword}{true};}
\DoxyCodeLine{00943     m\_firstPanPoint = e-\/>touchPoints().at(0).pos();}
\DoxyCodeLine{00944     \textcolor{comment}{// obtain device type}}
\DoxyCodeLine{00945     m\_touchDevice = e-\/>device()-\/>type();}
\DoxyCodeLine{00946   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m\_touchActive) \{}
\DoxyCodeLine{00947     \textcolor{comment}{// touchpads must have 2 finger panning for tools and navigation to be}}
\DoxyCodeLine{00948     \textcolor{comment}{// functional on other devices, 1 finger panning is preferred}}
\DoxyCodeLine{00949     \textcolor{keywordflow}{if} ((e-\/>touchPoints().count() == 2 \&\&}
\DoxyCodeLine{00950          m\_touchDevice == QTouchDevice::TouchPad) ||}
\DoxyCodeLine{00951         (e-\/>touchPoints().count() == 1 \&\&}
\DoxyCodeLine{00952          m\_touchDevice == QTouchDevice::TouchScreen)) \{}
\DoxyCodeLine{00953       QTouchEvent::TouchPoint panPoint = e-\/>touchPoints().at(0);}
\DoxyCodeLine{00954       \textcolor{keywordflow}{if} (!m\_panning) \{}
\DoxyCodeLine{00955         QPointF deltaPoint = panPoint.pos() -\/ m\_firstPanPoint;}
\DoxyCodeLine{00956         \textcolor{comment}{// minimize accidental and jerky zooming/rotating during 2 finger}}
\DoxyCodeLine{00957         \textcolor{comment}{// panning}}
\DoxyCodeLine{00958         \textcolor{keywordflow}{if} ((deltaPoint.manhattanLength() > 100) \&\& !m\_zooming) \{}
\DoxyCodeLine{00959           m\_panning = \textcolor{keyword}{true};}
\DoxyCodeLine{00960         \}}
\DoxyCodeLine{00961       \}}
\DoxyCodeLine{00962       \textcolor{keywordflow}{if} (m\_panning) \{}
\DoxyCodeLine{00963         QPoint curPos  = panPoint.pos().toPoint();}
\DoxyCodeLine{00964         QPoint lastPos = panPoint.lastPos().toPoint();}
\DoxyCodeLine{00965         \mbox{\hyperlink{class_t_point_t}{TPoint}} centerDelta =}
\DoxyCodeLine{00966             \mbox{\hyperlink{class_t_point_t}{TPoint}}(curPos.x(), curPos.y()) -\/ \mbox{\hyperlink{class_t_point_t}{TPoint}}(lastPos.x(), lastPos.y());}
\DoxyCodeLine{00967         pan(centerDelta);}
\DoxyCodeLine{00968       \}}
\DoxyCodeLine{00969     \}}
\DoxyCodeLine{00970   \}}
\DoxyCodeLine{00971   \textcolor{keywordflow}{if} (type == QEvent::TouchEnd || type == QEvent::TouchCancel) \{}
\DoxyCodeLine{00972     m\_touchActive = \textcolor{keyword}{false};}
\DoxyCodeLine{00973     m\_panning     = \textcolor{keyword}{false};}
\DoxyCodeLine{00974   \}}
\DoxyCodeLine{00975   e-\/>accept();}
\DoxyCodeLine{00976 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a0d0cc24f3d4b71fe6cd733dc43397a23}\label{class_swatch_viewer_a0d0cc24f3d4b71fe6cd733dc43397a23}} 
\index{SwatchViewer@{SwatchViewer}!updateFrame@{updateFrame}}
\index{updateFrame@{updateFrame}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{updateFrame()}{updateFrame()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::update\+Frame (\begin{DoxyParamCaption}\item[{int}]{frame }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00368                                         \{}
\DoxyCodeLine{00369   m\_frame = frame;}
\DoxyCodeLine{00370   computeContent();}
\DoxyCodeLine{00371   update();}
\DoxyCodeLine{00372 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a255e7fd57934b07b54ca51c0b479abec}\label{class_swatch_viewer_a255e7fd57934b07b54ca51c0b479abec}} 
\index{SwatchViewer@{SwatchViewer}!updateRaster@{updateRaster}}
\index{updateRaster@{updateRaster}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{updateRaster()}{updateRaster()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::update\+Raster (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00522                                 \{}
\DoxyCodeLine{00523   QMutexLocker sl(\&m\_mutex);}
\DoxyCodeLine{00524 }
\DoxyCodeLine{00525   \textcolor{keywordflow}{if} (!m\_enabled) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00526   \textcolor{keywordflow}{if} (!m\_raster) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00527   \textcolor{keywordflow}{if} (m\_bgPainter)}
\DoxyCodeLine{00528     m\_bgPainter-\/>paint(m\_raster);}
\DoxyCodeLine{00529   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00530     m\_raster-\/>fill(TPixel32(127, 127, 127));}
\DoxyCodeLine{00531 }
\DoxyCodeLine{00532   \textcolor{keywordflow}{if} (m\_cameraMode \&\& !m\_cameraRect.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \{}
\DoxyCodeLine{00533     \mbox{\hyperlink{class_t_point_t}{TPointD}} p0(m\_cameraRect.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}}, m\_cameraRect.y0);}
\DoxyCodeLine{00534     \mbox{\hyperlink{class_t_point_t}{TPointD}} p1(m\_cameraRect.x1, m\_cameraRect.y1);}
\DoxyCodeLine{00535     \mbox{\hyperlink{class_t_point_t}{TPointD}} center(width() * 0.5, height() * 0.5);}
\DoxyCodeLine{00536     \mbox{\hyperlink{class_t_point_t}{TPoint}} transP0 = convert(m\_aff * p0 + center);}
\DoxyCodeLine{00537     \mbox{\hyperlink{class_t_point_t}{TPoint}} transP1 = convert(m\_aff * p1 + center);}
\DoxyCodeLine{00538     \mbox{\hyperlink{class_t_point_t}{TPoint}} p       = convert(}
\DoxyCodeLine{00539         (\mbox{\hyperlink{class_t_point_t}{TPointD}}(transP1.x, transP1.y) -\/ \mbox{\hyperlink{class_t_point_t}{TPointD}}(transP0.x, transP0.y)) * 0.5);}
\DoxyCodeLine{00540     \mbox{\hyperlink{class_t_rect_t}{TRect}} rect(transP0 -\/ p, transP1 -\/ p);}
\DoxyCodeLine{00541     m\_content-\/>fillOutside(rect, TPixel32(255, 0, 0, 255));}
\DoxyCodeLine{00542     m\_content-\/>fillOutside(rect.enlarge(\mbox{\hyperlink{class_t_dimension_t}{TDimension}}(1, 1)),}
\DoxyCodeLine{00543                            TPixel32(0, 0, 0, 0));}
\DoxyCodeLine{00544   \}}
\DoxyCodeLine{00545 }
\DoxyCodeLine{00546   \textcolor{keywordflow}{if} (m\_content) \mbox{\hyperlink{namespace_t_rop_ae5fd1fb0c2f625e1da14fe92ae0e5122}{TRop::over}}(m\_raster, m\_content);}
\DoxyCodeLine{00547 }
\DoxyCodeLine{00548   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00549   \textcolor{keywordflow}{for} (i = 0; i < (int)m\_points.size(); i++) \{}
\DoxyCodeLine{00550     \textcolor{keywordflow}{if} (m\_points[i].m\_pairFlag) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00551     \mbox{\hyperlink{class_t_point_t}{TPoint}} p = world2win(m\_points[i].m\_param-\/>getValue(m\_frame));}
\DoxyCodeLine{00552     \mbox{\hyperlink{namespace_t_rop_ae5fd1fb0c2f625e1da14fe92ae0e5122}{TRop::over}}(m\_raster, m\_crossIcon, p -\/ \mbox{\hyperlink{class_t_point_t}{TPoint}}(4, 4));}
\DoxyCodeLine{00553   \}}
\DoxyCodeLine{00554   \textcolor{keywordflow}{for} (i = 0; i < (int)m\_pointPairs.size(); i++) \{}
\DoxyCodeLine{00555     \textcolor{keywordtype}{int} i0 = m\_pointPairs[i].first;}
\DoxyCodeLine{00556     \textcolor{keywordtype}{int} i1 = m\_pointPairs[i].second;}
\DoxyCodeLine{00557     assert(i0 != i1);}
\DoxyCodeLine{00558     assert(0 <= i0 \&\& i0 < (\textcolor{keywordtype}{int})m\_points.size());}
\DoxyCodeLine{00559     assert(0 <= i1 \&\& i1 < (\textcolor{keywordtype}{int})m\_points.size());}
\DoxyCodeLine{00560     \mbox{\hyperlink{class_t_point_t}{TPoint}} p0        = world2win(m\_points[i0].m\_param-\/>getValue(m\_frame));}
\DoxyCodeLine{00561     \mbox{\hyperlink{class_t_point_t}{TPoint}} p1        = world2win(m\_points[i1].m\_param-\/>getValue(m\_frame));}
\DoxyCodeLine{00562     \mbox{\hyperlink{class_t_point_t}{TPoint}} delta     = p1 -\/ p0;}
\DoxyCodeLine{00563     \textcolor{keywordtype}{int} len          = tround(sqrt((\textcolor{keywordtype}{double})(delta * delta)));}
\DoxyCodeLine{00564     \textcolor{keywordtype}{double} phi       = 0;}
\DoxyCodeLine{00565     \textcolor{keywordflow}{if} (len > 0) phi = atan2((\textcolor{keywordtype}{double})delta.y, (\textcolor{keywordtype}{double})delta.x) * M\_180\_PI;}
\DoxyCodeLine{00566 }
\DoxyCodeLine{00567     \textcolor{keywordflow}{if} (len > 500) \{}
\DoxyCodeLine{00568       \textcolor{comment}{// puo' succedere per zoom molto grandi.}}
\DoxyCodeLine{00569       \textcolor{comment}{// dovrei fare qualcosa, ma non so bene che cosa e non credo sia}}
\DoxyCodeLine{00570       \textcolor{comment}{// importantissimo}}
\DoxyCodeLine{00571     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00572       \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} arrowShape = createArrowShape(len);}
\DoxyCodeLine{00573       \mbox{\hyperlink{class_t_affine}{TAffine}} aff =}
\DoxyCodeLine{00574           \mbox{\hyperlink{class_t_rotation}{TRotation}}(phi).\mbox{\hyperlink{class_t_affine_a5c556c5952cff649a61add494ff3423c}{place}}(0, arrowShape-\/>getLy() / 2, p0.x, p0.y);}
\DoxyCodeLine{00575       \mbox{\hyperlink{namespace_t_rop_ae5fd1fb0c2f625e1da14fe92ae0e5122}{TRop::over}}(m\_raster, arrowShape, aff);}
\DoxyCodeLine{00576       \textcolor{comment}{// verrebbe la tentazione di usare il filtro TRop::Bilinear (piu'veloce),}}
\DoxyCodeLine{00577       \textcolor{comment}{// ma la qualita' ne risente molto}}
\DoxyCodeLine{00578     \}}
\DoxyCodeLine{00579   \}}
\DoxyCodeLine{00580 }
\DoxyCodeLine{00581   update();}
\DoxyCodeLine{00582 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a26cd42dbe8dd9379ec783542bd64dc08}\label{class_swatch_viewer_a26cd42dbe8dd9379ec783542bd64dc08}} 
\index{SwatchViewer@{SwatchViewer}!updateSize@{updateSize}}
\index{updateSize@{updateSize}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{updateSize}{updateSize}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::update\+Size (\begin{DoxyParamCaption}\item[{const QSize \&}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00391                                                \{}
\DoxyCodeLine{00392   \textcolor{keywordtype}{int} h        = size.height();}
\DoxyCodeLine{00393   \textcolor{keywordtype}{double} ratio = m\_cameraRect.getLy() > 0}
\DoxyCodeLine{00394                      ? m\_cameraRect.getLx() / (double)m\_cameraRect.getLy()}
\DoxyCodeLine{00395                      : 1.0;}
\DoxyCodeLine{00396   \textcolor{keywordtype}{int} w = std::min((\textcolor{keywordtype}{int})(h * ratio), parentWidget()-\/>width());}
\DoxyCodeLine{00397   setFixedWidth(w);}
\DoxyCodeLine{00398   \textcolor{keywordflow}{if} (w > 2 \&\& h > 2)}
\DoxyCodeLine{00399     m\_raster = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}(\mbox{\hyperlink{class_t_dimension_t}{TDimension}}(w, h));}
\DoxyCodeLine{00400   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00401     m\_raster = \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}();}
\DoxyCodeLine{00402 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a4ff74d0579f49d45583ae6bc31e06c8b}\label{class_swatch_viewer_a4ff74d0579f49d45583ae6bc31e06c8b}} 
\index{SwatchViewer@{SwatchViewer}!wheelEvent@{wheelEvent}}
\index{wheelEvent@{wheelEvent}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{wheelEvent()}{wheelEvent()}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::wheel\+Event (\begin{DoxyParamCaption}\item[{QWheel\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00752                                                 \{}
\DoxyCodeLine{00753   \textcolor{keywordtype}{int} delta = 0;}
\DoxyCodeLine{00754   \textcolor{keywordflow}{switch} (event-\/>source()) \{}
\DoxyCodeLine{00755   \textcolor{keywordflow}{case} Qt::MouseEventNotSynthesized: \{}
\DoxyCodeLine{00756     \textcolor{keywordflow}{if} (event-\/>modifiers() \& Qt::AltModifier)}
\DoxyCodeLine{00757       delta = \textcolor{keyword}{event}-\/>angleDelta().x();}
\DoxyCodeLine{00758     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00759       delta = \textcolor{keyword}{event}-\/>angleDelta().y();}
\DoxyCodeLine{00760     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00761   \}}
\DoxyCodeLine{00762 }
\DoxyCodeLine{00763   \textcolor{keywordflow}{case} Qt::MouseEventSynthesizedBySystem: \{}
\DoxyCodeLine{00764     QPoint numPixels  = \textcolor{keyword}{event}-\/>pixelDelta();}
\DoxyCodeLine{00765     QPoint numDegrees = \textcolor{keyword}{event}-\/>angleDelta() / 8;}
\DoxyCodeLine{00766     \textcolor{keywordflow}{if} (!numPixels.isNull()) \{}
\DoxyCodeLine{00767       delta = \textcolor{keyword}{event}-\/>pixelDelta().y();}
\DoxyCodeLine{00768     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!numDegrees.isNull()) \{}
\DoxyCodeLine{00769       QPoint numSteps = numDegrees / 15;}
\DoxyCodeLine{00770       delta           = numSteps.y();}
\DoxyCodeLine{00771     \}}
\DoxyCodeLine{00772     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00773   \}}
\DoxyCodeLine{00774 }
\DoxyCodeLine{00775   \textcolor{keywordflow}{default}:  \textcolor{comment}{// Qt::MouseEventSynthesizedByQt,}}
\DoxyCodeLine{00776             \textcolor{comment}{// Qt::MouseEventSynthesizedByApplication}}
\DoxyCodeLine{00777     \{}
\DoxyCodeLine{00778       std::cout << \textcolor{stringliteral}{"{}not supported event: Qt::MouseEventSynthesizedByQt, "{}}}
\DoxyCodeLine{00779                    \textcolor{stringliteral}{"{}Qt::MouseEventSynthesizedByApplication"{}}}
\DoxyCodeLine{00780                 << std::endl;}
\DoxyCodeLine{00781       \textcolor{keywordflow}{break};}
\DoxyCodeLine{00782     \}}
\DoxyCodeLine{00783 }
\DoxyCodeLine{00784   \}  \textcolor{comment}{// end switch}}
\DoxyCodeLine{00785 }
\DoxyCodeLine{00786   \textcolor{keywordflow}{if} (abs(delta) > 0) \{}
\DoxyCodeLine{00787     \textcolor{keywordflow}{if} ((m\_gestureActive == \textcolor{keyword}{true} \&\&}
\DoxyCodeLine{00788          m\_touchDevice == QTouchDevice::TouchScreen) ||}
\DoxyCodeLine{00789         m\_gestureActive == \textcolor{keyword}{false}) \{}
\DoxyCodeLine{00790       \mbox{\hyperlink{class_t_point_t}{TPoint}} center(event-\/>pos().x() -\/ width() / 2,}
\DoxyCodeLine{00791                     -\/event-\/>pos().y() + height() / 2);}
\DoxyCodeLine{00792       zoom(center, exp(0.001 * event-\/>delta()));}
\DoxyCodeLine{00793     \}}
\DoxyCodeLine{00794   \}}
\DoxyCodeLine{00795   \textcolor{keyword}{event}-\/>accept();}
\DoxyCodeLine{00796 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a0203c47fc5165fe7937c28866bbf7932}\label{class_swatch_viewer_a0203c47fc5165fe7937c28866bbf7932}} 
\index{SwatchViewer@{SwatchViewer}!win2world@{win2world}}
\index{win2world@{win2world}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{win2world()}{win2world()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPointD}} Swatch\+Viewer\+::win2world (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&}]{p }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00423                                                      \{}
\DoxyCodeLine{00424   \mbox{\hyperlink{class_t_point_t}{TPointD}} center(width() * 0.5, height() * 0.5);}
\DoxyCodeLine{00425   \mbox{\hyperlink{class_t_point_t}{TPointD}} point = \mbox{\hyperlink{class_t_point_t}{TPointD}}(convert(p) -\/ center);}
\DoxyCodeLine{00426   \textcolor{keywordflow}{return} m\_fxAff.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * m\_aff.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * \mbox{\hyperlink{class_t_point_t}{TPointD}}(point.x, -\/point.y);}
\DoxyCodeLine{00427 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_aaaa6fd61362dbe6cea404e5e4fe391f4}\label{class_swatch_viewer_aaaa6fd61362dbe6cea404e5e4fe391f4}} 
\index{SwatchViewer@{SwatchViewer}!world2win@{world2win}}
\index{world2win@{world2win}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{world2win()}{world2win()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_point_t}{TPoint}} Swatch\+Viewer\+::world2win (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPointD}} \&}]{p }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00416                                                      \{}
\DoxyCodeLine{00417   \mbox{\hyperlink{class_t_point_t}{TPointD}} center(width() * 0.5, height() * 0.5);}
\DoxyCodeLine{00418   \textcolor{keywordflow}{return} convert(m\_aff * m\_fxAff * p + center);}
\DoxyCodeLine{00419 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_a6975a5489c08803c67a05021c30f910e}\label{class_swatch_viewer_a6975a5489c08803c67a05021c30f910e}} 
\index{SwatchViewer@{SwatchViewer}!zoom@{zoom}}
\index{zoom@{zoom}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{zoom()}{zoom()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::zoom (\begin{DoxyParamCaption}\item[{bool}]{forward,  }\item[{bool}]{reset }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00465                                                 \{}
\DoxyCodeLine{00466   \textcolor{keywordtype}{double} scale2 = m\_aff.det();}
\DoxyCodeLine{00467   \textcolor{keywordflow}{if} (reset || ((scale2 < 2000 || !forward) \&\& (scale2 > 0.004 || forward))) \{}
\DoxyCodeLine{00468     \textcolor{keywordtype}{double} oldZoomScale = sqrt(scale2);}
\DoxyCodeLine{00469     \textcolor{keywordtype}{double} zoomScale =}
\DoxyCodeLine{00470         reset ? 1 : getQuantizedZoomFactor(oldZoomScale, forward);}
\DoxyCodeLine{00471     \mbox{\hyperlink{class_t_affine}{TAffine}} aff = \mbox{\hyperlink{class_t_scale}{TScale}}(zoomScale / oldZoomScale);}
\DoxyCodeLine{00472 }
\DoxyCodeLine{00473     setAff(aff * m\_aff);}
\DoxyCodeLine{00474   \}}
\DoxyCodeLine{00475 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_swatch_viewer_aae94bedfb14c3cf65b76ee148c5e5c12}\label{class_swatch_viewer_aae94bedfb14c3cf65b76ee148c5e5c12}} 
\index{SwatchViewer@{SwatchViewer}!zoom@{zoom}}
\index{zoom@{zoom}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{zoom()}{zoom()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Swatch\+Viewer\+::zoom (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_point_t}{TPoint}} \&}]{pos,  }\item[{double}]{factor }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00431                                                         \{}
\DoxyCodeLine{00432   \textcolor{keywordflow}{if} (!m\_content || factor == 1.0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00433 }
\DoxyCodeLine{00434   \mbox{\hyperlink{class_t_point_t}{TPointD}} delta = convert(pos);}
\DoxyCodeLine{00435   \textcolor{keywordtype}{double} scale  = m\_aff.det();}
\DoxyCodeLine{00436   \mbox{\hyperlink{class_t_affine}{TAffine}} aff;}
\DoxyCodeLine{00437   \textcolor{keywordflow}{if} ((scale < 2000 || factor < 1) \&\& (scale > 0.004 || factor > 1)) \{}
\DoxyCodeLine{00438     aff = \mbox{\hyperlink{class_t_translation}{TTranslation}}(delta) * \mbox{\hyperlink{class_t_scale}{TScale}}(factor) * \mbox{\hyperlink{class_t_translation}{TTranslation}}(-\/delta);}
\DoxyCodeLine{00439     setAff(aff * m\_aff);}
\DoxyCodeLine{00440   \}}
\DoxyCodeLine{00441 \}}

\end{DoxyCode}


\doxysubsection{Friends And Related Function Documentation}
\mbox{\Hypertarget{class_swatch_viewer_aa113bd47178f9539d0ed8eb474e24b6f}\label{class_swatch_viewer_aa113bd47178f9539d0ed8eb474e24b6f}} 
\index{SwatchViewer@{SwatchViewer}!ContentRender@{ContentRender}}
\index{ContentRender@{ContentRender}!SwatchViewer@{SwatchViewer}}
\doxysubsubsection{\texorpdfstring{ContentRender}{ContentRender}}
{\footnotesize\ttfamily friend class \mbox{\hyperlink{class_swatch_viewer_1_1_content_render}{Content\+Render}}\hspace{0.3cm}{\ttfamily [friend]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/toonzqt/swatchviewer.\+h\item 
E\+:/opentoonz/toonz/sources/toonzqt/swatchviewer.\+cpp\end{DoxyCompactItemize}
