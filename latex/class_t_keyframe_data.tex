\hypertarget{class_t_keyframe_data}{}\doxysection{TKeyframe\+Data Class Reference}
\label{class_t_keyframe_data}\index{TKeyframeData@{TKeyframeData}}
Inheritance diagram for TKeyframe\+Data\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_t_keyframe_data}
\end{center}
\end{figure}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef TKeyframe\+Selection\+::\+Position \mbox{\hyperlink{class_t_keyframe_data_a61a1faded2e47e8bf119f3db2595bd6e}{Position}}
\item 
typedef std\+::map$<$ Position, \mbox{\hyperlink{struct_t_stage_object_1_1_keyframe}{TStage\+Object\+::\+Keyframe}} $>$ \mbox{\hyperlink{class_t_keyframe_data_a893dfa43187229d23bbcffb376454582}{Key\+Data}}
\item 
typedef std\+::map$<$ Position, \mbox{\hyperlink{struct_t_stage_object_1_1_keyframe}{TStage\+Object\+::\+Keyframe}} $>$\+::const\+\_\+iterator \mbox{\hyperlink{class_t_keyframe_data_a409313bc0be0029f6a89289fab8e31f3}{Iterator}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_keyframe_data_ade932300291eb0406941f773be528b6f}{TKeyframe\+Data}} (const \mbox{\hyperlink{class_t_keyframe_data}{TKeyframe\+Data}} $\ast$src)
\item 
\mbox{\hyperlink{class_t_keyframe_data}{TKeyframe\+Data}} $\ast$ \mbox{\hyperlink{class_t_keyframe_data_a7a162cefb84994eec6231ef3367d994f}{clone}} () const override
\item 
void \mbox{\hyperlink{class_t_keyframe_data_a8bef46fa86cdb534b6fdadcce73d7dd1}{set\+Keyframes}} (std\+::set$<$ Position $>$ positions, \mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$xsh)
\item 
void \mbox{\hyperlink{class_t_keyframe_data_a71c207a45d4a0e65b7554574ab79b298}{set\+Keyframes}} (std\+::set$<$ Position $>$ positions, \mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$xsh, Position start\+Pos)
\item 
bool \mbox{\hyperlink{class_t_keyframe_data_aa630e9da889212b31e260970a757e530}{get\+Keyframes}} (std\+::set$<$ Position $>$ \&positions, \mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$xsh) const
\item 
void \mbox{\hyperlink{class_t_keyframe_data_a753f56f099b2a78a33462b93e631d228}{get\+Keyframes}} (std\+::set$<$ Position $>$ \&positions) const
\item 
\mbox{\hyperlink{class_t_keyframe_data}{TKeyframe\+Data}} $\ast$ \mbox{\hyperlink{class_t_keyframe_data_a0f7fe21ec0182bd57972b7e8234eaea7}{clone}} ()
\item 
int \mbox{\hyperlink{class_t_keyframe_data_adb478566c008e84fdd0a68acd1d87c40}{get\+Column\+Span\+Count}} () const
\item 
int \mbox{\hyperlink{class_t_keyframe_data_a9aba7bb41e1b2d8d0ec9ef04f1130006}{get\+Row\+Span\+Count}} () const
\item 
void \mbox{\hyperlink{class_t_keyframe_data_adfb6a908460eb4f065d58afe8f370c67}{set\+Keyframes\+Offset}} (int row, int col)
\item 
Position \mbox{\hyperlink{class_t_keyframe_data_a27fe128014fa7f1afbcd937aec665d76}{get\+Keyframes\+Offset}} () const
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
Key\+Data \mbox{\hyperlink{class_t_keyframe_data_aed2662041a6f808c3e717b803908e347}{m\+\_\+key\+Data}}
\item 
int \mbox{\hyperlink{class_t_keyframe_data_acb7d89b66c7f0ad5cd3ba2d925ec7f21}{m\+\_\+column\+Span\+Count}}
\item 
int \mbox{\hyperlink{class_t_keyframe_data_a8d3437be632f6c893a487c5414e77ec0}{m\+\_\+row\+Span\+Count}}
\item 
Position \mbox{\hyperlink{class_t_keyframe_data_ad8ea92db81f6f003565ef724b093c8c0}{m\+\_\+offset}} = std\+::make\+\_\+pair(0, 0)
\item 
std\+::map$<$ int, bool $>$ \mbox{\hyperlink{class_t_keyframe_data_ac033c76e3f0ea5b4db395350fb123e64}{m\+\_\+is\+Pegbars\+Cycle\+Enabled}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Member Typedef Documentation}
\mbox{\Hypertarget{class_t_keyframe_data_a409313bc0be0029f6a89289fab8e31f3}\label{class_t_keyframe_data_a409313bc0be0029f6a89289fab8e31f3}} 
\index{TKeyframeData@{TKeyframeData}!Iterator@{Iterator}}
\index{Iterator@{Iterator}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{Iterator}{Iterator}}
{\footnotesize\ttfamily typedef std\+::map$<$Position,\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe}{TStage\+Object\+::\+Keyframe}}$>$\+::const\+\_\+iterator TKeyframe\+Data\+::\+Iterator}

\mbox{\Hypertarget{class_t_keyframe_data_a893dfa43187229d23bbcffb376454582}\label{class_t_keyframe_data_a893dfa43187229d23bbcffb376454582}} 
\index{TKeyframeData@{TKeyframeData}!KeyData@{KeyData}}
\index{KeyData@{KeyData}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{KeyData}{KeyData}}
{\footnotesize\ttfamily typedef std\+::map$<$Position, \mbox{\hyperlink{struct_t_stage_object_1_1_keyframe}{TStage\+Object\+::\+Keyframe}}$>$ TKeyframe\+Data\+::\+Key\+Data}

\mbox{\Hypertarget{class_t_keyframe_data_a61a1faded2e47e8bf119f3db2595bd6e}\label{class_t_keyframe_data_a61a1faded2e47e8bf119f3db2595bd6e}} 
\index{TKeyframeData@{TKeyframeData}!Position@{Position}}
\index{Position@{Position}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{Position}{Position}}
{\footnotesize\ttfamily typedef TKeyframe\+Selection\+::\+Position TKeyframe\+Data\+::\+Position}



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_t_keyframe_data_a9901fea2a877c5aa0f4c99fdda0b16af}\label{class_t_keyframe_data_a9901fea2a877c5aa0f4c99fdda0b16af}} 
\index{TKeyframeData@{TKeyframeData}!TKeyframeData@{TKeyframeData}}
\index{TKeyframeData@{TKeyframeData}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{TKeyframeData()}{TKeyframeData()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily TKeyframe\+Data\+::\+TKeyframe\+Data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00021 \{\}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_keyframe_data_ade932300291eb0406941f773be528b6f}\label{class_t_keyframe_data_ade932300291eb0406941f773be528b6f}} 
\index{TKeyframeData@{TKeyframeData}!TKeyframeData@{TKeyframeData}}
\index{TKeyframeData@{TKeyframeData}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{TKeyframeData()}{TKeyframeData()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily TKeyframe\+Data\+::\+TKeyframe\+Data (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_keyframe_data}{TKeyframe\+Data}} $\ast$}]{src }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00026     : m\_keyData(src-\/>m\_keyData)}
\DoxyCodeLine{00027     , m\_isPegbarsCycleEnabled(src-\/>m\_isPegbarsCycleEnabled)}
\DoxyCodeLine{00028     , m\_offset(src-\/>m\_offset) \{\}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_keyframe_data_ae3ddcff3a457119af316761639ef763c}\label{class_t_keyframe_data_ae3ddcff3a457119af316761639ef763c}} 
\index{TKeyframeData@{TKeyframeData}!````~TKeyframeData@{$\sim$TKeyframeData}}
\index{````~TKeyframeData@{$\sim$TKeyframeData}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{$\sim$TKeyframeData()}{~TKeyframeData()}}
{\footnotesize\ttfamily TKeyframe\+Data\+::$\sim$\+TKeyframe\+Data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00032 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_t_keyframe_data_a0f7fe21ec0182bd57972b7e8234eaea7}\label{class_t_keyframe_data_a0f7fe21ec0182bd57972b7e8234eaea7}} 
\index{TKeyframeData@{TKeyframeData}!clone@{clone}}
\index{clone@{clone}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{clone()}{clone()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_keyframe_data}{TKeyframe\+Data}} $\ast$ TKeyframe\+Data\+::clone (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00052                          \{}
\DoxyCodeLine{00053     \mbox{\hyperlink{class_t_keyframe_data}{TKeyframeData}} *data = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_keyframe_data}{TKeyframeData}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00054     \textcolor{keywordflow}{return} data;}
\DoxyCodeLine{00055   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_keyframe_data_a7a162cefb84994eec6231ef3367d994f}\label{class_t_keyframe_data_a7a162cefb84994eec6231ef3367d994f}} 
\index{TKeyframeData@{TKeyframeData}!clone@{clone}}
\index{clone@{clone}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{clone()}{clone()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_keyframe_data}{TKeyframe\+Data}} $\ast$ TKeyframe\+Data\+::clone (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_dv_mime_data}{Dv\+Mime\+Data}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00038 \{ \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{class_t_keyframe_data}{TKeyframeData}}(\textcolor{keyword}{this}); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_keyframe_data_adb478566c008e84fdd0a68acd1d87c40}\label{class_t_keyframe_data_adb478566c008e84fdd0a68acd1d87c40}} 
\index{TKeyframeData@{TKeyframeData}!getColumnSpanCount@{getColumnSpanCount}}
\index{getColumnSpanCount@{getColumnSpanCount}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{getColumnSpanCount()}{getColumnSpanCount()}}
{\footnotesize\ttfamily int TKeyframe\+Data\+::get\+Column\+Span\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00057 \{ \textcolor{keywordflow}{return} m\_columnSpanCount; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_keyframe_data_a753f56f099b2a78a33462b93e631d228}\label{class_t_keyframe_data_a753f56f099b2a78a33462b93e631d228}} 
\index{TKeyframeData@{TKeyframeData}!getKeyframes@{getKeyframes}}
\index{getKeyframes@{getKeyframes}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{getKeyframes()}{getKeyframes()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void TKeyframe\+Data\+::get\+Keyframes (\begin{DoxyParamCaption}\item[{std\+::set$<$ Position $>$ \&}]{positions }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00206                                                                   \{}
\DoxyCodeLine{00207   \textcolor{keywordtype}{int} r0 = positions.begin()-\/>first;}
\DoxyCodeLine{00208   \textcolor{keywordtype}{int} c0 = positions.begin()-\/>second;}
\DoxyCodeLine{00209   positions.clear();}
\DoxyCodeLine{00210 }
\DoxyCodeLine{00211   TKeyframeData::KeyData::const\_iterator it;}
\DoxyCodeLine{00212   \textcolor{keywordflow}{for} (it = m\_keyData.begin(); it != m\_keyData.end(); ++it) \{}
\DoxyCodeLine{00213     TKeyframeData::Position pos(it-\/>first);}
\DoxyCodeLine{00214     positions.insert(}
\DoxyCodeLine{00215         TKeyframeSelection::Position(pos.first + r0, pos.second + c0));}
\DoxyCodeLine{00216   \}}
\DoxyCodeLine{00217 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_keyframe_data_aa630e9da889212b31e260970a757e530}\label{class_t_keyframe_data_aa630e9da889212b31e260970a757e530}} 
\index{TKeyframeData@{TKeyframeData}!getKeyframes@{getKeyframes}}
\index{getKeyframes@{getKeyframes}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{getKeyframes()}{getKeyframes()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily bool TKeyframe\+Data\+::get\+Keyframes (\begin{DoxyParamCaption}\item[{std\+::set$<$ Position $>$ \&}]{positions,  }\item[{\mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$}]{xsh }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00085                                                      \{}
\DoxyCodeLine{00086   std::set<TKeyframeSelection::Position>::iterator it2 = positions.begin();}
\DoxyCodeLine{00087   \textcolor{keywordtype}{int} r0                                               = it2-\/>first;}
\DoxyCodeLine{00088   \textcolor{keywordtype}{int} c0                                               = it2-\/>second;}
\DoxyCodeLine{00089   std::map<int, int> firstRowCol, lastRowCol;}
\DoxyCodeLine{00090   firstRowCol.insert(std::pair<int, int>(c0, r0));}
\DoxyCodeLine{00091   lastRowCol.insert(std::pair<int, int>(c0, r0));}
\DoxyCodeLine{00092   \textcolor{keywordflow}{for} (++it2; it2 != positions.end(); ++it2) \{}
\DoxyCodeLine{00093     r0 = std::min(r0, it2-\/>first);}
\DoxyCodeLine{00094     c0 = std::min(c0, it2-\/>second);}
\DoxyCodeLine{00095     std::map<int, int>::iterator itF = firstRowCol.find(it2-\/>second);}
\DoxyCodeLine{00096     std::map<int, int>::iterator itL = lastRowCol.find(it2-\/>second);}
\DoxyCodeLine{00097     \textcolor{keywordflow}{if} (itF == firstRowCol.end())}
\DoxyCodeLine{00098       firstRowCol.insert(std::pair<int, int>(it2-\/>second, it2-\/>first));}
\DoxyCodeLine{00099     \textcolor{keywordflow}{if} (itL == lastRowCol.end())}
\DoxyCodeLine{00100       lastRowCol.insert(std::pair<int, int>(it2-\/>second, it2-\/>first));}
\DoxyCodeLine{00101     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00102       itL-\/>second = c0;}
\DoxyCodeLine{00103   \}}
\DoxyCodeLine{00104 }
\DoxyCodeLine{00105   \mbox{\hyperlink{class_xsheet_viewer}{XsheetViewer}} *viewer = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getCurrentXsheetViewer();}
\DoxyCodeLine{00106 }
\DoxyCodeLine{00107   positions.clear();}
\DoxyCodeLine{00108   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} cameraId =}
\DoxyCodeLine{00109       TStageObjectId::CameraId(xsh-\/>getCameraColumnIndex());}
\DoxyCodeLine{00110   Iterator it;}
\DoxyCodeLine{00111   \textcolor{keywordtype}{bool} keyFrameChanged = \textcolor{keyword}{false};}
\DoxyCodeLine{00112   \textcolor{keywordflow}{for} (it = m\_keyData.begin(); it != m\_keyData.end(); ++it) \{}
\DoxyCodeLine{00113     Position pos = it-\/>first;}
\DoxyCodeLine{00114     \textcolor{keywordtype}{int} row      = r0 + pos.first;}
\DoxyCodeLine{00115     \textcolor{keywordtype}{int} col      = c0 + pos.second;}
\DoxyCodeLine{00116     positions.insert(std::make\_pair(row, col));}
\DoxyCodeLine{00117     \mbox{\hyperlink{class_t_xsh_column}{TXshColumn}} *column = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(col);}
\DoxyCodeLine{00118     \textcolor{keywordflow}{if} (column \&\& column-\/>getSoundColumn()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00119     \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *pegbar = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(}
\DoxyCodeLine{00120         col >= 0 ? TStageObjectId::ColumnId(col) : cameraId);}
\DoxyCodeLine{00121     \textcolor{keywordflow}{if} (xsh-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(col) \&\& xsh-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(col)-\/>\mbox{\hyperlink{class_t_xsh_column_a04953896aae8860ace46010956a28db9}{isLocked}}()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00122     keyFrameChanged = \textcolor{keyword}{true};}
\DoxyCodeLine{00123     assert(pegbar);}
\DoxyCodeLine{00124 }
\DoxyCodeLine{00125     \textcolor{keywordtype}{int} kF, kL, kP, kN;}
\DoxyCodeLine{00126     \textcolor{keywordtype}{double} e0, e1;}
\DoxyCodeLine{00127     pegbar-\/>getKeyframeRange(kF, kL);}
\DoxyCodeLine{00128     pegbar-\/>setKeyframeWithoutUndo(row, it-\/>second);}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130     std::map<int, int>::iterator itF = firstRowCol.find(col);}
\DoxyCodeLine{00131     std::map<int, int>::iterator itL = lastRowCol.find(col);}
\DoxyCodeLine{00132     \mbox{\hyperlink{struct_t_stage_object_1_1_keyframe}{TStageObject::Keyframe}} newKey = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_aacff624691523109a01d3039b8aae432}{getKeyframe}}(row);}
\DoxyCodeLine{00133     \textcolor{comment}{// Process 1st key added in column}}
\DoxyCodeLine{00134     \textcolor{keywordflow}{if} (itF != firstRowCol.end() \&\& itF-\/>second == row) \{}
\DoxyCodeLine{00135       \textcolor{keywordflow}{if} (row > kL) \{}
\DoxyCodeLine{00136         \textcolor{comment}{// If new key was added after the existing last one, create new}}
\DoxyCodeLine{00137         \textcolor{comment}{// interpolation between them using preference setting}}
\DoxyCodeLine{00138         \mbox{\hyperlink{struct_t_stage_object_1_1_keyframe}{TStageObject::Keyframe}} prevKey = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_aacff624691523109a01d3039b8aae432}{getKeyframe}}(kL);}
\DoxyCodeLine{00139         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < TStageObject::T\_ChannelCount; i++) \{}
\DoxyCodeLine{00140           \textcolor{keywordflow}{if} (newKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_isKeyframe \&\&}
\DoxyCodeLine{00141               prevKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_isKeyframe) \{}
\DoxyCodeLine{00142             prevKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_type = TDoubleKeyframe::Type(}
\DoxyCodeLine{00143                 Preferences::instance()-\/>getKeyframeType());}
\DoxyCodeLine{00144             newKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_prevType = prevKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_type;}
\DoxyCodeLine{00145           \}}
\DoxyCodeLine{00146         \}}
\DoxyCodeLine{00147         pegbar-\/>setKeyframeWithoutUndo(kL, prevKey);}
\DoxyCodeLine{00148         pegbar-\/>setKeyframeWithoutUndo(row, newKey);}
\DoxyCodeLine{00149       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row > kF) \{}
\DoxyCodeLine{00150         \textcolor{comment}{// If new key was added between existing keys, sync new key's previous}}
\DoxyCodeLine{00151         \textcolor{comment}{// interpolation to key just before it}}
\DoxyCodeLine{00152         \textcolor{keywordflow}{if} (!pegbar-\/>getKeyframeSpan(row -\/ 1, kP, e0, kN, e1)) kP = row -\/ 1;}
\DoxyCodeLine{00153         \mbox{\hyperlink{struct_t_stage_object_1_1_keyframe}{TStageObject::Keyframe}} prevKey = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_aacff624691523109a01d3039b8aae432}{getKeyframe}}(kP);}
\DoxyCodeLine{00154         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < TStageObject::T\_ChannelCount; i++) \{}
\DoxyCodeLine{00155           \textcolor{keywordflow}{if} (newKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_isKeyframe \&\&}
\DoxyCodeLine{00156               prevKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_isKeyframe)}
\DoxyCodeLine{00157             newKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_prevType = prevKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_type; }
\DoxyCodeLine{00158         \}}
\DoxyCodeLine{00159         pegbar-\/>setKeyframeWithoutUndo(row, newKey);}
\DoxyCodeLine{00160       \}}
\DoxyCodeLine{00161     \}}
\DoxyCodeLine{00162     \textcolor{comment}{// Process last key added in column}}
\DoxyCodeLine{00163     \textcolor{keywordflow}{if} (itL != lastRowCol.end() \&\& itL-\/>second == row) \{}
\DoxyCodeLine{00164       \textcolor{keywordflow}{if} (row < kF) \{}
\DoxyCodeLine{00165         \textcolor{comment}{// If new key was added before the existing 1st one, create new}}
\DoxyCodeLine{00166         \textcolor{comment}{// interpolation between them using preference setting}}
\DoxyCodeLine{00167         \mbox{\hyperlink{struct_t_stage_object_1_1_keyframe}{TStageObject::Keyframe}} nextKey = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_aacff624691523109a01d3039b8aae432}{getKeyframe}}(kF);}
\DoxyCodeLine{00168         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < TStageObject::T\_ChannelCount; i++) \{}
\DoxyCodeLine{00169           \textcolor{keywordflow}{if} (newKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_isKeyframe \&\&}
\DoxyCodeLine{00170               nextKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_isKeyframe) \{}
\DoxyCodeLine{00171             newKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_type = TDoubleKeyframe::Type(}
\DoxyCodeLine{00172                 Preferences::instance()-\/>getKeyframeType());}
\DoxyCodeLine{00173             nextKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_prevType = newKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_type;}
\DoxyCodeLine{00174           \}}
\DoxyCodeLine{00175         \}}
\DoxyCodeLine{00176         pegbar-\/>setKeyframeWithoutUndo(row, newKey);}
\DoxyCodeLine{00177         pegbar-\/>setKeyframeWithoutUndo(kF, nextKey);}
\DoxyCodeLine{00178       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row < kL) \{}
\DoxyCodeLine{00179         \textcolor{comment}{// If new key was added between existing keys, sync new key to the next}}
\DoxyCodeLine{00180         \textcolor{comment}{// key's previous interpolation}}
\DoxyCodeLine{00181         \textcolor{keywordflow}{if} (!pegbar-\/>getKeyframeSpan(row + 1, kP, e0, kN, e1)) kN = row + 1;}
\DoxyCodeLine{00182         \mbox{\hyperlink{struct_t_stage_object_1_1_keyframe}{TStageObject::Keyframe}} nextKey = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_aacff624691523109a01d3039b8aae432}{getKeyframe}}(kN);}
\DoxyCodeLine{00183         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < TStageObject::T\_ChannelCount; i++) \{}
\DoxyCodeLine{00184           \textcolor{keywordflow}{if} (newKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_isKeyframe \&\&}
\DoxyCodeLine{00185               nextKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_isKeyframe) \{}
\DoxyCodeLine{00186             nextKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_prevType = newKey.\mbox{\hyperlink{struct_t_stage_object_1_1_keyframe_a550937888febd57e2059d37d1e0df68f}{m\_channels}}[i].m\_type;}
\DoxyCodeLine{00187           \}}
\DoxyCodeLine{00188         \}}
\DoxyCodeLine{00189         pegbar-\/>setKeyframeWithoutUndo(row, newKey);}
\DoxyCodeLine{00190       \}}
\DoxyCodeLine{00191     \}}
\DoxyCodeLine{00192   \}}
\DoxyCodeLine{00193   \textcolor{keywordflow}{if} (!keyFrameChanged) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00194 }
\DoxyCodeLine{00195   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \textcolor{keyword}{const} pegbar : m\_isPegbarsCycleEnabled) \{}
\DoxyCodeLine{00196     \textcolor{keywordtype}{int} \textcolor{keyword}{const} col = pegbar.first;}
\DoxyCodeLine{00197     \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} objectId =}
\DoxyCodeLine{00198         (col >= 0) ? TStageObjectId::ColumnId(col) : cameraId;}
\DoxyCodeLine{00199     xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(objectId)-\/>\mbox{\hyperlink{class_t_stage_object_a7bf5e6ed9872b613c34b7d921457065a}{enableCycle}}(pegbar.second);}
\DoxyCodeLine{00200   \}}
\DoxyCodeLine{00201   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00202 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_keyframe_data_a27fe128014fa7f1afbcd937aec665d76}\label{class_t_keyframe_data_a27fe128014fa7f1afbcd937aec665d76}} 
\index{TKeyframeData@{TKeyframeData}!getKeyframesOffset@{getKeyframesOffset}}
\index{getKeyframesOffset@{getKeyframesOffset}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{getKeyframesOffset()}{getKeyframesOffset()}}
{\footnotesize\ttfamily Position TKeyframe\+Data\+::get\+Keyframes\+Offset (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00061 \{ \textcolor{keywordflow}{return} m\_offset; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_keyframe_data_a9aba7bb41e1b2d8d0ec9ef04f1130006}\label{class_t_keyframe_data_a9aba7bb41e1b2d8d0ec9ef04f1130006}} 
\index{TKeyframeData@{TKeyframeData}!getRowSpanCount@{getRowSpanCount}}
\index{getRowSpanCount@{getRowSpanCount}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{getRowSpanCount()}{getRowSpanCount()}}
{\footnotesize\ttfamily int TKeyframe\+Data\+::get\+Row\+Span\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00058 \{ \textcolor{keywordflow}{return} m\_rowSpanCount; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_keyframe_data_a8bef46fa86cdb534b6fdadcce73d7dd1}\label{class_t_keyframe_data_a8bef46fa86cdb534b6fdadcce73d7dd1}} 
\index{TKeyframeData@{TKeyframeData}!setKeyframes@{setKeyframes}}
\index{setKeyframes@{setKeyframes}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{setKeyframes()}{setKeyframes()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void TKeyframe\+Data\+::set\+Keyframes (\begin{DoxyParamCaption}\item[{std\+::set$<$ Position $>$}]{positions,  }\item[{\mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$}]{xsh }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00036                                                                          \{}
\DoxyCodeLine{00037   Position startPos(-\/1, -\/1);}
\DoxyCodeLine{00038   setKeyframes(positions, xsh, startPos);}
\DoxyCodeLine{00039 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_keyframe_data_a71c207a45d4a0e65b7554574ab79b298}\label{class_t_keyframe_data_a71c207a45d4a0e65b7554574ab79b298}} 
\index{TKeyframeData@{TKeyframeData}!setKeyframes@{setKeyframes}}
\index{setKeyframes@{setKeyframes}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{setKeyframes()}{setKeyframes()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void TKeyframe\+Data\+::set\+Keyframes (\begin{DoxyParamCaption}\item[{std\+::set$<$ Position $>$}]{positions,  }\item[{\mbox{\hyperlink{class_t_xsheet}{TXsheet}} $\ast$}]{xsh,  }\item[{Position}]{start\+Pos }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00042                                                     \{}
\DoxyCodeLine{00043   \textcolor{keywordflow}{if} (positions.empty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00044 }
\DoxyCodeLine{00045   \mbox{\hyperlink{class_t_stage_object_id}{TStageObjectId}} cameraId =}
\DoxyCodeLine{00046       TStageObjectId::CameraId(xsh-\/>getCameraColumnIndex());}
\DoxyCodeLine{00047 }
\DoxyCodeLine{00048   std::set<Position>::iterator it = positions.begin();}
\DoxyCodeLine{00049   \textcolor{keywordtype}{int} r0                          = it-\/>first;}
\DoxyCodeLine{00050   \textcolor{keywordtype}{int} c0                          = it-\/>second;}
\DoxyCodeLine{00051   \textcolor{keywordtype}{int} r1                          = it-\/>first;}
\DoxyCodeLine{00052   \textcolor{keywordtype}{int} c1                          = it-\/>second;}
\DoxyCodeLine{00053   \textcolor{keywordflow}{for} (++it; it != positions.end(); ++it) \{}
\DoxyCodeLine{00054     r0 = std::min(r0, it-\/>first);}
\DoxyCodeLine{00055     c0 = std::min(c0, it-\/>second);}
\DoxyCodeLine{00056     r1 = std::max(r1, it-\/>first);}
\DoxyCodeLine{00057     c1 = std::max(c1, it-\/>second);}
\DoxyCodeLine{00058   \}}
\DoxyCodeLine{00059 }
\DoxyCodeLine{00060   m\_columnSpanCount = c1 -\/ c0 + 1;}
\DoxyCodeLine{00061   m\_rowSpanCount    = r1 -\/ r0 + 1;}
\DoxyCodeLine{00062 }
\DoxyCodeLine{00063   \textcolor{keywordflow}{if} (startPos.first >= 0 \&\& startPos.second >= 0)}
\DoxyCodeLine{00064     m\_offset = std::make\_pair(r0 -\/ startPos.first, c0 -\/ startPos.second);}
\DoxyCodeLine{00065 }
\DoxyCodeLine{00066   \textcolor{keywordflow}{for} (it = positions.begin(); it != positions.end(); ++it) \{}
\DoxyCodeLine{00067     \textcolor{keywordtype}{int} row              = it-\/>first;}
\DoxyCodeLine{00068     \textcolor{keywordtype}{int} col              = it-\/>second;}
\DoxyCodeLine{00069     \mbox{\hyperlink{class_t_stage_object}{TStageObject}} *pegbar = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a13d9b9c08ca8dde39769f5644e046ee5}{getStageObject}}(}
\DoxyCodeLine{00070         col >= 0 ? TStageObjectId::ColumnId(col) : cameraId);}
\DoxyCodeLine{00071     assert(pegbar);}
\DoxyCodeLine{00072     m\_isPegbarsCycleEnabled[col] = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_a2c2094a00f2a5f616a12662d7a23ea3a}{isCycleEnabled}}();}
\DoxyCodeLine{00073     \textcolor{keywordflow}{if} (pegbar-\/>\mbox{\hyperlink{class_t_stage_object_af2c8c37f71b2b2e2c2a15c6eb73b8b38}{isKeyframe}}(row)) \{}
\DoxyCodeLine{00074       Position p(row -\/ r0, col -\/ c0);}
\DoxyCodeLine{00075       \mbox{\hyperlink{struct_t_stage_object_1_1_keyframe}{TStageObject::Keyframe}} k = pegbar-\/>\mbox{\hyperlink{class_t_stage_object_aacff624691523109a01d3039b8aae432}{getKeyframe}}(row);}
\DoxyCodeLine{00076       m\_keyData[p]             = k;}
\DoxyCodeLine{00077     \}}
\DoxyCodeLine{00078   \}}
\DoxyCodeLine{00079 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_keyframe_data_adfb6a908460eb4f065d58afe8f370c67}\label{class_t_keyframe_data_adfb6a908460eb4f065d58afe8f370c67}} 
\index{TKeyframeData@{TKeyframeData}!setKeyframesOffset@{setKeyframesOffset}}
\index{setKeyframesOffset@{setKeyframesOffset}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{setKeyframesOffset()}{setKeyframesOffset()}}
{\footnotesize\ttfamily void TKeyframe\+Data\+::set\+Keyframes\+Offset (\begin{DoxyParamCaption}\item[{int}]{row,  }\item[{int}]{col }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00219                                                        \{}
\DoxyCodeLine{00220   m\_offset = std::make\_pair(row, col);}
\DoxyCodeLine{00221 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_t_keyframe_data_acb7d89b66c7f0ad5cd3ba2d925ec7f21}\label{class_t_keyframe_data_acb7d89b66c7f0ad5cd3ba2d925ec7f21}} 
\index{TKeyframeData@{TKeyframeData}!m\_columnSpanCount@{m\_columnSpanCount}}
\index{m\_columnSpanCount@{m\_columnSpanCount}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{m\_columnSpanCount}{m\_columnSpanCount}}
{\footnotesize\ttfamily int TKeyframe\+Data\+::m\+\_\+column\+Span\+Count}

\mbox{\Hypertarget{class_t_keyframe_data_ac033c76e3f0ea5b4db395350fb123e64}\label{class_t_keyframe_data_ac033c76e3f0ea5b4db395350fb123e64}} 
\index{TKeyframeData@{TKeyframeData}!m\_isPegbarsCycleEnabled@{m\_isPegbarsCycleEnabled}}
\index{m\_isPegbarsCycleEnabled@{m\_isPegbarsCycleEnabled}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{m\_isPegbarsCycleEnabled}{m\_isPegbarsCycleEnabled}}
{\footnotesize\ttfamily std\+::map$<$int, bool$>$ TKeyframe\+Data\+::m\+\_\+is\+Pegbars\+Cycle\+Enabled}

\mbox{\Hypertarget{class_t_keyframe_data_aed2662041a6f808c3e717b803908e347}\label{class_t_keyframe_data_aed2662041a6f808c3e717b803908e347}} 
\index{TKeyframeData@{TKeyframeData}!m\_keyData@{m\_keyData}}
\index{m\_keyData@{m\_keyData}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{m\_keyData}{m\_keyData}}
{\footnotesize\ttfamily Key\+Data TKeyframe\+Data\+::m\+\_\+key\+Data}

\mbox{\Hypertarget{class_t_keyframe_data_ad8ea92db81f6f003565ef724b093c8c0}\label{class_t_keyframe_data_ad8ea92db81f6f003565ef724b093c8c0}} 
\index{TKeyframeData@{TKeyframeData}!m\_offset@{m\_offset}}
\index{m\_offset@{m\_offset}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{m\_offset}{m\_offset}}
{\footnotesize\ttfamily Position TKeyframe\+Data\+::m\+\_\+offset = std\+::make\+\_\+pair(0, 0)}

\mbox{\Hypertarget{class_t_keyframe_data_a8d3437be632f6c893a487c5414e77ec0}\label{class_t_keyframe_data_a8d3437be632f6c893a487c5414e77ec0}} 
\index{TKeyframeData@{TKeyframeData}!m\_rowSpanCount@{m\_rowSpanCount}}
\index{m\_rowSpanCount@{m\_rowSpanCount}!TKeyframeData@{TKeyframeData}}
\doxysubsubsection{\texorpdfstring{m\_rowSpanCount}{m\_rowSpanCount}}
{\footnotesize\ttfamily int TKeyframe\+Data\+::m\+\_\+row\+Span\+Count}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonz/keyframedata.\+h\item 
E\+:/opentoonz/toonz/sources/toonz/keyframedata.\+cpp\end{DoxyCompactItemize}
