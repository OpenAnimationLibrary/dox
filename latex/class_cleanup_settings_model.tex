\hypertarget{class_cleanup_settings_model}{}\doxysection{Cleanup\+Settings\+Model Class Reference}
\label{class_cleanup_settings_model}\index{CleanupSettingsModel@{CleanupSettingsModel}}


{\ttfamily \#include $<$cleanupsettingsmodel.\+h$>$}

Inheritance diagram for Cleanup\+Settings\+Model\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_cleanup_settings_model}
\end{center}
\end{figure}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \{ {\bfseries LISTENER} = 0x1
, {\bfseries PREVIEWER} = 0x2
, {\bfseries CAMERATEST} = 0x4
 \}
\item 
enum {\bfseries Commit\+Mask} \{ {\bfseries NONE} = 0
, {\bfseries INTERFACE}
, {\bfseries POSTPROCESS}
, {\bfseries FULLPROCESS}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Public Slots}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_cleanup_settings_model_a7b1f1768b04906a781f54d03965d7016}{commit\+Changes}} ()
\item 
void \mbox{\hyperlink{class_cleanup_settings_model_a1310a7fd0caf8560aa806c30eaee53f7}{prompt\+Save}} ()
\begin{DoxyCompactList}\small\item\em Prompts to save current settings. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_cleanup_settings_model_af80a228a227794221750d26a6e7bf766}{prompt\+Load}} ()
\begin{DoxyCompactList}\small\item\em Prompts to load settings. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_cleanup_settings_model_a15df7abc5aaea2155743ce59c3c03b0b}{restore\+Global\+Settings}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Signals}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_cleanup_settings_model_a8e1ea53050b6a45679726c949bc0d95c}{model\+Changed}} (bool needs\+Post\+Process)
\item 
\mbox{\Hypertarget{class_cleanup_settings_model_acb49064f1d809138cb49cd560c4c03d9}\label{class_cleanup_settings_model_acb49064f1d809138cb49cd560c4c03d9}} 
void {\bfseries image\+Switched} ()
\begin{DoxyCompactList}\small\item\em Emitted every time the cleanup focus switches to a new image. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_cleanup_settings_model_ad78610bd7ee12050dc10c9eaf16929c9}{preview\+Data\+Changed}} ()
\item 
void \mbox{\hyperlink{class_cleanup_settings_model_a1fba35f9b6bf33dcae7311c0e3cafa67}{cln\+Loaded}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_cleanup_parameters}{Cleanup\+Parameters}} $\ast$ \mbox{\hyperlink{class_cleanup_settings_model_af2a3e27103283f01a830ecdf06168e42}{get\+Current\+Parameters}} ()
\item 
void \mbox{\hyperlink{class_cleanup_settings_model_abe65b098da3eb470040733b76e07b86d}{get\+Cleanup\+Frame}} (\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$\&sl, \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&fid)
\item 
const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \& \mbox{\hyperlink{class_cleanup_settings_model_af02095102c6a85cfcdde2a8f8a3780f9}{cln\+Path}} () const
\item 
void \mbox{\hyperlink{class_cleanup_settings_model_a244bd70aa1bc4af824a6c8e299cd5d79}{attach}} (int object\+Flag, bool do\+Preview=true)
\item 
void \mbox{\hyperlink{class_cleanup_settings_model_a26a2edbdf4fe3ed77fe4f40020189579}{detach}} (int object\+Flag)
\item 
void \mbox{\hyperlink{class_cleanup_settings_model_a6d8825724b5f3153f2b9318250a5ba38}{get\+Preview\+Data}} (\mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&original, \mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&transformed, \mbox{\hyperlink{class_t_affine}{TAffine}} \&transform)
\item 
void \mbox{\hyperlink{class_cleanup_settings_model_a91498127febe1394e79acfef0cbdea40}{get\+Camera\+Test\+Data}} (\mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&original, \mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&transformed)
\item 
void \mbox{\hyperlink{class_cleanup_settings_model_a24546176ae0de7be360eaf619213d895}{set\+Commit\+Mask}} (Commit\+Mask allowed\+Processing)
\item 
void \mbox{\hyperlink{class_cleanup_settings_model_a2d9db2eaaca9f1e2c6be091f81144d7d}{save\+Settings}} (const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&cln\+Path)
\item 
bool \mbox{\hyperlink{class_cleanup_settings_model_a7188206526532919018ae9da8ebd1e16}{load\+Settings}} (const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&cln\+Path)
\item 
bool \mbox{\hyperlink{class_cleanup_settings_model_aa1fb1f6664d3b6a4ca4dcf9361d538af}{save\+Settings\+If\+Needed}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{class_cleanup_settings_model}{Cleanup\+Settings\+Model}} $\ast$ \mbox{\hyperlink{class_cleanup_settings_model_a13b56ba8eabf7f7c1498f66f6443ac36}{instance}} ()
\item 
static \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \mbox{\hyperlink{class_cleanup_settings_model_af745293ce297fb8b8cad81250bb9aa5f}{get\+Input\+Path}} (\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$sl)
\item 
static \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \mbox{\hyperlink{class_cleanup_settings_model_ac824b1d0e864f6218d53b362a0d0f3f5}{get\+Output\+Path}} (\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$sl, const \mbox{\hyperlink{class_cleanup_parameters}{Cleanup\+Parameters}} $\ast$params)
\item 
static \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \mbox{\hyperlink{class_cleanup_settings_model_ae6b676700db1e01577ec407f29f78f88}{get\+Cln\+Path}} (\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$sl)
\item 
static void \mbox{\hyperlink{class_cleanup_settings_model_a852371a260556200406f292aed420a7c}{save\+Settings}} (\mbox{\hyperlink{class_cleanup_parameters}{Cleanup\+Parameters}} $\ast$params, const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&cln\+Path)
\begin{DoxyCompactList}\small\item\em cln file. \end{DoxyCompactList}\item 
static bool \mbox{\hyperlink{class_cleanup_settings_model_aa49e33b0914593ab81e717463b1373a9}{load\+Settings}} (\mbox{\hyperlink{class_cleanup_parameters}{Cleanup\+Parameters}} $\ast$params, const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&cln\+Path)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The \mbox{\hyperlink{class_cleanup_settings_model}{Cleanup\+Settings\+Model}} is the class responsible for concrete management of cleanup settings in Toonz.

In Toonz, the interface to cleanup settings follows the model/view architecture, where each Cleanup Settings panel is a view to a singleton model of this class. ~\newline
~\newline
 The \mbox{\hyperlink{class_cleanup_settings_model}{Cleanup\+Settings\+Model}} is responsible for handling signals that involve cleanup changes, such as user changes in the parameters coming from views, settings reset or switches from commands, and so on. ~\newline
~\newline
 A cleanup operation is roughly split in 2 parts\+: main processing and post-\/processing. ~\newline
~\newline
 The main processing part takes the full original image and applies geometric transforms and other full-\/image analysis and processing. This is typically slow, and is thus performed by this class once for all views. ~\newline
~\newline
 Post-\/processing performs further local or pixel-\/per-\/pixel adjustments that are sufficiently fast to be carried out by single views on their preview area. This includes {\itshape  colors recognition, colors adjustment, despeckling \texorpdfstring{$<$}{<}\textbackslash{}I\texorpdfstring{$>$}{>} and {\itshape antialiasing-\/related} effects.}

{\itshape \begin{DoxyNote}{Note}
This class also acts as a wrapper to \mbox{\hyperlink{class_cleanup_parameters}{Cleanup\+Parameters}}\textquotesingle{} palette, attaching to the \char`\"{}current cleanup palette handle\char`\"{} accessible through the TPalette\+Controller. 
\end{DoxyNote}
}

\doxysubsection{Member Enumeration Documentation}
\mbox{\Hypertarget{class_cleanup_settings_model_a44a4f8c2566616b6807f3b9228d1ad6b}\label{class_cleanup_settings_model_a44a4f8c2566616b6807f3b9228d1ad6b}} 
\doxysubsubsection{\texorpdfstring{anonymous enum}{anonymous enum}}
{\footnotesize\ttfamily anonymous enum}


\begin{DoxyCode}{0}
\DoxyCodeLine{00089 \{ LISTENER = 0x1, PREVIEWER = 0x2, CAMERATEST = 0x4 \};}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_a1db558b07c2c95ea6eed88ffc11a01ff}\label{class_cleanup_settings_model_a1db558b07c2c95ea6eed88ffc11a01ff}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!CommitMask@{CommitMask}}
\index{CommitMask@{CommitMask}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{CommitMask}{CommitMask}}
{\footnotesize\ttfamily enum Cleanup\+Settings\+Model\+::\+Commit\+Mask}


\begin{DoxyCode}{0}
\DoxyCodeLine{00090 \{ NONE = 0, INTERFACE, POSTPROCESS, FULLPROCESS \};}

\end{DoxyCode}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_cleanup_settings_model_a8c2e503989dffd8ec1bd95b4c2272437}\label{class_cleanup_settings_model_a8c2e503989dffd8ec1bd95b4c2272437}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!CleanupSettingsModel@{CleanupSettingsModel}}
\index{CleanupSettingsModel@{CleanupSettingsModel}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{CleanupSettingsModel()}{CleanupSettingsModel()}}
{\footnotesize\ttfamily Cleanup\+Settings\+Model\+::\+Cleanup\+Settings\+Model (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00143     : m\_listenersCount(0)}
\DoxyCodeLine{00144     , m\_previewersCount(0)}
\DoxyCodeLine{00145     , m\_cameraTestsCount(0)}
\DoxyCodeLine{00146     , m\_allowedActions(FULLPROCESS)}
\DoxyCodeLine{00147     , m\_action(NONE)}
\DoxyCodeLine{00148     , m\_c(-\/1)}
\DoxyCodeLine{00149     , m\_sl(0) \{}
\DoxyCodeLine{00150   \mbox{\hyperlink{class_cleanup_parameters}{CleanupParameters}} *currentParams = getCurrentParameters();}
\DoxyCodeLine{00151 }
\DoxyCodeLine{00152   \textcolor{comment}{// Don't clone the palette. Palette changes are tracked through}}
\DoxyCodeLine{00153   \textcolor{comment}{// palette handle signals.}}
\DoxyCodeLine{00154   m\_backupParams.assign(currentParams, \textcolor{keyword}{false});}
\DoxyCodeLine{00155 }
\DoxyCodeLine{00156   \mbox{\hyperlink{class_t_scene_handle}{TSceneHandle}} *sceneHandle = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}();}
\DoxyCodeLine{00157 }
\DoxyCodeLine{00158   \textcolor{keywordtype}{bool} ret = \textcolor{keyword}{true};}
\DoxyCodeLine{00159   ret      = ret \&\&}
\DoxyCodeLine{00160         connect(sceneHandle, SIGNAL(sceneSwitched()), SLOT(onSceneSwitched()));}
\DoxyCodeLine{00161   assert(ret);}
\DoxyCodeLine{00162 }
\DoxyCodeLine{00163   onSceneSwitched();}
\DoxyCodeLine{00164 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_aa0d729675008c6d6adfaafb88bb4eeb7}\label{class_cleanup_settings_model_aa0d729675008c6d6adfaafb88bb4eeb7}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!````~CleanupSettingsModel@{$\sim$CleanupSettingsModel}}
\index{````~CleanupSettingsModel@{$\sim$CleanupSettingsModel}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{$\sim$CleanupSettingsModel()}{~CleanupSettingsModel()}}
{\footnotesize\ttfamily Cleanup\+Settings\+Model\+::$\sim$\+Cleanup\+Settings\+Model (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00168 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_cleanup_settings_model_a244bd70aa1bc4af824a6c8e299cd5d79}\label{class_cleanup_settings_model_a244bd70aa1bc4af824a6c8e299cd5d79}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!attach@{attach}}
\index{attach@{attach}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{attach()}{attach()}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::attach (\begin{DoxyParamCaption}\item[{int}]{object\+Flag,  }\item[{bool}]{do\+Preview = {\ttfamily true} }\end{DoxyParamCaption})}

Attaches an object to the model. It is not necessary to supply the object itself, but a description of its role is required. The object could be any combination of the LISTENER, PREVIEWER or CAMERATEST flags. The role information is used to activate centralized preview or camera test processing. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00204                                                                 \{}
\DoxyCodeLine{00205   \textcolor{keywordflow}{if} ((objectFlag \& LISTENER) \&\& (m\_listenersCount++ <= 0)) connectSignals();}
\DoxyCodeLine{00206 }
\DoxyCodeLine{00207   \textcolor{keywordtype}{bool} doRebuild = \textcolor{keyword}{false};}
\DoxyCodeLine{00208 }
\DoxyCodeLine{00209   \textcolor{keywordflow}{if} ((objectFlag \& PREVIEWER) \&\& (m\_previewersCount++ <= 0)) doRebuild = \textcolor{keyword}{true};}
\DoxyCodeLine{00210 }
\DoxyCodeLine{00211   \textcolor{keywordflow}{if} ((objectFlag \& CAMERATEST) \&\& (m\_cameraTestsCount++ <= 0))}
\DoxyCodeLine{00212     doRebuild = \textcolor{keyword}{true};}
\DoxyCodeLine{00213 }
\DoxyCodeLine{00214   \textcolor{keywordflow}{if} (doRebuild \&\& doPreview) rebuildPreview();}
\DoxyCodeLine{00215 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_a1fba35f9b6bf33dcae7311c0e3cafa67}\label{class_cleanup_settings_model_a1fba35f9b6bf33dcae7311c0e3cafa67}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!clnLoaded@{clnLoaded}}
\index{clnLoaded@{clnLoaded}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{clnLoaded}{clnLoaded}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::cln\+Loaded (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [signal]}}

Emitted when the model loads (or unloads) a cln settings file. It is also invoked when a cln is saved, since saving should put us in the same situation we have after a cln has been loaded. 

Referenced by \mbox{\hyperlink{l00579}{restore\+Global\+Settings()}}.

\mbox{\Hypertarget{class_cleanup_settings_model_af02095102c6a85cfcdde2a8f8a3780f9}\label{class_cleanup_settings_model_af02095102c6a85cfcdde2a8f8a3780f9}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!clnPath@{clnPath}}
\index{clnPath@{clnPath}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{clnPath()}{clnPath()}}
{\footnotesize\ttfamily const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \& Cleanup\+Settings\+Model\+::cln\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00101 \{ \textcolor{keywordflow}{return} m\_clnPath; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_a7b1f1768b04906a781f54d03965d7016}\label{class_cleanup_settings_model_a7b1f1768b04906a781f54d03965d7016}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!commitChanges@{commitChanges}}
\index{commitChanges@{commitChanges}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{commitChanges}{commitChanges}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::commit\+Changes (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}

Informs the model that current settings have changed. Settings analysis and cleanup refreshes ensue. The \mbox{\hyperlink{class_cleanup_settings_model_a8e1ea53050b6a45679726c949bc0d95c}{model\+Changed()}} signal is then emitted to inform connected views of said change. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00291                                          \{}
\DoxyCodeLine{00292   \mbox{\hyperlink{class_cleanup_parameters}{CleanupParameters}} *currentParams = getCurrentParameters();}
\DoxyCodeLine{00293 }
\DoxyCodeLine{00294   \textcolor{keywordtype}{int} action = NONE;}
\DoxyCodeLine{00295 }
\DoxyCodeLine{00296   \textcolor{comment}{// Analyze param changes}}
\DoxyCodeLine{00297   \{}
\DoxyCodeLine{00298     \textcolor{comment}{// Check for simple changes}}
\DoxyCodeLine{00299     \textcolor{keywordflow}{if} (currentParams-\/>m\_path != m\_backupParams.m\_path) action = INTERFACE;}
\DoxyCodeLine{00300 }
\DoxyCodeLine{00301     \textcolor{comment}{// Check post-\/processing-\/related changes}}
\DoxyCodeLine{00302     \textcolor{keywordflow}{if} (currentParams-\/>m\_transparencyCheckEnabled !=}
\DoxyCodeLine{00303             m\_backupParams.m\_transparencyCheckEnabled ||}
\DoxyCodeLine{00304         currentParams-\/>m\_noAntialias != m\_backupParams.m\_noAntialias ||}
\DoxyCodeLine{00305         currentParams-\/>m\_postAntialias != m\_backupParams.m\_postAntialias ||}
\DoxyCodeLine{00306         currentParams-\/>m\_despeckling != m\_backupParams.m\_despeckling ||}
\DoxyCodeLine{00307         currentParams-\/>m\_aaValue != m\_backupParams.m\_aaValue)}
\DoxyCodeLine{00308 }
\DoxyCodeLine{00309       action = POSTPROCESS;}
\DoxyCodeLine{00310 }
\DoxyCodeLine{00311     \textcolor{comment}{// Check for full preview rebuilds}}
\DoxyCodeLine{00312     \textcolor{keywordflow}{if} (currentParams-\/>m\_lineProcessingMode !=}
\DoxyCodeLine{00313             m\_backupParams.m\_lineProcessingMode ||}
\DoxyCodeLine{00314         currentParams-\/>m\_autocenterType != m\_backupParams.m\_autocenterType ||}
\DoxyCodeLine{00315         currentParams-\/>m\_autoAdjustMode != m\_backupParams.m\_autoAdjustMode ||}
\DoxyCodeLine{00316         currentParams-\/>m\_camera.\mbox{\hyperlink{class_t_camera_a9a7c573e7a2c397ffae4b747809ea2a5}{getRes}}() != m\_backupParams.m\_camera.\mbox{\hyperlink{class_t_camera_a9a7c573e7a2c397ffae4b747809ea2a5}{getRes}}() ||}
\DoxyCodeLine{00317         currentParams-\/>m\_camera.\mbox{\hyperlink{class_t_camera_a6f561eca912177c2150b3e57816f02f6}{getSize}}() !=}
\DoxyCodeLine{00318             m\_backupParams.m\_camera.\mbox{\hyperlink{class_t_camera_a6f561eca912177c2150b3e57816f02f6}{getSize}}() ||}
\DoxyCodeLine{00319         currentParams-\/>m\_rotate != m\_backupParams.m\_rotate ||}
\DoxyCodeLine{00320         currentParams-\/>m\_flipx != m\_backupParams.m\_flipx ||}
\DoxyCodeLine{00321         currentParams-\/>m\_flipy != m\_backupParams.m\_flipy ||}
\DoxyCodeLine{00322         currentParams-\/>m\_offx != m\_backupParams.m\_offx ||}
\DoxyCodeLine{00323         currentParams-\/>m\_offy != m\_backupParams.m\_offy ||}
\DoxyCodeLine{00324         currentParams-\/>m\_sharpness != m\_backupParams.m\_sharpness ||}
\DoxyCodeLine{00325         currentParams-\/>m\_closestField != m\_backupParams.m\_closestField)}
\DoxyCodeLine{00326 }
\DoxyCodeLine{00327       action = FULLPROCESS;}
\DoxyCodeLine{00328 }
\DoxyCodeLine{00329     \textcolor{keywordflow}{if} (currentParams-\/>m\_autocenterType != CleanupTypes::AUTOCENTER\_NONE) \{}
\DoxyCodeLine{00330       \textcolor{comment}{// Check Autocenter changes}}
\DoxyCodeLine{00331       \textcolor{keywordflow}{if} (!(currentParams-\/>getFdgInfo() == m\_backupParams.getFdgInfo()) ||}
\DoxyCodeLine{00332           currentParams-\/>m\_pegSide != m\_backupParams.m\_pegSide)}
\DoxyCodeLine{00333 }
\DoxyCodeLine{00334         action = FULLPROCESS;}
\DoxyCodeLine{00335     \}}
\DoxyCodeLine{00336   \}}
\DoxyCodeLine{00337 }
\DoxyCodeLine{00338   \mbox{\hyperlink{class_cleanup_settings_model_a7b1f1768b04906a781f54d03965d7016}{commitChanges}}(action);}
\DoxyCodeLine{00339 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00291}{commit\+Changes()}}, \mbox{\hyperlink{l00072}{TCamera\+::get\+Res()}}, and \mbox{\hyperlink{l00055}{TCamera\+::get\+Size()}}.



Referenced by \mbox{\hyperlink{l00291}{commit\+Changes()}}, and \mbox{\hyperlink{l00284}{set\+Commit\+Mask()}}.

\mbox{\Hypertarget{class_cleanup_settings_model_a26a2edbdf4fe3ed77fe4f40020189579}\label{class_cleanup_settings_model_a26a2edbdf4fe3ed77fe4f40020189579}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!detach@{detach}}
\index{detach@{detach}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{detach()}{detach()}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::detach (\begin{DoxyParamCaption}\item[{int}]{object\+Flag }\end{DoxyParamCaption})}

The inverse of \mbox{\hyperlink{class_cleanup_settings_model_a244bd70aa1bc4af824a6c8e299cd5d79}{attach()}}, it\textquotesingle{}s used to deactivate the specified role activities when no more attached objects to that role remain. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00219                                                 \{}
\DoxyCodeLine{00220   \textcolor{keywordflow}{if} ((objectFlag \& LISTENER) \&\& (-\/-\/m\_listenersCount <= 0)) disconnectSignals();}
\DoxyCodeLine{00221 }
\DoxyCodeLine{00222   \textcolor{keywordflow}{if} ((objectFlag \& PREVIEWER) \&\& (-\/-\/m\_previewersCount <= 0)) \{}
\DoxyCodeLine{00223     m\_previewTransformed = \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}}();}
\DoxyCodeLine{00224     m\_transform          = \mbox{\hyperlink{class_t_affine}{TAffine}}();}
\DoxyCodeLine{00225   \}}
\DoxyCodeLine{00226 }
\DoxyCodeLine{00227   \textcolor{keywordflow}{if} ((objectFlag \& CAMERATEST) \&\& (-\/-\/m\_cameraTestsCount <= 0))}
\DoxyCodeLine{00228     m\_cameraTestTransformed = \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}}();}
\DoxyCodeLine{00229 }
\DoxyCodeLine{00230   assert(m\_listenersCount >= 0);}
\DoxyCodeLine{00231   assert(m\_previewersCount >= 0);}
\DoxyCodeLine{00232   assert(m\_cameraTestsCount >= 0);}
\DoxyCodeLine{00233 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_a91498127febe1394e79acfef0cbdea40}\label{class_cleanup_settings_model_a91498127febe1394e79acfef0cbdea40}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!getCameraTestData@{getCameraTestData}}
\index{getCameraTestData@{getCameraTestData}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{getCameraTestData()}{getCameraTestData()}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::get\+Camera\+Test\+Data (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&}]{original,  }\item[{\mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&}]{transformed }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Returns the interesting info about a camera test process. This includes both the original and affine-\/transformed image. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00128                                                                               \{}
\DoxyCodeLine{00129     original    = m\_original;}
\DoxyCodeLine{00130     transformed = m\_cameraTestTransformed;}
\DoxyCodeLine{00131   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_abe65b098da3eb470040733b76e07b86d}\label{class_cleanup_settings_model_abe65b098da3eb470040733b76e07b86d}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!getCleanupFrame@{getCleanupFrame}}
\index{getCleanupFrame@{getCleanupFrame}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{getCleanupFrame()}{getCleanupFrame()}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::get\+Cleanup\+Frame (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$\&}]{sl,  }\item[{\mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{fid }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00187                                                           \{}
\DoxyCodeLine{00188   \mbox{\hyperlink{class_t_app}{TApp}} *app = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{00189 }
\DoxyCodeLine{00190   \textcolor{keywordtype}{int} r = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{00191   \textcolor{keywordtype}{int} c = app-\/>\mbox{\hyperlink{class_t_app_a1e294e7cff300851d12a8c3d196943f6}{getCurrentColumn}}()-\/>getColumnIndex();}
\DoxyCodeLine{00192 }
\DoxyCodeLine{00193   \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh = app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet();}
\DoxyCodeLine{00194   assert(xsh);}
\DoxyCodeLine{00195 }
\DoxyCodeLine{00196   \textcolor{keyword}{const} \mbox{\hyperlink{class_t_xsh_cell}{TXshCell}} \&cell = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(r, c);}
\DoxyCodeLine{00197 }
\DoxyCodeLine{00198   fid = cell.\mbox{\hyperlink{class_t_xsh_cell_a5a1965b96c2c698d6f0fb42a80c03406}{getFrameId}}();}
\DoxyCodeLine{00199   sl  = cell.\mbox{\hyperlink{class_t_xsh_cell_a5d20229e7bcd19957b123959e58a833e}{isEmpty}}() ? 0 : cell.\mbox{\hyperlink{class_t_xsh_cell_a8898cc47eba24e59477bfba8e2511f1d}{getSimpleLevel}}();}
\DoxyCodeLine{00200 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_ae6b676700db1e01577ec407f29f78f88}\label{class_cleanup_settings_model_ae6b676700db1e01577ec407f29f78f88}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!getClnPath@{getClnPath}}
\index{getClnPath@{getClnPath}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{getClnPath()}{getClnPath()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} Cleanup\+Settings\+Model\+::get\+Cln\+Path (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$}]{sl }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

encoded output cleanup path for the specified level. Returns the {\bfseries{decoded}} path for the level\textquotesingle{}s {\itshape } 
\begin{DoxyCode}{0}
\DoxyCodeLine{00712                                                               \{}
\DoxyCodeLine{00713   \textcolor{keywordflow}{if} (!sl) \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_file_path}{TFilePath}}();}
\DoxyCodeLine{00714 }
\DoxyCodeLine{00715   \mbox{\hyperlink{class_t_file_path}{TFilePath}} clnPath(sl-\/>getScannedPath());}
\DoxyCodeLine{00716   \textcolor{keywordflow}{if} (clnPath == \mbox{\hyperlink{class_t_file_path}{TFilePath}}()) clnPath = sl-\/>\mbox{\hyperlink{class_t_xsh_simple_level_a668293d53a70cca8811db28d87011c55}{getPath}}();}
\DoxyCodeLine{00717 }
\DoxyCodeLine{00718   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{00719   \textcolor{keywordflow}{return} scene-\/>\mbox{\hyperlink{class_toonz_scene_aa2ed57dfbae7f8cf02a4abe47ed533c6}{decodeFilePath}}(clnPath).withNoFrame().\mbox{\hyperlink{class_t_file_path_a1437b0e0720e9258b622f68b6858e95d}{withType}}(\textcolor{stringliteral}{"{}cln"{}});}
\DoxyCodeLine{00720 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l01231}{Toonz\+Scene\+::decode\+File\+Path()}}, \mbox{\hyperlink{l00106}{TApp\+::get\+Current\+Scene()}}, \mbox{\hyperlink{l00120}{TXsh\+Simple\+Level\+::get\+Path()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, and \mbox{\hyperlink{l00774}{TFile\+Path\+::with\+Type()}}.



Referenced by \mbox{\hyperlink{l00702}{prompt\+Load()}}, and \mbox{\hyperlink{l00692}{prompt\+Save()}}.

\mbox{\Hypertarget{class_cleanup_settings_model_af2a3e27103283f01a830ecdf06168e42}\label{class_cleanup_settings_model_af2a3e27103283f01a830ecdf06168e42}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!getCurrentParameters@{getCurrentParameters}}
\index{getCurrentParameters@{getCurrentParameters}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{getCurrentParameters()}{getCurrentParameters()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_cleanup_parameters}{Cleanup\+Parameters}} $\ast$ Cleanup\+Settings\+Model\+::get\+Current\+Parameters (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00179                                                               \{}
\DoxyCodeLine{00180   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{00181   \textcolor{keywordflow}{return} scene ? scene-\/>\mbox{\hyperlink{class_toonz_scene_a8ef96fedc17d7def810ac419b0939254}{getProperties}}()-\/>\mbox{\hyperlink{class_t_scene_properties_a84e6735bb0b0ea5054b9592c9612aff9}{getCleanupParameters}}() : 0;}
\DoxyCodeLine{00182 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_af745293ce297fb8b8cad81250bb9aa5f}\label{class_cleanup_settings_model_af745293ce297fb8b8cad81250bb9aa5f}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!getInputPath@{getInputPath}}
\index{getInputPath@{getInputPath}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{getInputPath()}{getInputPath()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} Cleanup\+Settings\+Model\+::get\+Input\+Path (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$}]{sl }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Returns the {\bfseries{encoded}} input cleanup 
\begin{DoxyCode}{0}
\DoxyCodeLine{00724                                                                 \{}
\DoxyCodeLine{00725   \textcolor{keyword}{const} \mbox{\hyperlink{class_t_file_path}{TFilePath}} \&scannedPath = sl-\/>getScannedPath();}
\DoxyCodeLine{00726   \textcolor{keywordflow}{return} scannedPath.isEmpty() ? sl-\/>\mbox{\hyperlink{class_t_xsh_simple_level_a668293d53a70cca8811db28d87011c55}{getPath}}() : scannedPath;}
\DoxyCodeLine{00727 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00120}{TXsh\+Simple\+Level\+::get\+Path()}}.



Referenced by \mbox{\hyperlink{l00731}{get\+Output\+Path()}}.

\mbox{\Hypertarget{class_cleanup_settings_model_ac824b1d0e864f6218d53b362a0d0f3f5}\label{class_cleanup_settings_model_ac824b1d0e864f6218d53b362a0d0f3f5}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!getOutputPath@{getOutputPath}}
\index{getOutputPath@{getOutputPath}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{getOutputPath()}{getOutputPath()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} Cleanup\+Settings\+Model\+::get\+Output\+Path (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$}]{sl,  }\item[{const \mbox{\hyperlink{class_cleanup_parameters}{Cleanup\+Parameters}} $\ast$}]{params }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

path for the specified level. Returns the {\bfseries{}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{00732                                                                                \{}
\DoxyCodeLine{00733   \textcolor{keyword}{const} \mbox{\hyperlink{class_t_file_path}{TFilePath}} \&inPath = \mbox{\hyperlink{class_cleanup_settings_model_af745293ce297fb8b8cad81250bb9aa5f}{getInputPath}}(sl);  \textcolor{comment}{// Used just to get level name}}
\DoxyCodeLine{00734 }
\DoxyCodeLine{00735   \textcolor{keywordflow}{if} (inPath.isEmpty() || !params) \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_file_path}{TFilePath}}();}
\DoxyCodeLine{00736 }
\DoxyCodeLine{00737   \textcolor{keywordtype}{bool} lineProcessing = (params-\/>m\_lineProcessingMode != lpNone);}
\DoxyCodeLine{00738   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene   = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{00739 }
\DoxyCodeLine{00740   \textcolor{comment}{// Check if the cleaned up level already exists}}
\DoxyCodeLine{00741   \textcolor{keyword}{const} \mbox{\hyperlink{class_t_file_path}{TFilePath}} \&outDir = params-\/>getPath(scene);}
\DoxyCodeLine{00742 }
\DoxyCodeLine{00743   \textcolor{keywordflow}{return} lineProcessing ? (outDir + inPath.getWideName()).withType(\textcolor{stringliteral}{"{}tlv"{}})}
\DoxyCodeLine{00744                         : (outDir + inPath.getLevelNameW())}
\DoxyCodeLine{00745                               .withType(params-\/>m\_lpNoneFormat);}
\DoxyCodeLine{00746 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00106}{TApp\+::get\+Current\+Scene()}}, \mbox{\hyperlink{l00724}{get\+Input\+Path()}}, and \mbox{\hyperlink{l00215}{TApp\+::instance()}}.

\mbox{\Hypertarget{class_cleanup_settings_model_a6d8825724b5f3153f2b9318250a5ba38}\label{class_cleanup_settings_model_a6d8825724b5f3153f2b9318250a5ba38}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!getPreviewData@{getPreviewData}}
\index{getPreviewData@{getPreviewData}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{getPreviewData()}{getPreviewData()}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::get\+Preview\+Data (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&}]{original,  }\item[{\mbox{\hyperlink{class_t_raster_image_p}{TRaster\+ImageP}} \&}]{transformed,  }\item[{\mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{transform }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Returns the interesting info about a cleanup preview process. Specifically, we have both the original and affine-\/transformed images, and the applied transform. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00119                                           \{}
\DoxyCodeLine{00120     original    = m\_original;}
\DoxyCodeLine{00121     transformed = m\_previewTransformed;}
\DoxyCodeLine{00122     transform   = m\_transform;}
\DoxyCodeLine{00123   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_a13b56ba8eabf7f7c1498f66f6443ac36}\label{class_cleanup_settings_model_a13b56ba8eabf7f7c1498f66f6443ac36}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!instance@{instance}}
\index{instance@{instance}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{instance()}{instance()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_cleanup_settings_model}{Cleanup\+Settings\+Model}} $\ast$ Cleanup\+Settings\+Model\+::instance (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00172                                                      \{}
\DoxyCodeLine{00173   \textcolor{keyword}{static} \mbox{\hyperlink{class_cleanup_settings_model}{CleanupSettingsModel}} theInstance;}
\DoxyCodeLine{00174   \textcolor{keywordflow}{return} \&theInstance;}
\DoxyCodeLine{00175 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_aa49e33b0914593ab81e717463b1373a9}\label{class_cleanup_settings_model_aa49e33b0914593ab81e717463b1373a9}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!loadSettings@{loadSettings}}
\index{loadSettings@{loadSettings}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{loadSettings()}{loadSettings()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily bool Cleanup\+Settings\+Model\+::load\+Settings (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_cleanup_parameters}{Cleanup\+Parameters}} $\ast$}]{params,  }\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{cln\+Path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00629                                                                   \{}
\DoxyCodeLine{00630   assert(params);}
\DoxyCodeLine{00631   \textcolor{keywordflow}{if} (clnPath.isEmpty() || !TSystem::doesExistFileOrLevel(clnPath))}
\DoxyCodeLine{00632     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00633 }
\DoxyCodeLine{00634   \mbox{\hyperlink{class_t_i_stream}{TIStream}} *is = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_i_stream}{TIStream}}(clnPath);}
\DoxyCodeLine{00635 }
\DoxyCodeLine{00636   \mbox{\hyperlink{class_cleanup_parameters}{CleanupParameters}} defaultParameters;}
\DoxyCodeLine{00637   params-\/>assign(\&defaultParameters);}
\DoxyCodeLine{00638 }
\DoxyCodeLine{00639   std::string tagName;}
\DoxyCodeLine{00640   is-\/>\mbox{\hyperlink{class_t_i_stream_a5fe7ddb5560e39e0ab4ff57d24926d41}{matchTag}}(tagName);}
\DoxyCodeLine{00641   \textcolor{keywordflow}{if} (tagName == \textcolor{stringliteral}{"{}version"{}}) \{}
\DoxyCodeLine{00642     \textcolor{keywordtype}{int} minor, major;}
\DoxyCodeLine{00643     *is >> major >> minor;}
\DoxyCodeLine{00644 }
\DoxyCodeLine{00645     is-\/>\mbox{\hyperlink{class_t_i_stream_a84110f30d5adcc50d6000e9c99cd4708}{matchEndTag}}();}
\DoxyCodeLine{00646     is-\/>\mbox{\hyperlink{class_t_i_stream_ab793d0eaa6881bc7126babc39b93f5d9}{setVersion}}(VersionNumber(major, minor));}
\DoxyCodeLine{00647   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00648     \textcolor{keyword}{delete} is;}
\DoxyCodeLine{00649     is = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_i_stream}{TIStream}}(clnPath);}
\DoxyCodeLine{00650   \}}
\DoxyCodeLine{00651 }
\DoxyCodeLine{00652   params-\/>loadData(*is, \textcolor{keyword}{false});}
\DoxyCodeLine{00653   \textcolor{keyword}{delete} is;}
\DoxyCodeLine{00654 }
\DoxyCodeLine{00655   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00656 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_a7188206526532919018ae9da8ebd1e16}\label{class_cleanup_settings_model_a7188206526532919018ae9da8ebd1e16}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!loadSettings@{loadSettings}}
\index{loadSettings@{loadSettings}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{loadSettings()}{loadSettings()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily bool Cleanup\+Settings\+Model\+::load\+Settings (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{cln\+Path }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00660                                                                 \{}
\DoxyCodeLine{00661   \mbox{\hyperlink{class_cleanup_parameters}{CleanupParameters}} *cp = getCurrentParameters();}
\DoxyCodeLine{00662   \textcolor{keywordflow}{if} (!loadSettings(cp, clnPath)) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00663 }
\DoxyCodeLine{00664   \textcolor{comment}{// The same as restoreGlobalSettings()}}
\DoxyCodeLine{00665   \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()}
\DoxyCodeLine{00666       -\/>getPaletteController()}
\DoxyCodeLine{00667       -\/>getCurrentCleanupPalette()}
\DoxyCodeLine{00668       -\/>setPalette(cp-\/>m\_cleanupPalette.getPointer());}
\DoxyCodeLine{00669 }
\DoxyCodeLine{00670   \textcolor{comment}{/*-\/-\/-\/}}
\DoxyCodeLine{00671 \textcolor{comment}{   * LoadSettingsPopupからこの関数が呼ばれたとき、ロードしたパラメータをGlobal設定に格納する-\/-\/-\/*/}}
\DoxyCodeLine{00672   \textcolor{keywordflow}{if} (m\_clnPath.isEmpty()) \{}
\DoxyCodeLine{00673     \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>setDirtyFlag(}
\DoxyCodeLine{00674         \textcolor{keyword}{true});  \textcolor{comment}{// This should be moved outside... sadly not supported at the}}
\DoxyCodeLine{00675                 \textcolor{comment}{// moment...}}
\DoxyCodeLine{00676     CleanupParameters::GlobalParameters.assign(}
\DoxyCodeLine{00677         cp);  \textcolor{comment}{// The global settings are being changed}}
\DoxyCodeLine{00678   \}}
\DoxyCodeLine{00679 }
\DoxyCodeLine{00680   m\_backupParams.assign(cp, \textcolor{keyword}{false});}
\DoxyCodeLine{00681 }
\DoxyCodeLine{00682   \textcolor{keywordflow}{if} (m\_previewersCount > 0 || m\_cameraTestsCount > 0) rebuildPreview();}
\DoxyCodeLine{00683 }
\DoxyCodeLine{00684   emit \mbox{\hyperlink{class_cleanup_settings_model_a8e1ea53050b6a45679726c949bc0d95c}{modelChanged}}(\textcolor{keyword}{false});}
\DoxyCodeLine{00685   emit \mbox{\hyperlink{class_cleanup_settings_model_a1fba35f9b6bf33dcae7311c0e3cafa67}{clnLoaded}}();}
\DoxyCodeLine{00686 }
\DoxyCodeLine{00687   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00688 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_a8e1ea53050b6a45679726c949bc0d95c}\label{class_cleanup_settings_model_a8e1ea53050b6a45679726c949bc0d95c}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!modelChanged@{modelChanged}}
\index{modelChanged@{modelChanged}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{modelChanged}{modelChanged}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::model\+Changed (\begin{DoxyParamCaption}\item[{bool}]{needs\+Post\+Process }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [signal]}}

Emitted whenever the model has finished processing a cleanup settings change. This happens after an explicit commit\+Change() has been invoked from a view, or other command-\/related settings change occur. 

Referenced by \mbox{\hyperlink{l00579}{restore\+Global\+Settings()}}.

\mbox{\Hypertarget{class_cleanup_settings_model_ad78610bd7ee12050dc10c9eaf16929c9}\label{class_cleanup_settings_model_ad78610bd7ee12050dc10c9eaf16929c9}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!previewDataChanged@{previewDataChanged}}
\index{previewDataChanged@{previewDataChanged}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{previewDataChanged}{previewDataChanged}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::preview\+Data\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [signal]}}

Emitted when the data retrievable with \mbox{\hyperlink{class_cleanup_settings_model_a6d8825724b5f3153f2b9318250a5ba38}{get\+Preview\+Data()}} and \mbox{\hyperlink{class_cleanup_settings_model_a91498127febe1394e79acfef0cbdea40}{get\+Camera\+Test\+Data()}} have been updated. \mbox{\Hypertarget{class_cleanup_settings_model_af80a228a227794221750d26a6e7bf766}\label{class_cleanup_settings_model_af80a228a227794221750d26a6e7bf766}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!promptLoad@{promptLoad}}
\index{promptLoad@{promptLoad}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{promptLoad}{promptLoad}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::prompt\+Load (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}



Prompts to load settings. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00702                                       \{}
\DoxyCodeLine{00703   \textcolor{keyword}{static} LoadSettingsPopup *loadPopup = 0;}
\DoxyCodeLine{00704   \textcolor{keywordflow}{if} (!loadPopup) loadPopup = \textcolor{keyword}{new} LoadSettingsPopup;}
\DoxyCodeLine{00705 }
\DoxyCodeLine{00706   loadPopup-\/>setPath(\mbox{\hyperlink{class_cleanup_settings_model_ae6b676700db1e01577ec407f29f78f88}{getClnPath}}(m\_sl));}
\DoxyCodeLine{00707   loadPopup-\/>exec();}
\DoxyCodeLine{00708 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00712}{get\+Cln\+Path()}}.

\mbox{\Hypertarget{class_cleanup_settings_model_a1310a7fd0caf8560aa806c30eaee53f7}\label{class_cleanup_settings_model_a1310a7fd0caf8560aa806c30eaee53f7}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!promptSave@{promptSave}}
\index{promptSave@{promptSave}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{promptSave}{promptSave}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::prompt\+Save (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}



Prompts to save current settings. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00692                                       \{}
\DoxyCodeLine{00693   \textcolor{keyword}{static} SaveSettingsPopup *savePopup = 0;}
\DoxyCodeLine{00694   \textcolor{keywordflow}{if} (!savePopup) savePopup = \textcolor{keyword}{new} SaveSettingsPopup;}
\DoxyCodeLine{00695 }
\DoxyCodeLine{00696   savePopup-\/>setPath(\mbox{\hyperlink{class_cleanup_settings_model_ae6b676700db1e01577ec407f29f78f88}{getClnPath}}(m\_sl));}
\DoxyCodeLine{00697   savePopup-\/>exec();}
\DoxyCodeLine{00698 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00712}{get\+Cln\+Path()}}.



Referenced by \mbox{\hyperlink{l00553}{save\+Settings\+If\+Needed()}}.

\mbox{\Hypertarget{class_cleanup_settings_model_a15df7abc5aaea2155743ce59c3c03b0b}\label{class_cleanup_settings_model_a15df7abc5aaea2155743ce59c3c03b0b}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!restoreGlobalSettings@{restoreGlobalSettings}}
\index{restoreGlobalSettings@{restoreGlobalSettings}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{restoreGlobalSettings}{restoreGlobalSettings}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::restore\+Global\+Settings (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}

Reloads the project\textquotesingle{}s cleanup settings (no prompts) 
\begin{DoxyCode}{0}
\DoxyCodeLine{00579                                                  \{}
\DoxyCodeLine{00580   \mbox{\hyperlink{class_cleanup_parameters}{CleanupParameters}} *currentParams = getCurrentParameters();}
\DoxyCodeLine{00581   currentParams-\/>assign(\&CleanupParameters::GlobalParameters);}
\DoxyCodeLine{00582 }
\DoxyCodeLine{00583   \textcolor{comment}{// Make sure that the current cleanup palette is set to currentParams' palette}}
\DoxyCodeLine{00584   \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()}
\DoxyCodeLine{00585       -\/>getPaletteController()}
\DoxyCodeLine{00586       -\/>getCurrentCleanupPalette()}
\DoxyCodeLine{00587       -\/>setPalette(currentParams-\/>m\_cleanupPalette.getPointer());}
\DoxyCodeLine{00588 }
\DoxyCodeLine{00589   m\_clnPath = \mbox{\hyperlink{class_t_file_path}{TFilePath}}();}
\DoxyCodeLine{00590   m\_backupParams.assign(currentParams, \textcolor{keyword}{false});}
\DoxyCodeLine{00591 }
\DoxyCodeLine{00592   \textcolor{keywordflow}{if} (m\_previewersCount > 0 || m\_cameraTestsCount > 0) rebuildPreview();}
\DoxyCodeLine{00593 }
\DoxyCodeLine{00594   emit \mbox{\hyperlink{class_cleanup_settings_model_a8e1ea53050b6a45679726c949bc0d95c}{modelChanged}}(\textcolor{keyword}{false});}
\DoxyCodeLine{00595   emit \mbox{\hyperlink{class_cleanup_settings_model_a1fba35f9b6bf33dcae7311c0e3cafa67}{clnLoaded}}();}
\DoxyCodeLine{00596 \}}

\end{DoxyCode}


References \mbox{\hyperlink{class_cleanup_settings_model_a1fba35f9b6bf33dcae7311c0e3cafa67}{cln\+Loaded()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, and \mbox{\hyperlink{class_cleanup_settings_model_a8e1ea53050b6a45679726c949bc0d95c}{model\+Changed()}}.

\mbox{\Hypertarget{class_cleanup_settings_model_a852371a260556200406f292aed420a7c}\label{class_cleanup_settings_model_a852371a260556200406f292aed420a7c}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!saveSettings@{saveSettings}}
\index{saveSettings@{saveSettings}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{saveSettings()}{saveSettings()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::save\+Settings (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_cleanup_parameters}{Cleanup\+Parameters}} $\ast$}]{params,  }\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{cln\+Path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



cln file. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00601                                                                   \{}
\DoxyCodeLine{00602   \textcolor{keywordflow}{if} (clnPath.isEmpty() || !params) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00603 }
\DoxyCodeLine{00604   \mbox{\hyperlink{class_t_o_stream}{TOStream}} os(clnPath);}
\DoxyCodeLine{00605 }
\DoxyCodeLine{00606   os.openChild(\textcolor{stringliteral}{"{}version"{}});}
\DoxyCodeLine{00607   os << 1 << 19;}
\DoxyCodeLine{00608   os.closeChild();}
\DoxyCodeLine{00609 }
\DoxyCodeLine{00610   params-\/>saveData(os);}
\DoxyCodeLine{00611   params-\/>setDirtyFlag(\textcolor{keyword}{false});}
\DoxyCodeLine{00612 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00520}{TOStream\+::close\+Child()}}, and \mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{TOStream\+::open\+Child()}}.

\mbox{\Hypertarget{class_cleanup_settings_model_a2d9db2eaaca9f1e2c6be091f81144d7d}\label{class_cleanup_settings_model_a2d9db2eaaca9f1e2c6be091f81144d7d}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!saveSettings@{saveSettings}}
\index{saveSettings@{saveSettings}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{saveSettings()}{saveSettings()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::save\+Settings (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{cln\+Path }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00616                                                                 \{}
\DoxyCodeLine{00617   saveSettings(getCurrentParameters(), clnPath);}
\DoxyCodeLine{00618 }
\DoxyCodeLine{00619   \textcolor{comment}{// Saving current settings should put the model in the same situation we}}
\DoxyCodeLine{00620   \textcolor{comment}{// have after a model is loaded (ie see loadSettings(clnPath))}}
\DoxyCodeLine{00621   m\_clnPath = clnPath;}
\DoxyCodeLine{00622 }
\DoxyCodeLine{00623   emit \mbox{\hyperlink{class_cleanup_settings_model_a1fba35f9b6bf33dcae7311c0e3cafa67}{clnLoaded}}();}
\DoxyCodeLine{00624 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_cleanup_settings_model_aa1fb1f6664d3b6a4ca4dcf9361d538af}\label{class_cleanup_settings_model_aa1fb1f6664d3b6a4ca4dcf9361d538af}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!saveSettingsIfNeeded@{saveSettingsIfNeeded}}
\index{saveSettingsIfNeeded@{saveSettingsIfNeeded}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{saveSettingsIfNeeded()}{saveSettingsIfNeeded()}}
{\footnotesize\ttfamily bool Cleanup\+Settings\+Model\+::save\+Settings\+If\+Needed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Prompts to save current settings in case they have been modified. Returns false if the user decided to keep the settings and stop (cancel) any action affecting them. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00553                                                 \{}
\DoxyCodeLine{00554   \mbox{\hyperlink{class_cleanup_parameters}{CleanupParameters}} *params = getCurrentParameters();}
\DoxyCodeLine{00555 }
\DoxyCodeLine{00556   \textcolor{keywordflow}{if} (params-\/>getDirtyFlag() \&\& !m\_clnPath.isEmpty() \&\&}
\DoxyCodeLine{00557       \mbox{\hyperlink{class_t_file_status}{TFileStatus}}(m\_clnPath).doesExist()) \{}
\DoxyCodeLine{00558     QString question(}
\DoxyCodeLine{00559         QObject::tr(\textcolor{stringliteral}{"{}The cleanup settings for the current level have been "{}}}
\DoxyCodeLine{00560                     \textcolor{stringliteral}{"{}modified...\(\backslash\)n\(\backslash\)nDo you want to save your changes?"{}}));}
\DoxyCodeLine{00561 }
\DoxyCodeLine{00562     \textcolor{keywordtype}{int} ret = DVGui::MsgBox(question, QObject::tr(\textcolor{stringliteral}{"{}Save"{}}),}
\DoxyCodeLine{00563                             QObject::tr(\textcolor{stringliteral}{"{}Discard"{}}), QObject::tr(\textcolor{stringliteral}{"{}Cancel"{}}), 0);}
\DoxyCodeLine{00564     \textcolor{keywordflow}{if} (ret == 1) \{}
\DoxyCodeLine{00565       \textcolor{comment}{// WARNING: This is legacy behavior, but is it really needed? I think}}
\DoxyCodeLine{00566       \textcolor{comment}{// there should be no further}}
\DoxyCodeLine{00567       \textcolor{comment}{// request of user interaction -\/ why invoking the popup to choose the save}}
\DoxyCodeLine{00568       \textcolor{comment}{// path?}}
\DoxyCodeLine{00569       \mbox{\hyperlink{class_cleanup_settings_model_a1310a7fd0caf8560aa806c30eaee53f7}{promptSave}}();}
\DoxyCodeLine{00570     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ret == 3)}
\DoxyCodeLine{00571       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00572   \}}
\DoxyCodeLine{00573 }
\DoxyCodeLine{00574   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00575 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00692}{prompt\+Save()}}.

\mbox{\Hypertarget{class_cleanup_settings_model_a24546176ae0de7be360eaf619213d895}\label{class_cleanup_settings_model_a24546176ae0de7be360eaf619213d895}} 
\index{CleanupSettingsModel@{CleanupSettingsModel}!setCommitMask@{setCommitMask}}
\index{setCommitMask@{setCommitMask}!CleanupSettingsModel@{CleanupSettingsModel}}
\doxysubsubsection{\texorpdfstring{setCommitMask()}{setCommitMask()}}
{\footnotesize\ttfamily void Cleanup\+Settings\+Model\+::set\+Commit\+Mask (\begin{DoxyParamCaption}\item[{Commit\+Mask}]{allowed\+Processing }\end{DoxyParamCaption})}

Specifies the model behavior upon a cleanup parameters change commit. Once the model receives a \mbox{\hyperlink{class_cleanup_settings_model_a7b1f1768b04906a781f54d03965d7016}{commit\+Changes()}} notification, it tracks the changed parameters and decides how deep the image under cleanup focus must be re-\/processed to stick to the changes. The commit mask can be specified to force the model to limit the performed cleanup up to the specified stage. This is especially useful in case a parameter changes frequently enough that only the last of a long sequence of updates should be processed (e.\+g. when dragging a parameter slider). 
\begin{DoxyCode}{0}
\DoxyCodeLine{00284                                                                      \{}
\DoxyCodeLine{00285   m\_allowedActions = allowedProcessing;}
\DoxyCodeLine{00286   \mbox{\hyperlink{class_cleanup_settings_model_a7b1f1768b04906a781f54d03965d7016}{commitChanges}}();}
\DoxyCodeLine{00287 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00291}{commit\+Changes()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonz/cleanupsettingsmodel.\+h\item 
E\+:/opentoonz/toonz/sources/toonz/cleanupsettingsmodel.\+cpp\end{DoxyCompactItemize}
