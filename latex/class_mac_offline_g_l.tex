\hypertarget{class_mac_offline_g_l}{}\doxysection{Mac\+Offline\+GL Class Reference}
\label{class_mac_offline_g_l}\index{MacOfflineGL@{MacOfflineGL}}
Inheritance diagram for Mac\+Offline\+GL\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_mac_offline_g_l}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_mac_offline_g_l_ac00d8dcb1ec3b7ae9ba0340a1c4dcc2d}{Mac\+Offline\+GL}} (\mbox{\hyperlink{class_t_dimension_t}{TDimension}} raster\+Size, const \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOffline\+GL\+::\+Imp}} $\ast$shared=0)
\item 
void \mbox{\hyperlink{class_mac_offline_g_l_a6a88dba07db45414c049f255f88fdfb9}{create\+Context}} (\mbox{\hyperlink{class_t_dimension_t}{TDimension}} raster\+Size, const \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOffline\+GL\+::\+Imp}} $\ast$shared)
\item 
void \mbox{\hyperlink{class_mac_offline_g_l_aafc8ea61beaa67980fbc04142a03cc8a}{make\+Current}} ()
\item 
void \mbox{\hyperlink{class_mac_offline_g_l_ae813aeb6b883fa103ac6a064bed7eed2}{done\+Current}} ()
\item 
void \mbox{\hyperlink{class_mac_offline_g_l_a159aba366dcb712147b842afbb624798}{get\+Raster}} (\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}})
\item 
void \mbox{\hyperlink{class_mac_offline_g_l_ae174684a1b54484d60c1e2c8cab85d91}{save\+Current\+Context}} ()
\item 
void \mbox{\hyperlink{class_mac_offline_g_l_a378e409d3819f600f929898264f43b63}{restore\+Current\+Context}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
AGLContext \mbox{\hyperlink{class_mac_offline_g_l_a7b3ca3edd448d6d80c8b03abdb00cca9}{m\+\_\+context}}
\item 
AGLContext \mbox{\hyperlink{class_mac_offline_g_l_a0214058db22bf66ead6e6974f8b3de67}{m\+\_\+old\+Context}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_mac_offline_g_l_ac00d8dcb1ec3b7ae9ba0340a1c4dcc2d}\label{class_mac_offline_g_l_ac00d8dcb1ec3b7ae9ba0340a1c4dcc2d}} 
\index{MacOfflineGL@{MacOfflineGL}!MacOfflineGL@{MacOfflineGL}}
\index{MacOfflineGL@{MacOfflineGL}!MacOfflineGL@{MacOfflineGL}}
\doxysubsubsection{\texorpdfstring{MacOfflineGL()}{MacOfflineGL()}}
{\footnotesize\ttfamily Mac\+Offline\+GL\+::\+Mac\+Offline\+GL (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimension}}}]{raster\+Size,  }\item[{const \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOffline\+GL\+::\+Imp}} $\ast$}]{shared = {\ttfamily 0} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00041     : \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOfflineGL::Imp}}(rasterSize.lx, rasterSize.ly)}
\DoxyCodeLine{00042     , m\_context(0)}
\DoxyCodeLine{00043     , m\_oldContext(0) \{}
\DoxyCodeLine{00044   createContext(rasterSize, shared);}
\DoxyCodeLine{00045 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_mac_offline_g_l_a4093b0a48a1525480e230caca9a665e9}\label{class_mac_offline_g_l_a4093b0a48a1525480e230caca9a665e9}} 
\index{MacOfflineGL@{MacOfflineGL}!````~MacOfflineGL@{$\sim$MacOfflineGL}}
\index{````~MacOfflineGL@{$\sim$MacOfflineGL}!MacOfflineGL@{MacOfflineGL}}
\doxysubsubsection{\texorpdfstring{$\sim$MacOfflineGL()}{~MacOfflineGL()}}
{\footnotesize\ttfamily Mac\+Offline\+GL\+::$\sim$\+Mac\+Offline\+GL (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00049 \{ aglDestroyContext(m\_context); \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_mac_offline_g_l_a6a88dba07db45414c049f255f88fdfb9}\label{class_mac_offline_g_l_a6a88dba07db45414c049f255f88fdfb9}} 
\index{MacOfflineGL@{MacOfflineGL}!createContext@{createContext}}
\index{createContext@{createContext}!MacOfflineGL@{MacOfflineGL}}
\doxysubsubsection{\texorpdfstring{createContext()}{createContext()}}
{\footnotesize\ttfamily void Mac\+Offline\+GL\+::create\+Context (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_dimension_t}{TDimension}}}]{raster\+Size,  }\item[{const \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOffline\+GL\+::\+Imp}} $\ast$}]{shared }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00054                                                               \{}
\DoxyCodeLine{00055   GLint attribs[20], cnt = 0;}
\DoxyCodeLine{00056 }
\DoxyCodeLine{00057   \textcolor{comment}{// NOTE: AGL\_OFFSCREEN *must* be selected -\/ or it seems that gl surfaces are}}
\DoxyCodeLine{00058   \textcolor{comment}{// never destructed correctly!}}
\DoxyCodeLine{00059   \textcolor{comment}{// This may lead to a kernel panic!}}
\DoxyCodeLine{00060 }
\DoxyCodeLine{00061   attribs[cnt++] = AGL\_RGBA;}
\DoxyCodeLine{00062   attribs[cnt++] = GL\_TRUE;}
\DoxyCodeLine{00063   attribs[cnt++] = AGL\_PIXEL\_SIZE;}
\DoxyCodeLine{00064   attribs[cnt++] = 32;}
\DoxyCodeLine{00065   attribs[cnt++] = AGL\_BUFFER\_SIZE;}
\DoxyCodeLine{00066   attribs[cnt++] = 32;}
\DoxyCodeLine{00067   attribs[cnt++] = AGL\_STENCIL\_SIZE;}
\DoxyCodeLine{00068   attribs[cnt++] = 8;}
\DoxyCodeLine{00069   attribs[cnt++] = AGL\_DEPTH\_SIZE;}
\DoxyCodeLine{00070   attribs[cnt++] = 24;}
\DoxyCodeLine{00071   attribs[cnt++] = AGL\_OFFSCREEN;}
\DoxyCodeLine{00072   attribs[cnt++] = AGL\_ALPHA\_SIZE;}
\DoxyCodeLine{00073   attribs[cnt++] = 8;}
\DoxyCodeLine{00074   attribs[cnt]   = AGL\_NONE;}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076   AGLPixelFormat fmt = aglChoosePixelFormat(0, 0, attribs);}
\DoxyCodeLine{00077 }
\DoxyCodeLine{00078   \textcolor{keywordflow}{if} (fmt == NULL) \{}
\DoxyCodeLine{00079     GLenum err = aglGetError();}
\DoxyCodeLine{00080     std::cout << \textcolor{stringliteral}{"{}Unable to create a pixel format, AGLError =  "{}} << err}
\DoxyCodeLine{00081               << std::endl;}
\DoxyCodeLine{00082   \}}
\DoxyCodeLine{00083 }
\DoxyCodeLine{00084   m\_context = aglCreateContext(fmt, NULL);}
\DoxyCodeLine{00085   \textcolor{keywordflow}{if} (!m\_context) \{}
\DoxyCodeLine{00086     GLenum err = aglGetError();}
\DoxyCodeLine{00087     \textcolor{comment}{/*}}
\DoxyCodeLine{00088 \textcolor{comment}{    AGL\_NO\_ERROR                 0}}
\DoxyCodeLine{00089 \textcolor{comment}{    AGL\_BAD\_ATTRIBUTE        10000}}
\DoxyCodeLine{00090 \textcolor{comment}{    AGL\_BAD\_PROPERTY         10001}}
\DoxyCodeLine{00091 \textcolor{comment}{    AGL\_BAD\_PIXELFMT         10002}}
\DoxyCodeLine{00092 \textcolor{comment}{    AGL\_BAD\_RENDINFO         10003}}
\DoxyCodeLine{00093 \textcolor{comment}{    AGL\_BAD\_CONTEXT          10004}}
\DoxyCodeLine{00094 \textcolor{comment}{    AGL\_BAD\_DRAWABLE         10005}}
\DoxyCodeLine{00095 \textcolor{comment}{    AGL\_BAD\_GDEV             10006}}
\DoxyCodeLine{00096 \textcolor{comment}{    AGL\_BAD\_STATE            10007}}
\DoxyCodeLine{00097 \textcolor{comment}{    AGL\_BAD\_VALUE            10008}}
\DoxyCodeLine{00098 \textcolor{comment}{    AGL\_BAD\_MATCH            10009}}
\DoxyCodeLine{00099 \textcolor{comment}{    AGL\_BAD\_ENUM             10010}}
\DoxyCodeLine{00100 \textcolor{comment}{    AGL\_BAD\_OFFSCREEN        10011}}
\DoxyCodeLine{00101 \textcolor{comment}{    AGL\_BAD\_FULLSCREEN       10012}}
\DoxyCodeLine{00102 \textcolor{comment}{    AGL\_BAD\_WINDOW           10013}}
\DoxyCodeLine{00103 \textcolor{comment}{    AGL\_BAD\_POINTER          10014}}
\DoxyCodeLine{00104 \textcolor{comment}{    AGL\_BAD\_MODULE           10015}}
\DoxyCodeLine{00105 \textcolor{comment}{    AGL\_BAD\_ALLOC            10016}}
\DoxyCodeLine{00106 \textcolor{comment}{    AGL\_BAD\_CONNECTION       10017}}
\DoxyCodeLine{00107 \textcolor{comment}{*/}}
\DoxyCodeLine{00108     std::cout << \textcolor{stringliteral}{"{}Unable to create an OpenGL Context, AGLError = "{}} << err}
\DoxyCodeLine{00109               << std::endl;}
\DoxyCodeLine{00110   \}}
\DoxyCodeLine{00111 }
\DoxyCodeLine{00112   makeCurrent();}
\DoxyCodeLine{00113 }
\DoxyCodeLine{00114   \textcolor{comment}{// Creo il pixel buffer}}
\DoxyCodeLine{00115 }
\DoxyCodeLine{00116   GLboolean ret;}
\DoxyCodeLine{00117 }
\DoxyCodeLine{00118   AGLPbuffer pbuffer;}
\DoxyCodeLine{00119 }
\DoxyCodeLine{00120   ret = aglCreatePBuffer(rasterSize.lx, rasterSize.ly, GL\_TEXTURE\_RECTANGLE\_EXT,}
\DoxyCodeLine{00121                          GL\_RGBA, 0, \&pbuffer);}
\DoxyCodeLine{00122   \textcolor{keywordflow}{if} (!ret) \{}
\DoxyCodeLine{00123     GLenum err = aglGetError();}
\DoxyCodeLine{00124     std::cout << \textcolor{stringliteral}{"{}Unable to create a PBuffer, AGLError = "{}} << err << std::endl;}
\DoxyCodeLine{00125   \}}
\DoxyCodeLine{00126 }
\DoxyCodeLine{00127   \textcolor{comment}{// memBuffer = new GLubyte[rasterSize.lx*rasterSize.ly*4];}}
\DoxyCodeLine{00128 }
\DoxyCodeLine{00129   ret = aglSetOffScreen(m\_context, rasterSize.lx, rasterSize.ly,}
\DoxyCodeLine{00130                         rasterSize.lx * 4, memBuffer);}
\DoxyCodeLine{00131 }
\DoxyCodeLine{00132   ret = aglSetPBuffer(m\_context, pbuffer, 0, 0, 0);}
\DoxyCodeLine{00133   \textcolor{keywordflow}{if} (!ret) \{}
\DoxyCodeLine{00134     GLenum err = aglGetError();}
\DoxyCodeLine{00135     std::cout << \textcolor{stringliteral}{"{}Unable to set a PBuffer, AGLError = "{}} << err << std::endl;}
\DoxyCodeLine{00136   \}}
\DoxyCodeLine{00137 }
\DoxyCodeLine{00138   \textcolor{comment}{// Non serve piu'}}
\DoxyCodeLine{00139   aglDestroyPixelFormat(fmt);}
\DoxyCodeLine{00140 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_mac_offline_g_l_ae813aeb6b883fa103ac6a064bed7eed2}\label{class_mac_offline_g_l_ae813aeb6b883fa103ac6a064bed7eed2}} 
\index{MacOfflineGL@{MacOfflineGL}!doneCurrent@{doneCurrent}}
\index{doneCurrent@{doneCurrent}!MacOfflineGL@{MacOfflineGL}}
\doxysubsubsection{\texorpdfstring{doneCurrent()}{doneCurrent()}}
{\footnotesize\ttfamily void Mac\+Offline\+GL\+::done\+Current (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOffline\+GL\+::\+Imp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00158                                \{}
\DoxyCodeLine{00159   \textcolor{keywordflow}{if} (aglGetCurrentContext() != m\_context) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00160   aglSetCurrentContext(0);}
\DoxyCodeLine{00161 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_mac_offline_g_l_a159aba366dcb712147b842afbb624798}\label{class_mac_offline_g_l_a159aba366dcb712147b842afbb624798}} 
\index{MacOfflineGL@{MacOfflineGL}!getRaster@{getRaster}}
\index{getRaster@{getRaster}!MacOfflineGL@{MacOfflineGL}}
\doxysubsubsection{\texorpdfstring{getRaster()}{getRaster()}}
{\footnotesize\ttfamily void Mac\+Offline\+GL\+::get\+Raster (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}}}]{raster }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOffline\+GL\+::\+Imp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00178                                               \{}
\DoxyCodeLine{00179   makeCurrent();}
\DoxyCodeLine{00180   glFinish();}
\DoxyCodeLine{00181 }
\DoxyCodeLine{00182   \textcolor{keywordtype}{int} lx = raster-\/>getLx();}
\DoxyCodeLine{00183   \textcolor{keywordtype}{int} ly = raster-\/>getLy();}
\DoxyCodeLine{00184 }
\DoxyCodeLine{00185   raster-\/>lock();}
\DoxyCodeLine{00186 }
\DoxyCodeLine{00187   glReadPixels(0, 0, lx, ly, GL\_RGBA, GL\_UNSIGNED\_BYTE, raster-\/>getRawData());}
\DoxyCodeLine{00188 }
\DoxyCodeLine{00189   rightRotateBits(raster-\/>getRawData(), lx * ly);}
\DoxyCodeLine{00190 }
\DoxyCodeLine{00191   raster-\/>unlock();}
\DoxyCodeLine{00192 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_mac_offline_g_l_aafc8ea61beaa67980fbc04142a03cc8a}\label{class_mac_offline_g_l_aafc8ea61beaa67980fbc04142a03cc8a}} 
\index{MacOfflineGL@{MacOfflineGL}!makeCurrent@{makeCurrent}}
\index{makeCurrent@{makeCurrent}!MacOfflineGL@{MacOfflineGL}}
\doxysubsubsection{\texorpdfstring{makeCurrent()}{makeCurrent()}}
{\footnotesize\ttfamily void Mac\+Offline\+GL\+::make\+Current (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_offline_g_l_1_1_imp}{TOffline\+GL\+::\+Imp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00144                                \{}
\DoxyCodeLine{00145   \textcolor{keywordflow}{if} (m\_context) \{}
\DoxyCodeLine{00146     \textcolor{keywordtype}{bool} ret = aglSetCurrentContext(m\_context);}
\DoxyCodeLine{00147     \textcolor{keywordflow}{if} (ret == GL\_FALSE) \{}
\DoxyCodeLine{00148       GLenum err = aglGetError();}
\DoxyCodeLine{00149       std::cout << \textcolor{stringliteral}{"{}Unable to set current OpenGL Context, AGLError = "{}} << err}
\DoxyCodeLine{00150                 << std::endl;}
\DoxyCodeLine{00151     \}}
\DoxyCodeLine{00152   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00153     m\_oldContext = 0;}
\DoxyCodeLine{00154 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_mac_offline_g_l_a378e409d3819f600f929898264f43b63}\label{class_mac_offline_g_l_a378e409d3819f600f929898264f43b63}} 
\index{MacOfflineGL@{MacOfflineGL}!restoreCurrentContext@{restoreCurrentContext}}
\index{restoreCurrentContext@{restoreCurrentContext}!MacOfflineGL@{MacOfflineGL}}
\doxysubsubsection{\texorpdfstring{restoreCurrentContext()}{restoreCurrentContext()}}
{\footnotesize\ttfamily void Mac\+Offline\+GL\+::restore\+Current\+Context (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00171                                          \{}
\DoxyCodeLine{00172   \textcolor{keywordflow}{if} (m\_oldContext) aglSetCurrentContext(m\_oldContext);}
\DoxyCodeLine{00173   m\_oldContext = 0;}
\DoxyCodeLine{00174 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_mac_offline_g_l_ae174684a1b54484d60c1e2c8cab85d91}\label{class_mac_offline_g_l_ae174684a1b54484d60c1e2c8cab85d91}} 
\index{MacOfflineGL@{MacOfflineGL}!saveCurrentContext@{saveCurrentContext}}
\index{saveCurrentContext@{saveCurrentContext}!MacOfflineGL@{MacOfflineGL}}
\doxysubsubsection{\texorpdfstring{saveCurrentContext()}{saveCurrentContext()}}
{\footnotesize\ttfamily void Mac\+Offline\+GL\+::save\+Current\+Context (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00165                                       \{}
\DoxyCodeLine{00166   m\_oldContext = aglGetCurrentContext();}
\DoxyCodeLine{00167 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_mac_offline_g_l_a7b3ca3edd448d6d80c8b03abdb00cca9}\label{class_mac_offline_g_l_a7b3ca3edd448d6d80c8b03abdb00cca9}} 
\index{MacOfflineGL@{MacOfflineGL}!m\_context@{m\_context}}
\index{m\_context@{m\_context}!MacOfflineGL@{MacOfflineGL}}
\doxysubsubsection{\texorpdfstring{m\_context}{m\_context}}
{\footnotesize\ttfamily AGLContext Mac\+Offline\+GL\+::m\+\_\+context}

\mbox{\Hypertarget{class_mac_offline_g_l_a0214058db22bf66ead6e6974f8b3de67}\label{class_mac_offline_g_l_a0214058db22bf66ead6e6974f8b3de67}} 
\index{MacOfflineGL@{MacOfflineGL}!m\_oldContext@{m\_oldContext}}
\index{m\_oldContext@{m\_oldContext}!MacOfflineGL@{MacOfflineGL}}
\doxysubsubsection{\texorpdfstring{m\_oldContext}{m\_oldContext}}
{\footnotesize\ttfamily AGLContext Mac\+Offline\+GL\+::m\+\_\+old\+Context}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/macofflinegl.\+h\item 
E\+:/opentoonz/toonz/sources/common/tvrender/macofflinegl.\+cpp\end{DoxyCompactItemize}
