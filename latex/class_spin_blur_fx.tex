\hypertarget{class_spin_blur_fx}{}\doxysection{Spin\+Blur\+Fx Class Reference}
\label{class_spin_blur_fx}\index{SpinBlurFx@{SpinBlurFx}}
Inheritance diagram for Spin\+Blur\+Fx\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=5.000000cm]{class_spin_blur_fx}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{class_spin_blur_fx_aab3d8172c491047321e1850fc1fbef1c}{get\+Max\+Braid}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&b\+Box, double frame, const \mbox{\hyperlink{class_t_affine}{TAffine}} \&aff=\mbox{\hyperlink{class_t_affine}{TAffine}}())
\item 
void \mbox{\hyperlink{class_spin_blur_fx_ac21cafc5a3891c8fdaafcbadf206fc9a}{enlarge}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&bbox, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&requested\+Geom, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&ri, double frame)
\item 
bool \mbox{\hyperlink{class_spin_blur_fx_af3848d60185792ea93c90df320006dff}{do\+Get\+BBox}} (double frame, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&b\+Box, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
void \mbox{\hyperlink{class_spin_blur_fx_aa57c1baf100bb1a0f77c2f996b948e19}{transform}} (double frame, int port, const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect\+On\+Output, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info\+On\+Output, \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect\+On\+Input, \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info\+On\+Input) override
\item 
void \mbox{\hyperlink{class_spin_blur_fx_a0ca08e2f23b25ad9070ede38bbbd6399}{do\+Compute}} (\mbox{\hyperlink{class_t_tile}{TTile}} \&tile, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&) override
\item 
int \mbox{\hyperlink{class_spin_blur_fx_a6cd41a9761c1c16c9bd96305c73cf8da}{get\+Memory\+Requirement}} (const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&rect, double frame, const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info) override
\item 
bool \mbox{\hyperlink{class_spin_blur_fx_ad298afa69f68920a940323af20612ddf}{can\+Handle}} (const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&info, double frame) override
\item 
void \mbox{\hyperlink{class_spin_blur_fx_ae0a9d1ffa45108301b3747583711bcf8}{get\+Param\+UIs}} (\mbox{\hyperlink{class_t_param_u_i_concept}{TParam\+UIConcept}} $\ast$\&concepts, int \&length) override
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_spin_blur_fx_a212b477451cd4850661fd497b1f0c6a4}\label{class_spin_blur_fx_a212b477451cd4850661fd497b1f0c6a4}} 
\index{SpinBlurFx@{SpinBlurFx}!SpinBlurFx@{SpinBlurFx}}
\index{SpinBlurFx@{SpinBlurFx}!SpinBlurFx@{SpinBlurFx}}
\doxysubsubsection{\texorpdfstring{SpinBlurFx()}{SpinBlurFx()}}
{\footnotesize\ttfamily Spin\+Blur\+Fx\+::\+Spin\+Blur\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00018                : m\_point(\mbox{\hyperlink{class_t_point_t}{TPointD}}(0.0, 0.0)), m\_radius(0.0), m\_blur(2.0) \{}
\DoxyCodeLine{00019     m\_point-\/>getX()-\/>setMeasureName(\textcolor{stringliteral}{"{}fxLength"{}});}
\DoxyCodeLine{00020     m\_point-\/>getY()-\/>setMeasureName(\textcolor{stringliteral}{"{}fxLength"{}});}
\DoxyCodeLine{00021     m\_radius-\/>setMeasureName(\textcolor{stringliteral}{"{}fxLength"{}});}
\DoxyCodeLine{00022     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}point"{}}, m\_point);}
\DoxyCodeLine{00023     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}radius"{}}, m\_radius);}
\DoxyCodeLine{00024     bindParam(\textcolor{keyword}{this}, \textcolor{stringliteral}{"{}blur"{}}, m\_blur);}
\DoxyCodeLine{00025     \mbox{\hyperlink{class_t_fx_af0ccf8d65934ed9f7a62d3b45ee5f2b6}{addInputPort}}(\textcolor{stringliteral}{"{}Source"{}}, m\_input);}
\DoxyCodeLine{00026     m\_radius-\/>setValueRange(0, (std::numeric\_limits<double>::max)());}
\DoxyCodeLine{00027     m\_blur-\/>setValueRange(0, (std::numeric\_limits<double>::max)());}
\DoxyCodeLine{00028   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_spin_blur_fx_a8e7d8bfeaa8aaf18e425fb5779a8fd9b}\label{class_spin_blur_fx_a8e7d8bfeaa8aaf18e425fb5779a8fd9b}} 
\index{SpinBlurFx@{SpinBlurFx}!````~SpinBlurFx@{$\sim$SpinBlurFx}}
\index{````~SpinBlurFx@{$\sim$SpinBlurFx}!SpinBlurFx@{SpinBlurFx}}
\doxysubsubsection{\texorpdfstring{$\sim$SpinBlurFx()}{~SpinBlurFx()}}
{\footnotesize\ttfamily Spin\+Blur\+Fx\+::$\sim$\+Spin\+Blur\+Fx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00030 \{\};}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_spin_blur_fx_ad298afa69f68920a940323af20612ddf}\label{class_spin_blur_fx_ad298afa69f68920a940323af20612ddf}} 
\index{SpinBlurFx@{SpinBlurFx}!canHandle@{canHandle}}
\index{canHandle@{canHandle}!SpinBlurFx@{SpinBlurFx}}
\doxysubsubsection{\texorpdfstring{canHandle()}{canHandle()}}
{\footnotesize\ttfamily bool Spin\+Blur\+Fx\+::can\+Handle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info,  }\item[{double}]{frame }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00083                                                                      \{}
\DoxyCodeLine{00084     \textcolor{keywordflow}{if} (info.m\_isSwatch) \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00085 }
\DoxyCodeLine{00086     \textcolor{keywordflow}{return} m\_blur-\/>getValue(frame) == 0 ? true}
\DoxyCodeLine{00087                                         : isAlmostIsotropic(info.m\_affine);}
\DoxyCodeLine{00088   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_spin_blur_fx_a0ca08e2f23b25ad9070ede38bbbd6399}\label{class_spin_blur_fx_a0ca08e2f23b25ad9070ede38bbbd6399}} 
\index{SpinBlurFx@{SpinBlurFx}!doCompute@{doCompute}}
\index{doCompute@{doCompute}!SpinBlurFx@{SpinBlurFx}}
\doxysubsubsection{\texorpdfstring{doCompute()}{doCompute()}}
{\footnotesize\ttfamily void Spin\+Blur\+Fx\+::do\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_tile}{TTile}} \&}]{tile,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{ri }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00250                                                       \{}
\DoxyCodeLine{00251   \textcolor{keywordflow}{if} (!m\_input.isConnected()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00252 }
\DoxyCodeLine{00253   \textcolor{keywordtype}{double} scale  = sqrt(fabs(ri.\mbox{\hyperlink{class_t_render_settings_a1250181bf3fe8e05db005d5faa76b3ea}{m\_affine}}.det()));}
\DoxyCodeLine{00254   \mbox{\hyperlink{class_t_point_t}{TPointD}} point = ri.\mbox{\hyperlink{class_t_render_settings_a1250181bf3fe8e05db005d5faa76b3ea}{m\_affine}} * m\_point-\/>getValue(frame);}
\DoxyCodeLine{00255   \textcolor{keywordtype}{double} radius = m\_radius-\/>getValue(frame) * scale;}
\DoxyCodeLine{00256   \textcolor{keywordtype}{double} blur   = 0.001 * m\_blur-\/>getValue(frame) / scale;}
\DoxyCodeLine{00257 }
\DoxyCodeLine{00258   \mbox{\hyperlink{class_t_rect_t}{TRectD}} tileRect = convert(tile.getRaster()-\/>getBounds()) + tile.m\_pos;}
\DoxyCodeLine{00259 }
\DoxyCodeLine{00260   \mbox{\hyperlink{class_t_rect_t}{TRectD}} bBox;}
\DoxyCodeLine{00261   m\_input-\/>getBBox(frame, bBox, ri);}
\DoxyCodeLine{00262   \textcolor{keywordflow}{if} (bBox.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00263 }
\DoxyCodeLine{00264   \textcolor{keywordflow}{if} (bBox == TConsts::infiniteRectD) bBox = tileRect;}
\DoxyCodeLine{00265 }
\DoxyCodeLine{00266   \mbox{\hyperlink{class_spin_blur_fx_ac21cafc5a3891c8fdaafcbadf206fc9a}{enlarge}}(bBox, tileRect, ri, frame);}
\DoxyCodeLine{00267 }
\DoxyCodeLine{00268   \mbox{\hyperlink{class_t_point_t}{TPointD}} tileRectCenter = (tileRect.getP00() + tileRect.getP11()) * 0.5;}
\DoxyCodeLine{00269   point -\/= tileRectCenter;}
\DoxyCodeLine{00270 }
\DoxyCodeLine{00271   \textcolor{keywordtype}{int} rasInLx = tileRect.getLx();}
\DoxyCodeLine{00272   \textcolor{keywordtype}{int} rasInLy = tileRect.getLy();}
\DoxyCodeLine{00273 }
\DoxyCodeLine{00274   \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} raster32 = tile.getRaster();}
\DoxyCodeLine{00275   \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} raster64 = tile.getRaster();}
\DoxyCodeLine{00276 }
\DoxyCodeLine{00277   \mbox{\hyperlink{class_t_point_t}{TPoint}} offset = convert(tile.m\_pos -\/ tileRect.getP00());}
\DoxyCodeLine{00278   \mbox{\hyperlink{class_t_tile}{TTile}} tileIn;}
\DoxyCodeLine{00279   \textcolor{keywordflow}{if} (raster32) \{}
\DoxyCodeLine{00280     m\_input-\/>allocateAndCompute(tileIn, tileRect.getP00(),}
\DoxyCodeLine{00281                                 \mbox{\hyperlink{class_t_dimension_t}{TDimension}}(rasInLx, rasInLy), raster32, frame,}
\DoxyCodeLine{00282                                 ri);}
\DoxyCodeLine{00283     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} rin = tileIn.getRaster();}
\DoxyCodeLine{00284     \mbox{\hyperlink{class_t_raster_p_t}{TRaster32P}} app = raster32-\/>create(rasInLx, rasInLy);}
\DoxyCodeLine{00285     doSpinBlur<TPixel32, UCHAR, 255>(app, rin, blur, radius, point);}
\DoxyCodeLine{00286     raster32-\/>copy(app, -\/offset);}
\DoxyCodeLine{00287   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (raster64) \{}
\DoxyCodeLine{00288     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} raster64 = tile.getRaster();}
\DoxyCodeLine{00289     m\_input-\/>allocateAndCompute(tileIn, tileRect.getP00(),}
\DoxyCodeLine{00290                                 \mbox{\hyperlink{class_t_dimension_t}{TDimension}}(rasInLx, rasInLy), raster64, frame,}
\DoxyCodeLine{00291                                 ri);}
\DoxyCodeLine{00292     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} rin = tileIn.getRaster();}
\DoxyCodeLine{00293     \mbox{\hyperlink{class_t_raster_p_t}{TRaster64P}} app = raster64-\/>create(rasInLx, rasInLy);}
\DoxyCodeLine{00294     doSpinBlur<TPixel64, USHORT, 65535>(app, rin, blur, radius, point);}
\DoxyCodeLine{00295     raster64-\/>copy(app, -\/offset);}
\DoxyCodeLine{00296   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00297     \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}Brightness\&Contrast: unsupported Pixel Type"{}});}
\DoxyCodeLine{00298 }
\DoxyCodeLine{00299   \textcolor{comment}{/* TRectD rectIn = convert(tile.getRaster()-\/>getBounds()) + tile.m\_pos;}}
\DoxyCodeLine{00300 \textcolor{comment}{TPointD rectInCenter=(rectIn.getP00()+rectIn.getP11())*0.5;}}
\DoxyCodeLine{00301 \textcolor{comment}{//rectIn = rectIn.enlarge(blur);}}
\DoxyCodeLine{00302 \textcolor{comment}{int rasInLx = tround(rectIn.getLx())+1;}}
\DoxyCodeLine{00303 \textcolor{comment}{int rasInLy = tround(rectIn.getLy())+1;}}
\DoxyCodeLine{00304 \textcolor{comment}{}}
\DoxyCodeLine{00305 \textcolor{comment}{point-\/=rectInCenter;}}
\DoxyCodeLine{00306 \textcolor{comment}{}}
\DoxyCodeLine{00307 \textcolor{comment}{}}
\DoxyCodeLine{00308 \textcolor{comment}{}}
\DoxyCodeLine{00309 \textcolor{comment}{}}
\DoxyCodeLine{00310 \textcolor{comment}{}}
\DoxyCodeLine{00311 \textcolor{comment}{TRaster32P raster32 = tile.getRaster();}}
\DoxyCodeLine{00312 \textcolor{comment}{}}
\DoxyCodeLine{00313 \textcolor{comment}{}}
\DoxyCodeLine{00314 \textcolor{comment}{TTile tileIn;}}
\DoxyCodeLine{00315 \textcolor{comment}{}}
\DoxyCodeLine{00316 \textcolor{comment}{}}
\DoxyCodeLine{00317 \textcolor{comment}{if (raster32)}}
\DoxyCodeLine{00318 \textcolor{comment}{\{}}
\DoxyCodeLine{00319 \textcolor{comment}{m\_input-\/>allocateAndCompute(tileIn, rectIn.getP00(),}}
\DoxyCodeLine{00320 \textcolor{comment}{                        TDimension(rasInLx, rasInLy),}}
\DoxyCodeLine{00321 \textcolor{comment}{                        raster32, frame, ri);}}
\DoxyCodeLine{00322 \textcolor{comment}{TRaster32P rin=tileIn.getRaster();}}
\DoxyCodeLine{00323 \textcolor{comment}{doSpinBlur<TPixel32, UCHAR, 255>(raster32, rin, blur, radius, point);}}
\DoxyCodeLine{00324 \textcolor{comment}{\}}}
\DoxyCodeLine{00325 \textcolor{comment}{else}}
\DoxyCodeLine{00326 \textcolor{comment}{\{}}
\DoxyCodeLine{00327 \textcolor{comment}{TRaster64P raster64 = tile.getRaster();}}
\DoxyCodeLine{00328 \textcolor{comment}{}}
\DoxyCodeLine{00329 \textcolor{comment}{m\_input-\/>allocateAndCompute(tileIn, rectIn.getP00(),}}
\DoxyCodeLine{00330 \textcolor{comment}{                        TDimension(rasInLx, rasInLy),}}
\DoxyCodeLine{00331 \textcolor{comment}{                        raster64, frame, ri);}}
\DoxyCodeLine{00332 \textcolor{comment}{TRaster64P rin=tileIn.getRaster();}}
\DoxyCodeLine{00333 \textcolor{comment}{if (raster64)}}
\DoxyCodeLine{00334 \textcolor{comment}{doSpinBlur<TPixel64, USHORT, 65535>(raster64, rin, blur, radius, point);}}
\DoxyCodeLine{00335 \textcolor{comment}{else}}
\DoxyCodeLine{00336 \textcolor{comment}{throw TException("{}Brightness\&Contrast: unsupported Pixel Type"{});}}
\DoxyCodeLine{00337 \textcolor{comment}{\}}}
\DoxyCodeLine{00338 \textcolor{comment}{}}
\DoxyCodeLine{00339 \textcolor{comment}{}}
\DoxyCodeLine{00340 \textcolor{comment}{*/}}
\DoxyCodeLine{00341 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_spin_blur_fx_af3848d60185792ea93c90df320006dff}\label{class_spin_blur_fx_af3848d60185792ea93c90df320006dff}} 
\index{SpinBlurFx@{SpinBlurFx}!doGetBBox@{doGetBBox}}
\index{doGetBBox@{doGetBBox}!SpinBlurFx@{SpinBlurFx}}
\doxysubsubsection{\texorpdfstring{doGetBBox()}{doGetBBox()}}
{\footnotesize\ttfamily bool Spin\+Blur\+Fx\+::do\+Get\+BBox (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{b\+Box,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00064                                                        \{}
\DoxyCodeLine{00065     \textcolor{keywordflow}{if} (m\_input.isConnected()) \{}
\DoxyCodeLine{00066       m\_input-\/>doGetBBox(frame, bBox, info);}
\DoxyCodeLine{00067       bBox = bBox.enlarge(getMaxBraid(bBox, frame));}
\DoxyCodeLine{00068       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00069     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00070       bBox = \mbox{\hyperlink{class_t_rect_t}{TRectD}}();}
\DoxyCodeLine{00071       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00072     \}}
\DoxyCodeLine{00073   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_spin_blur_fx_ac21cafc5a3891c8fdaafcbadf206fc9a}\label{class_spin_blur_fx_ac21cafc5a3891c8fdaafcbadf206fc9a}} 
\index{SpinBlurFx@{SpinBlurFx}!enlarge@{enlarge}}
\index{enlarge@{enlarge}!SpinBlurFx@{SpinBlurFx}}
\doxysubsubsection{\texorpdfstring{enlarge()}{enlarge()}}
{\footnotesize\ttfamily void Spin\+Blur\+Fx\+::enlarge (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{bbox,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{requested\+Geom,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{ri,  }\item[{double}]{frame }\end{DoxyParamCaption})}

Calculates the geometry we need for this node computation, given the known input data (bbox) and the requested output (requested\+Geom). 
\begin{DoxyCode}{0}
\DoxyCodeLine{00194                                                                   \{}
\DoxyCodeLine{00195   \mbox{\hyperlink{class_t_rect_t}{TRectD}} enlargedBbox(bbox);}
\DoxyCodeLine{00196   \mbox{\hyperlink{class_t_rect_t}{TRectD}} enlargedGeom(requestedGeom);}
\DoxyCodeLine{00197   \mbox{\hyperlink{class_t_point_t}{TPointD}} originalP00(requestedGeom.getP00());}
\DoxyCodeLine{00198 }
\DoxyCodeLine{00199   \textcolor{keywordtype}{double} maxRange = getMaxBraid(enlargedBbox, frame, ri.\mbox{\hyperlink{class_t_render_settings_a1250181bf3fe8e05db005d5faa76b3ea}{m\_affine}});}
\DoxyCodeLine{00200   enlargedBbox    = enlargedBbox.enlarge(maxRange);}
\DoxyCodeLine{00201   enlargedGeom    = enlargedGeom.enlarge(maxRange);}
\DoxyCodeLine{00202 }
\DoxyCodeLine{00203   \textcolor{comment}{// We are to find out the geometry that is useful for the fx computation.}}
\DoxyCodeLine{00204   \textcolor{comment}{// There are some rules to follow:}}
\DoxyCodeLine{00205   \textcolor{comment}{//  a) First, the interesting output we can generate is bounded by both}}
\DoxyCodeLine{00206   \textcolor{comment}{//     the requestedRect and the blurred bbox (i.e. enlarged by the blur}}
\DoxyCodeLine{00207   \textcolor{comment}{//     radius).}}
\DoxyCodeLine{00208   \textcolor{comment}{//  b) Pixels contributing to any output are necessarily part of bbox -\/ and}}
\DoxyCodeLine{00209   \textcolor{comment}{//  only}}
\DoxyCodeLine{00210   \textcolor{comment}{//     those which are blurrable into the requestedRect are useful to us}}
\DoxyCodeLine{00211   \textcolor{comment}{//     (i.e. pixels contained in its enlargement by the blur radius).}}
\DoxyCodeLine{00212 }
\DoxyCodeLine{00213   requestedGeom = (enlargedGeom * bbox) + (enlargedBbox * requestedGeom);}
\DoxyCodeLine{00214 }
\DoxyCodeLine{00215   \textcolor{comment}{// Finally, make sure that the result is coherent with the original P00}}
\DoxyCodeLine{00216   requestedGeom -\/= originalP00;}
\DoxyCodeLine{00217   requestedGeom.\mbox{\hyperlink{class_t_rect_t_ac008cbc625f50d8b3c180c8eb2594cdb}{x0}} = tfloor(requestedGeom.x0);}
\DoxyCodeLine{00218   requestedGeom.y0 = tfloor(requestedGeom.y0);}
\DoxyCodeLine{00219   requestedGeom.x1 = tceil(requestedGeom.x1);}
\DoxyCodeLine{00220   requestedGeom.y1 = tceil(requestedGeom.y1);}
\DoxyCodeLine{00221   requestedGeom += originalP00;}
\DoxyCodeLine{00222 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00097}{TRender\+Settings\+::m\+\_\+affine}}, and \mbox{\hyperlink{l00557}{TRect\+T$<$ T $>$\+::x0}}.



Referenced by \mbox{\hyperlink{l00345}{get\+Memory\+Requirement()}}.

\mbox{\Hypertarget{class_spin_blur_fx_aab3d8172c491047321e1850fc1fbef1c}\label{class_spin_blur_fx_aab3d8172c491047321e1850fc1fbef1c}} 
\index{SpinBlurFx@{SpinBlurFx}!getMaxBraid@{getMaxBraid}}
\index{getMaxBraid@{getMaxBraid}!SpinBlurFx@{SpinBlurFx}}
\doxysubsubsection{\texorpdfstring{getMaxBraid()}{getMaxBraid()}}
{\footnotesize\ttfamily int Spin\+Blur\+Fx\+::get\+Max\+Braid (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{b\+Box,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_affine}{TAffine}} \&}]{aff = {\ttfamily \mbox{\hyperlink{class_t_affine}{TAffine}}()} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00033                                                   \{}
\DoxyCodeLine{00034     \textcolor{keywordtype}{double} scale  = sqrt(fabs(aff.det()));}
\DoxyCodeLine{00035     \mbox{\hyperlink{class_t_point_t}{TPointD}} point = aff * m\_point-\/>getValue(frame);}
\DoxyCodeLine{00036     \textcolor{keywordtype}{double} radius = m\_radius-\/>getValue(frame) * scale;}
\DoxyCodeLine{00037     \textcolor{keywordtype}{double} blur   = 0.001 * m\_blur-\/>getValue(frame) / scale;}
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039     \textcolor{keywordtype}{double} intensity = blur * M\_PI\_180;}
\DoxyCodeLine{00040 }
\DoxyCodeLine{00041     \mbox{\hyperlink{class_t_point_t}{TPointD}} p1  = bBox.getP00() -\/ point;}
\DoxyCodeLine{00042     \mbox{\hyperlink{class_t_point_t}{TPointD}} p2  = bBox.getP01() -\/ point;}
\DoxyCodeLine{00043     \mbox{\hyperlink{class_t_point_t}{TPointD}} p3  = bBox.getP10() -\/ point;}
\DoxyCodeLine{00044     \mbox{\hyperlink{class_t_point_t}{TPointD}} p4  = bBox.getP11() -\/ point;}
\DoxyCodeLine{00045     \textcolor{keywordtype}{double} d1   = p1.x * p1.x + p1.y * p1.y;}
\DoxyCodeLine{00046     \textcolor{keywordtype}{double} d2   = p2.x * p2.x + p2.y * p2.y;}
\DoxyCodeLine{00047     \textcolor{keywordtype}{double} d3   = p3.x * p3.x + p3.y * p3.y;}
\DoxyCodeLine{00048     \textcolor{keywordtype}{double} d4   = p4.x * p4.x + p4.y * p4.y;}
\DoxyCodeLine{00049     \textcolor{keywordtype}{double} maxD = std::max(std::max(std::max(d3, d4), d2), d1);}
\DoxyCodeLine{00050     \textcolor{keywordtype}{double} dist = sqrt(maxD);}
\DoxyCodeLine{00051     \textcolor{keywordtype}{double} blurangle;}
\DoxyCodeLine{00052     \textcolor{keywordflow}{if} (dist > radius)}
\DoxyCodeLine{00053       blurangle = intensity * ((dist -\/ radius));}
\DoxyCodeLine{00054     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00055       blurangle = 0;}
\DoxyCodeLine{00056     \textcolor{keywordflow}{if} (blurangle > M\_PI) blurangle = M\_PI;}
\DoxyCodeLine{00057     \textcolor{keywordflow}{return} tround(4 * blurangle * dist);}
\DoxyCodeLine{00058   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_spin_blur_fx_a6cd41a9761c1c16c9bd96305c73cf8da}\label{class_spin_blur_fx_a6cd41a9761c1c16c9bd96305c73cf8da}} 
\index{SpinBlurFx@{SpinBlurFx}!getMemoryRequirement@{getMemoryRequirement}}
\index{getMemoryRequirement@{getMemoryRequirement}!SpinBlurFx@{SpinBlurFx}}
\doxysubsubsection{\texorpdfstring{getMemoryRequirement()}{getMemoryRequirement()}}
{\footnotesize\ttfamily int Spin\+Blur\+Fx\+::get\+Memory\+Requirement (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect,  }\item[{double}]{frame,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Specifies the approximate size (in Mega\+Bytes) of the maximum allocation instance that this fx will need to perform in order to render the passed input. This method should be reimplemented in order to make the Toonz rendering process aware of the use of big raster memory chunks, at least. Observe that the passed tile geometry is implicitly {\itshape  already allocated \texorpdfstring{$<$}{<}\textbackslash{}i\texorpdfstring{$>$}{>} for the fx output. ~\newline
The default implementation returns 0, assuming that the passed implicit memory size is passed below in node computation without further allocation of resources. Fxs can reimplement this to -\/1 to explicitly disable the Toonz\textquotesingle{}s smart memory handling. ~\newline
 ~\newline
\begin{DoxyNote}{Note}
The rendering process ensures that the passed render settings are {\itshape handled} by the fx before this function is invoked -\/ do not waste code for it. 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRaster\+Fx\+::memory\+Size}} and TRaster\+Fx\+::can\+Handle methods. 
\end{DoxySeeAlso}
}

Reimplemented from \mbox{\hyperlink{class_t_raster_fx_af8eb991c9756f4fb2e48d9f96cbacfba}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00346                                                                   \{}
\DoxyCodeLine{00347   \textcolor{keywordtype}{double} scale  = sqrt(fabs(info.m\_affine.det()));}
\DoxyCodeLine{00348   \mbox{\hyperlink{class_t_point_t}{TPointD}} point = info.m\_affine * m\_point-\/>getValue(frame);}
\DoxyCodeLine{00349   \textcolor{keywordtype}{double} blur   = 0.001 * m\_blur-\/>getValue(frame) / scale;}
\DoxyCodeLine{00350 }
\DoxyCodeLine{00351   \mbox{\hyperlink{class_t_rect_t}{TRectD}} bBox;}
\DoxyCodeLine{00352   m\_input-\/>getBBox(frame, bBox, info);}
\DoxyCodeLine{00353   \textcolor{keywordflow}{if} (bBox.\mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{isEmpty}}()) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00354 }
\DoxyCodeLine{00355   \textcolor{keywordflow}{if} (bBox == TConsts::infiniteRectD) bBox = rect;}
\DoxyCodeLine{00356 }
\DoxyCodeLine{00357   \mbox{\hyperlink{class_t_rect_t}{TRectD}} tileRect(rect);}
\DoxyCodeLine{00358   \mbox{\hyperlink{class_spin_blur_fx_ac21cafc5a3891c8fdaafcbadf206fc9a}{enlarge}}(bBox, tileRect, info, frame);}
\DoxyCodeLine{00359 }
\DoxyCodeLine{00360   \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_raster_fx_a909a7afa779121b6caef5093da6447b0}{TRasterFx::memorySize}}(tileRect.enlarge(blur), info.m\_bpp);}
\DoxyCodeLine{00361 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00193}{enlarge()}}, \mbox{\hyperlink{class_t_rect_t_a53ce09c6112f8a019b43ad82d721a93b}{TRect\+T$<$ T $>$\+::is\+Empty()}}, and \mbox{\hyperlink{l00560}{TRaster\+Fx\+::memory\+Size()}}.

\mbox{\Hypertarget{class_spin_blur_fx_ae0a9d1ffa45108301b3747583711bcf8}\label{class_spin_blur_fx_ae0a9d1ffa45108301b3747583711bcf8}} 
\index{SpinBlurFx@{SpinBlurFx}!getParamUIs@{getParamUIs}}
\index{getParamUIs@{getParamUIs}!SpinBlurFx@{SpinBlurFx}}
\doxysubsubsection{\texorpdfstring{getParamUIs()}{getParamUIs()}}
{\footnotesize\ttfamily void Spin\+Blur\+Fx\+::get\+Param\+UIs (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_param_u_i_concept}{TParam\+UIConcept}} $\ast$\&}]{params,  }\item[{int \&}]{length }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Returns a list of User Interface Concepts to be displayed when editing the fx parameters. \begin{DoxyNote}{Note}
Ownership of the returned array allocated with new\mbox{[}\mbox{]} is passed to callers. 
\end{DoxyNote}


Reimplemented from \mbox{\hyperlink{class_t_fx_a18766b107b77772d67c5678e7d832b18}{TFx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00090                                                                      \{}
\DoxyCodeLine{00091     concepts = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_param_u_i_concept}{TParamUIConcept}}[length = 3];}
\DoxyCodeLine{00092 }
\DoxyCodeLine{00093     concepts[0].\mbox{\hyperlink{class_t_param_u_i_concept_a2dbb7c954ca5f2441a6931945cf004a5}{m\_type}}  = TParamUIConcept::POINT;}
\DoxyCodeLine{00094     concepts[0].m\_label = \textcolor{stringliteral}{"{}Center"{}};}
\DoxyCodeLine{00095     concepts[0].m\_params.push\_back(m\_point);}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097     concepts[1].m\_type  = TParamUIConcept::RADIUS;}
\DoxyCodeLine{00098     concepts[1].m\_label = \textcolor{stringliteral}{"{}Radius"{}};}
\DoxyCodeLine{00099     concepts[1].m\_params.push\_back(m\_radius);}
\DoxyCodeLine{00100     concepts[1].m\_params.push\_back(m\_point);}
\DoxyCodeLine{00101 }
\DoxyCodeLine{00102     concepts[2].m\_type = TParamUIConcept::COMPASS\_SPIN;}
\DoxyCodeLine{00103     concepts[2].m\_params.push\_back(m\_point);}
\DoxyCodeLine{00104   \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00078}{TParam\+UIConcept\+::m\+\_\+label}}, \mbox{\hyperlink{l00079}{TParam\+UIConcept\+::m\+\_\+params}}, and \mbox{\hyperlink{l00077}{TParam\+UIConcept\+::m\+\_\+type}}.

\mbox{\Hypertarget{class_spin_blur_fx_aa57c1baf100bb1a0f77c2f996b948e19}\label{class_spin_blur_fx_aa57c1baf100bb1a0f77c2f996b948e19}} 
\index{SpinBlurFx@{SpinBlurFx}!transform@{transform}}
\index{transform@{transform}!SpinBlurFx@{SpinBlurFx}}
\doxysubsubsection{\texorpdfstring{transform()}{transform()}}
{\footnotesize\ttfamily void Spin\+Blur\+Fx\+::transform (\begin{DoxyParamCaption}\item[{double}]{frame,  }\item[{int}]{port,  }\item[{const \mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect\+On\+Output,  }\item[{const \mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info\+On\+Output,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRectD}} \&}]{rect\+On\+Input,  }\item[{\mbox{\hyperlink{class_t_render_settings}{TRender\+Settings}} \&}]{info\+On\+Input }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_raster_fx}{TRaster\+Fx}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00228                                                                               \{}
\DoxyCodeLine{00229   \mbox{\hyperlink{class_t_rect_t}{TRectD}} rectOut(rectOnOutput);}
\DoxyCodeLine{00230 }
\DoxyCodeLine{00231   \textcolor{keywordflow}{if} (canHandle(infoOnOutput, frame))}
\DoxyCodeLine{00232     infoOnInput = infoOnOutput;}
\DoxyCodeLine{00233   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00234     infoOnInput          = infoOnOutput;}
\DoxyCodeLine{00235     infoOnInput.\mbox{\hyperlink{class_t_render_settings_a1250181bf3fe8e05db005d5faa76b3ea}{m\_affine}} = \mbox{\hyperlink{class_t_affine}{TAffine}}();  \textcolor{comment}{// because the affine does not commute}}
\DoxyCodeLine{00236     rectOut              = infoOnOutput.\mbox{\hyperlink{class_t_render_settings_a1250181bf3fe8e05db005d5faa76b3ea}{m\_affine}}.\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() * rectOut;}
\DoxyCodeLine{00237   \}}
\DoxyCodeLine{00238 }
\DoxyCodeLine{00239   \mbox{\hyperlink{class_t_rect_t}{TRectD}} bbox;}
\DoxyCodeLine{00240   m\_input-\/>getBBox(frame, bbox, infoOnInput);}
\DoxyCodeLine{00241   \textcolor{keywordflow}{if} (bbox == TConsts::infiniteRectD) bbox = rectOut;}
\DoxyCodeLine{00242 }
\DoxyCodeLine{00243   rectOnInput = rectOut;}
\DoxyCodeLine{00244   \mbox{\hyperlink{class_spin_blur_fx_ac21cafc5a3891c8fdaafcbadf206fc9a}{enlarge}}(bbox, rectOnInput, infoOnInput, frame);}
\DoxyCodeLine{00245 \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/stdfx/rotationalblurfx.\+cpp\end{DoxyCompactItemize}
