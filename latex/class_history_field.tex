\hypertarget{class_history_field}{}\doxysection{History\+Field Class Reference}
\label{class_history_field}\index{HistoryField@{HistoryField}}
Inheritance diagram for History\+Field\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_history_field}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_history_field_a4177c214989205aa4bae8be0947bbf64}{History\+Field}} (QScroll\+Area $\ast$parent=0, Qt\+::\+WFlags flags=0)
\item 
void \mbox{\hyperlink{class_history_field_a0505d51e483a74af2e85ad3cc1f83e06}{update\+Content\+Height}} (int minimum\+Height=-\/1)
\item 
int \mbox{\hyperlink{class_history_field_a318440bf3e719cf37216ad14e8d71aa2}{y2index}} (int y) const
\item 
int \mbox{\hyperlink{class_history_field_a5675e6ec45e0389f3132bb33f728517c}{index2y}} (int index) const
\item 
void \mbox{\hyperlink{class_history_field_afcdc69808f21f45f427db15dd2202386}{expose\+Current}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_history_field_a0958bb74223c932a697c65ddf88d2165}{paint\+Event}} (QPaint\+Event $\ast$) override
\item 
void \mbox{\hyperlink{class_history_field_a2c1bf01c497518a6c222dcd7d7c36db8}{mouse\+Press\+Event}} (QMouse\+Event $\ast$event) override
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_history_field_a4177c214989205aa4bae8be0947bbf64}\label{class_history_field_a4177c214989205aa4bae8be0947bbf64}} 
\index{HistoryField@{HistoryField}!HistoryField@{HistoryField}}
\index{HistoryField@{HistoryField}!HistoryField@{HistoryField}}
\doxysubsubsection{\texorpdfstring{HistoryField()}{HistoryField()}}
{\footnotesize\ttfamily History\+Field\+::\+History\+Field (\begin{DoxyParamCaption}\item[{QScroll\+Area $\ast$}]{parent = {\ttfamily 0},  }\item[{Qt\+::\+WFlags}]{flags = {\ttfamily 0} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00080     : QFrame(parent, flags), m\_scrollArea(parent) \{}
\DoxyCodeLine{00081   setObjectName(\textcolor{stringliteral}{"{}filmStripFrames"{}});}
\DoxyCodeLine{00082   setFrameStyle(QFrame::StyledPanel);}
\DoxyCodeLine{00083 }
\DoxyCodeLine{00084   setFocusPolicy(Qt::StrongFocus); \textcolor{comment}{/*-\/-\/ KeyboadでもTabキーでもFocusされる -\/-\/*/}}
\DoxyCodeLine{00085 }
\DoxyCodeLine{00086   setFixedHeight(parentWidget()-\/>height());}
\DoxyCodeLine{00087   setMinimumWidth(std::max(parentWidget()-\/>width(), 600));}
\DoxyCodeLine{00088 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_history_field_ad5d36932d643bac0c1a7adde450ad9d1}\label{class_history_field_ad5d36932d643bac0c1a7adde450ad9d1}} 
\index{HistoryField@{HistoryField}!````~HistoryField@{$\sim$HistoryField}}
\index{````~HistoryField@{$\sim$HistoryField}!HistoryField@{HistoryField}}
\doxysubsubsection{\texorpdfstring{$\sim$HistoryField()}{~HistoryField()}}
{\footnotesize\ttfamily History\+Field\+::$\sim$\+History\+Field (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00019 \{\};}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_history_field_afcdc69808f21f45f427db15dd2202386}\label{class_history_field_afcdc69808f21f45f427db15dd2202386}} 
\index{HistoryField@{HistoryField}!exposeCurrent@{exposeCurrent}}
\index{exposeCurrent@{exposeCurrent}!HistoryField@{HistoryField}}
\doxysubsubsection{\texorpdfstring{exposeCurrent()}{exposeCurrent()}}
{\footnotesize\ttfamily void History\+Field\+::expose\+Current (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00186                                  \{}
\DoxyCodeLine{00187   \textcolor{keywordtype}{int} currentIndex = TUndoManager::manager()-\/>getCurrentHistoryIndex();}
\DoxyCodeLine{00188 }
\DoxyCodeLine{00189   m\_scrollArea-\/>ensureVisible(0, index2y(currentIndex) + 10, 50, 10);}
\DoxyCodeLine{00190 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_history_field_a5675e6ec45e0389f3132bb33f728517c}\label{class_history_field_a5675e6ec45e0389f3132bb33f728517c}} 
\index{HistoryField@{HistoryField}!index2y@{index2y}}
\index{index2y@{index2y}!HistoryField@{HistoryField}}
\doxysubsubsection{\texorpdfstring{index2y()}{index2y()}}
{\footnotesize\ttfamily int History\+Field\+::index2y (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00157                                          \{}
\DoxyCodeLine{00158   \textcolor{keywordflow}{return} (index -\/ 1) * HISTORY\_ITEM\_HEIGHT;}
\DoxyCodeLine{00159 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_history_field_a2c1bf01c497518a6c222dcd7d7c36db8}\label{class_history_field_a2c1bf01c497518a6c222dcd7d7c36db8}} 
\index{HistoryField@{HistoryField}!mousePressEvent@{mousePressEvent}}
\index{mousePressEvent@{mousePressEvent}!HistoryField@{HistoryField}}
\doxysubsubsection{\texorpdfstring{mousePressEvent()}{mousePressEvent()}}
{\footnotesize\ttfamily void History\+Field\+::mouse\+Press\+Event (\begin{DoxyParamCaption}\item[{QMouse\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00163                                                      \{}
\DoxyCodeLine{00164   \textcolor{keywordtype}{int} index        = y2index(event-\/>pos().y());}
\DoxyCodeLine{00165   \textcolor{keywordtype}{int} historyCount = TUndoManager::manager()-\/>getHistoryCount();}
\DoxyCodeLine{00166 }
\DoxyCodeLine{00167   \textcolor{keywordflow}{if} (index > historyCount || index <= 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00168 }
\DoxyCodeLine{00169   \textcolor{keywordtype}{int} currentIndex = TUndoManager::manager()-\/>getCurrentHistoryIndex();}
\DoxyCodeLine{00170 }
\DoxyCodeLine{00171   \textcolor{keywordflow}{if} (index == currentIndex) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00172 }
\DoxyCodeLine{00173   \textcolor{keywordflow}{if} (index < currentIndex)  \textcolor{comment}{// undo}}
\DoxyCodeLine{00174   \{}
\DoxyCodeLine{00175     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (currentIndex -\/ index); i++)}
\DoxyCodeLine{00176       TUndoManager::manager()-\/>undo();}
\DoxyCodeLine{00177   \} \textcolor{keywordflow}{else}  \textcolor{comment}{// redo}}
\DoxyCodeLine{00178   \{}
\DoxyCodeLine{00179     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (index -\/ currentIndex); i++)}
\DoxyCodeLine{00180       TUndoManager::manager()-\/>redo();}
\DoxyCodeLine{00181   \}}
\DoxyCodeLine{00182 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_history_field_a0958bb74223c932a697c65ddf88d2165}\label{class_history_field_a0958bb74223c932a697c65ddf88d2165}} 
\index{HistoryField@{HistoryField}!paintEvent@{paintEvent}}
\index{paintEvent@{paintEvent}!HistoryField@{HistoryField}}
\doxysubsubsection{\texorpdfstring{paintEvent()}{paintEvent()}}
{\footnotesize\ttfamily void History\+Field\+::paint\+Event (\begin{DoxyParamCaption}\item[{QPaint\+Event $\ast$}]{evt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00104                                               \{}
\DoxyCodeLine{00105   QPainter p(\textcolor{keyword}{this});}
\DoxyCodeLine{00106 }
\DoxyCodeLine{00107   QRect clipRect = evt-\/>rect();}
\DoxyCodeLine{00108 }
\DoxyCodeLine{00109   \textcolor{keywordtype}{int} i0 = y2index(clipRect.top());}
\DoxyCodeLine{00110   \textcolor{keywordtype}{int} i1 = y2index(clipRect.bottom());}
\DoxyCodeLine{00111 }
\DoxyCodeLine{00112   \textcolor{keywordtype}{int} currentHistoryIndex = TUndoManager::manager()-\/>getCurrentHistoryIndex();}
\DoxyCodeLine{00113   \textcolor{keywordtype}{int} currentHistoryCount = TUndoManager::manager()-\/>getHistoryCount();}
\DoxyCodeLine{00114 }
\DoxyCodeLine{00115   QRect undoChipRect(0, 0, width(), HISTORY\_ITEM\_HEIGHT);}
\DoxyCodeLine{00116   QRect undoIconRect(7, 2, 17, 17);}
\DoxyCodeLine{00117 }
\DoxyCodeLine{00118   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = i0; i <= i1; i++) \{}
\DoxyCodeLine{00119     \textcolor{keywordflow}{if} (0 <= i \&\& i <= currentHistoryCount) \{}
\DoxyCodeLine{00120       QRect tmpRect = undoChipRect.translated(0, HISTORY\_ITEM\_HEIGHT * (i -\/ 1));}
\DoxyCodeLine{00121 }
\DoxyCodeLine{00122       \textcolor{keywordtype}{bool} isCurrent = (i == currentHistoryIndex);}
\DoxyCodeLine{00123       \textcolor{keywordtype}{bool} isFuture  = (i > currentHistoryIndex);}
\DoxyCodeLine{00124 }
\DoxyCodeLine{00125       p.setPen(QColor(64, 64, 64));}
\DoxyCodeLine{00126       p.setBrush((isFuture) ? QColor(150, 150, 150) : QColor(192, 192, 192));}
\DoxyCodeLine{00127       \textcolor{keywordflow}{if} (isCurrent) p.setBrush(QColor(0, 0, 128));}
\DoxyCodeLine{00128       p.drawRect(tmpRect);}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130       \textcolor{comment}{// draw text}}
\DoxyCodeLine{00131       QFont fon = p.font();}
\DoxyCodeLine{00132       fon.setItalic(isFuture);}
\DoxyCodeLine{00133       p.setFont(fon);}
\DoxyCodeLine{00134 }
\DoxyCodeLine{00135       p.setPen((isFuture) ? QColor(64, 64, 64) : Qt::black);}
\DoxyCodeLine{00136       \textcolor{keywordflow}{if} (isCurrent) p.setPen(Qt::white);}
\DoxyCodeLine{00137 }
\DoxyCodeLine{00138       tmpRect.adjust(30, 0, 0, 0);}
\DoxyCodeLine{00139 }
\DoxyCodeLine{00140       \mbox{\hyperlink{class_t_undo}{TUndo}} *tmpUndo = TUndoManager::manager()-\/>getUndoItem(i);}
\DoxyCodeLine{00141       p.drawText(tmpRect, Qt::AlignLeft | Qt::AlignVCenter,}
\DoxyCodeLine{00142                  tmpUndo-\/>getHistoryString());}
\DoxyCodeLine{00143 }
\DoxyCodeLine{00144       QRect tmpIconRect = undoIconRect.translated(0, 20 * (i -\/ 1));}
\DoxyCodeLine{00145       p.drawPixmap(tmpIconRect, HistoryPixmapManager::instance()-\/>getHistoryPm(}
\DoxyCodeLine{00146                                     tmpUndo-\/>getHistoryType()));}
\DoxyCodeLine{00147     \}}
\DoxyCodeLine{00148   \}}
\DoxyCodeLine{00149 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_history_field_a0505d51e483a74af2e85ad3cc1f83e06}\label{class_history_field_a0505d51e483a74af2e85ad3cc1f83e06}} 
\index{HistoryField@{HistoryField}!updateContentHeight@{updateContentHeight}}
\index{updateContentHeight@{updateContentHeight}!HistoryField@{HistoryField}}
\doxysubsubsection{\texorpdfstring{updateContentHeight()}{updateContentHeight()}}
{\footnotesize\ttfamily void History\+Field\+::update\+Content\+Height (\begin{DoxyParamCaption}\item[{int}]{minimum\+Height = {\ttfamily -\/1} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00091                                                         \{}
\DoxyCodeLine{00092   \textcolor{keywordflow}{if} (minimumHeight < 0)}
\DoxyCodeLine{00093     minimumHeight = visibleRegion().boundingRect().bottom();}
\DoxyCodeLine{00094   \textcolor{keywordtype}{int} contentHeight =}
\DoxyCodeLine{00095       TUndoManager::manager()-\/>getHistoryCount() * HISTORY\_ITEM\_HEIGHT;}
\DoxyCodeLine{00096   \textcolor{keywordflow}{if} (contentHeight < minimumHeight) contentHeight = minimumHeight;}
\DoxyCodeLine{00097   \textcolor{keywordtype}{int} parentHeight                                 = parentWidget()-\/>height();}
\DoxyCodeLine{00098   \textcolor{keywordflow}{if} (contentHeight < parentHeight) contentHeight  = parentHeight;}
\DoxyCodeLine{00099   \textcolor{keywordflow}{if} (contentHeight != height()) setFixedHeight(contentHeight);}
\DoxyCodeLine{00100 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_history_field_a318440bf3e719cf37216ad14e8d71aa2}\label{class_history_field_a318440bf3e719cf37216ad14e8d71aa2}} 
\index{HistoryField@{HistoryField}!y2index@{y2index}}
\index{y2index@{y2index}!HistoryField@{HistoryField}}
\doxysubsubsection{\texorpdfstring{y2index()}{y2index()}}
{\footnotesize\ttfamily int History\+Field\+::y2index (\begin{DoxyParamCaption}\item[{int}]{y }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00153 \{ \textcolor{keywordflow}{return} y / HISTORY\_ITEM\_HEIGHT + 1; \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonz/historypane.\+h\item 
E\+:/opentoonz/toonz/sources/toonz/historypane.\+cpp\end{DoxyCompactItemize}
