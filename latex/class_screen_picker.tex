\hypertarget{class_screen_picker}{}\doxysection{Screen\+Picker Class Reference}
\label{class_screen_picker}\index{ScreenPicker@{ScreenPicker}}
Inheritance diagram for Screen\+Picker\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_screen_picker}
\end{center}
\end{figure}
\doxysubsection*{Public Slots}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_screen_picker_a837079bc97fb66f42ce328204a991efe}{start\+Grab}} ()
\item 
void \mbox{\hyperlink{class_screen_picker_adb3973f74dbf7a8e016f7c1202212f63}{pick}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_screen_picker_a576a47cf74824f8f4a05241865f4988d}{Screen\+Picker}} (QWidget $\ast$parent=0)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_screen_picker_a6d160da85d800ff44647a7d5c8f3492b}{event}} (QWidget $\ast$widget, QEvent $\ast$e) override
\begin{DoxyCompactList}\small\item\em Generic event handler for drawings. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_screen_picker_ab86707e879622774ed75491c34bf9353}{mouse\+Press\+Event}} (QWidget $\ast$widget, QMouse\+Event $\ast$me)
\item 
void \mbox{\hyperlink{class_screen_picker_aead60290d06eefed5872db2dc4aa4aa8}{mouse\+Move\+Event}} (QWidget $\ast$widget, QMouse\+Event $\ast$me)
\item 
void \mbox{\hyperlink{class_screen_picker_a6e75fb952560df0b6da75ca5feed5f45}{mouse\+Release\+Event}} (QWidget $\ast$widget, QMouse\+Event $\ast$me)
\item 
void \mbox{\hyperlink{class_screen_picker_a311c565a08423441a3ec83454a5f2302}{paint\+Event}} (QWidget $\ast$widget, QPaint\+Event $\ast$pe) override
\item 
bool \mbox{\hyperlink{class_screen_picker_a067c34c02941d305d875f4389ad95fbc}{accept\+Screen\+Events}} (const QRect \&screen\+Rect) const override
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_screen_picker_a576a47cf74824f8f4a05241865f4988d}\label{class_screen_picker_a576a47cf74824f8f4a05241865f4988d}} 
\index{ScreenPicker@{ScreenPicker}!ScreenPicker@{ScreenPicker}}
\index{ScreenPicker@{ScreenPicker}!ScreenPicker@{ScreenPicker}}
\doxysubsubsection{\texorpdfstring{ScreenPicker()}{ScreenPicker()}}
{\footnotesize\ttfamily Screen\+Picker\+::\+Screen\+Picker (\begin{DoxyParamCaption}\item[{QWidget $\ast$}]{parent = {\ttfamily 0} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00027     : m\_mousePressed(\textcolor{keyword}{false}), m\_mouseGrabbed(\textcolor{keyword}{false}) \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_screen_picker_a067c34c02941d305d875f4389ad95fbc}\label{class_screen_picker_a067c34c02941d305d875f4389ad95fbc}} 
\index{ScreenPicker@{ScreenPicker}!acceptScreenEvents@{acceptScreenEvents}}
\index{acceptScreenEvents@{acceptScreenEvents}!ScreenPicker@{ScreenPicker}}
\doxysubsubsection{\texorpdfstring{acceptScreenEvents()}{acceptScreenEvents()}}
{\footnotesize\ttfamily bool Screen\+Picker\+::accept\+Screen\+Events (\begin{DoxyParamCaption}\item[{const QRect \&}]{screen\+Rect }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Returns whether the drawing is interested in events from the passed screen geometry. Accepting a screen causes a screen widget to be allocated in order to receive events. 

Implements \mbox{\hyperlink{class_d_v_gui_1_1_screen_board_1_1_drawing_a2eb191843d7e8b7d583245a9d9648d90}{DVGui\+::\+Screen\+Board\+::\+Drawing}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00031                                                                    \{}
\DoxyCodeLine{00032   \textcolor{keywordflow}{return} screenRect.contains(QCursor::pos()) ||  \textcolor{comment}{// Accept mouse events}}
\DoxyCodeLine{00033          screenRect.intersects(m\_geometry);      \textcolor{comment}{// Accept paint events}}
\DoxyCodeLine{00034 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_screen_picker_a6d160da85d800ff44647a7d5c8f3492b}\label{class_screen_picker_a6d160da85d800ff44647a7d5c8f3492b}} 
\index{ScreenPicker@{ScreenPicker}!event@{event}}
\index{event@{event}!ScreenPicker@{ScreenPicker}}
\doxysubsubsection{\texorpdfstring{event()}{event()}}
{\footnotesize\ttfamily void Screen\+Picker\+::event (\begin{DoxyParamCaption}\item[{QWidget $\ast$}]{widget,  }\item[{QEvent $\ast$}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Generic event handler for drawings. 

Reimplement it to receive events from screen widgets other than paint events. Paint events are {\bfseries{not}} received in this handler, since they must be delivered in reverse order. 

Reimplemented from \mbox{\hyperlink{class_d_v_gui_1_1_screen_board_1_1_drawing_ac3287aa08f472dd9656935c1f0cf043a}{DVGui\+::\+Screen\+Board\+::\+Drawing}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00038                                                    \{}
\DoxyCodeLine{00039   \textcolor{keywordflow}{switch} (e-\/>type()) \{}
\DoxyCodeLine{00040   \textcolor{keywordflow}{case} QEvent::MouseButtonPress:}
\DoxyCodeLine{00041     mousePressEvent(widget, \textcolor{keyword}{static\_cast<}QMouseEvent *\textcolor{keyword}{>}(e));}
\DoxyCodeLine{00042     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00043 }
\DoxyCodeLine{00044   \textcolor{keywordflow}{case} QEvent::MouseMove:}
\DoxyCodeLine{00045     mouseMoveEvent(widget, \textcolor{keyword}{static\_cast<}QMouseEvent *\textcolor{keyword}{>}(e));}
\DoxyCodeLine{00046     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00047 }
\DoxyCodeLine{00048   \textcolor{keywordflow}{case} QEvent::MouseButtonRelease:}
\DoxyCodeLine{00049     mouseReleaseEvent(widget, \textcolor{keyword}{static\_cast<}QMouseEvent *\textcolor{keyword}{>}(e));}
\DoxyCodeLine{00050 }
\DoxyCodeLine{00051   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00052     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00053   \}}
\DoxyCodeLine{00054 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_screen_picker_aead60290d06eefed5872db2dc4aa4aa8}\label{class_screen_picker_aead60290d06eefed5872db2dc4aa4aa8}} 
\index{ScreenPicker@{ScreenPicker}!mouseMoveEvent@{mouseMoveEvent}}
\index{mouseMoveEvent@{mouseMoveEvent}!ScreenPicker@{ScreenPicker}}
\doxysubsubsection{\texorpdfstring{mouseMoveEvent()}{mouseMoveEvent()}}
{\footnotesize\ttfamily void Screen\+Picker\+::mouse\+Move\+Event (\begin{DoxyParamCaption}\item[{QWidget $\ast$}]{widget,  }\item[{QMouse\+Event $\ast$}]{me }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00068                                                                   \{}
\DoxyCodeLine{00069   \textcolor{comment}{// On fast movements, the mouse release can fire before the mouse movement}}
\DoxyCodeLine{00070   \textcolor{comment}{// assert(m\_mouseGrabbed); -\/ can cause a crash}}
\DoxyCodeLine{00071   \textcolor{keywordflow}{if} (!m\_mousePressed || !m\_mouseGrabbed) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00072 }
\DoxyCodeLine{00073   QPoint pos(widget-\/>mapToGlobal(me-\/>pos()));}
\DoxyCodeLine{00074   m\_geometry = QRect(QRect(m\_start, QSize(1, 1)) | QRect(pos, QSize(1, 1)));}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076   DVGui::ScreenBoard::instance()-\/>\mbox{\hyperlink{class_d_v_gui_1_1_screen_board_ad677f3f3be085aebc45b1ee01967bdba}{update}}();}
\DoxyCodeLine{00077 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_screen_picker_ab86707e879622774ed75491c34bf9353}\label{class_screen_picker_ab86707e879622774ed75491c34bf9353}} 
\index{ScreenPicker@{ScreenPicker}!mousePressEvent@{mousePressEvent}}
\index{mousePressEvent@{mousePressEvent}!ScreenPicker@{ScreenPicker}}
\doxysubsubsection{\texorpdfstring{mousePressEvent()}{mousePressEvent()}}
{\footnotesize\ttfamily void Screen\+Picker\+::mouse\+Press\+Event (\begin{DoxyParamCaption}\item[{QWidget $\ast$}]{widget,  }\item[{QMouse\+Event $\ast$}]{me }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00058                                                                    \{}
\DoxyCodeLine{00059   m\_mousePressed = \textcolor{keyword}{true};}
\DoxyCodeLine{00060   m\_start        = widget-\/>mapToGlobal(me-\/>pos());}
\DoxyCodeLine{00061 }
\DoxyCodeLine{00062   m\_geometry = QRect(m\_start, QSize(1, 1));}
\DoxyCodeLine{00063   DVGui::ScreenBoard::instance()-\/>\mbox{\hyperlink{class_d_v_gui_1_1_screen_board_ad677f3f3be085aebc45b1ee01967bdba}{update}}();}
\DoxyCodeLine{00064 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_screen_picker_a6e75fb952560df0b6da75ca5feed5f45}\label{class_screen_picker_a6e75fb952560df0b6da75ca5feed5f45}} 
\index{ScreenPicker@{ScreenPicker}!mouseReleaseEvent@{mouseReleaseEvent}}
\index{mouseReleaseEvent@{mouseReleaseEvent}!ScreenPicker@{ScreenPicker}}
\doxysubsubsection{\texorpdfstring{mouseReleaseEvent()}{mouseReleaseEvent()}}
{\footnotesize\ttfamily void Screen\+Picker\+::mouse\+Release\+Event (\begin{DoxyParamCaption}\item[{QWidget $\ast$}]{widget,  }\item[{QMouse\+Event $\ast$}]{me }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00081                                                                      \{}
\DoxyCodeLine{00082   assert(m\_mouseGrabbed);}
\DoxyCodeLine{00083   \textcolor{keywordflow}{if} (!m\_mousePressed) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00084 }
\DoxyCodeLine{00085   m\_mouseGrabbed = m\_mousePressed = \textcolor{keyword}{false};}
\DoxyCodeLine{00086 }
\DoxyCodeLine{00087   \mbox{\hyperlink{class_d_v_gui_1_1_screen_board}{DVGui::ScreenBoard}} *screenBoard = DVGui::ScreenBoard::instance();}
\DoxyCodeLine{00088   QList<DVGui::ScreenBoard::Drawing *> \&drawings = screenBoard-\/>drawings();}
\DoxyCodeLine{00089 }
\DoxyCodeLine{00090   drawings.removeAt(drawings.indexOf(\textcolor{keyword}{this}));}
\DoxyCodeLine{00091   screenBoard-\/>\mbox{\hyperlink{class_d_v_gui_1_1_screen_board_afe2f63c4e5fa6cfa1bd46c8160ceadc1}{releaseMouse}}();}
\DoxyCodeLine{00092   screenBoard-\/>\mbox{\hyperlink{class_d_v_gui_1_1_screen_board_ad677f3f3be085aebc45b1ee01967bdba}{update}}();}
\DoxyCodeLine{00093 }
\DoxyCodeLine{00094   QPoint pos(widget-\/>mapToGlobal(me-\/>pos()));}
\DoxyCodeLine{00095   m\_geometry = QRect(QRect(m\_start, QSize(1, 1)) | QRect(pos, QSize(1, 1)));}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097   \textcolor{comment}{// TimerEvents execution is delayed until all other events have been}}
\DoxyCodeLine{00098   \textcolor{comment}{// processed.}}
\DoxyCodeLine{00099   \textcolor{comment}{// In particular, we want to pick after the screen refreshes}}
\DoxyCodeLine{00100   QTimer::singleShot(0, \textcolor{keyword}{this}, SLOT(pick()));}
\DoxyCodeLine{00101 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_screen_picker_a311c565a08423441a3ec83454a5f2302}\label{class_screen_picker_a311c565a08423441a3ec83454a5f2302}} 
\index{ScreenPicker@{ScreenPicker}!paintEvent@{paintEvent}}
\index{paintEvent@{paintEvent}!ScreenPicker@{ScreenPicker}}
\doxysubsubsection{\texorpdfstring{paintEvent()}{paintEvent()}}
{\footnotesize\ttfamily void Screen\+Picker\+::paint\+Event (\begin{DoxyParamCaption}\item[{QWidget $\ast$}]{widget,  }\item[{QPaint\+Event $\ast$}]{pe }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Paints the drawing on the specified screen widget. Use the widget\textquotesingle{}s map\+From\+Global() function to match desktop coordinates to screen coordinates. 

Implements \mbox{\hyperlink{class_d_v_gui_1_1_screen_board_1_1_drawing_aaf5809776e7dc3c77ab67cfa799018eb}{DVGui\+::\+Screen\+Board\+::\+Drawing}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00120                                                               \{}
\DoxyCodeLine{00121   \textcolor{keywordflow}{if} (!m\_mousePressed) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00122 }
\DoxyCodeLine{00123   QPainter painter(widget);}
\DoxyCodeLine{00124 }
\DoxyCodeLine{00125   QRect relativeGeom(widget-\/>mapFromGlobal(m\_geometry.topLeft()),}
\DoxyCodeLine{00126                      widget-\/>mapFromGlobal(m\_geometry.bottomRight()));}
\DoxyCodeLine{00127 }
\DoxyCodeLine{00128   painter.setPen(QColor(0, 0, 255, 128));}
\DoxyCodeLine{00129   painter.setBrush(QColor(0, 0, 255, 64));}
\DoxyCodeLine{00130   painter.drawRect(relativeGeom);}
\DoxyCodeLine{00131 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_screen_picker_adb3973f74dbf7a8e016f7c1202212f63}\label{class_screen_picker_adb3973f74dbf7a8e016f7c1202212f63}} 
\index{ScreenPicker@{ScreenPicker}!pick@{pick}}
\index{pick@{pick}!ScreenPicker@{ScreenPicker}}
\doxysubsubsection{\texorpdfstring{pick}{pick}}
{\footnotesize\ttfamily void Screen\+Picker\+::pick (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00105                         \{}
\DoxyCodeLine{00106   \textcolor{comment}{// Someway, on MACOSX 10.7 (Lion) there may be screen refresh events pending}}
\DoxyCodeLine{00107   \textcolor{comment}{// at this point.}}
\DoxyCodeLine{00108   \textcolor{comment}{// Process them before picking.}}
\DoxyCodeLine{00109   QCoreApplication::processEvents();}
\DoxyCodeLine{00110 }
\DoxyCodeLine{00111   QColor color(pickScreenRGB(m\_geometry));}
\DoxyCodeLine{00112   RGBPicker::setCurrentColorWithUndo(}
\DoxyCodeLine{00113       TPixel32(color.red(), color.green(), color.blue()));}
\DoxyCodeLine{00114 }
\DoxyCodeLine{00115   m\_geometry = QRect();}
\DoxyCodeLine{00116 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_screen_picker_a837079bc97fb66f42ce328204a991efe}\label{class_screen_picker_a837079bc97fb66f42ce328204a991efe}} 
\index{ScreenPicker@{ScreenPicker}!startGrab@{startGrab}}
\index{startGrab@{startGrab}!ScreenPicker@{ScreenPicker}}
\doxysubsubsection{\texorpdfstring{startGrab}{startGrab}}
{\footnotesize\ttfamily void Screen\+Picker\+::start\+Grab (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00135                              \{}
\DoxyCodeLine{00136   \textcolor{keywordflow}{if} (!m\_mouseGrabbed) \{}
\DoxyCodeLine{00137     m\_mouseGrabbed = \textcolor{keyword}{true};}
\DoxyCodeLine{00138 }
\DoxyCodeLine{00139     \mbox{\hyperlink{class_d_v_gui_1_1_screen_board}{DVGui::ScreenBoard}} *screenBoard = DVGui::ScreenBoard::instance();}
\DoxyCodeLine{00140 }
\DoxyCodeLine{00141     screenBoard-\/>drawings().push\_back(\textcolor{keyword}{this});}
\DoxyCodeLine{00142     screenBoard-\/>\mbox{\hyperlink{class_d_v_gui_1_1_screen_board_ad05ba9dd13fb69dafc6ba62da79e4f00}{grabMouse}}(getToolCursor(ToolCursor::PickerCursor));}
\DoxyCodeLine{00143     screenBoard-\/>\mbox{\hyperlink{class_d_v_gui_1_1_screen_board_ad677f3f3be085aebc45b1ee01967bdba}{update}}();}
\DoxyCodeLine{00144   \}}
\DoxyCodeLine{00145 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/tools/screenpicker.\+h\item 
E\+:/opentoonz/toonz/sources/tnztools/screenpicker.\+cpp\end{DoxyCompactItemize}
