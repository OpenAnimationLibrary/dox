\hypertarget{class_color_model_viewer}{}\doxysection{Color\+Model\+Viewer Class Reference}
\label{class_color_model_viewer}\index{ColorModelViewer@{ColorModelViewer}}


The \mbox{\hyperlink{class_color_model_viewer}{Color\+Model\+Viewer}} class is a flip book used to manage color model.  


Inheritance diagram for Color\+Model\+Viewer\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_color_model_viewer}
\end{center}
\end{figure}
\doxysubsection*{Signals}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_color_model_viewer_ad5bd18483fb4f2e905813e3fb12aa769}\label{class_color_model_viewer_ad5bd18483fb4f2e905813e3fb12aa769}} 
void {\bfseries ref\+Image\+Not\+Found} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_color_model_viewer_ac9395a01539fe0ca599039673d66b547}{Color\+Model\+Viewer}} (QWidget $\ast$parent=0)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Slots}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_color_model_viewer_a75c3636dd2482cf5a5f7238712a797e8}{show\+Current\+Image}} ()
\item 
void \mbox{\hyperlink{class_color_model_viewer_a7cb4c2e898f108d2327e17a85bb25772}{load\+Current\+Frame}} ()
\item 
void \mbox{\hyperlink{class_color_model_viewer_afbdf5d0068d7b7423d61d5bcc5daaae7}{remove\+Color\+Model}} ()
\item 
void \mbox{\hyperlink{class_color_model_viewer_a50acdd62634aee18e6528776653ba001}{on\+Ref\+Image\+Not\+Found}} ()
\item 
void \mbox{\hyperlink{class_color_model_viewer_adcad5be4168e72f9a2589628a403770c}{update\+Viewer}} ()
\item 
void \mbox{\hyperlink{class_color_model_viewer_aede8504e1b6f4a1be6058919d1178a79}{change\+Pick\+Type}} ()
\item 
void \mbox{\hyperlink{class_color_model_viewer_a76649fd1fe9df823e23164ffe9ad7f3f}{repick\+From\+Color\+Model}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_color_model_viewer_a4a0a3e713afe7494d64711ebb917eb9b}{drag\+Enter\+Event}} (QDrag\+Enter\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_color_model_viewer_a59cc30c7dd138060dcdb92337f43da71}{drop\+Event}} (QDrop\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_color_model_viewer_ade8eb37686b75e5650ed8a2f070c892f}{load\+Image}} (const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&fp)
\item 
void \mbox{\hyperlink{class_color_model_viewer_afe17b3649c3aa4aa107ddf6320a19704}{reset\+Image\+Viewer}} ()
\item 
void \mbox{\hyperlink{class_color_model_viewer_a250574a8c8fafa5423ae517523457746}{context\+Menu\+Event}} (QContext\+Menu\+Event $\ast$event) override
\item 
void \mbox{\hyperlink{class_color_model_viewer_aa71b691dd4cb37f0386a121347444400}{mouse\+Press\+Event}} (QMouse\+Event $\ast$) override
\item 
void \mbox{\hyperlink{class_color_model_viewer_a5f246e052fa62e4618bb8649ad8eee5f}{mouse\+Move\+Event}} (QMouse\+Event $\ast$) override
\item 
void \mbox{\hyperlink{class_color_model_viewer_ab285b6790edf8a3623b66dc56d9be80a}{pick}} (const QPoint \&p)
\item 
void \mbox{\hyperlink{class_color_model_viewer_a26a9c7d0bf9570651a92f83be350a0c7}{hide\+Event}} (QHide\+Event $\ast$e) override
\item 
void \mbox{\hyperlink{class_color_model_viewer_a1319770c15aeb6dd70c64708d4deae0c}{show\+Event}} (QShow\+Event $\ast$e) override
\item 
void \mbox{\hyperlink{class_color_model_viewer_a1b98686eb625dbeda6c1831f875544a8}{reload\+Current\+Frame}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
The \mbox{\hyperlink{class_color_model_viewer}{Color\+Model\+Viewer}} class is a flip book used to manage color model. 

\begin{DoxyVerb}         Inherits \b FlipBook.

         This object show the reference image linked to current level
\end{DoxyVerb}
 palette. 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_color_model_viewer_ac9395a01539fe0ca599039673d66b547}\label{class_color_model_viewer_ac9395a01539fe0ca599039673d66b547}} 
\index{ColorModelViewer@{ColorModelViewer}!ColorModelViewer@{ColorModelViewer}}
\index{ColorModelViewer@{ColorModelViewer}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{ColorModelViewer()}{ColorModelViewer()}}
{\footnotesize\ttfamily Color\+Model\+Viewer\+::\+Color\+Model\+Viewer (\begin{DoxyParamCaption}\item[{QWidget $\ast$}]{parent = {\ttfamily 0} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00081     : \mbox{\hyperlink{class_flip_book}{FlipBook}}(parent, QString(tr(\textcolor{stringliteral}{"{}Color Model"{}})),}
\DoxyCodeLine{00082                std::vector<int>(}
\DoxyCodeLine{00083                    \{FlipConsole::eRed,          FlipConsole::eGreen,}
\DoxyCodeLine{00084                     FlipConsole::eBlue,         FlipConsole::eMatte,}
\DoxyCodeLine{00085                     FlipConsole::eGRed,         FlipConsole::eGGreen,}
\DoxyCodeLine{00086                     FlipConsole::eGBlue,        FlipConsole::eRate,}
\DoxyCodeLine{00087                     FlipConsole::eSound,        FlipConsole::eSaveImg,}
\DoxyCodeLine{00088                     FlipConsole::eHisto,        FlipConsole::eCompare,}
\DoxyCodeLine{00089                     FlipConsole::eCustomize,    FlipConsole::eSave,}
\DoxyCodeLine{00090                     FlipConsole::eFilledRaster, FlipConsole::eDefineLoadBox,}
\DoxyCodeLine{00091                     FlipConsole::eUseLoadBox,   FlipConsole::eDefineSubCamera,}
\DoxyCodeLine{00092                     FlipConsole::eLocator,      FlipConsole::eZoomIn,}
\DoxyCodeLine{00093                     FlipConsole::eZoomOut,      FlipConsole::eFlipHorizontal,}
\DoxyCodeLine{00094                     FlipConsole::eFlipVertical, FlipConsole::eResetView\}),}
\DoxyCodeLine{00095                eDontKeepFilesOpened, \textcolor{keyword}{true})}
\DoxyCodeLine{00096     , m\_mode(0)}
\DoxyCodeLine{00097     , m\_currentRefImgPath(\mbox{\hyperlink{class_t_file_path}{TFilePath}}()) \{}
\DoxyCodeLine{00098   setObjectName(\textcolor{stringliteral}{"{}colormodel"{}});}
\DoxyCodeLine{00099 }
\DoxyCodeLine{00100   setToolCursor(m\_imageViewer, ToolCursor::PickerCursor);}
\DoxyCodeLine{00101 }
\DoxyCodeLine{00102   \textcolor{comment}{// Do not call the special procedure for flipbook closures...}}
\DoxyCodeLine{00103   disconnect(parentWidget(), SIGNAL(closeButtonPressed()), \textcolor{keyword}{this},}
\DoxyCodeLine{00104              SLOT(onCloseButtonPressed()));}
\DoxyCodeLine{00105 }
\DoxyCodeLine{00106   \textcolor{keywordtype}{bool} ret = connect(\textcolor{keyword}{this}, SIGNAL(refImageNotFound()), \textcolor{keyword}{this},}
\DoxyCodeLine{00107                      SLOT(onRefImageNotFound()), Qt::QueuedConnection);}
\DoxyCodeLine{00108   assert(ret);}
\DoxyCodeLine{00109 }
\DoxyCodeLine{00110   m\_imageViewer-\/>setMouseTracking(\textcolor{keyword}{true});}
\DoxyCodeLine{00111 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_color_model_viewer_a0ff76f1e97454767a554bcbc49e80748}\label{class_color_model_viewer_a0ff76f1e97454767a554bcbc49e80748}} 
\index{ColorModelViewer@{ColorModelViewer}!````~ColorModelViewer@{$\sim$ColorModelViewer}}
\index{````~ColorModelViewer@{$\sim$ColorModelViewer}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{$\sim$ColorModelViewer()}{~ColorModelViewer()}}
{\footnotesize\ttfamily Color\+Model\+Viewer\+::$\sim$\+Color\+Model\+Viewer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00114 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_color_model_viewer_aede8504e1b6f4a1be6058919d1178a79}\label{class_color_model_viewer_aede8504e1b6f4a1be6058919d1178a79}} 
\index{ColorModelViewer@{ColorModelViewer}!changePickType@{changePickType}}
\index{changePickType@{changePickType}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{changePickType}{changePickType}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::change\+Pick\+Type (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00400                                       \{}
\DoxyCodeLine{00401   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{00402   \textcolor{keywordflow}{if} (tool-\/>getName() == T\_StylePicker) \{}
\DoxyCodeLine{00403     \mbox{\hyperlink{class_style_picker_tool}{StylePickerTool}} *stylePickerTool = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_style_picker_tool}{StylePickerTool}} *\textcolor{keyword}{>}(tool);}
\DoxyCodeLine{00404     \textcolor{keywordflow}{if} (stylePickerTool-\/>isOrganizePaletteActive()) \{}
\DoxyCodeLine{00405       setToolCursor(m\_imageViewer, ToolCursor::PickerCursorOrganize);}
\DoxyCodeLine{00406       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00407     \}}
\DoxyCodeLine{00408   \}}
\DoxyCodeLine{00409 }
\DoxyCodeLine{00410   \mbox{\hyperlink{class_t_property_group}{TPropertyGroup}} *propGroup = tool-\/>getProperties(0);}
\DoxyCodeLine{00411   \textcolor{comment}{/*-\/ Propertyの無いツールの場合 -\/*/}}
\DoxyCodeLine{00412   \textcolor{keywordflow}{if} (!propGroup) \{}
\DoxyCodeLine{00413     m\_mode = 2;}
\DoxyCodeLine{00414     setToolCursor(m\_imageViewer, ToolCursor::PickerCursor);}
\DoxyCodeLine{00415     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00416   \}}
\DoxyCodeLine{00417 }
\DoxyCodeLine{00418   \textcolor{comment}{/*-\/ Mode: の無いツールの場合は0が返る -\/*/}}
\DoxyCodeLine{00419   \mbox{\hyperlink{class_t_property}{TProperty}} *modeProp = propGroup-\/>\mbox{\hyperlink{class_t_property_group_afb08f3145e5f77da6f163cdc9decad2f}{getProperty}}(\textcolor{stringliteral}{"{}Mode:"{}});}
\DoxyCodeLine{00420   \textcolor{keywordflow}{if} (!modeProp) \{}
\DoxyCodeLine{00421     m\_mode = 2;}
\DoxyCodeLine{00422     setToolCursor(m\_imageViewer, ToolCursor::PickerCursor);}
\DoxyCodeLine{00423     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00424   \}}
\DoxyCodeLine{00425 }
\DoxyCodeLine{00426   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00427     std::string var = modeProp-\/>getValueAsString();}
\DoxyCodeLine{00428     \textcolor{keywordflow}{if} (var == LINES) \{}
\DoxyCodeLine{00429       m\_mode = 1;}
\DoxyCodeLine{00430       setToolCursor(m\_imageViewer, ToolCursor::PickerCursorLine);}
\DoxyCodeLine{00431     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (var == AREAS) \{}
\DoxyCodeLine{00432       m\_mode = 0;}
\DoxyCodeLine{00433       setToolCursor(m\_imageViewer, ToolCursor::PickerCursorArea);}
\DoxyCodeLine{00434     \} \textcolor{keywordflow}{else}  \textcolor{comment}{// Line \& Areas}}
\DoxyCodeLine{00435     \{}
\DoxyCodeLine{00436       m\_mode = 2;}
\DoxyCodeLine{00437       setToolCursor(m\_imageViewer, ToolCursor::PickerCursor);}
\DoxyCodeLine{00438     \}}
\DoxyCodeLine{00439   \}}
\DoxyCodeLine{00440 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_color_model_viewer_a250574a8c8fafa5423ae517523457746}\label{class_color_model_viewer_a250574a8c8fafa5423ae517523457746}} 
\index{ColorModelViewer@{ColorModelViewer}!contextMenuEvent@{contextMenuEvent}}
\index{contextMenuEvent@{contextMenuEvent}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{contextMenuEvent()}{contextMenuEvent()}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::context\+Menu\+Event (\begin{DoxyParamCaption}\item[{QContext\+Menu\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}

Create and open the Right-\/click menu color model viewer. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00213                                                                 \{}
\DoxyCodeLine{00214   \textcolor{comment}{/*-\/-\/ Levelが取得できない場合はMenuを出さない -\/-\/*/}}
\DoxyCodeLine{00215   \mbox{\hyperlink{class_t_app}{TApp}} *app     = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{00216   \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *xl = app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel();}
\DoxyCodeLine{00217   \textcolor{keywordflow}{if} (!xl) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00218   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl = xl-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{00219   \textcolor{keywordflow}{if} (!sl) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00220   \mbox{\hyperlink{class_t_palette}{TPalette}} *currentPalette =}
\DoxyCodeLine{00221       app-\/>getPaletteController()-\/>getCurrentLevelPalette()-\/>getPalette();}
\DoxyCodeLine{00222   \textcolor{keywordflow}{if} (!currentPalette) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00223 }
\DoxyCodeLine{00224   QMenu menu(\textcolor{keyword}{this});}
\DoxyCodeLine{00225 }
\DoxyCodeLine{00226   menu.addAction(CommandManager::instance()-\/>getAction(MI\_LoadColorModel));}
\DoxyCodeLine{00227 }
\DoxyCodeLine{00228   QAction *\mbox{\hyperlink{class_color_model_viewer_a7cb4c2e898f108d2327e17a85bb25772}{loadCurrentFrame}} =}
\DoxyCodeLine{00229       \textcolor{keyword}{new} QAction(QString(tr(\textcolor{stringliteral}{"{}Use Current Frame"{}})), \textcolor{keyword}{this});}
\DoxyCodeLine{00230   connect(\mbox{\hyperlink{class_color_model_viewer_a7cb4c2e898f108d2327e17a85bb25772}{loadCurrentFrame}}, SIGNAL(triggered()), SLOT(\mbox{\hyperlink{class_color_model_viewer_a7cb4c2e898f108d2327e17a85bb25772}{loadCurrentFrame}}()));}
\DoxyCodeLine{00231   menu.addAction(\mbox{\hyperlink{class_color_model_viewer_a7cb4c2e898f108d2327e17a85bb25772}{loadCurrentFrame}});}
\DoxyCodeLine{00232 }
\DoxyCodeLine{00233   \textcolor{keywordflow}{if} (!m\_imageViewer-\/>\mbox{\hyperlink{class_image_viewer_af80b9641df537a1bf3b0c98f2c431420}{getImage}}()) \{}
\DoxyCodeLine{00234     menu.exec(event-\/>globalPos());}
\DoxyCodeLine{00235     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00236   \}}
\DoxyCodeLine{00237 }
\DoxyCodeLine{00238   QAction *\mbox{\hyperlink{class_color_model_viewer_afbdf5d0068d7b7423d61d5bcc5daaae7}{removeColorModel}} =}
\DoxyCodeLine{00239       \textcolor{keyword}{new} QAction(QString(tr(\textcolor{stringliteral}{"{}Remove Color Model"{}})), \textcolor{keyword}{this});}
\DoxyCodeLine{00240   connect(\mbox{\hyperlink{class_color_model_viewer_afbdf5d0068d7b7423d61d5bcc5daaae7}{removeColorModel}}, SIGNAL(triggered()), SLOT(\mbox{\hyperlink{class_color_model_viewer_afbdf5d0068d7b7423d61d5bcc5daaae7}{removeColorModel}}()));}
\DoxyCodeLine{00241   menu.addAction(\mbox{\hyperlink{class_color_model_viewer_afbdf5d0068d7b7423d61d5bcc5daaae7}{removeColorModel}});}
\DoxyCodeLine{00242 }
\DoxyCodeLine{00243   \textcolor{comment}{/* If there is at least one style with "{}picked pos"{} parameter, then enable}}
\DoxyCodeLine{00244 \textcolor{comment}{   * repick command */}}
\DoxyCodeLine{00245   \mbox{\hyperlink{class_t_raster_image_p}{TRasterImageP}} ri = m\_imageViewer-\/>\mbox{\hyperlink{class_image_viewer_af80b9641df537a1bf3b0c98f2c431420}{getImage}}();}
\DoxyCodeLine{00246   \textcolor{keywordflow}{if} (ri \&\& currentPalette-\/>hasPickedPosStyle()) \{}
\DoxyCodeLine{00247     menu.addSeparator();}
\DoxyCodeLine{00248     QAction *repickFromColorModelAct = \textcolor{keyword}{new} QAction(}
\DoxyCodeLine{00249         QString(tr(\textcolor{stringliteral}{"{}Update Colors by Using Picked Positions"{}})), \textcolor{keyword}{this});}
\DoxyCodeLine{00250     connect(repickFromColorModelAct, SIGNAL(triggered()),}
\DoxyCodeLine{00251             SLOT(repickFromColorModel()));}
\DoxyCodeLine{00252     menu.addAction(repickFromColorModelAct);}
\DoxyCodeLine{00253   \}}
\DoxyCodeLine{00254 }
\DoxyCodeLine{00255   menu.addSeparator();}
\DoxyCodeLine{00256 }
\DoxyCodeLine{00257   QString shortcut = QString::fromStdString(}
\DoxyCodeLine{00258       CommandManager::instance()-\/>getShortcutFromId(V\_ViewReset));}
\DoxyCodeLine{00259   QAction *reset = menu.addAction(tr(\textcolor{stringliteral}{"{}Reset View"{}}) + \textcolor{stringliteral}{"{}\(\backslash\)t "{}} + shortcut);}
\DoxyCodeLine{00260   connect(reset, SIGNAL(triggered()), m\_imageViewer, SLOT(resetView()));}
\DoxyCodeLine{00261 }
\DoxyCodeLine{00262   shortcut = QString::fromStdString(}
\DoxyCodeLine{00263       CommandManager::instance()-\/>getShortcutFromId(V\_ZoomFit));}
\DoxyCodeLine{00264   QAction *fit = menu.addAction(tr(\textcolor{stringliteral}{"{}Fit to Window"{}}) + \textcolor{stringliteral}{"{}\(\backslash\)t"{}} + shortcut);}
\DoxyCodeLine{00265   connect(fit, SIGNAL(triggered()), m\_imageViewer, SLOT(fitView()));}
\DoxyCodeLine{00266 }
\DoxyCodeLine{00267   menu.exec(event-\/>globalPos());}
\DoxyCodeLine{00268 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00122}{TApp\+::get\+Current\+Level()}}, \mbox{\hyperlink{l00095}{TXsh\+Level\+::get\+Simple\+Level()}}, and \mbox{\hyperlink{l00215}{TApp\+::instance()}}.

\mbox{\Hypertarget{class_color_model_viewer_a4a0a3e713afe7494d64711ebb917eb9b}\label{class_color_model_viewer_a4a0a3e713afe7494d64711ebb917eb9b}} 
\index{ColorModelViewer@{ColorModelViewer}!dragEnterEvent@{dragEnterEvent}}
\index{dragEnterEvent@{dragEnterEvent}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{dragEnterEvent()}{dragEnterEvent()}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::drag\+Enter\+Event (\begin{DoxyParamCaption}\item[{QDrag\+Enter\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}

Accept event if current palette is not empty, event data has urls and each urls type are different from \char`\"{}src\char`\"{} and \char`\"{}tpl\char`\"{} . 
\begin{DoxyCode}{0}
\DoxyCodeLine{00120                                                             \{}
\DoxyCodeLine{00121   \mbox{\hyperlink{class_t_palette}{TPalette}} *palette = getPaletteHandle()-\/>getPalette();}
\DoxyCodeLine{00122   \textcolor{keywordflow}{if} (!palette) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00123   \textcolor{keyword}{const} QMimeData *mimeData = \textcolor{keyword}{event}-\/>mimeData();}
\DoxyCodeLine{00124   \textcolor{keywordflow}{if} (!acceptResourceDrop(mimeData-\/>urls())) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00125 }
\DoxyCodeLine{00126   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} QUrl \&url : mimeData-\/>urls()) \{}
\DoxyCodeLine{00127     \mbox{\hyperlink{class_t_file_path}{TFilePath}} fp(url.toLocalFile().toStdWString());}
\DoxyCodeLine{00128     std::string type = fp.getType();}
\DoxyCodeLine{00129     \textcolor{keywordflow}{if} (type == \textcolor{stringliteral}{"{}scr"{}} || type == \textcolor{stringliteral}{"{}tpl"{}}) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00130   \}}
\DoxyCodeLine{00131   \textcolor{comment}{// Force CopyAction}}
\DoxyCodeLine{00132   \textcolor{keyword}{event}-\/>setDropAction(Qt::CopyAction);}
\DoxyCodeLine{00133   \textcolor{comment}{// For files, don't accept original proposed action in case it's a move}}
\DoxyCodeLine{00134   \textcolor{keyword}{event}-\/>accept();}
\DoxyCodeLine{00135 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00225}{TFile\+Path\+::get\+Type()}}.

\mbox{\Hypertarget{class_color_model_viewer_a59cc30c7dd138060dcdb92337f43da71}\label{class_color_model_viewer_a59cc30c7dd138060dcdb92337f43da71}} 
\index{ColorModelViewer@{ColorModelViewer}!dropEvent@{dropEvent}}
\index{dropEvent@{dropEvent}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{dropEvent()}{dropEvent()}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::drop\+Event (\begin{DoxyParamCaption}\item[{QDrop\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}

If event data has urls, convert each urls in path and set view and current palette reference image (recall \mbox{\hyperlink{class_color_model_viewer_ade8eb37686b75e5650ed8a2f070c892f}{load\+Image()}} and \mbox{\hyperlink{class_flip_book_ac70c72b88200e2821ea83f4273cb34e4}{set\+Level()}}). 
\begin{DoxyCode}{0}
\DoxyCodeLine{00141                                                   \{}
\DoxyCodeLine{00142   \textcolor{keyword}{const} QMimeData *mimeData = \textcolor{keyword}{event}-\/>mimeData();}
\DoxyCodeLine{00143   \textcolor{keywordflow}{if} (mimeData-\/>hasUrls()) \{}
\DoxyCodeLine{00144     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} QUrl \&url : mimeData-\/>urls()) \{}
\DoxyCodeLine{00145       \mbox{\hyperlink{class_t_file_path}{TFilePath}} fp(url.toLocalFile().toStdWString());}
\DoxyCodeLine{00146       \mbox{\hyperlink{class_color_model_viewer_ade8eb37686b75e5650ed8a2f070c892f}{loadImage}}(fp);}
\DoxyCodeLine{00147       \mbox{\hyperlink{class_flip_book_ac70c72b88200e2821ea83f4273cb34e4}{setLevel}}(fp);}
\DoxyCodeLine{00148     \}}
\DoxyCodeLine{00149     \textcolor{comment}{// Force CopyAction}}
\DoxyCodeLine{00150     \textcolor{keyword}{event}-\/>setDropAction(Qt::CopyAction);}
\DoxyCodeLine{00151     \textcolor{comment}{// For files, don't accept original proposed action in case it's a move}}
\DoxyCodeLine{00152     \textcolor{keyword}{event}-\/>accept();}
\DoxyCodeLine{00153   \}}
\DoxyCodeLine{00154 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00163}{load\+Image()}}, and \mbox{\hyperlink{l01024}{Flip\+Book\+::set\+Level()}}.

\mbox{\Hypertarget{class_color_model_viewer_a26a9c7d0bf9570651a92f83be350a0c7}\label{class_color_model_viewer_a26a9c7d0bf9570651a92f83be350a0c7}} 
\index{ColorModelViewer@{ColorModelViewer}!hideEvent@{hideEvent}}
\index{hideEvent@{hideEvent}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{hideEvent()}{hideEvent()}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::hide\+Event (\begin{DoxyParamCaption}\item[{QHide\+Event $\ast$}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00356                                               \{}
\DoxyCodeLine{00357   \mbox{\hyperlink{class_t_palette_handle}{TPaletteHandle}} *paletteHandle = getPaletteHandle();}
\DoxyCodeLine{00358   \mbox{\hyperlink{class_t_xsh_level_handle}{TXshLevelHandle}} *levelHandle  = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}();}
\DoxyCodeLine{00359   \mbox{\hyperlink{class_tool_handle}{ToolHandle}} *toolHandle        = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}();}
\DoxyCodeLine{00360   disconnect(paletteHandle, SIGNAL(paletteSwitched()), \textcolor{keyword}{this},}
\DoxyCodeLine{00361              SLOT(showCurrentImage()));}
\DoxyCodeLine{00362   disconnect(paletteHandle, SIGNAL(paletteChanged()), \textcolor{keyword}{this},}
\DoxyCodeLine{00363              SLOT(showCurrentImage()));}
\DoxyCodeLine{00364   disconnect(paletteHandle, SIGNAL(colorStyleChanged(\textcolor{keywordtype}{bool})), \textcolor{keyword}{this},}
\DoxyCodeLine{00365              SLOT(showCurrentImage()));}
\DoxyCodeLine{00366 }
\DoxyCodeLine{00367   disconnect(toolHandle, SIGNAL(toolSwitched()), \textcolor{keyword}{this}, SLOT(changePickType()));}
\DoxyCodeLine{00368   disconnect(toolHandle, SIGNAL(toolChanged()), \textcolor{keyword}{this}, SLOT(changePickType()));}
\DoxyCodeLine{00369 }
\DoxyCodeLine{00370   disconnect(levelHandle, SIGNAL(xshLevelViewChanged()), \textcolor{keyword}{this},}
\DoxyCodeLine{00371              SLOT(\mbox{\hyperlink{class_color_model_viewer_adcad5be4168e72f9a2589628a403770c}{updateViewer}}()));}
\DoxyCodeLine{00372 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_color_model_viewer_a7cb4c2e898f108d2327e17a85bb25772}\label{class_color_model_viewer_a7cb4c2e898f108d2327e17a85bb25772}} 
\index{ColorModelViewer@{ColorModelViewer}!loadCurrentFrame@{loadCurrentFrame}}
\index{loadCurrentFrame@{loadCurrentFrame}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{loadCurrentFrame}{loadCurrentFrame}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::load\+Current\+Frame (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}

Clone current image and set it in viewer. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00504                                         \{}
\DoxyCodeLine{00505   \mbox{\hyperlink{class_t_app}{TApp}} *app     = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{00506   \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *xl = app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel();}
\DoxyCodeLine{00507   \textcolor{keywordflow}{if} (!xl) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00508   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl = xl-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{00509   \textcolor{keywordflow}{if} (!sl) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00510   \textcolor{comment}{/*-\/ カレントフレームのFIdの取得 -\/*/}}
\DoxyCodeLine{00511   \mbox{\hyperlink{class_t_frame_id}{TFrameId}} fid;}
\DoxyCodeLine{00512   \textcolor{keywordflow}{if} (app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isEditingLevel())}
\DoxyCodeLine{00513     fid = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFid();}
\DoxyCodeLine{00514   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>isEditingScene()) \{}
\DoxyCodeLine{00515     \textcolor{keywordtype}{int} columnIndex = app-\/>\mbox{\hyperlink{class_t_app_a1e294e7cff300851d12a8c3d196943f6}{getCurrentColumn}}()-\/>getColumnIndex();}
\DoxyCodeLine{00516     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh    = app-\/>\mbox{\hyperlink{class_t_app_a13f509e753824cb0500787f68bb51a09}{getCurrentXsheet}}()-\/>getXsheet();}
\DoxyCodeLine{00517     \textcolor{keywordflow}{if} (!xsh) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00518     \mbox{\hyperlink{class_t_xsh_column}{TXshColumn}} *column = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a3e1a216c019a0ebdf73d95acac95d8d0}{getColumn}}(columnIndex);}
\DoxyCodeLine{00519     \textcolor{keywordflow}{if} (!column) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00520     \textcolor{keywordtype}{int} frame = app-\/>\mbox{\hyperlink{class_t_app_a35516f8175dab3ccdf3d6d3c3e5f59ae}{getCurrentFrame}}()-\/>getFrame();}
\DoxyCodeLine{00521     fid       = column-\/>getCellColumn()-\/>getCell(frame).getFrameId();}
\DoxyCodeLine{00522   \}}
\DoxyCodeLine{00523   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img = sl-\/>getFrame(fid, \textcolor{keyword}{true});}
\DoxyCodeLine{00524 }
\DoxyCodeLine{00525   \mbox{\hyperlink{class_t_palette}{TPalette}} *currentPalette =}
\DoxyCodeLine{00526       app-\/>getPaletteController()-\/>getCurrentLevelPalette()-\/>getPalette();}
\DoxyCodeLine{00527   \textcolor{keywordflow}{if} (!img || !currentPalette) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00528   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} refImg = img-\/>\mbox{\hyperlink{class_t_image_a3632b96b398057030a4adfe6917d2e28}{cloneImage}}();}
\DoxyCodeLine{00529   currentPalette-\/>\mbox{\hyperlink{class_t_palette_a971fd2aac3c14754d6cdcb0679cf6893}{setRefImg}}(\mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}}());}
\DoxyCodeLine{00530   \textcolor{comment}{/*-\/-\/onPaletteSwitchedでRefImagePathを見て、自分自身のパスを参照していたらUpdateのルーチンを切り替える-\/-\/*/}}
\DoxyCodeLine{00531   currentPalette-\/>\mbox{\hyperlink{class_t_palette_a3009b4c976d9458d71dca9ea176bd7e1}{setRefImgPath}}(xl-\/>\mbox{\hyperlink{class_t_xsh_level_ab8ffcf067cadf0e1c4081b54ffde249d}{getPath}}());}
\DoxyCodeLine{00532 }
\DoxyCodeLine{00533   std::vector<TFrameId> fids;}
\DoxyCodeLine{00534   fids.push\_back(fid);}
\DoxyCodeLine{00535   currentPalette-\/>\mbox{\hyperlink{class_t_palette_a807070f5c3f7033531f455f08ee489c4}{setRefLevelFids}}(fids, \textcolor{keyword}{false});}
\DoxyCodeLine{00536 }
\DoxyCodeLine{00537   m\_currentRefImgPath = xl-\/>\mbox{\hyperlink{class_t_xsh_level_ab8ffcf067cadf0e1c4081b54ffde249d}{getPath}}();}
\DoxyCodeLine{00538 }
\DoxyCodeLine{00539   m\_levels.clear();}
\DoxyCodeLine{00540 }
\DoxyCodeLine{00541   m\_levelNames.clear();}
\DoxyCodeLine{00542   m\_framesCount = 1;}
\DoxyCodeLine{00543   m\_palette     = 0;}
\DoxyCodeLine{00544   m\_lr          = \mbox{\hyperlink{class_t_level_reader_p}{TLevelReaderP}}();}
\DoxyCodeLine{00545   m\_dim         = \mbox{\hyperlink{class_t_dimension_t}{TDimension}}(0, 0);}
\DoxyCodeLine{00546   m\_loadbox     = \mbox{\hyperlink{class_t_rect_t}{TRect}}();}
\DoxyCodeLine{00547   m\_loadboxes.clear();}
\DoxyCodeLine{00548   m\_flipConsole-\/>enableProgressBar(\textcolor{keyword}{false});}
\DoxyCodeLine{00549   m\_flipConsole-\/>setProgressBarStatus(0);}
\DoxyCodeLine{00550   m\_flipConsole-\/>setFrameRange(1, 1, 1);}
\DoxyCodeLine{00551   m\_title1 = m\_viewerTitle +}
\DoxyCodeLine{00552              \textcolor{stringliteral}{"{} :: "{}} + m\_currentRefImgPath.\mbox{\hyperlink{class_t_file_path_ac17d65d827432f0fae28fed699bf4afa}{withoutParentDir}}().\mbox{\hyperlink{class_t_file_path_a12f35b225e1882372ad7e02ad7fce543}{withFrame}}(fid);}
\DoxyCodeLine{00553   m\_title = \textcolor{stringliteral}{"{}  ::  <Use Current Frame>"{}};}
\DoxyCodeLine{00554 }
\DoxyCodeLine{00555   m\_imageViewer-\/>\mbox{\hyperlink{class_image_viewer_af514a3d90ce0f99a9217874bb3ef95dc}{setImage}}(refImg);}
\DoxyCodeLine{00556 \}}

\end{DoxyCode}


References \mbox{\hyperlink{class_t_image_a3632b96b398057030a4adfe6917d2e28}{TImage\+::clone\+Image()}}, \mbox{\hyperlink{l01418}{TXsheet\+::get\+Column()}}, \mbox{\hyperlink{l00118}{TApp\+::get\+Current\+Column()}}, \mbox{\hyperlink{l00114}{TApp\+::get\+Current\+Frame()}}, \mbox{\hyperlink{l00122}{TApp\+::get\+Current\+Level()}}, \mbox{\hyperlink{l00110}{TApp\+::get\+Current\+Xsheet()}}, \mbox{\hyperlink{l00121}{TXsh\+Level\+::get\+Path()}}, \mbox{\hyperlink{l00095}{TXsh\+Level\+::get\+Simple\+Level()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, \mbox{\hyperlink{l00405}{Image\+Viewer\+::set\+Image()}}, \mbox{\hyperlink{l01019}{TPalette\+::set\+Ref\+Img()}}, \mbox{\hyperlink{l01040}{TPalette\+::set\+Ref\+Img\+Path()}}, \mbox{\hyperlink{l01028}{TPalette\+::set\+Ref\+Level\+Fids()}}, \mbox{\hyperlink{l00860}{TFile\+Path\+::with\+Frame()}}, and \mbox{\hyperlink{l00264}{TFile\+Path\+::without\+Parent\+Dir()}}.

\mbox{\Hypertarget{class_color_model_viewer_ade8eb37686b75e5650ed8a2f070c892f}\label{class_color_model_viewer_ade8eb37686b75e5650ed8a2f070c892f}} 
\index{ColorModelViewer@{ColorModelViewer}!loadImage@{loadImage}}
\index{loadImage@{loadImage}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{loadImage()}{loadImage()}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::load\+Image (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{fp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Set current palette reference image to {\bfseries{fp}} recall\+: {\bfseries{Palette\+Cmd\+::load\+Reference\+Image()}}. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00163                                                     \{}
\DoxyCodeLine{00164   \textcolor{keywordflow}{if} (fp.isEmpty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00165 }
\DoxyCodeLine{00166   \mbox{\hyperlink{class_t_palette_handle}{TPaletteHandle}} *paletteHandle = getPaletteHandle();}
\DoxyCodeLine{00167   \mbox{\hyperlink{class_t_palette}{TPalette}} *palette             = paletteHandle-\/>getPalette();}
\DoxyCodeLine{00168 }
\DoxyCodeLine{00169   \textcolor{keywordflow}{if} (!palette || palette-\/>isCleanupPalette()) \{}
\DoxyCodeLine{00170     DVGui::error(QObject::tr(\textcolor{stringliteral}{"{}Cannot load Color Model in current palette."{}}));}
\DoxyCodeLine{00171     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00172   \}}
\DoxyCodeLine{00173 }
\DoxyCodeLine{00174   \mbox{\hyperlink{struct_palette_cmd_1_1_color_model_loading_configuration}{PaletteCmd::ColorModelLoadingConfiguration}} config;}
\DoxyCodeLine{00175 }
\DoxyCodeLine{00176   \textcolor{comment}{// if the palette is locked, replace the color model's palette with the}}
\DoxyCodeLine{00177   \textcolor{comment}{// destination}}
\DoxyCodeLine{00178   \textcolor{keywordflow}{if} (palette-\/>isLocked()) \{}
\DoxyCodeLine{00179     \textcolor{comment}{// do nothing as config will use behavior = ReplaceColorModelPlt by default}}
\DoxyCodeLine{00180     \textcolor{comment}{// config.behavior = PaletteCmd::ReplaceColorModelPlt;}}
\DoxyCodeLine{00181   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00182     std::set<TFilePath> fpSet;}
\DoxyCodeLine{00183     fpSet.insert(fp);}
\DoxyCodeLine{00184     \mbox{\hyperlink{class_color_model_behavior_popup}{ColorModelBehaviorPopup}} popup(fpSet, 0);}
\DoxyCodeLine{00185     \textcolor{keywordtype}{int} ret = popup.exec();}
\DoxyCodeLine{00186     \textcolor{keywordflow}{if} (ret == QDialog::Rejected) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00187     popup.getLoadingConfiguration(config);}
\DoxyCodeLine{00188   \}}
\DoxyCodeLine{00189 }
\DoxyCodeLine{00190   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{00191 }
\DoxyCodeLine{00192   \textcolor{keywordtype}{int} isLoaded =}
\DoxyCodeLine{00193       PaletteCmd::loadReferenceImage(paletteHandle, config, fp, scene);}
\DoxyCodeLine{00194 }
\DoxyCodeLine{00195   \textcolor{keywordflow}{if} (0 != isLoaded) \{}
\DoxyCodeLine{00196     std::cout << \textcolor{stringliteral}{"{}loadReferenceImage Failed for some reason."{}} << std::endl;}
\DoxyCodeLine{00197     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00198   \}}
\DoxyCodeLine{00199 }
\DoxyCodeLine{00200   \textcolor{comment}{// no changes in the icon with replace (Keep the destination palette) option}}
\DoxyCodeLine{00201   \textcolor{keywordflow}{if} (config.behavior != PaletteCmd::ReplaceColorModelPlt) \{}
\DoxyCodeLine{00202     \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *level = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel();}
\DoxyCodeLine{00203     \textcolor{keywordflow}{if} (!level) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00204     std::vector<TFrameId> fids;}
\DoxyCodeLine{00205     level-\/>getFids(fids);}
\DoxyCodeLine{00206     invalidateIcons(level, fids);}
\DoxyCodeLine{00207   \}}
\DoxyCodeLine{00208 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00122}{TApp\+::get\+Current\+Level()}}, \mbox{\hyperlink{l00106}{TApp\+::get\+Current\+Scene()}}, and \mbox{\hyperlink{l00215}{TApp\+::instance()}}.



Referenced by \mbox{\hyperlink{l00141}{drop\+Event()}}.

\mbox{\Hypertarget{class_color_model_viewer_a5f246e052fa62e4618bb8649ad8eee5f}\label{class_color_model_viewer_a5f246e052fa62e4618bb8649ad8eee5f}} 
\index{ColorModelViewer@{ColorModelViewer}!mouseMoveEvent@{mouseMoveEvent}}
\index{mouseMoveEvent@{mouseMoveEvent}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{mouseMoveEvent()}{mouseMoveEvent()}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::mouse\+Move\+Event (\begin{DoxyParamCaption}\item[{QMouse\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}

If left button is moved recall {\bfseries{\mbox{\hyperlink{class_color_model_viewer_ab285b6790edf8a3623b66dc56d9be80a}{pick()}}}} in event pos. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00280                                                         \{}
\DoxyCodeLine{00281   \textcolor{keywordflow}{if} (event-\/>buttons() \& Qt::LeftButton) \mbox{\hyperlink{class_color_model_viewer_ab285b6790edf8a3623b66dc56d9be80a}{pick}}(event-\/>pos() * getDevPixRatio());}
\DoxyCodeLine{00282 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00287}{pick()}}.

\mbox{\Hypertarget{class_color_model_viewer_aa71b691dd4cb37f0386a121347444400}\label{class_color_model_viewer_aa71b691dd4cb37f0386a121347444400}} 
\index{ColorModelViewer@{ColorModelViewer}!mousePressEvent@{mousePressEvent}}
\index{mousePressEvent@{mousePressEvent}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{mousePressEvent()}{mousePressEvent()}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::mouse\+Press\+Event (\begin{DoxyParamCaption}\item[{QMouse\+Event $\ast$}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}

If left button is pressed recall {\bfseries{\mbox{\hyperlink{class_color_model_viewer_ab285b6790edf8a3623b66dc56d9be80a}{pick()}}}} in event pos. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00273                                                          \{}
\DoxyCodeLine{00274   \textcolor{keywordflow}{if} (event-\/>button() == Qt::LeftButton) \mbox{\hyperlink{class_color_model_viewer_ab285b6790edf8a3623b66dc56d9be80a}{pick}}(event-\/>pos() * getDevPixRatio());}
\DoxyCodeLine{00275 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00287}{pick()}}.

\mbox{\Hypertarget{class_color_model_viewer_a50acdd62634aee18e6528776653ba001}\label{class_color_model_viewer_a50acdd62634aee18e6528776653ba001}} 
\index{ColorModelViewer@{ColorModelViewer}!onRefImageNotFound@{onRefImageNotFound}}
\index{onRefImageNotFound@{onRefImageNotFound}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{onRefImageNotFound}{onRefImageNotFound}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::on\+Ref\+Image\+Not\+Found (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00620                                           \{}
\DoxyCodeLine{00621   DVGui::info(}
\DoxyCodeLine{00622       tr(\textcolor{stringliteral}{"{}It is not possible to retrieve the color model set for the current "{}}}
\DoxyCodeLine{00623          \textcolor{stringliteral}{"{}level."{}}));}
\DoxyCodeLine{00624 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_color_model_viewer_ab285b6790edf8a3623b66dc56d9be80a}\label{class_color_model_viewer_ab285b6790edf8a3623b66dc56d9be80a}} 
\index{ColorModelViewer@{ColorModelViewer}!pick@{pick}}
\index{pick@{pick}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{pick()}{pick()}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::pick (\begin{DoxyParamCaption}\item[{const QPoint \&}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Pick color from image and set it as current style. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00287                                            \{}
\DoxyCodeLine{00288   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img = m\_imageViewer-\/>\mbox{\hyperlink{class_image_viewer_af80b9641df537a1bf3b0c98f2c431420}{getImage}}();}
\DoxyCodeLine{00289   \textcolor{keywordflow}{if} (!img) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00290 }
\DoxyCodeLine{00291   \mbox{\hyperlink{class_t_palette_handle}{TPaletteHandle}} *ph =}
\DoxyCodeLine{00292       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getPaletteController()-\/>getCurrentLevelPalette();}
\DoxyCodeLine{00293   \mbox{\hyperlink{class_t_palette}{TPalette}} *currentPalette = ph-\/>getPalette();}
\DoxyCodeLine{00294   \textcolor{keywordflow}{if} (!currentPalette) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00295 }
\DoxyCodeLine{00296   \textcolor{comment}{/*-\/ 画面外ではPickできない -\/*/}}
\DoxyCodeLine{00297   \textcolor{keywordflow}{if} (!m\_imageViewer-\/>rect().contains(p)) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00298 }
\DoxyCodeLine{00299   \mbox{\hyperlink{class_style_picker}{StylePicker}} picker(img, currentPalette);}
\DoxyCodeLine{00300 }
\DoxyCodeLine{00301   QPoint viewP = m\_imageViewer-\/>mapFrom(\textcolor{keyword}{this}, p);}
\DoxyCodeLine{00302   \mbox{\hyperlink{class_t_point_t}{TPointD}} pos  = m\_imageViewer-\/>\mbox{\hyperlink{class_image_viewer_ad3ae5a695b9e5ec53364d657d6f51e07}{getViewAff}}().\mbox{\hyperlink{class_t_affine_a570529b96b1ec5abc711aaa9aac09ff9}{inv}}() *}
\DoxyCodeLine{00303                 \mbox{\hyperlink{class_t_point_t}{TPointD}}(viewP.x() -\/ m\_imageViewer-\/>width() / 2,}
\DoxyCodeLine{00304                         -\/viewP.y() + m\_imageViewer-\/>height() / 2);}
\DoxyCodeLine{00305 }
\DoxyCodeLine{00306   \textcolor{keywordtype}{double} scale2 = m\_imageViewer-\/>\mbox{\hyperlink{class_image_viewer_ad3ae5a695b9e5ec53364d657d6f51e07}{getViewAff}}().det();}
\DoxyCodeLine{00307   \textcolor{comment}{/*-\/-\/-\/}}
\DoxyCodeLine{00308 \textcolor{comment}{          カレントToolに合わせてPickモードを変更}}
\DoxyCodeLine{00309 \textcolor{comment}{          0=Area, 1=Line, 2=Line\&Areas(default)}}
\DoxyCodeLine{00310 \textcolor{comment}{  -\/-\/-\/*/}}
\DoxyCodeLine{00311   \textcolor{keywordtype}{int} styleIndex =}
\DoxyCodeLine{00312       picker.pickStyleId(pos + \mbox{\hyperlink{class_t_point_t}{TPointD}}(-\/0.5, -\/0.5), 1, scale2, m\_mode);}
\DoxyCodeLine{00313 }
\DoxyCodeLine{00314   \textcolor{keywordflow}{if} (styleIndex < 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00315 }
\DoxyCodeLine{00316   \textcolor{comment}{/*-\/-\/ pickLineモードのとき、取得Styleが0の場合 /}}
\DoxyCodeLine{00317 \textcolor{comment}{   * PurePaintの部分をクリックした場合 はカレントStyleを変えない -\/-\/*/}}
\DoxyCodeLine{00318   \textcolor{keywordflow}{if} (m\_mode == 1) \{}
\DoxyCodeLine{00319     \textcolor{keywordflow}{if} (styleIndex == 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00320     \mbox{\hyperlink{class_t_toonz_image_p}{TToonzImageP}} ti = img;}
\DoxyCodeLine{00321     \textcolor{keywordflow}{if} (ti \&\& picker.pickTone(pos) == 255) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00322   \}}
\DoxyCodeLine{00323   \textcolor{comment}{/*-\/ Paletteに存在しない色が取れた場合はreturn -\/*/}}
\DoxyCodeLine{00324   \mbox{\hyperlink{class_t_palette_1_1_page}{TPalette::Page}} *page = currentPalette-\/>\mbox{\hyperlink{class_t_palette_ae8566a5ffa9e69be120003ad4b69078d}{getStylePage}}(styleIndex);}
\DoxyCodeLine{00325   \textcolor{keywordflow}{if} (!page) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00326 }
\DoxyCodeLine{00327   \textcolor{comment}{/*-\/-\/ Styleを選択している場合は選択を解除する -\/-\/*/}}
\DoxyCodeLine{00328   \mbox{\hyperlink{class_t_selection}{TSelection}} *selection =}
\DoxyCodeLine{00329       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_a6e0ee1978807a89009571ed5ce44323b}{getCurrentSelection}}()-\/>getSelection();}
\DoxyCodeLine{00330   \textcolor{keywordflow}{if} (selection) \{}
\DoxyCodeLine{00331     \mbox{\hyperlink{class_t_style_selection}{TStyleSelection}} *styleSelection =}
\DoxyCodeLine{00332         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_t_style_selection}{TStyleSelection}} *\textcolor{keyword}{>}(selection);}
\DoxyCodeLine{00333     \textcolor{keywordflow}{if} (styleSelection) styleSelection-\/>selectNone();}
\DoxyCodeLine{00334   \}}
\DoxyCodeLine{00335 }
\DoxyCodeLine{00336   \textcolor{comment}{/*}}
\DoxyCodeLine{00337 \textcolor{comment}{    if the Style Picker tool is current and "{}organize palette"{} is activated,}}
\DoxyCodeLine{00338 \textcolor{comment}{    then move the picked style to the first page of the palette.}}
\DoxyCodeLine{00339 \textcolor{comment}{  */}}
\DoxyCodeLine{00340   \mbox{\hyperlink{class_t_tool}{TTool}} *tool = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}()-\/>getTool();}
\DoxyCodeLine{00341   \textcolor{keywordflow}{if} (tool-\/>getName() == \textcolor{stringliteral}{"{}T\_StylePicker"{}}) \{}
\DoxyCodeLine{00342     \mbox{\hyperlink{class_style_picker_tool}{StylePickerTool}} *spTool = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_style_picker_tool}{StylePickerTool}} *\textcolor{keyword}{>}(tool);}
\DoxyCodeLine{00343     \textcolor{keywordflow}{if} (spTool \&\& spTool-\/>isOrganizePaletteActive()) \{}
\DoxyCodeLine{00344       \mbox{\hyperlink{class_t_point_t}{TPoint}} point = picker.getRasterPoint(pos);}
\DoxyCodeLine{00345       \textcolor{keywordtype}{int} frame    = m\_flipConsole-\/>getCurrentFrame() -\/ 1;}
\DoxyCodeLine{00346       PaletteCmd::organizePaletteStyle(}
\DoxyCodeLine{00347           ph, styleIndex, \mbox{\hyperlink{struct_t_color_style_1_1_picked_position}{TColorStyle::PickedPosition}}(point, frame));}
\DoxyCodeLine{00348     \}}
\DoxyCodeLine{00349   \}}
\DoxyCodeLine{00350 }
\DoxyCodeLine{00351   ph-\/>setStyleIndex(styleIndex);}
\DoxyCodeLine{00352 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00134}{TApp\+::get\+Current\+Selection()}}, \mbox{\hyperlink{l00126}{TApp\+::get\+Current\+Tool()}}, \mbox{\hyperlink{l00108}{Image\+Viewer\+::get\+Image()}}, \mbox{\hyperlink{l00030}{Style\+Picker\+::get\+Raster\+Point()}}, \mbox{\hyperlink{l00433}{TPalette\+::get\+Style\+Page()}}, \mbox{\hyperlink{l00110}{Image\+Viewer\+::get\+View\+Aff()}}, \mbox{\hyperlink{l00215}{TApp\+::instance()}}, \mbox{\hyperlink{l00055}{TAffine\+::inv()}}, and \mbox{\hyperlink{l00048}{Style\+Picker\+::pick\+Style\+Id()}}.



Referenced by \mbox{\hyperlink{l00280}{mouse\+Move\+Event()}}, and \mbox{\hyperlink{l00273}{mouse\+Press\+Event()}}.

\mbox{\Hypertarget{class_color_model_viewer_a1b98686eb625dbeda6c1831f875544a8}\label{class_color_model_viewer_a1b98686eb625dbeda6c1831f875544a8}} 
\index{ColorModelViewer@{ColorModelViewer}!reloadCurrentFrame@{reloadCurrentFrame}}
\index{reloadCurrentFrame@{reloadCurrentFrame}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{reloadCurrentFrame()}{reloadCurrentFrame()}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::reload\+Current\+Frame (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00562                                           \{}
\DoxyCodeLine{00563   \mbox{\hyperlink{class_t_app}{TApp}} *app     = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{00564   \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *xl = app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel();}
\DoxyCodeLine{00565   \textcolor{keywordflow}{if} (!xl) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00566   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl = xl-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{00567   \textcolor{keywordflow}{if} (!sl) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00568 }
\DoxyCodeLine{00569   \mbox{\hyperlink{class_t_palette}{TPalette}} *currentPalette =}
\DoxyCodeLine{00570       app-\/>getPaletteController()-\/>getCurrentLevelPalette()-\/>getPalette();}
\DoxyCodeLine{00571   \textcolor{keywordflow}{if} (!currentPalette) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00572 }
\DoxyCodeLine{00573   std::vector<TFrameId> fids = currentPalette-\/>\mbox{\hyperlink{class_t_palette_aeda302f41529ee532096ecef117bdf7d}{getRefLevelFids}}();}
\DoxyCodeLine{00574   \textcolor{comment}{/*-\/ CurrentFrameなので、1Frameのみのはず -\/*/}}
\DoxyCodeLine{00575   \textcolor{keywordflow}{if} (fids.size() != 1) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00576 }
\DoxyCodeLine{00577   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img = sl-\/>getFrame(fids[0], \textcolor{keyword}{true});}
\DoxyCodeLine{00578   \textcolor{keywordflow}{if} (!img) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00579 }
\DoxyCodeLine{00580   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} refImg = img-\/>\mbox{\hyperlink{class_t_image_a3632b96b398057030a4adfe6917d2e28}{cloneImage}}();}
\DoxyCodeLine{00581 }
\DoxyCodeLine{00582   currentPalette-\/>\mbox{\hyperlink{class_t_palette_a971fd2aac3c14754d6cdcb0679cf6893}{setRefImg}}(\mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}}());}
\DoxyCodeLine{00583 }
\DoxyCodeLine{00584   currentPalette-\/>\mbox{\hyperlink{class_t_palette_a3009b4c976d9458d71dca9ea176bd7e1}{setRefImgPath}}(xl-\/>\mbox{\hyperlink{class_t_xsh_level_ab8ffcf067cadf0e1c4081b54ffde249d}{getPath}}());}
\DoxyCodeLine{00585 }
\DoxyCodeLine{00586   \textcolor{comment}{/*-\/ currentRefImgPathの更新 -\/*/}}
\DoxyCodeLine{00587   m\_currentRefImgPath = xl-\/>\mbox{\hyperlink{class_t_xsh_level_ab8ffcf067cadf0e1c4081b54ffde249d}{getPath}}();}
\DoxyCodeLine{00588 }
\DoxyCodeLine{00589   m\_levels.clear();}
\DoxyCodeLine{00590 }
\DoxyCodeLine{00591   m\_levelNames.clear();}
\DoxyCodeLine{00592   m\_framesCount = 1;}
\DoxyCodeLine{00593   m\_palette     = 0;}
\DoxyCodeLine{00594   m\_lr          = \mbox{\hyperlink{class_t_level_reader_p}{TLevelReaderP}}();}
\DoxyCodeLine{00595   m\_dim         = \mbox{\hyperlink{class_t_dimension_t}{TDimension}}(0, 0);}
\DoxyCodeLine{00596   m\_loadbox     = \mbox{\hyperlink{class_t_rect_t}{TRect}}();}
\DoxyCodeLine{00597   m\_loadboxes.clear();}
\DoxyCodeLine{00598   m\_flipConsole-\/>enableProgressBar(\textcolor{keyword}{false});}
\DoxyCodeLine{00599   m\_flipConsole-\/>setProgressBarStatus(0);}
\DoxyCodeLine{00600   m\_flipConsole-\/>setFrameRange(1, 1, 1);}
\DoxyCodeLine{00601   m\_title1 = m\_viewerTitle +}
\DoxyCodeLine{00602              \textcolor{stringliteral}{"{} :: "{}} + m\_currentRefImgPath.\mbox{\hyperlink{class_t_file_path_ac17d65d827432f0fae28fed699bf4afa}{withoutParentDir}}().\mbox{\hyperlink{class_t_file_path_a12f35b225e1882372ad7e02ad7fce543}{withFrame}}(fids[0]);}
\DoxyCodeLine{00603   m\_title = \textcolor{stringliteral}{"{}  ::  <Use Current Frame>"{}};}
\DoxyCodeLine{00604 }
\DoxyCodeLine{00605   m\_imageViewer-\/>\mbox{\hyperlink{class_image_viewer_af514a3d90ce0f99a9217874bb3ef95dc}{setImage}}(refImg);}
\DoxyCodeLine{00606 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_color_model_viewer_afbdf5d0068d7b7423d61d5bcc5daaae7}\label{class_color_model_viewer_afbdf5d0068d7b7423d61d5bcc5daaae7}} 
\index{ColorModelViewer@{ColorModelViewer}!removeColorModel@{removeColorModel}}
\index{removeColorModel@{removeColorModel}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{removeColorModel}{removeColorModel}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::remove\+Color\+Model (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}

Remove reference image from current palette using {\bfseries{Palette\+Cmd\+::remove\+Reference\+Image()}} and reset image viewer. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00612                                         \{}
\DoxyCodeLine{00613   PaletteCmd::removeReferenceImage(getPaletteHandle());}
\DoxyCodeLine{00614   \mbox{\hyperlink{class_color_model_viewer_afe17b3649c3aa4aa107ddf6320a19704}{resetImageViewer}}();}
\DoxyCodeLine{00615   m\_currentRefImgPath = \mbox{\hyperlink{class_t_file_path}{TFilePath}}();}
\DoxyCodeLine{00616 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00029}{reset\+Image\+Viewer()}}.

\mbox{\Hypertarget{class_color_model_viewer_a76649fd1fe9df823e23164ffe9ad7f3f}\label{class_color_model_viewer_a76649fd1fe9df823e23164ffe9ad7f3f}} 
\index{ColorModelViewer@{ColorModelViewer}!repickFromColorModel@{repickFromColorModel}}
\index{repickFromColorModel@{repickFromColorModel}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{repickFromColorModel}{repickFromColorModel}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::repick\+From\+Color\+Model (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00628                                             \{}
\DoxyCodeLine{00629   \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img = m\_imageViewer-\/>\mbox{\hyperlink{class_image_viewer_af80b9641df537a1bf3b0c98f2c431420}{getImage}}();}
\DoxyCodeLine{00630   \textcolor{keywordflow}{if} (!img) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00631   \mbox{\hyperlink{class_t_palette_handle}{TPaletteHandle}} *ph =}
\DoxyCodeLine{00632       \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>getPaletteController()-\/>getCurrentLevelPalette();}
\DoxyCodeLine{00633 }
\DoxyCodeLine{00634   PaletteCmd::pickColorByUsingPickedPosition(}
\DoxyCodeLine{00635       ph, img, m\_flipConsole-\/>getCurrentFrame() -\/ 1);}
\DoxyCodeLine{00636 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_color_model_viewer_afe17b3649c3aa4aa107ddf6320a19704}\label{class_color_model_viewer_afe17b3649c3aa4aa107ddf6320a19704}} 
\index{ColorModelViewer@{ColorModelViewer}!resetImageViewer@{resetImageViewer}}
\index{resetImageViewer@{resetImageViewer}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{resetImageViewer()}{resetImageViewer()}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::reset\+Image\+Viewer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}

Set current level to \mbox{\hyperlink{class_t_level_p}{TLevel\+P()}} and image to \char`\"{}0\char`\"{}. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00029                           \{}
\DoxyCodeLine{00030     clearCache();}
\DoxyCodeLine{00031     m\_levels.clear();}
\DoxyCodeLine{00032     m\_title = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00033     m\_imageViewer-\/>\mbox{\hyperlink{class_image_viewer_af514a3d90ce0f99a9217874bb3ef95dc}{setImage}}(getCurrentImage(0));}
\DoxyCodeLine{00034     m\_currentRefImgPath = \mbox{\hyperlink{class_t_file_path}{TFilePath}}();}
\DoxyCodeLine{00035     m\_palette           = 0;}
\DoxyCodeLine{00036   \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00405}{Image\+Viewer\+::set\+Image()}}.



Referenced by \mbox{\hyperlink{l00612}{remove\+Color\+Model()}}.

\mbox{\Hypertarget{class_color_model_viewer_a75c3636dd2482cf5a5f7238712a797e8}\label{class_color_model_viewer_a75c3636dd2482cf5a5f7238712a797e8}} 
\index{ColorModelViewer@{ColorModelViewer}!showCurrentImage@{showCurrentImage}}
\index{showCurrentImage@{showCurrentImage}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{showCurrentImage}{showCurrentImage}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::show\+Current\+Image (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00451                                         \{}
\DoxyCodeLine{00452   \mbox{\hyperlink{class_t_palette}{TPalette}} *palette = getPaletteHandle()-\/>getPalette();}
\DoxyCodeLine{00453   \textcolor{keywordflow}{if} (!palette) \{}
\DoxyCodeLine{00454     \mbox{\hyperlink{class_color_model_viewer_afe17b3649c3aa4aa107ddf6320a19704}{resetImageViewer}}();}
\DoxyCodeLine{00455     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00456   \}}
\DoxyCodeLine{00457   \mbox{\hyperlink{class_t_app}{TApp}} *app     = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}();}
\DoxyCodeLine{00458   \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *xl = app-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}()-\/>getLevel();}
\DoxyCodeLine{00459   \textcolor{keywordflow}{if} (!xl) \{}
\DoxyCodeLine{00460     \mbox{\hyperlink{class_color_model_viewer_afe17b3649c3aa4aa107ddf6320a19704}{resetImageViewer}}();}
\DoxyCodeLine{00461     \textcolor{keywordflow}{return};}
\DoxyCodeLine{00462   \}}
\DoxyCodeLine{00463   \textcolor{comment}{/*-\/-\/ UseCurrentFrameの場合、paletteを差し替える -\/-\/*/}}
\DoxyCodeLine{00464   \textcolor{keywordflow}{if} (palette-\/>getRefImgPath() == xl-\/>\mbox{\hyperlink{class_t_xsh_level_ab8ffcf067cadf0e1c4081b54ffde249d}{getPath}}()) \{}
\DoxyCodeLine{00465     \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *sl = xl-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{00466     \textcolor{keywordflow}{if} (!sl) \{}
\DoxyCodeLine{00467       \mbox{\hyperlink{class_color_model_viewer_afe17b3649c3aa4aa107ddf6320a19704}{resetImageViewer}}();}
\DoxyCodeLine{00468       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00469     \}}
\DoxyCodeLine{00470     \textcolor{comment}{/*-\/ 同じTFrameIdだった場合、パレットを差し替える -\/*/}}
\DoxyCodeLine{00471     \textcolor{keywordflow}{if} (m\_currentRefImgPath == xl-\/>\mbox{\hyperlink{class_t_xsh_level_ab8ffcf067cadf0e1c4081b54ffde249d}{getPath}}()) \{}
\DoxyCodeLine{00472       \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} refImg = m\_imageViewer-\/>\mbox{\hyperlink{class_image_viewer_af80b9641df537a1bf3b0c98f2c431420}{getImage}}();}
\DoxyCodeLine{00473       \textcolor{keywordflow}{if} (!refImg) \{}
\DoxyCodeLine{00474         \mbox{\hyperlink{class_color_model_viewer_afe17b3649c3aa4aa107ddf6320a19704}{resetImageViewer}}();}
\DoxyCodeLine{00475         \textcolor{keywordflow}{return};}
\DoxyCodeLine{00476       \}}
\DoxyCodeLine{00477 }
\DoxyCodeLine{00478       \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} refImg\_clone = refImg-\/>\mbox{\hyperlink{class_t_image_a3632b96b398057030a4adfe6917d2e28}{cloneImage}}();}
\DoxyCodeLine{00479       refImg\_clone-\/>\mbox{\hyperlink{class_t_image_a3377c18a849addff5c2cb238176ad04f}{setPalette}}(palette);}
\DoxyCodeLine{00480       m\_imageViewer-\/>\mbox{\hyperlink{class_image_viewer_af514a3d90ce0f99a9217874bb3ef95dc}{setImage}}(refImg\_clone);}
\DoxyCodeLine{00481       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00482     \}}
\DoxyCodeLine{00483     \textcolor{comment}{/*-\/ UseCurrentFrameのLevelに移動してきた場合、Levelを入れ直す -\/*/}}
\DoxyCodeLine{00484     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00485       reloadCurrentFrame();}
\DoxyCodeLine{00486       \textcolor{keywordflow}{return};}
\DoxyCodeLine{00487     \}}
\DoxyCodeLine{00488   \}}
\DoxyCodeLine{00489 }
\DoxyCodeLine{00490   \textcolor{comment}{/*-\/ 以下、通常のColorModelが読み込まれている場合 -\/*/}}
\DoxyCodeLine{00491   \mbox{\hyperlink{class_color_model_viewer_afe17b3649c3aa4aa107ddf6320a19704}{resetImageViewer}}();}
\DoxyCodeLine{00492 }
\DoxyCodeLine{00493   \mbox{\hyperlink{class_toonz_scene}{ToonzScene}} *scene = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_abbbf1fae564e9e510826eda4f6637d20}{getCurrentScene}}()-\/>getScene();}
\DoxyCodeLine{00494   \mbox{\hyperlink{class_t_file_path}{TFilePath}} fp      = scene-\/>\mbox{\hyperlink{class_toonz_scene_aa2ed57dfbae7f8cf02a4abe47ed533c6}{decodeFilePath}}(palette-\/>getRefImgPath());}
\DoxyCodeLine{00495   \textcolor{keywordflow}{if} (TSystem::doesExistFileOrLevel(fp)) \{}
\DoxyCodeLine{00496     \mbox{\hyperlink{class_flip_book_ac70c72b88200e2821ea83f4273cb34e4}{setLevel}}(fp, palette);}
\DoxyCodeLine{00497   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!fp.isEmpty())}
\DoxyCodeLine{00498     emit refImageNotFound();}
\DoxyCodeLine{00499 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_color_model_viewer_a1319770c15aeb6dd70c64708d4deae0c}\label{class_color_model_viewer_a1319770c15aeb6dd70c64708d4deae0c}} 
\index{ColorModelViewer@{ColorModelViewer}!showEvent@{showEvent}}
\index{showEvent@{showEvent}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{showEvent()}{showEvent()}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::show\+Event (\begin{DoxyParamCaption}\item[{QShow\+Event $\ast$}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00376                                               \{}
\DoxyCodeLine{00377   \mbox{\hyperlink{class_t_palette_handle}{TPaletteHandle}} *paletteHandle = getPaletteHandle();}
\DoxyCodeLine{00378   \mbox{\hyperlink{class_t_xsh_level_handle}{TXshLevelHandle}} *levelHandle  = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad2923c9feaaa44ecd9cdd0fa029aa8aa}{getCurrentLevel}}();}
\DoxyCodeLine{00379   \mbox{\hyperlink{class_tool_handle}{ToolHandle}} *toolHandle        = \mbox{\hyperlink{class_t_app_a24088f8647d5d9447fcec6b9b9bbf9eb}{TApp::instance}}()-\/>\mbox{\hyperlink{class_t_app_ad70b447aff489792cfc3dbac7150a540}{getCurrentTool}}();}
\DoxyCodeLine{00380   \textcolor{keywordtype}{bool} ret = connect(paletteHandle, SIGNAL(paletteSwitched()), \textcolor{keyword}{this},}
\DoxyCodeLine{00381                      SLOT(showCurrentImage()));}
\DoxyCodeLine{00382   ret      = ret \&\& connect(paletteHandle, SIGNAL(paletteChanged()), \textcolor{keyword}{this},}
\DoxyCodeLine{00383                        SLOT(showCurrentImage()));}
\DoxyCodeLine{00384   ret = ret \&\& connect(paletteHandle, SIGNAL(colorStyleChanged(\textcolor{keywordtype}{bool})), \textcolor{keyword}{this},}
\DoxyCodeLine{00385                        SLOT(showCurrentImage()));}
\DoxyCodeLine{00386   \textcolor{comment}{/*-\/ ツールのTypeに合わせてPickのタイプも変え、カーソルも切り替える -\/*/}}
\DoxyCodeLine{00387   ret = ret \&\& connect(toolHandle, SIGNAL(toolSwitched()), \textcolor{keyword}{this},}
\DoxyCodeLine{00388                        SLOT(changePickType()));}
\DoxyCodeLine{00389   ret = ret \&\& connect(toolHandle, SIGNAL(toolChanged()), \textcolor{keyword}{this},}
\DoxyCodeLine{00390                        SLOT(changePickType()));}
\DoxyCodeLine{00391   ret = ret \&\& connect(levelHandle, SIGNAL(xshLevelViewChanged()), \textcolor{keyword}{this},}
\DoxyCodeLine{00392                        SLOT(\mbox{\hyperlink{class_color_model_viewer_adcad5be4168e72f9a2589628a403770c}{updateViewer}}()));}
\DoxyCodeLine{00393   assert(ret);}
\DoxyCodeLine{00394   changePickType();}
\DoxyCodeLine{00395   showCurrentImage();}
\DoxyCodeLine{00396 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_color_model_viewer_adcad5be4168e72f9a2589628a403770c}\label{class_color_model_viewer_adcad5be4168e72f9a2589628a403770c}} 
\index{ColorModelViewer@{ColorModelViewer}!updateViewer@{updateViewer}}
\index{updateViewer@{updateViewer}!ColorModelViewer@{ColorModelViewer}}
\doxysubsubsection{\texorpdfstring{updateViewer}{updateViewer}}
{\footnotesize\ttfamily void Color\+Model\+Viewer\+::update\+Viewer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [slot]}}

If current palette level exists reset image viewer and set current viewer to reference image path level. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00447 \{ getImageViewer()-\/>repaint(); \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/toonz/colormodelviewer.\+h\item 
E\+:/opentoonz/toonz/sources/toonz/colormodelviewer.\+cpp\end{DoxyCompactItemize}
