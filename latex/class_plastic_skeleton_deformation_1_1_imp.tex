\hypertarget{class_plastic_skeleton_deformation_1_1_imp}{}\doxysection{Plastic\+Skeleton\+Deformation\+::Imp Class Reference}
\label{class_plastic_skeleton_deformation_1_1_imp}\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
Inheritance diagram for Plastic\+Skeleton\+Deformation\+::Imp\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_plastic_skeleton_deformation_1_1_imp}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a6b5a286e2e9d075be34836f324654ed6}{Imp}} (\mbox{\hyperlink{class_plastic_skeleton_deformation}{Plastic\+Skeleton\+Deformation}} $\ast$back)
\item 
\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_aff1d97553bcbbeb1c95680f003efe57e}{Imp}} (\mbox{\hyperlink{class_plastic_skeleton_deformation}{Plastic\+Skeleton\+Deformation}} $\ast$back, const \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp}{Imp}} \&other)
\item 
\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp}{Imp}} \& \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a3dd1917723e99c8b22218e16123679ca}{operator=}} (const \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp}{Imp}} \&other)
\item 
\mbox{\hyperlink{class_plastic_skeleton}{Plastic\+Skeleton}} \& \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a84483d0f3a935d01f5ae353fe745ce03}{skeleton}} (int skel\+Id) const
\item 
\mbox{\hyperlink{struct_plastic_skeleton_vertex_deformation}{Sk\+VD}} \& \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acd1a0511d80c3cfabd07be4a6ae4a298}{vertex\+Deformation}} (const QString \&name) const
\item 
void \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a97f4b9a362d445cb59869405d69a7f20}{attach}} (int skeleton\+Id, \mbox{\hyperlink{class_plastic_skeleton}{Plastic\+Skeleton}} $\ast$skeleton)
\item 
void \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a57df8e86184c83fe487ebaea1b7149af}{detach}} (int skeleton\+Id)
\item 
void \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a6cc21996f9d71fac5be1ecedd940c489}{attach\+Vertex}} (const QString \&name, int skel\+Id, int v)
\item 
void \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_aeccd1a9da48889fbac2be22ee2d41a5d}{detach\+Vertex}} (const QString \&name, int skel\+Id, int v)
\item 
void \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a99a301e9661103d69ab056a0f2d4c0fc}{rebind\+Vertex}} (const QString \&name, int skel\+Id, const QString \&new\+Name)
\item 
void \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a3bc7e979fd0e95572f0a34782a430f9c}{touch\+Params}} (\mbox{\hyperlink{struct_plastic_skeleton_vertex_deformation}{Sk\+VD}} \&vd)
\item 
void \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a89c21cbdf7318f9e76f0391ce2927420}{update\+Branch\+Positions}} (const \mbox{\hyperlink{class_plastic_skeleton}{Plastic\+Skeleton}} \&original\+Skeleton, \mbox{\hyperlink{class_plastic_skeleton}{Plastic\+Skeleton}} \&deformed\+Skeleton, double frame, int v)
\begin{DoxyCompactList}\small\item\em Applies stored vertex deformations to the skeleton branch starting at v. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a238fe915c6ba1478526ddf6f22698a07}{on\+Change}} (const \mbox{\hyperlink{class_t_param_change}{TParam\+Change}} \&change) override
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_plastic_skeleton_deformation}{Plastic\+Skeleton\+Deformation}} $\ast$ \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a0cc0fc45d621136e9bc57218dca90c89}{m\+\_\+back}}
\begin{DoxyCompactList}\small\item\em Back-\/pointer to the interface class. \end{DoxyCompactList}\item 
Skeleton\+Set \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_add23c9f507c01add3f49ee42d6b272c8}{m\+\_\+skeletons}}
\begin{DoxyCompactList}\small\item\em Skeletons owned by the deformation. \end{DoxyCompactList}\item 
Sk\+VDSet \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\+\_\+vds}}
\begin{DoxyCompactList}\small\item\em Container of vertex deformations. \end{DoxyCompactList}\item 
TDouble\+ParamP \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}{m\+\_\+skel\+Ids\+Param}}
\begin{DoxyCompactList}\small\item\em Curve of skeleton ids by xsheet frame. \end{DoxyCompactList}\item 
std\+::set$<$ \mbox{\hyperlink{class_t_param_observer}{TParam\+Observer}} $\ast$ $>$ \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a851b848cf4f24ec1bef75c8280c7d0f8}{m\+\_\+observers}}
\begin{DoxyCompactList}\small\item\em Set of the deformation\textquotesingle{}s observers. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_t_syntax_1_1_grammar}{TSyntax\+::\+Grammar}} $\ast$ \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_aab7a0f7a3f56b3fa02378febd6dba110}{m\+\_\+grammar}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a6b5a286e2e9d075be34836f324654ed6}\label{class_plastic_skeleton_deformation_1_1_imp_a6b5a286e2e9d075be34836f324654ed6}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!Imp@{Imp}}
\index{Imp@{Imp}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{Imp()}{Imp()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Plastic\+Skeleton\+Deformation\+::\+Imp\+::\+Imp (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_plastic_skeleton_deformation}{Plastic\+Skeleton\+Deformation}} $\ast$}]{back }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00273     : \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a0cc0fc45d621136e9bc57218dca90c89}{m\_back}}(back), \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}{m\_skelIdsParam}}(1.0), \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_aab7a0f7a3f56b3fa02378febd6dba110}{m\_grammar}}() \{}
\DoxyCodeLine{00274   \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}{m\_skelIdsParam}}-\/>setName(\textcolor{stringliteral}{"{}Skeleton Id"{}});}
\DoxyCodeLine{00275   \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}{m\_skelIdsParam}}-\/>addObserver(\textcolor{keyword}{this});}
\DoxyCodeLine{00276 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a30aa025dd1686b6573b0cfd92d919d41}\label{class_plastic_skeleton_deformation_1_1_imp_a30aa025dd1686b6573b0cfd92d919d41}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!````~Imp@{$\sim$Imp}}
\index{````~Imp@{$\sim$Imp}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{$\sim$Imp()}{~Imp()}}
{\footnotesize\ttfamily Plastic\+Skeleton\+Deformation\+::\+Imp\+::$\sim$\+Imp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00280                                     \{}
\DoxyCodeLine{00281   \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}{m\_skelIdsParam}}-\/>removeObserver(\textcolor{keyword}{this});}
\DoxyCodeLine{00282 }
\DoxyCodeLine{00283   SkVDSet::iterator dt, dEnd(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.end());}
\DoxyCodeLine{00284   \textcolor{keywordflow}{for} (dt = \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.begin(); dt != dEnd; ++dt)}
\DoxyCodeLine{00285     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < SkVD::PARAMS\_COUNT; ++p)}
\DoxyCodeLine{00286       dt-\/>m\_vd.m\_params[p]-\/>removeObserver(\textcolor{keyword}{this});}
\DoxyCodeLine{00287 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_aff1d97553bcbbeb1c95680f003efe57e}\label{class_plastic_skeleton_deformation_1_1_imp_aff1d97553bcbbeb1c95680f003efe57e}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!Imp@{Imp}}
\index{Imp@{Imp}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{Imp()}{Imp()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily Plastic\+Skeleton\+Deformation\+::\+Imp\+::\+Imp (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_plastic_skeleton_deformation}{Plastic\+Skeleton\+Deformation}} $\ast$}]{back,  }\item[{const \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp}{Imp}} \&}]{other }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00293     : \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a0cc0fc45d621136e9bc57218dca90c89}{m\_back}}(back), \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}{m\_skelIdsParam}}(other.m\_skelIdsParam-\/>clone()), \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_aab7a0f7a3f56b3fa02378febd6dba110}{m\_grammar}}() \{}
\DoxyCodeLine{00294   \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}{m\_skelIdsParam}}-\/>setGrammar(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_aab7a0f7a3f56b3fa02378febd6dba110}{m\_grammar}});}
\DoxyCodeLine{00295   \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}{m\_skelIdsParam}}-\/>addObserver(\textcolor{keyword}{this});}
\DoxyCodeLine{00296 }
\DoxyCodeLine{00297   \textcolor{comment}{// Clone the skeletons}}
\DoxyCodeLine{00298   SkeletonSet::const\_iterator st, sEnd(other.m\_skeletons.end());}
\DoxyCodeLine{00299   \textcolor{keywordflow}{for} (st = other.m\_skeletons.begin(); st != sEnd; ++st)}
\DoxyCodeLine{00300     \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_add23c9f507c01add3f49ee42d6b272c8}{m\_skeletons}}.insert(SkeletonSet::value\_type(}
\DoxyCodeLine{00301         st-\/>get\_left(), \textcolor{keyword}{new} \mbox{\hyperlink{class_plastic_skeleton}{PlasticSkeleton}}(*st-\/>get\_right())));}
\DoxyCodeLine{00302 }
\DoxyCodeLine{00303   \textcolor{comment}{// Clone each parameters curve}}
\DoxyCodeLine{00304   \mbox{\hyperlink{struct_plastic_skeleton_vertex_deformation}{SkVD}} vd;}
\DoxyCodeLine{00305 }
\DoxyCodeLine{00306   SkVDSet::const\_iterator dt, dEnd(other.m\_vds.end());}
\DoxyCodeLine{00307   \textcolor{keywordflow}{for} (dt = other.m\_vds.begin(); dt != dEnd; ++dt) \{}
\DoxyCodeLine{00308     VDKey vdKey = \{dt-\/>m\_name, dt-\/>m\_hookNumber, dt-\/>m\_vIndices\};}
\DoxyCodeLine{00309 }
\DoxyCodeLine{00310     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < SkVD::PARAMS\_COUNT; ++p) \{}
\DoxyCodeLine{00311       TDoubleParamP \&param = vdKey.m\_vd.m\_params[p];}
\DoxyCodeLine{00312 }
\DoxyCodeLine{00313       param = TDoubleParamP(dt-\/>m\_vd.m\_params[p]-\/>clone());}
\DoxyCodeLine{00314 }
\DoxyCodeLine{00315       param-\/>setGrammar(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_aab7a0f7a3f56b3fa02378febd6dba110}{m\_grammar}});}
\DoxyCodeLine{00316       param-\/>addObserver(\textcolor{keyword}{this});}
\DoxyCodeLine{00317     \}}
\DoxyCodeLine{00318 }
\DoxyCodeLine{00319     \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.insert(vdKey);}
\DoxyCodeLine{00320   \}}
\DoxyCodeLine{00321 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a97f4b9a362d445cb59869405d69a7f20}\label{class_plastic_skeleton_deformation_1_1_imp_a97f4b9a362d445cb59869405d69a7f20}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!attach@{attach}}
\index{attach@{attach}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{attach()}{attach()}}
{\footnotesize\ttfamily void Plastic\+Skeleton\+Deformation\+::\+Imp\+::attach (\begin{DoxyParamCaption}\item[{int}]{skeleton\+Id,  }\item[{\mbox{\hyperlink{class_plastic_skeleton}{Plastic\+Skeleton}} $\ast$}]{skeleton }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00373                                                                         \{}
\DoxyCodeLine{00374   assert(skeleton);}
\DoxyCodeLine{00375 }
\DoxyCodeLine{00376   \textcolor{comment}{// Store the skeleton -\/ acquires shared ownership}}
\DoxyCodeLine{00377   assert(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_add23c9f507c01add3f49ee42d6b272c8}{m\_skeletons}}.left.find(skeletonId) == \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_add23c9f507c01add3f49ee42d6b272c8}{m\_skeletons}}.left.end());}
\DoxyCodeLine{00378 }
\DoxyCodeLine{00379   \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_add23c9f507c01add3f49ee42d6b272c8}{m\_skeletons}}.insert(SkeletonSet::value\_type(skeletonId, skeleton));}
\DoxyCodeLine{00380 }
\DoxyCodeLine{00381   \textcolor{comment}{// Deal with vertex deformations and parameter defaults}}
\DoxyCodeLine{00382   \mbox{\hyperlink{classtcg_1_1list}{tcg::list<PlasticSkeleton::vertex\_type>}} \&vertices = skeleton-\/>vertices();}
\DoxyCodeLine{00383   \textcolor{keywordflow}{if} (!vertices.empty()) \{}
\DoxyCodeLine{00384     \mbox{\hyperlink{structtcg_1_1list_1_1iterator}{tcg::list<PlasticSkeletonVertex>::iterator}} vt, vEnd(vertices.end());}
\DoxyCodeLine{00385     \textcolor{keywordflow}{for} (vt = vertices.begin(); vt != vEnd; ++vt)}
\DoxyCodeLine{00386       attachVertex(vt-\/>name(), skeletonId, vt.index());}
\DoxyCodeLine{00387   \}}
\DoxyCodeLine{00388 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a6cc21996f9d71fac5be1ecedd940c489}\label{class_plastic_skeleton_deformation_1_1_imp_a6cc21996f9d71fac5be1ecedd940c489}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!attachVertex@{attachVertex}}
\index{attachVertex@{attachVertex}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{attachVertex()}{attachVertex()}}
{\footnotesize\ttfamily void Plastic\+Skeleton\+Deformation\+::\+Imp\+::attach\+Vertex (\begin{DoxyParamCaption}\item[{const QString \&}]{name,  }\item[{int}]{skel\+Id,  }\item[{int}]{v }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00409                                                                       \{}
\DoxyCodeLine{00410   \textcolor{keyword}{struct }locals \{}
\DoxyCodeLine{00411     \textcolor{keyword}{static} \textcolor{keywordtype}{int} newHookNumber(Imp *imp) \{}
\DoxyCodeLine{00412       \textcolor{keywordtype}{int} h = 1;}
\DoxyCodeLine{00413 }
\DoxyCodeLine{00414       SkVDByHookNumber::iterator vdt, vdEnd(imp-\/>m\_vds.get<\textcolor{keywordtype}{int}>().end());}
\DoxyCodeLine{00415       \textcolor{keywordflow}{for} (vdt = imp-\/>m\_vds.get<\textcolor{keywordtype}{int}>().begin();}
\DoxyCodeLine{00416            vdt != vdEnd \&\& vdt-\/>m\_hookNumber == h; ++vdt, ++h)}
\DoxyCodeLine{00417         ;}
\DoxyCodeLine{00418 }
\DoxyCodeLine{00419       \textcolor{keywordflow}{return} h;}
\DoxyCodeLine{00420     \}}
\DoxyCodeLine{00421 }
\DoxyCodeLine{00422   \};  \textcolor{comment}{// locals}}
\DoxyCodeLine{00423 }
\DoxyCodeLine{00424   \textcolor{comment}{// Insert a new VD if necessary}}
\DoxyCodeLine{00425   SkVDSet::iterator vdt(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.find(name));}
\DoxyCodeLine{00426   \textcolor{keywordflow}{if} (vdt == \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.end()) \{}
\DoxyCodeLine{00427     VDKey vdKey = \{name, locals::newHookNumber(\textcolor{keyword}{this})\};}
\DoxyCodeLine{00428     touchParams(vdKey.m\_vd);}
\DoxyCodeLine{00429 }
\DoxyCodeLine{00430     vdt = \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.insert(vdKey).first;}
\DoxyCodeLine{00431   \}}
\DoxyCodeLine{00432 }
\DoxyCodeLine{00433   \textcolor{comment}{// Register (skelId, v) on the vd}}
\DoxyCodeLine{00434   vdt-\/>m\_vIndices.insert(std::make\_pair(skelId, v));}
\DoxyCodeLine{00435 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a57df8e86184c83fe487ebaea1b7149af}\label{class_plastic_skeleton_deformation_1_1_imp_a57df8e86184c83fe487ebaea1b7149af}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!detach@{detach}}
\index{detach@{detach}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{detach()}{detach()}}
{\footnotesize\ttfamily void Plastic\+Skeleton\+Deformation\+::\+Imp\+::detach (\begin{DoxyParamCaption}\item[{int}]{skeleton\+Id }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00392                                                          \{}
\DoxyCodeLine{00393   \textcolor{comment}{// First, detach all vertices}}
\DoxyCodeLine{00394   \mbox{\hyperlink{classtcg_1_1list}{tcg::list<PlasticSkeleton::vertex\_type>}} \&vertices =}
\DoxyCodeLine{00395       skeleton(skeletonId).vertices();}
\DoxyCodeLine{00396   \textcolor{keywordflow}{if} (!vertices.empty()) \{}
\DoxyCodeLine{00397     \mbox{\hyperlink{structtcg_1_1list_1_1iterator}{tcg::list<PlasticSkeletonVertex>::iterator}} vt, vEnd(vertices.end());}
\DoxyCodeLine{00398     \textcolor{keywordflow}{for} (vt = vertices.begin(); vt != vEnd; ++vt)}
\DoxyCodeLine{00399       detachVertex(vt-\/>name(), skeletonId, vt.index());}
\DoxyCodeLine{00400   \}}
\DoxyCodeLine{00401 }
\DoxyCodeLine{00402   \textcolor{comment}{// Then, release the skeleton itself}}
\DoxyCodeLine{00403   \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_add23c9f507c01add3f49ee42d6b272c8}{m\_skeletons}}.left.erase(skeletonId);}
\DoxyCodeLine{00404 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_aeccd1a9da48889fbac2be22ee2d41a5d}\label{class_plastic_skeleton_deformation_1_1_imp_aeccd1a9da48889fbac2be22ee2d41a5d}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!detachVertex@{detachVertex}}
\index{detachVertex@{detachVertex}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{detachVertex()}{detachVertex()}}
{\footnotesize\ttfamily void Plastic\+Skeleton\+Deformation\+::\+Imp\+::detach\+Vertex (\begin{DoxyParamCaption}\item[{const QString \&}]{name,  }\item[{int}]{skel\+Id,  }\item[{int}]{v }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00440                                                                       \{}
\DoxyCodeLine{00441   SkVDSet::iterator vdt = \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.find(name);}
\DoxyCodeLine{00442   assert(vdt != \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.end());}
\DoxyCodeLine{00443 }
\DoxyCodeLine{00444   \textcolor{comment}{// Unregister skelId}}
\DoxyCodeLine{00445   \textcolor{keywordtype}{int} count = vdt-\/>m\_vIndices.erase(skelId);}
\DoxyCodeLine{00446   assert(count > 0);}
\DoxyCodeLine{00447 }
\DoxyCodeLine{00448   \textcolor{keywordflow}{if} (vdt-\/>m\_vIndices.empty()) \{}
\DoxyCodeLine{00449     \textcolor{comment}{// De-\/register as vdt's observer, and release it from stored vds}}
\DoxyCodeLine{00450     \mbox{\hyperlink{struct_plastic_skeleton_vertex_deformation}{SkVD}} \&vd = vdt-\/>m\_vd;}
\DoxyCodeLine{00451 }
\DoxyCodeLine{00452     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < SkVD::PARAMS\_COUNT; ++p)}
\DoxyCodeLine{00453       vd.m\_params[p]-\/>removeObserver(\textcolor{keyword}{this});}
\DoxyCodeLine{00454 }
\DoxyCodeLine{00455     \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.erase(vdt);}
\DoxyCodeLine{00456   \}}
\DoxyCodeLine{00457 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a238fe915c6ba1478526ddf6f22698a07}\label{class_plastic_skeleton_deformation_1_1_imp_a238fe915c6ba1478526ddf6f22698a07}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!onChange@{onChange}}
\index{onChange@{onChange}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{onChange()}{onChange()}}
{\footnotesize\ttfamily void Plastic\+Skeleton\+Deformation\+::\+Imp\+::on\+Change (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_param_change}{TParam\+Change}} \&}]{change }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{class_t_param_observer}{TParam\+Observer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00522                                                                        \{}
\DoxyCodeLine{00523   \textcolor{comment}{// Since the deformation was changed, any associated deformer}}
\DoxyCodeLine{00524   \textcolor{comment}{// must be invalidated (at the animation-\/deform level only)}}
\DoxyCodeLine{00525   PlasticDeformerStorage::instance()-\/>\mbox{\hyperlink{class_plastic_deformer_storage_a5d8d1f31ce46100daca876d7c9f5b8a1}{invalidateDeformation}}(}
\DoxyCodeLine{00526       \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a0cc0fc45d621136e9bc57218dca90c89}{m\_back}}, PlasticDeformerStorage::NONE);}
\DoxyCodeLine{00527 }
\DoxyCodeLine{00528   \textcolor{comment}{// Propagate notification to this object's observers}}
\DoxyCodeLine{00529   std::set<TParamObserver *>::iterator ot, oEnd(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a851b848cf4f24ec1bef75c8280c7d0f8}{m\_observers}}.end());}
\DoxyCodeLine{00530   \textcolor{keywordflow}{for} (ot = \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a851b848cf4f24ec1bef75c8280c7d0f8}{m\_observers}}.begin(); ot != oEnd; ++ot) (*ot)-\/>onChange(change);}
\DoxyCodeLine{00531 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a3dd1917723e99c8b22218e16123679ca}\label{class_plastic_skeleton_deformation_1_1_imp_a3dd1917723e99c8b22218e16123679ca}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!operator=@{operator=}}
\index{operator=@{operator=}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp}{Plastic\+Skeleton\+Deformation\+::\+Imp}} \& Plastic\+Skeleton\+Deformation\+::\+Imp\+::operator= (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp}{Imp}} \&}]{other }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00326                       \{}
\DoxyCodeLine{00327   *\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}{m\_skelIdsParam}} = *other.m\_skelIdsParam;}
\DoxyCodeLine{00328   \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}{m\_skelIdsParam}}-\/>setGrammar(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_aab7a0f7a3f56b3fa02378febd6dba110}{m\_grammar}});}
\DoxyCodeLine{00329 }
\DoxyCodeLine{00330   \textcolor{comment}{// Take in all curves whose name matches one of the stored ones}}
\DoxyCodeLine{00331 }
\DoxyCodeLine{00332   \textcolor{comment}{// Traverse known curves}}
\DoxyCodeLine{00333   SkVDSet::iterator dt, dEnd(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.end());}
\DoxyCodeLine{00334   SkVDSet::const\_iterator st, sEnd(other.m\_vds.end());}
\DoxyCodeLine{00335 }
\DoxyCodeLine{00336   \textcolor{keywordflow}{for} (dt = \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.begin(); dt != dEnd; ++dt) \{}
\DoxyCodeLine{00337     \textcolor{comment}{// Search a corresponding curve in the input ones}}
\DoxyCodeLine{00338     st = other.m\_vds.find(dt-\/>m\_name);}
\DoxyCodeLine{00339     \textcolor{keywordflow}{if} (st != sEnd)}
\DoxyCodeLine{00340       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < SkVD::PARAMS\_COUNT; ++p) \{}
\DoxyCodeLine{00341         \mbox{\hyperlink{class_t_double_param}{TDoubleParam}} \&param = *dt-\/>m\_vd.m\_params[p];}
\DoxyCodeLine{00342 }
\DoxyCodeLine{00343         param = *st-\/>m\_vd.m\_params[p];}
\DoxyCodeLine{00344         param.setGrammar(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_aab7a0f7a3f56b3fa02378febd6dba110}{m\_grammar}});}
\DoxyCodeLine{00345       \}}
\DoxyCodeLine{00346   \}}
\DoxyCodeLine{00347 }
\DoxyCodeLine{00348   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{00349 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a99a301e9661103d69ab056a0f2d4c0fc}\label{class_plastic_skeleton_deformation_1_1_imp_a99a301e9661103d69ab056a0f2d4c0fc}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!rebindVertex@{rebindVertex}}
\index{rebindVertex@{rebindVertex}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{rebindVertex()}{rebindVertex()}}
{\footnotesize\ttfamily void Plastic\+Skeleton\+Deformation\+::\+Imp\+::rebind\+Vertex (\begin{DoxyParamCaption}\item[{const QString \&}]{name,  }\item[{int}]{skel\+Id,  }\item[{const QString \&}]{new\+Name }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00463                                                                            \{}
\DoxyCodeLine{00464   \textcolor{keywordflow}{if} (name == newName) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00465 }
\DoxyCodeLine{00466   SkVDSet::iterator oldVdt = \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.find(name);}
\DoxyCodeLine{00467   \textcolor{keywordflow}{if} (oldVdt == \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.end()) \textcolor{keywordflow}{return};  \textcolor{comment}{// We get here when creating a new vertex}}
\DoxyCodeLine{00468 }
\DoxyCodeLine{00469   std::map<int, int>::iterator vit = oldVdt-\/>m\_vIndices.find(skelId);}
\DoxyCodeLine{00470   assert(vit != oldVdt-\/>m\_vIndices.end());}
\DoxyCodeLine{00471 }
\DoxyCodeLine{00472   \textcolor{keywordtype}{int} v = vit-\/>second;}
\DoxyCodeLine{00473 }
\DoxyCodeLine{00474   SkVDSet::iterator newVdt = \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.find(newName);}
\DoxyCodeLine{00475   \textcolor{keywordflow}{if} (newVdt != \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.end()) \{}
\DoxyCodeLine{00476     detachVertex(name, skelId, v);}
\DoxyCodeLine{00477     attachVertex(newName, skelId, v);}
\DoxyCodeLine{00478   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00479     \textcolor{comment}{// Creating a new vd entry}}
\DoxyCodeLine{00480     \textcolor{keywordflow}{if} (oldVdt-\/>m\_vIndices.size() == 1) \{}
\DoxyCodeLine{00481       \textcolor{comment}{// The old entry should be removed -\/ it is actually *purely* renamed}}
\DoxyCodeLine{00482       VDKey vdKey(*oldVdt);}
\DoxyCodeLine{00483       vdKey.m\_name = newName;}
\DoxyCodeLine{00484 }
\DoxyCodeLine{00485       \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.erase(name);}
\DoxyCodeLine{00486       \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.insert(vdKey);}
\DoxyCodeLine{00487     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00488       \textcolor{comment}{// The old entry remains -\/ and data must be copied from there}}
\DoxyCodeLine{00489       detachVertex(name, skelId, v);}
\DoxyCodeLine{00490       attachVertex(newName, skelId, v);}
\DoxyCodeLine{00491 }
\DoxyCodeLine{00492       newVdt = \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.find(newName);  \textcolor{comment}{// Fetch the newly created vd}}
\DoxyCodeLine{00493 }
\DoxyCodeLine{00494       \textcolor{comment}{// Copy the existing vd into the new one}}
\DoxyCodeLine{00495       \mbox{\hyperlink{struct_plastic_skeleton_vertex_deformation}{SkVD}} \&oldVd = oldVdt-\/>m\_vd, \&newVd = newVdt-\/>m\_vd;}
\DoxyCodeLine{00496 }
\DoxyCodeLine{00497       \textcolor{keywordtype}{int} p, pCount = SkVD::PARAMS\_COUNT;}
\DoxyCodeLine{00498       \textcolor{keywordflow}{for} (p = 0; p != pCount; ++p) *newVd.m\_params[p] = *oldVd.m\_params[p];}
\DoxyCodeLine{00499     \}}
\DoxyCodeLine{00500   \}}
\DoxyCodeLine{00501 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a84483d0f3a935d01f5ae353fe745ce03}\label{class_plastic_skeleton_deformation_1_1_imp_a84483d0f3a935d01f5ae353fe745ce03}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!skeleton@{skeleton}}
\index{skeleton@{skeleton}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{skeleton()}{skeleton()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_plastic_skeleton}{Plastic\+Skeleton}} \& Plastic\+Skeleton\+Deformation\+::\+Imp\+::skeleton (\begin{DoxyParamCaption}\item[{int}]{skel\+Id }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00353                                                                          \{}
\DoxyCodeLine{00354   SkeletonSet::left\_map::const\_iterator st(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_add23c9f507c01add3f49ee42d6b272c8}{m\_skeletons}}.left.find(skelId));}
\DoxyCodeLine{00355   assert(st != \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_add23c9f507c01add3f49ee42d6b272c8}{m\_skeletons}}.left.end());}
\DoxyCodeLine{00356 }
\DoxyCodeLine{00357   \textcolor{keywordflow}{return} *st-\/>second;}
\DoxyCodeLine{00358 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a3bc7e979fd0e95572f0a34782a430f9c}\label{class_plastic_skeleton_deformation_1_1_imp_a3bc7e979fd0e95572f0a34782a430f9c}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!touchParams@{touchParams}}
\index{touchParams@{touchParams}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{touchParams()}{touchParams()}}
{\footnotesize\ttfamily void Plastic\+Skeleton\+Deformation\+::\+Imp\+::touch\+Params (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_plastic_skeleton_vertex_deformation}{Sk\+VD}} \&}]{vd }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00505                                                         \{}
\DoxyCodeLine{00506   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < SkVD::PARAMS\_COUNT; ++p) \{}
\DoxyCodeLine{00507     \textcolor{keywordflow}{if} (vd.m\_params[p]) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00508 }
\DoxyCodeLine{00509     \mbox{\hyperlink{class_t_double_param}{TDoubleParam}} *param = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_double_param}{TDoubleParam}};}
\DoxyCodeLine{00510     param-\/>\mbox{\hyperlink{class_t_param_adcea1c8c0a15cde752bc44205314ebc6}{setName}}(parNames[p]);}
\DoxyCodeLine{00511     param-\/>setMeasureName(parMeasures[p]);}
\DoxyCodeLine{00512     param-\/>setGrammar(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_aab7a0f7a3f56b3fa02378febd6dba110}{m\_grammar}});}
\DoxyCodeLine{00513 }
\DoxyCodeLine{00514     vd.m\_params[p] = param;}
\DoxyCodeLine{00515 }
\DoxyCodeLine{00516     param-\/>\mbox{\hyperlink{class_t_double_param_a477a2db0757b41f75322450bd00300f2}{addObserver}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00517   \}}
\DoxyCodeLine{00518 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a89c21cbdf7318f9e76f0391ce2927420}\label{class_plastic_skeleton_deformation_1_1_imp_a89c21cbdf7318f9e76f0391ce2927420}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!updateBranchPositions@{updateBranchPositions}}
\index{updateBranchPositions@{updateBranchPositions}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{updateBranchPositions()}{updateBranchPositions()}}
{\footnotesize\ttfamily void Plastic\+Skeleton\+Deformation\+::\+Imp\+::update\+Branch\+Positions (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_plastic_skeleton}{Plastic\+Skeleton}} \&}]{original\+Skeleton,  }\item[{\mbox{\hyperlink{class_plastic_skeleton}{Plastic\+Skeleton}} \&}]{deformed\+Skeleton,  }\item[{double}]{frame,  }\item[{int}]{v }\end{DoxyParamCaption})}



Applies stored vertex deformations to the skeleton branch starting at v. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00537                          \{}
\DoxyCodeLine{00538   \textcolor{keyword}{struct }locals \{}
\DoxyCodeLine{00539     \textcolor{keyword}{static} \textcolor{keywordtype}{void} buildParentDirection(\textcolor{keyword}{const} \mbox{\hyperlink{class_plastic_skeleton}{PlasticSkeleton}} \&skel, \textcolor{keywordtype}{int} v,}
\DoxyCodeLine{00540                                      \mbox{\hyperlink{class_t_point_t}{TPointD}} \&dir) \{}
\DoxyCodeLine{00541       assert(v >= 0);}
\DoxyCodeLine{00542 }
\DoxyCodeLine{00543       \textcolor{keyword}{const} \mbox{\hyperlink{struct_plastic_skeleton_vertex}{PlasticSkeletonVertex}} \&vx = skel.vertex(v);}
\DoxyCodeLine{00544 }
\DoxyCodeLine{00545       \textcolor{keywordtype}{int} vParent = vx.parent();}
\DoxyCodeLine{00546       \textcolor{keywordflow}{if} (vParent < 0) \textcolor{keywordflow}{return};  \textcolor{comment}{// dir remains as passed}}
\DoxyCodeLine{00547 }
\DoxyCodeLine{00548       \textcolor{keyword}{const} \mbox{\hyperlink{class_t_point_t}{TPointD}} \&dir\_ =}
\DoxyCodeLine{00549           tcg::point\_ops::direction(skel.vertex(vParent).P(), vx.P(), 1e-\/4);}
\DoxyCodeLine{00550 }
\DoxyCodeLine{00551       \textcolor{keywordflow}{if} (dir\_ != tcg::point\_ops::NaP<TPointD>())}
\DoxyCodeLine{00552         dir = dir\_;}
\DoxyCodeLine{00553       \textcolor{keywordflow}{else}}
\DoxyCodeLine{00554         buildParentDirection(skel, vParent, dir);}
\DoxyCodeLine{00555     \}}
\DoxyCodeLine{00556   \};  \textcolor{comment}{// locals}}
\DoxyCodeLine{00557 }
\DoxyCodeLine{00558   \mbox{\hyperlink{struct_plastic_skeleton_vertex}{PlasticSkeletonVertex}} \&dvx = deformedSkeleton.vertex(v);}
\DoxyCodeLine{00559   \textcolor{keywordtype}{int} vParent                = dvx.parent();}
\DoxyCodeLine{00560   \textcolor{keywordflow}{if} (vParent >= 0) \{}
\DoxyCodeLine{00561     \textcolor{comment}{// Rebuild vertex position}}
\DoxyCodeLine{00562     \textcolor{keyword}{const} \mbox{\hyperlink{class_t_point_t}{TPointD}} \&ovxPos       = originalSkeleton.vertex(v).P();}
\DoxyCodeLine{00563     \textcolor{keyword}{const} \mbox{\hyperlink{class_t_point_t}{TPointD}} \&ovxParentPos = originalSkeleton.vertex(vParent).P();}
\DoxyCodeLine{00564 }
\DoxyCodeLine{00565     \textcolor{comment}{// Start by getting the polar reference}}
\DoxyCodeLine{00566     \mbox{\hyperlink{class_t_point_t}{TPointD}} oDir(1.0, 0.0), dDir(1.0, 0.0);}
\DoxyCodeLine{00567 }
\DoxyCodeLine{00568     locals::buildParentDirection(originalSkeleton, vParent, oDir);}
\DoxyCodeLine{00569     locals::buildParentDirection(deformedSkeleton, vParent, dDir);}
\DoxyCodeLine{00570 }
\DoxyCodeLine{00571     \textcolor{comment}{// Now, rebuild vx's position}}
\DoxyCodeLine{00572     \textcolor{keyword}{const} \mbox{\hyperlink{struct_plastic_skeleton_vertex_deformation}{SkVD}} \&vd = \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.find(dvx.name())-\/>m\_vd;}
\DoxyCodeLine{00573 }
\DoxyCodeLine{00574     \textcolor{keywordtype}{double} a = \mbox{\hyperlink{namespacetcg_1_1point__ops_a566c0c25632bc324dfacf35b4fe13e0e}{tcg::point\_ops::angle}}(oDir, ovxPos -\/ ovxParentPos) * M\_180\_PI;}
\DoxyCodeLine{00575     \textcolor{keywordtype}{double} d = tcg::point\_ops::dist(ovxParentPos, ovxPos);}
\DoxyCodeLine{00576 }
\DoxyCodeLine{00577     \textcolor{keywordtype}{double} aDelta = vd.m\_params[\mbox{\hyperlink{struct_plastic_skeleton_vertex_deformation_ad86a0a561a86fe4fecafe375ce9b668aac7395a1a37dd81030a5a3c4b64c834f1}{SkVD::ANGLE}}]-\/>getValue(frame);}
\DoxyCodeLine{00578     \textcolor{keywordtype}{double} dDelta = vd.m\_params[\mbox{\hyperlink{struct_plastic_skeleton_vertex_deformation_ad86a0a561a86fe4fecafe375ce9b668aaa8d13a6740a3949b4c3a70fea675c70b}{SkVD::DISTANCE}}]-\/>getValue(frame);}
\DoxyCodeLine{00579 }
\DoxyCodeLine{00580     dvx.P() = deformedSkeleton.vertex(vParent).P() +}
\DoxyCodeLine{00581               (d + dDelta) * (\mbox{\hyperlink{class_t_rotation}{TRotation}}(a + aDelta) * dDir);}
\DoxyCodeLine{00582   \}}
\DoxyCodeLine{00583 }
\DoxyCodeLine{00584   \textcolor{comment}{// Finally, update children positions}}
\DoxyCodeLine{00585   \mbox{\hyperlink{structtcg_1_1list_1_1iterator}{PlasticSkeleton::vertex\_type::edges\_iterator}} et, eEnd(dvx.edgesEnd());}
\DoxyCodeLine{00586   \textcolor{keywordflow}{for} (et = dvx.edgesBegin(); et != eEnd; ++et) \{}
\DoxyCodeLine{00587     \textcolor{keywordtype}{int} vChild = deformedSkeleton.edge(*et).vertex(1);}
\DoxyCodeLine{00588     \textcolor{keywordflow}{if} (vChild == v) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00589 }
\DoxyCodeLine{00590     \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_a89c21cbdf7318f9e76f0391ce2927420}{updateBranchPositions}}(originalSkeleton, deformedSkeleton, frame, vChild);}
\DoxyCodeLine{00591   \}}
\DoxyCodeLine{00592 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00052}{Plastic\+Skeleton\+Vertex\+Deformation\+::\+ANGLE}}, \mbox{\hyperlink{l00309}{tcg\+::point\+\_\+ops\+::angle()}}, and \mbox{\hyperlink{l00053}{Plastic\+Skeleton\+Vertex\+Deformation\+::\+DISTANCE}}.

\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_acd1a0511d80c3cfabd07be4a6ae4a298}\label{class_plastic_skeleton_deformation_1_1_imp_acd1a0511d80c3cfabd07be4a6ae4a298}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!vertexDeformation@{vertexDeformation}}
\index{vertexDeformation@{vertexDeformation}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{vertexDeformation()}{vertexDeformation()}}
{\footnotesize\ttfamily \mbox{\hyperlink{struct_plastic_skeleton_vertex_deformation}{Sk\+VD}} \& Plastic\+Skeleton\+Deformation\+::\+Imp\+::vertex\+Deformation (\begin{DoxyParamCaption}\item[{const QString \&}]{name }\end{DoxyParamCaption}) const}


\begin{DoxyCode}{0}
\DoxyCodeLine{00363                                \{}
\DoxyCodeLine{00364   SkVDSet::const\_iterator vdt(\mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.find(name));}
\DoxyCodeLine{00365   assert(vdt != \mbox{\hyperlink{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}{m\_vds}}.end());}
\DoxyCodeLine{00366 }
\DoxyCodeLine{00367   \textcolor{keywordflow}{return} vdt-\/>m\_vd;}
\DoxyCodeLine{00368 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a0cc0fc45d621136e9bc57218dca90c89}\label{class_plastic_skeleton_deformation_1_1_imp_a0cc0fc45d621136e9bc57218dca90c89}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!m\_back@{m\_back}}
\index{m\_back@{m\_back}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{m\_back}{m\_back}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_plastic_skeleton_deformation}{Plastic\+Skeleton\+Deformation}}$\ast$ Plastic\+Skeleton\+Deformation\+::\+Imp\+::m\+\_\+back}



Back-\/pointer to the interface class. 

\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_aab7a0f7a3f56b3fa02378febd6dba110}\label{class_plastic_skeleton_deformation_1_1_imp_aab7a0f7a3f56b3fa02378febd6dba110}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!m\_grammar@{m\_grammar}}
\index{m\_grammar@{m\_grammar}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{m\_grammar}{m\_grammar}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_syntax_1_1_grammar}{TSyntax\+::\+Grammar}}$\ast$ Plastic\+Skeleton\+Deformation\+::\+Imp\+::m\+\_\+grammar}

The params\textquotesingle{} grammar. Weird though -\/ it\textquotesingle{}s a VERY occult requirement to TDouble\+Params... \mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_a851b848cf4f24ec1bef75c8280c7d0f8}\label{class_plastic_skeleton_deformation_1_1_imp_a851b848cf4f24ec1bef75c8280c7d0f8}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!m\_observers@{m\_observers}}
\index{m\_observers@{m\_observers}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{m\_observers}{m\_observers}}
{\footnotesize\ttfamily std\+::set$<$\mbox{\hyperlink{class_t_param_observer}{TParam\+Observer}} $\ast$$>$ Plastic\+Skeleton\+Deformation\+::\+Imp\+::m\+\_\+observers}



Set of the deformation\textquotesingle{}s observers. 

\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_add23c9f507c01add3f49ee42d6b272c8}\label{class_plastic_skeleton_deformation_1_1_imp_add23c9f507c01add3f49ee42d6b272c8}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!m\_skeletons@{m\_skeletons}}
\index{m\_skeletons@{m\_skeletons}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{m\_skeletons}{m\_skeletons}}
{\footnotesize\ttfamily Skeleton\+Set Plastic\+Skeleton\+Deformation\+::\+Imp\+::m\+\_\+skeletons}



Skeletons owned by the deformation. 

\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}\label{class_plastic_skeleton_deformation_1_1_imp_acd33d9098440f931e51300a659aa2f11}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!m\_skelIdsParam@{m\_skelIdsParam}}
\index{m\_skelIdsParam@{m\_skelIdsParam}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{m\_skelIdsParam}{m\_skelIdsParam}}
{\footnotesize\ttfamily TDouble\+ParamP Plastic\+Skeleton\+Deformation\+::\+Imp\+::m\+\_\+skel\+Ids\+Param}



Curve of skeleton ids by xsheet frame. 

\mbox{\Hypertarget{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}\label{class_plastic_skeleton_deformation_1_1_imp_acad53b379e32595a02679c1bb57c3f88}} 
\index{PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}!m\_vds@{m\_vds}}
\index{m\_vds@{m\_vds}!PlasticSkeletonDeformation::Imp@{PlasticSkeletonDeformation::Imp}}
\doxysubsubsection{\texorpdfstring{m\_vds}{m\_vds}}
{\footnotesize\ttfamily Sk\+VDSet Plastic\+Skeleton\+Deformation\+::\+Imp\+::m\+\_\+vds}



Container of vertex deformations. 



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/tnzext/plasticskeletondeformation.\+cpp\end{DoxyCompactItemize}
