\hypertarget{class_tool_utils_1_1_t_tool_undo}{}\doxysection{Tool\+Utils\+::TTool\+Undo Class Reference}
\label{class_tool_utils_1_1_t_tool_undo}\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
Inheritance diagram for Tool\+Utils\+::TTool\+Undo\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=10.000000cm]{class_tool_utils_1_1_t_tool_undo}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_acad5f2667c9ca5236ed2e7a8f9a2678e}{TTool\+Undo}} (\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$level, const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&frame\+Id, bool created\+Frame=false, bool created\+Level=false, const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&old\+Palette=0)
\item 
virtual QString \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_ab98f17830c8416168c15ddda68965c9d}{get\+Tool\+Name}} ()
\item 
QString \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_acb8bb9dd329c642d0c55169369a78d7c}{get\+History\+String}} () override
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_a65ddd6941f4c8b3a966b9f9da2b1aeb3}{insert\+Level\+And\+Frame\+If\+Needed}} () const
\item 
void \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_a701b97cddffd8b1bd34a410bf254fbf2}{remove\+Level\+And\+Frame\+If\+Needed}} () const
\item 
void \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_a600c6e8fa120e862d9a48c3665538b2c}{notify\+Image\+Changed}} () const
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_smart_pointer_t}{TXsh\+Simple\+LevelP}} \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_a125bbeeca279fa3f477a726288e1fd4f}{m\+\_\+level}}
\item 
\mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_a75a394cbe10e9d5b004cfd947afb7cc5}{m\+\_\+frame\+Id}}
\item 
int \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_abf6feea66c2b27f84248571cba00c530}{m\+\_\+row}}
\item 
int \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_abdf429a88e1c81986ccda123d8b7444a}{m\+\_\+col}}
\item 
bool \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_a4b7512482beb57f7b5ace43db9300306}{m\+\_\+is\+Editing\+Level}}
\item 
bool \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_a7f9418f55c16b92a7bc8adec3ba078f1}{m\+\_\+created\+Frame}}
\item 
bool \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_aed152afcdf3f8a7ffebdd94cae9ac2ff}{m\+\_\+created\+Level}}
\item 
bool \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_a68b4635d81a16aa183dde2be7df606dc}{m\+\_\+renumbered\+Level}}
\item 
std\+::vector$<$ \mbox{\hyperlink{struct_t_tool_1_1_cell_ops}{TTool\+::\+Cell\+Ops}} $>$ \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_ad963195e9f3d4a3c2425c7df09aabbc0}{m\+\_\+cells\+Data}}
\item 
std\+::vector$<$ \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} $>$ \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_a622cf23d8ef19bd975220e88e294b4d3}{m\+\_\+old\+Fids}}
\item 
std\+::vector$<$ \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} $>$ \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_a54c4e2f9e22717c62489e054d15b4f05}{m\+\_\+new\+Fids}}
\item 
\mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_ae48e4d822e689737f10216043063fc57}{m\+\_\+old\+Palette}}
\item 
std\+::string \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_aca799585da37e56c3b3776304ad7d71f}{m\+\_\+image\+Id}}
\end{DoxyCompactItemize}
\doxysubsection*{Static Protected Attributes}
\begin{DoxyCompactItemize}
\item 
static int \mbox{\hyperlink{class_tool_utils_1_1_t_tool_undo_a3706837f7d9ad0358e658da4d5d0d181}{m\+\_\+id\+Count}} = 0
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_acad5f2667c9ca5236ed2e7a8f9a2678e}\label{class_tool_utils_1_1_t_tool_undo_acad5f2667c9ca5236ed2e7a8f9a2678e}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!TToolUndo@{TToolUndo}}
\index{TToolUndo@{TToolUndo}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{TToolUndo()}{TToolUndo()}}
{\footnotesize\ttfamily Tool\+Utils\+::\+TTool\+Undo\+::\+TTool\+Undo (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_xsh_simple_level}{TXsh\+Simple\+Level}} $\ast$}]{level,  }\item[{const \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} \&}]{frame\+Id,  }\item[{bool}]{created\+Frame = {\ttfamily false},  }\item[{bool}]{created\+Level = {\ttfamily false},  }\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} \&}]{old\+Palette = {\ttfamily 0} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00455     : \mbox{\hyperlink{class_t_undo}{TUndo}}()}
\DoxyCodeLine{00456     , m\_level(level)}
\DoxyCodeLine{00457     , m\_frameId(frameId)}
\DoxyCodeLine{00458     , m\_oldPalette(oldPalette)}
\DoxyCodeLine{00459     , m\_col(-\/2)}
\DoxyCodeLine{00460     , m\_row(-\/1)}
\DoxyCodeLine{00461     , m\_isEditingLevel(\textcolor{keyword}{false})}
\DoxyCodeLine{00462     , m\_createdFrame(createdFrame)}
\DoxyCodeLine{00463     , m\_createdLevel(createdLevel)}
\DoxyCodeLine{00464     , m\_renumberedLevel(TTool::m\_isLevelRenumbererd)}
\DoxyCodeLine{00465     , m\_imageId(\textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{00466   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{00467   m\_isEditingLevel        = app-\/>getCurrentFrame()-\/>isEditingLevel();}
\DoxyCodeLine{00468   \textcolor{keywordflow}{if} (!m\_isEditingLevel) \{}
\DoxyCodeLine{00469     m\_col       = app-\/>getCurrentColumn()-\/>getColumnIndex();}
\DoxyCodeLine{00470     m\_row       = app-\/>getCurrentFrame()-\/>getFrameIndex();}
\DoxyCodeLine{00471     m\_cellsData = \mbox{\hyperlink{class_t_tool_a9345d88f41578058ccb2d6e681591c09}{TTool::m\_cellsData}};}
\DoxyCodeLine{00472   \}}
\DoxyCodeLine{00473   \textcolor{keywordflow}{if} (m\_renumberedLevel) \{}
\DoxyCodeLine{00474     m\_oldFids = TTool::m\_oldFids;}
\DoxyCodeLine{00475     m\_newFids = TTool::m\_newFids;}
\DoxyCodeLine{00476   \}}
\DoxyCodeLine{00477   \textcolor{keywordflow}{if} (createdFrame) \{}
\DoxyCodeLine{00478     m\_imageId = \textcolor{stringliteral}{"{}TToolUndo"{}} + std::to\_string(m\_idCount++);}
\DoxyCodeLine{00479     TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a124eae4cf370288f42c22b3477cb5163}{add}}(m\_imageId, level-\/>getFrame(frameId, \textcolor{keyword}{false}),}
\DoxyCodeLine{00480                                  \textcolor{keyword}{false});}
\DoxyCodeLine{00481   \}}
\DoxyCodeLine{00482 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_acc720ae277d977055ca02a6ece457bdd}\label{class_tool_utils_1_1_t_tool_undo_acc720ae277d977055ca02a6ece457bdd}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!````~TToolUndo@{$\sim$TToolUndo}}
\index{````~TToolUndo@{$\sim$TToolUndo}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{$\sim$TToolUndo()}{~TToolUndo()}}
{\footnotesize\ttfamily Tool\+Utils\+::\+TTool\+Undo\+::$\sim$\+TTool\+Undo (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00486                                \{}
\DoxyCodeLine{00487   TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_a57d63227dfe2532b0aed22c47113be66}{remove}}(m\_imageId);}
\DoxyCodeLine{00488 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_acb8bb9dd329c642d0c55169369a78d7c}\label{class_tool_utils_1_1_t_tool_undo_acb8bb9dd329c642d0c55169369a78d7c}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!getHistoryString@{getHistoryString}}
\index{getHistoryString@{getHistoryString}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{getHistoryString()}{getHistoryString()}}
{\footnotesize\ttfamily QString Tool\+Utils\+::\+TTool\+Undo\+::get\+History\+String (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_t_undo}{TUndo}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00179                                       \{}
\DoxyCodeLine{00180     \textcolor{keywordflow}{return} QObject::tr(\textcolor{stringliteral}{"{}\%1   Level : \%2  Frame : \%3"{}})}
\DoxyCodeLine{00181         .arg(getToolName())}
\DoxyCodeLine{00182         .arg(QString::fromStdWString(m\_level-\/>\mbox{\hyperlink{class_t_xsh_level_a3a59fb1bd3261baee4e889a9edbf0ae8}{getName}}()))}
\DoxyCodeLine{00183         .arg(QString::number(m\_frameId.getNumber()));}
\DoxyCodeLine{00184   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_ab98f17830c8416168c15ddda68965c9d}\label{class_tool_utils_1_1_t_tool_undo_ab98f17830c8416168c15ddda68965c9d}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!getToolName@{getToolName}}
\index{getToolName@{getToolName}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{getToolName()}{getToolName()}}
{\footnotesize\ttfamily virtual QString Tool\+Utils\+::\+TTool\+Undo\+::get\+Tool\+Name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00177 \{ \textcolor{keywordflow}{return} QString(\textcolor{stringliteral}{"{}Tool"{}}); \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_a65ddd6941f4c8b3a966b9f9da2b1aeb3}\label{class_tool_utils_1_1_t_tool_undo_a65ddd6941f4c8b3a966b9f9da2b1aeb3}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!insertLevelAndFrameIfNeeded@{insertLevelAndFrameIfNeeded}}
\index{insertLevelAndFrameIfNeeded@{insertLevelAndFrameIfNeeded}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{insertLevelAndFrameIfNeeded()}{insertLevelAndFrameIfNeeded()}}
{\footnotesize\ttfamily void Tool\+Utils\+::\+TTool\+Undo\+::insert\+Level\+And\+Frame\+If\+Needed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00492                                                            \{}
\DoxyCodeLine{00493   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{00494   \textcolor{keywordflow}{if} (m\_renumberedLevel) \{}
\DoxyCodeLine{00495     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh = app-\/>getCurrentScene()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_aaffd562eebbd8faba4caeaed69bfcc18}{getTopXsheet}}();}
\DoxyCodeLine{00496     std::vector<TXshChildLevel *> childLevels;}
\DoxyCodeLine{00497     ToolUtils::doUpdateXSheet(m\_level.getPointer(), m\_oldFids, m\_newFids, xsh,}
\DoxyCodeLine{00498                               childLevels);}
\DoxyCodeLine{00499     m\_level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_ad682afea2e389bdc6fa1c09e2b068b48}{renumber}}(m\_newFids);}
\DoxyCodeLine{00500     app-\/>getCurrentXsheet()-\/>notifyXsheetChanged();}
\DoxyCodeLine{00501   \}}
\DoxyCodeLine{00502   \textcolor{keywordflow}{if} (m\_createdLevel) \{}
\DoxyCodeLine{00503     \mbox{\hyperlink{class_t_level_set}{TLevelSet}} *levelSet = app-\/>getCurrentScene()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_ac1a8bf0d2cec4f59c87b0001991264b5}{getLevelSet}}();}
\DoxyCodeLine{00504     \textcolor{keywordflow}{if} (levelSet) \{}
\DoxyCodeLine{00505       levelSet-\/>insertLevel(m\_level.getPointer());}
\DoxyCodeLine{00506       app-\/>getCurrentScene()-\/>notifyCastChange();}
\DoxyCodeLine{00507     \}}
\DoxyCodeLine{00508   \}}
\DoxyCodeLine{00509   \textcolor{keywordflow}{if} (m\_createdFrame) \{}
\DoxyCodeLine{00510     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh = app-\/>getCurrentXsheet()-\/>getXsheet();}
\DoxyCodeLine{00511     \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} img  = TImageCache::instance()-\/>\mbox{\hyperlink{class_t_image_cache_aea3ac2752efd6fa9689f5a7c1e895e41}{get}}(m\_imageId, \textcolor{keyword}{false});}
\DoxyCodeLine{00512     m\_level-\/>setFrame(m\_frameId, img);}
\DoxyCodeLine{00513     \textcolor{keywordflow}{if} (!m\_isEditingLevel) \{}
\DoxyCodeLine{00514       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_tool_1_1_cell_ops}{TTool::CellOps}} \&cellOps : m\_cellsData) \{}
\DoxyCodeLine{00515         \mbox{\hyperlink{class_t_xsh_cell}{TXshCell}} cell;}
\DoxyCodeLine{00516         \textcolor{keywordflow}{if} (cellOps.type == TTool::CellOps::BlankToExisting)}
\DoxyCodeLine{00517           cell = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(cellOps.r0 -\/ 1, m\_col);}
\DoxyCodeLine{00518         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00519           cell = \mbox{\hyperlink{class_t_xsh_cell}{TXshCell}}(m\_level.getPointer(), m\_frameId);}
\DoxyCodeLine{00520         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} r = cellOps.r0; r <= cellOps.r1; r++)}
\DoxyCodeLine{00521           xsh-\/>setCell(r, m\_col, cell);}
\DoxyCodeLine{00522       \}}
\DoxyCodeLine{00523     \}}
\DoxyCodeLine{00524     app-\/>getCurrentLevel()-\/>notifyLevelChange();}
\DoxyCodeLine{00525   \}}
\DoxyCodeLine{00526 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_a600c6e8fa120e862d9a48c3665538b2c}\label{class_tool_utils_1_1_t_tool_undo_a600c6e8fa120e862d9a48c3665538b2c}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!notifyImageChanged@{notifyImageChanged}}
\index{notifyImageChanged@{notifyImageChanged}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{notifyImageChanged()}{notifyImageChanged()}}
{\footnotesize\ttfamily void Tool\+Utils\+::\+TTool\+Undo\+::notify\+Image\+Changed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00572                                                   \{}
\DoxyCodeLine{00573   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{00574 }
\DoxyCodeLine{00575   \mbox{\hyperlink{class_t_xsh_simple_level}{TXshSimpleLevel}} *currentSl = 0;}
\DoxyCodeLine{00576   \mbox{\hyperlink{class_t_frame_id}{TFrameId}} currentFrameId;}
\DoxyCodeLine{00577   \textcolor{keywordflow}{if} (app-\/>getCurrentFrame()-\/>isEditingLevel()) \{}
\DoxyCodeLine{00578     \mbox{\hyperlink{class_t_xsh_level}{TXshLevel}} *xl = app-\/>getCurrentLevel()-\/>getLevel();}
\DoxyCodeLine{00579     \textcolor{keywordflow}{if} (!xl) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00580     currentSl      = xl-\/>\mbox{\hyperlink{class_t_xsh_level_a023065559cff76164ecb6344c586ba27}{getSimpleLevel}}();}
\DoxyCodeLine{00581     currentFrameId = app-\/>getCurrentFrame()-\/>getFid();}
\DoxyCodeLine{00582   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00583     \textcolor{keywordtype}{int} row = app-\/>getCurrentFrame()-\/>getFrame();}
\DoxyCodeLine{00584     \textcolor{keywordtype}{int} col = app-\/>getCurrentColumn()-\/>getColumnIndex();}
\DoxyCodeLine{00585     \textcolor{keywordflow}{if} (col < 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00586     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh = app-\/>getCurrentXsheet()-\/>getXsheet();}
\DoxyCodeLine{00587     \textcolor{keywordflow}{if} (!xsh) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00588     \mbox{\hyperlink{class_t_xsh_cell}{TXshCell}} cell  = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(row, col);}
\DoxyCodeLine{00589     currentSl      = cell.\mbox{\hyperlink{class_t_xsh_cell_a8898cc47eba24e59477bfba8e2511f1d}{getSimpleLevel}}();}
\DoxyCodeLine{00590     currentFrameId = cell.\mbox{\hyperlink{class_t_xsh_cell_a5a1965b96c2c698d6f0fb42a80c03406}{getFrameId}}();}
\DoxyCodeLine{00591   \}}
\DoxyCodeLine{00592   \textcolor{keywordflow}{if} (currentSl == m\_level.getPointer() \&\& currentFrameId == m\_frameId) \{}
\DoxyCodeLine{00593     \mbox{\hyperlink{class_t_tool}{TTool}} *tool = app-\/>getCurrentTool()-\/>getTool();}
\DoxyCodeLine{00594     \textcolor{keywordflow}{if} (tool) tool-\/>\mbox{\hyperlink{class_t_tool_aaf1e021290e74c1b085e4b095668e1ed}{onImageChanged}}();}
\DoxyCodeLine{00595   \}}
\DoxyCodeLine{00596 }
\DoxyCodeLine{00597   IconGenerator::instance()-\/>invalidate(m\_level.getPointer(), m\_frameId);}
\DoxyCodeLine{00598   IconGenerator::instance()-\/>invalidateSceneIcon();}
\DoxyCodeLine{00599 }
\DoxyCodeLine{00600   \textcolor{keywordflow}{if} (m\_level \&\& m\_level-\/>\mbox{\hyperlink{class_t_xsh_level_a1a147f1e970a62120c0bbaf0020a8932}{getType}}() == PLI\_XSHLEVEL) \{}
\DoxyCodeLine{00601     std::string \textcolor{keywordtype}{id} = m\_level-\/>getImageId(m\_frameId) + \textcolor{stringliteral}{"{}\_rasterized"{}};}
\DoxyCodeLine{00602     ImageManager::instance()-\/>\mbox{\hyperlink{class_image_manager_a34bdaa25c84cd79a7518dbd233a947f4}{invalidate}}(\textcolor{keywordtype}{id});}
\DoxyCodeLine{00603   \}}
\DoxyCodeLine{00604 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_a701b97cddffd8b1bd34a410bf254fbf2}\label{class_tool_utils_1_1_t_tool_undo_a701b97cddffd8b1bd34a410bf254fbf2}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!removeLevelAndFrameIfNeeded@{removeLevelAndFrameIfNeeded}}
\index{removeLevelAndFrameIfNeeded@{removeLevelAndFrameIfNeeded}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{removeLevelAndFrameIfNeeded()}{removeLevelAndFrameIfNeeded()}}
{\footnotesize\ttfamily void Tool\+Utils\+::\+TTool\+Undo\+::remove\+Level\+And\+Frame\+If\+Needed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00530                                                            \{}
\DoxyCodeLine{00531   \mbox{\hyperlink{class_t_application}{TTool::Application}} *app = TTool::getApplication();}
\DoxyCodeLine{00532   \textcolor{keywordflow}{if} (m\_createdFrame) \{}
\DoxyCodeLine{00533     m\_level-\/>eraseFrame(m\_frameId);}
\DoxyCodeLine{00534     \textcolor{keywordflow}{if} (!m\_isEditingLevel) \{}
\DoxyCodeLine{00535       \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh = app-\/>getCurrentXsheet()-\/>getXsheet();}
\DoxyCodeLine{00536       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_tool_1_1_cell_ops}{TTool::CellOps}} \&cellOps : m\_cellsData) \{}
\DoxyCodeLine{00537         \mbox{\hyperlink{class_t_xsh_cell}{TXshCell}} cell;}
\DoxyCodeLine{00538         \textcolor{keywordflow}{if} (cellOps.type == TTool::CellOps::ExistingToNew)}
\DoxyCodeLine{00539           cell = xsh-\/>\mbox{\hyperlink{class_t_xsheet_a1ae81edf03bc7527176c84478c350f57}{getCell}}(cellOps.r0 -\/ 1, m\_col);}
\DoxyCodeLine{00540         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} r = cellOps.r0; r <= cellOps.r1; r++)}
\DoxyCodeLine{00541           xsh-\/>setCell(r, m\_col, cell);}
\DoxyCodeLine{00542       \}}
\DoxyCodeLine{00543     \}}
\DoxyCodeLine{00544     \textcolor{keywordflow}{if} (m\_createdLevel) \{}
\DoxyCodeLine{00545       \textcolor{comment}{// butta il livello}}
\DoxyCodeLine{00546       \mbox{\hyperlink{class_t_level_set}{TLevelSet}} *levelSet = app-\/>getCurrentScene()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_ac1a8bf0d2cec4f59c87b0001991264b5}{getLevelSet}}();}
\DoxyCodeLine{00547       \textcolor{keywordflow}{if} (levelSet) \{}
\DoxyCodeLine{00548         levelSet-\/>removeLevel(m\_level.getPointer());}
\DoxyCodeLine{00549         app-\/>getCurrentScene()-\/>notifyCastChange();}
\DoxyCodeLine{00550       \}}
\DoxyCodeLine{00551     \}}
\DoxyCodeLine{00552     app-\/>getCurrentLevel()-\/>notifyLevelChange();}
\DoxyCodeLine{00553   \}}
\DoxyCodeLine{00554   \textcolor{keywordflow}{if} (m\_oldPalette.getPointer()) \{}
\DoxyCodeLine{00555     m\_level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_a9aea4f8e34caef293d5e5c7694047564}{getPalette}}()-\/>\mbox{\hyperlink{class_t_palette_a319e848e06467e458214bba1132b49a9}{assign}}(m\_oldPalette-\/>\mbox{\hyperlink{class_t_palette_abc3ef5824d89e65687b32c530cf25325}{clone}}());}
\DoxyCodeLine{00556     app-\/>getPaletteController()}
\DoxyCodeLine{00557         -\/>getCurrentLevelPalette()}
\DoxyCodeLine{00558         -\/>notifyPaletteChanged();}
\DoxyCodeLine{00559   \}}
\DoxyCodeLine{00560   \textcolor{keywordflow}{if} (m\_renumberedLevel) \{}
\DoxyCodeLine{00561     \mbox{\hyperlink{class_t_xsheet}{TXsheet}} *xsh = app-\/>getCurrentScene()-\/>getScene()-\/>\mbox{\hyperlink{class_toonz_scene_aaffd562eebbd8faba4caeaed69bfcc18}{getTopXsheet}}();}
\DoxyCodeLine{00562     std::vector<TXshChildLevel *> childLevels;}
\DoxyCodeLine{00563     ToolUtils::doUpdateXSheet(m\_level.getPointer(), m\_newFids, m\_oldFids, xsh,}
\DoxyCodeLine{00564                               childLevels);}
\DoxyCodeLine{00565     m\_level-\/>\mbox{\hyperlink{class_t_xsh_simple_level_ad682afea2e389bdc6fa1c09e2b068b48}{renumber}}(m\_oldFids);}
\DoxyCodeLine{00566     app-\/>getCurrentXsheet()-\/>notifyXsheetChanged();}
\DoxyCodeLine{00567   \}}
\DoxyCodeLine{00568 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_ad963195e9f3d4a3c2425c7df09aabbc0}\label{class_tool_utils_1_1_t_tool_undo_ad963195e9f3d4a3c2425c7df09aabbc0}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_cellsData@{m\_cellsData}}
\index{m\_cellsData@{m\_cellsData}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_cellsData}{m\_cellsData}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{struct_t_tool_1_1_cell_ops}{TTool\+::\+Cell\+Ops}}$>$ Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+cells\+Data\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_abdf429a88e1c81986ccda123d8b7444a}\label{class_tool_utils_1_1_t_tool_undo_abdf429a88e1c81986ccda123d8b7444a}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_col@{m\_col}}
\index{m\_col@{m\_col}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_col}{m\_col}}
{\footnotesize\ttfamily int Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+col\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_a7f9418f55c16b92a7bc8adec3ba078f1}\label{class_tool_utils_1_1_t_tool_undo_a7f9418f55c16b92a7bc8adec3ba078f1}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_createdFrame@{m\_createdFrame}}
\index{m\_createdFrame@{m\_createdFrame}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_createdFrame}{m\_createdFrame}}
{\footnotesize\ttfamily bool Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+created\+Frame\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_aed152afcdf3f8a7ffebdd94cae9ac2ff}\label{class_tool_utils_1_1_t_tool_undo_aed152afcdf3f8a7ffebdd94cae9ac2ff}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_createdLevel@{m\_createdLevel}}
\index{m\_createdLevel@{m\_createdLevel}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_createdLevel}{m\_createdLevel}}
{\footnotesize\ttfamily bool Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+created\+Level\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_a75a394cbe10e9d5b004cfd947afb7cc5}\label{class_tool_utils_1_1_t_tool_undo_a75a394cbe10e9d5b004cfd947afb7cc5}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_frameId@{m\_frameId}}
\index{m\_frameId@{m\_frameId}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_frameId}{m\_frameId}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+frame\+Id\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_a3706837f7d9ad0358e658da4d5d0d181}\label{class_tool_utils_1_1_t_tool_undo_a3706837f7d9ad0358e658da4d5d0d181}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_idCount@{m\_idCount}}
\index{m\_idCount@{m\_idCount}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_idCount}{m\_idCount}}
{\footnotesize\ttfamily int Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+id\+Count = 0\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_aca799585da37e56c3b3776304ad7d71f}\label{class_tool_utils_1_1_t_tool_undo_aca799585da37e56c3b3776304ad7d71f}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_imageId@{m\_imageId}}
\index{m\_imageId@{m\_imageId}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_imageId}{m\_imageId}}
{\footnotesize\ttfamily std\+::string Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+image\+Id\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_a4b7512482beb57f7b5ace43db9300306}\label{class_tool_utils_1_1_t_tool_undo_a4b7512482beb57f7b5ace43db9300306}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_isEditingLevel@{m\_isEditingLevel}}
\index{m\_isEditingLevel@{m\_isEditingLevel}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_isEditingLevel}{m\_isEditingLevel}}
{\footnotesize\ttfamily bool Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+is\+Editing\+Level\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_a125bbeeca279fa3f477a726288e1fd4f}\label{class_tool_utils_1_1_t_tool_undo_a125bbeeca279fa3f477a726288e1fd4f}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_level@{m\_level}}
\index{m\_level@{m\_level}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_level}{m\_level}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_smart_pointer_t}{TXsh\+Simple\+LevelP}} Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+level\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_a54c4e2f9e22717c62489e054d15b4f05}\label{class_tool_utils_1_1_t_tool_undo_a54c4e2f9e22717c62489e054d15b4f05}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_newFids@{m\_newFids}}
\index{m\_newFids@{m\_newFids}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_newFids}{m\_newFids}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}}$>$ Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+new\+Fids\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_a622cf23d8ef19bd975220e88e294b4d3}\label{class_tool_utils_1_1_t_tool_undo_a622cf23d8ef19bd975220e88e294b4d3}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_oldFids@{m\_oldFids}}
\index{m\_oldFids@{m\_oldFids}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_oldFids}{m\_oldFids}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}}$>$ Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+old\+Fids\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_ae48e4d822e689737f10216043063fc57}\label{class_tool_utils_1_1_t_tool_undo_ae48e4d822e689737f10216043063fc57}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_oldPalette@{m\_oldPalette}}
\index{m\_oldPalette@{m\_oldPalette}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_oldPalette}{m\_oldPalette}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_smart_pointer_t}{TPaletteP}} Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+old\+Palette\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_a68b4635d81a16aa183dde2be7df606dc}\label{class_tool_utils_1_1_t_tool_undo_a68b4635d81a16aa183dde2be7df606dc}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_renumberedLevel@{m\_renumberedLevel}}
\index{m\_renumberedLevel@{m\_renumberedLevel}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_renumberedLevel}{m\_renumberedLevel}}
{\footnotesize\ttfamily bool Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+renumbered\+Level\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_tool_utils_1_1_t_tool_undo_abf6feea66c2b27f84248571cba00c530}\label{class_tool_utils_1_1_t_tool_undo_abf6feea66c2b27f84248571cba00c530}} 
\index{ToolUtils::TToolUndo@{ToolUtils::TToolUndo}!m\_row@{m\_row}}
\index{m\_row@{m\_row}!ToolUtils::TToolUndo@{ToolUtils::TToolUndo}}
\doxysubsubsection{\texorpdfstring{m\_row}{m\_row}}
{\footnotesize\ttfamily int Tool\+Utils\+::\+TTool\+Undo\+::m\+\_\+row\hspace{0.3cm}{\ttfamily [protected]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/tools/toolutils.\+h\item 
E\+:/opentoonz/toonz/sources/tnztools/toolutils.\+cpp\end{DoxyCompactItemize}
