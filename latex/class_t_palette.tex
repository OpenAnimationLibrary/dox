\hypertarget{class_t_palette}{}\doxysection{TPalette Class Reference}
\label{class_t_palette}\index{TPalette@{TPalette}}


The class representing a Toonz palette object.  




{\ttfamily \#include $<$tpalette.\+h$>$}

Inheritance diagram for TPalette\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_t_palette}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{class_t_palette_1_1_page}{Page}}
\begin{DoxyCompactList}\small\item\em A palette page is a restricted view of a palette instance. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_t_palette}{TPalette}} $\ast$ \mbox{\hyperlink{class_t_palette_abc3ef5824d89e65687b32c530cf25325}{clone}} () const
\begin{DoxyCompactList}\small\item\em Allocates a {\itshape new} copy of this palette instance. \end{DoxyCompactList}\item 
std\+::wstring \mbox{\hyperlink{class_t_palette_ad3199523465a1961c1564a82db46b451}{get\+Global\+Name}} () const
\begin{DoxyCompactList}\small\item\em Returns the name of the palette object. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_a0d1a5c3b332f133235f6fd758d22f683}{set\+Global\+Name}} (std\+::wstring name)
\begin{DoxyCompactList}\small\item\em Assigns the name of the palette. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_a382fa102abee4e69e386cb5a4d8d5184}{set\+Dirty\+Flag}} (bool dirty\+Flag)
\item 
bool \mbox{\hyperlink{class_t_palette_a4e573ec80c4779bcdb543e4b743a8c34}{get\+Dirty\+Flag}} ()
\item 
\mbox{\hyperlink{class_t_color_style}{TColor\+Style}} $\ast$ \mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{get\+Style}} (int style\+Id) const
\item 
int \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{get\+Style\+Count}} () const
\begin{DoxyCompactList}\small\item\em Returns the number of the color styles in the palette. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_t_palette_a403b73bd6dc6e600bd15252a9c1d2dfe}{get\+Style\+In\+Pages\+Count}} () const
\begin{DoxyCompactList}\small\item\em Returns the number of styles contained in palette pages. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_t_palette_aa3db2bd45a8e8a7ec488144684923b0a}{get\+First\+Unpaged\+Style}} () const
\item 
int \mbox{\hyperlink{class_t_palette_a43a27667c3b3583b2b3e1a9f307e7b42}{add\+Style}} (\mbox{\hyperlink{class_t_color_style}{TColor\+Style}} $\ast$style)
\item 
int \mbox{\hyperlink{class_t_palette_af1561219d1a6936510ac1ef9d705e52d}{add\+Style}} (const TPixel\+RGBM32 \&color)
\item 
void \mbox{\hyperlink{class_t_palette_ab9369e7992a6db74a33b7e5094071121}{set\+Style}} (int style\+Id, \mbox{\hyperlink{class_t_color_style}{TColor\+Style}} $\ast$style)
\begin{DoxyCompactList}\small\item\em Replaces the style with the specified style id. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_ae6b45fab15ad86f01342b3e7855502f6}{set\+Style}} (int style\+Id, const TPixel\+RGBM32 \&color)
\item 
int \mbox{\hyperlink{class_t_palette_afd211cadf0f047450bc31897f858fa73}{get\+Page\+Count}} () const
\begin{DoxyCompactList}\small\item\em specified style id. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_t_palette_1_1_page}{Page}} $\ast$ \mbox{\hyperlink{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}{get\+Page}} (int page\+Index)
\item 
const \mbox{\hyperlink{class_t_palette_1_1_page}{Page}} $\ast$ \mbox{\hyperlink{class_t_palette_a19de22cf05c7052997008e6693294893}{get\+Page}} (int page\+Index) const
\begin{DoxyCompactList}\small\item\em Const version of \mbox{\hyperlink{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}{get\+Page(int)}}. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_t_palette_1_1_page}{Page}} $\ast$ \mbox{\hyperlink{class_t_palette_a77258e62bbb8a9f60e4aa5e6ea0e862a}{add\+Page}} (std\+::wstring name)
\begin{DoxyCompactList}\small\item\em Creates a new page with the specified name. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_a6a18830b8f209aac7c13bccfe88b19e4}{erase\+Page}} (int index)
\begin{DoxyCompactList}\small\item\em Deletes the {\itshape index-\/th} page. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_ab6c28b4d7f325bef02d347473d4daacb}{move\+Page}} (\mbox{\hyperlink{class_t_palette_1_1_page}{Page}} $\ast$page, int dst\+Page\+Index)
\item 
\mbox{\hyperlink{class_t_palette_1_1_page}{Page}} $\ast$ \mbox{\hyperlink{class_t_palette_ae8566a5ffa9e69be120003ad4b69078d}{get\+Style\+Page}} (int style\+Id) const
\begin{DoxyCompactList}\small\item\em Returns the page containing the specified {\itshape style\+Id}. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_t_palette_ab0bf5c4fdd9cd3428819ce594299627d}{get\+Closest\+Style}} (const TPixel\+RGBM32 \&color) const
\item 
void \mbox{\hyperlink{class_t_palette_ad4c4db7647acbcccbd698e1ae0655b43}{load\+Data}} (\mbox{\hyperlink{class_t_i_stream}{TIStream}} \&is) override
\begin{DoxyCompactList}\small\item\em I/O palette save function. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_a30dcdbafb77d943fbc8b712625f4f3d2}{save\+Data}} (\mbox{\hyperlink{class_t_o_stream}{TOStream}} \&os) override
\begin{DoxyCompactList}\small\item\em I/O palette load function. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_t_palette_a6a8a0879cdbd83ecdcf4c7599e093524}{get\+Version}} () const
\begin{DoxyCompactList}\small\item\em Returns the palette\textquotesingle{}s version number. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_a8afe4a624111185995b5594ca03ec32d}{set\+Version}} (int v)
\begin{DoxyCompactList}\small\item\em Sets the palette\textquotesingle{}s version number. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_a807070f5c3f7033531f455f08ee489c4}{set\+Ref\+Level\+Fids}} (const std\+::vector$<$ \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} $>$ fids, bool specified)
\item 
std\+::vector$<$ \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} $>$ \mbox{\hyperlink{class_t_palette_aeda302f41529ee532096ecef117bdf7d}{get\+Ref\+Level\+Fids}} ()
\item 
void \mbox{\hyperlink{class_t_palette_a319e848e06467e458214bba1132b49a9}{assign}} (const \mbox{\hyperlink{class_t_palette}{TPalette}} $\ast$src, bool is\+From\+Studio\+Palette=false)
\item 
void \mbox{\hyperlink{class_t_palette_a705d1d02aa6a88e4da4ead66c9e838aa}{merge}} (const \mbox{\hyperlink{class_t_palette}{TPalette}} $\ast$src, bool is\+From\+Studio\+Palette=false)
\item 
void \mbox{\hyperlink{class_t_palette_a988c1603b1f87b4d3e26195781574658}{set\+Ask\+Overwrite\+Flag}} (bool ask\+Overwrite\+Flag)
\item 
bool \mbox{\hyperlink{class_t_palette_acef775ca72db90dfdebb0dcad53a3af2}{get\+Ask\+Overwrite\+Flag}} ()
\begin{DoxyCompactList}\small\item\em Returns the ask-\/overwrite flag. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_a609c029285f223f5bc116c5e1f6ed358}{set\+Is\+Cleanup\+Palette}} (bool on)
\begin{DoxyCompactList}\small\item\em Sets the palette\textquotesingle{}s identity as a cleanup palette. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_t_palette_a8160207d0a98de8a562c4339aa648ed4}{is\+Cleanup\+Palette}} () const
\begin{DoxyCompactList}\small\item\em Returns whether this is a cleanup palette. \end{DoxyCompactList}\item 
const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \& \mbox{\hyperlink{class_t_palette_ac3e08b7fe4ac6f2cb16d195786067108}{get\+Ref\+Img}} () const
\item 
void \mbox{\hyperlink{class_t_palette_a971fd2aac3c14754d6cdcb0679cf6893}{set\+Ref\+Img}} (const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \&img)
\item 
const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \mbox{\hyperlink{class_t_palette_a7eda1d7f3a27e8e90d0c12faaedaf5a6}{get\+Ref\+Img\+Path}} () const
\begin{DoxyCompactList}\small\item\em built or modified using this palette. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_a3009b4c976d9458d71dca9ea176bd7e1}{set\+Ref\+Img\+Path}} (const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&fp)
\begin{DoxyCompactList}\small\item\em Sets the path filename of the reference image. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_t_palette_ab93ce6de2d1138d6c6946e1a3e317e04}{is\+Animated}} () const
\item 
int \mbox{\hyperlink{class_t_palette_a7fd9f134eeffe1fa9ca39ee3fb6ad1b4}{get\+Frame}} () const
\begin{DoxyCompactList}\small\item\em Returns the index of the current frame. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_aca7d99a4af59ffaed0ead1f8700c2edc}{set\+Frame}} (int frame)
\begin{DoxyCompactList}\small\item\em Sets the index of the current frame. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_t_palette_abc7a1661819318b6c4b45a700056c8f8}{is\+Keyframe}} (int style\+Id, int frame) const
\item 
int \mbox{\hyperlink{class_t_palette_a84cf99f9fef176cf5981425b493285a2}{get\+Keyframe\+Count}} (int style\+Id) const
\begin{DoxyCompactList}\small\item\em Returns the keyframes count in style\+Id\textquotesingle{}s animation. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_t_palette_ae3433802d3bc4cbf9e8848f74c11cbe5}{get\+Keyframe}} (int style\+Id, int index) const
\item 
void \mbox{\hyperlink{class_t_palette_aaf6467771b2ec40b6751295985fdd687}{set\+Keyframe}} (int style\+Id, int frame)
\item 
void \mbox{\hyperlink{class_t_palette_a36d0291b604c5ecb35c565c6d81c7ce8}{clear\+Keyframe}} (int style\+Id, int frame)
\begin{DoxyCompactList}\small\item\em animation. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_t_palette_ac7b1cee99b5f1961be1fc2e821bc2b8b}{get\+Shortcut\+Value}} (int key) const
\begin{DoxyCompactList}\small\item\em animation. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_t_palette_a2f74093e079ad1c423f9bd62bc00faf1}{get\+Style\+Shortcut}} (int style\+Id) const
\item 
void \mbox{\hyperlink{class_t_palette_a2e4fc32a08028cbcc65c9a3897efa80d}{set\+Shortcut\+Value}} (int key, int style\+Id)
\begin{DoxyCompactList}\small\item\em Associates the specified key to a style\+Id. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_a49d4f02fb0810c659887bc4e2c5bc3a0}{set\+Palette\+Name}} (std\+::wstring name)
\begin{DoxyCompactList}\small\item\em Sets the name of the palette. \end{DoxyCompactList}\item 
std\+::wstring \mbox{\hyperlink{class_t_palette_af0bb56df19af40d1a729482efc85f492}{get\+Palette\+Name}} () const
\begin{DoxyCompactList}\small\item\em Returns the name of the palette. \end{DoxyCompactList}\item 
QMutex $\ast$ \mbox{\hyperlink{class_t_palette_a3974fff5698333b742c0b0b2f58aee37}{mutex}} ()
\begin{DoxyCompactList}\small\item\em Returns the palette\textquotesingle{}s mutex. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_t_palette_a4a66ac047e12676ed6038f1261743dde}{is\+Locked}} () const
\begin{DoxyCompactList}\small\item\em Returns whether the palette is locked. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_t_palette_a0365e562643620b90f7477ccf70b8411}{set\+Is\+Locked}} (bool lock)
\item 
bool \mbox{\hyperlink{class_t_palette_a9cd803f2fbda78d541ea7c9cc1afc8b4}{has\+Picked\+Pos\+Style}} ()
\item 
void \mbox{\hyperlink{class_t_palette_aba372a4be1511bffcf54d99ea8d58773}{next\+Shortcut\+Scope}} (bool invert)
\item 
void \mbox{\hyperlink{class_t_palette_a5771815e1daa519b6bbd6cd284c3bc26}{set\+Current\+Style\+Id}} (int id)
\item 
int \mbox{\hyperlink{class_t_palette_a447462857fa4be53f7d67f95b7c059bf}{get\+Current\+Style\+Id}} () const
\item 
bool \mbox{\hyperlink{class_t_palette_ac3646c822ac89b3a44781322582e86ec}{get\+Fx\+Rects}} (const \mbox{\hyperlink{class_t_rect_t}{TRect}} \&rect, \mbox{\hyperlink{class_t_rect_t}{TRect}} \&rect\+In, \mbox{\hyperlink{class_t_rect_t}{TRect}} \&rect\+Out)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{class_t_palette_a55d9b8d3bfcb9690abd6bb1e2955ed0e}{set\+Root\+Dir}} (const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&fp)
\item 
\mbox{\Hypertarget{class_t_palette_a8d05f2254f6ca5d42d8feaff28072082}\label{class_t_palette_a8d05f2254f6ca5d42d8feaff28072082}} 
static \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} {\bfseries get\+Root\+Dir} ()
\begin{DoxyCompactList}\small\item\em fp/textures. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Friends}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{class_t_palette_a66d145c56e1747e0aecb5309042ab183}{Page}}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
The class representing a Toonz palette object. 

\begin{DoxyParagraph}{Rationale}
A palette is a collection of {\itshape color styles} that adds a level of indirection on color selections when drawing certain graphical objects. ~\newline
 Palette-\/based objects store {\itshape style identifiers} into an associated palette object, rather than the colors directly. When a color needs to be accessed, the palette objects is queried for a {\itshape style id}, and the associated {\itshape style} is returned. ~\newline
 A \mbox{\hyperlink{class_t_color_style}{TColor\+Style}} instance generalizes the notion of {\itshape color}, providing the ability to reduce a style instance to a color, {\itshape and} specialized drawing functions for {\itshape vector graphics} objects.
\end{DoxyParagraph}
\begin{DoxyParagraph}{Reserved colors}
A palette object has two fixed {\itshape reserved} styles -\/ which {\itshape cannot be removed} -\/ at indexes {\ttfamily 0} and \textbackslash{}p1. Index {\ttfamily 0} is reserved for the {\bfseries{transparent}} color. Index {\ttfamily 1} is reserved for the {\bfseries{ink}} color, initialized by default to black.
\end{DoxyParagraph}
\begin{DoxyParagraph}{Syntax}
A palette is supposedly created {\bfseries{on the heap}}, to the point that, {\itshape in current implementation}, copy and assignment are {\itshape forbidden}. This behavior is somewhat inconsistent since a palette {\bfseries{is}} currently {\itshape clonable} and {\itshape assignable} with the appropriate functions. Normalization to common C++ syntax should be enforced ASAP.
\end{DoxyParagraph}
\begin{DoxySeeAlso}{See also}
The \mbox{\hyperlink{class_t_color_style}{TColor\+Style}} class. 
\end{DoxySeeAlso}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_t_palette_a24634a99a760f66c61d06b9ed7af32c3}\label{class_t_palette_a24634a99a760f66c61d06b9ed7af32c3}} 
\index{TPalette@{TPalette}!TPalette@{TPalette}}
\index{TPalette@{TPalette}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{TPalette()}{TPalette()}}
{\footnotesize\ttfamily TPalette\+::\+TPalette (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00241     : m\_version(0)}
\DoxyCodeLine{00242     , m\_isCleanupPalette(\textcolor{keyword}{false})}
\DoxyCodeLine{00243     , m\_currentFrame(-\/1)}
\DoxyCodeLine{00244     , m\_dirtyFlag(\textcolor{keyword}{false})}
\DoxyCodeLine{00245     , m\_mutex(QMutex::Recursive)}
\DoxyCodeLine{00246     , m\_isLocked(\textcolor{keyword}{false})}
\DoxyCodeLine{00247     , m\_askOverwriteFlag(\textcolor{keyword}{false})}
\DoxyCodeLine{00248     , m\_shortcutScopeIndex(0)}
\DoxyCodeLine{00249     , m\_currentStyleId(1) \{}
\DoxyCodeLine{00250   QString tempName(QObject::tr(\textcolor{stringliteral}{"{}colors"{}}));}
\DoxyCodeLine{00251   std::wstring pageName = tempName.toStdWString();}
\DoxyCodeLine{00252   Page *page            = \mbox{\hyperlink{class_t_palette_a77258e62bbb8a9f60e4aa5e6ea0e862a}{addPage}}(pageName);}
\DoxyCodeLine{00253   page-\/>addStyle(TPixel32(255, 255, 255, 0));}
\DoxyCodeLine{00254   page-\/>addStyle(TPixel32(0, 0, 0, 255));}
\DoxyCodeLine{00255   \mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(0)-\/>\mbox{\hyperlink{class_t_color_style_aeb25e0ae1708d473bd551b0d0c9bf4a9}{setName}}(L\textcolor{stringliteral}{"{}color\_0"{}});}
\DoxyCodeLine{00256   \mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(1)-\/>\mbox{\hyperlink{class_t_color_style_aeb25e0ae1708d473bd551b0d0c9bf4a9}{setName}}(L\textcolor{stringliteral}{"{}color\_1"{}});}
\DoxyCodeLine{00257 }
\DoxyCodeLine{00258   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 10; i++) m\_shortcuts[\textcolor{charliteral}{'0'} + i] = i;}
\DoxyCodeLine{00259 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_a0ada9e7d0aa5bd801782ecbcca868ca0}\label{class_t_palette_a0ada9e7d0aa5bd801782ecbcca868ca0}} 
\index{TPalette@{TPalette}!````~TPalette@{$\sim$TPalette}}
\index{````~TPalette@{$\sim$TPalette}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{$\sim$TPalette()}{~TPalette()}}
{\footnotesize\ttfamily TPalette\+::$\sim$\+TPalette (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00263                     \{}
\DoxyCodeLine{00264   std::set<TColorStyle *> table;}
\DoxyCodeLine{00265   \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{00266   \textcolor{keywordflow}{for} (i = 0; i < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}(); i++) \{}
\DoxyCodeLine{00267     assert(table.find(\mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(i)) == table.end());}
\DoxyCodeLine{00268     table.insert(\mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(i));}
\DoxyCodeLine{00269   \}}
\DoxyCodeLine{00270   clearPointerContainer(m\_pages);}
\DoxyCodeLine{00271 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_t_palette_a77258e62bbb8a9f60e4aa5e6ea0e862a}\label{class_t_palette_a77258e62bbb8a9f60e4aa5e6ea0e862a}} 
\index{TPalette@{TPalette}!addPage@{addPage}}
\index{addPage@{addPage}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{addPage()}{addPage()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_palette_1_1_page}{TPalette\+::\+Page}} $\ast$ TPalette\+::add\+Page (\begin{DoxyParamCaption}\item[{std\+::wstring}]{name }\end{DoxyParamCaption})}



Creates a new page with the specified name. 

\begin{DoxyReturn}{Returns}
A pointer to the newly created page. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00396                                                \{}
\DoxyCodeLine{00397   Page *page      = \textcolor{keyword}{new} Page(name);}
\DoxyCodeLine{00398   page-\/>m\_index   = \mbox{\hyperlink{class_t_palette_afd211cadf0f047450bc31897f858fa73}{getPageCount}}();}
\DoxyCodeLine{00399   page-\/>m\_palette = \textcolor{keyword}{this};}
\DoxyCodeLine{00400   m\_pages.push\_back(page);}
\DoxyCodeLine{00401   \textcolor{keywordflow}{return} page;}
\DoxyCodeLine{00402 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00368}{get\+Page\+Count()}}.



Referenced by \mbox{\hyperlink{l00898}{assign()}}, \mbox{\hyperlink{l00751}{load\+Data()}}, and \mbox{\hyperlink{l00969}{merge()}}.

\mbox{\Hypertarget{class_t_palette_af1561219d1a6936510ac1ef9d705e52d}\label{class_t_palette_af1561219d1a6936510ac1ef9d705e52d}} 
\index{TPalette@{TPalette}!addStyle@{addStyle}}
\index{addStyle@{addStyle}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{addStyle()}{addStyle()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily int TPalette\+::add\+Style (\begin{DoxyParamCaption}\item[{const TPixel\+RGBM32 \&}]{color }\end{DoxyParamCaption})}

Adds a solid color style to the palette (but in no page). \mbox{\Hypertarget{class_t_palette_a43a27667c3b3583b2b3e1a9f307e7b42}\label{class_t_palette_a43a27667c3b3583b2b3e1a9f307e7b42}} 
\index{TPalette@{TPalette}!addStyle@{addStyle}}
\index{addStyle@{addStyle}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{addStyle()}{addStyle()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily int TPalette\+::add\+Style (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_color_style}{TColor\+Style}} $\ast$}]{style }\end{DoxyParamCaption})}

\begin{DoxyVerb} \remark   Style ownserhip is \a surrendered to the palette
 \return   The styleId associated to the inserted style, or \a -1 on
\end{DoxyVerb}
 failure. Adds the specified style to the palette (but in no page).

Adding style with new style\+Id. Even if there are deleted styles in the palette, the new style will be appended to the end of the list. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00314                                          \{}
\DoxyCodeLine{00315   \textcolor{comment}{// limit the number of cleanup style to 7}}
\DoxyCodeLine{00316   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_palette_a8160207d0a98de8a562c4339aa648ed4}{isCleanupPalette}}() \&\& \mbox{\hyperlink{class_t_palette_a403b73bd6dc6e600bd15252a9c1d2dfe}{getStyleInPagesCount}}() >= 8) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00317 }
\DoxyCodeLine{00318   \textcolor{keywordtype}{int} styleId = int(m\_styles.size());}
\DoxyCodeLine{00319   \textcolor{keywordflow}{if} (styleId < 4096) \{}
\DoxyCodeLine{00320     \textcolor{comment}{// checking if the style is overlapped}}
\DoxyCodeLine{00321     \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{00322     \textcolor{keywordflow}{for} (i = 0; i < styleId; i++)}
\DoxyCodeLine{00323       \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(i) == style) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00324     \textcolor{keywordflow}{if} (i == styleId) \{}
\DoxyCodeLine{00325       m\_styles.push\_back(std::make\_pair((Page *)0, style));}
\DoxyCodeLine{00326       \textcolor{keywordflow}{return} styleId;}
\DoxyCodeLine{00327     \}}
\DoxyCodeLine{00328   \}}
\DoxyCodeLine{00329   \textcolor{keyword}{delete} style;}
\DoxyCodeLine{00330   \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00331 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00283}{get\+Style()}}, \mbox{\hyperlink{l00295}{get\+Style\+In\+Pages\+Count()}}, and \mbox{\hyperlink{l00355}{is\+Cleanup\+Palette()}}.



Referenced by \mbox{\hyperlink{l00154}{TPalette\+::\+Page\+::add\+Style()}}, \mbox{\hyperlink{l00898}{assign()}}, \mbox{\hyperlink{l00751}{load\+Data()}}, and \mbox{\hyperlink{l00969}{merge()}}.

\mbox{\Hypertarget{class_t_palette_a319e848e06467e458214bba1132b49a9}\label{class_t_palette_a319e848e06467e458214bba1132b49a9}} 
\index{TPalette@{TPalette}!assign@{assign}}
\index{assign@{assign}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{assign()}{assign()}}
{\footnotesize\ttfamily void TPalette\+::assign (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_palette}{TPalette}} $\ast$}]{src,  }\item[{bool}]{is\+From\+Studio\+Palette = {\ttfamily false} }\end{DoxyParamCaption})}

\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000020}{Deprecated}}]Should be substituted by operator=(const TPalette\&). \end{DoxyRefDesc}
Copies src\textquotesingle{}s page, color styles an animation table

if the palette is copied from studio palette, this function will modify the original names. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00898                                                                    \{}
\DoxyCodeLine{00899   \textcolor{keywordflow}{if} (src == \textcolor{keyword}{this}) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00900   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00901   m\_isCleanupPalette = src-\/>\mbox{\hyperlink{class_t_palette_a8160207d0a98de8a562c4339aa648ed4}{isCleanupPalette}}();}
\DoxyCodeLine{00902   \textcolor{comment}{// for(i=0;i<getStyleCount();i++) delete getStyle(i);}}
\DoxyCodeLine{00903   m\_styles.clear();}
\DoxyCodeLine{00904   clearPointerContainer(m\_pages);}
\DoxyCodeLine{00905 }
\DoxyCodeLine{00906   \textcolor{keywordflow}{for} (i = 0; i < src-\/>\mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}(); i++) \{}
\DoxyCodeLine{00907     \mbox{\hyperlink{class_t_color_style}{TColorStyle}} *srcStyle = src-\/>\mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(i);}
\DoxyCodeLine{00908     \mbox{\hyperlink{class_t_color_style}{TColorStyle}} *dstStyle = srcStyle-\/>\mbox{\hyperlink{class_t_color_style_a7b7e50c731a150aa84f746a261765adf}{clone}}();}
\DoxyCodeLine{00909     dstStyle-\/>\mbox{\hyperlink{class_t_color_style_aeb25e0ae1708d473bd551b0d0c9bf4a9}{setName}}(}
\DoxyCodeLine{00910         srcStyle-\/>\mbox{\hyperlink{class_t_color_style_a611de20d126c5838456f9113b4682c4f}{getName}}());  \textcolor{comment}{// per un baco del TColorStyle::clone()}}
\DoxyCodeLine{00911     dstStyle-\/>\mbox{\hyperlink{class_t_color_style_af6a3579e3785b9addcf434574bc89367}{setGlobalName}}(}
\DoxyCodeLine{00912         srcStyle-\/>\mbox{\hyperlink{class_t_color_style_ad275b1ae7fbbf9b7a0266b799ce53d40}{getGlobalName}}());  \textcolor{comment}{// per un baco del TColorStyle::clone()}}
\DoxyCodeLine{00913 }
\DoxyCodeLine{00914     \textcolor{comment}{// if the style is copied from studio palette, put its name to the original}}
\DoxyCodeLine{00915     \textcolor{comment}{// name.}}
\DoxyCodeLine{00916     \textcolor{comment}{// check if the style has the global name (i.e. it comes from studio}}
\DoxyCodeLine{00917     \textcolor{comment}{// palette)}}
\DoxyCodeLine{00918     \textcolor{keywordflow}{if} (isFromStudioPalette \&\& srcStyle-\/>\mbox{\hyperlink{class_t_color_style_ad275b1ae7fbbf9b7a0266b799ce53d40}{getGlobalName}}() != L\textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{00919       \textcolor{comment}{// If the original style has no original name (i.e. if the style is copied}}
\DoxyCodeLine{00920       \textcolor{comment}{// from the studio palette)}}
\DoxyCodeLine{00921       \textcolor{keywordflow}{if} (srcStyle-\/>\mbox{\hyperlink{class_t_color_style_a9bbfc9d628f549c134e6593ea9d6b42e}{getOriginalName}}() == L\textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{00922         \textcolor{comment}{// put the original style name to the "{}original name"{} of the pasted}}
\DoxyCodeLine{00923         \textcolor{comment}{// style.}}
\DoxyCodeLine{00924         dstStyle-\/>\mbox{\hyperlink{class_t_color_style_a22061dd49a8282e8af93840441998532}{setOriginalName}}(srcStyle-\/>\mbox{\hyperlink{class_t_color_style_a611de20d126c5838456f9113b4682c4f}{getName}}());}
\DoxyCodeLine{00925       \}}
\DoxyCodeLine{00926     \}}
\DoxyCodeLine{00927 }
\DoxyCodeLine{00928     \textcolor{keywordtype}{int} j = \mbox{\hyperlink{class_t_palette_a43a27667c3b3583b2b3e1a9f307e7b42}{addStyle}}(dstStyle);}
\DoxyCodeLine{00929     assert(i == j);}
\DoxyCodeLine{00930   \}}
\DoxyCodeLine{00931 }
\DoxyCodeLine{00932   \textcolor{keywordflow}{for} (i = 0; i < src-\/>\mbox{\hyperlink{class_t_palette_afd211cadf0f047450bc31897f858fa73}{getPageCount}}(); i++) \{}
\DoxyCodeLine{00933     \textcolor{keyword}{const} Page *srcPage = src-\/>\mbox{\hyperlink{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}{getPage}}(i);}
\DoxyCodeLine{00934     Page *dstPage       = \mbox{\hyperlink{class_t_palette_a77258e62bbb8a9f60e4aa5e6ea0e862a}{addPage}}(srcPage-\/>getName());}
\DoxyCodeLine{00935     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < srcPage-\/>getStyleCount(); j++)}
\DoxyCodeLine{00936       dstPage-\/>addStyle(srcPage-\/>getStyleId(j));}
\DoxyCodeLine{00937   \}}
\DoxyCodeLine{00938   m\_refImg     = !!src-\/>m\_refImg ? src-\/>m\_refImg-\/>\mbox{\hyperlink{class_t_image_a3632b96b398057030a4adfe6917d2e28}{cloneImage}}() : \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}}();}
\DoxyCodeLine{00939   m\_refImgPath = src-\/>m\_refImgPath;}
\DoxyCodeLine{00940 }
\DoxyCodeLine{00941   StyleAnimationTable::iterator it;}
\DoxyCodeLine{00942   StyleAnimation::iterator j;}
\DoxyCodeLine{00943   \textcolor{keywordflow}{for} (it = m\_styleAnimationTable.begin(); it != m\_styleAnimationTable.end();}
\DoxyCodeLine{00944        ++it) \{}
\DoxyCodeLine{00945     \textcolor{comment}{// for(j = it-\/>second.begin(); j != it-\/>second.end(); ++j)}}
\DoxyCodeLine{00946     \textcolor{comment}{//   delete j-\/>second;}}
\DoxyCodeLine{00947     it-\/>second.clear();}
\DoxyCodeLine{00948   \}}
\DoxyCodeLine{00949   m\_styleAnimationTable.clear();}
\DoxyCodeLine{00950   StyleAnimationTable::const\_iterator cit;}
\DoxyCodeLine{00951   \textcolor{keywordflow}{for} (cit = src-\/>m\_styleAnimationTable.begin();}
\DoxyCodeLine{00952        cit != src-\/>m\_styleAnimationTable.end(); ++cit) \{}
\DoxyCodeLine{00953     StyleAnimation animation = cit-\/>second;}
\DoxyCodeLine{00954     \textcolor{keywordflow}{for} (j = animation.begin(); j != animation.end(); j++)}
\DoxyCodeLine{00955       j-\/>second = j-\/>second-\/>clone();}
\DoxyCodeLine{00956     m\_styleAnimationTable[cit-\/>first] = cit-\/>second;}
\DoxyCodeLine{00957   \}}
\DoxyCodeLine{00958   m\_globalName         = src-\/>\mbox{\hyperlink{class_t_palette_ad3199523465a1961c1564a82db46b451}{getGlobalName}}();}
\DoxyCodeLine{00959   m\_shortcuts          = src-\/>m\_shortcuts;}
\DoxyCodeLine{00960   m\_currentFrame       = src-\/>m\_currentFrame;}
\DoxyCodeLine{00961   m\_shortcutScopeIndex = src-\/>m\_shortcutScopeIndex;}
\DoxyCodeLine{00962   \textcolor{comment}{// setDirtyFlag(true);}}
\DoxyCodeLine{00963 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00396}{add\+Page()}}, \mbox{\hyperlink{l00142}{TPalette\+::\+Page\+::add\+Style()}}, \mbox{\hyperlink{l00314}{add\+Style()}}, \mbox{\hyperlink{class_t_color_style_a7b7e50c731a150aa84f746a261765adf}{TColor\+Style\+::clone()}}, \mbox{\hyperlink{class_t_image_a3632b96b398057030a4adfe6917d2e28}{TImage\+::clone\+Image()}}, \mbox{\hyperlink{l00200}{TColor\+Style\+::get\+Global\+Name()}}, \mbox{\hyperlink{l00233}{get\+Global\+Name()}}, \mbox{\hyperlink{l00190}{TColor\+Style\+::get\+Name()}}, \mbox{\hyperlink{l00106}{TPalette\+::\+Page\+::get\+Name()}}, \mbox{\hyperlink{l00207}{TColor\+Style\+::get\+Original\+Name()}}, \mbox{\hyperlink{l00372}{get\+Page()}}, \mbox{\hyperlink{l00368}{get\+Page\+Count()}}, \mbox{\hyperlink{l00283}{get\+Style()}}, \mbox{\hyperlink{l00121}{TPalette\+::\+Page\+::get\+Style\+Count()}}, \mbox{\hyperlink{l00255}{get\+Style\+Count()}}, \mbox{\hyperlink{l00132}{TPalette\+::\+Page\+::get\+Style\+Id()}}, \mbox{\hyperlink{l00355}{is\+Cleanup\+Palette()}}, \mbox{\hyperlink{l00197}{TColor\+Style\+::set\+Global\+Name()}}, \mbox{\hyperlink{l00187}{TColor\+Style\+::set\+Name()}}, and \mbox{\hyperlink{l00204}{TColor\+Style\+::set\+Original\+Name()}}.



Referenced by \mbox{\hyperlink{l01069}{Raster\+Selection\+::delete\+Selection()}}.

\mbox{\Hypertarget{class_t_palette_a36d0291b604c5ecb35c565c6d81c7ce8}\label{class_t_palette_a36d0291b604c5ecb35c565c6d81c7ce8}} 
\index{TPalette@{TPalette}!clearKeyframe@{clearKeyframe}}
\index{clearKeyframe@{clearKeyframe}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{clearKeyframe()}{clearKeyframe()}}
{\footnotesize\ttfamily void TPalette\+::clear\+Keyframe (\begin{DoxyParamCaption}\item[{int}]{style\+Id,  }\item[{int}]{frame }\end{DoxyParamCaption})}



animation. 

Deletes the keyframe at the specified frame of style\+Id\textquotesingle{}s 
\begin{DoxyCode}{0}
\DoxyCodeLine{01145                                                    \{}
\DoxyCodeLine{01146   assert(0 <= styleId \&\& styleId < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}());}
\DoxyCodeLine{01147   assert(0 <= frame);}
\DoxyCodeLine{01148   StyleAnimationTable::iterator it = m\_styleAnimationTable.find(styleId);}
\DoxyCodeLine{01149   \textcolor{keywordflow}{if} (it == m\_styleAnimationTable.end()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01150   StyleAnimation \&animation  = it-\/>second;}
\DoxyCodeLine{01151   StyleAnimation::iterator j = animation.find(frame);}
\DoxyCodeLine{01152   \textcolor{keywordflow}{if} (j == animation.end()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01153   \textcolor{comment}{// j-\/>second-\/>release();}}
\DoxyCodeLine{01154   animation.erase(j);}
\DoxyCodeLine{01155   \textcolor{keywordflow}{if} (animation.empty()) \{}
\DoxyCodeLine{01156     m\_styleAnimationTable.erase(styleId);}
\DoxyCodeLine{01157   \}}
\DoxyCodeLine{01158 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00255}{get\+Style\+Count()}}.

\mbox{\Hypertarget{class_t_palette_abc3ef5824d89e65687b32c530cf25325}\label{class_t_palette_abc3ef5824d89e65687b32c530cf25325}} 
\index{TPalette@{TPalette}!clone@{clone}}
\index{clone@{clone}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{clone()}{clone()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_palette}{TPalette}} $\ast$ TPalette\+::clone (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Allocates a {\itshape new} copy of this palette instance. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00275                                 \{}
\DoxyCodeLine{00276   \mbox{\hyperlink{class_t_palette}{TPalette}} *palette = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_palette}{TPalette}};}
\DoxyCodeLine{00277   palette-\/>assign(\textcolor{keyword}{this});}
\DoxyCodeLine{00278   \textcolor{keywordflow}{return} palette;}
\DoxyCodeLine{00279 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00698}{Toonz\+Image\+Icon\+Renderer\+::run()}}, and \mbox{\hyperlink{l00242}{Vectorizer\+::set\+Level()}}.

\mbox{\Hypertarget{class_t_palette_a6a18830b8f209aac7c13bccfe88b19e4}\label{class_t_palette_a6a18830b8f209aac7c13bccfe88b19e4}} 
\index{TPalette@{TPalette}!erasePage@{erasePage}}
\index{erasePage@{erasePage}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{erasePage()}{erasePage()}}
{\footnotesize\ttfamily void TPalette\+::erase\+Page (\begin{DoxyParamCaption}\item[{int}]{index }\end{DoxyParamCaption})}



Deletes the {\itshape index-\/th} page. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00406                                   \{}
\DoxyCodeLine{00407   Page *page = \mbox{\hyperlink{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}{getPage}}(index);}
\DoxyCodeLine{00408   \textcolor{keywordflow}{if} (!page) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00409   m\_pages.erase(m\_pages.begin() + index);}
\DoxyCodeLine{00410   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00411   \textcolor{keywordflow}{for} (i = 0; i < \mbox{\hyperlink{class_t_palette_afd211cadf0f047450bc31897f858fa73}{getPageCount}}(); i++) m\_pages[i]-\/>m\_index = i;}
\DoxyCodeLine{00412   \textcolor{keywordflow}{for} (i = 0; i < page-\/>getStyleCount(); i++)}
\DoxyCodeLine{00413     m\_styles[page-\/>getStyleId(i)].first = 0;}
\DoxyCodeLine{00414   page-\/>m\_palette = 0;}
\DoxyCodeLine{00415   \textcolor{keyword}{delete} page;}
\DoxyCodeLine{00416 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00372}{get\+Page()}}, \mbox{\hyperlink{l00368}{get\+Page\+Count()}}, \mbox{\hyperlink{l00121}{TPalette\+::\+Page\+::get\+Style\+Count()}}, and \mbox{\hyperlink{l00132}{TPalette\+::\+Page\+::get\+Style\+Id()}}.

\mbox{\Hypertarget{class_t_palette_acef775ca72db90dfdebb0dcad53a3af2}\label{class_t_palette_acef775ca72db90dfdebb0dcad53a3af2}} 
\index{TPalette@{TPalette}!getAskOverwriteFlag@{getAskOverwriteFlag}}
\index{getAskOverwriteFlag@{getAskOverwriteFlag}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getAskOverwriteFlag()}{getAskOverwriteFlag()}}
{\footnotesize\ttfamily bool TPalette\+::get\+Ask\+Overwrite\+Flag (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Returns the ask-\/overwrite flag. 

\mbox{\Hypertarget{class_t_palette_ab0bf5c4fdd9cd3428819ce594299627d}\label{class_t_palette_ab0bf5c4fdd9cd3428819ce594299627d}} 
\index{TPalette@{TPalette}!getClosestStyle@{getClosestStyle}}
\index{getClosestStyle@{getClosestStyle}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getClosestStyle()}{getClosestStyle()}}
{\footnotesize\ttfamily int TPalette\+::get\+Closest\+Style (\begin{DoxyParamCaption}\item[{const TPixel\+RGBM32 \&}]{color }\end{DoxyParamCaption}) const}

\begin{DoxyNote}{Note}
The distance between colors is calculated with the usual sphrical norm between RGBA color components. 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
The style id of the nearest style, or {\ttfamily -\/1} if none was found. Returns the index of the style whose main color is nearest to the requested one. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00442                                                          \{}
\DoxyCodeLine{00443   \textcolor{keyword}{struct }locals \{}
\DoxyCodeLine{00444     \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{int} getDistance2(\textcolor{keyword}{const} TPixel32 \&a, \textcolor{keyword}{const} TPixel32 \&b) \{}
\DoxyCodeLine{00445       \textcolor{keywordflow}{return} (a.r -\/ b.r) * (a.r -\/ b.r) + (a.g -\/ b.g) * (a.g -\/ b.g) +}
\DoxyCodeLine{00446              (a.b -\/ b.b) * (a.b -\/ b.b) + (a.m -\/ b.m) * (a.m -\/ b.m);}
\DoxyCodeLine{00447     \}}
\DoxyCodeLine{00448   \};  \textcolor{comment}{// locals}}
\DoxyCodeLine{00449 }
\DoxyCodeLine{00450   \textcolor{keywordflow}{if} (color == TPixel32::Transparent) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00451   \textcolor{keywordtype}{int} bestIndex    = -\/1;}
\DoxyCodeLine{00452   \textcolor{keywordtype}{int} bestDistance = 255 * 255 * 4 + 1;}
\DoxyCodeLine{00453   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < (int)m\_styles.size(); i++) \{}
\DoxyCodeLine{00454     \textcolor{comment}{// if(i==FirstUserStyle+2) continue;}}
\DoxyCodeLine{00455     \mbox{\hyperlink{class_t_solid_color_style}{TSolidColorStyle}} *scs =}
\DoxyCodeLine{00456         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{class_t_solid_color_style}{TSolidColorStyle}} *\textcolor{keyword}{>}(m\_styles[i].second.getPointer());}
\DoxyCodeLine{00457     \textcolor{keywordflow}{if} (scs) \{}
\DoxyCodeLine{00458       \textcolor{keywordtype}{int} d = locals::getDistance2(scs-\/>\mbox{\hyperlink{class_t_solid_color_style_a99ea32bd112b325f3c94ab0e09552b6a}{getMainColor}}(), color);}
\DoxyCodeLine{00459       \textcolor{keywordflow}{if} (d < bestDistance) \{}
\DoxyCodeLine{00460         bestIndex    = i;}
\DoxyCodeLine{00461         bestDistance = d;}
\DoxyCodeLine{00462       \}}
\DoxyCodeLine{00463     \}}
\DoxyCodeLine{00464   \}}
\DoxyCodeLine{00465   \textcolor{keywordflow}{return} bestIndex;}
\DoxyCodeLine{00466 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00155}{TSolid\+Color\+Style\+::get\+Main\+Color()}}.

\mbox{\Hypertarget{class_t_palette_a447462857fa4be53f7d67f95b7c059bf}\label{class_t_palette_a447462857fa4be53f7d67f95b7c059bf}} 
\index{TPalette@{TPalette}!getCurrentStyleId@{getCurrentStyleId}}
\index{getCurrentStyleId@{getCurrentStyleId}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getCurrentStyleId()}{getCurrentStyleId()}}
{\footnotesize\ttfamily int TPalette\+::get\+Current\+Style\+Id (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00434 \{ \textcolor{keywordflow}{return} m\_currentStyleId; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_a4e573ec80c4779bcdb543e4b743a8c34}\label{class_t_palette_a4e573ec80c4779bcdb543e4b743a8c34}} 
\index{TPalette@{TPalette}!getDirtyFlag@{getDirtyFlag}}
\index{getDirtyFlag@{getDirtyFlag}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getDirtyFlag()}{getDirtyFlag()}}
{\footnotesize\ttfamily bool TPalette\+::get\+Dirty\+Flag (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Returns whether the palette changed with respect to the last {\itshape saved state}. 

Referenced by \mbox{\hyperlink{l00475}{Studio\+Palette\+Tree\+Viewer\+::on\+Current\+Item\+Changed()}}, \mbox{\hyperlink{l00412}{Studio\+Palette\+Tree\+Viewer\+::on\+Item\+Selection\+Changed()}}, and \mbox{\hyperlink{l00209}{Scene\+Level\+::save()}}.

\mbox{\Hypertarget{class_t_palette_aa3db2bd45a8e8a7ec488144684923b0a}\label{class_t_palette_aa3db2bd45a8e8a7ec488144684923b0a}} 
\index{TPalette@{TPalette}!getFirstUnpagedStyle@{getFirstUnpagedStyle}}
\index{getFirstUnpagedStyle@{getFirstUnpagedStyle}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getFirstUnpagedStyle()}{getFirstUnpagedStyle()}}
{\footnotesize\ttfamily int TPalette\+::get\+First\+Unpaged\+Style (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Returns the style\+Id of the first style not in a page ({\ttfamily -\/1} if none). 
\begin{DoxyCode}{0}
\DoxyCodeLine{00304                                          \{}
\DoxyCodeLine{00305   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}(); i++)}
\DoxyCodeLine{00306     \textcolor{keywordflow}{if} (m\_styles[i].first == 0) \textcolor{keywordflow}{return} i;}
\DoxyCodeLine{00307   \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{00308 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00255}{get\+Style\+Count()}}.

\mbox{\Hypertarget{class_t_palette_a7fd9f134eeffe1fa9ca39ee3fb6ad1b4}\label{class_t_palette_a7fd9f134eeffe1fa9ca39ee3fb6ad1b4}} 
\index{TPalette@{TPalette}!getFrame@{getFrame}}
\index{getFrame@{getFrame}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getFrame()}{getFrame()}}
{\footnotesize\ttfamily int TPalette\+::get\+Frame (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Returns the index of the current frame. 


\begin{DoxyCode}{0}
\DoxyCodeLine{01050 \{ \textcolor{keywordflow}{return} m\_currentFrame; \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00821}{Stage\+::\+Raster\+Painter\+::on\+Vector\+Image()}}.

\mbox{\Hypertarget{class_t_palette_ac3646c822ac89b3a44781322582e86ec}\label{class_t_palette_ac3646c822ac89b3a44781322582e86ec}} 
\index{TPalette@{TPalette}!getFxRects@{getFxRects}}
\index{getFxRects@{getFxRects}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getFxRects()}{getFxRects()}}
{\footnotesize\ttfamily bool TPalette\+::get\+Fx\+Rects (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_rect_t}{TRect}} \&}]{rect,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRect}} \&}]{rect\+In,  }\item[{\mbox{\hyperlink{class_t_rect_t}{TRect}} \&}]{rect\+Out }\end{DoxyParamCaption})}

\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000021}{Deprecated}}]Used only once throughout Toonz, should be verified. \end{DoxyRefDesc}

\begin{DoxyCode}{0}
\DoxyCodeLine{00470                                                                           \{}
\DoxyCodeLine{00471   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00472   \textcolor{keywordtype}{bool} ret = \textcolor{keyword}{false};}
\DoxyCodeLine{00473   \textcolor{keywordtype}{int} borderIn, borderOut, fullBorderIn = 0, fullBorderOut = 0;}
\DoxyCodeLine{00474 }
\DoxyCodeLine{00475   \textcolor{keywordflow}{for} (i = 0; i < (int)m\_styles.size(); i++)}
\DoxyCodeLine{00476     \textcolor{keywordflow}{if} (m\_styles[i].second-\/>isRasterStyle()) \{}
\DoxyCodeLine{00477       m\_styles[i].second-\/>getRasterStyleFx()-\/>getEnlargement(borderIn,}
\DoxyCodeLine{00478                                                              borderOut);}
\DoxyCodeLine{00479       fullBorderIn  = std::max(fullBorderIn, borderIn);}
\DoxyCodeLine{00480       fullBorderOut = std::max(fullBorderOut, borderOut);}
\DoxyCodeLine{00481       ret           = \textcolor{keyword}{true};}
\DoxyCodeLine{00482     \}}
\DoxyCodeLine{00483 }
\DoxyCodeLine{00484   rectIn  = rect.enlarge(fullBorderIn);}
\DoxyCodeLine{00485   rectOut = rect.enlarge(fullBorderOut);}
\DoxyCodeLine{00486   \textcolor{keywordflow}{return} ret;}
\DoxyCodeLine{00487 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_ad3199523465a1961c1564a82db46b451}\label{class_t_palette_ad3199523465a1961c1564a82db46b451}} 
\index{TPalette@{TPalette}!getGlobalName@{getGlobalName}}
\index{getGlobalName@{getGlobalName}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getGlobalName()}{getGlobalName()}}
{\footnotesize\ttfamily std\+::wstring TPalette\+::get\+Global\+Name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Returns the name of the palette object. 



Referenced by \mbox{\hyperlink{l00898}{assign()}}, \mbox{\hyperlink{l00475}{Studio\+Palette\+Tree\+Viewer\+::on\+Current\+Item\+Changed()}}, and \mbox{\hyperlink{l00412}{Studio\+Palette\+Tree\+Viewer\+::on\+Item\+Selection\+Changed()}}.

\mbox{\Hypertarget{class_t_palette_ae3433802d3bc4cbf9e8848f74c11cbe5}\label{class_t_palette_ae3433802d3bc4cbf9e8848f74c11cbe5}} 
\index{TPalette@{TPalette}!getKeyframe@{getKeyframe}}
\index{getKeyframe@{getKeyframe}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getKeyframe()}{getKeyframe()}}
{\footnotesize\ttfamily int TPalette\+::get\+Keyframe (\begin{DoxyParamCaption}\item[{int}]{style\+Id,  }\item[{int}]{index }\end{DoxyParamCaption}) const}

Returns the {\itshape index-\/th} frame in style\+Id\textquotesingle{}s animation, or {\ttfamily -\/1} if it couldn\textquotesingle{}t be found. 
\begin{DoxyCode}{0}
\DoxyCodeLine{01114                                                       \{}
\DoxyCodeLine{01115   StyleAnimationTable::const\_iterator it = m\_styleAnimationTable.find(styleId);}
\DoxyCodeLine{01116   \textcolor{keywordflow}{if} (it == m\_styleAnimationTable.end()) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{01117   \textcolor{keyword}{const} StyleAnimation \&animation = it-\/>second;}
\DoxyCodeLine{01118   \textcolor{keywordflow}{if} (index < 0 || index >= (\textcolor{keywordtype}{int})animation.size()) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{01119   StyleAnimation::const\_iterator j = animation.begin();}
\DoxyCodeLine{01120   std::advance(j, index);}
\DoxyCodeLine{01121   \textcolor{keywordflow}{return} j-\/>first;}
\DoxyCodeLine{01122 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_a84cf99f9fef176cf5981425b493285a2}\label{class_t_palette_a84cf99f9fef176cf5981425b493285a2}} 
\index{TPalette@{TPalette}!getKeyframeCount@{getKeyframeCount}}
\index{getKeyframeCount@{getKeyframeCount}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getKeyframeCount()}{getKeyframeCount()}}
{\footnotesize\ttfamily int TPalette\+::get\+Keyframe\+Count (\begin{DoxyParamCaption}\item[{int}]{style\+Id }\end{DoxyParamCaption}) const}



Returns the keyframes count in style\+Id\textquotesingle{}s animation. 

keyframe in style\+Id\textquotesingle{}s animation 
\begin{DoxyCode}{0}
\DoxyCodeLine{01106                                                 \{}
\DoxyCodeLine{01107   StyleAnimationTable::const\_iterator it = m\_styleAnimationTable.find(styleId);}
\DoxyCodeLine{01108   \textcolor{keywordflow}{if} (it == m\_styleAnimationTable.end()) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{01109   \textcolor{keywordflow}{return} int(it-\/>second.size());}
\DoxyCodeLine{01110 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}\label{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}} 
\index{TPalette@{TPalette}!getPage@{getPage}}
\index{getPage@{getPage}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getPage()}{getPage()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_palette_1_1_page}{TPalette\+::\+Page}} $\ast$ TPalette\+::get\+Page (\begin{DoxyParamCaption}\item[{int}]{page\+Index }\end{DoxyParamCaption})}

Returns the {\itshape index-\/th} palette page, or {\ttfamily 0} if no such page was found. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00372                                              \{}
\DoxyCodeLine{00373   \textcolor{keywordflow}{if} (0 <= pageIndex \&\& pageIndex < \mbox{\hyperlink{class_t_palette_afd211cadf0f047450bc31897f858fa73}{getPageCount}}()) \{}
\DoxyCodeLine{00374     Page *page = m\_pages[pageIndex];}
\DoxyCodeLine{00375     assert(page-\/>getIndex() == pageIndex);}
\DoxyCodeLine{00376     assert(page-\/>m\_palette == \textcolor{keyword}{this});}
\DoxyCodeLine{00377     \textcolor{keywordflow}{return} page;}
\DoxyCodeLine{00378   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00379     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00380 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00117}{TPalette\+::\+Page\+::get\+Index()}}, and \mbox{\hyperlink{l00368}{get\+Page\+Count()}}.



Referenced by \mbox{\hyperlink{l00898}{assign()}}, \mbox{\hyperlink{l00655}{Palette\+Viewer\+::context\+Menu\+Event()}}, \mbox{\hyperlink{l00323}{Palette\+Viewer\+GUI\+::\+Page\+Viewer\+::drop()}}, \mbox{\hyperlink{l00406}{erase\+Page()}}, \mbox{\hyperlink{l01162}{get\+Shortcut\+Value()}}, \mbox{\hyperlink{l00969}{merge()}}, and \mbox{\hyperlink{l00633}{save\+Data()}}.

\mbox{\Hypertarget{class_t_palette_a19de22cf05c7052997008e6693294893}\label{class_t_palette_a19de22cf05c7052997008e6693294893}} 
\index{TPalette@{TPalette}!getPage@{getPage}}
\index{getPage@{getPage}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getPage()}{getPage()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily const \mbox{\hyperlink{class_t_palette_1_1_page}{TPalette\+::\+Page}} $\ast$ TPalette\+::get\+Page (\begin{DoxyParamCaption}\item[{int}]{page\+Index }\end{DoxyParamCaption}) const}



Const version of \mbox{\hyperlink{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}{get\+Page(int)}}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00384                                                          \{}
\DoxyCodeLine{00385   \textcolor{keywordflow}{if} (0 <= pageIndex \&\& pageIndex < \mbox{\hyperlink{class_t_palette_afd211cadf0f047450bc31897f858fa73}{getPageCount}}()) \{}
\DoxyCodeLine{00386     Page *page = m\_pages[pageIndex];}
\DoxyCodeLine{00387     assert(page-\/>getIndex() == pageIndex);}
\DoxyCodeLine{00388     assert(page-\/>m\_palette == \textcolor{keyword}{this});}
\DoxyCodeLine{00389     \textcolor{keywordflow}{return} page;}
\DoxyCodeLine{00390   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00391     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00392 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00117}{TPalette\+::\+Page\+::get\+Index()}}, and \mbox{\hyperlink{l00368}{get\+Page\+Count()}}.

\mbox{\Hypertarget{class_t_palette_afd211cadf0f047450bc31897f858fa73}\label{class_t_palette_afd211cadf0f047450bc31897f858fa73}} 
\index{TPalette@{TPalette}!getPageCount@{getPageCount}}
\index{getPageCount@{getPageCount}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getPageCount()}{getPageCount()}}
{\footnotesize\ttfamily int TPalette\+::get\+Page\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



specified style id. 

Returns the pages count. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00368 \{ \textcolor{keywordflow}{return} int(m\_pages.size()); \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00916}{Palette\+Viewer\+::add\+New\+Page()}}, \mbox{\hyperlink{l00396}{add\+Page()}}, \mbox{\hyperlink{l00898}{assign()}}, \mbox{\hyperlink{l00799}{Palette\+Viewer\+::drop\+Event()}}, \mbox{\hyperlink{l00406}{erase\+Page()}}, \mbox{\hyperlink{l00372}{get\+Page()}}, \mbox{\hyperlink{l00969}{merge()}}, \mbox{\hyperlink{l01222}{TVector\+Image\+::merge\+Image()}}, \mbox{\hyperlink{l00420}{move\+Page()}}, and \mbox{\hyperlink{l00633}{save\+Data()}}.

\mbox{\Hypertarget{class_t_palette_af0bb56df19af40d1a729482efc85f492}\label{class_t_palette_af0bb56df19af40d1a729482efc85f492}} 
\index{TPalette@{TPalette}!getPaletteName@{getPaletteName}}
\index{getPaletteName@{getPaletteName}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getPaletteName()}{getPaletteName()}}
{\footnotesize\ttfamily std\+::wstring TPalette\+::get\+Palette\+Name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Returns the name of the palette. 



Referenced by \mbox{\hyperlink{l00571}{Studio\+Palette\+Tree\+Viewer\+::convert\+To\+Studio\+Palette()}}, \mbox{\hyperlink{l00969}{merge()}}, and \mbox{\hyperlink{l00808}{Studio\+Palette\+Tree\+Viewer\+::replace\+Current\+Palette()}}.

\mbox{\Hypertarget{class_t_palette_ac3e08b7fe4ac6f2cb16d195786067108}\label{class_t_palette_ac3e08b7fe4ac6f2cb16d195786067108}} 
\index{TPalette@{TPalette}!getRefImg@{getRefImg}}
\index{getRefImg@{getRefImg}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getRefImg()}{getRefImg()}}
{\footnotesize\ttfamily const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \& TPalette\+::get\+Ref\+Img (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Returns an image that represents the frame image associated to this palette. \mbox{\Hypertarget{class_t_palette_a7eda1d7f3a27e8e90d0c12faaedaf5a6}\label{class_t_palette_a7eda1d7f3a27e8e90d0c12faaedaf5a6}} 
\index{TPalette@{TPalette}!getRefImgPath@{getRefImgPath}}
\index{getRefImgPath@{getRefImgPath}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getRefImgPath()}{getRefImgPath()}}
{\footnotesize\ttfamily const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} TPalette\+::get\+Ref\+Img\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



built or modified using this palette. 

Returns the file path of the reference image. 

Referenced by \mbox{\hyperlink{l00799}{Palette\+Viewer\+::drop\+Event()}}, \mbox{\hyperlink{l01083}{TXsh\+Simple\+Level\+::load()}}, and \mbox{\hyperlink{l00190}{Scene\+Level\+::\+Scene\+Level()}}.

\mbox{\Hypertarget{class_t_palette_aeda302f41529ee532096ecef117bdf7d}\label{class_t_palette_aeda302f41529ee532096ecef117bdf7d}} 
\index{TPalette@{TPalette}!getRefLevelFids@{getRefLevelFids}}
\index{getRefLevelFids@{getRefLevelFids}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getRefLevelFids()}{getRefLevelFids()}}
{\footnotesize\ttfamily std\+::vector$<$ \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} $>$ TPalette\+::get\+Ref\+Level\+Fids (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

fids to this palette. When specified == true fids were specified by user on loading. Returns the list of frames associated to this palette. 
\begin{DoxyCode}{0}
\DoxyCodeLine{01036 \{ \textcolor{keywordflow}{return} m\_refLevelFids; \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l01083}{TXsh\+Simple\+Level\+::load()}}.

\mbox{\Hypertarget{class_t_palette_ac7b1cee99b5f1961be1fc2e821bc2b8b}\label{class_t_palette_ac7b1cee99b5f1961be1fc2e821bc2b8b}} 
\index{TPalette@{TPalette}!getShortcutValue@{getShortcutValue}}
\index{getShortcutValue@{getShortcutValue}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getShortcutValue()}{getShortcutValue()}}
{\footnotesize\ttfamily int TPalette\+::get\+Shortcut\+Value (\begin{DoxyParamCaption}\item[{int}]{key }\end{DoxyParamCaption}) const}



animation. 

\begin{DoxyNote}{Note}
Key is an integer between 0 and 9 included. Returns the style id {\itshape shortcut} associated to key, or {\ttfamily -\/1} if it couldn\textquotesingle{}t be found. 
\end{DoxyNote}

\begin{DoxyCode}{0}
\DoxyCodeLine{01162                                             \{}
\DoxyCodeLine{01163   assert(Qt::Key\_0 <= key \&\& key <= Qt::Key\_9);}
\DoxyCodeLine{01164 }
\DoxyCodeLine{01165   \textcolor{keywordtype}{int} shortcutIndex = (key == Qt::Key\_0) ? 9 : key -\/ Qt::Key\_1;}
\DoxyCodeLine{01166   \textcolor{keywordtype}{int} indexInPage   = m\_shortcutScopeIndex * 10 + shortcutIndex;}
\DoxyCodeLine{01167   \textcolor{comment}{// shortcut is available only in the first page}}
\DoxyCodeLine{01168   \textcolor{keywordflow}{return} \mbox{\hyperlink{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}{getPage}}(0)-\/>\mbox{\hyperlink{class_t_palette_1_1_page_a3d6eed995ee8b1c22d50a73911a45786}{getStyleId}}(indexInPage);}
\DoxyCodeLine{01169 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00372}{get\+Page()}}, and \mbox{\hyperlink{l00132}{TPalette\+::\+Page\+::get\+Style\+Id()}}.



Referenced by \mbox{\hyperlink{l00633}{save\+Data()}}.

\mbox{\Hypertarget{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}\label{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}} 
\index{TPalette@{TPalette}!getStyle@{getStyle}}
\index{getStyle@{getStyle}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getStyle()}{getStyle()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_color_style}{TColor\+Style}} $\ast$ TPalette\+::get\+Style (\begin{DoxyParamCaption}\item[{int}]{style\+Id }\end{DoxyParamCaption}) const}

Returns a pointer to the color style with the specified id, or {\ttfamily 0} if said id is not stored in the palette. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00283                                                \{}
\DoxyCodeLine{00284   \textcolor{keywordflow}{if} (0 <= index \&\& index < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}())}
\DoxyCodeLine{00285     \textcolor{keywordflow}{return} m\_styles[index].second.getPointer();}
\DoxyCodeLine{00286   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00287     \textcolor{keyword}{static} \mbox{\hyperlink{class_t_solid_color_style}{TSolidColorStyle}} *ss = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_solid_color_style}{TSolidColorStyle}}(TPixel32::Red);}
\DoxyCodeLine{00288     ss-\/>addRef();}
\DoxyCodeLine{00289     \textcolor{keywordflow}{return} ss;}
\DoxyCodeLine{00290   \}}
\DoxyCodeLine{00291 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00255}{get\+Style\+Count()}}.



Referenced by \mbox{\hyperlink{l00314}{add\+Style()}}, \mbox{\hyperlink{l00898}{assign()}}, \mbox{\hyperlink{l01043}{TRop\+::convert\+Raster50to46()}}, \mbox{\hyperlink{l01757}{TStyle\+Selection\+::get\+Back\+Original\+Style()}}, \mbox{\hyperlink{l00567}{TVector\+Image\+::get\+BBox()}}, \mbox{\hyperlink{l00345}{TVector\+Brush\+Style\+::get\+Color\+Param\+Value()}}, \mbox{\hyperlink{l00323}{TVector\+Brush\+Style\+::get\+Main\+Color()}}, \mbox{\hyperlink{l00122}{TPalette\+::\+Page\+::get\+Style()}}, \mbox{\hyperlink{l00751}{load\+Data()}}, \mbox{\hyperlink{l00969}{merge()}}, \mbox{\hyperlink{l00316}{Full\+Color\+Area\+Filler\+::rect\+Fill()}}, \mbox{\hyperlink{l00357}{TVector\+Brush\+Style\+::set\+Color\+Param\+Value()}}, \mbox{\hyperlink{l01054}{set\+Frame()}}, \mbox{\hyperlink{l01126}{set\+Keyframe()}}, \mbox{\hyperlink{l00332}{TVector\+Brush\+Style\+::set\+Main\+Color()}}, \mbox{\hyperlink{l00341}{set\+Style()}}, and \mbox{\hyperlink{l00568}{Studio\+Palette\+::update\+Linked\+Colors()}}.

\mbox{\Hypertarget{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}\label{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}} 
\index{TPalette@{TPalette}!getStyleCount@{getStyleCount}}
\index{getStyleCount@{getStyleCount}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getStyleCount()}{getStyleCount()}}
{\footnotesize\ttfamily int TPalette\+::get\+Style\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Returns the number of the color styles in the palette. 



Referenced by \mbox{\hyperlink{l00898}{assign()}}, \mbox{\hyperlink{l01145}{clear\+Keyframe()}}, \mbox{\hyperlink{l01043}{TRop\+::convert\+Raster50to46()}}, \mbox{\hyperlink{l00304}{get\+First\+Unpaged\+Style()}}, \mbox{\hyperlink{l00283}{get\+Style()}}, \mbox{\hyperlink{l00132}{TPalette\+::\+Page\+::get\+Style\+Id()}}, \mbox{\hyperlink{l00295}{get\+Style\+In\+Pages\+Count()}}, \mbox{\hyperlink{l00433}{get\+Style\+Page()}}, \mbox{\hyperlink{l01173}{get\+Style\+Shortcut()}}, \mbox{\hyperlink{l00173}{TPalette\+::\+Page\+::insert\+Style()}}, \mbox{\hyperlink{l00969}{merge()}}, \mbox{\hyperlink{l00203}{TPalette\+::\+Page\+::remove\+Style()}}, \mbox{\hyperlink{l00633}{save\+Data()}}, \mbox{\hyperlink{l00226}{TPalette\+::\+Page\+::search()}}, \mbox{\hyperlink{l01054}{set\+Frame()}}, \mbox{\hyperlink{l01126}{set\+Keyframe()}}, \mbox{\hyperlink{l01187}{set\+Shortcut\+Value()}}, and \mbox{\hyperlink{l00341}{set\+Style()}}.

\mbox{\Hypertarget{class_t_palette_a403b73bd6dc6e600bd15252a9c1d2dfe}\label{class_t_palette_a403b73bd6dc6e600bd15252a9c1d2dfe}} 
\index{TPalette@{TPalette}!getStyleInPagesCount@{getStyleInPagesCount}}
\index{getStyleInPagesCount@{getStyleInPagesCount}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getStyleInPagesCount()}{getStyleInPagesCount()}}
{\footnotesize\ttfamily int TPalette\+::get\+Style\+In\+Pages\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Returns the number of styles contained in palette pages. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00295                                          \{}
\DoxyCodeLine{00296   \textcolor{keywordtype}{int} styleInPagesCount = 0;}
\DoxyCodeLine{00297   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}(); i++)}
\DoxyCodeLine{00298     \textcolor{keywordflow}{if} (m\_styles[i].first != 0) styleInPagesCount++;}
\DoxyCodeLine{00299   \textcolor{keywordflow}{return} styleInPagesCount;}
\DoxyCodeLine{00300 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00255}{get\+Style\+Count()}}.



Referenced by \mbox{\hyperlink{l00314}{add\+Style()}}.

\mbox{\Hypertarget{class_t_palette_ae8566a5ffa9e69be120003ad4b69078d}\label{class_t_palette_ae8566a5ffa9e69be120003ad4b69078d}} 
\index{TPalette@{TPalette}!getStylePage@{getStylePage}}
\index{getStylePage@{getStylePage}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getStylePage()}{getStylePage()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_t_palette_1_1_page}{TPalette\+::\+Page}} $\ast$ TPalette\+::get\+Style\+Page (\begin{DoxyParamCaption}\item[{int}]{style\+Id }\end{DoxyParamCaption}) const}



Returns the page containing the specified {\itshape style\+Id}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00433                                                       \{}
\DoxyCodeLine{00434   \textcolor{keywordflow}{if} (0 <= styleId \&\& styleId < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}())}
\DoxyCodeLine{00435     \textcolor{keywordflow}{return} m\_styles[styleId].first;}
\DoxyCodeLine{00436   \textcolor{keywordflow}{else}}
\DoxyCodeLine{00437     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00438 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00255}{get\+Style\+Count()}}.



Referenced by \mbox{\hyperlink{l01173}{get\+Style\+Shortcut()}}, and \mbox{\hyperlink{l00287}{Color\+Model\+Viewer\+::pick()}}.

\mbox{\Hypertarget{class_t_palette_a2f74093e079ad1c423f9bd62bc00faf1}\label{class_t_palette_a2f74093e079ad1c423f9bd62bc00faf1}} 
\index{TPalette@{TPalette}!getStyleShortcut@{getStyleShortcut}}
\index{getStyleShortcut@{getStyleShortcut}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getStyleShortcut()}{getStyleShortcut()}}
{\footnotesize\ttfamily int TPalette\+::get\+Style\+Shortcut (\begin{DoxyParamCaption}\item[{int}]{style\+Id }\end{DoxyParamCaption}) const}

Returns the shortcut associated to style\+Id, or or {\ttfamily -\/1} if it couldn\textquotesingle{}t be found. 
\begin{DoxyCode}{0}
\DoxyCodeLine{01173                                                 \{}
\DoxyCodeLine{01174   assert(0 <= styleId \&\& styleId < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}());}
\DoxyCodeLine{01175 }
\DoxyCodeLine{01176   Page *page = \mbox{\hyperlink{class_t_palette_ae8566a5ffa9e69be120003ad4b69078d}{getStylePage}}(styleId);}
\DoxyCodeLine{01177   \textcolor{comment}{// shortcut is available only in the first page}}
\DoxyCodeLine{01178   \textcolor{keywordflow}{if} (!page || page-\/>getIndex() != 0) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{01179   \textcolor{keywordtype}{int} indexInPage   = page-\/>search(styleId);}
\DoxyCodeLine{01180   \textcolor{keywordtype}{int} shortcutIndex = indexInPage -\/ m\_shortcutScopeIndex * 10;}
\DoxyCodeLine{01181   \textcolor{keywordflow}{if} (shortcutIndex < 0 || shortcutIndex > 9) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{01182   \textcolor{keywordflow}{return} (shortcutIndex == 9) ? Qt::Key\_0 : Qt::Key\_1 + shortcutIndex;}
\DoxyCodeLine{01183 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00117}{TPalette\+::\+Page\+::get\+Index()}}, \mbox{\hyperlink{l00255}{get\+Style\+Count()}}, \mbox{\hyperlink{l00433}{get\+Style\+Page()}}, and \mbox{\hyperlink{l00215}{TPalette\+::\+Page\+::search()}}.



Referenced by \mbox{\hyperlink{l01359}{Palette\+Viewer\+GUI\+::\+Page\+Viewer\+::event()}}.

\mbox{\Hypertarget{class_t_palette_a6a8a0879cdbd83ecdcf4c7599e093524}\label{class_t_palette_a6a8a0879cdbd83ecdcf4c7599e093524}} 
\index{TPalette@{TPalette}!getVersion@{getVersion}}
\index{getVersion@{getVersion}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{getVersion()}{getVersion()}}
{\footnotesize\ttfamily int TPalette\+::get\+Version (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Returns the palette\textquotesingle{}s version number. 

\mbox{\Hypertarget{class_t_palette_a9cd803f2fbda78d541ea7c9cc1afc8b4}\label{class_t_palette_a9cd803f2fbda78d541ea7c9cc1afc8b4}} 
\index{TPalette@{TPalette}!hasPickedPosStyle@{hasPickedPosStyle}}
\index{hasPickedPosStyle@{hasPickedPosStyle}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{hasPickedPosStyle()}{hasPickedPosStyle()}}
{\footnotesize\ttfamily bool TPalette\+::has\+Picked\+Pos\+Style (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01207                                  \{}
\DoxyCodeLine{01208   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}(); ++i) \{}
\DoxyCodeLine{01209     \mbox{\hyperlink{class_t_smart_pointer_t}{TColorStyleP}} style = m\_styles[i].second;}
\DoxyCodeLine{01210     \textcolor{keywordflow}{if} (style-\/>getPickedPosition().pos != \mbox{\hyperlink{class_t_point_t}{TPoint}}()) \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{01211   \}}
\DoxyCodeLine{01212   \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{01213 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_ab93ce6de2d1138d6c6946e1a3e317e04}\label{class_t_palette_ab93ce6de2d1138d6c6946e1a3e317e04}} 
\index{TPalette@{TPalette}!isAnimated@{isAnimated}}
\index{isAnimated@{isAnimated}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{isAnimated()}{isAnimated()}}
{\footnotesize\ttfamily bool TPalette\+::is\+Animated (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Returns whether this palette is animated (styles change through time). 
\begin{DoxyCode}{0}
\DoxyCodeLine{01046 \{ \textcolor{keywordflow}{return} !m\_styleAnimationTable.empty(); \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00633}{save\+Data()}}.

\mbox{\Hypertarget{class_t_palette_a8160207d0a98de8a562c4339aa648ed4}\label{class_t_palette_a8160207d0a98de8a562c4339aa648ed4}} 
\index{TPalette@{TPalette}!isCleanupPalette@{isCleanupPalette}}
\index{isCleanupPalette@{isCleanupPalette}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{isCleanupPalette()}{isCleanupPalette()}}
{\footnotesize\ttfamily bool TPalette\+::is\+Cleanup\+Palette (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Returns whether this is a cleanup palette. 



Referenced by \mbox{\hyperlink{l00314}{add\+Style()}}, \mbox{\hyperlink{l00898}{assign()}}, \mbox{\hyperlink{l01214}{Palette\+Viewer\+GUI\+::\+Page\+Viewer\+::drag\+Enter\+Event()}}, and \mbox{\hyperlink{l01593}{Palette\+Viewer\+GUI\+::\+Palette\+Tab\+Bar\+::drag\+Enter\+Event()}}.

\mbox{\Hypertarget{class_t_palette_abc7a1661819318b6c4b45a700056c8f8}\label{class_t_palette_abc7a1661819318b6c4b45a700056c8f8}} 
\index{TPalette@{TPalette}!isKeyframe@{isKeyframe}}
\index{isKeyframe@{isKeyframe}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{isKeyframe()}{isKeyframe()}}
{\footnotesize\ttfamily bool TPalette\+::is\+Keyframe (\begin{DoxyParamCaption}\item[{int}]{style\+Id,  }\item[{int}]{frame }\end{DoxyParamCaption}) const}

Returns whether the specified frame is a {\itshape } 
\begin{DoxyCode}{0}
\DoxyCodeLine{01098                                                       \{}
\DoxyCodeLine{01099   StyleAnimationTable::const\_iterator it = m\_styleAnimationTable.find(styleId);}
\DoxyCodeLine{01100   \textcolor{keywordflow}{if} (it == m\_styleAnimationTable.end()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{01101   \textcolor{keywordflow}{return} it-\/>second.count(frame) > 0;}
\DoxyCodeLine{01102 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_a4a66ac047e12676ed6038f1261743dde}\label{class_t_palette_a4a66ac047e12676ed6038f1261743dde}} 
\index{TPalette@{TPalette}!isLocked@{isLocked}}
\index{isLocked@{isLocked}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{isLocked()}{isLocked()}}
{\footnotesize\ttfamily bool TPalette\+::is\+Locked (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Returns whether the palette is locked. 



Referenced by \mbox{\hyperlink{l01121}{Palette\+Viewer\+GUI\+::\+Page\+Viewer\+::context\+Menu\+Event()}}, \mbox{\hyperlink{l01062}{Palette\+Viewer\+GUI\+::\+Page\+Viewer\+::mouse\+Double\+Click\+Event()}}, \mbox{\hyperlink{l01575}{Palette\+Viewer\+GUI\+::\+Palette\+Tab\+Bar\+::mouse\+Double\+Click\+Event()}}, \mbox{\hyperlink{l01021}{Palette\+Viewer\+GUI\+::\+Page\+Viewer\+::mouse\+Move\+Event()}}, \mbox{\hyperlink{l01555}{Palette\+Viewer\+GUI\+::\+Palette\+Tab\+Bar\+::mouse\+Move\+Event()}}, \mbox{\hyperlink{l00942}{Palette\+Viewer\+GUI\+::\+Page\+Viewer\+::mouse\+Press\+Event()}}, \mbox{\hyperlink{l00580}{Palette\+Viewer\+GUI\+::\+Page\+Viewer\+::paint\+Event()}}, \mbox{\hyperlink{l00633}{save\+Data()}}, and \mbox{\hyperlink{l01758}{Palette\+Viewer\+GUI\+::\+Page\+Viewer\+::update\+Command\+Locks()}}.

\mbox{\Hypertarget{class_t_palette_ad4c4db7647acbcccbd698e1ae0655b43}\label{class_t_palette_ad4c4db7647acbcccbd698e1ae0655b43}} 
\index{TPalette@{TPalette}!loadData@{loadData}}
\index{loadData@{loadData}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{loadData()}{loadData()}}
{\footnotesize\ttfamily void TPalette\+::load\+Data (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_i_stream}{TIStream}} \&}]{is }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



I/O palette save function. 



Implements \mbox{\hyperlink{class_t_persist_a9e9d78431e843edb9299095af867a136}{TPersist}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00751                                     \{}
\DoxyCodeLine{00752   m\_styles.clear();}
\DoxyCodeLine{00753   clearPointerContainer(m\_pages);}
\DoxyCodeLine{00754 }
\DoxyCodeLine{00755   VersionNumber version = is.\mbox{\hyperlink{class_t_i_stream_a61179493a9ae5d6b057d23195cec606b}{getVersion}}();}
\DoxyCodeLine{00756 }
\DoxyCodeLine{00757   std::string tagName;}
\DoxyCodeLine{00758   \textcolor{keywordflow}{while} (is.\mbox{\hyperlink{class_t_i_stream_a735640240402316f00c595134bfe6b4b}{openChild}}(tagName)) \{}
\DoxyCodeLine{00759     \textcolor{keywordflow}{if} (tagName == \textcolor{stringliteral}{"{}version"{}}) \{}
\DoxyCodeLine{00760       is >> version.first >> version.second;}
\DoxyCodeLine{00761       \textcolor{keywordflow}{if} (version > VersionNumber(71, 0))}
\DoxyCodeLine{00762         \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}palette, unsupported version number"{}});}
\DoxyCodeLine{00763     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tagName == \textcolor{stringliteral}{"{}styles"{}}) \{}
\DoxyCodeLine{00764       \textcolor{keywordflow}{while} (!is.\mbox{\hyperlink{class_t_i_stream_af8ad0a31e14e94179bd5688f13340528}{eos}}())  \textcolor{comment}{// I think while(is.openChild(tagName))}}
\DoxyCodeLine{00765       \{                  \textcolor{comment}{// would be better. However, I don't trust}}
\DoxyCodeLine{00766         \textcolor{keywordflow}{if} (!is.\mbox{\hyperlink{class_t_i_stream_a735640240402316f00c595134bfe6b4b}{openChild}}(tagName) ||}
\DoxyCodeLine{00767             tagName !=}
\DoxyCodeLine{00768                 \textcolor{stringliteral}{"{}style"{}})  \textcolor{comment}{// TIStream's implementation very much. Keeping it}}
\DoxyCodeLine{00769           \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(}
\DoxyCodeLine{00770               \textcolor{stringliteral}{"{}palette, expected tag <style>"{}});  \textcolor{comment}{// like this for now.}}
\DoxyCodeLine{00771         \{}
\DoxyCodeLine{00772           StyleReader r(is, version);}
\DoxyCodeLine{00773           \mbox{\hyperlink{class_t_color_style}{TColorStyle}} *cs = \mbox{\hyperlink{class_t_color_style_a27dd8ed3da9830923d5231575840f1d1}{TColorStyle::load}}(r);}
\DoxyCodeLine{00774 }
\DoxyCodeLine{00775           std::string pickedPosStr;}
\DoxyCodeLine{00776           \textcolor{keywordflow}{if} (is.\mbox{\hyperlink{class_t_i_stream_a530540f44de1a1031cebfee0d34ffcfe}{getTagParam}}(\textcolor{stringliteral}{"{}pickedpos"{}}, pickedPosStr))}
\DoxyCodeLine{00777             cs-\/>setPickedPosition(stringToPoint(pickedPosStr));}
\DoxyCodeLine{00778 }
\DoxyCodeLine{00779           \mbox{\hyperlink{class_t_palette_a43a27667c3b3583b2b3e1a9f307e7b42}{addStyle}}(cs);}
\DoxyCodeLine{00780         \}}
\DoxyCodeLine{00781 }
\DoxyCodeLine{00782         is.\mbox{\hyperlink{class_t_i_stream_a57d85a02799eb0e904c8b22788dc671b}{closeChild}}();}
\DoxyCodeLine{00783       \}}
\DoxyCodeLine{00784     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tagName == \textcolor{stringliteral}{"{}stylepages"{}}) \{}
\DoxyCodeLine{00785       \textcolor{keywordflow}{while} (!is.\mbox{\hyperlink{class_t_i_stream_af8ad0a31e14e94179bd5688f13340528}{eos}}()) \{}
\DoxyCodeLine{00786         \textcolor{keywordflow}{if} (!is.\mbox{\hyperlink{class_t_i_stream_a735640240402316f00c595134bfe6b4b}{openChild}}(tagName) || tagName != \textcolor{stringliteral}{"{}page"{}})}
\DoxyCodeLine{00787           \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}palette, expected tag <stylepage>"{}});}
\DoxyCodeLine{00788         \{}
\DoxyCodeLine{00789           std::wstring pageName;}
\DoxyCodeLine{00790 }
\DoxyCodeLine{00791           \textcolor{keywordflow}{if} (!is.\mbox{\hyperlink{class_t_i_stream_a735640240402316f00c595134bfe6b4b}{openChild}}(tagName) || tagName != \textcolor{stringliteral}{"{}name"{}})}
\DoxyCodeLine{00792             \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}palette, expected tag <name>"{}});}
\DoxyCodeLine{00793           \{ is >> pageName; \}}
\DoxyCodeLine{00794           is.\mbox{\hyperlink{class_t_i_stream_a57d85a02799eb0e904c8b22788dc671b}{closeChild}}();}
\DoxyCodeLine{00795 }
\DoxyCodeLine{00796           Page *page = \mbox{\hyperlink{class_t_palette_a77258e62bbb8a9f60e4aa5e6ea0e862a}{addPage}}(pageName);}
\DoxyCodeLine{00797 }
\DoxyCodeLine{00798           \textcolor{keywordflow}{if} (!is.\mbox{\hyperlink{class_t_i_stream_a735640240402316f00c595134bfe6b4b}{openChild}}(tagName) || tagName != \textcolor{stringliteral}{"{}indices"{}})}
\DoxyCodeLine{00799             \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}palette, expected tag <indices>"{}});}
\DoxyCodeLine{00800           \{}
\DoxyCodeLine{00801             \textcolor{keywordflow}{while} (!is.\mbox{\hyperlink{class_t_i_stream_af8ad0a31e14e94179bd5688f13340528}{eos}}()) \{}
\DoxyCodeLine{00802               \textcolor{keywordtype}{int} index;}
\DoxyCodeLine{00803               is >> index;}
\DoxyCodeLine{00804               page-\/>addStyle(index);}
\DoxyCodeLine{00805             \}}
\DoxyCodeLine{00806           \}}
\DoxyCodeLine{00807           is.\mbox{\hyperlink{class_t_i_stream_a57d85a02799eb0e904c8b22788dc671b}{closeChild}}();}
\DoxyCodeLine{00808         \}}
\DoxyCodeLine{00809         is.\mbox{\hyperlink{class_t_i_stream_a57d85a02799eb0e904c8b22788dc671b}{closeChild}}();}
\DoxyCodeLine{00810       \}}
\DoxyCodeLine{00811     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tagName == \textcolor{stringliteral}{"{}refImgPath"{}}) \{}
\DoxyCodeLine{00812       std::string fidsStr;}
\DoxyCodeLine{00813       \textcolor{keywordflow}{if} (is.\mbox{\hyperlink{class_t_i_stream_a530540f44de1a1031cebfee0d34ffcfe}{getTagParam}}(\textcolor{stringliteral}{"{}fids"{}}, fidsStr)) \{}
\DoxyCodeLine{00814         m\_areRefLevelFidsSpecified = \textcolor{keyword}{true};}
\DoxyCodeLine{00815         m\_refLevelFids             = strToFids(fidsStr);}
\DoxyCodeLine{00816       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00817         m\_areRefLevelFidsSpecified = \textcolor{keyword}{false};}
\DoxyCodeLine{00818         m\_refLevelFids.clear();}
\DoxyCodeLine{00819       \}}
\DoxyCodeLine{00820       is >> m\_refImgPath;}
\DoxyCodeLine{00821     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tagName == \textcolor{stringliteral}{"{}animation"{}}) \{}
\DoxyCodeLine{00822       \textcolor{keywordflow}{while} (!is.\mbox{\hyperlink{class_t_i_stream_af8ad0a31e14e94179bd5688f13340528}{eos}}()) \{}
\DoxyCodeLine{00823         \textcolor{keywordflow}{if} (!is.\mbox{\hyperlink{class_t_i_stream_a735640240402316f00c595134bfe6b4b}{openChild}}(tagName) || tagName != \textcolor{stringliteral}{"{}style"{}})}
\DoxyCodeLine{00824           \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}palette, expected tag <style>"{}});}
\DoxyCodeLine{00825         \{}
\DoxyCodeLine{00826           \textcolor{keywordtype}{int} styleId = 0;}
\DoxyCodeLine{00827           \textcolor{keywordflow}{if} (!is.\mbox{\hyperlink{class_t_i_stream_a530540f44de1a1031cebfee0d34ffcfe}{getTagParam}}(\textcolor{stringliteral}{"{}id"{}}, styleId))}
\DoxyCodeLine{00828             \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}palette, missing id attribute in tag <style>"{}});}
\DoxyCodeLine{00829 }
\DoxyCodeLine{00830           StyleAnimation animation;}
\DoxyCodeLine{00831 }
\DoxyCodeLine{00832           \mbox{\hyperlink{class_t_color_style}{TColorStyle}} *style = \mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(styleId);}
\DoxyCodeLine{00833           assert(style);}
\DoxyCodeLine{00834 }
\DoxyCodeLine{00835           \textcolor{keywordflow}{while} (is.\mbox{\hyperlink{class_t_i_stream_a5fe7ddb5560e39e0ab4ff57d24926d41}{matchTag}}(tagName)) \{}
\DoxyCodeLine{00836             \mbox{\hyperlink{class_t_color_style}{TColorStyle}} *cs = 0;}
\DoxyCodeLine{00837             \textcolor{keywordtype}{int} frame       = 0;}
\DoxyCodeLine{00838 }
\DoxyCodeLine{00839             \textcolor{keywordflow}{if} (tagName == \textcolor{stringliteral}{"{}keycolor"{}}) \{}
\DoxyCodeLine{00840               \textcolor{keywordflow}{if} (!is.\mbox{\hyperlink{class_t_i_stream_a530540f44de1a1031cebfee0d34ffcfe}{getTagParam}}(\textcolor{stringliteral}{"{}frame"{}}, frame))}
\DoxyCodeLine{00841                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(}
\DoxyCodeLine{00842                     \textcolor{stringliteral}{"{}palette, missing frame attribute in tag <keycolor>"{}});}
\DoxyCodeLine{00843 }
\DoxyCodeLine{00844               TPixel32 color;}
\DoxyCodeLine{00845               is >> color;}
\DoxyCodeLine{00846 }
\DoxyCodeLine{00847               cs = style-\/>\mbox{\hyperlink{class_t_color_style_a7b7e50c731a150aa84f746a261765adf}{clone}}();}
\DoxyCodeLine{00848               cs-\/>\mbox{\hyperlink{class_t_color_style_a7298dce9321f51cfb21f3fcb13701240}{setMainColor}}(color);}
\DoxyCodeLine{00849             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tagName == \textcolor{stringliteral}{"{}keyframe"{}}) \{}
\DoxyCodeLine{00850               \textcolor{keywordflow}{if} (!is.\mbox{\hyperlink{class_t_i_stream_a530540f44de1a1031cebfee0d34ffcfe}{getTagParam}}(\textcolor{stringliteral}{"{}frame"{}}, frame))}
\DoxyCodeLine{00851                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(}
\DoxyCodeLine{00852                     \textcolor{stringliteral}{"{}palette, missing frame attribute in tag <keyframe>"{}});}
\DoxyCodeLine{00853 }
\DoxyCodeLine{00854               StyleReader r(is, version);}
\DoxyCodeLine{00855               cs = \mbox{\hyperlink{class_t_color_style_a27dd8ed3da9830923d5231575840f1d1}{TColorStyle::load}}(r);}
\DoxyCodeLine{00856             \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00857               \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}palette, expected <keyframe> tag"{}});}
\DoxyCodeLine{00858 }
\DoxyCodeLine{00859             animation[frame] = cs;}
\DoxyCodeLine{00860             is.\mbox{\hyperlink{class_t_i_stream_a57d85a02799eb0e904c8b22788dc671b}{closeChild}}();}
\DoxyCodeLine{00861           \}}
\DoxyCodeLine{00862 }
\DoxyCodeLine{00863           m\_styleAnimationTable[styleId] = animation;}
\DoxyCodeLine{00864         \}}
\DoxyCodeLine{00865         is.\mbox{\hyperlink{class_t_i_stream_a57d85a02799eb0e904c8b22788dc671b}{closeChild}}();}
\DoxyCodeLine{00866       \}}
\DoxyCodeLine{00867     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tagName == \textcolor{stringliteral}{"{}stylepages"{}}) \{}
\DoxyCodeLine{00868       \textcolor{keywordtype}{int} key = \textcolor{charliteral}{'0'};}
\DoxyCodeLine{00869       \textcolor{keywordflow}{while} (!is.\mbox{\hyperlink{class_t_i_stream_af8ad0a31e14e94179bd5688f13340528}{eos}}()) \{}
\DoxyCodeLine{00870         \textcolor{keywordtype}{int} styleId = 0;}
\DoxyCodeLine{00871         is >> styleId;}
\DoxyCodeLine{00872 }
\DoxyCodeLine{00873         \textcolor{keywordflow}{if} (key <= \textcolor{charliteral}{'9'}) \mbox{\hyperlink{class_t_palette_a2e4fc32a08028cbcc65c9a3897efa80d}{setShortcutValue}}(key, styleId);}
\DoxyCodeLine{00874       \}}
\DoxyCodeLine{00875     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tagName == \textcolor{stringliteral}{"{}shortcuts"{}}) \{}
\DoxyCodeLine{00876       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 10; ++i) \{}
\DoxyCodeLine{00877         \textcolor{keywordtype}{int} v;}
\DoxyCodeLine{00878         is >> v;}
\DoxyCodeLine{00879 }
\DoxyCodeLine{00880         \mbox{\hyperlink{class_t_palette_a2e4fc32a08028cbcc65c9a3897efa80d}{setShortcutValue}}(\textcolor{charliteral}{'0'} + i, v);}
\DoxyCodeLine{00881       \}}
\DoxyCodeLine{00882     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tagName == \textcolor{stringliteral}{"{}lock"{}}) \{}
\DoxyCodeLine{00883       \textcolor{keywordtype}{int} lockValue;}
\DoxyCodeLine{00884       is >> lockValue;}
\DoxyCodeLine{00885       m\_isLocked = (bool)lockValue;}
\DoxyCodeLine{00886     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00887       \textcolor{keywordflow}{throw} \mbox{\hyperlink{class_t_exception}{TException}}(\textcolor{stringliteral}{"{}palette, unknown tag: "{}} + tagName);}
\DoxyCodeLine{00888 }
\DoxyCodeLine{00889     is.\mbox{\hyperlink{class_t_i_stream_a57d85a02799eb0e904c8b22788dc671b}{closeChild}}();}
\DoxyCodeLine{00890   \}}
\DoxyCodeLine{00891 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00396}{add\+Page()}}, \mbox{\hyperlink{l00142}{TPalette\+::\+Page\+::add\+Style()}}, \mbox{\hyperlink{l00314}{add\+Style()}}, \mbox{\hyperlink{class_t_color_style_a7b7e50c731a150aa84f746a261765adf}{TColor\+Style\+::clone()}}, \mbox{\hyperlink{l01242}{TIStream\+::close\+Child()}}, \mbox{\hyperlink{l01169}{TIStream\+::eos()}}, \mbox{\hyperlink{l00283}{get\+Style()}}, \mbox{\hyperlink{class_t_i_stream_a530540f44de1a1031cebfee0d34ffcfe}{TIStream\+::get\+Tag\+Param()}}, \mbox{\hyperlink{l01273}{TIStream\+::get\+Version()}}, \mbox{\hyperlink{l00514}{TColor\+Style\+::load()}}, \mbox{\hyperlink{l01178}{TIStream\+::match\+Tag()}}, \mbox{\hyperlink{l01231}{TIStream\+::open\+Child()}}, \mbox{\hyperlink{l00248}{TColor\+Style\+::set\+Main\+Color()}}, and \mbox{\hyperlink{l01187}{set\+Shortcut\+Value()}}.



Referenced by \mbox{\hyperlink{l00359}{TScene\+Properties\+::load\+Data()}}.

\mbox{\Hypertarget{class_t_palette_a705d1d02aa6a88e4da4ead66c9e838aa}\label{class_t_palette_a705d1d02aa6a88e4da4ead66c9e838aa}} 
\index{TPalette@{TPalette}!merge@{merge}}
\index{merge@{merge}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{merge()}{merge()}}
{\footnotesize\ttfamily void TPalette\+::merge (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_palette}{TPalette}} $\ast$}]{src,  }\item[{bool}]{is\+From\+Studio\+Palette = {\ttfamily false} }\end{DoxyParamCaption})}

to the corresponding features of the palette. if the palette is copied from studio palette, this function will modify the original names. Adds src\textquotesingle{}s styles and pages to the palette.

if the palette is merged from studio palette, this function will modify the original names. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00969                                                                   \{}
\DoxyCodeLine{00970   std::map<int, int> table;}
\DoxyCodeLine{00971   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00972   \textcolor{keywordflow}{for} (i = 1; i < src-\/>\mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}(); i++) \{}
\DoxyCodeLine{00973     \mbox{\hyperlink{class_t_color_style}{TColorStyle}} *srcStyle = src-\/>\mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(i);}
\DoxyCodeLine{00974     \mbox{\hyperlink{class_t_color_style}{TColorStyle}} *dstStyle = srcStyle-\/>\mbox{\hyperlink{class_t_color_style_a7b7e50c731a150aa84f746a261765adf}{clone}}();}
\DoxyCodeLine{00975     dstStyle-\/>\mbox{\hyperlink{class_t_color_style_aeb25e0ae1708d473bd551b0d0c9bf4a9}{setName}}(srcStyle-\/>\mbox{\hyperlink{class_t_color_style_a611de20d126c5838456f9113b4682c4f}{getName}}());}
\DoxyCodeLine{00976     dstStyle-\/>\mbox{\hyperlink{class_t_color_style_af6a3579e3785b9addcf434574bc89367}{setGlobalName}}(srcStyle-\/>\mbox{\hyperlink{class_t_color_style_ad275b1ae7fbbf9b7a0266b799ce53d40}{getGlobalName}}());}
\DoxyCodeLine{00977 }
\DoxyCodeLine{00978     \textcolor{comment}{// if the style is copied from studio palette, put its name to the original}}
\DoxyCodeLine{00979     \textcolor{comment}{// name.}}
\DoxyCodeLine{00980     \textcolor{comment}{// check if the style has the global name (i.e. it comes from studio}}
\DoxyCodeLine{00981     \textcolor{comment}{// palette)}}
\DoxyCodeLine{00982     \textcolor{keywordflow}{if} (isFromStudioPalette \&\& srcStyle-\/>\mbox{\hyperlink{class_t_color_style_ad275b1ae7fbbf9b7a0266b799ce53d40}{getGlobalName}}() != L\textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{00983       \textcolor{comment}{// If the original style has no original name (i.e. if the style is copied}}
\DoxyCodeLine{00984       \textcolor{comment}{// from the studio palette)}}
\DoxyCodeLine{00985       \textcolor{keywordflow}{if} (srcStyle-\/>\mbox{\hyperlink{class_t_color_style_a9bbfc9d628f549c134e6593ea9d6b42e}{getOriginalName}}() == L\textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{00986         \textcolor{comment}{// put the original style name to the "{}original name"{} of the pasted}}
\DoxyCodeLine{00987         \textcolor{comment}{// style.}}
\DoxyCodeLine{00988         dstStyle-\/>\mbox{\hyperlink{class_t_color_style_a22061dd49a8282e8af93840441998532}{setOriginalName}}(srcStyle-\/>\mbox{\hyperlink{class_t_color_style_a611de20d126c5838456f9113b4682c4f}{getName}}());}
\DoxyCodeLine{00989       \}}
\DoxyCodeLine{00990     \}}
\DoxyCodeLine{00991 }
\DoxyCodeLine{00992     \textcolor{keywordtype}{int} j    = \mbox{\hyperlink{class_t_palette_a43a27667c3b3583b2b3e1a9f307e7b42}{addStyle}}(dstStyle);}
\DoxyCodeLine{00993     table[i] = j;}
\DoxyCodeLine{00994   \}}
\DoxyCodeLine{00995 }
\DoxyCodeLine{00996   \textcolor{keywordtype}{int} pageCount = src-\/>\mbox{\hyperlink{class_t_palette_afd211cadf0f047450bc31897f858fa73}{getPageCount}}();}
\DoxyCodeLine{00997   \textcolor{keywordflow}{for} (i = 0; i < pageCount; i++) \{}
\DoxyCodeLine{00998     \textcolor{keyword}{const} Page *srcPage   = src-\/>\mbox{\hyperlink{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}{getPage}}(i);}
\DoxyCodeLine{00999     std::wstring pageName = srcPage-\/>\mbox{\hyperlink{class_t_palette_1_1_page_afe6244af91aba433da867c48d0ecb304}{getName}}();}
\DoxyCodeLine{01000     \textcolor{keywordflow}{if} (pageName == L\textcolor{stringliteral}{"{}colors"{}} \&\& src-\/>\mbox{\hyperlink{class_t_palette_af0bb56df19af40d1a729482efc85f492}{getPaletteName}}() != L\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{01001       pageName = src-\/>\mbox{\hyperlink{class_t_palette_af0bb56df19af40d1a729482efc85f492}{getPaletteName}}();}
\DoxyCodeLine{01002     Page *dstPage = \mbox{\hyperlink{class_t_palette_a77258e62bbb8a9f60e4aa5e6ea0e862a}{addPage}}(pageName);  \textcolor{comment}{//;}}
\DoxyCodeLine{01003     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < srcPage-\/>getStyleCount(); j++) \{}
\DoxyCodeLine{01004       \textcolor{keywordtype}{int} styleId = srcPage-\/>getStyleId(j);}
\DoxyCodeLine{01005       \textcolor{keywordflow}{if} (styleId == 0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01006       assert(table.find(styleId) != table.end());}
\DoxyCodeLine{01007       dstPage-\/>addStyle(table[styleId]);}
\DoxyCodeLine{01008     \}}
\DoxyCodeLine{01009     assert(dstPage-\/>m\_palette == \textcolor{keyword}{this});}
\DoxyCodeLine{01010   \}}
\DoxyCodeLine{01011 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00396}{add\+Page()}}, \mbox{\hyperlink{l00142}{TPalette\+::\+Page\+::add\+Style()}}, \mbox{\hyperlink{l00314}{add\+Style()}}, \mbox{\hyperlink{class_t_color_style_a7b7e50c731a150aa84f746a261765adf}{TColor\+Style\+::clone()}}, \mbox{\hyperlink{l00200}{TColor\+Style\+::get\+Global\+Name()}}, \mbox{\hyperlink{l00190}{TColor\+Style\+::get\+Name()}}, \mbox{\hyperlink{l00106}{TPalette\+::\+Page\+::get\+Name()}}, \mbox{\hyperlink{l00207}{TColor\+Style\+::get\+Original\+Name()}}, \mbox{\hyperlink{l00372}{get\+Page()}}, \mbox{\hyperlink{l00368}{get\+Page\+Count()}}, \mbox{\hyperlink{l00414}{get\+Palette\+Name()}}, \mbox{\hyperlink{l00283}{get\+Style()}}, \mbox{\hyperlink{l00121}{TPalette\+::\+Page\+::get\+Style\+Count()}}, \mbox{\hyperlink{l00255}{get\+Style\+Count()}}, \mbox{\hyperlink{l00132}{TPalette\+::\+Page\+::get\+Style\+Id()}}, \mbox{\hyperlink{l00197}{TColor\+Style\+::set\+Global\+Name()}}, \mbox{\hyperlink{l00187}{TColor\+Style\+::set\+Name()}}, and \mbox{\hyperlink{l00204}{TColor\+Style\+::set\+Original\+Name()}}.

\mbox{\Hypertarget{class_t_palette_ab6c28b4d7f325bef02d347473d4daacb}\label{class_t_palette_ab6c28b4d7f325bef02d347473d4daacb}} 
\index{TPalette@{TPalette}!movePage@{movePage}}
\index{movePage@{movePage}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{movePage()}{movePage()}}
{\footnotesize\ttfamily void TPalette\+::move\+Page (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_palette_1_1_page}{Page}} $\ast$}]{page,  }\item[{int}]{dst\+Page\+Index }\end{DoxyParamCaption})}

Moves the specified page to a different page index. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00420                                                     \{}
\DoxyCodeLine{00421   assert(page);}
\DoxyCodeLine{00422   assert(page-\/>m\_palette == \textcolor{keyword}{this});}
\DoxyCodeLine{00423   dstPageIndex = tcrop(dstPageIndex, 0, \mbox{\hyperlink{class_t_palette_afd211cadf0f047450bc31897f858fa73}{getPageCount}}() -\/ 1);}
\DoxyCodeLine{00424   \textcolor{keywordflow}{if} (dstPageIndex == page-\/>getIndex()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00425   m\_pages.erase(m\_pages.begin() + page-\/>getIndex());}
\DoxyCodeLine{00426   m\_pages.insert(m\_pages.begin() + dstPageIndex, page);}
\DoxyCodeLine{00427   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{class_t_palette_afd211cadf0f047450bc31897f858fa73}{getPageCount}}(); i++) m\_pages[i]-\/>m\_index = i;}
\DoxyCodeLine{00428   assert(page-\/>getIndex() == dstPageIndex);}
\DoxyCodeLine{00429 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00117}{TPalette\+::\+Page\+::get\+Index()}}, and \mbox{\hyperlink{l00368}{get\+Page\+Count()}}.

\mbox{\Hypertarget{class_t_palette_a3974fff5698333b742c0b0b2f58aee37}\label{class_t_palette_a3974fff5698333b742c0b0b2f58aee37}} 
\index{TPalette@{TPalette}!mutex@{mutex}}
\index{mutex@{mutex}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{mutex()}{mutex()}}
{\footnotesize\ttfamily QMutex $\ast$ TPalette\+::mutex (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Returns the palette\textquotesingle{}s mutex. 

\mbox{\Hypertarget{class_t_palette_aba372a4be1511bffcf54d99ea8d58773}\label{class_t_palette_aba372a4be1511bffcf54d99ea8d58773}} 
\index{TPalette@{TPalette}!nextShortcutScope@{nextShortcutScope}}
\index{nextShortcutScope@{nextShortcutScope}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{nextShortcutScope()}{nextShortcutScope()}}
{\footnotesize\ttfamily void TPalette\+::next\+Shortcut\+Scope (\begin{DoxyParamCaption}\item[{bool}]{invert }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01217                                             \{}
\DoxyCodeLine{01218   \textcolor{keywordflow}{if} (invert) \{}
\DoxyCodeLine{01219     \textcolor{keywordflow}{if} (m\_shortcutScopeIndex > 0)}
\DoxyCodeLine{01220       m\_shortcutScopeIndex -\/= 1;}
\DoxyCodeLine{01221     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01222       m\_shortcutScopeIndex = \mbox{\hyperlink{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}{getPage}}(0)-\/>\mbox{\hyperlink{class_t_palette_1_1_page_ae6d6b899ee10f5b3900081acd882f8ee}{getStyleCount}}() / 10;}
\DoxyCodeLine{01223   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01224     \textcolor{keywordflow}{if} ((m\_shortcutScopeIndex + 1) * 10 < \mbox{\hyperlink{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}{getPage}}(0)-\/>\mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}())}
\DoxyCodeLine{01225       m\_shortcutScopeIndex += 1;}
\DoxyCodeLine{01226     \textcolor{keywordflow}{else}}
\DoxyCodeLine{01227       m\_shortcutScopeIndex = 0;}
\DoxyCodeLine{01228   \}}
\DoxyCodeLine{01229 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_a30dcdbafb77d943fbc8b712625f4f3d2}\label{class_t_palette_a30dcdbafb77d943fbc8b712625f4f3d2}} 
\index{TPalette@{TPalette}!saveData@{saveData}}
\index{saveData@{saveData}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{saveData()}{saveData()}}
{\footnotesize\ttfamily void TPalette\+::save\+Data (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_t_o_stream}{TOStream}} \&}]{os }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



I/O palette load function. 



Implements \mbox{\hyperlink{class_t_persist_afb991f7b26f14dbee1740ef036ff4e85}{TPersist}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00633                                     \{}
\DoxyCodeLine{00634   os.\mbox{\hyperlink{class_t_o_stream_a9cd1359e6b21d85786708c7e680756d1}{child}}(\textcolor{stringliteral}{"{}version"{}}) << 71 << 0;  \textcolor{comment}{// Inserting the version tag at this level.}}
\DoxyCodeLine{00635   \textcolor{comment}{// This is necessary to support the tpl format}}
\DoxyCodeLine{00636   \textcolor{keywordflow}{if} (m\_refImgPath !=}
\DoxyCodeLine{00637       \mbox{\hyperlink{class_t_file_path}{TFilePath}}()) \{  \textcolor{comment}{// since it performs *untagged* stream output}}
\DoxyCodeLine{00638     \textcolor{keywordflow}{if} (m\_areRefLevelFidsSpecified) \{}
\DoxyCodeLine{00639       std::map<std::string, std::string> attr;}
\DoxyCodeLine{00640       attr[\textcolor{stringliteral}{"{}fids"{}}] = fidsToString(m\_refLevelFids);}
\DoxyCodeLine{00641       os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}refImgPath"{}}, attr);}
\DoxyCodeLine{00642     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00643       os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}refImgPath"{}});}
\DoxyCodeLine{00644     os << m\_refImgPath;  \textcolor{comment}{// (the palette is streamed directly).}}
\DoxyCodeLine{00645     os.\mbox{\hyperlink{class_t_o_stream_ae80752da32b21a502953e151e7c4b2ee}{closeChild}}();}
\DoxyCodeLine{00646   \}}
\DoxyCodeLine{00647 }
\DoxyCodeLine{00648   os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}styles"{}});}
\DoxyCodeLine{00649   \{}
\DoxyCodeLine{00650     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}(); ++i) \{}
\DoxyCodeLine{00651       \mbox{\hyperlink{class_t_smart_pointer_t}{TColorStyleP}} style = m\_styles[i].second;}
\DoxyCodeLine{00652       \textcolor{keywordflow}{if} (style-\/>getPickedPosition().pos == \mbox{\hyperlink{class_t_point_t}{TPoint}}())}
\DoxyCodeLine{00653         os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}style"{}});}
\DoxyCodeLine{00654       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00655         std::map<std::string, std::string> attr;}
\DoxyCodeLine{00656         attr[\textcolor{stringliteral}{"{}pickedpos"{}}] = pointToString(style-\/>getPickedPosition());}
\DoxyCodeLine{00657         os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}style"{}}, attr);}
\DoxyCodeLine{00658       \}}
\DoxyCodeLine{00659       \{}
\DoxyCodeLine{00660         StyleWriter w(os, i);}
\DoxyCodeLine{00661         style-\/>\mbox{\hyperlink{class_t_color_style_a77eb7dbedc1c6fe2e4ade48eee4bdcb6}{save}}(w);}
\DoxyCodeLine{00662       \}}
\DoxyCodeLine{00663       os.\mbox{\hyperlink{class_t_o_stream_ae80752da32b21a502953e151e7c4b2ee}{closeChild}}();}
\DoxyCodeLine{00664     \}}
\DoxyCodeLine{00665   \}}
\DoxyCodeLine{00666   os.\mbox{\hyperlink{class_t_o_stream_ae80752da32b21a502953e151e7c4b2ee}{closeChild}}();}
\DoxyCodeLine{00667 }
\DoxyCodeLine{00668   os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}stylepages"{}});}
\DoxyCodeLine{00669   \{}
\DoxyCodeLine{00670     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{class_t_palette_afd211cadf0f047450bc31897f858fa73}{getPageCount}}(); ++i) \{}
\DoxyCodeLine{00671       Page *page = \mbox{\hyperlink{class_t_palette_a25f83b7baf3eb774e50c726fa702056c}{getPage}}(i);}
\DoxyCodeLine{00672       os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}page"{}});}
\DoxyCodeLine{00673       \{}
\DoxyCodeLine{00674         os.\mbox{\hyperlink{class_t_o_stream_a9cd1359e6b21d85786708c7e680756d1}{child}}(\textcolor{stringliteral}{"{}name"{}}) << page-\/>getName();}
\DoxyCodeLine{00675 }
\DoxyCodeLine{00676         os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}indices"{}});}
\DoxyCodeLine{00677         \{}
\DoxyCodeLine{00678           \textcolor{keywordtype}{int} m = page-\/>getStyleCount();}
\DoxyCodeLine{00679 }
\DoxyCodeLine{00680           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < m; ++j) os << page-\/>getStyleId(j);}
\DoxyCodeLine{00681         \}}
\DoxyCodeLine{00682         os.\mbox{\hyperlink{class_t_o_stream_ae80752da32b21a502953e151e7c4b2ee}{closeChild}}();}
\DoxyCodeLine{00683       \}}
\DoxyCodeLine{00684       os.\mbox{\hyperlink{class_t_o_stream_ae80752da32b21a502953e151e7c4b2ee}{closeChild}}();}
\DoxyCodeLine{00685     \}}
\DoxyCodeLine{00686   \}}
\DoxyCodeLine{00687   os.\mbox{\hyperlink{class_t_o_stream_ae80752da32b21a502953e151e7c4b2ee}{closeChild}}();}
\DoxyCodeLine{00688 }
\DoxyCodeLine{00689   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_palette_ab93ce6de2d1138d6c6946e1a3e317e04}{isAnimated}}()) \{}
\DoxyCodeLine{00690     os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}animation"{}});}
\DoxyCodeLine{00691     \{}
\DoxyCodeLine{00692       StyleAnimationTable::iterator sat, saEnd = m\_styleAnimationTable.end();}
\DoxyCodeLine{00693       \textcolor{keywordflow}{for} (sat = m\_styleAnimationTable.begin(); sat != saEnd; ++sat) \{}
\DoxyCodeLine{00694         \textcolor{keywordtype}{int} styleId               = sat-\/>first;}
\DoxyCodeLine{00695         StyleAnimation \&animation = sat-\/>second;}
\DoxyCodeLine{00696 }
\DoxyCodeLine{00697         std::map<std::string, std::string> attributes;}
\DoxyCodeLine{00698         attributes[\textcolor{stringliteral}{"{}id"{}}] = std::to\_string(styleId);}
\DoxyCodeLine{00699 }
\DoxyCodeLine{00700         os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}style"{}}, attributes);}
\DoxyCodeLine{00701         \{}
\DoxyCodeLine{00702           StyleAnimation::iterator kt, kEnd = animation.end();}
\DoxyCodeLine{00703           \textcolor{keywordflow}{for} (kt = animation.begin(); kt != kEnd; ++kt) \{}
\DoxyCodeLine{00704             \textcolor{keywordtype}{int} frame = kt-\/>first;}
\DoxyCodeLine{00705 }
\DoxyCodeLine{00706             \mbox{\hyperlink{class_t_color_style}{TColorStyle}} *cs = kt-\/>second.getPointer();}
\DoxyCodeLine{00707             assert(cs);}
\DoxyCodeLine{00708 }
\DoxyCodeLine{00709             attributes.clear();}
\DoxyCodeLine{00710             attributes[\textcolor{stringliteral}{"{}frame"{}}] = std::to\_string(frame);}
\DoxyCodeLine{00711 }
\DoxyCodeLine{00712             \textcolor{comment}{/*os.openChild("{}keycolor"{}, attributes);                       // Up}}
\DoxyCodeLine{00713 \textcolor{comment}{            to Toonz 7.0, animations saved os << cs-\/>getMainColor(); // the main}}
\DoxyCodeLine{00714 \textcolor{comment}{            color only os.closeChild();*/}  \textcolor{comment}{//}}
\DoxyCodeLine{00715 }
\DoxyCodeLine{00716             os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}keyframe"{}}, attributes);}
\DoxyCodeLine{00717             \{}
\DoxyCodeLine{00718               StyleWriter w(os, sat-\/>first);}
\DoxyCodeLine{00719               kt-\/>second-\/>save(w);}
\DoxyCodeLine{00720             \}}
\DoxyCodeLine{00721             os.\mbox{\hyperlink{class_t_o_stream_ae80752da32b21a502953e151e7c4b2ee}{closeChild}}();}
\DoxyCodeLine{00722           \}}
\DoxyCodeLine{00723         \}}
\DoxyCodeLine{00724         os.\mbox{\hyperlink{class_t_o_stream_ae80752da32b21a502953e151e7c4b2ee}{closeChild}}();}
\DoxyCodeLine{00725       \}}
\DoxyCodeLine{00726     \}}
\DoxyCodeLine{00727     os.\mbox{\hyperlink{class_t_o_stream_ae80752da32b21a502953e151e7c4b2ee}{closeChild}}();}
\DoxyCodeLine{00728   \}}
\DoxyCodeLine{00729 }
\DoxyCodeLine{00730   \textcolor{comment}{// salvo gli shortcuts solo se sono non standard}}
\DoxyCodeLine{00731   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{00732   \textcolor{keywordflow}{for} (i = 0; i < 10; ++i)}
\DoxyCodeLine{00733     \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_palette_ac7b1cee99b5f1961be1fc2e821bc2b8b}{getShortcutValue}}(\textcolor{charliteral}{'0'} + i) != i) \textcolor{keywordflow}{break};}
\DoxyCodeLine{00734 }
\DoxyCodeLine{00735   \textcolor{keywordflow}{if} (i < 10) \{}
\DoxyCodeLine{00736     os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}shortcuts"{}});}
\DoxyCodeLine{00737     \{}
\DoxyCodeLine{00738       \textcolor{keywordflow}{for} (i = 0; i < 10; i++) os << \mbox{\hyperlink{class_t_palette_ac7b1cee99b5f1961be1fc2e821bc2b8b}{getShortcutValue}}(\textcolor{charliteral}{'0'} + i);}
\DoxyCodeLine{00739     \}}
\DoxyCodeLine{00740     os.\mbox{\hyperlink{class_t_o_stream_ae80752da32b21a502953e151e7c4b2ee}{closeChild}}();}
\DoxyCodeLine{00741   \}}
\DoxyCodeLine{00742   \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_t_palette_a4a66ac047e12676ed6038f1261743dde}{isLocked}}()) \{}
\DoxyCodeLine{00743     os.\mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{openChild}}(\textcolor{stringliteral}{"{}lock"{}});}
\DoxyCodeLine{00744     os << 1;}
\DoxyCodeLine{00745     os.\mbox{\hyperlink{class_t_o_stream_ae80752da32b21a502953e151e7c4b2ee}{closeChild}}();}
\DoxyCodeLine{00746   \}}
\DoxyCodeLine{00747 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00482}{TOStream\+::child()}}, \mbox{\hyperlink{l00520}{TOStream\+::close\+Child()}}, \mbox{\hyperlink{l00106}{TPalette\+::\+Page\+::get\+Name()}}, \mbox{\hyperlink{l00372}{get\+Page()}}, \mbox{\hyperlink{l00368}{get\+Page\+Count()}}, \mbox{\hyperlink{l01162}{get\+Shortcut\+Value()}}, \mbox{\hyperlink{l00121}{TPalette\+::\+Page\+::get\+Style\+Count()}}, \mbox{\hyperlink{l00255}{get\+Style\+Count()}}, \mbox{\hyperlink{l00132}{TPalette\+::\+Page\+::get\+Style\+Id()}}, \mbox{\hyperlink{l01046}{is\+Animated()}}, \mbox{\hyperlink{l00420}{is\+Locked()}}, \mbox{\hyperlink{class_t_o_stream_a38fe0f56d934f1c25e2b5d8156415673}{TOStream\+::open\+Child()}}, and \mbox{\hyperlink{l00486}{TColor\+Style\+::save()}}.

\mbox{\Hypertarget{class_t_palette_a988c1603b1f87b4d3e26195781574658}\label{class_t_palette_a988c1603b1f87b4d3e26195781574658}} 
\index{TPalette@{TPalette}!setAskOverwriteFlag@{setAskOverwriteFlag}}
\index{setAskOverwriteFlag@{setAskOverwriteFlag}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setAskOverwriteFlag()}{setAskOverwriteFlag()}}
{\footnotesize\ttfamily void TPalette\+::set\+Ask\+Overwrite\+Flag (\begin{DoxyParamCaption}\item[{bool}]{ask\+Overwrite\+Flag }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

if the palette is merged from studio palette, this function will modify the original names. \texorpdfstring{$<$}{<} Sets the ask-\/overwrite flag.
\begin{DoxyCode}{0}
\DoxyCodeLine{00346                              \{  }
\DoxyCodeLine{00347     m\_askOverwriteFlag = askOverwriteFlag;}
\DoxyCodeLine{00348   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_a5771815e1daa519b6bbd6cd284c3bc26}\label{class_t_palette_a5771815e1daa519b6bbd6cd284c3bc26}} 
\index{TPalette@{TPalette}!setCurrentStyleId@{setCurrentStyleId}}
\index{setCurrentStyleId@{setCurrentStyleId}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setCurrentStyleId()}{setCurrentStyleId()}}
{\footnotesize\ttfamily void TPalette\+::set\+Current\+Style\+Id (\begin{DoxyParamCaption}\item[{int}]{id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00433 \{ m\_currentStyleId = id; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_a382fa102abee4e69e386cb5a4d8d5184}\label{class_t_palette_a382fa102abee4e69e386cb5a4d8d5184}} 
\index{TPalette@{TPalette}!setDirtyFlag@{setDirtyFlag}}
\index{setDirtyFlag@{setDirtyFlag}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setDirtyFlag()}{setDirtyFlag()}}
{\footnotesize\ttfamily void TPalette\+::set\+Dirty\+Flag (\begin{DoxyParamCaption}\item[{bool}]{dirty\+Flag }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyParams}{Parameters}
{\em dirty\+Flag} & Declares the palette {\itshape changed} with respect to the last {\itshape saved state}. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00242   \{}
\DoxyCodeLine{00243     m\_dirtyFlag = dirtyFlag;}
\DoxyCodeLine{00244     \textcolor{comment}{// synchronize with the dirty flag}}
\DoxyCodeLine{00245     m\_askOverwriteFlag = dirtyFlag;}
\DoxyCodeLine{00246   \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00571}{Studio\+Palette\+Tree\+Viewer\+::convert\+To\+Studio\+Palette()}}, \mbox{\hyperlink{l00765}{Studio\+Palette\+Tree\+Viewer\+::load\+In\+Current\+Palette()}}, \mbox{\hyperlink{l00475}{Studio\+Palette\+Tree\+Viewer\+::on\+Current\+Item\+Changed()}}, \mbox{\hyperlink{l00412}{Studio\+Palette\+Tree\+Viewer\+::on\+Item\+Selection\+Changed()}}, \mbox{\hyperlink{l00808}{Studio\+Palette\+Tree\+Viewer\+::replace\+Current\+Palette()}}, \mbox{\hyperlink{l01468}{TXsh\+Simple\+Level\+::save()}}, and \mbox{\hyperlink{l01214}{Palette\+Viewer\+::set\+Is\+Locked()}}.

\mbox{\Hypertarget{class_t_palette_aca7d99a4af59ffaed0ead1f8700c2edc}\label{class_t_palette_aca7d99a4af59ffaed0ead1f8700c2edc}} 
\index{TPalette@{TPalette}!setFrame@{setFrame}}
\index{setFrame@{setFrame}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setFrame()}{setFrame()}}
{\footnotesize\ttfamily void TPalette\+::set\+Frame (\begin{DoxyParamCaption}\item[{int}]{frame }\end{DoxyParamCaption})}



Sets the index of the current frame. 


\begin{DoxyCode}{0}
\DoxyCodeLine{01054                                  \{}
\DoxyCodeLine{01055   QMutexLocker muLock(\&m\_mutex);}
\DoxyCodeLine{01056 }
\DoxyCodeLine{01057   \textcolor{keywordflow}{if} (m\_currentFrame == frame) \textcolor{keywordflow}{return};}
\DoxyCodeLine{01058 }
\DoxyCodeLine{01059   m\_currentFrame = frame;}
\DoxyCodeLine{01060 }
\DoxyCodeLine{01061   StyleAnimationTable::iterator sat, saEnd = m\_styleAnimationTable.end();}
\DoxyCodeLine{01062   \textcolor{keywordflow}{for} (sat = m\_styleAnimationTable.begin(); sat != saEnd; ++sat) \{}
\DoxyCodeLine{01063     StyleAnimation \&animation = sat-\/>second;}
\DoxyCodeLine{01064     assert(!animation.empty());}
\DoxyCodeLine{01065 }
\DoxyCodeLine{01066     \textcolor{comment}{// Retrieve the associated style to interpolate}}
\DoxyCodeLine{01067     \textcolor{keywordtype}{int} styleId = sat-\/>first;}
\DoxyCodeLine{01068     assert(0 <= styleId \&\& styleId < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}());}
\DoxyCodeLine{01069 }
\DoxyCodeLine{01070     \mbox{\hyperlink{class_t_color_style}{TColorStyle}} *cs = \mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(styleId);}
\DoxyCodeLine{01071     assert(cs);}
\DoxyCodeLine{01072 }
\DoxyCodeLine{01073     \textcolor{comment}{// Build the keyframes interval containing frame}}
\DoxyCodeLine{01074     StyleAnimation::iterator j0, j1;}
\DoxyCodeLine{01075 }
\DoxyCodeLine{01076     j1 = animation.lower\_bound(}
\DoxyCodeLine{01077         frame);  \textcolor{comment}{// j1 is the first element:  j1-\/>first >= frame}}
\DoxyCodeLine{01078     \textcolor{keywordflow}{if} (j1 == animation.begin())}
\DoxyCodeLine{01079       cs-\/>\mbox{\hyperlink{class_t_color_style_a39bf1c837a7348e4dff65d1779f63a7f}{copy}}(*j1-\/>second);}
\DoxyCodeLine{01080     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01081       j0 = j1, -\/-\/j0;}
\DoxyCodeLine{01082       assert(j0-\/>first <= frame);}
\DoxyCodeLine{01083 }
\DoxyCodeLine{01084       \textcolor{keywordflow}{if} (j1 == animation.end())}
\DoxyCodeLine{01085         cs-\/>\mbox{\hyperlink{class_t_color_style_a39bf1c837a7348e4dff65d1779f63a7f}{copy}}(*j0-\/>second);}
\DoxyCodeLine{01086       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01087         assert(frame <= j1-\/>first);}
\DoxyCodeLine{01088 }
\DoxyCodeLine{01089         cs-\/>\mbox{\hyperlink{class_t_color_style_adda489e34e4552d4ad5e2764dd554ca6}{assignBlend}}(*j0-\/>second, *j1-\/>second,}
\DoxyCodeLine{01090                         (frame -\/ j0-\/>first) / \textcolor{keywordtype}{double}(j1-\/>first -\/ j0-\/>first));}
\DoxyCodeLine{01091       \}}
\DoxyCodeLine{01092     \}}
\DoxyCodeLine{01093   \}}
\DoxyCodeLine{01094 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00332}{TColor\+Style\+::assign\+Blend()}}, \mbox{\hyperlink{l00150}{TColor\+Style\+::copy()}}, \mbox{\hyperlink{l00283}{get\+Style()}}, and \mbox{\hyperlink{l00255}{get\+Style\+Count()}}.



Referenced by \mbox{\hyperlink{l00821}{Stage\+::\+Raster\+Painter\+::on\+Vector\+Image()}}, and \mbox{\hyperlink{l00698}{Toonz\+Image\+Icon\+Renderer\+::run()}}.

\mbox{\Hypertarget{class_t_palette_a0d1a5c3b332f133235f6fd758d22f683}\label{class_t_palette_a0d1a5c3b332f133235f6fd758d22f683}} 
\index{TPalette@{TPalette}!setGlobalName@{setGlobalName}}
\index{setGlobalName@{setGlobalName}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setGlobalName()}{setGlobalName()}}
{\footnotesize\ttfamily void TPalette\+::set\+Global\+Name (\begin{DoxyParamCaption}\item[{std\+::wstring}]{name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Assigns the name of the palette. 



Referenced by \mbox{\hyperlink{l00571}{Studio\+Palette\+Tree\+Viewer\+::convert\+To\+Studio\+Palette()}}.

\mbox{\Hypertarget{class_t_palette_a609c029285f223f5bc116c5e1f6ed358}\label{class_t_palette_a609c029285f223f5bc116c5e1f6ed358}} 
\index{TPalette@{TPalette}!setIsCleanupPalette@{setIsCleanupPalette}}
\index{setIsCleanupPalette@{setIsCleanupPalette}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setIsCleanupPalette()}{setIsCleanupPalette()}}
{\footnotesize\ttfamily void TPalette\+::set\+Is\+Cleanup\+Palette (\begin{DoxyParamCaption}\item[{bool}]{on }\end{DoxyParamCaption})}



Sets the palette\textquotesingle{}s identity as a cleanup palette. 


\begin{DoxyCode}{0}
\DoxyCodeLine{01015 \{ m\_isCleanupPalette = on; \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_a0365e562643620b90f7477ccf70b8411}\label{class_t_palette_a0365e562643620b90f7477ccf70b8411}} 
\index{TPalette@{TPalette}!setIsLocked@{setIsLocked}}
\index{setIsLocked@{setIsLocked}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setIsLocked()}{setIsLocked()}}
{\footnotesize\ttfamily void TPalette\+::set\+Is\+Locked (\begin{DoxyParamCaption}\item[{bool}]{lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyParams}{Parameters}
{\em lock} & Sets lock/unlock to the palette. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00424   \{}
\DoxyCodeLine{00425     m\_isLocked = lock;}
\DoxyCodeLine{00426   \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l01214}{Palette\+Viewer\+::set\+Is\+Locked()}}.

\mbox{\Hypertarget{class_t_palette_aaf6467771b2ec40b6751295985fdd687}\label{class_t_palette_aaf6467771b2ec40b6751295985fdd687}} 
\index{TPalette@{TPalette}!setKeyframe@{setKeyframe}}
\index{setKeyframe@{setKeyframe}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setKeyframe()}{setKeyframe()}}
{\footnotesize\ttfamily void TPalette\+::set\+Keyframe (\begin{DoxyParamCaption}\item[{int}]{style\+Id,  }\item[{int}]{frame }\end{DoxyParamCaption})}

Sets a keyframe at the specified frame of style\+Id\textquotesingle{}s 
\begin{DoxyCode}{0}
\DoxyCodeLine{01126                                                  \{}
\DoxyCodeLine{01127   assert(styleId >= 0 \&\& styleId < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}());}
\DoxyCodeLine{01128   assert(frame >= 0);}
\DoxyCodeLine{01129 }
\DoxyCodeLine{01130   StyleAnimationTable::iterator sat = m\_styleAnimationTable.find(styleId);}
\DoxyCodeLine{01131 }
\DoxyCodeLine{01132   \textcolor{keywordflow}{if} (sat == m\_styleAnimationTable.end())}
\DoxyCodeLine{01133     sat =}
\DoxyCodeLine{01134         m\_styleAnimationTable.insert(std::make\_pair(styleId, StyleAnimation()))}
\DoxyCodeLine{01135             .first;}
\DoxyCodeLine{01136 }
\DoxyCodeLine{01137   assert(sat != m\_styleAnimationTable.end());}
\DoxyCodeLine{01138 }
\DoxyCodeLine{01139   StyleAnimation \&animation = sat-\/>second;}
\DoxyCodeLine{01140   animation[frame]          = \mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(styleId)-\/>\mbox{\hyperlink{class_t_color_style_a7b7e50c731a150aa84f746a261765adf}{clone}}();}
\DoxyCodeLine{01141 \}}

\end{DoxyCode}


References \mbox{\hyperlink{class_t_color_style_a7b7e50c731a150aa84f746a261765adf}{TColor\+Style\+::clone()}}, \mbox{\hyperlink{l00283}{get\+Style()}}, and \mbox{\hyperlink{l00255}{get\+Style\+Count()}}.

\mbox{\Hypertarget{class_t_palette_a49d4f02fb0810c659887bc4e2c5bc3a0}\label{class_t_palette_a49d4f02fb0810c659887bc4e2c5bc3a0}} 
\index{TPalette@{TPalette}!setPaletteName@{setPaletteName}}
\index{setPaletteName@{setPaletteName}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setPaletteName()}{setPaletteName()}}
{\footnotesize\ttfamily void TPalette\+::set\+Palette\+Name (\begin{DoxyParamCaption}\item[{std\+::wstring}]{name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Sets the name of the palette. 



Referenced by \mbox{\hyperlink{l00428}{TXsh\+Simple\+Level\+::set\+Palette()}}.

\mbox{\Hypertarget{class_t_palette_a971fd2aac3c14754d6cdcb0679cf6893}\label{class_t_palette_a971fd2aac3c14754d6cdcb0679cf6893}} 
\index{TPalette@{TPalette}!setRefImg@{setRefImg}}
\index{setRefImg@{setRefImg}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setRefImg()}{setRefImg()}}
{\footnotesize\ttfamily void TPalette\+::set\+Ref\+Img (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_smart_pointer_t}{TImageP}} \&}]{img }\end{DoxyParamCaption})}

Associates an image to this palette, that is an image in the frame 
\begin{DoxyCode}{0}
\DoxyCodeLine{01019                                            \{}
\DoxyCodeLine{01020   m\_refImg = img;}
\DoxyCodeLine{01021   \textcolor{keywordflow}{if} (img) \{}
\DoxyCodeLine{01022     assert(img-\/>getPalette() == 0);}
\DoxyCodeLine{01023   \}}
\DoxyCodeLine{01024 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l01083}{TXsh\+Simple\+Level\+::load()}}, and \mbox{\hyperlink{l00504}{Color\+Model\+Viewer\+::load\+Current\+Frame()}}.

\mbox{\Hypertarget{class_t_palette_a3009b4c976d9458d71dca9ea176bd7e1}\label{class_t_palette_a3009b4c976d9458d71dca9ea176bd7e1}} 
\index{TPalette@{TPalette}!setRefImgPath@{setRefImgPath}}
\index{setRefImgPath@{setRefImgPath}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setRefImgPath()}{setRefImgPath()}}
{\footnotesize\ttfamily void TPalette\+::set\+Ref\+Img\+Path (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{fp }\end{DoxyParamCaption})}



Sets the path filename of the reference image. 


\begin{DoxyCode}{0}
\DoxyCodeLine{01040                                                         \{}
\DoxyCodeLine{01041   m\_refImgPath = refImgPath;}
\DoxyCodeLine{01042 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l00799}{Palette\+Viewer\+::drop\+Event()}}, and \mbox{\hyperlink{l00504}{Color\+Model\+Viewer\+::load\+Current\+Frame()}}.

\mbox{\Hypertarget{class_t_palette_a807070f5c3f7033531f455f08ee489c4}\label{class_t_palette_a807070f5c3f7033531f455f08ee489c4}} 
\index{TPalette@{TPalette}!setRefLevelFids@{setRefLevelFids}}
\index{setRefLevelFids@{setRefLevelFids}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setRefLevelFids()}{setRefLevelFids()}}
{\footnotesize\ttfamily void TPalette\+::set\+Ref\+Level\+Fids (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{class_t_frame_id}{TFrame\+Id}} $>$}]{fids,  }\item[{bool}]{specified }\end{DoxyParamCaption})}

Associates the list of frames {\itshape } 
\begin{DoxyCode}{0}
\DoxyCodeLine{01029                                                \{}
\DoxyCodeLine{01030   m\_refLevelFids             = fids;}
\DoxyCodeLine{01031   m\_areRefLevelFidsSpecified = specified;}
\DoxyCodeLine{01032 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{l01083}{TXsh\+Simple\+Level\+::load()}}, and \mbox{\hyperlink{l00504}{Color\+Model\+Viewer\+::load\+Current\+Frame()}}.

\mbox{\Hypertarget{class_t_palette_a55d9b8d3bfcb9690abd6bb1e2955ed0e}\label{class_t_palette_a55d9b8d3bfcb9690abd6bb1e2955ed0e}} 
\index{TPalette@{TPalette}!setRootDir@{setRootDir}}
\index{setRootDir@{setRootDir}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setRootDir()}{setRootDir()}}
{\footnotesize\ttfamily void TPalette\+::set\+Root\+Dir (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_t_file_path}{TFile\+Path}} \&}]{fp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

It must be specified to save textures in {\itshape } 
\begin{DoxyCode}{0}
\DoxyCodeLine{00626                                              \{}
\DoxyCodeLine{00627   StyleWriter::setRootDir(fp);}
\DoxyCodeLine{00628   StyleReader::setRootDir(fp);}
\DoxyCodeLine{00629 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_t_palette_a2e4fc32a08028cbcc65c9a3897efa80d}\label{class_t_palette_a2e4fc32a08028cbcc65c9a3897efa80d}} 
\index{TPalette@{TPalette}!setShortcutValue@{setShortcutValue}}
\index{setShortcutValue@{setShortcutValue}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setShortcutValue()}{setShortcutValue()}}
{\footnotesize\ttfamily void TPalette\+::set\+Shortcut\+Value (\begin{DoxyParamCaption}\item[{int}]{key,  }\item[{int}]{style\+Id }\end{DoxyParamCaption})}



Associates the specified key to a style\+Id. 


\begin{DoxyCode}{0}
\DoxyCodeLine{01187                                                     \{}
\DoxyCodeLine{01188   assert(\textcolor{charliteral}{'0'} <= key \&\& key <= \textcolor{charliteral}{'9'});}
\DoxyCodeLine{01189   assert(styleId == -\/1 || 0 <= styleId \&\& styleId < \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}());}
\DoxyCodeLine{01190   \textcolor{keywordflow}{if} (styleId == -\/1)}
\DoxyCodeLine{01191     m\_shortcuts.erase(key);}
\DoxyCodeLine{01192   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{01193     std::map<int, int>::iterator it;}
\DoxyCodeLine{01194     \textcolor{keywordflow}{for} (it = m\_shortcuts.begin(); it != m\_shortcuts.end(); ++it)}
\DoxyCodeLine{01195       \textcolor{keywordflow}{if} (it-\/>second == styleId) \{}
\DoxyCodeLine{01196         m\_shortcuts.erase(it);}
\DoxyCodeLine{01197         \textcolor{keywordflow}{break};}
\DoxyCodeLine{01198       \}}
\DoxyCodeLine{01199     m\_shortcuts[key] = styleId;}
\DoxyCodeLine{01200   \}}
\DoxyCodeLine{01201 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00255}{get\+Style\+Count()}}.



Referenced by \mbox{\hyperlink{l00751}{load\+Data()}}.

\mbox{\Hypertarget{class_t_palette_ae6b45fab15ad86f01342b3e7855502f6}\label{class_t_palette_ae6b45fab15ad86f01342b3e7855502f6}} 
\index{TPalette@{TPalette}!setStyle@{setStyle}}
\index{setStyle@{setStyle}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setStyle()}{setStyle()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void TPalette\+::set\+Style (\begin{DoxyParamCaption}\item[{int}]{style\+Id,  }\item[{const TPixel\+RGBM32 \&}]{color }\end{DoxyParamCaption})}

Replaces the style with the 
\begin{DoxyCode}{0}
\DoxyCodeLine{00362                                                               \{}
\DoxyCodeLine{00363   \mbox{\hyperlink{class_t_palette_ab9369e7992a6db74a33b7e5094071121}{setStyle}}(styleId, \textcolor{keyword}{new} \mbox{\hyperlink{class_t_solid_color_style}{TSolidColorStyle}}(color));}
\DoxyCodeLine{00364 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00341}{set\+Style()}}.

\mbox{\Hypertarget{class_t_palette_ab9369e7992a6db74a33b7e5094071121}\label{class_t_palette_ab9369e7992a6db74a33b7e5094071121}} 
\index{TPalette@{TPalette}!setStyle@{setStyle}}
\index{setStyle@{setStyle}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setStyle()}{setStyle()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void TPalette\+::set\+Style (\begin{DoxyParamCaption}\item[{int}]{style\+Id,  }\item[{\mbox{\hyperlink{class_t_color_style}{TColor\+Style}} $\ast$}]{style }\end{DoxyParamCaption})}



Replaces the style with the specified style id. 

\begin{DoxyRemark}{Remarks}
Style ownserhip is {\itshape surrendered} to the palette. 

Any existing style\textquotesingle{}s animation will be discarded. 
\end{DoxyRemark}

\begin{DoxyCode}{0}
\DoxyCodeLine{00341                                                        \{}
\DoxyCodeLine{00342   std::unique\_ptr<TColorStyle> styleOwner(style);}
\DoxyCodeLine{00343 }
\DoxyCodeLine{00344   \textcolor{keywordtype}{int} styleCount = \mbox{\hyperlink{class_t_palette_a5a562f2d3a5fa256fcb4bb2be5b45534}{getStyleCount}}();}
\DoxyCodeLine{00345 }
\DoxyCodeLine{00346   \textcolor{keywordflow}{if} (0 <= styleId \&\& styleId < styleCount) \{}
\DoxyCodeLine{00347     \textcolor{comment}{// Find out if the supplied style is already in the palette}}
\DoxyCodeLine{00348     \textcolor{comment}{// with a different style id. In that case, bail out as a noop.}}
\DoxyCodeLine{00349     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < styleCount; ++i)}
\DoxyCodeLine{00350       \textcolor{keywordflow}{if} (style == \mbox{\hyperlink{class_t_palette_a0f6a4eda7dafb0a9f2b43160cfec81e4}{getStyle}}(i)) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00351 }
\DoxyCodeLine{00352     \textcolor{comment}{// Substitution can take place}}
\DoxyCodeLine{00353     \textcolor{keywordflow}{if} (\textcolor{keyword}{typeid}(*m\_styles[styleId].second.getPointer()) != \textcolor{keyword}{typeid}(*style))}
\DoxyCodeLine{00354       m\_styleAnimationTable.erase(styleId);}
\DoxyCodeLine{00355 }
\DoxyCodeLine{00356     m\_styles[styleId].second = styleOwner.release();}
\DoxyCodeLine{00357   \}}
\DoxyCodeLine{00358 \}}

\end{DoxyCode}


References \mbox{\hyperlink{l00283}{get\+Style()}}, and \mbox{\hyperlink{l00255}{get\+Style\+Count()}}.



Referenced by \mbox{\hyperlink{l00362}{set\+Style()}}.

\mbox{\Hypertarget{class_t_palette_a8afe4a624111185995b5594ca03ec32d}\label{class_t_palette_a8afe4a624111185995b5594ca03ec32d}} 
\index{TPalette@{TPalette}!setVersion@{setVersion}}
\index{setVersion@{setVersion}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{setVersion()}{setVersion()}}
{\footnotesize\ttfamily void TPalette\+::set\+Version (\begin{DoxyParamCaption}\item[{int}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Sets the palette\textquotesingle{}s version number. 



\doxysubsection{Friends And Related Function Documentation}
\mbox{\Hypertarget{class_t_palette_a66d145c56e1747e0aecb5309042ab183}\label{class_t_palette_a66d145c56e1747e0aecb5309042ab183}} 
\index{TPalette@{TPalette}!Page@{Page}}
\index{Page@{Page}!TPalette@{TPalette}}
\doxysubsubsection{\texorpdfstring{Page}{Page}}
{\footnotesize\ttfamily friend class \mbox{\hyperlink{class_t_palette_1_1_page}{Page}}\hspace{0.3cm}{\ttfamily [friend]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
E\+:/opentoonz/toonz/sources/include/tpalette.\+h\item 
E\+:/opentoonz/toonz/sources/common/tvrender/tpalette.\+cpp\end{DoxyCompactItemize}
